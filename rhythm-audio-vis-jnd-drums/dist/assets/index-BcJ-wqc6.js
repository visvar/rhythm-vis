import{N as rs}from"./browser-Bw6UQkrp.js";const os=(r,t=4294967295,s=79764919)=>{const n=new Int32Array(256);let e,i,o,a=t;for(e=0;e<256;e++){for(o=e<<24,i=8;i>0;--i)o=2147483648&o?o<<1^s:o<<1;n[e]=o}for(e=0;e<r.length;e++)a=a<<8^n[255&(a>>24^r[e])];return a},ve=(r,t=os)=>{const s=U=>new Uint8Array(U.length/2).map((F,V)=>parseInt(U.substring(2*V,2*(V+1)),16)),n=U=>s(U)[0],e=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((U,F)=>e.set(U,F));const i=new Uint8Array(r.length);let o,a,l,h=!1,g=0,_=42,A=r.length>13&&r.substring(0,9)==="dynEncode",M=0;A&&(M=11,a=n(r.substring(9,M)),a<=1&&(M+=2,_=n(r.substring(11,M))),a===1&&(M+=8,l=(U=>new DataView(s(U).buffer).getInt32(0,!0))(r.substring(13,M))));const N=256-_;for(let U=M;U<r.length;U++)if(o=r.charCodeAt(U),o!==61||h){if(o===92&&U<r.length-5&&A){const F=r.charCodeAt(U+1);F!==117&&F!==85||(o=parseInt(r.substring(U+2,U+6),16),U+=5)}if(o>255){const F=e.get(o);F&&(o=F+127)}h&&(h=!1,o-=64),i[g++]=o<_&&o>0?o+N:o-_}else h=!0;const E=i.subarray(0,g);if(A&&a===1){const U=t(E);if(U!==l){const F="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",F+`
`,"Expected: "+l+"; Got: "+U+`
`,"Visit https://github.com/eshaz/simple-yenc for more information"),Error(F)}}return E};function B(){const r=Uint8Array,t=Float32Array;B.modules||Object.defineProperties(B,{modules:{value:new WeakMap},setModule:{value(s,n){B.modules.set(s,Promise.resolve(n))}},getModule:{value(s,n){let e=B.modules.get(s);return e||(n?e=WebAssembly.compile(ve(n)):(n=s.wasm,e=B.inflateDynEncodeString(n).then(i=>WebAssembly.compile(i))),B.modules.set(s,e)),e}},concatFloat32:{value(s,n){let e=new t(n),i=0,o=0;for(;i<s.length;)e.set(s[i],o),o+=s[i++].length;return e}},getDecodedAudio:{value:(s,n,e,i,o)=>({errors:s,channelData:n,samplesDecoded:e,sampleRate:i,bitDepth:o})},getDecodedAudioMultiChannel:{value(s,n,e,i,o,a){let l=[],h,g;for(h=0;h<e;h++){const _=[];for(g=0;g<n.length;)_.push(n[g++][h]||[]);l.push(B.concatFloat32(_,i))}return B.getDecodedAudio(s,l,i,o,a)}},inflateDynEncodeString:{value(s){return s=ve(s),new Promise(n=>{const e=String.raw`dynEncode0114db91da9bu*ttt$#U¤¤U¤¤3yzzss|yusvuyÚ&4<054<,5T44^T44<(6U~J(44< ~A544U~6J0444545 444J0444J,4U4UÒ7U454U4Z4U4U^/6545T4T44BU~64CU~O4U54U~5 U5T4B4Z!4U~5U5U5T4U~6U4ZTU5U5T44~4O4U2ZTU5T44Z!4B6T44U~64B6U~O44U~4O4U~54U~5 44~C4~54U~5 44~5454U4B6Ub!444~UO4U~5 U54U4ZTU#44U$464<4~B6^4<444~U~B4U~54U544~544~U5 µUä#UJUè#5TT4U0ZTTUX5U5T4T4Uà#~4OU4U $~C4~54U~5 T44$6U\!TTT4UaT4<6T4<64<Z!44~4N4<U~5 4UZ!4U±_TU#44UU6UÔ~B$544$6U\!4U6U¤#~B44Uä#~B$~64<6_TU#444U~B~6~54<Y!44<_!T4Y!4<64~444~AN44<U~6J4U5 44J4U[!U#44UO4U~54U~5 U54 7U6844J44J 4UJ4UJ04VK(44<J44<J$4U´~54U~5 4U¤~5!TTT4U$5"U5TTTTTTT4U$"4VK,U54<(6U~64<$6_!4< 64~6A54A544U~6#J(U54A4U[!44J(44#~A4U6UUU[!4464~64_!4<64~54<6T4<4]TU5 T4Y!44~44~AN4U~54U~54U5 44J(44J UÄA!U5U#UôJU"UÔJU#UÔ"JU#U´"JT4U´ZTU5T4UôZTU5T4UDZTU5T4U$[T44~UO4U~5 UÔUô4U~U´$.U5T4UP[T4U~4~UO4U~5 U#<U#<4U~U2$.UÄUN 44 ~UO4U~5 44!~UO4U~5 4U~4~UO4U~5 44J44J(U5 44U¤~J@44Uä~J<44UD~J844U~J44U$54U$5U54U$54U1^4U1^!4U~54U~5U54U~6U4U^/65T4T4U$54U~4BU~4O4U54U~5 UU'464U'_/54UU~5T4T4U~4BU~UO4U54U~5 U54Uä~4U¤~4U~U'$!44~5U5T44\T44U<~$6U\!4U#aT4U~4U~4O4U~5 U5U5U5TTT4U$"4YTU5 4U4~C5U5 U5U5444$4~64~\TU5 4U~4U~5T4Y!44O4U~54U~54U5 4CYTU5 4Uä~4U¤~4U~4$6TU54U\!44Bæ4Bä~[!4U~4UD~4U~4U~4$6TU54U\!44B4B~[!44U<~4U4~$5 4U"U#$544"Y!454U^!44<J44<(J454U~84­UN!#%'+/37?GOWgw·×÷Uä;U9$%& !"#`;B.getModule(B,e).then(i=>WebAssembly.instantiate(i,{})).then(({exports:i})=>{const o=new Map(Object.entries(i)),a=o.get("puff"),l=o.get("memory").buffer,h=new r(l),g=new DataView(l);let _=o.get("__heap_base");const A=s.length,M=_;_+=4,g.setInt32(M,A,!0);const N=_;_+=A,h.set(s,N);const E=_;_+=4,g.setInt32(E,h.byteLength-_,!0),a(_,E,N,M),n(h.slice(_,_+g.getInt32(E,!0)))})})}}}),Object.defineProperty(this,"wasm",{enumerable:!0,get:()=>this._wasm}),this.getOutputChannels=(s,n,e)=>{let i=[],o=0;for(;o<n;)i.push(s.slice(o*e,o++*e+e));return i},this.allocateTypedArray=(s,n,e=!0)=>{const i=this._wasm.malloc(n.BYTES_PER_ELEMENT*s);return e&&this._pointers.add(i),{ptr:i,len:s,buf:new n(this._wasm.HEAP,i,s)}},this.free=()=>{this._pointers.forEach(s=>{this._wasm.free(s)}),this._pointers.clear()},this.codeToString=s=>{const n=[],e=new Uint8Array(this._wasm.HEAP);for(let i=e[s];i!==0;i=e[++s])n.push(i);return String.fromCharCode.apply(null,n)},this.addError=(s,n,e,i,o,a)=>{s.push({message:n,frameLength:e,frameNumber:i,inputBytes:o,outputSamples:a})},this.instantiate=(s,n)=>(n&&B.setModule(s,n),this._wasm=new s(B).instantiate(),this._pointers=new Set,this._wasm.ready.then(()=>this))}const cs=()=>globalThis.Worker||rs;class qs extends cs(){constructor(t,s,n,e){B.modules||new B;let i=B.modules.get(n);if(!i){let o="text/javascript",a,l=`'use strict';(${((h,g,_)=>{let A,M,N=new Promise(E=>{M=E});self.onmessage=({data:{id:E,command:U,data:F}})=>{let V=N,Y0={id:E},Fe;U==="init"?(Object.defineProperties(h,{WASMAudioDecoderCommon:{value:g},EmscriptenWASM:{value:_},module:{value:F.module},isWebWorker:{value:!0}}),A=new h(F.options),M()):U==="free"?A.free():U==="ready"?V=V.then(()=>A.ready):U==="reset"?V=V.then(()=>A.reset()):(Object.assign(Y0,A[U](Array.isArray(F)?F.map(Lt=>new Uint8Array(Lt)):new Uint8Array(F))),Fe=Y0.channelData?Y0.channelData.map(Lt=>Lt.buffer):[]),V.then(()=>self.postMessage(Y0,Fe))}}).toString()})(${n}, ${B}, ${e})`;try{a=typeof process.versions.node<"u"}catch{}i=a?`data:${o};base64,${Buffer.from(l).toString("base64")}`:URL.createObjectURL(new Blob([l],{type:o})),B.modules.set(n,i)}super(i,{name:s}),this._id=Number.MIN_SAFE_INTEGER,this._enqueuedOperations=new Map,this.onmessage=({data:o})=>{const{id:a,...l}=o;this._enqueuedOperations.get(a)(l),this._enqueuedOperations.delete(a)},new e(B).getModule().then(o=>{this.postToDecoder("init",{module:o,options:t})})}async postToDecoder(t,s){return new Promise(n=>{this.postMessage({command:t,id:this._id,data:s}),this._enqueuedOperations.set(this._id++,n)})}get ready(){return this.postToDecoder("ready")}async free(){await this.postToDecoder("free").finally(()=>{this.terminate()})}async reset(){await this.postToDecoder("reset")}}const Gs=(r,t)=>{Object.defineProperty(r,"name",{value:t})},w=Symbol,Ee=", ",u=(()=>{const r="front",t="side",s="rear",n="left",e="center",i="right";return["",r+" ",t+" ",s+" "].map(o=>[[n,i],[n,i,e],[n,e,i],[e,n,i],[e]].flatMap(a=>a.map(l=>o+l).join(Ee)))})(),X="LFE",W0="monophonic (mono)",w0="stereo",P0="surround",v=(r,...t)=>`${[W0,w0,`linear ${P0}`,"quadraphonic",`5.0 ${P0}`,`5.1 ${P0}`,`6.1 ${P0}`,`7.1 ${P0}`][r-1]} (${t.join(Ee)})`,ae=[W0,v(2,u[0][0]),v(3,u[0][2]),v(4,u[1][0],u[3][0]),v(5,u[1][2],u[3][0]),v(6,u[1][2],u[3][0],X),v(7,u[1][2],u[2][0],u[3][4],X),v(8,u[1][2],u[2][0],u[3][0],X)],as=192e3,ls=176400,De=96e3,Je=88200,hs=64e3,St=48e3,be=44100,de=32e3,pe=24e3,fe=22050,me=16e3,Re=12e3,ze=11025,_e=8e3,us=7350,C0="absoluteGranulePosition",m="bandwidth",t0="bitDepth",R="bitrate",It=R+"Maximum",Ht=R+"Minimum",Nt=R+"Nominal",j0="buffer",Et=j0+"Fullness",k="codec",e0=k+"Frames",lt="coupledStreamCount",gt="crc",Ve=gt+"16",We=gt+"32",P="data",b="description",y0="duration",K0="emphasis",Dt="hasOpusPadding",u0="header",N0="isContinuedPacket",Jt="isCopyrighted",E0="isFirstPage",Rt="isHome",b0="isLastPage",S0="isOriginal",x0="isPrivate",zt="isVbr",z="layer",c="length",p="mode",a0=p+"Extension",je="mpeg",T0=je+"Version",Vt="numberAACFrames",Wt="outputGain",ht="preSkip",jt="profile",qt=w(),$0="protection",bs="rawData",l0="segments",C="subarray",D0="version",xt="vorbis",ut=xt+"Comments",bt=xt+"Setup",Tt="block",Gt=Tt+"ingStrategy",Zt=w(),r0=Tt+"Size",L0=Tt+"size0",I0=Tt+"size1",X0=w(),$t="channel",o0=$t+"MappingFamily",dt=$t+"MappingTable",s0=$t+"Mode",Q0=w(),d=$t+"s",qe="copyright",Yt=qe+"Id",Kt=qe+"IdStart",p0="frame",g0=p0+"Count",n0=p0+"Length",Ft="Number",J0=p0+Ft,Z=p0+"Padding",f=p0+"Size",Ge="Rate",Xt="inputSample"+Ge,Ue="page",pt=Ue+"Checksum",yt=w(),H0=Ue+"SegmentTable",H=Ue+"Sequence"+Ft,ge="sample",Qt=ge+Ft,$=ge+Ge,Y=w(),O=ge+"s",vt="stream",ft=vt+"Count",Ze=vt+"Info",F0=vt+"Serial"+Ft,ds=vt+"StructureVersion",ye="total",mt=ye+"BytesOut",_t=ye+"Duration",le=ye+"Samples",T=w(),Q=w(),te=w(),At=w(),v0=w(),Ye=w(),Ae=w(),Mt=w(),I=w(),M0=w(),f0=w(),q0=w(),Bt=w(),Ke=w(),d0=w(),A0=w(),B0=w(),Xe=w(),j=Uint8Array,kt=DataView,y="reserved",J="bad",O0="free",we="none",Qe="16bit CRC",Ce=(r,t,s)=>{for(let n=0;n<r[c];n++){let e=t(n);for(let i=8;i>0;i--)e=s(e);r[n]=e}return r},ps=Ce(new j(256),r=>r,r=>r&128?7^r<<1:r<<1),S=[Ce(new Uint16Array(256),r=>r<<8,r=>r<<1^(r&32768?32773:0))],x=[Ce(new Uint32Array(256),r=>r,r=>r>>>1^(r&1)*3988292384)];for(let r=0;r<15;r++){S.push(new Uint16Array(256)),x.push(new Uint32Array(256));for(let t=0;t<=255;t++)S[r+1][t]=S[0][S[r][t]>>>8]^S[r][t]<<8,x[r+1][t]=x[r][t]>>>8^x[0][x[r][t]&255]}const fs=r=>{let t=0;const s=r[c];for(let n=0;n!==s;n++)t=ps[t^r[n]];return t},ms=r=>{const t=r[c],s=t-16;let n=0,e=0;for(;e<=s;)n^=r[e++]<<8|r[e++],n=S[15][n>>8]^S[14][n&255]^S[13][r[e++]]^S[12][r[e++]]^S[11][r[e++]]^S[10][r[e++]]^S[9][r[e++]]^S[8][r[e++]]^S[7][r[e++]]^S[6][r[e++]]^S[5][r[e++]]^S[4][r[e++]]^S[3][r[e++]]^S[2][r[e++]]^S[1][r[e++]]^S[0][r[e++]];for(;e!==t;)n=(n&255)<<8^S[0][n>>8^r[e++]];return n},_s=r=>{const t=r[c],s=t-16;let n=0,e=0;for(;e<=s;)n=x[15][(r[e++]^n)&255]^x[14][(r[e++]^n>>>8)&255]^x[13][(r[e++]^n>>>16)&255]^x[12][r[e++]^n>>>24]^x[11][r[e++]]^x[10][r[e++]]^x[9][r[e++]]^x[8][r[e++]]^x[7][r[e++]]^x[6][r[e++]]^x[5][r[e++]]^x[4][r[e++]]^x[3][r[e++]]^x[2][r[e++]]^x[1][r[e++]]^x[0][r[e++]];for(;e!==t;)n=x[0][(n^r[e++])&255]^n>>>8;return n^-1},he=(...r)=>{const t=new j(r.reduce((s,n)=>s+n[c],0));return r.reduce((s,n)=>(t.set(n,s),s+n[c]),0),t},m0=r=>String.fromCharCode(...r),Me=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15],wt=r=>Me[r&15]<<4|Me[r>>4];class Us{constructor(t){this._data=t,this._pos=t[c]*8}set position(t){this._pos=t}get position(){return this._pos}read(t){const s=Math.floor(this._pos/8),n=this._pos%8;return this._pos-=t,(wt(this._data[s-1])<<8)+wt(this._data[s])>>7-n&255}}class gs{constructor(t,s){this._onCodecHeader=t,this._onCodecUpdate=s,this[d0]()}[A0](){this._isEnabled=!0}[d0](){this._headerCache=new Map,this._codecUpdateData=new WeakMap,this._codecHeaderSent=!1,this._codecShouldUpdate=!1,this._bitrate=null,this._isEnabled=!1}[Ke](t,s){if(this._onCodecUpdate){this._bitrate!==t&&(this._bitrate=t,this._codecShouldUpdate=!0);const n=this._codecUpdateData.get(this._headerCache.get(this._currentHeader));this._codecShouldUpdate&&n&&this._onCodecUpdate({bitrate:t,...n},s),this._codecShouldUpdate=!1}}[I](t){const s=this._headerCache.get(t);return s&&this._updateCurrentHeader(t),s}[M0](t,s,n){this._isEnabled&&(this._codecHeaderSent||(this._onCodecHeader({...s}),this._codecHeaderSent=!0),this._updateCurrentHeader(t),this._headerCache.set(t,s),this._codecUpdateData.set(s,n))}_updateCurrentHeader(t){this._onCodecUpdate&&t!==this._currentHeader&&(this._codecShouldUpdate=!0,this._currentHeader=t)}}const W=new WeakMap,i0=new WeakMap;class k0{constructor(t,s){this._codecParser=t,this._headerCache=s}*[Ae](){let t;do{if(t=yield*this.Frame[f0](this._codecParser,this._headerCache,0),t)return t;this._codecParser[Q](1)}while(!0)}*[Mt](t){let s=yield*this[Ae]();const n=i0.get(s)[c];if(t||this._codecParser._flushing||(yield*this.Header[I](this._codecParser,this._headerCache,n)))return this._headerCache[A0](),this._codecParser[Q](n),this._codecParser[At](s),s;this._codecParser[v0](`Missing ${p0} at ${n} bytes from current position.`,`Dropping current ${p0} and trying again.`),this._headerCache[d0](),this._codecParser[Q](1)}}class ts{constructor(t,s){i0.set(this,{[u0]:t}),this[P]=s}}class G0 extends ts{static*[f0](t,s,n,e,i){const o=yield*t[I](n,e,i);if(o){const a=W.get(o)[n0],l=W.get(o)[O],h=(yield*n[T](a,i))[C](0,a);return new s(o,h,l)}else return null}constructor(t,s,n){super(t,s),this[u0]=t,this[O]=n,this[y0]=n/t[$]*1e3,this[J0]=null,this[mt]=null,this[le]=null,this[_t]=null,i0.get(this)[c]=s[c]}}const ee="unsynchronizationFlag",se="extendedHeaderFlag",ne="experimentalFlag",ie="footerPresent";class Se{static*getID3v2Header(t,s,n){const i={};let o=yield*t[T](3,n);if(o[0]!==73||o[1]!==68||o[2]!==51||(o=yield*t[T](10,n),i[D0]=`id3v2.${o[3]}.${o[4]}`,o[5]&15)||(i[ee]=!!(o[5]&128),i[se]=!!(o[5]&64),i[ne]=!!(o[5]&32),i[ie]=!!(o[5]&16),o[6]&128||o[7]&128||o[8]&128||o[9]&128))return null;const a=o[6]<<21|o[7]<<14|o[8]<<7|o[9];return i[c]=10+a,new Se(i)}constructor(t){this[D0]=t[D0],this[ee]=t[ee],this[se]=t[se],this[ne]=t[ne],this[ie]=t[ie],this[c]=t[c]}}class Z0{constructor(t){W.set(this,t),this[t0]=t[t0],this[R]=null,this[d]=t[d],this[s0]=t[s0],this[$]=t[$]}}const es={0:[O0,O0,O0,O0,O0],16:[32,32,32,32,8],240:[J,J,J,J,J]},tt=(r,t,s)=>8*((r+s)%t+t)*(1<<(r+s)/t)-8*t*(t/8|0);for(let r=2;r<15;r++)es[r<<4]=[r*32,tt(r,4,0),tt(r,4,-1),tt(r,8,4),tt(r,8,0)];const ys=0,ws=1,Cs=2,Ss=3,Be=4,et="bands ",st=" to 31",ke={0:et+4+st,16:et+8+st,32:et+12+st,48:et+16+st},c0="bitrateIndex",R0="v2",Ut="v1",nt="Intensity stereo ",it=", MS stereo ",rt="on",ot="off",xs={0:nt+ot+it+ot,16:nt+rt+it+ot,32:nt+ot+it+rt,48:nt+rt+it+rt},re={0:{[b]:y},2:{[b]:"Layer III",[Z]:1,[a0]:xs,[Ut]:{[c0]:Cs,[O]:1152},[R0]:{[c0]:Be,[O]:576}},4:{[b]:"Layer II",[Z]:1,[a0]:ke,[O]:1152,[Ut]:{[c0]:ws},[R0]:{[c0]:Be}},6:{[b]:"Layer I",[Z]:4,[a0]:ke,[O]:384,[Ut]:{[c0]:ys},[R0]:{[c0]:Ss}}},oe="MPEG Version ",Pe="ISO/IEC ",Ts={0:{[b]:`${oe}2.5 (later extension of MPEG 2)`,[z]:R0,[$]:{0:ze,4:Re,8:_e,12:y}},8:{[b]:y},16:{[b]:`${oe}2 (${Pe}13818-3)`,[z]:R0,[$]:{0:fe,4:pe,8:me,12:y}},24:{[b]:`${oe}1 (${Pe}11172-3)`,[z]:Ut,[$]:{0:be,4:St,8:de,12:y}},length:c},$s={0:Qe,1:we},Fs={0:we,1:"50/15 ms",2:y,3:"CCIT J.17"},Oe={0:{[d]:2,[b]:w0},64:{[d]:2,[b]:"joint "+w0},128:{[d]:2,[b]:"dual channel"},192:{[d]:1,[b]:W0}};class z0 extends Z0{static*[I](t,s,n){const e={},i=yield*Se.getID3v2Header(t,s,n);i&&(yield*t[T](i[c],n),t[Q](i[c]));const o=yield*t[T](4,n),a=m0(o[C](0,4)),l=s[I](a);if(l)return new z0(l);if(o[0]!==255||o[1]<224)return null;const h=Ts[o[1]&24];if(h[b]===y)return null;const g=o[1]&6;if(re[g][b]===y)return null;const _={...re[g],...re[g][h[z]]};if(e[T0]=h[b],e[z]=_[b],e[O]=_[O],e[$0]=$s[o[1]&1],e[c]=4,e[R]=es[o[2]&240][_[c0]],e[R]===J||(e[$]=h[$][o[2]&12],e[$]===y)||(e[Z]=o[2]&2&&_[Z],e[x0]=!!(o[2]&1),e[n0]=Math.floor(125*e[R]*e[O]/e[$]+e[Z]),!e[n0]))return null;const A=o[3]&192;if(e[s0]=Oe[A][b],e[d]=Oe[A][d],e[a0]=_[a0][o[3]&48],e[Jt]=!!(o[3]&8),e[S0]=!!(o[3]&4),e[K0]=Fs[o[3]&3],e[K0]===y)return null;e[t0]=16;{const{length:M,frameLength:N,samples:E,...U}=e;s[M0](a,e,U)}return new z0(e)}constructor(t){super(t),this[R]=t[R],this[K0]=t[K0],this[Z]=t[Z],this[Jt]=t[Jt],this[S0]=t[S0],this[x0]=t[x0],this[z]=t[z],this[a0]=t[a0],this[T0]=t[T0],this[$0]=t[$0]}}class xe extends G0{static*[f0](t,s,n){return yield*super[f0](z0,xe,t,s,n)}constructor(t,s,n){super(t,s,n)}}class vs extends k0{constructor(t,s,n){super(t,s),this.Frame=xe,this.Header=z0,n(this[k])}get[k](){return je}*[q0](){return yield*this[Mt]()}}const As={0:"MPEG-4",8:"MPEG-2"},Ms={0:"valid",2:J,4:J,6:J},Bs={0:Qe,1:we},ks={0:"AAC Main",64:"AAC LC (Low Complexity)",128:"AAC SSR (Scalable Sample Rate)",192:"AAC LTP (Long Term Prediction)"},Ps={0:De,4:Je,8:hs,12:St,16:be,20:de,24:pe,28:fe,32:me,36:Re,40:ze,44:_e,48:us,52:y,56:y,60:"frequency is written explicitly"},Le={0:{[d]:0,[b]:"Defined in AOT Specific Config"},64:{[d]:1,[b]:W0},128:{[d]:2,[b]:v(2,u[0][0])},192:{[d]:3,[b]:v(3,u[1][3])},256:{[d]:4,[b]:v(4,u[1][3],u[3][4])},320:{[d]:5,[b]:v(5,u[1][3],u[3][0])},384:{[d]:6,[b]:v(6,u[1][3],u[3][0],X)},448:{[d]:8,[b]:v(8,u[1][3],u[2][0],u[3][0],X)}};class Pt extends Z0{static*[I](t,s,n){const e={},i=yield*t[T](7,n),o=m0([i[0],i[1],i[2],i[3]&252|i[6]&3]),a=s[I](o);if(a)Object.assign(e,a);else{if(i[0]!==255||i[1]<240||(e[T0]=As[i[1]&8],e[z]=Ms[i[1]&6],e[z]===J))return null;const h=i[1]&1;e[$0]=Bs[h],e[c]=h?7:9,e[qt]=i[2]&192,e[Y]=i[2]&60;const g=i[2]&2;if(e[jt]=ks[e[qt]],e[$]=Ps[e[Y]],e[$]===y)return null;e[x0]=!!g,e[Q0]=(i[2]<<8|i[3])&448,e[s0]=Le[e[Q0]][b],e[d]=Le[e[Q0]][d],e[S0]=!!(i[3]&32),e[Rt]=!!(i[3]&8),e[Yt]=!!(i[3]&8),e[Kt]=!!(i[3]&4),e[t0]=16,e[O]=1024,e[Vt]=i[6]&3;{const{length:_,channelModeBits:A,profileBits:M,sampleRateBits:N,frameLength:E,samples:U,numberAACFrames:F,...V}=e;s[M0](o,e,V)}}if(e[n0]=(i[3]<<11|i[4]<<3|i[5]>>5)&8191,!e[n0])return null;const l=(i[5]<<6|i[6]>>2)&2047;return e[Et]=l===2047?"VBR":l,new Pt(e)}constructor(t){super(t),this[Yt]=t[Yt],this[Kt]=t[Kt],this[Et]=t[Et],this[Rt]=t[Rt],this[S0]=t[S0],this[x0]=t[x0],this[z]=t[z],this[c]=t[c],this[T0]=t[T0],this[Vt]=t[Vt],this[jt]=t[jt],this[$0]=t[$0]}get audioSpecificConfig(){const t=W.get(this),s=t[qt]+64<<5|t[Y]<<5|t[Q0]>>3,n=new j(2);return new kt(n[j0]).setUint16(0,s,!1),n}}class Te extends G0{static*[f0](t,s,n){return yield*super[f0](Pt,Te,t,s,n)}constructor(t,s,n){super(t,s,n)}}class Os extends k0{constructor(t,s,n){super(t,s),this.Frame=Te,this.Header=Pt,n(this[k])}get[k](){return"aac"}*[q0](){return yield*this[Mt]()}}class h0 extends G0{static _getFrameFooterCrc16(t){return(t[t[c]-2]<<8)+t[t[c]-1]}static[Xe](t){const s=h0._getFrameFooterCrc16(t),n=ms(t[C](0,-2));return s===n}constructor(t,s,n){s[Ze]=n,s[Ve]=h0._getFrameFooterCrc16(t),super(s,t,W.get(s)[O])}}const ss="get from STREAMINFO metadata block",Ls={0:"Fixed",1:"Variable"},ns={0:y,16:192};for(let r=2;r<16;r++)ns[r<<4]=r<6?576*2**(r-2):2**r;const Is={0:ss,1:Je,2:ls,3:as,4:_e,5:me,6:fe,7:pe,8:de,9:be,10:St,11:De,15:J},Hs={0:{[d]:1,[b]:W0},16:{[d]:2,[b]:v(2,u[0][0])},32:{[d]:3,[b]:v(3,u[0][1])},48:{[d]:4,[b]:v(4,u[1][0],u[3][0])},64:{[d]:5,[b]:v(5,u[1][1],u[3][0])},80:{[d]:6,[b]:v(6,u[1][1],X,u[3][0])},96:{[d]:7,[b]:v(7,u[1][1],X,u[3][4],u[2][0])},112:{[d]:8,[b]:v(8,u[1][1],X,u[3][0],u[2][0])},128:{[d]:2,[b]:`${w0} (left, diff)`},144:{[d]:2,[b]:`${w0} (diff, right)`},160:{[d]:2,[b]:`${w0} (avg, diff)`},176:y,192:y,208:y,224:y,240:y},Ns={0:ss,2:8,4:12,6:y,8:16,10:20,12:24,14:y};class K extends Z0{static _decodeUTF8Int(t){if(t[0]>254)return null;if(t[0]<128)return{value:t[0],length:1};let s=1;for(let o=64;o&t[0];o>>=1)s++;let n=s-1,e=0,i=0;for(;n>0;i+=6,n--){if((t[n]&192)!==128)return null;e|=(t[n]&63)<<i}return e|=(t[n]&127>>s)<<i,{value:e,length:s}}static[B0](t,s){const n={[T]:function*(){return t}};return K[I](n,s,0).next().value}static*[I](t,s,n){let e=yield*t[T](6,n);if(e[0]!==255||!(e[1]===248||e[1]===249))return null;const i={},o=m0(e[C](0,4)),a=s[I](o);if(a)Object.assign(i,a);else{if(i[Zt]=e[1]&1,i[Gt]=Ls[i[Zt]],i[X0]=e[2]&240,i[Y]=e[2]&15,i[r0]=ns[i[X0]],i[r0]===y||(i[$]=Is[i[Y]],i[$]===J)||e[3]&1)return null;const h=Hs[e[3]&240];if(h===y||(i[d]=h[d],i[s0]=h[b],i[t0]=Ns[e[3]&14],i[t0]===y))return null}i[c]=5,e=yield*t[T](i[c]+8,n);const l=K._decodeUTF8Int(e[C](4));if(!l||(i[Zt]?i[Qt]=l.value:i[J0]=l.value,i[c]+=l[c],i[X0]===96?(e[c]<i[c]&&(e=yield*t[T](i[c],n)),i[r0]=e[i[c]-1]+1,i[c]+=1):i[X0]===112&&(e[c]<i[c]&&(e=yield*t[T](i[c],n)),i[r0]=(e[i[c]-1]<<8)+e[i[c]]+1,i[c]+=2),i[O]=i[r0],i[Y]===12?(e[c]<i[c]&&(e=yield*t[T](i[c],n)),i[$]=e[i[c]-1]*1e3,i[c]+=1):i[Y]===13?(e[c]<i[c]&&(e=yield*t[T](i[c],n)),i[$]=(e[i[c]-1]<<8)+e[i[c]],i[c]+=2):i[Y]===14&&(e[c]<i[c]&&(e=yield*t[T](i[c],n)),i[$]=((e[i[c]-1]<<8)+e[i[c]])*10,i[c]+=2),e[c]<i[c]&&(e=yield*t[T](i[c],n)),i[gt]=e[i[c]-1],i[gt]!==fs(e[C](0,i[c]-1))))return null;if(!a){const{blockingStrategyBits:h,frameNumber:g,sampleNumber:_,samples:A,sampleRateBits:M,blockSizeBits:N,crc:E,length:U,...F}=i;s[M0](o,i,F)}return new K(i)}constructor(t){super(t),this[Ve]=null,this[Gt]=t[Gt],this[r0]=t[r0],this[J0]=t[J0],this[Qt]=t[Qt],this[Ze]=null}}const Es=2,Ds=512*1024;class is extends k0{constructor(t,s,n){super(t,s),this.Frame=h0,this.Header=K,n(this[k])}get[k](){return"flac"}*_getNextFrameSyncOffset(t){const s=yield*this._codecParser[T](2,0),n=s[c]-2;for(;t<n;){if(s[t]===255){const i=s[t+1];if(i===248||i===249)break;i!==255&&t++}t++}return t}*[q0](){do{const t=yield*K[I](this._codecParser,this._headerCache,0);if(t){let s=W.get(t)[c]+Es;for(;s<=Ds;){if(this._codecParser._flushing||(yield*K[I](this._codecParser,this._headerCache,s))){let n=yield*this._codecParser[T](s);if(this._codecParser._flushing||(n=n[C](0,s)),h0[Xe](n)){const e=new h0(n,t);return this._headerCache[A0](),this._codecParser[Q](s),this._codecParser[At](e),e}}s=yield*this._getNextFrameSyncOffset(s+1)}this._codecParser[v0](`Unable to sync FLAC frame after searching ${s} bytes.`),this._codecParser[Q](s)}else this._codecParser[Q](yield*this._getNextFrameSyncOffset(1))}while(!0)}[Bt](t){return t[H]===0?(this._headerCache[A0](),this._streamInfo=t[P][C](13)):t[H]===1||(t[e0]=i0.get(t)[l0].map(s=>{const n=K[B0](s,this._headerCache);if(n)return new h0(s,n,this._streamInfo);this._codecParser[v0]("Failed to parse Ogg FLAC frame","Skipping invalid FLAC frame")}).filter(s=>!!s)),t}}class Ot{static*[I](t,s,n){const e={};let i=yield*t[T](28,n);if(i[0]!==79||i[1]!==103||i[2]!==103||i[3]!==83||(e[ds]=i[4],i[5]&248))return null;e[b0]=!!(i[5]&4),e[E0]=!!(i[5]&2),e[N0]=!!(i[5]&1);const a=new kt(j.from(i[C](0,28))[j0]);try{e[C0]=a.getBigInt64(6,!0)}catch{}e[F0]=a.getInt32(14,!0),e[H]=a.getInt32(18,!0),e[pt]=a.getInt32(22,!0);const l=i[26];e[c]=l+27,i=yield*t[T](e[c],n),e[n0]=0,e[H0]=[],e[yt]=j.from(i[C](27,e[c]));for(let h=0,g=0;h<l;h++){const _=e[yt][h];e[n0]+=_,g+=_,(_!==255||h===l-1)&&(e[H0].push(g),g=0)}return new Ot(e)}constructor(t){W.set(this,t),this[C0]=t[C0],this[N0]=t[N0],this[E0]=t[E0],this[b0]=t[b0],this[H0]=t[H0],this[H]=t[H],this[pt]=t[pt],this[F0]=t[F0]}}class $e extends ts{static*[f0](t,s,n){const e=yield*Ot[I](t,s,n);if(e){const i=W.get(e)[n0],o=W.get(e)[c],a=o+i,l=(yield*t[T](a,0))[C](0,a),h=l[C](o,a);return new $e(e,h,l)}else return null}constructor(t,s,n){super(t,s),i0.get(this)[c]=n[c],this[e0]=[],this[bs]=n,this[C0]=t[C0],this[We]=t[pt],this[y0]=0,this[N0]=t[N0],this[E0]=t[E0],this[b0]=t[b0],this[H]=t[H],this[O]=0,this[F0]=t[F0]}}class Ie extends G0{constructor(t,s){super(s,t,s[f]*s[g0]/1e3*s[$])}}const He={0:ae.slice(0,2),1:ae},D="SILK-only",L="CELT-only",ct="Hybrid",q="narrowband",at="medium-band",G="wideband",_0="super-wideband",U0="fullband",Js={0:{[p]:D,[m]:q,[f]:10},8:{[p]:D,[m]:q,[f]:20},16:{[p]:D,[m]:q,[f]:40},24:{[p]:D,[m]:q,[f]:60},32:{[p]:D,[m]:at,[f]:10},40:{[p]:D,[m]:at,[f]:20},48:{[p]:D,[m]:at,[f]:40},56:{[p]:D,[m]:at,[f]:60},64:{[p]:D,[m]:G,[f]:10},72:{[p]:D,[m]:G,[f]:20},80:{[p]:D,[m]:G,[f]:40},88:{[p]:D,[m]:G,[f]:60},96:{[p]:ct,[m]:_0,[f]:10},104:{[p]:ct,[m]:_0,[f]:20},112:{[p]:ct,[m]:U0,[f]:10},120:{[p]:ct,[m]:U0,[f]:20},128:{[p]:L,[m]:q,[f]:2.5},136:{[p]:L,[m]:q,[f]:5},144:{[p]:L,[m]:q,[f]:10},152:{[p]:L,[m]:q,[f]:20},160:{[p]:L,[m]:G,[f]:2.5},168:{[p]:L,[m]:G,[f]:5},176:{[p]:L,[m]:G,[f]:10},184:{[p]:L,[m]:G,[f]:20},192:{[p]:L,[m]:_0,[f]:2.5},200:{[p]:L,[m]:_0,[f]:5},208:{[p]:L,[m]:_0,[f]:10},216:{[p]:L,[m]:_0,[f]:20},224:{[p]:L,[m]:U0,[f]:2.5},232:{[p]:L,[m]:U0,[f]:5},240:{[p]:L,[m]:U0,[f]:10},248:{[p]:L,[m]:U0,[f]:20}};class V0 extends Z0{static[B0](t,s,n){const e={};if(e[d]=t[9],e[o0]=t[18],e[c]=e[o0]!==0?21+e[d]:19,t[c]<e[c])throw new Error("Out of data while inside an Ogg Page");const i=s[0]&3,o=i===3?2:1,a=m0(t[C](0,e[c]))+m0(s[C](0,o)),l=n[I](a);if(l)return new V0(l);if(a.substr(0,8)!=="OpusHead"||t[8]!==1)return null;e[P]=j.from(t[C](0,e[c]));const h=new kt(e[P][j0]);if(e[t0]=16,e[ht]=h.getUint16(10,!0),e[Xt]=h.getUint32(12,!0),e[$]=St,e[Wt]=h.getInt16(16,!0),e[o0]in He&&(e[s0]=He[e[o0]][e[d]-1],!e[s0]))return null;e[o0]!==0&&(e[ft]=t[19],e[lt]=t[20],e[dt]=[...t[C](21,e[d]+21)]);const g=Js[248&s[0]];switch(e[p]=g[p],e[m]=g[m],e[f]=g[f],i){case 0:e[g0]=1;break;case 1:case 2:e[g0]=2;break;case 3:e[zt]=!!(128&s[1]),e[Dt]=!!(64&s[1]),e[g0]=63&s[1];break;default:return null}{const{length:_,data:A,channelMappingFamily:M,...N}=e;n[M0](a,e,N)}return new V0(e)}constructor(t){super(t),this[P]=t[P],this[m]=t[m],this[o0]=t[o0],this[dt]=t[dt],this[lt]=t[lt],this[g0]=t[g0],this[f]=t[f],this[Dt]=t[Dt],this[Xt]=t[Xt],this[zt]=t[zt],this[p]=t[p],this[Wt]=t[Wt],this[ht]=t[ht],this[ft]=t[ft]}}class Rs extends k0{constructor(t,s,n){super(t,s),this.Frame=Ie,this.Header=V0,n(this[k]),this._identificationHeader=null}get[k](){return"opus"}[Bt](t){return t[H]===0?(this._headerCache[A0](),this._identificationHeader=t[P]):t[H]===1||(t[e0]=i0.get(t)[l0].map(s=>{const n=V0[B0](this._identificationHeader,s,this._headerCache);if(n)return new Ie(s,n);this._codecParser[Ye]("Failed to parse Ogg Opus Header","Not a valid Ogg Opus file")})),t}}class Ne extends G0{constructor(t,s,n){super(s,t,n)}}const ue={};for(let r=0;r<8;r++)ue[r+6]=2**(6+r);class Ct extends Z0{static[B0](t,s,n,e){if(t[c]<30)throw new Error("Out of data while inside an Ogg Page");const i=m0(t[C](0,30)),o=s[I](i);if(o)return new Ct(o);const a={[c]:30};if(i.substr(0,7)!=="vorbis")return null;a[P]=j.from(t[C](0,30));const l=new kt(a[P][j0]);if(a[D0]=l.getUint32(7,!0),a[D0]!==0||(a[d]=t[11],a[s0]=ae[a[d]-1]||"application defined",a[$]=l.getUint32(12,!0),a[It]=l.getInt32(16,!0),a[Nt]=l.getInt32(20,!0),a[Ht]=l.getInt32(24,!0),a[I0]=ue[(t[28]&240)>>4],a[L0]=ue[t[28]&15],a[L0]>a[I0])||t[29]!==1)return null;a[t0]=32,a[bt]=e,a[ut]=n;{const{length:h,data:g,version:_,vorbisSetup:A,vorbisComments:M,...N}=a;s[M0](i,a,N)}return new Ct(a)}constructor(t){super(t),this[It]=t[It],this[Ht]=t[Ht],this[Nt]=t[Nt],this[L0]=t[L0],this[I0]=t[I0],this[P]=t[P],this[ut]=t[ut],this[bt]=t[bt]}}class zs extends k0{constructor(t,s,n){super(t,s),this.Frame=Ne,n(this[k]),this._identificationHeader=null,this._setupComplete=!1,this._prevBlockSize=null}get[k](){return xt}[Bt](t){t[e0]=[];for(const s of i0.get(t)[l0])if(s[0]===1)this._headerCache[A0](),this._identificationHeader=t[P],this._setupComplete=!1;else if(s[0]===3)this._vorbisComments=s;else if(s[0]===5)this._vorbisSetup=s,this._mode=this._parseSetupHeader(s),this._setupComplete=!0;else if(this._setupComplete){const n=Ct[B0](this._identificationHeader,this._headerCache,this._vorbisComments,this._vorbisSetup);n?t[e0].push(new Ne(s,n,this._getSamples(s,n))):this._codecParser[logError]("Failed to parse Ogg Vorbis Header","Not a valid Ogg Vorbis file")}return t}_getSamples(t,s){const e=this._mode.blockFlags[t[0]>>1&this._mode.mask]?s[I0]:s[L0],i=this._prevBlockSize===null?0:(this._prevBlockSize+e)/4;return this._prevBlockSize=e,i}_parseSetupHeader(t){const s=new Us(t),n={count:0,blockFlags:[]};for(;(s.read(1)&1)!==1;);let e;for(;n.count<64&&s.position>0;){wt(s.read(8));let i=0;for(;s.read(8)===0&&i++<3;);if(i===4)e=s.read(7),n.blockFlags.unshift(e&1),s.position+=6,n.count++;else{((wt(e)&126)>>1)+1!==n.count&&this._codecParser[v0]("vorbis derived mode count did not match actual mode count");break}}return n.mask=(1<<Math.log2(n.count))-1,n}}class Vs{constructor(t,s,n){this._codecParser=t,this._headerCache=s,this._onCodec=n,this._continuedPacket=new j,this._codec=null,this._isSupported=null}get[k](){return this._codec||""}_updateCodec(t,s){this._codec!==t&&(this._headerCache[d0](),this._parser=new s(this._codecParser,this._headerCache,this._onCodec),this._codec=t)}_checkCodecSupport({data:t}){const s=m0(t[C](0,8));switch(s){case"fishead\0":return!1;case"OpusHead":return this._updateCodec("opus",Rs),!0;case(/^\x7fFLAC/.test(s)&&s):return this._updateCodec("flac",is),!0;case(/^\x01vorbis/.test(s)&&s):return this._updateCodec(xt,zs),!0;default:return!1}}_checkPageSequenceNumber(t){t[H]!==this._pageSequenceNumber+1&&this._pageSequenceNumber>1&&t[H]>1&&this._codecParser[v0]("Unexpected gap in Ogg Page Sequence Number.",`Expected: ${this._pageSequenceNumber+1}, Got: ${t[H]}`),this._pageSequenceNumber=t[H]}_parsePage(t){this._isSupported===null&&(this._pageSequenceNumber=t[H],this._isSupported=this._checkCodecSupport(t)),this._checkPageSequenceNumber(t);const s=i0.get(t),n=W.get(s[u0]);let e=0;if(s[l0]=n[H0].map(i=>t[P][C](e,e+=i)),this._continuedPacket[c]&&(s[l0][0]=he(this._continuedPacket,s[l0][0]),this._continuedPacket=new j),n[yt][n[yt][c]-1]===255&&(this._continuedPacket=he(this._continuedPacket,s[l0].pop())),this._isSupported){const i=this._parser[Bt](t);return this._codecParser[At](i),i}else return t}}class Ws extends k0{constructor(t,s,n){super(t,s),this._onCodec=n,this.Frame=$e,this.Header=Ot,this._streams=new Map,this._currentSerialNumber=null}get[k](){const t=this._streams.get(this._currentSerialNumber);return t?t.codec:""}*[q0](){const t=yield*this[Mt](!0);this._currentSerialNumber=t[F0];let s=this._streams.get(this._currentSerialNumber);return s||(s=new Vs(this._codecParser,this._headerCache,this._onCodec),this._streams.set(this._currentSerialNumber,s)),t[b0]&&this._streams.delete(this._currentSerialNumber),s._parsePage(t)}}const ce=()=>{};class Zs{constructor(t,{onCodec:s,onCodecHeader:n,onCodecUpdate:e,enableLogging:i=!1,enableFrameCRC32:o=!0}={}){this._inputMimeType=t,this._onCodec=s||ce,this._onCodecHeader=n||ce,this._onCodecUpdate=e,this._enableLogging=i,this._crc32=o?_s:ce,this[d0]()}get[k](){return this._parser?this._parser[k]:""}[d0](){this._headerCache=new gs(this._onCodecHeader,this._onCodecUpdate),this._generator=this._getGenerator(),this._generator.next()}*flush(){this._flushing=!0;for(let t=this._generator.next();t.value;t=this._generator.next())yield t.value;this._flushing=!1,this[d0]()}*parseChunk(t){for(let s=this._generator.next(t);s.value;s=this._generator.next())yield s.value}parseAll(t){return[...this.parseChunk(t),...this.flush()]}*_getGenerator(){if(this._inputMimeType.match(/aac/))this._parser=new Os(this,this._headerCache,this._onCodec);else if(this._inputMimeType.match(/mpeg/))this._parser=new vs(this,this._headerCache,this._onCodec);else if(this._inputMimeType.match(/flac/))this._parser=new is(this,this._headerCache,this._onCodec);else if(this._inputMimeType.match(/ogg/))this._parser=new Ws(this,this._headerCache,this._onCodec);else throw new Error(`Unsupported Codec ${mimeType}`);for(this._frameNumber=0,this._currentReadPosition=0,this._totalBytesIn=0,this._totalBytesOut=0,this._totalSamples=0,this._sampleRate=void 0,this._rawData=new Uint8Array(0);;){const t=yield*this._parser[q0]();t&&(yield t)}}*[T](t=0,s=0){let n;for(;this._rawData[c]<=t+s;){if(n=yield,this._flushing)return this._rawData[C](s);n&&(this._totalBytesIn+=n[c],this._rawData=he(this._rawData,n))}return this._rawData[C](s)}[Q](t){this._currentReadPosition+=t,this._rawData=this._rawData[C](t)}[te](t){this._sampleRate=t[u0][$],t[u0][R]=t[y0]>0?Math.round(t[P][c]/t[y0])*8:0,t[J0]=this._frameNumber++,t[mt]=this._totalBytesOut,t[le]=this._totalSamples,t[_t]=this._totalSamples/this._sampleRate*1e3,t[We]=this._crc32(t[P]),this._headerCache[Ke](t[u0][R],t[_t]),this._totalBytesOut+=t[P][c],this._totalSamples+=t[O]}[At](t){t[e0]?(t[e0].forEach(s=>{t[y0]+=s[y0],t[O]+=s[O],this[te](s)}),t[le]=this._totalSamples,t[_t]=this._totalSamples/this._sampleRate*1e3||0,t[mt]=this._totalBytesOut):this[te](t)}_log(t,s){if(this._enableLogging){const n=[`${k}:         ${this[k]}`,`inputMimeType: ${this._inputMimeType}`,`readPosition:  ${this._currentReadPosition}`,`totalBytesIn:  ${this._totalBytesIn}`,`${mt}: ${this._totalBytesOut}`],e=Math.max(...n.map(i=>i[c]));s.push(`--stats--${"-".repeat(e-9)}`,...n,"-".repeat(e)),t("codec-parser",s.reduce((i,o)=>i+`
  `+o,""))}}[v0](...t){this._log(console.warn,t)}[Ye](...t){this._log(console.error,t)}}const Ys=C0,Ks=e0,Xs=lt,Qs=P,tn=u0,en=b0,sn=ht,nn=ut,rn=bt,on=dt,cn=d,an=O,ln=ft;export{Zs as C,B as W,rn as a,Ys as b,Ks as c,Qs as d,qs as e,Gs as f,cn as g,tn as h,en as i,ln as j,Xs as k,on as l,sn as p,an as s,nn as v};
