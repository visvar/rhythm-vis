var b5=Object.defineProperty;var g5=(e,t,n)=>t in e?b5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ft=(e,t,n)=>(g5(e,typeof t!="symbol"?t+"":t,n),n),om=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var Ke=(e,t,n)=>(om(e,t,"read from private field"),n?n.call(e):t.get(e)),Jt=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Pn=(e,t,n,r)=>(om(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var am=(e,t,n,r)=>({set _(i){Pn(e,t,i,n)},get _(){return Ke(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function ge(){}function ib(e){return e()}function sm(){return Object.create(null)}function Ve(e){e.forEach(ib)}function vo(e){return typeof e=="function"}function qe(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function y5(e){return Object.keys(e).length===0}function Zi(e){return e??""}function m(e,t){e.appendChild(t)}function fe(e,t,n){e.insertBefore(t,n||null)}function ce(e){e.parentNode&&e.parentNode.removeChild(e)}function Ue(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function q(e){return document.createTextNode(e)}function O(){return q(" ")}function ob(){return q("")}function ne(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function k(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ne(e){return e===""?null:+e}function _5(e){return Array.from(e.childNodes)}function he(e,t){t=""+t,e.data!==t&&(e.data=t)}function be(e,t){e.value=t??""}function St(e,t,n,r){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function $e(e,t,n){for(let r=0;r<e.options.length;r+=1){const i=e.options[r];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function pt(e){const t=e.querySelector(":checked");return t&&t.__value}function tl(e,t){return new e(t)}let fa;function ea(e){fa=e}function ab(){if(!fa)throw new Error("Function called outside component initialization");return fa}function st(e){ab().$$.on_mount.push(e)}function lt(e){ab().$$.on_destroy.push(e)}const Fi=[],xe=[];let Ui=[];const Jc=[],v5=Promise.resolve();let ef=!1;function w5(){ef||(ef=!0,v5.then(sb))}function at(e){Ui.push(e)}function tt(e){Jc.push(e)}const ec=new Set;let Ti=0;function sb(){if(Ti!==0)return;const e=fa;do{try{for(;Ti<Fi.length;){const t=Fi[Ti];Ti++,ea(t),M5(t.$$)}}catch(t){throw Fi.length=0,Ti=0,t}for(ea(null),Fi.length=0,Ti=0;xe.length;)xe.pop()();for(let t=0;t<Ui.length;t+=1){const n=Ui[t];ec.has(n)||(ec.add(n),n())}Ui.length=0}while(Fi.length);for(;Jc.length;)Jc.pop()();ef=!1,ec.clear(),ea(e)}function M5(e){if(e.fragment!==null){e.update(),Ve(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(at)}}function S5(e){const t=[],n=[];Ui.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Ui=t}const Us=new Set;let ti;function Jl(){ti={r:0,c:[],p:ti}}function eu(){ti.r||Ve(ti.c),ti=ti.p}function _e(e,t){e&&e.i&&(Us.delete(e),e.i(t))}function Me(e,t,n,r){if(e&&e.o){if(Us.has(e))return;Us.add(e),ti.c.push(()=>{Us.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Pe(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function nt(e,t,n){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function Ae(e){e&&e.c()}function Se(e,t,n){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,n),at(()=>{const o=e.$$.on_mount.map(ib).filter(vo);e.$$.on_destroy?e.$$.on_destroy.push(...o):Ve(o),e.$$.on_mount=[]}),i.forEach(at)}function Ee(e,t){const n=e.$$;n.fragment!==null&&(S5(n.after_update),Ve(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function E5(e,t){e.$$.dirty[0]===-1&&(Fi.push(e),w5(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ze(e,t,n,r,i,o,a=null,s=[-1]){const l=fa;ea(e);const u=e.$$={fragment:null,ctx:[],props:o,update:ge,not_equal:i,bound:sm(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:sm(),dirty:s,skip_bound:!1,root:t.target||l.$$.root};a&&a(u.root);let c=!1;if(u.ctx=n?n(e,t.props||{},(f,h,...d)=>{const p=d.length?d[0]:h;return u.ctx&&i(u.ctx[f],u.ctx[f]=p)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](p),c&&E5(e,f)),h}):[],u.update(),c=!0,Ve(u.before_update),u.fragment=r?r(u.ctx):!1,t.target){if(t.hydrate){const f=_5(t.target);u.fragment&&u.fragment.l(f),f.forEach(ce)}else u.fragment&&u.fragment.c();t.intro&&_e(e.$$.fragment),Se(e,t.target,t.anchor),sb()}ea(l)}class He{constructor(){Ft(this,"$$");Ft(this,"$$set")}$destroy(){Ee(this,1),this.$destroy=ge}$on(t,n){if(!vo(n))return ge;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!y5(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const A5="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(A5);function tc(e,t,n){const r=new URLSearchParams(e.location.search);r.set(t,n);const i=`${e.location.protocol}//${e.location.host}${e.location.pathname}?${r.toString()}`;e.history.pushState({path:i},"",i)}function C5(e,t){return new URLSearchParams(e.location.search).get(t)}function Vt(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ga(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tu(e){let t,n,r;e.length!==2?(t=Vt,n=(s,l)=>Vt(e(s),l),r=(s,l)=>e(s)-l):(t=e===Vt||e===Ga?e:P5,n=e,r=e);function i(s,l,u=0,c=s.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(s[f],l)<0?u=f+1:c=f}while(u<c)}return u}function o(s,l,u=0,c=s.length){if(u<c){if(t(l,l)!==0)return c;do{const f=u+c>>>1;n(s[f],l)<=0?u=f+1:c=f}while(u<c)}return u}function a(s,l,u=0,c=s.length){const f=i(s,l,u,c-1);return f>u&&r(s[f-1],l)>-r(s[f],l)?f-1:f}return{left:i,center:a,right:o}}function P5(){return 0}function lb(e){return e===null?NaN:+e}function*x5(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const N5=tu(Vt),nu=N5.right;tu(lb).center;function T5(e,t){let n=0;for(let r of e)r!=null&&(r=+r)>=r&&++n;return n}function I5(e){return e.length|0}function k5(e){return!(e>0)}function $5(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function D5(e){return t=>e(...t)}function F5(...e){const t=typeof e[e.length-1]=="function"&&D5(e.pop());e=e.map($5);const n=e.map(I5),r=e.length-1,i=new Array(r+1).fill(0),o=[];if(r<0||n.some(k5))return o;for(;;){o.push(i.map((s,l)=>e[l][s]));let a=r;for(;++i[a]===n[a];){if(a===0)return t?o.map(t):o;i[a--]=0}}}function B5(e,t){var n=0;return Float64Array.from(e,r=>n+=+r||0)}function ub(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i))}if(n>1)return o/(n-1)}function R5(e,t){const n=ub(e,t);return n&&Math.sqrt(n)}function Yt(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class li{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}class ui extends Map{constructor(t,n=hb){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(tf(this,t))}has(t){return super.has(tf(this,t))}set(t,n){return super.set(cb(this,t),n)}delete(t){return super.delete(fb(this,t))}}class Ua extends Set{constructor(t,n=hb){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(tf(this,t))}add(t){return super.add(cb(this,t))}delete(t){return super.delete(fb(this,t))}}function tf({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function cb({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function fb({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function hb(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ha(e){return e}function ru(e,...t){return iu(e,ha,ha,t)}function da(e,...t){return iu(e,Array.from,ha,t)}function qi(e,t,...n){return iu(e,ha,t,n)}function L5(e,t,...n){return iu(e,Array.from,t,n)}function iu(e,t,n,r){return function i(o,a){if(a>=r.length)return n(o);const s=new ui,l=r[a++];let u=-1;for(const c of o){const f=l(c,++u,o),h=s.get(f);h?h.push(c):s.set(f,[c])}for(const[c,f]of s)s.set(c,i(f,a));return t(s)}(e,0)}function O5(e,t){return Array.from(t,n=>e[n])}function nl(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,o)=>o);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,o)=>{for(const a of t){const s=rl(a[i],a[o]);if(s)return s}})):(n=e.map(n),r.sort((i,o)=>rl(n[i],n[o]))),O5(e,r)}return e.sort(db(n))}function db(e=Vt){if(e===Vt)return rl;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function rl(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Mh(e,t,n){return(t.length!==2?nl(qi(e,t,n),([r,i],[o,a])=>Vt(i,a)||Vt(r,o)):nl(ru(e,n),([r,i],[o,a])=>t(i,a)||Vt(r,o))).map(([r])=>r)}var G5=Array.prototype,U5=G5.slice;function nc(e){return()=>e}const q5=Math.sqrt(50),z5=Math.sqrt(10),H5=Math.sqrt(2);function il(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=q5?10:o>=z5?5:o>=H5?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=n&&n<2?il(e,t,n*2):[s,l,u]}function ma(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,a]=r?il(t,e,n):il(e,t,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function Qi(e,t,n){return t=+t,e=+e,n=+n,il(e,t,n)[2]}function nf(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Qi(t,e,n):Qi(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function V5(e,t,n){let r;for(;;){const i=Qi(e,t,n);if(i===r||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function Y5(e){return Math.max(1,Math.ceil(Math.log(T5(e))/Math.LN2)+1)}function mb(){var e=ha,t=Yt,n=Y5;function r(i){Array.isArray(i)||(i=Array.from(i));var o,a=i.length,s,l,u=new Array(a);for(o=0;o<a;++o)u[o]=e(i[o],o,i);var c=t(u),f=c[0],h=c[1],d=n(u,f,h);if(!Array.isArray(d)){const M=h,g=+d;if(t===Yt&&([f,h]=V5(f,h,g)),d=ma(f,h,g),d[0]<=f&&(l=Qi(f,h,g)),d[d.length-1]>=h)if(M>=h&&t===Yt){const w=Qi(f,h,g);isFinite(w)&&(w>0?h=(Math.floor(h/w)+1)*w:w<0&&(h=(Math.ceil(h*-w)+1)/-w))}else d.pop()}for(var p=d.length,b=0,y=p;d[b]<=f;)++b;for(;d[y-1]>h;)--y;(b||y<p)&&(d=d.slice(b,y),p=y-b);var _=new Array(p+1),v;for(o=0;o<=p;++o)v=_[o]=[],v.x0=o>0?d[o-1]:f,v.x1=o<p?d[o]:h;if(isFinite(l)){if(l>0)for(o=0;o<a;++o)(s=u[o])!=null&&f<=s&&s<=h&&_[Math.min(p,Math.floor((s-f)/l))].push(i[o]);else if(l<0){for(o=0;o<a;++o)if((s=u[o])!=null&&f<=s&&s<=h){const M=Math.floor((f-s)*l);_[Math.min(p,M+(d[M]<=s))].push(i[o])}}}else for(o=0;o<a;++o)(s=u[o])!=null&&f<=s&&s<=h&&_[nu(d,s,0,p)].push(i[o]);return _}return r.value=function(i){return arguments.length?(e=typeof i=="function"?i:nc(i),r):e},r.domain=function(i){return arguments.length?(t=typeof i=="function"?i:nc([i[0],i[1]]),r):t},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:nc(Array.isArray(i)?U5.call(i):i),r):n},r}function ot(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function W5(e,t){let n,r=-1,i=-1;if(t===void 0)for(const o of e)++i,o!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of e)(o=t(o,++i,e))!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);return r}function Gt(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function pb(e,t){let n,r=-1,i=-1;if(t===void 0)for(const o of e)++i,o!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of e)(o=t(o,++i,e))!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);return r}function bb(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?rl:db(i);r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),f=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*f*(l-f)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(t-u*f/l+h)),p=Math.min(r,Math.floor(t+(l-u)*f/l+h));bb(e,t,d,p,i)}const o=e[t];let a=n,s=r;for(ko(e,n,t),i(e[r],o)>0&&ko(e,n,r);a<s;){for(ko(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[n],o)===0?ko(e,n,s):(++s,ko(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function ko(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function gb(e,t=Vt){let n,r=!1;if(t.length===1){let i;for(const o of e){const a=t(o);(r?Vt(a,i)>0:Vt(a,a)===0)&&(n=o,i=a,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function ol(e,t,n){if(e=Float64Array.from(x5(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Gt(e);if(t>=1)return ot(e);var r,i=(r-1)*t,o=Math.floor(i),a=ot(bb(e,o).subarray(0,o+1)),s=Gt(e.subarray(o+1));return a+(s-a)*(i-o)}}function j5(e,t,n=lb){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function yb(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function al(e,t){return ol(e,.5,t)}function*X5(e){for(const t of e)yield*t}function _b(e){return Array.from(X5(e))}function K5(e,t){const n=new ui;if(t===void 0)for(let o of e)o!=null&&o>=o&&n.set(o,(n.get(o)||0)+1);else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&a>=a&&n.set(a,(n.get(a)||0)+1)}let r,i=0;for(const[o,a]of n)a>i&&(i=a,r=o);return r}function Z5(e,t=Q5){const n=[];let r,i=!1;for(const o of e)i&&n.push(t(r,o)),r=o,i=!0;return n}function Q5(e,t){return[e,t]}function Ce(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Br(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function sl(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function ll(e,...t){e=new Ua(e);for(const n of t)for(const r of n)e.delete(r);return e}function J5(e){return e}var e4=3,lm=1e-6;function t4(e){return"translate("+e+",0)"}function n4(e){return t=>+e(t)}function r4(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function i4(){return!this.__axis}function o4(e,t){var n=[],r=null,i=null,o=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=1,c="y",f=t4;function h(d){var p=r??(t.ticks?t.ticks.apply(t,n):t.domain()),b=i??(t.tickFormat?t.tickFormat.apply(t,n):J5),y=Math.max(o,0)+s,_=t.range(),v=+_[0]+l,M=+_[_.length-1]+l,g=(t.bandwidth?r4:n4)(t.copy(),l),w=d.selection?d.selection():d,E=w.selectAll(".domain").data([null]),N=w.selectAll(".tick").data(p,t).order(),x=N.exit(),T=N.enter().append("g").attr("class","tick"),S=N.select("line"),P=N.select("text");E=E.merge(E.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),N=N.merge(T),S=S.merge(T.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),P=P.merge(T.append("text").attr("fill","currentColor").attr(c,u*y).attr("dy","0.71em")),d!==w&&(E=E.transition(d),N=N.transition(d),S=S.transition(d),P=P.transition(d),x=x.transition(d).attr("opacity",lm).attr("transform",function(I){return isFinite(I=g(I))?f(I+l):this.getAttribute("transform")}),T.attr("opacity",lm).attr("transform",function(I){var $=this.parentNode.__axis;return f(($&&isFinite($=$(I))?$:g(I))+l)})),x.remove(),E.attr("d",a?"M"+v+","+u*a+"V"+l+"H"+M+"V"+u*a:"M"+v+","+l+"H"+M),N.attr("opacity",1).attr("transform",function(I){return f(g(I)+l)}),S.attr(c+"2",u*o),P.attr(c,u*y).text(b),w.filter(i4).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),w.each(function(){this.__axis=g})}return h.scale=function(d){return arguments.length?(t=d,h):t},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),h):n.slice()},h.tickValues=function(d){return arguments.length?(r=d==null?null:Array.from(d),h):r&&r.slice()},h.tickFormat=function(d){return arguments.length?(i=d,h):i},h.tickSize=function(d){return arguments.length?(o=a=+d,h):o},h.tickSizeInner=function(d){return arguments.length?(o=+d,h):o},h.tickSizeOuter=function(d){return arguments.length?(a=+d,h):a},h.tickPadding=function(d){return arguments.length?(s=+d,h):s},h.offset=function(d){return arguments.length?(l=+d,h):l},h}function a4(e){return o4(e4,e)}var s4={value:()=>{}};function vb(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new qs(n)}function qs(e){this._=e}function l4(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}qs.prototype=vb.prototype={constructor:qs,on:function(e,t){var n=this._,r=l4(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=u4(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=um(n[i],e.name,t);else if(t==null)for(i in n)n[i]=um(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new qs(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function u4(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function um(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=s4,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var rf="http://www.w3.org/1999/xhtml";const Ji={svg:"http://www.w3.org/2000/svg",xhtml:rf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ou(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ji.hasOwnProperty(t)?{space:Ji[t],local:e}:e}function c4(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===rf&&t.documentElement.namespaceURI===rf?t.createElement(e):t.createElementNS(n,e)}}function f4(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function au(e){var t=ou(e);return(t.local?f4:c4)(t)}function h4(){}function Sh(e){return e==null?h4:function(){return this.querySelector(e)}}function d4(e){typeof e!="function"&&(e=Sh(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=e.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new tn(r,this._parents)}function m4(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function p4(){return[]}function wb(e){return e==null?p4:function(){return this.querySelectorAll(e)}}function b4(e){return function(){return m4(e.apply(this,arguments))}}function g4(e){typeof e=="function"?e=b4(e):e=wb(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(r.push(e.call(l,l.__data__,u,a)),i.push(l));return new tn(r,i)}function Mb(e){return function(){return this.matches(e)}}function Sb(e){return function(t){return t.matches(e)}}var y4=Array.prototype.find;function _4(e){return function(){return y4.call(this.children,e)}}function v4(){return this.firstElementChild}function w4(e){return this.select(e==null?v4:_4(typeof e=="function"?e:Sb(e)))}var M4=Array.prototype.filter;function S4(){return Array.from(this.children)}function E4(e){return function(){return M4.call(this.children,e)}}function A4(e){return this.selectAll(e==null?S4:E4(typeof e=="function"?e:Sb(e)))}function C4(e){typeof e!="function"&&(e=Mb(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new tn(r,this._parents)}function Eb(e){return new Array(e.length)}function P4(){return new tn(this._enter||this._groups.map(Eb),this._parents)}function ul(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ul.prototype={constructor:ul,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function x4(e){return function(){return e}}function N4(e,t,n,r,i,o){for(var a=0,s,l=t.length,u=o.length;a<u;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new ul(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function T4(e,t,n,r,i,o,a){var s,l,u=new Map,c=t.length,f=o.length,h=new Array(c),d;for(s=0;s<c;++s)(l=t[s])&&(h[s]=d=a.call(l,l.__data__,s,t)+"",u.has(d)?i[s]=l:u.set(d,l));for(s=0;s<f;++s)d=a.call(e,o[s],s,o)+"",(l=u.get(d))?(r[s]=l,l.__data__=o[s],u.delete(d)):n[s]=new ul(e,o[s]);for(s=0;s<c;++s)(l=t[s])&&u.get(h[s])===l&&(i[s]=l)}function I4(e){return e.__data__}function k4(e,t){if(!arguments.length)return Array.from(this,I4);var n=t?T4:N4,r=this._parents,i=this._groups;typeof e!="function"&&(e=x4(e));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],h=f.length,d=$4(e.call(c,c&&c.__data__,u,r)),p=d.length,b=s[u]=new Array(p),y=a[u]=new Array(p),_=l[u]=new Array(h);n(c,f,b,y,_,d,t);for(var v=0,M=0,g,w;v<p;++v)if(g=b[v]){for(v>=M&&(M=v+1);!(w=y[M])&&++M<p;);g._next=w||null}}return a=new tn(a,r),a._enter=s,a._exit=l,a}function $4(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function D4(){return new tn(this._exit||this._groups.map(Eb),this._parents)}function F4(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function B4(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u=n[l],c=r[l],f=u.length,h=s[l]=new Array(f),d,p=0;p<f;++p)(d=u[p]||c[p])&&(h[p]=d);for(;l<i;++l)s[l]=n[l];return new tn(s,this._parents)}function R4(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function L4(e){e||(e=O4);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,l=i[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(t)}return new tn(i,this._parents).order()}function O4(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function G4(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function U4(){return Array.from(this)}function q4(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function z4(){let e=0;for(const t of this)++e;return e}function H4(){return!this.node()}function V4(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function Y4(e){return function(){this.removeAttribute(e)}}function W4(e){return function(){this.removeAttributeNS(e.space,e.local)}}function j4(e,t){return function(){this.setAttribute(e,t)}}function X4(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function K4(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Z4(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Q4(e,t){var n=ou(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?W4:Y4:typeof t=="function"?n.local?Z4:K4:n.local?X4:j4)(n,t))}function Ab(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function J4(e){return function(){this.style.removeProperty(e)}}function e6(e,t,n){return function(){this.style.setProperty(e,t,n)}}function t6(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function n6(e,t,n){return arguments.length>1?this.each((t==null?J4:typeof t=="function"?t6:e6)(e,t,n??"")):eo(this.node(),e)}function eo(e,t){return e.style.getPropertyValue(t)||Ab(e).getComputedStyle(e,null).getPropertyValue(t)}function r6(e){return function(){delete this[e]}}function i6(e,t){return function(){this[e]=t}}function o6(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function a6(e,t){return arguments.length>1?this.each((t==null?r6:typeof t=="function"?o6:i6)(e,t)):this.node()[e]}function Cb(e){return e.trim().split(/^|\s+/)}function Eh(e){return e.classList||new Pb(e)}function Pb(e){this._node=e,this._names=Cb(e.getAttribute("class")||"")}Pb.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function xb(e,t){for(var n=Eh(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Nb(e,t){for(var n=Eh(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function s6(e){return function(){xb(this,e)}}function l6(e){return function(){Nb(this,e)}}function u6(e,t){return function(){(t.apply(this,arguments)?xb:Nb)(this,e)}}function c6(e,t){var n=Cb(e+"");if(arguments.length<2){for(var r=Eh(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?u6:t?s6:l6)(n,t))}function f6(){this.textContent=""}function h6(e){return function(){this.textContent=e}}function d6(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function m6(e){return arguments.length?this.each(e==null?f6:(typeof e=="function"?d6:h6)(e)):this.node().textContent}function p6(){this.innerHTML=""}function b6(e){return function(){this.innerHTML=e}}function g6(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function y6(e){return arguments.length?this.each(e==null?p6:(typeof e=="function"?g6:b6)(e)):this.node().innerHTML}function _6(){this.nextSibling&&this.parentNode.appendChild(this)}function v6(){return this.each(_6)}function w6(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function M6(){return this.each(w6)}function S6(e){var t=typeof e=="function"?e:au(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function E6(){return null}function A6(e,t){var n=typeof e=="function"?e:au(e),r=t==null?E6:typeof t=="function"?t:Sh(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function C6(){var e=this.parentNode;e&&e.removeChild(this)}function P6(){return this.each(C6)}function x6(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function N6(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function T6(e){return this.select(e?N6:x6)}function I6(e){return arguments.length?this.property("__data__",e):this.node().__data__}function k6(e){return function(t){e.call(this,t,this.__data__)}}function $6(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function D6(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function F6(e,t,n){return function(){var r=this.__on,i,o=k6(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function B6(e,t,n){var r=$6(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=t?F6:D6,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function Tb(e,t,n){var r=Ab(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function R6(e,t){return function(){return Tb(this,e,t)}}function L6(e,t){return function(){return Tb(this,e,t.apply(this,arguments))}}function O6(e,t){return this.each((typeof t=="function"?L6:R6)(e,t))}function*G6(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Ib=[null];function tn(e,t){this._groups=e,this._parents=t}function qa(){return new tn([[document.documentElement]],Ib)}function U6(){return this}tn.prototype=qa.prototype={constructor:tn,select:d4,selectAll:g4,selectChild:w4,selectChildren:A4,filter:C4,data:k4,enter:P4,exit:D4,join:F4,merge:B4,selection:U6,order:R4,sort:L4,call:G4,nodes:U4,node:q4,size:z4,empty:H4,each:V4,attr:Q4,style:n6,property:a6,classed:c6,text:m6,html:y6,raise:v6,lower:M6,append:S6,insert:A6,remove:P6,clone:T6,datum:I6,on:B6,dispatch:O6,[Symbol.iterator]:G6};function ta(e){return typeof e=="string"?new tn([[document.querySelector(e)]],[document.documentElement]):new tn([[e]],Ib)}function q6(e){let t;for(;t=e.sourceEvent;)e=t;return e}function z6(e,t){if(e=q6(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}function wo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function za(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Vr(){}var ci=.7,to=1/ci,zi="\\s*([+-]?\\d+)\\s*",pa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Kn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",H6=/^#([0-9a-f]{3,8})$/,V6=new RegExp(`^rgb\\(${zi},${zi},${zi}\\)$`),Y6=new RegExp(`^rgb\\(${Kn},${Kn},${Kn}\\)$`),W6=new RegExp(`^rgba\\(${zi},${zi},${zi},${pa}\\)$`),j6=new RegExp(`^rgba\\(${Kn},${Kn},${Kn},${pa}\\)$`),X6=new RegExp(`^hsl\\(${pa},${Kn},${Kn}\\)$`),K6=new RegExp(`^hsla\\(${pa},${Kn},${Kn},${pa}\\)$`),cm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wo(Vr,Rr,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:fm,formatHex:fm,formatHex8:Z6,formatHsl:Q6,formatRgb:hm,toString:hm});function fm(){return this.rgb().formatHex()}function Z6(){return this.rgb().formatHex8()}function Q6(){return kb(this).formatHsl()}function hm(){return this.rgb().formatRgb()}function Rr(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=H6.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?dm(t):n===3?new Et(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ws(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ws(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=V6.exec(e))?new Et(t[1],t[2],t[3],1):(t=Y6.exec(e))?new Et(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=W6.exec(e))?ws(t[1],t[2],t[3],t[4]):(t=j6.exec(e))?ws(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=X6.exec(e))?bm(t[1],t[2]/100,t[3]/100,1):(t=K6.exec(e))?bm(t[1],t[2]/100,t[3]/100,t[4]):cm.hasOwnProperty(e)?dm(cm[e]):e==="transparent"?new Et(NaN,NaN,NaN,0):null}function dm(e){return new Et(e>>16&255,e>>8&255,e&255,1)}function ws(e,t,n,r){return r<=0&&(e=t=n=NaN),new Et(e,t,n,r)}function Ah(e){return e instanceof Vr||(e=Rr(e)),e?(e=e.rgb(),new Et(e.r,e.g,e.b,e.opacity)):new Et}function Lr(e,t,n,r){return arguments.length===1?Ah(e):new Et(e,t,n,r??1)}function Et(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}wo(Et,Lr,za(Vr,{brighter(e){return e=e==null?to:Math.pow(to,e),new Et(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ci:Math.pow(ci,e),new Et(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Et(oi(this.r),oi(this.g),oi(this.b),cl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mm,formatHex:mm,formatHex8:J6,formatRgb:pm,toString:pm}));function mm(){return`#${ni(this.r)}${ni(this.g)}${ni(this.b)}`}function J6(){return`#${ni(this.r)}${ni(this.g)}${ni(this.b)}${ni((isNaN(this.opacity)?1:this.opacity)*255)}`}function pm(){const e=cl(this.opacity);return`${e===1?"rgb(":"rgba("}${oi(this.r)}, ${oi(this.g)}, ${oi(this.b)}${e===1?")":`, ${e})`}`}function cl(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function oi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ni(e){return e=oi(e),(e<16?"0":"")+e.toString(16)}function bm(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Tn(e,t,n,r)}function kb(e){if(e instanceof Tn)return new Tn(e.h,e.s,e.l,e.opacity);if(e instanceof Vr||(e=Rr(e)),!e)return new Tn;if(e instanceof Tn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new Tn(a,s,l,e.opacity)}function of(e,t,n,r){return arguments.length===1?kb(e):new Tn(e,t,n,r??1)}function Tn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}wo(Tn,of,za(Vr,{brighter(e){return e=e==null?to:Math.pow(to,e),new Tn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ci:Math.pow(ci,e),new Tn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Et(rc(e>=240?e-240:e+120,i,r),rc(e,i,r),rc(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Tn(gm(this.h),Ms(this.s),Ms(this.l),cl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=cl(this.opacity);return`${e===1?"hsl(":"hsla("}${gm(this.h)}, ${Ms(this.s)*100}%, ${Ms(this.l)*100}%${e===1?")":`, ${e})`}`}}));function gm(e){return e=(e||0)%360,e<0?e+360:e}function Ms(e){return Math.max(0,Math.min(1,e||0))}function rc(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const $b=Math.PI/180,Db=180/Math.PI,fl=18,Fb=.96422,Bb=1,Rb=.82521,Lb=4/29,Hi=6/29,Ob=3*Hi*Hi,e7=Hi*Hi*Hi;function Gb(e){if(e instanceof Zn)return new Zn(e.l,e.a,e.b,e.opacity);if(e instanceof hr)return Ub(e);e instanceof Et||(e=Ah(e));var t=sc(e.r),n=sc(e.g),r=sc(e.b),i=ic((.2225045*t+.7168786*n+.0606169*r)/Bb),o,a;return t===n&&n===r?o=a=i:(o=ic((.4360747*t+.3850649*n+.1430804*r)/Fb),a=ic((.0139322*t+.0971045*n+.7141733*r)/Rb)),new Zn(116*i-16,500*(o-i),200*(i-a),e.opacity)}function af(e,t,n,r){return arguments.length===1?Gb(e):new Zn(e,t,n,r??1)}function Zn(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}wo(Zn,af,za(Vr,{brighter(e){return new Zn(this.l+fl*(e??1),this.a,this.b,this.opacity)},darker(e){return new Zn(this.l-fl*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Fb*oc(t),e=Bb*oc(e),n=Rb*oc(n),new Et(ac(3.1338561*t-1.6168667*e-.4906146*n),ac(-.9787684*t+1.9161415*e+.033454*n),ac(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function ic(e){return e>e7?Math.pow(e,1/3):e/Ob+Lb}function oc(e){return e>Hi?e*e*e:Ob*(e-Lb)}function ac(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function sc(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function t7(e){if(e instanceof hr)return new hr(e.h,e.c,e.l,e.opacity);if(e instanceof Zn||(e=Gb(e)),e.a===0&&e.b===0)return new hr(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Db;return new hr(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function sf(e,t,n,r){return arguments.length===1?t7(e):new hr(e,t,n,r??1)}function hr(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Ub(e){if(isNaN(e.h))return new Zn(e.l,0,0,e.opacity);var t=e.h*$b;return new Zn(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}wo(hr,sf,za(Vr,{brighter(e){return new hr(this.h,this.c,this.l+fl*(e??1),this.opacity)},darker(e){return new hr(this.h,this.c,this.l-fl*(e??1),this.opacity)},rgb(){return Ub(this).rgb()}}));var qb=-.14861,Ch=1.78277,Ph=-.29227,su=-.90649,ba=1.97294,ym=ba*su,_m=ba*Ch,vm=Ch*Ph-su*qb;function n7(e){if(e instanceof ai)return new ai(e.h,e.s,e.l,e.opacity);e instanceof Et||(e=Ah(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(vm*r+ym*t-_m*n)/(vm+ym-_m),o=r-i,a=(ba*(n-i)-Ph*o)/su,s=Math.sqrt(a*a+o*o)/(ba*i*(1-i)),l=s?Math.atan2(a,o)*Db-120:NaN;return new ai(l<0?l+360:l,s,i,e.opacity)}function Jn(e,t,n,r){return arguments.length===1?n7(e):new ai(e,t,n,r??1)}function ai(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}wo(ai,Jn,za(Vr,{brighter(e){return e=e==null?to:Math.pow(to,e),new ai(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ci:Math.pow(ci,e),new ai(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*$b,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Et(255*(t+n*(qb*r+Ch*i)),255*(t+n*(Ph*r+su*i)),255*(t+n*(ba*r)),this.opacity)}}));function r7(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function i7(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return r7((n-r/t)*t,a,i,o,s)}}const lu=e=>()=>e;function zb(e,t){return function(n){return e+n*t}}function o7(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function xh(e,t){var n=t-e;return n?zb(e,n>180||n<-180?n-360*Math.round(n/360):n):lu(isNaN(e)?t:e)}function a7(e){return(e=+e)==1?kt:function(t,n){return n-t?o7(t,n,e):lu(isNaN(t)?n:t)}}function kt(e,t){var n=t-e;return n?zb(e,n):lu(isNaN(e)?t:e)}const fi=function e(t){var n=a7(t);function r(i,o){var a=n((i=Lr(i)).r,(o=Lr(o)).r),s=n(i.g,o.g),l=n(i.b,o.b),u=kt(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function s7(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Lr(t[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=e(r),i=e(i),o=e(o),s.opacity=1,function(l){return s.r=r(l),s.g=i(l),s.b=o(l),s+""}}}var l7=s7(i7);function u7(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function c7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function f7(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Ha(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function h7(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function It(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function d7(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ha(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var lf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lc=new RegExp(lf.source,"g");function m7(e){return function(){return e}}function p7(e){return function(t){return e(t)+""}}function Hb(e,t){var n=lf.lastIndex=lc.lastIndex=0,r,i,o,a=-1,s=[],l=[];for(e=e+"",t=t+"";(r=lf.exec(e))&&(i=lc.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:It(r,i)})),n=lc.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?p7(l[0].x):m7(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}function Ha(e,t){var n=typeof t,r;return t==null||n==="boolean"?lu(t):(n==="number"?It:n==="string"?(r=Rr(t))?(t=r,fi):Hb:t instanceof Rr?fi:t instanceof Date?h7:c7(t)?u7:Array.isArray(t)?f7:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?d7:It)(e,t)}function Nh(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var wm=180/Math.PI,uf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Vb(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*wm,skewX:Math.atan(l)*wm,scaleX:a,scaleY:s}}var Ss;function b7(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uf:Vb(t.a,t.b,t.c,t.d,t.e,t.f)}function g7(e){return e==null||(Ss||(Ss=document.createElementNS("http://www.w3.org/2000/svg","g")),Ss.setAttribute("transform",e),!(e=Ss.transform.baseVal.consolidate()))?uf:(e=e.matrix,Vb(e.a,e.b,e.c,e.d,e.e,e.f))}function Yb(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,h,d,p){if(u!==f||c!==h){var b=d.push("translate(",null,t,null,n);p.push({i:b-4,x:It(u,f)},{i:b-2,x:It(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:It(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:It(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var b=d.push(i(d)+"scale(",null,",",null,")");p.push({i:b-4,x:It(u,f)},{i:b-2,x:It(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),s(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,b=h.length,y;++p<b;)f[(y=h[p]).i]=y.x(d);return f.join("")}}}var y7=Yb(b7,"px, ","px)","deg)"),_7=Yb(g7,", ",")",")");function v7(e){return function(t,n){var r=e((t=of(t)).h,(n=of(n)).h),i=kt(t.s,n.s),o=kt(t.l,n.l),a=kt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=o(s),t.opacity=a(s),t+""}}}const w7=v7(xh);function M7(e,t){var n=kt((e=af(e)).l,(t=af(t)).l),r=kt(e.a,t.a),i=kt(e.b,t.b),o=kt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=o(a),e+""}}function S7(e){return function(t,n){var r=e((t=sf(t)).h,(n=sf(n)).h),i=kt(t.c,n.c),o=kt(t.l,n.l),a=kt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=o(s),t.opacity=a(s),t+""}}}const E7=S7(xh);function Wb(e){return function t(n){n=+n;function r(i,o){var a=e((i=Jn(i)).h,(o=Jn(o)).h),s=kt(i.s,o.s),l=kt(i.l,o.l),u=kt(i.opacity,o.opacity);return function(c){return i.h=a(c),i.s=s(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}Wb(xh);var Th=Wb(kt);function uu(e,t){t===void 0&&(t=e,e=Ha);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(a){var s=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return o[s](a-s)}}function $n(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var no=0,Uo=0,$o=0,jb=1e3,hl,qo,dl=0,hi=0,cu=0,ga=typeof performance=="object"&&performance.now?performance:Date,Xb=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ih(){return hi||(Xb(A7),hi=ga.now()+cu)}function A7(){hi=0}function ml(){this._call=this._time=this._next=null}ml.prototype=Kb.prototype={constructor:ml,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ih():+n)+(t==null?0:+t),!this._next&&qo!==this&&(qo?qo._next=this:hl=this,qo=this),this._call=e,this._time=n,cf()},stop:function(){this._call&&(this._call=null,this._time=1/0,cf())}};function Kb(e,t,n){var r=new ml;return r.restart(e,t,n),r}function C7(){Ih(),++no;for(var e=hl,t;e;)(t=hi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--no}function Mm(){hi=(dl=ga.now())+cu,no=Uo=0;try{C7()}finally{no=0,x7(),hi=0}}function P7(){var e=ga.now(),t=e-dl;t>jb&&(cu-=t,dl=e)}function x7(){for(var e,t=hl,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:hl=n);qo=e,cf(r)}function cf(e){if(!no){Uo&&(Uo=clearTimeout(Uo));var t=e-hi;t>24?(e<1/0&&(Uo=setTimeout(Mm,e-ga.now()-cu)),$o&&($o=clearInterval($o))):($o||(dl=ga.now(),$o=setInterval(P7,jb)),no=1,Xb(Mm))}}function Sm(e,t,n){var r=new ml;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var N7=vb("start","end","cancel","interrupt"),T7=[],Zb=0,Em=1,ff=2,zs=3,Am=4,hf=5,Hs=6;function fu(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;I7(e,n,{name:t,index:r,group:i,on:N7,tween:T7,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Zb})}function kh(e,t){var n=Ln(e,t);if(n.state>Zb)throw new Error("too late; already scheduled");return n}function nr(e,t){var n=Ln(e,t);if(n.state>zs)throw new Error("too late; already running");return n}function Ln(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function I7(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Kb(o,0,n.time);function o(u){n.state=Em,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,f,h,d;if(n.state!==Em)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===zs)return Sm(a);d.state===Am?(d.state=Hs,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[c]):+c<t&&(d.state=Hs,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[c])}if(Sm(function(){n.state===zs&&(n.state=Am,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=ff,n.on.call("start",e,e.__data__,n.index,n.group),n.state===ff){for(n.state=zs,i=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=hf,1),f=-1,h=i.length;++f<h;)i[f].call(e,c);n.state===hf&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Hs,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function k7(e,t){var n=e.__transition,r,i,o=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>ff&&r.state<hf,r.state=Hs,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function $7(e){return this.each(function(){k7(this,e)})}function D7(e,t){var n,r;return function(){var i=nr(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function F7(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=nr(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function B7(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ln(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?D7:F7)(n,e,t))}function $h(e,t,n){var r=e._id;return e.each(function(){var i=nr(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Ln(i,r).value[t]}}function Qb(e,t){var n;return(typeof t=="number"?It:t instanceof Rr?fi:(n=Rr(t))?(t=n,fi):Hb)(e,t)}function R7(e){return function(){this.removeAttribute(e)}}function L7(e){return function(){this.removeAttributeNS(e.space,e.local)}}function O7(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function G7(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function U7(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function q7(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function z7(e,t){var n=ou(e),r=n==="transform"?_7:Qb;return this.attrTween(e,typeof t=="function"?(n.local?q7:U7)(n,r,$h(this,"attr."+e,t)):t==null?(n.local?L7:R7)(n):(n.local?G7:O7)(n,r,t))}function H7(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function V7(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Y7(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&V7(e,o)),n}return i._value=t,i}function W7(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&H7(e,o)),n}return i._value=t,i}function j7(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=ou(e);return this.tween(n,(r.local?Y7:W7)(r,t))}function X7(e,t){return function(){kh(this,e).delay=+t.apply(this,arguments)}}function K7(e,t){return t=+t,function(){kh(this,e).delay=t}}function Z7(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?X7:K7)(t,e)):Ln(this.node(),t).delay}function Q7(e,t){return function(){nr(this,e).duration=+t.apply(this,arguments)}}function J7(e,t){return t=+t,function(){nr(this,e).duration=t}}function eM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Q7:J7)(t,e)):Ln(this.node(),t).duration}function tM(e,t){if(typeof t!="function")throw new Error;return function(){nr(this,e).ease=t}}function nM(e){var t=this._id;return arguments.length?this.each(tM(t,e)):Ln(this.node(),t).ease}function rM(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;nr(this,e).ease=n}}function iM(e){if(typeof e!="function")throw new Error;return this.each(rM(this._id,e))}function oM(e){typeof e!="function"&&(e=Mb(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new br(r,this._parents,this._name,this._id)}function aM(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=t[s],u=n[s],c=l.length,f=a[s]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;s<r;++s)a[s]=t[s];return new br(a,this._parents,this._name,this._id)}function sM(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function lM(e,t,n){var r,i,o=sM(t)?kh:nr;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function uM(e,t){var n=this._id;return arguments.length<2?Ln(this.node(),n).on.on(e):this.each(lM(n,e,t))}function cM(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function fM(){return this.on("end.remove",cM(this._id))}function hM(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Sh(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],l=s.length,u=o[a]=new Array(l),c,f,h=0;h<l;++h)(c=s[h])&&(f=e.call(c,c.__data__,h,s))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,fu(u[h],t,n,h,u,Ln(c,n)));return new br(o,this._parents,t,n)}function dM(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wb(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,f=0;f<u;++f)if(c=l[f]){for(var h=e.call(c,c.__data__,f,l),d,p=Ln(c,n),b=0,y=h.length;b<y;++b)(d=h[b])&&fu(d,t,n,b,h,p);o.push(h),a.push(c)}return new br(o,a,t,n)}var mM=qa.prototype.constructor;function pM(){return new mM(this._groups,this._parents)}function bM(e,t){var n,r,i;return function(){var o=eo(this,e),a=(this.style.removeProperty(e),eo(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function Jb(e){return function(){this.style.removeProperty(e)}}function gM(e,t,n){var r,i=n+"",o;return function(){var a=eo(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function yM(e,t,n){var r,i,o;return function(){var a=eo(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),eo(this,e))),a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s))}}function _M(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var l=nr(this,e),u=l.on,c=l.value[o]==null?s||(s=Jb(t)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(a,i=c),l.on=r}}function vM(e,t,n){var r=(e+="")=="transform"?y7:Qb;return t==null?this.styleTween(e,bM(e,r)).on("end.style."+e,Jb(e)):typeof t=="function"?this.styleTween(e,yM(e,r,$h(this,"style."+e,t))).each(_M(this._id,e)):this.styleTween(e,gM(e,r,t),n).on("end.style."+e,null)}function wM(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function MM(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&wM(e,a,n)),r}return o._value=t,o}function SM(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,MM(e,t,n??""))}function EM(e){return function(){this.textContent=e}}function AM(e){return function(){var t=e(this);this.textContent=t??""}}function CM(e){return this.tween("text",typeof e=="function"?AM($h(this,"text",e)):EM(e==null?"":e+""))}function PM(e){return function(t){this.textContent=e.call(this,t)}}function xM(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&PM(i)),t}return r._value=e,r}function NM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,xM(e))}function TM(){for(var e=this._name,t=this._id,n=eg(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=Ln(l,t);fu(l,e,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new br(r,this._parents,e,n)}function IM(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--i===0&&o()}};n.each(function(){var u=nr(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),u.on=t}),i===0&&o()})}var kM=0;function br(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function eg(){return++kM}var or=qa.prototype;br.prototype={constructor:br,select:hM,selectAll:dM,selectChild:or.selectChild,selectChildren:or.selectChildren,filter:oM,merge:aM,selection:pM,transition:TM,call:or.call,nodes:or.nodes,node:or.node,size:or.size,empty:or.empty,each:or.each,on:uM,attr:z7,attrTween:j7,style:vM,styleTween:SM,text:CM,textTween:NM,remove:fM,tween:B7,delay:Z7,duration:eM,ease:nM,easeVarying:iM,end:IM,[Symbol.iterator]:or[Symbol.iterator]};function $M(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var DM={time:null,delay:0,duration:250,ease:$M};function FM(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function BM(e){var t,n;e instanceof br?(t=e._id,e=e._name):(t=eg(),(n=DM).time=Ih(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&fu(l,e,t,u,a,n||FM(l,t));return new br(r,this._parents,e,t)}qa.prototype.interrupt=$7;qa.prototype.transition=BM;const df=Math.PI,mf=2*df,Jr=1e-6,RM=mf-Jr;function tg(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function LM(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return tg;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class ng{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?tg:LM(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,l=r-t,u=i-n,c=a-t,f=s-n,h=c*c+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Jr)if(!(Math.abs(f*l-u*c)>Jr)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,p=i-s,b=l*l+u*u,y=d*d+p*p,_=Math.sqrt(b),v=Math.sqrt(h),M=o*Math.tan((df-Math.acos((b+h-y)/(2*_*v)))/2),g=M/v,w=M/_;Math.abs(g-1)>Jr&&this._append`L${t+g*c},${n+g*f}`,this._append`A${o},${o},0,0,${+(f*d>c*p)},${this._x1=t+w*l},${this._y1=n+w*u}`}}arc(t,n,r,i,o,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),l=r*Math.sin(i),u=t+s,c=n+l,f=1^a,h=a?i-o:o-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Jr||Math.abs(this._y1-c)>Jr)&&this._append`L${u},${c}`,r&&(h<0&&(h=h%mf+mf),h>RM?this._append`A${r},${r},0,1,${f},${t-s},${n-l}A${r},${r},0,1,${f},${this._x1=u},${this._y1=c}`:h>Jr&&this._append`A${r},${r},0,${+(h>=df)},${f},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Ir(e=3){return new ng(+e)}function OM(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function pl(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ro(e){return e=pl(Math.abs(e)),e?e[1]:NaN}function GM(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function UM(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var qM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ya(e){if(!(t=qM.exec(e)))throw new Error("invalid format: "+e);var t;return new Dh({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ya.prototype=Dh.prototype;function Dh(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Dh.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zM(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var rg;function HM(e,t){var n=pl(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(rg=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+pl(e,Math.max(0,t+o-1))[0]}function Cm(e,t){var n=pl(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Pm={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:OM,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Cm(e*100,t),r:Cm,s:HM,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function xm(e){return e}var Nm=Array.prototype.map,Tm=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function VM(e){var t=e.grouping===void 0||e.thousands===void 0?xm:GM(Nm.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?xm:UM(Nm.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(f){f=ya(f);var h=f.fill,d=f.align,p=f.sign,b=f.symbol,y=f.zero,_=f.width,v=f.comma,M=f.precision,g=f.trim,w=f.type;w==="n"?(v=!0,w="g"):Pm[w]||(M===void 0&&(M=12),g=!0,w="g"),(y||h==="0"&&d==="=")&&(y=!0,h="0",d="=");var E=b==="$"?n:b==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",N=b==="$"?r:/[%p]/.test(w)?a:"",x=Pm[w],T=/[defgprs%]/.test(w);M=M===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function S(P){var I=E,$=N,D,A,F;if(w==="c")$=x(P)+$,P="";else{P=+P;var L=P<0||1/P<0;if(P=isNaN(P)?l:x(Math.abs(P),M),g&&(P=zM(P)),L&&+P==0&&p!=="+"&&(L=!1),I=(L?p==="("?p:s:p==="-"||p==="("?"":p)+I,$=(w==="s"?Tm[8+rg/3]:"")+$+(L&&p==="("?")":""),T){for(D=-1,A=P.length;++D<A;)if(F=P.charCodeAt(D),48>F||F>57){$=(F===46?i+P.slice(D+1):P.slice(D))+$,P=P.slice(0,D);break}}}v&&!y&&(P=t(P,1/0));var X=I.length+P.length+$.length,U=X<_?new Array(_-X+1).join(h):"";switch(v&&y&&(P=t(U+P,U.length?_-$.length:1/0),U=""),d){case"<":P=I+P+$+U;break;case"=":P=I+U+P+$;break;case"^":P=U.slice(0,X=U.length>>1)+I+P+$+U.slice(X);break;default:P=U+I+P+$;break}return o(P)}return S.toString=function(){return f+""},S}function c(f,h){var d=u((f=ya(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(ro(h)/3)))*3,b=Math.pow(10,-p),y=Tm[8+p/3];return function(_){return d(b*_)+y}}return{format:u,formatPrefix:c}}var Es,Mo,ig;YM({thousands:",",grouping:[3],currency:["$",""]});function YM(e){return Es=VM(e),Mo=Es.format,ig=Es.formatPrefix,Es}function WM(e){return Math.max(0,-ro(Math.abs(e)))}function jM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ro(t)/3)))*3-ro(Math.abs(e)))}function XM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ro(t)-ro(e))+1}var Be=1e-6,og=1e-12,Ge=Math.PI,dt=Ge/2,Im=Ge/4,nn=Ge*2,Bt=180/Ge,ct=Ge/180,Ze=Math.abs,So=Math.atan,gr=Math.atan2,Le=Math.cos,ag=Math.exp,bl=Math.log,uc=Math.pow,ke=Math.sin,pn=Math.sign||function(e){return e>0?1:e<0?-1:0},Wt=Math.sqrt,Fh=Math.tan;function sg(e){return e>1?0:e<-1?Ge:Math.acos(e)}function vn(e){return e>1?dt:e<-1?-dt:Math.asin(e)}function bn(){}function gl(e,t){e&&$m.hasOwnProperty(e.type)&&$m[e.type](e,t)}var km={Feature:function(e,t){gl(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)gl(n[r].geometry,t)}},$m={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){pf(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)pf(n[r],t,0)},Polygon:function(e,t){Dm(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Dm(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)gl(n[r],t)}};function pf(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function Dm(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)pf(e[n],t,1);t.polygonEnd()}function ei(e,t){e&&km.hasOwnProperty(e.type)?km[e.type](e,t):gl(e,t)}function bf(e){return[gr(e[1],e[0]),vn(e[2])]}function io(e){var t=e[0],n=e[1],r=Le(n);return[r*Le(t),r*ke(t),ke(n)]}function As(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function yl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function cc(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Cs(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function gf(e){var t=Wt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function yf(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function _f(e,t){return Ze(e)>Ge&&(e-=Math.round(e/nn)*nn),[e,t]}_f.invert=_f;function lg(e,t,n){return(e%=nn)?t||n?yf(Bm(e),Rm(t,n)):Bm(e):t||n?Rm(t,n):_f}function Fm(e){return function(t,n){return t+=e,Ze(t)>Ge&&(t-=Math.round(t/nn)*nn),[t,n]}}function Bm(e){var t=Fm(e);return t.invert=Fm(-e),t}function Rm(e,t){var n=Le(e),r=ke(e),i=Le(t),o=ke(t);function a(s,l){var u=Le(l),c=Le(s)*u,f=ke(s)*u,h=ke(l),d=h*n+c*r;return[gr(f*i-d*o,c*n-h*r),vn(d*i+f*o)]}return a.invert=function(s,l){var u=Le(l),c=Le(s)*u,f=ke(s)*u,h=ke(l),d=h*i-f*o;return[gr(f*i+h*o,c*n+d*r),vn(d*n-c*r)]},a}function KM(e){e=lg(e[0]*ct,e[1]*ct,e.length>2?e[2]*ct:0);function t(n){return n=e(n[0]*ct,n[1]*ct),n[0]*=Bt,n[1]*=Bt,n}return t.invert=function(n){return n=e.invert(n[0]*ct,n[1]*ct),n[0]*=Bt,n[1]*=Bt,n},t}function ZM(e,t,n,r,i,o){if(n){var a=Le(t),s=ke(t),l=r*n;i==null?(i=t+r*nn,o=t-l/2):(i=Lm(a,i),o=Lm(a,o),(r>0?i<o:i>o)&&(i+=r*nn));for(var u,c=i;r>0?c>o:c<o;c-=l)u=bf([a,-s*Le(c),-s*ke(c)]),e.point(u[0],u[1])}}function Lm(e,t){t=io(t),t[0]-=e,gf(t);var n=sg(-t[1]);return((-t[2]<0?-n:n)+nn-Be)%nn}function ug(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:bn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Vs(e,t){return Ze(e[0]-t[0])<Be&&Ze(e[1]-t[1])<Be}function Ps(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function cg(e,t,n,r,i){var o=[],a=[],s,l;if(e.forEach(function(p){if(!((b=p.length-1)<=0)){var b,y=p[0],_=p[b],v;if(Vs(y,_)){if(!y[2]&&!_[2]){for(i.lineStart(),s=0;s<b;++s)i.point((y=p[s])[0],y[1]);i.lineEnd();return}_[0]+=2*Be}o.push(v=new Ps(y,p,null,!0)),a.push(v.o=new Ps(y,null,v,!1)),o.push(v=new Ps(_,p,null,!1)),a.push(v.o=new Ps(_,null,v,!0))}}),!!o.length){for(a.sort(t),Om(o),Om(a),s=0,l=a.length;s<l;++s)a[s].e=n=!n;for(var u=o[0],c,f;;){for(var h=u,d=!0;h.v;)if((h=h.n)===u)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(s=0,l=c.length;s<l;++s)i.point((f=c[s])[0],f[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,c=h.z,d=!d}while(!h.v);i.lineEnd()}}}function Om(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function fc(e){return Ze(e[0])<=Ge?e[0]:pn(e[0])*((Ze(e[0])+Ge)%nn-Ge)}function QM(e,t){var n=fc(t),r=t[1],i=ke(r),o=[ke(n),-Le(n),0],a=0,s=0,l=new li;i===1?r=dt+Be:i===-1&&(r=-dt-Be);for(var u=0,c=e.length;u<c;++u)if(h=(f=e[u]).length)for(var f,h,d=f[h-1],p=fc(d),b=d[1]/2+Im,y=ke(b),_=Le(b),v=0;v<h;++v,p=g,y=E,_=N,d=M){var M=f[v],g=fc(M),w=M[1]/2+Im,E=ke(w),N=Le(w),x=g-p,T=x>=0?1:-1,S=T*x,P=S>Ge,I=y*E;if(l.add(gr(I*T*ke(S),_*N+I*Le(S))),a+=P?x+T*nn:x,P^p>=n^g>=n){var $=yl(io(d),io(M));gf($);var D=yl(o,$);gf(D);var A=(P^x>=0?-1:1)*vn(D[2]);(r>A||r===A&&($[0]||$[1]))&&(s+=P^x>=0?1:-1)}}return(a<-Be||a<Be&&l<-og)^s&1}function fg(e,t,n,r){return function(i){var o=t(i),a=ug(),s=t(a),l=!1,u,c,f,h={point:d,lineStart:b,lineEnd:y,polygonStart:function(){h.point=_,h.lineStart=v,h.lineEnd=M,c=[],u=[]},polygonEnd:function(){h.point=d,h.lineStart=b,h.lineEnd=y,c=_b(c);var g=QM(u,r);c.length?(l||(i.polygonStart(),l=!0),cg(c,e8,g,n,i)):g&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(g,w){e(g,w)&&i.point(g,w)}function p(g,w){o.point(g,w)}function b(){h.point=p,o.lineStart()}function y(){h.point=d,o.lineEnd()}function _(g,w){f.push([g,w]),s.point(g,w)}function v(){s.lineStart(),f=[]}function M(){_(f[0][0],f[0][1]),s.lineEnd();var g=s.clean(),w=a.result(),E,N=w.length,x,T,S;if(f.pop(),u.push(f),f=null,!!N){if(g&1){if(T=w[0],(x=T.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),E=0;E<x;++E)i.point((S=T[E])[0],S[1]);i.lineEnd()}return}N>1&&g&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(JM))}}return h}}function JM(e){return e.length>1}function e8(e,t){return((e=e.x)[0]<0?e[1]-dt-Be:dt-e[1])-((t=t.x)[0]<0?t[1]-dt-Be:dt-t[1])}const Gm=fg(function(){return!0},t8,r8,[-Ge,-dt]);function t8(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?Ge:-Ge,l=Ze(o-t);Ze(l-Ge)<Be?(e.point(t,n=(n+a)/2>0?dt:-dt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&l>=Ge&&(Ze(t-r)<Be&&(t-=r*Be),Ze(o-s)<Be&&(o-=s*Be),n=n8(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function n8(e,t,n,r){var i,o,a=ke(e-n);return Ze(a)>Be?So((ke(t)*(o=Le(r))*ke(n)-ke(r)*(i=Le(t))*ke(e))/(i*o*a)):(t+r)/2}function r8(e,t,n,r){var i;if(e==null)i=n*dt,r.point(-Ge,i),r.point(0,i),r.point(Ge,i),r.point(Ge,0),r.point(Ge,-i),r.point(0,-i),r.point(-Ge,-i),r.point(-Ge,0),r.point(-Ge,i);else if(Ze(e[0]-t[0])>Be){var o=e[0]<t[0]?Ge:-Ge;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function i8(e){var t=Le(e),n=2*ct,r=t>0,i=Ze(t)>Be;function o(c,f,h,d){ZM(d,e,n,h,c,f)}function a(c,f){return Le(c)*Le(f)>t}function s(c){var f,h,d,p,b;return{lineStart:function(){p=d=!1,b=1},point:function(y,_){var v=[y,_],M,g=a(y,_),w=r?g?0:u(y,_):g?u(y+(y<0?Ge:-Ge),_):0;if(!f&&(p=d=g)&&c.lineStart(),g!==d&&(M=l(f,v),(!M||Vs(f,M)||Vs(v,M))&&(v[2]=1)),g!==d)b=0,g?(c.lineStart(),M=l(v,f),c.point(M[0],M[1])):(M=l(f,v),c.point(M[0],M[1],2),c.lineEnd()),f=M;else if(i&&f&&r^g){var E;!(w&h)&&(E=l(v,f,!0))&&(b=0,r?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}g&&(!f||!Vs(f,v))&&c.point(v[0],v[1]),f=v,d=g,h=w},lineEnd:function(){d&&c.lineEnd(),f=null},clean:function(){return b|(p&&d)<<1}}}function l(c,f,h){var d=io(c),p=io(f),b=[1,0,0],y=yl(d,p),_=As(y,y),v=y[0],M=_-v*v;if(!M)return!h&&c;var g=t*_/M,w=-t*v/M,E=yl(b,y),N=Cs(b,g),x=Cs(y,w);cc(N,x);var T=E,S=As(N,T),P=As(T,T),I=S*S-P*(As(N,N)-1);if(!(I<0)){var $=Wt(I),D=Cs(T,(-S-$)/P);if(cc(D,N),D=bf(D),!h)return D;var A=c[0],F=f[0],L=c[1],X=f[1],U;F<A&&(U=A,A=F,F=U);var z=F-A,G=Ze(z-Ge)<Be,R=G||z<Be;if(!G&&X<L&&(U=L,L=X,X=U),R?G?L+X>0^D[1]<(Ze(D[0]-A)<Be?L:X):L<=D[1]&&D[1]<=X:z>Ge^(A<=D[0]&&D[0]<=F)){var Y=Cs(T,(-S+$)/P);return cc(Y,N),[D,bf(Y)]}}}function u(c,f){var h=r?e:Ge-e,d=0;return c<-h?d|=1:c>h&&(d|=2),f<-h?d|=4:f>h&&(d|=8),d}return fg(a,s,o,r?[0,-e]:[-Ge,e-Ge])}function o8(e,t,n,r,i,o){var a=e[0],s=e[1],l=t[0],u=t[1],c=0,f=1,h=l-a,d=u-s,p;if(p=n-a,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=i-a,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}if(p=r-s,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=o-s,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=a+c*h,e[1]=s+c*d),f<1&&(t[0]=a+f*h,t[1]=s+f*d),!0}}}}}var zo=1e9,xs=-zo;function hg(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function o(u,c,f,h){var d=0,p=0;if(u==null||(d=a(u,f))!==(p=a(c,f))||l(u,c)<0^f>0)do h.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+f+4)%4)!==p);else h.point(c[0],c[1])}function a(u,c){return Ze(u[0]-e)<Be?c>0?0:3:Ze(u[0]-n)<Be?c>0?2:1:Ze(u[1]-t)<Be?c>0?1:0:c>0?3:2}function s(u,c){return l(u.x,c.x)}function l(u,c){var f=a(u,1),h=a(c,1);return f!==h?f-h:f===0?c[1]-u[1]:f===1?u[0]-c[0]:f===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,f=ug(),h,d,p,b,y,_,v,M,g,w,E,N={point:x,lineStart:I,lineEnd:$,polygonStart:S,polygonEnd:P};function x(A,F){i(A,F)&&c.point(A,F)}function T(){for(var A=0,F=0,L=d.length;F<L;++F)for(var X=d[F],U=1,z=X.length,G=X[0],R,Y,re=G[0],Q=G[1];U<z;++U)R=re,Y=Q,G=X[U],re=G[0],Q=G[1],Y<=r?Q>r&&(re-R)*(r-Y)>(Q-Y)*(e-R)&&++A:Q<=r&&(re-R)*(r-Y)<(Q-Y)*(e-R)&&--A;return A}function S(){c=f,h=[],d=[],E=!0}function P(){var A=T(),F=E&&A,L=(h=_b(h)).length;(F||L)&&(u.polygonStart(),F&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),L&&cg(h,s,A,o,u),u.polygonEnd()),c=u,h=d=p=null}function I(){N.point=D,d&&d.push(p=[]),w=!0,g=!1,v=M=NaN}function $(){h&&(D(b,y),_&&g&&f.rejoin(),h.push(f.result())),N.point=x,g&&c.lineEnd()}function D(A,F){var L=i(A,F);if(d&&p.push([A,F]),w)b=A,y=F,_=L,w=!1,L&&(c.lineStart(),c.point(A,F));else if(L&&g)c.point(A,F);else{var X=[v=Math.max(xs,Math.min(zo,v)),M=Math.max(xs,Math.min(zo,M))],U=[A=Math.max(xs,Math.min(zo,A)),F=Math.max(xs,Math.min(zo,F))];o8(X,U,e,t,n,r)?(g||(c.lineStart(),c.point(X[0],X[1])),c.point(U[0],U[1]),L||c.lineEnd(),E=!1):L&&(c.lineStart(),c.point(A,F),E=!1)}v=A,M=F,g=L}return N}}const vf=e=>e;var hc=new li,wf=new li,dg,mg,Mf,Sf,fr={point:bn,lineStart:bn,lineEnd:bn,polygonStart:function(){fr.lineStart=a8,fr.lineEnd=l8},polygonEnd:function(){fr.lineStart=fr.lineEnd=fr.point=bn,hc.add(Ze(wf)),wf=new li},result:function(){var e=hc/2;return hc=new li,e}};function a8(){fr.point=s8}function s8(e,t){fr.point=pg,dg=Mf=e,mg=Sf=t}function pg(e,t){wf.add(Sf*e-Mf*t),Mf=e,Sf=t}function l8(){pg(dg,mg)}var oo=1/0,_l=oo,_a=-oo,vl=_a,wl={point:u8,lineStart:bn,lineEnd:bn,polygonStart:bn,polygonEnd:bn,result:function(){var e=[[oo,_l],[_a,vl]];return _a=vl=-(_l=oo=1/0),e}};function u8(e,t){e<oo&&(oo=e),e>_a&&(_a=e),t<_l&&(_l=t),t>vl&&(vl=t)}var Ef=0,Af=0,Ho=0,Ml=0,Sl=0,Li=0,Cf=0,Pf=0,Vo=0,bg,gg,Yn,Wn,mn={point:di,lineStart:Um,lineEnd:qm,polygonStart:function(){mn.lineStart=h8,mn.lineEnd=d8},polygonEnd:function(){mn.point=di,mn.lineStart=Um,mn.lineEnd=qm},result:function(){var e=Vo?[Cf/Vo,Pf/Vo]:Li?[Ml/Li,Sl/Li]:Ho?[Ef/Ho,Af/Ho]:[NaN,NaN];return Ef=Af=Ho=Ml=Sl=Li=Cf=Pf=Vo=0,e}};function di(e,t){Ef+=e,Af+=t,++Ho}function Um(){mn.point=c8}function c8(e,t){mn.point=f8,di(Yn=e,Wn=t)}function f8(e,t){var n=e-Yn,r=t-Wn,i=Wt(n*n+r*r);Ml+=i*(Yn+e)/2,Sl+=i*(Wn+t)/2,Li+=i,di(Yn=e,Wn=t)}function qm(){mn.point=di}function h8(){mn.point=m8}function d8(){yg(bg,gg)}function m8(e,t){mn.point=yg,di(bg=Yn=e,gg=Wn=t)}function yg(e,t){var n=e-Yn,r=t-Wn,i=Wt(n*n+r*r);Ml+=i*(Yn+e)/2,Sl+=i*(Wn+t)/2,Li+=i,i=Wn*e-Yn*t,Cf+=i*(Yn+e),Pf+=i*(Wn+t),Vo+=i*3,di(Yn=e,Wn=t)}function _g(e){this._context=e}_g.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,nn);break}}},result:bn};var xf=new li,dc,vg,wg,Yo,Wo,va={point:bn,lineStart:function(){va.point=p8},lineEnd:function(){dc&&Mg(vg,wg),va.point=bn},polygonStart:function(){dc=!0},polygonEnd:function(){dc=null},result:function(){var e=+xf;return xf=new li,e}};function p8(e,t){va.point=Mg,vg=Yo=e,wg=Wo=t}function Mg(e,t){Yo-=e,Wo-=t,xf.add(Wt(Yo*Yo+Wo*Wo)),Yo=e,Wo=t}let zm,El,Hm,Vm;class Ym{constructor(t){this._append=t==null?Sg:b8(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Hm||this._append!==El){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Hm=r,El=this._append,Vm=this._,this._=i}this._+=Vm;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Sg(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function b8(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Sg;if(t!==zm){const n=10**t;zm=t,El=function(i){let o=1;this._+=i[0];for(const a=i.length;o<a;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return El}function hu(e,t){let n=3,r=4.5,i,o;function a(s){return s&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),ei(s,i(o))),o.result()}return a.area=function(s){return ei(s,i(fr)),fr.result()},a.measure=function(s){return ei(s,i(va)),va.result()},a.bounds=function(s){return ei(s,i(wl)),wl.result()},a.centroid=function(s){return ei(s,i(mn)),mn.result()},a.projection=function(s){return arguments.length?(i=s==null?(e=null,vf):(e=s).stream,a):e},a.context=function(s){return arguments.length?(o=s==null?(t=null,new Ym(n)):new _g(t=s),typeof r!="function"&&o.pointRadius(r),a):t},a.pointRadius=function(s){return arguments.length?(r=typeof s=="function"?s:(o.pointRadius(+s),+s),a):r},a.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);n=l}return t===null&&(o=new Ym(n)),a},a.projection(e).digits(n).context(t)}function Nf(e){return{stream:du(e)}}function du(e){return function(t){var n=new Tf;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Tf(){}Tf.prototype={constructor:Tf,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Bh(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),ei(n,e.stream(wl)),t(wl.result()),r!=null&&e.clipExtent(r),e}function Rh(e,t,n){return Bh(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,l])},n)}function Eg(e,t,n){return Rh(e,[[0,0],t],n)}function Ag(e,t,n){return Bh(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function Cg(e,t,n){return Bh(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var Wm=16,g8=Le(30*ct);function jm(e,t){return+t?_8(e,t):y8(e)}function y8(e){return du({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function _8(e,t){function n(r,i,o,a,s,l,u,c,f,h,d,p,b,y){var _=u-r,v=c-i,M=_*_+v*v;if(M>4*t&&b--){var g=a+h,w=s+d,E=l+p,N=Wt(g*g+w*w+E*E),x=vn(E/=N),T=Ze(Ze(E)-1)<Be||Ze(o-f)<Be?(o+f)/2:gr(w,g),S=e(T,x),P=S[0],I=S[1],$=P-r,D=I-i,A=v*$-_*D;(A*A/M>t||Ze((_*$+v*D)/M-.5)>.3||a*h+s*d+l*p<g8)&&(n(r,i,o,a,s,l,P,I,T,g/=N,w/=N,E,b,y),y.point(P,I),n(P,I,T,g,w,E,u,c,f,h,d,p,b,y))}}return function(r){var i,o,a,s,l,u,c,f,h,d,p,b,y={point:_,lineStart:v,lineEnd:g,polygonStart:function(){r.polygonStart(),y.lineStart=w},polygonEnd:function(){r.polygonEnd(),y.lineStart=v}};function _(x,T){x=e(x,T),r.point(x[0],x[1])}function v(){f=NaN,y.point=M,r.lineStart()}function M(x,T){var S=io([x,T]),P=e(x,T);n(f,h,c,d,p,b,f=P[0],h=P[1],c=x,d=S[0],p=S[1],b=S[2],Wm,r),r.point(f,h)}function g(){y.point=_,r.lineEnd()}function w(){v(),y.point=E,y.lineEnd=N}function E(x,T){M(i=x,T),o=f,a=h,s=d,l=p,u=b,y.point=M}function N(){n(f,h,c,d,p,b,o,a,i,s,l,u,Wm,r),y.lineEnd=g,g()}return y}}var v8=du({point:function(e,t){this.stream.point(e*ct,t*ct)}});function w8(e){return du({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function M8(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function Xm(e,t,n,r,i,o){if(!o)return M8(e,t,n,r,i);var a=Le(o),s=ke(o),l=a*e,u=s*e,c=a/e,f=s/e,h=(s*n-a*t)/e,d=(s*t+a*n)/e;function p(b,y){return b*=r,y*=i,[l*b-u*y+t,n-u*b-l*y]}return p.invert=function(b,y){return[r*(c*b-f*y+h),i*(d-f*b-c*y)]},p}function Yr(e){return Pg(function(){return e})()}function Pg(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,l=0,u=0,c,f=0,h=1,d=1,p=null,b=Gm,y=null,_,v,M,g=vf,w=.5,E,N,x,T,S;function P(A){return x(A[0]*ct,A[1]*ct)}function I(A){return A=x.invert(A[0],A[1]),A&&[A[0]*Bt,A[1]*Bt]}P.stream=function(A){return T&&S===A?T:T=v8(w8(c)(b(E(g(S=A)))))},P.preclip=function(A){return arguments.length?(b=A,p=void 0,D()):b},P.postclip=function(A){return arguments.length?(g=A,y=_=v=M=null,D()):g},P.clipAngle=function(A){return arguments.length?(b=+A?i8(p=A*ct):(p=null,Gm),D()):p*Bt},P.clipExtent=function(A){return arguments.length?(g=A==null?(y=_=v=M=null,vf):hg(y=+A[0][0],_=+A[0][1],v=+A[1][0],M=+A[1][1]),D()):y==null?null:[[y,_],[v,M]]},P.scale=function(A){return arguments.length?(n=+A,$()):n},P.translate=function(A){return arguments.length?(r=+A[0],i=+A[1],$()):[r,i]},P.center=function(A){return arguments.length?(o=A[0]%360*ct,a=A[1]%360*ct,$()):[o*Bt,a*Bt]},P.rotate=function(A){return arguments.length?(s=A[0]%360*ct,l=A[1]%360*ct,u=A.length>2?A[2]%360*ct:0,$()):[s*Bt,l*Bt,u*Bt]},P.angle=function(A){return arguments.length?(f=A%360*ct,$()):f*Bt},P.reflectX=function(A){return arguments.length?(h=A?-1:1,$()):h<0},P.reflectY=function(A){return arguments.length?(d=A?-1:1,$()):d<0},P.precision=function(A){return arguments.length?(E=jm(N,w=A*A),D()):Wt(w)},P.fitExtent=function(A,F){return Rh(P,A,F)},P.fitSize=function(A,F){return Eg(P,A,F)},P.fitWidth=function(A,F){return Ag(P,A,F)},P.fitHeight=function(A,F){return Cg(P,A,F)};function $(){var A=Xm(n,0,0,h,d,f).apply(null,t(o,a)),F=Xm(n,r-A[0],i-A[1],h,d,f);return c=lg(s,l,u),N=yf(t,F),x=yf(c,N),E=jm(N,w),D()}function D(){return T=S=null,P}return function(){return t=e.apply(this,arguments),P.invert=t.invert&&I,$()}}function Lh(e){var t=0,n=Ge/3,r=Pg(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*ct,n=o[1]*ct):[t*Bt,n*Bt]},i}function S8(e){var t=Le(e);function n(r,i){return[r*t,ke(i)/t]}return n.invert=function(r,i){return[r/t,vn(i*t)]},n}function E8(e,t){var n=ke(e),r=(n+ke(t))/2;if(Ze(r)<Be)return S8(e);var i=1+n*(2*r-n),o=Wt(i)/r;function a(s,l){var u=Wt(i-2*r*ke(l))/r;return[u*ke(s*=r),o-u*Le(s)]}return a.invert=function(s,l){var u=o-l,c=gr(s,Ze(u))*pn(u);return u*r<0&&(c-=Ge*pn(s)*pn(u)),[c/r,vn((i-(s*s+u*u)*r*r)/(2*r))]},a}function Al(){return Lh(E8).scale(155.424).center([0,33.6442])}function xg(){return Al().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function A8(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function C8(){var e,t,n=xg(),r,i=Al().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=Al().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,l,u={point:function(h,d){l=[h,d]}};function c(h){var d=h[0],p=h[1];return l=null,r.point(d,p),l||(o.point(d,p),l)||(s.point(d,p),l)}c.invert=function(h){var d=n.scale(),p=n.translate(),b=(h[0]-p[0])/d,y=(h[1]-p[1])/d;return(y>=.12&&y<.234&&b>=-.425&&b<-.214?i:y>=.166&&y<.234&&b>=-.214&&b<-.115?a:n).invert(h)},c.stream=function(h){return e&&t===h?e:e=A8([n.stream(t=h),i.stream(h),a.stream(h)])},c.precision=function(h){return arguments.length?(n.precision(h),i.precision(h),a.precision(h),f()):n.precision()},c.scale=function(h){return arguments.length?(n.scale(h),i.scale(h*.35),a.scale(h),c.translate(n.translate())):n.scale()},c.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),p=+h[0],b=+h[1];return r=n.translate(h).clipExtent([[p-.455*d,b-.238*d],[p+.455*d,b+.238*d]]).stream(u),o=i.translate([p-.307*d,b+.201*d]).clipExtent([[p-.425*d+Be,b+.12*d+Be],[p-.214*d-Be,b+.234*d-Be]]).stream(u),s=a.translate([p-.205*d,b+.212*d]).clipExtent([[p-.214*d+Be,b+.166*d+Be],[p-.115*d-Be,b+.234*d-Be]]).stream(u),f()},c.fitExtent=function(h,d){return Rh(c,h,d)},c.fitSize=function(h,d){return Eg(c,h,d)},c.fitWidth=function(h,d){return Ag(c,h,d)},c.fitHeight=function(h,d){return Cg(c,h,d)};function f(){return e=t=null,c}return c.scale(1070)}function Ng(e){return function(t,n){var r=Le(t),i=Le(n),o=e(r*i);return o===1/0?[2,0]:[o*i*ke(t),o*ke(n)]}}function Va(e){return function(t,n){var r=Wt(t*t+n*n),i=e(r),o=ke(i),a=Le(i);return[gr(t*o,r*a),vn(r&&n*o/r)]}}var Tg=Ng(function(e){return Wt(2/(1+e))});Tg.invert=Va(function(e){return 2*vn(e/2)});function P8(){return Yr(Tg).scale(124.75).clipAngle(180-.001)}var Ig=Ng(function(e){return(e=sg(e))&&e/ke(e)});Ig.invert=Va(function(e){return e});function x8(){return Yr(Ig).scale(79.4188).clipAngle(180-.001)}function mu(e,t){return[e,bl(Fh((dt+t)/2))]}mu.invert=function(e,t){return[e,2*So(ag(t))-dt]};function N8(){return kg(mu).scale(961/nn)}function kg(e){var t=Yr(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,a=null,s,l,u;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=l=u=null:(a=+f[0][0],s=+f[0][1],l=+f[1][0],u=+f[1][1]),c()):a==null?null:[[a,s],[l,u]]};function c(){var f=Ge*r(),h=t(KM(t.rotate()).invert([0,0]));return o(a==null?[[h[0]-f,h[1]-f],[h[0]+f,h[1]+f]]:e===mu?[[Math.max(h[0]-f,a),s],[Math.min(h[0]+f,l),u]]:[[a,Math.max(h[1]-f,s)],[l,Math.min(h[1]+f,u)]])}return c()}function Ns(e){return Fh((dt+e)/2)}function T8(e,t){var n=Le(e),r=e===t?ke(e):bl(n/Le(t))/bl(Ns(t)/Ns(e)),i=n*uc(Ns(e),r)/r;if(!r)return mu;function o(a,s){i>0?s<-dt+Be&&(s=-dt+Be):s>dt-Be&&(s=dt-Be);var l=i/uc(Ns(s),r);return[l*ke(r*a),i-l*Le(r*a)]}return o.invert=function(a,s){var l=i-s,u=pn(r)*Wt(a*a+l*l),c=gr(a,Ze(l))*pn(l);return l*r<0&&(c-=Ge*pn(a)*pn(l)),[c/r,2*So(uc(i/u,1/r))-dt]},o}function I8(){return Lh(T8).scale(109.5).parallels([30,30])}function Cl(e,t){return[e,t]}Cl.invert=Cl;function k8(){return Yr(Cl).scale(152.63)}function $8(e,t){var n=Le(e),r=e===t?ke(e):(n-Le(t))/(t-e),i=n/r+e;if(Ze(r)<Be)return Cl;function o(a,s){var l=i-s,u=r*a;return[l*ke(u),i-l*Le(u)]}return o.invert=function(a,s){var l=i-s,u=gr(a,Ze(l))*pn(l);return l*r<0&&(u-=Ge*pn(a)*pn(l)),[u/r,i-pn(r)*Wt(a*a+l*l)]},o}function D8(){return Lh($8).scale(131.154).center([0,13.9389])}var na=1.340264,ra=-.081106,ia=893e-6,oa=.003796,Pl=Wt(3)/2,F8=12;function $g(e,t){var n=vn(Pl*ke(t)),r=n*n,i=r*r*r;return[e*Le(n)/(Pl*(na+3*ra*r+i*(7*ia+9*oa*r))),n*(na+ra*r+i*(ia+oa*r))]}$g.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,a,s,l;o<F8&&(s=n*(na+ra*r+i*(ia+oa*r))-t,l=na+3*ra*r+i*(7*ia+9*oa*r),n-=a=s/l,r=n*n,i=r*r*r,!(Ze(a)<og));++o);return[Pl*e*(na+3*ra*r+i*(7*ia+9*oa*r))/Le(n),vn(ke(n)/Pl)]};function B8(){return Yr($g).scale(177.158)}function Dg(e,t){var n=Le(t),r=Le(e)*n;return[n*ke(e)/r,ke(t)/r]}Dg.invert=Va(So);function R8(){return Yr(Dg).scale(144.049).clipAngle(60)}function Fg(e,t){return[Le(t)*ke(e),ke(t)]}Fg.invert=Va(vn);function L8(){return Yr(Fg).scale(249.5).clipAngle(90+Be)}function Bg(e,t){var n=Le(t),r=1+Le(e)*n;return[n*ke(e)/r,ke(t)/r]}Bg.invert=Va(function(e){return 2*So(e)});function O8(){return Yr(Bg).scale(250).clipAngle(142)}function Rg(e,t){return[bl(Fh((dt+t)/2)),-e]}Rg.invert=function(e,t){return[-t,2*So(ag(e))-dt]};function G8(){var e=kg(Rg),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function rr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function pu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const If=Symbol("implicit");function Oh(){var e=new ui,t=[],n=[],r=If;function i(o){let a=e.get(o);if(a===void 0){if(r!==If)return r;e.set(o,a=t.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new ui;for(const a of o)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Oh(t,n).unknown(r)},rr.apply(i,arguments),i}function bu(){var e=Oh().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,o,a,s=!1,l=0,u=0,c=.5;delete e.unknown;function f(){var h=t().length,d=i<r,p=d?i:r,b=d?r:i;o=(b-p)/Math.max(1,h-l+u*2),s&&(o=Math.floor(o)),p+=(b-p-o*(h-l))*c,a=o*(1-l),s&&(p=Math.round(p),a=Math.round(a));var y=Ce(h).map(function(_){return p+o*_});return n(d?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([r,i]=h,r=+r,i=+i,f()):[r,i]},e.rangeRound=function(h){return[r,i]=h,r=+r,i=+i,s=!0,f()},e.bandwidth=function(){return a},e.step=function(){return o},e.round=function(h){return arguments.length?(s=!!h,f()):s},e.padding=function(h){return arguments.length?(l=Math.min(1,u=+h),f()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(c=Math.max(0,Math.min(1,h)),f()):c},e.copy=function(){return bu(t(),[r,i]).round(s).paddingInner(l).paddingOuter(u).align(c)},rr.apply(f(),arguments)}function Lg(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Lg(t())},e}function U8(){return Lg(bu.apply(null,arguments).paddingInner(1))}function q8(e){return function(){return e}}function kf(e){return+e}var Km=[0,1];function gn(e){return e}function $f(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:q8(isNaN(t)?NaN:.5)}function z8(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function H8(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=$f(i,r),o=n(a,o)):(r=$f(r,i),o=n(o,a)),function(s){return o(r(s))}}function V8(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=$f(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var l=nu(e,s,1,r)-1;return o[l](i[l](s))}}function Ya(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function gu(){var e=Km,t=Km,n=Ha,r,i,o,a=gn,s,l,u;function c(){var h=Math.min(e.length,t.length);return a!==gn&&(a=z8(e[0],e[h-1])),s=h>2?V8:H8,l=u=null,f}function f(h){return h==null||isNaN(h=+h)?o:(l||(l=s(e.map(r),t,n)))(r(a(h)))}return f.invert=function(h){return a(i((u||(u=s(t,e.map(r),It)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,kf),c()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),c()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),n=Nh,c()},f.clamp=function(h){return arguments.length?(a=h?!0:gn,c()):a!==gn},f.interpolate=function(h){return arguments.length?(n=h,c()):n},f.unknown=function(h){return arguments.length?(o=h,f):o},function(h,d){return r=h,i=d,c()}}function Og(){return gu()(gn,gn)}function Y8(e,t,n,r){var i=nf(e,t,n),o;switch(r=ya(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=jM(i,a))&&(r.precision=o),ig(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=XM(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=WM(i))&&(r.precision=o-(r.type==="%")*2);break}}return Mo(r)}function Wa(e){var t=e.domain;return e.ticks=function(n){var r=t();return ma(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Y8(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,a=r[i],s=r[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=i,i=o,o=u);c-- >0;){if(u=Qi(a,s,n),u===l)return r[i]=a,r[o]=s,t(r);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return e},e}function Gh(){var e=Og();return e.copy=function(){return Ya(e,Gh())},rr.apply(e,arguments),Wa(e)}function Gg(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,kf),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return Gg(e).unknown(t)},e=arguments.length?Array.from(e,kf):[0,1],Wa(n)}function Ug(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),e[n]=t.floor(i),e[r]=t.ceil(o),e}function Zm(e){return Math.log(e)}function Qm(e){return Math.exp(e)}function W8(e){return-Math.log(-e)}function j8(e){return-Math.exp(-e)}function X8(e){return isFinite(e)?+("1e"+e):e<0?0:e}function K8(e){return e===10?X8:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Z8(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Jm(e){return(t,n)=>-e(-t,n)}function qg(e){const t=e(Zm,Qm),n=t.domain;let r=10,i,o;function a(){return i=Z8(r),o=K8(r),n()[0]<0?(i=Jm(i),o=Jm(o),e(W8,j8)):e(Zm,Qm),t}return t.base=function(s){return arguments.length?(r=+s,a()):r},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=s=>{const l=n();let u=l[0],c=l[l.length-1];const f=c<u;f&&([u,c]=[c,u]);let h=i(u),d=i(c),p,b;const y=s==null?10:+s;let _=[];if(!(r%1)&&d-h<y){if(h=Math.floor(h),d=Math.ceil(d),u>0){for(;h<=d;++h)for(p=1;p<r;++p)if(b=h<0?p/o(-h):p*o(h),!(b<u)){if(b>c)break;_.push(b)}}else for(;h<=d;++h)for(p=r-1;p>=1;--p)if(b=h>0?p/o(-h):p*o(h),!(b<u)){if(b>c)break;_.push(b)}_.length*2<y&&(_=ma(u,c,y))}else _=ma(h,d,Math.min(d-h,y)).map(o);return f?_.reverse():_},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=ya(l)).precision==null&&(l.trim=!0),l=Mo(l)),s===1/0)return l;const u=Math.max(1,r*s/t.ticks().length);return c=>{let f=c/o(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=u?l(c):""}},t.nice=()=>n(Ug(n(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),t}function zg(){const e=qg(gu()).domain([1,10]);return e.copy=()=>Ya(e,zg()).base(e.base()),rr.apply(e,arguments),e}function e0(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function t0(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Hg(e){var t=1,n=e(e0(t),t0(t));return n.constant=function(r){return arguments.length?e(e0(t=+r),t0(t)):t},Wa(n)}function Vg(){var e=Hg(gu());return e.copy=function(){return Ya(e,Vg()).constant(e.constant())},rr.apply(e,arguments)}function n0(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Q8(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function J8(e){return e<0?-e*e:e*e}function Yg(e){var t=e(gn,gn),n=1;function r(){return n===1?e(gn,gn):n===.5?e(Q8,J8):e(n0(n),n0(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Wa(t)}function Wg(){var e=Yg(gu());return e.copy=function(){return Ya(e,Wg()).exponent(e.exponent())},rr.apply(e,arguments),e}function jg(){var e=[],t=[],n=[],r;function i(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=j5(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?r:t[nu(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Vt),i()},o.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return jg().domain(e).range(t).unknown(r)},rr.apply(o,arguments)}function Xg(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[nu(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return Xg().domain(e).range(t).unknown(n)},rr.apply(i,arguments)}const mc=new Date,pc=new Date;function bt(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(t(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{const l=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;let u;do l.push(u=new Date(+o)),t(o,s),e(o);while(u<o&&o<a);return l},i.filter=o=>bt(a=>{if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););}),n&&(i.count=(o,a)=>(mc.setTime(+o),pc.setTime(+a),e(mc),e(pc),Math.floor(n(mc,pc))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const xl=bt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);xl.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?bt(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):xl);xl.range;const dr=1e3,yn=dr*60,mr=yn*60,yr=mr*24,Uh=yr*7,r0=yr*30,bc=yr*365,In=bt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*dr)},(e,t)=>(t-e)/dr,e=>e.getUTCSeconds());In.range;const ja=bt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*dr)},(e,t)=>{e.setTime(+e+t*yn)},(e,t)=>(t-e)/yn,e=>e.getMinutes());ja.range;const Xa=bt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*yn)},(e,t)=>(t-e)/yn,e=>e.getUTCMinutes());Xa.range;const Ka=bt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*dr-e.getMinutes()*yn)},(e,t)=>{e.setTime(+e+t*mr)},(e,t)=>(t-e)/mr,e=>e.getHours());Ka.range;const Za=bt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*mr)},(e,t)=>(t-e)/mr,e=>e.getUTCHours());Za.range;const _i=bt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*yn)/yr,e=>e.getDate()-1);_i.range;const yu=bt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/yr,e=>e.getUTCDate()-1);yu.range;const _u=bt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/yr,e=>Math.floor(e/yr));_u.range;function vi(e){return bt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*yn)/Uh)}const ao=vi(0),wa=vi(1),Kg=vi(2),Zg=vi(3),mi=vi(4),Qg=vi(5),Jg=vi(6);ao.range;wa.range;Kg.range;Zg.range;mi.range;Qg.range;Jg.range;function wi(e){return bt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Uh)}const so=wi(0),Ma=wi(1),e2=wi(2),t2=wi(3),pi=wi(4),n2=wi(5),r2=wi(6);so.range;Ma.range;e2.range;t2.range;pi.range;n2.range;r2.range;const Qa=bt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Qa.range;const Ja=bt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Ja.range;const Dn=bt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Dn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:bt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Dn.range;const Fn=bt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Fn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:bt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Fn.range;function i2(e,t,n,r,i,o){const a=[[In,1,dr],[In,5,5*dr],[In,15,15*dr],[In,30,30*dr],[o,1,yn],[o,5,5*yn],[o,15,15*yn],[o,30,30*yn],[i,1,mr],[i,3,3*mr],[i,6,6*mr],[i,12,12*mr],[r,1,yr],[r,2,2*yr],[n,1,Uh],[t,1,r0],[t,3,3*r0],[e,1,bc]];function s(u,c,f){const h=c<u;h&&([u,c]=[c,u]);const d=f&&typeof f.range=="function"?f:l(u,c,f),p=d?d.range(u,+c+1):[];return h?p.reverse():p}function l(u,c,f){const h=Math.abs(c-u)/f,d=tu(([,,y])=>y).right(a,h);if(d===a.length)return e.every(nf(u/bc,c/bc,f));if(d===0)return xl.every(Math.max(nf(u,c,f),1));const[p,b]=a[h/a[d-1][2]<a[d][2]/h?d-1:d];return p.every(b)}return[s,l]}const[e9,t9]=i2(Fn,Ja,so,_u,Za,Xa),[n9,r9]=i2(Dn,Qa,ao,_i,Ka,ja);function gc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function yc(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Do(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function i9(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,u=Fo(i),c=Bo(i),f=Fo(o),h=Bo(o),d=Fo(a),p=Bo(a),b=Fo(s),y=Bo(s),_=Fo(l),v=Bo(l),M={a:L,A:X,b:U,B:z,c:null,d:u0,e:u0,f:P9,g:R9,G:O9,H:E9,I:A9,j:C9,L:o2,m:x9,M:N9,p:G,q:R,Q:h0,s:d0,S:T9,u:I9,U:k9,V:$9,w:D9,W:F9,x:null,X:null,y:B9,Y:L9,Z:G9,"%":f0},g={a:Y,A:re,b:Q,B:J,c:null,d:c0,e:c0,f:H9,g:eS,G:nS,H:U9,I:q9,j:z9,L:s2,m:V9,M:Y9,p:K,q:ee,Q:h0,s:d0,S:W9,u:j9,U:X9,V:K9,w:Z9,W:Q9,x:null,X:null,y:J9,Y:tS,Z:rS,"%":f0},w={a:S,A:P,b:I,B:$,c:D,d:s0,e:s0,f:v9,g:a0,G:o0,H:l0,I:l0,j:b9,L:_9,m:p9,M:g9,p:T,q:m9,Q:M9,s:S9,S:y9,u:u9,U:c9,V:f9,w:l9,W:h9,x:A,X:F,y:a0,Y:o0,Z:d9,"%":w9};M.x=E(n,M),M.X=E(r,M),M.c=E(t,M),g.x=E(n,g),g.X=E(r,g),g.c=E(t,g);function E(j,V){return function(te){var B=[],se=-1,Z=0,ie=j.length,le,ve,we;for(te instanceof Date||(te=new Date(+te));++se<ie;)j.charCodeAt(se)===37&&(B.push(j.slice(Z,se)),(ve=i0[le=j.charAt(++se)])!=null?le=j.charAt(++se):ve=le==="e"?" ":"0",(we=V[le])&&(le=we(te,ve)),B.push(le),Z=se+1);return B.push(j.slice(Z,se)),B.join("")}}function N(j,V){return function(te){var B=Do(1900,void 0,1),se=x(B,j,te+="",0),Z,ie;if(se!=te.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(V&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Z=yc(Do(B.y,0,1)),ie=Z.getUTCDay(),Z=ie>4||ie===0?Ma.ceil(Z):Ma(Z),Z=yu.offset(Z,(B.V-1)*7),B.y=Z.getUTCFullYear(),B.m=Z.getUTCMonth(),B.d=Z.getUTCDate()+(B.w+6)%7):(Z=gc(Do(B.y,0,1)),ie=Z.getDay(),Z=ie>4||ie===0?wa.ceil(Z):wa(Z),Z=_i.offset(Z,(B.V-1)*7),B.y=Z.getFullYear(),B.m=Z.getMonth(),B.d=Z.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),ie="Z"in B?yc(Do(B.y,0,1)).getUTCDay():gc(Do(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(ie+5)%7:B.w+B.U*7-(ie+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,yc(B)):gc(B)}}function x(j,V,te,B){for(var se=0,Z=V.length,ie=te.length,le,ve;se<Z;){if(B>=ie)return-1;if(le=V.charCodeAt(se++),le===37){if(le=V.charAt(se++),ve=w[le in i0?V.charAt(se++):le],!ve||(B=ve(j,te,B))<0)return-1}else if(le!=te.charCodeAt(B++))return-1}return B}function T(j,V,te){var B=u.exec(V.slice(te));return B?(j.p=c.get(B[0].toLowerCase()),te+B[0].length):-1}function S(j,V,te){var B=d.exec(V.slice(te));return B?(j.w=p.get(B[0].toLowerCase()),te+B[0].length):-1}function P(j,V,te){var B=f.exec(V.slice(te));return B?(j.w=h.get(B[0].toLowerCase()),te+B[0].length):-1}function I(j,V,te){var B=_.exec(V.slice(te));return B?(j.m=v.get(B[0].toLowerCase()),te+B[0].length):-1}function $(j,V,te){var B=b.exec(V.slice(te));return B?(j.m=y.get(B[0].toLowerCase()),te+B[0].length):-1}function D(j,V,te){return x(j,t,V,te)}function A(j,V,te){return x(j,n,V,te)}function F(j,V,te){return x(j,r,V,te)}function L(j){return a[j.getDay()]}function X(j){return o[j.getDay()]}function U(j){return l[j.getMonth()]}function z(j){return s[j.getMonth()]}function G(j){return i[+(j.getHours()>=12)]}function R(j){return 1+~~(j.getMonth()/3)}function Y(j){return a[j.getUTCDay()]}function re(j){return o[j.getUTCDay()]}function Q(j){return l[j.getUTCMonth()]}function J(j){return s[j.getUTCMonth()]}function K(j){return i[+(j.getUTCHours()>=12)]}function ee(j){return 1+~~(j.getUTCMonth()/3)}return{format:function(j){var V=E(j+="",M);return V.toString=function(){return j},V},parse:function(j){var V=N(j+="",!1);return V.toString=function(){return j},V},utcFormat:function(j){var V=E(j+="",g);return V.toString=function(){return j},V},utcParse:function(j){var V=N(j+="",!0);return V.toString=function(){return j},V}}}var i0={"-":"",_:" ",0:"0"},Pt=/^\s*\d+/,o9=/^%/,a9=/[\\^$*+?|[\]().{}]/g;function Ye(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function s9(e){return e.replace(a9,"\\$&")}function Fo(e){return new RegExp("^(?:"+e.map(s9).join("|")+")","i")}function Bo(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function l9(e,t,n){var r=Pt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function u9(e,t,n){var r=Pt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function c9(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function f9(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function h9(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function o0(e,t,n){var r=Pt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function a0(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function d9(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function m9(e,t,n){var r=Pt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function p9(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function s0(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function b9(e,t,n){var r=Pt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function l0(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function g9(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function y9(e,t,n){var r=Pt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function _9(e,t,n){var r=Pt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function v9(e,t,n){var r=Pt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function w9(e,t,n){var r=o9.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function M9(e,t,n){var r=Pt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function S9(e,t,n){var r=Pt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function u0(e,t){return Ye(e.getDate(),t,2)}function E9(e,t){return Ye(e.getHours(),t,2)}function A9(e,t){return Ye(e.getHours()%12||12,t,2)}function C9(e,t){return Ye(1+_i.count(Dn(e),e),t,3)}function o2(e,t){return Ye(e.getMilliseconds(),t,3)}function P9(e,t){return o2(e,t)+"000"}function x9(e,t){return Ye(e.getMonth()+1,t,2)}function N9(e,t){return Ye(e.getMinutes(),t,2)}function T9(e,t){return Ye(e.getSeconds(),t,2)}function I9(e){var t=e.getDay();return t===0?7:t}function k9(e,t){return Ye(ao.count(Dn(e)-1,e),t,2)}function a2(e){var t=e.getDay();return t>=4||t===0?mi(e):mi.ceil(e)}function $9(e,t){return e=a2(e),Ye(mi.count(Dn(e),e)+(Dn(e).getDay()===4),t,2)}function D9(e){return e.getDay()}function F9(e,t){return Ye(wa.count(Dn(e)-1,e),t,2)}function B9(e,t){return Ye(e.getFullYear()%100,t,2)}function R9(e,t){return e=a2(e),Ye(e.getFullYear()%100,t,2)}function L9(e,t){return Ye(e.getFullYear()%1e4,t,4)}function O9(e,t){var n=e.getDay();return e=n>=4||n===0?mi(e):mi.ceil(e),Ye(e.getFullYear()%1e4,t,4)}function G9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ye(t/60|0,"0",2)+Ye(t%60,"0",2)}function c0(e,t){return Ye(e.getUTCDate(),t,2)}function U9(e,t){return Ye(e.getUTCHours(),t,2)}function q9(e,t){return Ye(e.getUTCHours()%12||12,t,2)}function z9(e,t){return Ye(1+yu.count(Fn(e),e),t,3)}function s2(e,t){return Ye(e.getUTCMilliseconds(),t,3)}function H9(e,t){return s2(e,t)+"000"}function V9(e,t){return Ye(e.getUTCMonth()+1,t,2)}function Y9(e,t){return Ye(e.getUTCMinutes(),t,2)}function W9(e,t){return Ye(e.getUTCSeconds(),t,2)}function j9(e){var t=e.getUTCDay();return t===0?7:t}function X9(e,t){return Ye(so.count(Fn(e)-1,e),t,2)}function l2(e){var t=e.getUTCDay();return t>=4||t===0?pi(e):pi.ceil(e)}function K9(e,t){return e=l2(e),Ye(pi.count(Fn(e),e)+(Fn(e).getUTCDay()===4),t,2)}function Z9(e){return e.getUTCDay()}function Q9(e,t){return Ye(Ma.count(Fn(e)-1,e),t,2)}function J9(e,t){return Ye(e.getUTCFullYear()%100,t,2)}function eS(e,t){return e=l2(e),Ye(e.getUTCFullYear()%100,t,2)}function tS(e,t){return Ye(e.getUTCFullYear()%1e4,t,4)}function nS(e,t){var n=e.getUTCDay();return e=n>=4||n===0?pi(e):pi.ceil(e),Ye(e.getUTCFullYear()%1e4,t,4)}function rS(){return"+0000"}function f0(){return"%"}function h0(e){return+e}function d0(e){return Math.floor(+e/1e3)}var Ii,qh,es;iS({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iS(e){return Ii=i9(e),qh=Ii.format,Ii.parse,es=Ii.utcFormat,Ii.utcParse,Ii}function oS(e){return new Date(e)}function aS(e){return e instanceof Date?+e:+new Date(+e)}function zh(e,t,n,r,i,o,a,s,l,u){var c=Og(),f=c.invert,h=c.domain,d=u(".%L"),p=u(":%S"),b=u("%I:%M"),y=u("%I %p"),_=u("%a %d"),v=u("%b %d"),M=u("%B"),g=u("%Y");function w(E){return(l(E)<E?d:s(E)<E?p:a(E)<E?b:o(E)<E?y:r(E)<E?i(E)<E?_:v:n(E)<E?M:g)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?h(Array.from(E,aS)):h().map(oS)},c.ticks=function(E){var N=h();return e(N[0],N[N.length-1],E??10)},c.tickFormat=function(E,N){return N==null?w:u(N)},c.nice=function(E){var N=h();return(!E||typeof E.range!="function")&&(E=t(N[0],N[N.length-1],E??10)),E?h(Ug(N,E)):c},c.copy=function(){return Ya(c,zh(e,t,n,r,i,o,a,s,l,u))},c}function sS(){return rr.apply(zh(n9,r9,Dn,Qa,ao,_i,Ka,ja,In,qh).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lS(){return rr.apply(zh(e9,t9,Fn,Ja,so,yu,Za,Xa,In,es).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function vu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function wu(){var e=0,t=.5,n=1,r=1,i,o,a,s,l,u=gn,c,f=!1,h;function d(b){return isNaN(b=+b)?h:(b=.5+((b=+c(b))-o)*(r*b<r*o?s:l),u(f?Math.max(0,Math.min(1,b)):b))}d.domain=function(b){return arguments.length?([e,t,n]=b,i=c(e=+e),o=c(t=+t),a=c(n=+n),s=i===o?0:.5/(o-i),l=o===a?0:.5/(a-o),r=o<i?-1:1,d):[e,t,n]},d.clamp=function(b){return arguments.length?(f=!!b,d):f},d.interpolator=function(b){return arguments.length?(u=b,d):u};function p(b){return function(y){var _,v,M;return arguments.length?([_,v,M]=y,u=uu(b,[_,v,M]),d):[u(0),u(.5),u(1)]}}return d.range=p(Ha),d.rangeRound=p(Nh),d.unknown=function(b){return arguments.length?(h=b,d):h},function(b){return c=b,i=b(e),o=b(t),a=b(n),s=i===o?0:.5/(o-i),l=o===a?0:.5/(a-o),r=o<i?-1:1,d}}function u2(){var e=Wa(wu()(gn));return e.copy=function(){return vu(e,u2())},pu.apply(e,arguments)}function c2(){var e=qg(wu()).domain([.1,1,10]);return e.copy=function(){return vu(e,c2()).base(e.base())},pu.apply(e,arguments)}function f2(){var e=Hg(wu());return e.copy=function(){return vu(e,f2()).constant(e.constant())},pu.apply(e,arguments)}function h2(){var e=Yg(wu());return e.copy=function(){return vu(e,h2()).exponent(e.exponent())},pu.apply(e,arguments)}function De(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const uS=De("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),cS=De("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),fS=De("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),hS=De("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),dS=De("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),mS=De("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),pS=De("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),bS=De("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),gS=De("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),yS=De("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),_S=De("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Qe=e=>l7(e[e.length-1]);var d2=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(De);const m2=Qe(d2);var p2=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(De);const b2=Qe(p2);var g2=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(De);const y2=Qe(g2);var _2=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(De);const v2=Qe(_2);var Df=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(De);const Nl=Qe(Df);var w2=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(De);const M2=Qe(w2);var Ff=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(De);const Sa=Qe(Ff);var S2=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(De);const E2=Qe(S2);var A2=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(De);const C2=Qe(A2);var P2=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(De);const x2=Qe(P2);var N2=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(De);const T2=Qe(N2);var I2=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(De);const k2=Qe(I2);var $2=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(De);const D2=Qe($2);var F2=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(De);const B2=Qe(F2);var R2=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(De);const L2=Qe(R2);var O2=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(De);const G2=Qe(O2);var U2=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(De);const q2=Qe(U2);var z2=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(De);const H2=Qe(z2);var V2=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(De);const Y2=Qe(V2);var W2=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(De);const j2=Qe(W2);var X2=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(De);const K2=Qe(X2);var Z2=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(De);const Q2=Qe(Z2);var J2=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(De);const ey=Qe(J2);var ty=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(De);const ny=Qe(ty);var ry=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(De);const iy=Qe(ry);var oy=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(De);const ay=Qe(oy);var sy=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(De);const ly=Qe(sy);function uy(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const cy=Th(Jn(300,.5,0),Jn(-240,.5,1));var fy=Th(Jn(-100,.75,.35),Jn(80,1.5,.8)),hy=Th(Jn(260,.75,.35),Jn(80,1.5,.8)),Ts=Jn();function dy(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Ts.h=360*e-100,Ts.s=1.5-1.5*t,Ts.l=.8-.9*t,Ts+""}var Is=Lr(),vS=Math.PI/3,wS=Math.PI*2/3;function my(e){var t;return e=(.5-e)*Math.PI,Is.r=255*(t=Math.sin(e))*t,Is.g=255*(t=Math.sin(e+vS))*t,Is.b=255*(t=Math.sin(e+wS))*t,Is+""}function py(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function Mu(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const by=Mu(De("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var gy=Mu(De("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),yy=Mu(De("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),_y=Mu(De("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function ki(e){return function(){return e}}const vy=Math.cos,Hh=Math.min,Tl=Math.sin,gt=Math.sqrt,m0=1e-12,Il=Math.PI,Su=2*Il;function MS(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new ng(t)}function SS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wy(e){this._context=e}wy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Eu(e){return new wy(e)}function ES(e){return e[0]}function AS(e){return e[1]}function CS(e,t){var n=ki(!0),r=null,i=Eu,o=null,a=MS(s);e=typeof e=="function"?e:e===void 0?ES:ki(e),t=typeof t=="function"?t:t===void 0?AS:ki(t);function s(l){var u,c=(l=SS(l)).length,f,h=!1,d;for(r==null&&(o=i(d=a())),u=0;u<=c;++u)!(u<c&&n(f=l[u],u,l))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(f,u,l),+t(f,u,l));if(d)return o=null,d+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:ki(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:ki(+l),s):t},s.defined=function(l){return arguments.length?(n=typeof l=="function"?l:ki(!!l),s):n},s.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),s):i},s.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),s):r},s}class My{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function PS(e){return new My(e,!0)}function xS(e){return new My(e,!1)}const NS=gt(3),Sy={draw(e,t){const n=gt(t+Hh(t/28,.75))*.59436,r=n/2,i=r*NS;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},Ea={draw(e,t){const n=gt(t/Il);e.moveTo(n,0),e.arc(0,0,n,0,Su)}},Ey={draw(e,t){const n=gt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},Ay=gt(1/3),TS=Ay*2,Cy={draw(e,t){const n=gt(t/TS),r=n*Ay;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},Py={draw(e,t){const n=gt(t)*.62625;e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},xy={draw(e,t){const n=gt(t-Hh(t/7,2))*.87559;e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},Ny={draw(e,t){const n=gt(t),r=-n/2;e.rect(r,r,n,n)}},Ty={draw(e,t){const n=gt(t)*.4431;e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},IS=.8908130915292852,Iy=Tl(Il/10)/Tl(7*Il/10),kS=Tl(Su/10)*Iy,$S=-vy(Su/10)*Iy,ky={draw(e,t){const n=gt(t*IS),r=kS*n,i=$S*n;e.moveTo(0,-n),e.lineTo(r,i);for(let o=1;o<5;++o){const a=Su*o/5,s=vy(a),l=Tl(a);e.lineTo(l*n,-s*n),e.lineTo(s*r-l*i,l*r+s*i)}e.closePath()}},_c=gt(3),$y={draw(e,t){const n=-gt(t/(_c*3));e.moveTo(0,n*2),e.lineTo(-_c*n,-n),e.lineTo(_c*n,-n),e.closePath()}},DS=gt(3),Dy={draw(e,t){const n=gt(t)*.6824,r=n/2,i=n*DS/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},hn=-.5,dn=gt(3)/2,Bf=1/gt(12),FS=(Bf/2+1)*3,Fy={draw(e,t){const n=gt(t/FS),r=n/2,i=n*Bf,o=r,a=n*Bf+n,s=-o,l=a;e.moveTo(r,i),e.lineTo(o,a),e.lineTo(s,l),e.lineTo(hn*r-dn*i,dn*r+hn*i),e.lineTo(hn*o-dn*a,dn*o+hn*a),e.lineTo(hn*s-dn*l,dn*s+hn*l),e.lineTo(hn*r+dn*i,hn*i-dn*r),e.lineTo(hn*o+dn*a,hn*a-dn*o),e.lineTo(hn*s+dn*l,hn*l-dn*s),e.closePath()}},By={draw(e,t){const n=gt(t-Hh(t/6,1.7))*.6189;e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},BS=[Ea,Ey,Cy,Ny,ky,$y,Fy],RS=[Ea,xy,By,Dy,Sy,Ty,Py];function Or(){}function kl(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Au(e){this._context=e}Au.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function LS(e){return new Au(e)}function Ry(e){this._context=e}Ry.prototype={areaStart:Or,areaEnd:Or,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OS(e){return new Ry(e)}function Ly(e){this._context=e}Ly.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:kl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function GS(e){return new Ly(e)}function Oy(e,t){this._basis=new Au(e),this._beta=t}Oy.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,a=t[n]-i,s=-1,l;++s<=n;)l=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+l*o),this._beta*t[s]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const US=function e(t){function n(r){return t===1?new Au(r):new Oy(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function $l(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Vh(e,t){this._context=e,this._k=(1-t)/6}Vh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:$l(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:$l(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const qS=function e(t){function n(r){return new Vh(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Yh(e,t){this._context=e,this._k=(1-t)/6}Yh.prototype={areaStart:Or,areaEnd:Or,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:$l(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const zS=function e(t){function n(r){return new Yh(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Wh(e,t){this._context=e,this._k=(1-t)/6}Wh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$l(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const HS=function e(t){function n(r){return new Wh(r,t)}return n.tension=function(r){return e(+r)},n}(0);function jh(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>m0){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>m0){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function Gy(e,t){this._context=e,this._alpha=t}Gy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:jh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const VS=function e(t){function n(r){return t?new Gy(r,t):new Vh(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Uy(e,t){this._context=e,this._alpha=t}Uy.prototype={areaStart:Or,areaEnd:Or,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:jh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const YS=function e(t){function n(r){return t?new Uy(r,t):new Yh(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function qy(e,t){this._context=e,this._alpha=t}qy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:jh(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const WS=function e(t){function n(r){return t?new qy(r,t):new Wh(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function zy(e){this._context=e}zy.prototype={areaStart:Or,areaEnd:Or,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function jS(e){return new zy(e)}function p0(e){return e<0?-1:1}function b0(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(p0(o)+p0(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function g0(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function vc(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function Dl(e){this._context=e}Dl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:vc(this,this._t0,g0(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,vc(this,g0(this,n=b0(this,e,t)),n);break;default:vc(this,this._t0,n=b0(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Hy(e){this._context=new Vy(e)}(Hy.prototype=Object.create(Dl.prototype)).point=function(e,t){Dl.prototype.point.call(this,t,e)};function Vy(e){this._context=e}Vy.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function XS(e){return new Dl(e)}function KS(e){return new Hy(e)}function Yy(e){this._context=e}Yy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=y0(e),i=y0(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function y0(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),a=new Array(n);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function ZS(e){return new Yy(e)}function Cu(e,t){this._context=e,this._t=t}Cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function QS(e){return new Cu(e,.5)}function JS(e){return new Cu(e,0)}function eE(e){return new Cu(e,1)}function jo(e,t,n){this.k=e,this.x=t,this.y=n}jo.prototype={constructor:jo,scale:function(e){return e===1?this:new jo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new jo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};jo.prototype;function tE(e){return 60*1/e}function Wy(e,t){return Ce(Math.ceil(e/12)*12,t+1,12)}function Pu(e,t,n){return e<t?t:e>n?n:e}function jy(e){return new Promise(t=>{setTimeout(t,e*1e3)})}function wc(e,t){return e.has(t)?e.delete(t):e.add(t),new Set(e)}function _0(e,t){for(const n of t)if(e.has(n))return!0;return!1}var Ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ky={exports:{}};(function(e,t){(function(n,r){r()})(Ro,function(){function n(u,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function r(u,c,f){var h=new XMLHttpRequest;h.open("GET",u),h.responseType="blob",h.onload=function(){l(h.response,c,f)},h.onerror=function(){console.error("could not download file")},h.send()}function i(u){var c=new XMLHttpRequest;c.open("HEAD",u,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Ro=="object"&&Ro.global===Ro?Ro:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,c,f){var h=a.URL||a.webkitURL,d=document.createElement("a");c=c||u.name||"download",d.download=c,d.rel="noopener",typeof u=="string"?(d.href=u,d.origin===location.origin?o(d):i(d.href)?r(u,c,f):o(d,d.target="_blank")):(d.href=h.createObjectURL(u),setTimeout(function(){h.revokeObjectURL(d.href)},4e4),setTimeout(function(){o(d)},0))}:"msSaveOrOpenBlob"in navigator?function(u,c,f){if(c=c||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(n(u,f),c);else if(i(u))r(u,c,f);else{var h=document.createElement("a");h.href=u,h.target="_blank",setTimeout(function(){o(h)})}}:function(u,c,f,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof u=="string")return r(u,c,f);var d=u.type==="application/octet-stream",p=/constructor/i.test(a.HTMLElement)||a.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||d&&p||s)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var M=y.result;M=b?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=M:location=M,h=null},y.readAsDataURL(u)}else{var _=a.URL||a.webkitURL,v=_.createObjectURL(u);h?h.location=v:location.href=v,h=null,setTimeout(function(){_.revokeObjectURL(v)},4e4)}});a.saveAs=l.saveAs=l,e.exports=l})})(Ky);var nE=Ky.exports;const Zy=Xy(nE);class kn{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,n,r={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==kn.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof n!="function")throw new TypeError("The callback must be a function.");const i=new v0(t,this,n,r);return this.eventMap[t]||(this.eventMap[t]=[]),r.prepend?this.eventMap[t].unshift(i):this.eventMap[t].push(i),i}addOneTimeListener(t,n,r={}){r.remaining=1,this.addListener(t,n,r)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,n){return t===void 0?this.eventMap[kn.ANY_EVENT]&&this.eventMap[kn.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,r])=>r.length>0):this.eventMap[t]&&this.eventMap[t].length>0?n instanceof v0?this.eventMap[t].filter(i=>i===n).length>0:typeof n=="function"?this.eventMap[t].filter(i=>i.callback===n).length>0:n==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(n=>{n.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(n=>{n.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...n){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let r=[],i=this.eventMap[kn.ANY_EVENT]||[];return this.eventMap[t]&&(i=i.concat(this.eventMap[t])),i.forEach(o=>{if(o.suspended)return;let a=[...n];Array.isArray(o.arguments)&&(a=a.concat(o.arguments)),o.remaining>0&&(r.push(o.callback.apply(o.context,a)),o.count++),--o.remaining<1&&o.remove()}),r}removeListener(t,n,r={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let i=this.eventMap[t].filter(o=>n&&o.callback!==n||r.remaining&&r.remaining!==o.remaining||r.context&&r.context!==o.context);i.length?this.eventMap[t]=i:delete this.eventMap[t]}async waitFor(t,n={}){return n.duration=parseInt(n.duration),(isNaN(n.duration)||n.duration<=0)&&(n.duration=1/0),new Promise((r,i)=>{let o,a=this.addListener(t,()=>{clearTimeout(o),r()},{remaining:1});n.duration!==1/0&&(o=setTimeout(()=>{a.remove(),i("The duration expired before the event was emitted.")},n.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class v0{constructor(t,n,r,i={}){if(typeof t!="string"&&!(t instanceof String)&&t!==kn.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!n)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof r!="function")throw new TypeError("The 'callback' must be a function.");i.arguments!==void 0&&!Array.isArray(i.arguments)&&(i.arguments=[i.arguments]),i=Object.assign({context:n,remaining:1/0,arguments:void 0,duration:1/0},i),i.duration!==1/0&&setTimeout(()=>this.remove(),i.duration),this.arguments=i.arguments,this.callback=r,this.context=i.context,this.count=0,this.event=t,this.remaining=parseInt(i.remaining)>=1?parseInt(i.remaining):1/0,this.suspended=!1,this.target=n}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class oe{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),oe.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),oe.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),oe.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),oe.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Oi{constructor(t,n={}){this.duration=W.defaults.note.duration,this.attack=W.defaults.note.attack,this.release=W.defaults.note.release,n.duration!=null&&(this.duration=n.duration),n.attack!=null&&(this.attack=n.attack),n.rawAttack!=null&&(this.attack=me.from7bitToFloat(n.rawAttack)),n.release!=null&&(this.release=n.release),n.rawRelease!=null&&(this.release=me.from7bitToFloat(n.rawRelease)),Number.isInteger(t)?this.identifier=me.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const n=me.getNoteDetails(t);if(W.validation&&!t)throw new Error("Invalid note identifier");this._name=n.name,this._accidental=n.accidental,this._octave=n.octave}get name(){return this._name}set name(t){if(W.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(W.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(W.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(W.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(W.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(W.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return me.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=me.from7bitToFloat(t)}get rawRelease(){return me.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=me.from7bitToFloat(t)}get number(){return me.toNoteNumber(this.identifier)}getOffsetNumber(t=0,n=0){return W.validation&&(t=parseInt(t)||0,n=parseInt(n)||0),Math.min(Math.max(this.number+t*12+n,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class me{static toNoteNumber(t,n=0){if(n=n==null?0:parseInt(n),isNaN(n))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const r=this.getNoteDetails(t);if(!r)throw new TypeError("Invalid note identifier");const i={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let o=(r.octave+1+n)*12;if(o+=i[r.name],r.accidental&&(r.accidental.startsWith("b")?o-=r.accidental.length:o+=r.accidental.length),o<0||o>127)throw new RangeError("Invalid octaveOffset value");return o}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const n=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!n)throw new TypeError("Invalid note identifier");const r=n[1].toUpperCase(),i=parseInt(n[3]);let o=n[2].toLowerCase();return o=o===""?void 0:o,{accidental:o,identifier:r+(o||"")+i,name:r,octave:i}}static sanitizeChannels(t){let n;if(W.validation){if(t==="all")n=["all"];else if(t==="none")return[]}return Array.isArray(t)?n=t:n=[t],n.indexOf("all")>-1&&(n=oe.MIDI_CHANNEL_NUMBERS),n.map(function(r){return parseInt(r)}).filter(function(r){return r>=1&&r<=16})}static toTimestamp(t){let n=!1;const r=parseFloat(t);return isNaN(r)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?r>=0&&(n=W.time+r):r>=0&&(n=r),n)}static guessNoteNumber(t,n){n=parseInt(n)||0;let r=!1;if(Number.isInteger(t)&&t>=0&&t<=127)r=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)r=parseInt(t);else if(typeof t=="string"||t instanceof String)try{r=this.toNoteNumber(t.trim(),n)}catch{return!1}return r}static toNoteIdentifier(t,n){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(n=n==null?0:parseInt(n),isNaN(n))throw new RangeError("Invalid octaveOffset value");const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],i=Math.floor(t/12-1)+n;return r[t%12]+i.toString()}static buildNote(t,n={}){if(n.octaveOffset=parseInt(n.octaveOffset)||0,t instanceof Oi)return t;let r=this.guessNoteNumber(t,n.octaveOffset);if(r===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return n.octaveOffset=void 0,new Oi(r,n)}static buildNoteArray(t,n={}){let r=[];return Array.isArray(t)||(t=[t]),t.forEach(i=>{r.push(this.buildNote(i,n))}),r}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,n=0){W.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),n=Math.min(Math.max(parseInt(n)||0,0),127));const r=((t<<7)+n)/16383;return Math.min(Math.max(r,0),1)}static fromFloatToMsbLsb(t){W.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const n=Math.round(t*16383);return{msb:n>>7,lsb:n&127}}static offsetNumber(t,n=0,r=0){if(W.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");n=parseInt(n)||0,r=parseInt(r)||0}return Math.min(Math.max(t+n*12+r,0),127)}static getPropertyByValue(t,n){return Object.keys(t).find(r=>t[r]===n)}static getCcNameByNumber(t){if(!(W.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return oe.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let n=oe.CONTROL_CHANGE_MESSAGES.find(r=>r.name===t);return n?n.number:oe.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let n in oe.CHANNEL_MODE_MESSAGES)if(oe.CHANNEL_MODE_MESSAGES.hasOwnProperty(n)&&t===oe.CHANNEL_MODE_MESSAGES[n])return n;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class rE extends kn{constructor(t,n){super(),this._output=t,this._number=n,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,n={time:0}){return this.output.send(t,n),this}sendKeyAftertouch(t,n,r={}){if(W.validation){if(r.useRawValue&&(r.rawValue=r.useRawValue),isNaN(parseFloat(n)))throw new RangeError("Invalid key aftertouch value.");if(r.rawValue){if(!(n>=0&&n<=127&&Number.isInteger(n)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(n>=0&&n<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}r.rawValue||(n=me.fromFloatTo7Bit(n));const i=W.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),me.buildNoteArray(t).forEach(o=>{this.send([(oe.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),o.getOffsetNumber(i),n],{time:me.toTimestamp(r.time)})}),this}sendControlChange(t,n,r={}){if(typeof t=="string"&&(t=me.getCcNumberByName(t)),Array.isArray(n)||(n=[n]),W.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(n=n.map(i=>{const o=Math.min(Math.max(parseInt(i),0),127);if(isNaN(o))throw new TypeError("Values must be integers between 0 and 127");return o}),n.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return n.forEach((i,o)=>{this.send([(oe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+o*32,n[o]],{time:me.toTimestamp(r.time)})}),this}_selectNonRegisteredParameter(t,n={}){return this.sendControlChange(99,t[0],n),this.sendControlChange(98,t[1],n),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,n={}){return this.sendControlChange(101,t[0],n),this.sendControlChange(100,t[1],n),this}_setCurrentParameter(t,n={}){return t=[].concat(t),this.sendControlChange(6,t[0],n),t.length<2?this:(this.sendControlChange(38,t[1],n),this)}sendRpnDecrement(t,n={}){if(Array.isArray(t)||(t=oe.REGISTERED_PARAMETERS[t]),W.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(oe.REGISTERED_PARAMETERS).forEach(i=>{oe.REGISTERED_PARAMETERS[i][0]===t[0]&&oe.REGISTERED_PARAMETERS[i][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,n),this.sendControlChange(97,0,n),this._deselectRegisteredParameter(n),this}sendRpnIncrement(t,n={}){if(Array.isArray(t)||(t=oe.REGISTERED_PARAMETERS[t]),W.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(oe.REGISTERED_PARAMETERS).forEach(i=>{oe.REGISTERED_PARAMETERS[i][0]===t[0]&&oe.REGISTERED_PARAMETERS[i][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,n),this.sendControlChange(96,0,n),this._deselectRegisteredParameter(n),this}playNote(t,n={}){this.sendNoteOn(t,n);const r=Array.isArray(t)?t:[t];for(let i of r)if(parseInt(i.duration)>0){const o={time:(me.toTimestamp(n.time)||W.time)+parseInt(i.duration),release:i.release,rawRelease:i.rawRelease};this.sendNoteOff(i,o)}else if(parseInt(n.duration)>0){const o={time:(me.toTimestamp(n.time)||W.time)+parseInt(n.duration),release:n.release,rawRelease:n.rawRelease};this.sendNoteOff(i,o)}return this}sendNoteOff(t,n={}){if(W.validation){if(n.rawRelease!=null&&!(n.rawRelease>=0&&n.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(n.release!=null&&!(n.release>=0&&n.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");n.rawVelocity&&(n.rawRelease=n.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),n.velocity&&(n.release=n.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;n.rawRelease!=null?r=n.rawRelease:isNaN(n.release)||(r=Math.round(n.release*127));const i=W.octaveOffset+this.output.octaveOffset+this.octaveOffset;return me.buildNoteArray(t,{rawRelease:parseInt(r)}).forEach(o=>{this.send([(oe.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),o.getOffsetNumber(i),o.rawRelease],{time:me.toTimestamp(n.time)})}),this}stopNote(t,n={}){return this.sendNoteOff(t,n)}sendNoteOn(t,n={}){if(W.validation){if(n.rawAttack!=null&&!(n.rawAttack>=0&&n.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(n.attack!=null&&!(n.attack>=0&&n.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");n.rawVelocity&&(n.rawAttack=n.velocity,n.rawRelease=n.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),n.velocity&&(n.attack=n.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;n.rawAttack!=null?r=n.rawAttack:isNaN(n.attack)||(r=Math.round(n.attack*127));const i=W.octaveOffset+this.output.octaveOffset+this.octaveOffset;return me.buildNoteArray(t,{rawAttack:r}).forEach(o=>{this.send([(oe.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),o.getOffsetNumber(i),o.rawAttack],{time:me.toTimestamp(n.time)})}),this}sendChannelMode(t,n=0,r={}){if(typeof t=="string"&&(t=oe.CHANNEL_MODE_MESSAGES[t]),W.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(n))||n<0||n>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(oe.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,n],{time:me.toTimestamp(r.time)}),this}sendOmniMode(t,n={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,n):this.sendChannelMode("omnimodeoff",0,n),this}sendChannelAftertouch(t,n={}){if(W.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(n.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return n.rawValue||(t=me.fromFloatTo7Bit(t)),this.send([(oe.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:me.toTimestamp(n.time)}),this}sendMasterTuning(t,n={}){if(t=parseFloat(t)||0,W.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let r=Math.floor(t)+64,i=t-Math.floor(t);i=Math.round((i+1)/2*16383);let o=i>>7&127,a=i&127;return this.sendRpnValue("channelcoarsetuning",r,n),this.sendRpnValue("channelfinetuning",[o,a],n),this}sendModulationRange(t,n,r={}){if(W.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(n!=null&&(!Number.isInteger(n)||!(n>=0&&n<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return n>=0&&n<=127||(n=0),this.sendRpnValue("modulationrange",[t,n],r),this}sendNrpnValue(t,n,r={}){if(n=[].concat(n),W.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");n.forEach(i=>{if(!(i>=0&&i<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,r),this._setCurrentParameter(n,r),this._deselectNonRegisteredParameter(r),this}sendPitchBend(t,n={}){if(W.validation)if(n.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(n.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let r=0,i=0;if(n.rawValue&&Array.isArray(t))r=t[0],i=t[1];else if(n.rawValue&&!Array.isArray(t))r=t;else{const o=me.fromFloatToMsbLsb((t+1)/2);r=o.msb,i=o.lsb}return this.send([(oe.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),i,r],{time:me.toTimestamp(n.time)}),this}sendPitchBendRange(t,n,r={}){if(W.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(n)||!(n>=0&&n<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,n],r),this}sendProgramChange(t,n={}){if(t=parseInt(t)||0,W.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(oe.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:me.toTimestamp(n.time)}),this}sendRpnValue(t,n,r={}){if(Array.isArray(t)||(t=oe.REGISTERED_PARAMETERS[t]),W.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(n).forEach(i=>{if(!(i>=0&&i<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,r),this._setCurrentParameter(n,r),this._deselectRegisteredParameter(r),this}sendTuningBank(t,n={}){if(W.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,n),this}sendTuningProgram(t,n={}){if(W.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,n),this}sendLocalControl(t,n={}){return t?this.sendChannelMode("localcontrol",127,n):this.sendChannelMode("localcontrol",0,n)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,n={}){return t==="mono"?this.sendChannelMode("monomodeon",0,n):this.sendChannelMode("polymodeon",0,n)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class Rf extends kn{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let n=1;n<=16;n++)this.channels[n]=new rE(this,n);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let n={timestamp:W.time};t.port.connection==="open"?(n.type="opened",n.target=this,n.port=n.target,this.emit("opened",n)):t.port.connection==="closed"&&t.port.state==="connected"?(n.type="closed",n.target=this,n.port=n.target,this.emit("closed",n)):t.port.connection==="closed"&&t.port.state==="disconnected"?(n.type="disconnected",n.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",n)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,n={time:0},r=0){if(t instanceof Qy&&(t=me.isNode?t.data:t.rawData),t instanceof Uint8Array&&me.isNode&&(t=Array.from(t)),W.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(n)&&(t=t.concat(n)),n=isNaN(r)?{time:0}:{time:r}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(i=>{if(i=parseInt(i),!(i>=0&&i<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),n||(n={time:0})}return this._midiOutput.send(t,me.toTimestamp(n.time)),this}sendSysex(t,n=[],r={}){if(t=[].concat(t),n instanceof Uint8Array){const i=new Uint8Array(1+t.length+n.length+1);i[0]=oe.SYSTEM_MESSAGES.sysex,i.set(Uint8Array.from(t),1),i.set(n,1+t.length),i[i.length-1]=oe.SYSTEM_MESSAGES.sysexend,this.send(i,{time:r.time})}else{const i=t.concat(n,oe.SYSTEM_MESSAGES.sysexend);this.send([oe.SYSTEM_MESSAGES.sysex].concat(i),{time:r.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():W.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,n={}){if(W.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([oe.SYSTEM_MESSAGES.timecode,t],{time:n.time}),this}sendSongPosition(t=0,n={}){t=Math.floor(t)||0;var r=t>>7&127,i=t&127;return this.send([oe.SYSTEM_MESSAGES.songposition,r,i],{time:n.time}),this}sendSongSelect(t=0,n={}){if(W.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([oe.SYSTEM_MESSAGES.songselect,t],{time:n.time}),this}sendTuneRequest(t={}){return this.send([oe.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([oe.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([oe.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([oe.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([oe.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([oe.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([oe.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return W.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,n,r={}){return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendKeyAftertouch(t,n,r)}),this}sendControlChange(t,n,r={},i={}){if(W.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendControlChange(t,n,r)}),this}sendPitchBendRange(t=0,n=0,r={}){return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendPitchBendRange(t,n,r)}),this}setPitchBendRange(t=0,n=0,r="all",i={}){return W.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),i.channels=r,i.channels==="all"&&(i.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,n,i)}sendRpnValue(t,n,r={}){return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnValue(t,n,r)}),this}setRegisteredParameter(t,n=[],r="all",i={}){return W.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),i.channels=r,i.channels==="all"&&(i.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,n,i)}sendChannelAftertouch(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendChannelAftertouch(t,n)}),this}sendPitchBend(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendPitchBend(t,n)}),this}sendProgramChange(t=0,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendProgramChange(t,n)}),this}sendModulationRange(t,n,r={}){return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendModulationRange(t,n,r)}),this}setModulationRange(t=0,n=0,r="all",i={}){return W.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),i.channels=r,i.channels==="all"&&(i.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,n,i)}sendMasterTuning(t,n={}){return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendMasterTuning(t,n)}),this}setMasterTuning(t,n={},r={}){return W.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),r.channels=n,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,r)}sendTuningProgram(t,n={}){return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendTuningProgram(t,n)}),this}setTuningProgram(t,n="all",r={}){return W.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),r.channels=n,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,r)}sendTuningBank(t=0,n={}){return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendTuningBank(t,n)}),this}setTuningBank(t,n="all",r={}){return W.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),r.channels=n,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,r)}sendChannelMode(t,n=0,r={},i={}){if(W.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendChannelMode(t,n,r)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},n={}){if(W.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=oe.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendPolyphonicMode(t,n)}),this}sendLocalControl(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendLocalControl(t,n)}),this}sendOmniMode(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendOmniMode(t,n)}),this}sendNrpnValue(t,n,r={}){return r.channels==null&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendNrpnValue(t,n,r)}),this}setNonRegisteredParameter(t,n=[],r="all",i={}){return W.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),i.channels=r,i.channels==="all"&&(i.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,n,i)}sendRpnIncrement(t,n={}){return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnIncrement(t,n)}),this}incrementRegisteredParameter(t,n="all",r={}){return W.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),r.channels=n,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,r)}sendRpnDecrement(t,n={}){return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnDecrement(t,n)}),this}decrementRegisteredParameter(t,n="all",r={}){return W.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),r.channels=n,r.channels==="all"&&(r.channels=oe.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,r)}sendNoteOff(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendNoteOff(t,n)}),this}stopNote(t,n){return this.sendNoteOff(t,n)}playNote(t,n={},r={}){if(W.validation&&(n.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),n.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].playNote(t,n)}),this}sendNoteOn(t,n={},r={}){if(W.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=oe.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendNoteOn(t,n)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class w0{constructor(t=[],n={}){this.destinations=[],this.types=[...Object.keys(oe.SYSTEM_MESSAGES),...Object.keys(oe.CHANNEL_MESSAGES)],this.channels=oe.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),n.types&&!Array.isArray(n.types)&&(n.types=[n.types]),n.channels&&!Array.isArray(n.channels)&&(n.channels=[n.channels]),W.validation&&(t.forEach(r=>{if(!(r instanceof Rf))throw new TypeError("Destinations must be of type 'Output'.")}),n.types!==void 0&&n.types.forEach(r=>{if(!oe.SYSTEM_MESSAGES.hasOwnProperty(r)&&!oe.CHANNEL_MESSAGES.hasOwnProperty(r))throw new TypeError("Type must be a valid message type.")}),n.channels!==void 0&&n.channels.forEach(r=>{if(!oe.MIDI_CHANNEL_NUMBERS.includes(r))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,n.types&&(this.types=n.types),n.channels&&(this.channels=n.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(n=>{W.validation&&!(n instanceof Rf)||n.send(t)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class iE extends kn{constructor(t,n){super(),this._input=t,this._number=n,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const n=Object.assign({},t);n.port=this.input,n.target=this,n.type="midimessage",this.emit(n.type,n),this._parseEventForStandardMessages(n)}_parseEventForStandardMessages(t){const n=Object.assign({},t);n.type=n.message.type||"unknownmessage";const r=t.message.dataBytes[0],i=t.message.dataBytes[1];if(n.type==="noteoff"||n.type==="noteon"&&i===0)this.notesState[r]=!1,n.type="noteoff",n.note=new Oi(me.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+W.octaveOffset),{rawAttack:0,rawRelease:i}),n.value=me.from7bitToFloat(i),n.rawValue=i,n.velocity=n.note.release,n.rawVelocity=n.note.rawRelease;else if(n.type==="noteon")this.notesState[r]=!0,n.note=new Oi(me.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+W.octaveOffset),{rawAttack:i}),n.value=me.from7bitToFloat(i),n.rawValue=i,n.velocity=n.note.attack,n.rawVelocity=n.note.rawAttack;else if(n.type==="keyaftertouch")n.note=new Oi(me.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+W.octaveOffset)),n.value=me.from7bitToFloat(i),n.rawValue=i,n.identifier=n.note.identifier,n.key=n.note.number,n.rawKey=r;else if(n.type==="controlchange"){n.controller={number:r,name:oe.CONTROL_CHANGE_MESSAGES[r].name,description:oe.CONTROL_CHANGE_MESSAGES[r].description,position:oe.CONTROL_CHANGE_MESSAGES[r].position},n.subtype=n.controller.name||"controller"+r,n.value=me.from7bitToFloat(i),n.rawValue=i;const o=Object.assign({},n);o.type=`${n.type}-controller${r}`,delete o.subtype,this.emit(o.type,o);const a=Object.assign({},n);a.type=`${n.type}-`+oe.CONTROL_CHANGE_MESSAGES[r].name,delete a.subtype,a.type.indexOf("controller")!==0&&this.emit(a.type,a),n.message.dataBytes[0]>=120&&this._parseChannelModeMessage(n),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(n.message.dataBytes[0])&&this._parseEventForParameterNumber(n)}else n.type==="programchange"?(n.value=r,n.rawValue=n.value):n.type==="channelaftertouch"?(n.value=me.from7bitToFloat(r),n.rawValue=r):n.type==="pitchbend"?(n.value=((i<<7)+r-8192)/8192,n.rawValue=(i<<7)+r):n.type="unknownmessage";this.emit(n.type,n)}_parseChannelModeMessage(t){const n=Object.assign({},t);n.type=n.controller.name,n.type==="localcontrol"&&(n.value=n.message.data[2]===127,n.rawValue=n.message.data[2]),n.type==="omnimodeon"?(n.type="omnimode",n.value=!0,n.rawValue=n.message.data[2]):n.type==="omnimodeoff"&&(n.type="omnimode",n.value=!1,n.rawValue=n.message.data[2]),n.type==="monomodeon"?(n.type="monomode",n.value=!0,n.rawValue=n.message.data[2]):n.type==="polymodeon"&&(n.type="monomode",n.value=!1,n.rawValue=n.message.data[2]),this.emit(n.type,n)}_parseEventForParameterNumber(t){const n=t.message.dataBytes[0],r=t.message.dataBytes[1];n===99||n===101?(this._nrpnBuffer=[],this._rpnBuffer=[],n===99?this._nrpnBuffer=[t.message]:r!==127&&(this._rpnBuffer=[t.message])):n===98||n===100?n===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&r!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(n===6||n===38||n===96||n===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,n,r,i){t=t==="nrpn"?"nrpn":"rpn";const o={target:i.target,timestamp:i.timestamp,message:i.message,parameterMsb:n,parameterLsb:r,value:me.from7bitToFloat(i.message.dataBytes[1]),rawValue:i.message.dataBytes[1]};t==="rpn"?o.parameter=Object.keys(oe.REGISTERED_PARAMETERS).find(l=>oe.REGISTERED_PARAMETERS[l][0]===n&&oe.REGISTERED_PARAMETERS[l][1]===r):o.parameter=(n<<7)+r;const a=oe.CONTROL_CHANGE_MESSAGES[i.message.dataBytes[0]].name;o.type=`${t}-${a}`,this.emit(o.type,o);const s=Object.assign({},o);s.type==="nrpn-dataincrement"?s.type="nrpn-databuttonincrement":s.type==="nrpn-datadecrement"?s.type="nrpn-databuttondecrement":s.type==="rpn-dataincrement"?s.type="rpn-databuttonincrement":s.type==="rpn-datadecrement"&&(s.type="rpn-databuttondecrement"),this.emit(s.type,s),o.type=t,o.subtype=a,this.emit(o.type,o)}getChannelModeByNumber(t){return W.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),me.getChannelModeByNumber(t)}getCcNameByNumber(t){if(W.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return me.getCcNameByNumber(t)}getNoteState(t){t instanceof Oi&&(t=t.identifier);const n=me.guessNoteNumber(t,W.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[n]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Qy{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=me.getPropertyByValue(oe.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=me.getPropertyByValue(oe.SYSTEM_MESSAGES,this.command)),this.statusByte===oe.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class oE extends kn{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let n=1;n<=16;n++)this.channels[n]=new iE(this,n);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let n={timestamp:W.time,target:this,port:this};t.port.connection==="open"?(n.type="opened",this.emit("opened",n)):t.port.connection==="closed"&&t.port.state==="connected"?(n.type="closed",this.emit("closed",n)):t.port.connection==="closed"&&t.port.state==="disconnected"?(n.type="disconnected",n.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",n)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const n=new Qy(t.data),r={port:this,target:this,message:n,timestamp:t.timeStamp,type:"midimessage",data:n.data,rawData:n.data,statusByte:n.data[0],dataBytes:n.dataBytes};this.emit("midimessage",r),n.isSystemMessage?this._parseEvent(r):n.isChannelMessage&&this.channels[n.channel]._processMidiMessageEvent(r),this._forwarders.forEach(i=>i.forward(n))}_parseEvent(t){const n=Object.assign({},t);n.type=n.message.type||"unknownmidimessage",n.type==="songselect"&&(n.song=t.data[1]+1,n.value=t.data[1],n.rawValue=n.value),this.emit(n.type,n)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){W.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,n,r={}){if(W.validation&&typeof r=="function"){let i=n!=null?[].concat(n):void 0;n=r,r={channels:i}}if(oe.CHANNEL_EVENTS.includes(t)){r.channels===void 0&&(r.channels=oe.MIDI_CHANNEL_NUMBERS);let i=[];return me.sanitizeChannels(r.channels).forEach(o=>{i.push(this.channels[o].addListener(t,n,r))}),i}else return super.addListener(t,n,r)}addOneTimeListener(t,n,r={}){return r.remaining=1,this.addListener(t,n,r)}on(t,n,r,i){return this.addListener(t,n,r,i)}hasListener(t,n,r={}){if(W.validation&&typeof r=="function"){let i=[].concat(n);n=r,r={channels:i}}return oe.CHANNEL_EVENTS.includes(t)?(r.channels===void 0&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),me.sanitizeChannels(r.channels).every(i=>this.channels[i].hasListener(t,n))):super.hasListener(t,n)}removeListener(t,n,r={}){if(W.validation&&typeof r=="function"){let i=[].concat(n);n=r,r={channels:i}}if(r.channels===void 0&&(r.channels=oe.MIDI_CHANNEL_NUMBERS),t==null)return me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i]&&this.channels[i].removeListener()}),super.removeListener();oe.CHANNEL_EVENTS.includes(t)?me.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].removeListener(t,n,r)}):super.removeListener(t,n,r)}addForwarder(t,n={}){let r;return t instanceof w0?r=t:r=new w0(t,n),this._forwarders.push(r),r}removeForwarder(t){this._forwarders=this._forwarders.filter(n=>n!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return W.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class aE extends kn{constructor(){super(),this.defaults={note:{attack:me.from7bitToFloat(64),release:me.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},n=!1){if(me.isNode){try{window.navigator}catch{let s=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,s)}try{}catch{global.performance=await Object.getPrototypeOf(async function(){}).constructor(`
        let perf_hooks = await import("perf_hooks");
        return perf_hooks.performance;
        `)()}}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:n}),n&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const r={timestamp:this.time,target:this,type:"error",error:void 0},i={timestamp:this.time,target:this,type:"midiaccessgranted"},o={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(a){return r.error=a,this.emit("error",r),typeof t.callback=="function"&&t.callback(a),Promise.reject(a)}this.emit("midiaccessgranted",i),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(a){return r.error=a,this.emit("error",r),typeof t.callback=="function"&&t.callback(a),Promise.reject(a)}return this.emit("enabled",o),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(n.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(this._disconnectedInputs[r].id===t.toString())return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(this.inputs[r].id===t.toString())return this.inputs[r]}getInputByName(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(n.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(~this._disconnectedInputs[r].name.indexOf(t))return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(~this.inputs[r].name.indexOf(t))return this.inputs[r]}getOutputByName(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(n.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(~this._disconnectedOutputs[r].name.indexOf(t))return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(~this.outputs[r].name.indexOf(t))return this.outputs[r]}getOutputById(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(n.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(this._disconnectedOutputs[r].id===t.toString())return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(this.outputs[r].id===t.toString())return this.outputs[r]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),me.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?me.getNoteDetails(me.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),me.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),me.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),me.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,n={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),me.buildNoteArray(t,n)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),me.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(n=>t.push(n.destroy())),this.outputs.forEach(n=>t.push(n.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let n={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?n.port=this.getOutputById(t.port.id):t.port.type==="input"&&(n.port=this.getInputById(t.port.id)),this.emit(t.port.state,n);const r=Object.assign({},n);r.type="portschanged",this.emit(r.type,r)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?n.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(n.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,n);const r=Object.assign({},n);r.type="portschanged",this.emit(r.type,r)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let n=this._inputs.length-1;n>=0;n--){const r=this._inputs[n];Array.from(this.interface.inputs.values()).find(o=>o===r._midiInput)||(this._disconnectedInputs.push(r),this._inputs.splice(n,1))}let t=[];return this.interface.inputs.forEach(n=>{if(!this._inputs.find(r=>r._midiInput===n)){let r=this._disconnectedInputs.find(i=>i._midiInput===n);r||(r=new oE(n)),this._inputs.push(r),t.push(r.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let n=this._outputs.length-1;n>=0;n--){const r=this._outputs[n];Array.from(this.interface.outputs.values()).find(o=>o===r._midiOutput)||(this._disconnectedOutputs.push(r),this._outputs.splice(n,1))}let t=[];return this.interface.outputs.forEach(n=>{if(!this._outputs.find(r=>r._midiOutput===n)){let r=this._disconnectedOutputs.find(i=>i._midiOutput===n);r||(r=new Rf(n)),this._outputs.push(r),t.push(r.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),me.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),me.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.9"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),oe.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),oe.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),oe.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),oe.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),oe.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const W=new aE;W.constructor=null;function Jy(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function e_(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var t_=[0,2,4,-1,1,3,5],n_=t_.map(e=>Math.floor(e*7/12));function r_(e){const{step:t,alt:n,oct:r,dir:i=1}=e,o=t_[t]+7*n;if(r===void 0)return[i*o];const a=r-n_[t]-4*n;return[i*o,i*a]}var sE=[3,0,4,1,5,2,6];function lE(e){const[t,n,r]=e,i=sE[uE(t)],o=Math.floor((t+1)/7);if(n===void 0)return{step:i,alt:o,dir:r};const a=n+4*o+n_[i];return{step:i,alt:o,oct:a,dir:r}}function uE(e){const t=(e+1)%7;return t<0?7+t:t}var M0=(e,t)=>Array(Math.abs(t)+1).join(e),Lf=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),cE="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",fE="(AA|A|P|M|m|d|dd)([-+]?\\d+)",hE=new RegExp("^"+cE+"|"+fE+"$");function dE(e){const t=hE.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var S0={};function Fl(e){return typeof e=="string"?S0[e]||(S0[e]=mE(e)):e_(e)?Fl(bE(e)):Jy(e)?Fl(e.name):Lf}var E0=[0,2,4,5,7,9,11],i_="PMMPPMM";function mE(e){const t=dE(e);if(t[0]==="")return Lf;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,o=i_[i];if(o==="M"&&r==="P")return Lf;const a=o==="M"?"majorable":"perfectable",s=""+n+r,l=n<0?-1:1,u=n===8||n===-8?n:l*(i+1),c=pE(a,r),f=Math.floor((Math.abs(n)-1)/7),h=l*(E0[i]+c+12*f),d=(l*(E0[i]+c)%12+12)%12,p=r_({step:i,alt:c,oct:f,dir:l});return{empty:!1,name:s,num:n,q:r,step:i,alt:c,dir:l,type:a,simple:u,semitones:h,chroma:d,coord:p,oct:f}}function pE(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function bE(e){const{step:t,alt:n,oct:r=0,dir:i}=e;if(!i)return"";const o=t+1+7*r,a=o===0?t+1:o,s=i<0?"-":"",l=i_[t]==="M"?"majorable":"perfectable";return s+a+gE(l,n)}function gE(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?M0("A",t):M0("d",e==="perfectable"?t:t+1)}var A0=(e,t)=>Array(Math.abs(t)+1).join(e),o_=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),C0=new Map,yE=e=>"CDEFGAB".charAt(e),_E=e=>e<0?A0("b",-e):A0("#",e),vE=e=>e[0]==="b"?-e.length:e.length;function ut(e){const t=JSON.stringify(e),n=C0.get(t);if(n)return n;const r=typeof e=="string"?AE(e):e_(e)?ut(CE(e)):Jy(e)?ut(e.name):o_;return C0.set(t,r),r}var wE=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function ME(e){const t=wE.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function SE(e){return ut(lE(e))}var EE=(e,t)=>(e%t+t)%t,Mc=[0,2,4,5,7,9,11];function AE(e){const t=ME(e);if(t[0]===""||t[3]!=="")return o_;const n=t[0],r=t[1],i=t[2],o=(n.charCodeAt(0)+3)%7,a=vE(r),s=i.length?+i:void 0,l=r_({step:o,alt:a,oct:s}),u=n+r+i,c=n+r,f=(Mc[o]+a+120)%12,h=s===void 0?EE(Mc[o]+a,12)-12*99:Mc[o]+a+12*(s+1),d=h>=0&&h<=127?h:null,p=s===void 0?null:Math.pow(2,(h-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:f,coord:l,freq:p,height:h,letter:n,midi:d,name:u,oct:s,pc:c,step:o}}function CE(e){const{step:t,alt:n,oct:r}=e,i=yE(t);if(!i)return"";const o=i+_E(n);return r||r===0?o+r:o}function lo(e,t){const n=ut(e),r=Array.isArray(t)?t:Fl(t).coord;if(n.empty||!r||r.length<2)return"";const i=n.coord,o=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return SE(o).name}function a_(e,t){const n=e.length;return r=>{if(!t)return"";const i=r<0?(n- -r%n)%n:r%n,o=Math.floor(r/n),a=lo(t,[0,o]);return lo(a,e[i])}}function PE(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}function xE(e,t){const n=[];for(;t--;n[t]=t+e);return n}function NE(e,t){const n=[];for(;t--;n[t]=e-t);return n}function TE(e,t){return e<t?xE(e,t-e+1):NE(e,e-t+1)}function ts(e,t){const n=t.length,r=(e%n+n)%n;return t.slice(r,n).concat(t.slice(0,r))}function IE(e){return e.filter(t=>t===0||t)}var Gr={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},s_=e=>Number(e).toString(2).padStart(12,"0"),P0=e=>parseInt(e,2),kE=/^[01]{12}$/;function Xh(e){return kE.test(e)}var $E=e=>typeof e=="number"&&e>=0&&e<=4095,DE=e=>e&&Xh(e.chroma),x0={[Gr.chroma]:Gr};function _r(e){const t=Xh(e)?e:$E(e)?s_(e):Array.isArray(e)?GE(e):DE(e)?e.chroma:Gr.chroma;return x0[t]=x0[t]||OE(t)}var FE=e=>_r(e).chroma,BE=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function RE(e){const t=[];for(let n=0;n<12;n++)e.charAt(n)==="1"&&t.push(BE[n]);return t}function l_(e,t=!0){const r=_r(e).chroma.split("");return IE(r.map((i,o)=>{const a=ts(o,r);return t&&a[0]==="0"?null:a.join("")}))}function Kh(e){const t=_r(e).setNum;return n=>{const r=_r(n).setNum;return t&&t!==r&&(r&t)===r}}function Zh(e){const t=_r(e).setNum;return n=>{const r=_r(n).setNum;return t&&t!==r&&(r|t)===r}}function LE(e){const t=e.split("");return t.map((n,r)=>ts(r,t).join(""))}function OE(e){const t=P0(e),n=LE(e).map(P0).filter(o=>o>=2048).sort()[0],r=s_(n),i=RE(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:r,intervals:i}}function GE(e){if(e.length===0)return Gr.chroma;let t;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<e.length;r++)t=ut(e[r]),t.empty&&(t=Fl(e[r])),t.empty||(n[t.chroma]=1);return n.join("")}var UE=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],qE=UE;({...Gr});var Qh=[],Ys={};function u_(){return Qh.slice()}function zE(e,t,n){const r=VE(e),i={..._r(e),name:n||"",quality:r,intervals:e,aliases:t};Qh.push(i),i.name&&(Ys[i.name]=i),Ys[i.setNum]=i,Ys[i.chroma]=i,i.aliases.forEach(o=>HE(i,o))}function HE(e,t){Ys[t]=e}function VE(e){const t=n=>e.indexOf(n)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}qE.forEach(([e,t,n])=>zE(e.split(" "),n.split(" "),t));Qh.sort((e,t)=>e.setNum-t.setNum);var YE=e=>{const t=e.reduce((n,r)=>{const i=ut(r).chroma;return i!==void 0&&(n[i]=n[i]||ut(r).name),n},{});return n=>t[n]};function WE(e,t={}){const n=e.map(i=>ut(i).pc).filter(i=>i);return ut.length===0?[]:eA(n,1,t).filter(i=>i.weight).sort((i,o)=>o.weight-i.weight).map(i=>i.name)}var xu={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},Nu=e=>t=>!!(t&e),jE=Nu(xu.anyThirds),XE=Nu(xu.perfectFifth),KE=Nu(xu.anySeventh),ZE=Nu(xu.nonPerfectFifths);function QE(e){const t=parseInt(e.chroma,2);return jE(t)&&XE(t)&&KE(t)}function JE(e){const t=parseInt(e,2);return ZE(t)?e:(t|16).toString(2)}function eA(e,t,n){const r=e[0],i=ut(r).chroma,o=YE(e),a=l_(e,!1),s=[];return a.forEach((l,u)=>{const c=n.assumePerfectFifth&&JE(l);u_().filter(h=>n.assumePerfectFifth&&QE(h)?h.chroma===c:h.chroma===l).forEach(h=>{const d=h.aliases[0],p=o(u);u!==i?s.push({weight:.5*t,name:`${p}${d}/${r}`}):s.push({weight:1*t,name:`${p}${d}`})})}),s}function c_(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function f_(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var h_=[0,2,4,-1,1,3,5],d_=h_.map(e=>Math.floor(e*7/12));function m_(e){const{step:t,alt:n,oct:r,dir:i=1}=e,o=h_[t]+7*n;if(r===void 0)return[i*o];const a=r-d_[t]-4*n;return[i*o,i*a]}var tA=[3,0,4,1,5,2,6];function p_(e){const[t,n,r]=e,i=tA[nA(t)],o=Math.floor((t+1)/7);if(n===void 0)return{step:i,alt:o,dir:r};const a=n+4*o+d_[i];return{step:i,alt:o,oct:a,dir:r}}function nA(e){const t=(e+1)%7;return t<0?7+t:t}var N0=(e,t)=>Array(Math.abs(t)+1).join(e),Of={empty:!0,name:"",acc:""},rA="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",iA="(AA|A|P|M|m|d|dd)([-+]?\\d+)",oA=new RegExp("^"+rA+"|"+iA+"$");function aA(e){const t=oA.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var T0={};function Bl(e){return typeof e=="string"?T0[e]||(T0[e]=sA(e)):f_(e)?Bl(cA(e)):c_(e)?Bl(e.name):Of}var I0=[0,2,4,5,7,9,11],b_="PMMPPMM";function sA(e){const t=aA(e);if(t[0]==="")return Of;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,o=b_[i];if(o==="M"&&r==="P")return Of;const a=o==="M"?"majorable":"perfectable",s=""+n+r,l=n<0?-1:1,u=n===8||n===-8?n:l*(i+1),c=uA(a,r),f=Math.floor((Math.abs(n)-1)/7),h=l*(I0[i]+c+12*f),d=(l*(I0[i]+c)%12+12)%12,p=m_({step:i,alt:c,oct:f,dir:l});return{empty:!1,name:s,num:n,q:r,step:i,alt:c,dir:l,type:a,simple:u,semitones:h,chroma:d,coord:p,oct:f}}function lA(e,t){const[n,r=0]=e,i=n*7+r*12<0,o=t||i?[-n,-r,-1]:[n,r,1];return Bl(p_(o))}function uA(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function cA(e){const{step:t,alt:n,oct:r=0,dir:i}=e;if(!i)return"";const o=t+1+7*r,a=o===0?t+1:o,s=i<0?"-":"",l=b_[t]==="M"?"majorable":"perfectable";return s+a+fA(l,n)}function fA(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?N0("A",t):N0("d",e==="perfectable"?t:t+1)}var k0=(e,t)=>Array(Math.abs(t)+1).join(e),g_={empty:!0,name:"",pc:"",acc:""},$0=new Map,hA=e=>"CDEFGAB".charAt(e),dA=e=>e<0?k0("b",-e):k0("#",e),mA=e=>e[0]==="b"?-e.length:e.length;function Ur(e){const t=JSON.stringify(e),n=$0.get(t);if(n)return n;const r=typeof e=="string"?yA(e):f_(e)?Ur(_A(e)):c_(e)?Ur(e.name):g_;return $0.set(t,r),r}var pA=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function y_(e){const t=pA.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function bA(e){return Ur(p_(e))}var gA=(e,t)=>(e%t+t)%t,Sc=[0,2,4,5,7,9,11];function yA(e){const t=y_(e);if(t[0]===""||t[3]!=="")return g_;const n=t[0],r=t[1],i=t[2],o=(n.charCodeAt(0)+3)%7,a=mA(r),s=i.length?+i:void 0,l=m_({step:o,alt:a,oct:s}),u=n+r+i,c=n+r,f=(Sc[o]+a+120)%12,h=s===void 0?gA(Sc[o]+a,12)-12*99:Sc[o]+a+12*(s+1),d=h>=0&&h<=127?h:null,p=s===void 0?null:Math.pow(2,(h-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:f,coord:l,freq:p,height:h,letter:n,midi:d,name:u,oct:s,pc:c,step:o}}function _A(e){const{step:t,alt:n,oct:r}=e,i=hA(t);if(!i)return"";const o=i+dA(n);return r||r===0?o+r:o}function Rl(e,t){const n=Ur(e),r=Array.isArray(t)?t:Bl(t).coord;if(n.empty||!r||r.length<2)return"";const i=n.coord,o=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return bA(o).name}function __(e,t){const n=e.length;return r=>{if(!t)return"";const i=r<0?(n- -r%n)%n:r%n,o=Math.floor(r/n),a=Rl(t,[0,o]);return Rl(a,e[i])}}function vA(e,t){const n=Ur(e),r=Ur(t);if(n.empty||r.empty)return"";const i=n.coord,o=r.coord,a=o[0]-i[0],s=i.length===2&&o.length===2?o[1]-i[1]:-Math.floor(a*7/12),l=r.height===n.height&&r.midi!==null&&n.midi!==null&&n.step>r.step;return lA([a,s],l).name}function wA(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}var MA=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],SA=MA,EA={...Gr,name:"",quality:"Unknown",intervals:[],aliases:[]},Jh=[],aa={};function AA(e){return aa[e]||EA}function v_(){return Jh.slice()}function CA(e,t,n){const r=xA(e),i={..._r(e),name:n||"",quality:r,intervals:e,aliases:t};Jh.push(i),i.name&&(aa[i.name]=i),aa[i.setNum]=i,aa[i.chroma]=i,i.aliases.forEach(o=>PA(i,o))}function PA(e,t){aa[t]=e}function xA(e){const t=n=>e.indexOf(n)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}SA.forEach(([e,t,n])=>CA(e.split(" "),n.split(" "),t));Jh.sort((e,t)=>e.setNum-t.setNum);var NA=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],TA=NA,IA={...Gr,intervals:[],aliases:[]},ed=[],sa={};function kA(){return ed.map(e=>e.name)}function w_(e){return sa[e]||IA}function Tu(){return ed.slice()}function $A(e,t,n=[]){const r={..._r(e),name:t,intervals:e,aliases:n};return ed.push(r),sa[r.name]=r,sa[r.setNum]=r,sa[r.chroma]=r,r.aliases.forEach(i=>DA(r,i)),r}function DA(e,t){sa[t]=e}TA.forEach(([e,t,...n])=>$A(e.split(" "),t,n));var Gf={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function td(e){const[t,n,r,i]=y_(e);return t===""?["",e]:t==="A"&&i==="ug"?["","aug"]:[t+n,r+i]}function Mi(e){if(e==="")return Gf;if(Array.isArray(e)&&e.length===2)return Ws(e[1],e[0]);{const[t,n]=td(e),r=Ws(n,t);return r.empty?Ws(e):r}}function Ws(e,t,n){const r=AA(e),i=Ur(t||""),o=Ur(n||"");if(r.empty||t&&i.empty||n&&o.empty)return Gf;const a=vA(i.pc,o.pc),s=r.intervals.indexOf(a)+1;if(!o.empty&&!s)return Gf;const l=Array.from(r.intervals);for(let h=1;h<s;h++){const d=l[0][0],p=l[0][1],b=parseInt(d,10)+7;l.push(`${b}${p}`),l.shift()}const u=i.empty?[]:l.map(h=>Rl(i,h));e=r.aliases.indexOf(e)!==-1?e:r.aliases[0];const c=`${i.empty?"":i.pc}${e}${o.empty||s<=1?"":"/"+o.pc}`,f=`${t?i.pc+" ":""}${r.name}${s>1&&n?" over "+o.pc:""}`;return{...r,name:f,symbol:c,type:r.name,root:o.name,intervals:l,rootDegree:s,tonic:i.name,notes:u}}var FA=wA("Chord.chord","Chord.get",Mi);function BA(e,t){const[n,r]=td(e);return n?Rl(n,t)+r:e}function RA(e){const t=Mi(e),n=Zh(t.chroma);return Tu().filter(r=>n(r.chroma)).map(r=>r.name)}function LA(e){const t=Mi(e),n=Zh(t.chroma);return v_().filter(r=>n(r.chroma)).map(r=>t.tonic+r.aliases[0])}function OA(e){const t=Mi(e),n=Kh(t.chroma);return v_().filter(r=>n(r.chroma)).map(r=>t.tonic+r.aliases[0])}function GA(e){const{intervals:t,tonic:n}=Mi(e),r=__(t,n);return i=>i?r(i>0?i-1:i):""}function UA(e){const{intervals:t,tonic:n}=Mi(e);return __(t,n)}var Ll={getChord:Ws,get:Mi,detect:WE,chordScales:RA,extended:LA,reduced:OA,tokenize:td,transpose:BA,degrees:GA,steps:UA,chord:FA};function M_(e){return+e>=0&&+e<=127}function qA(e){if(M_(e))return+e;const t=ut(e);return t.empty?null:t.midi}function zA(e,t=440){return Math.pow(2,(e-69)/12)*t}var HA=Math.log(2),VA=Math.log(440);function nd(e){const t=12*(Math.log(e)-VA)/HA+69;return Math.round(t*100)/100}var YA="C C# D D# E F F# G G# A A# B".split(" "),WA="C Db D Eb E F Gb G Ab A Bb B".split(" ");function Si(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const r=(t.sharps===!0?YA:WA)[e%12];if(t.pitchClass)return r;const i=Math.floor(e/12)-1;return r+i}function rd(e){return e%12}function jA(e){return e.split("").reduce((t,n,r)=>(r<12&&n==="1"&&t.push(r),t),[])}function XA(e){return e.map(rd).sort((t,n)=>t-n).filter((t,n,r)=>n===0||t!==r[n-1])}function id(e){return Array.isArray(e)?XA(e):jA(e)}function KA(e){const t=id(e);return n=>{const r=rd(n);for(let i=0;i<12;i++){if(t.includes(r+i))return n+i;if(t.includes(r-i))return n-i}}}function S_(e,t){const n=id(e),r=n.length;return i=>{const o=i<0?(r- -i%r)%r:i%r,a=Math.floor(i/r);return n[o]+a*12+t}}function ZA(e,t){const n=S_(e,t);return r=>{if(r!==0)return n(r>0?r-1:r)}}var Uf={chroma:rd,freqToMidi:nd,isMidi:M_,midiToFreq:zA,midiToNoteName:Si,pcsetNearest:KA,pcset:id,pcsetDegrees:ZA,pcsetSteps:S_,toMidi:qA},QA=["C","D","E","F","G","A","B"],E_=e=>e.name,A_=e=>e.map(ut).filter(t=>!t.empty);function JA(e){return e===void 0?QA.slice():Array.isArray(e)?A_(e).map(E_):[]}var Bn=ut,eC=e=>Bn(e).name,tC=e=>Bn(e).pc,nC=e=>Bn(e).acc,rC=e=>Bn(e).oct,iC=e=>Bn(e).midi,oC=e=>Bn(e).freq,aC=e=>Bn(e).chroma;function C_(e){return Si(e)}function sC(e){return Si(nd(e))}function lC(e){return Si(nd(e),{sharps:!0})}function uC(e){return Si(e,{sharps:!0})}var ns=lo,cC=lo,P_=e=>t=>ns(t,e),fC=P_,x_=e=>t=>ns(e,t),hC=x_;function N_(e,t){return ns(e,[t,0])}var dC=N_;function mC(e,t){return ns(e,[0,t])}var od=(e,t)=>e.height-t.height,pC=(e,t)=>t.height-e.height;function T_(e,t){return t=t||od,A_(e).sort(t).map(E_)}function I_(e){return T_(e,od).filter((t,n,r)=>n===0||t!==r[n-1])}var bC=e=>{const t=Bn(e);return t.empty?"":Si(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function k_(e,t){const n=Bn(e);if(n.empty)return"";const r=Bn(t||Si(n.midi||n.chroma,{sharps:n.alt<0,pitchClass:!0}));if(r.empty||r.chroma!==n.chroma)return"";if(n.oct===void 0)return r.pc;const i=n.chroma-n.alt,o=r.chroma-r.alt,a=i>11||o<0?-1:i<0||o>11?1:0,s=n.oct+a;return r.pc+s}var Ut={names:JA,get:Bn,name:eC,pitchClass:tC,accidentals:nC,octave:rC,midi:iC,ascending:od,descending:pC,sortedNames:T_,sortedUniqNames:I_,fromMidi:C_,fromMidiSharps:uC,freq:oC,fromFreq:sC,fromFreqSharps:lC,chroma:aC,transpose:ns,tr:cC,transposeBy:P_,trBy:fC,transposeFrom:x_,trFrom:hC,transposeFifths:N_,transposeOctaves:mC,trFifths:dC,simplify:bC,enharmonic:k_},ad=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],D0={...Gr,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},gC=ad.map(yC),qf={};gC.forEach(e=>{qf[e.name]=e,e.aliases.forEach(t=>{qf[t]=e})});function $_(e){return typeof e=="string"?qf[e.toLowerCase()]||D0:e&&e.name?$_(e.name):D0}function yC(e){const[t,n,r,i,o,a,s]=e,l=s?[s]:[],u=Number(n).toString(2);return{empty:!1,intervals:w_(i).intervals,modeNum:t,chroma:u,normalized:u,name:i,setNum:n,alt:r,triad:o,seventh:a,aliases:l}}function D_(e){return(t,n)=>{const r=$_(t);if(r.empty)return[];const i=ts(r.modeNum,e),o=r.intervals.map(a=>lo(n,a));return i.map((a,s)=>o[s]+a)}}D_(ad.map(e=>e[4]));D_(ad.map(e=>e[5]));var _C={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function F_(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),n=ut(e.substring(0,t));if(n.empty){const i=ut(e);return i.empty?["",e]:[i.name,""]}const r=e.substring(n.name.length+1).toLowerCase();return[n.name,r.length?r:""]}var vC=kA;function er(e){const t=Array.isArray(e)?e:F_(e),n=ut(t[0]).name,r=w_(t[1]);if(r.empty)return _C;const i=r.name,o=n?r.intervals.map(s=>lo(n,s)):[],a=n?n+" "+i:i;return{...r,name:a,type:i,tonic:n,notes:o}}var wC=PE("Scale.scale","Scale.get",er);function MC(e,t={}){const n=FE(e),r=ut(t.tonic??e[0]??""),i=r.chroma;if(i===void 0)return[];const o=n.split("");o[i]="1";const a=ts(i,o).join(""),s=Tu().find(u=>u.chroma===a),l=[];return s&&l.push(r.name+" "+s.name),t.match==="exact"||B_(a).forEach(u=>{l.push(r.name+" "+u)}),l}function SC(e){const t=er(e),n=Kh(t.chroma);return u_().filter(r=>n(r.chroma)).map(r=>r.aliases[0])}function B_(e){const t=Xh(e)?e:er(e).chroma,n=Zh(t);return Tu().filter(r=>n(r.chroma)).map(r=>r.name)}function EC(e){const t=Kh(er(e).chroma);return Tu().filter(n=>t(n.chroma)).map(n=>n.name)}function R_(e){const t=e.map(i=>ut(i).pc).filter(i=>i),n=t[0],r=I_(t);return ts(r.indexOf(n),r)}function AC(e){const t=er(e);if(t.empty)return[];const n=t.tonic?t.notes:t.intervals;return l_(t.chroma).map((r,i)=>{const o=er(r).name;return o?[n[i],o]:["",""]}).filter(r=>r[0])}function CC(e){const t=Array.isArray(e)?R_(e):er(e).notes,n=t.map(r=>ut(r).chroma);return r=>{const i=ut(typeof r=="number"?C_(r):r),o=i.height;if(o===void 0)return;const a=o%12,s=n.indexOf(a);if(s!==-1)return k_(i.name,t[s])}}function PC(e){const t=CC(e);return(n,r)=>{const i=ut(n).height,o=ut(r).height;return i===void 0||o===void 0?[]:TE(i,o).map(t).filter(a=>a)}}function xC(e){const{intervals:t,tonic:n}=er(e),r=a_(t,n);return i=>i?r(i>0?i-1:i):""}function NC(e){const{intervals:t,tonic:n}=er(e);return a_(t,n)}var wt={degrees:xC,detect:MC,extended:B_,get:er,modeNames:AC,names:vC,rangeOf:PC,reduced:EC,scaleChords:SC,scaleNotes:R_,steps:NC,tokenize:F_,scale:wC};function TC(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f=e[1].join(", ")+"",h,d,p,b,y=e[2].join(" or ")+"",_;return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Play a chord on a MIDI instrument. The notes you played and the detected
        chord will be shown below.`,s=O(),l=C("div"),u=q("Notes: "),c=C("b"),h=q(f),d=C("br"),p=q(`
        Detected chord: `),b=C("b"),_=q(y),k(a,"class","explanation"),k(l,"class","visualization"),k(t,"class","demo")},m(v,M){fe(v,t,M),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(l,c),m(c,h),m(l,d),m(l,p),m(l,b),m(b,_)},p(v,[M]){M&1&&r!==(r=v[0].title+"")&&he(i,r),M&2&&f!==(f=v[1].join(", ")+"")&&he(h,f),M&4&&y!==(y=v[2].join(" or ")+"")&&he(_,y)},i:ge,o:ge,d(v){v&&ce(t)}}}function IC(e,t,n){let{toolInfo:r}=t,i=0,o=[],a=[],s=[];const l=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((f,h)=>{console.log(`MIDI device ${h}: ${f.name}`),f.addListener("noteon",u)}),[...W.inputs])},u=f=>{const h=(f.timestamp-i)/1e3,d={number:f.note.number,velocity:f.rawVelocity,time:h,channel:f.message.channel};o.push(d),c()},c=()=>{const f=ot(o,h=>h.time);n(1,a=o.filter(h=>h.time>f-1).sort((h,d)=>h.number-d.number).map(h=>Ut.fromMidiSharps(h.number))),n(1,a=[...new Set(a)]),n(2,s=Ll.detect(a))};return st(()=>{W.enable().then(l).catch(f=>alert(f)),i=performance.now(),c()}),lt(()=>{for(const f of W.inputs)f.removeListener()}),e.$$set=f=>{"toolInfo"in f&&n(0,r=f.toolInfo)},[r,a,s]}class kC extends He{constructor(t){super(),ze(this,t,IC,TC,qe,{toolInfo:0})}}function qr(e){return e!=null&&!Number.isNaN(e)}function Rn(e,t){return+qr(t)-+qr(e)||Vt(e,t)}function Ol(e,t){return+qr(t)-+qr(e)||Ga(e,t)}function sd(e){return e!=null&&`${e}`!=""}function L_(e){return isFinite(e)?e:NaN}function Iu(e){return e>0&&isFinite(e)?e:NaN}function ld(e){return e<0&&isFinite(e)?e:NaN}function $C(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return`${DC(e.getUTCFullYear())}-${cr(e.getUTCMonth()+1,2)}-${cr(e.getUTCDate(),2)}${n||r||i||o?`T${cr(n,2)}:${cr(r,2)}${i||o?`:${cr(i,2)}${o?`.${cr(o,3)}`:""}`:""}Z`:""}`}function DC(e){return e<0?`-${cr(-e,6)}`:e>9999?`+${cr(e,6)}`:cr(e,4)}function cr(e,t){return`${e}`.padStart(t,"0")}const FC=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function O_(e,t){return FC.test(e+="")?new Date(e):typeof t=="function"?t(e):t}function uo(e){if(e==null)return;const t=e[0],n=e[e.length-1];return Ga(t,n)}const Gi=1e3,kr=Gi*60,$r=kr*60,tr=$r*24,Hn=tr*7,si=tr*30,Nr=tr*365,Ec=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",Gi],["5 seconds",5*Gi],["15 seconds",15*Gi],["30 seconds",30*Gi],["minute",kr],["5 minutes",5*kr],["15 minutes",15*kr],["30 minutes",30*kr],["hour",$r],["3 hours",3*$r],["6 hours",6*$r],["12 hours",12*$r],["day",tr],["2 days",2*tr],["week",Hn],["2 weeks",2*Hn],["month",si],["3 months",3*si],["6 months",6*si],["year",Nr],["2 years",2*Nr],["5 years",5*Nr],["10 years",10*Nr],["20 years",20*Nr],["50 years",50*Nr],["100 years",100*Nr]],ud=new Map([["second",Gi],["minute",kr],["hour",$r],["day",tr],["monday",Hn],["tuesday",Hn],["wednesday",Hn],["thursday",Hn],["friday",Hn],["saturday",Hn],["sunday",Hn],["week",Hn],["month",si],["year",Nr]]),G_=new Map([["second",In],["minute",ja],["hour",Ka],["day",_i],["monday",wa],["tuesday",Kg],["wednesday",Zg],["thursday",mi],["friday",Qg],["saturday",Jg],["sunday",ao],["week",ao],["month",Qa],["year",Dn]]),cd=new Map([["second",In],["minute",Xa],["hour",Za],["day",_u],["monday",Ma],["tuesday",e2],["wednesday",t2],["thursday",pi],["friday",n2],["saturday",r2],["sunday",so],["week",so],["month",Ja],["year",Fn]]),rs=Symbol("intervalDuration"),ku=Symbol("intervalType");for(const[e,t]of G_)t[rs]=ud.get(e),t[ku]="time";for(const[e,t]of cd)t[rs]=ud.get(e),t[ku]="utc";const Xo=[["year",Fn,"utc"],["month",Ja,"utc"],["day",_u,"utc",6*si],["hour",Za,"utc",3*tr],["minute",Xa,"utc",6*$r],["second",In,"utc",30*kr]],js=[["year",Dn,"time"],["month",Qa,"time"],["day",_i,"time",6*si],["hour",Ka,"time",3*tr],["minute",ja,"time",6*$r],["second",In,"time",30*kr]],BC=[Xo[0],js[0],Xo[1],js[1],Xo[2],js[2],...Xo.slice(3)];function U_(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),n=+r[1]),t){case"quarter":t="month",n*=3;break;case"half":t="month",n*=6;break}let i=cd.get(t);if(!i)throw new Error(`unknown interval: ${e}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${t}`);return[t,n]}function q_(e){return H_(U_(e),"time")}function z_(e){return H_(U_(e),"utc")}function H_([e,t],n){let r=(n==="time"?G_:cd).get(e);return t>1&&(r=r.every(t),r[rs]=ud.get(e)*t,r[ku]=n),r}function F0(e,t){if(!(t>1))return;const n=e[rs];if(!Ec.some(([,i])=>i===n)||n%tr===0&&tr<n&&n<si)return;const[r]=Ec[tu(([,i])=>Math.log(i)).center(Ec,Math.log(n*t))];return(e[ku]==="time"?q_:z_)(r)}function B0(e,t,n){const r=t==="time"?qh:es;if(n==null)return r(e==="year"?"%Y":e==="month"?"%Y-%m":e==="day"?"%Y-%m-%d":e==="hour"||e==="minute"?"%Y-%m-%dT%H:%M":e==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=RC(n);switch(e){case"millisecond":return $i(r(".%L"),r(":%M:%S"),i);case"second":return $i(r(":%S"),r("%-I:%M"),i);case"minute":return $i(r("%-I:%M"),r("%p"),i);case"hour":return $i(r("%-I %p"),r("%b %-d"),i);case"day":return $i(r("%-d"),r("%b"),i);case"month":return $i(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function RC(e){return e==="left"||e==="right"?(t,n)=>`
${t}
${n}`:e==="top"?(t,n)=>`${n}
${t}`:(t,n)=>`${t}
${n}`}function LC(e){return e==="time"?js:e==="utc"?Xo:BC}function OC(e,t,n){const r=ot(Z5(t,(i,o)=>Math.abs(o-i)));if(r<1e3)return B0("millisecond","utc",n);for(const[i,o,a,s]of LC(e)){if(r>s||i==="hour"&&!r)break;if(t.every(l=>o.floor(l)>=l))return B0(i,a,n)}}function $i(e,t,n){return(r,i,o)=>{const a=e(r,i),s=t(r,i),l=i-uo(o);return i!==l&&o[l]!==void 0&&s===t(o[l],l)?a:n(a,s)}}const Aa=Object.getPrototypeOf(Uint8Array),GC=Object.prototype.toString,V_=Symbol("reindex");function Mt(e,t,n){const r=typeof t;return r==="string"?R0(e,Y_(t),n):r==="function"?R0(e,t,n):r==="number"||t instanceof Date||r==="boolean"?At(e,is(t),n):typeof(t==null?void 0:t.transform)=="function"?L0(t.transform(e),n):UC(L0(t,n),e==null?void 0:e[V_])}function UC(e,t){return t?dd(e,t):e}function R0(e,t,n){return At(e,(n==null?void 0:n.prototype)instanceof Aa?qC(t):t,n)}function L0(e,t){return t===void 0?rn(e):e instanceof t?e:t.prototype instanceof Aa&&!(e instanceof Aa)?t.from(e,hd):t.from(e)}function qC(e){return(t,n)=>hd(e(t,n))}const Xs=[null],Y_=e=>t=>t[e],fd={transform:Er},Tt={transform:e=>e},zC=()=>1,HC=()=>!0,Rt=e=>e==null?e:`${e}`,rt=e=>e==null?e:+e,W_=e=>e?e[0]:void 0,zf=e=>e?e[1]:void 0,is=e=>()=>e;function VC(e){const t=+`${e}`.slice(1)/100;return(n,r)=>ol(n,t,r)}function Dr(e){return e instanceof Aa?e:At(e,hd,Float64Array)}function hd(e){return e==null?NaN:Number(e)}function YC(e){return At(e,WC)}function WC(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?O_(e):e==null||isNaN(e=+e)?void 0:new Date(e)}function vr(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:Fu(e)?[void 0,e]:[e,void 0]}function Ot(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function j_(e,t,n){if(e!=null)return On(e,t,n)}function On(e,t,n){const r=`${e}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${t}: ${e}`);return r}function rn(e){return e==null||e instanceof Array||e instanceof Aa?e:Array.from(e)}function At(e,t,n=Array){return e==null?e:e instanceof n?e.map(t):n.from(e,t)}function Ca(e,t=Array){return e instanceof t?e.slice():t.from(e)}function X_({x:e,x1:t,x2:n}){return e!==void 0||t!==void 0||n!==void 0}function K_({y:e,y1:t,y2:n}){return e!==void 0||t!==void 0||n!==void 0}function Z_(e){return X_(e)||K_(e)||e.interval!==void 0}function Wr(e){return(e==null?void 0:e.toString)===GC}function Hf(e){return Wr(e)&&(e.type!==void 0||e.domain!==void 0)}function $u(e){return Wr(e)&&typeof e.transform!="function"}function co(e){return $u(e)&&e.value===void 0&&e.channel===void 0}function Q_(e,t,n,r=Tt){return t===void 0&&n===void 0?(t=0,n=e===void 0?r:e):t===void 0?t=e===void 0?0:e:n===void 0&&(n=e===void 0?0:e),[t,n]}function Eo(e,t){return e===void 0&&t===void 0?[W_,zf]:[e,t]}function J_({z:e,fill:t,stroke:n}={}){return e===void 0&&([e]=vr(t)),e===void 0&&([e]=vr(n)),e}function Er(e){const t=e.length,n=new Uint32Array(t);for(let r=0;r<t;++r)n[r]=r;return n}function dd(e,t){return At(t,n=>e[n],e.constructor)}function jC(e,t,n){return e.subarray?e.subarray(t,n):e.slice(t,n)}function ri(e){return e!==null&&typeof e=="object"?e.valueOf():e}function XC(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function Gl(e){let t;return[{transform:()=>t,label:Ao(e)},n=>t=n]}function Bi(e){return e==null?[e]:Gl(e)}function Ao(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function ev(e,t){return{transform(n){const r=e.transform(n),i=t.transform(n);return wn(r)||wn(i)?At(r,(o,a)=>new Date((+r[a]+ +i[a])/2)):At(r,(o,a)=>(+r[a]+ +i[a])/2,Float64Array)},label:e.label}}function Vf(e,t){const n=tv(t==null?void 0:t.interval,t==null?void 0:t.type);return n?At(e,n):e}function tv(e,t){const n=md(e,t);return n&&(r=>qr(r)?n.floor(r):r)}function md(e,t){if(e!=null){if(typeof e=="number"){0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const n=Math.abs(e);return e<0?{floor:r=>Math.floor(r*n)/n,offset:r=>(r*n+1)/n,range:(r,i)=>Ce(Math.ceil(r*n),i*n).map(o=>o/n)}:{floor:r=>Math.floor(r/n)*n,offset:r=>r+n,range:(r,i)=>Ce(Math.ceil(r/n),i/n).map(o=>o*n)}}if(typeof e=="string")return(t==="time"?q_:z_)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function os(e,t){if(e=md(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function KC(e,t){if(e=os(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function ZC(e){return typeof(e==null?void 0:e.range)=="function"}function Du(e){return e===void 0||$u(e)?e:{value:e}}function QC(e){return e==null?null:{transform:t=>Mt(t,e,Float64Array),label:Ao(e)}}function Ei(e){return e&&typeof e[Symbol.iterator]=="function"}function nv(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function O0(e){for(const t of e){if(t==null)continue;const n=typeof t;return n==="string"||n==="boolean"}}function wn(e){for(const t of e)if(t!=null)return t instanceof Date}function JC(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&O_(t)}function eP(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function tP(e){for(const t of e)if(t!=null)return typeof t=="number"}function Ac(e,t){let n;for(const r of e)if(r!=null){if(!t(r))return!1;n=!0}return n}const nP=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Fu(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||nP.has(e))}function rP(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function zt(e){return e==null||Pa(e)}function Pa(e){return/^\s*none\s*$/i.test(e)}function iP(e){return/^\s*round\s*$/i.test(e)}function Yf(e,t){return j_(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Bu(e="middle"){return Yf(e,"frameAnchor")}function oP(e={},...t){let n=e;for(const r of t)for(const i in r)if(n[i]===void 0){const o=r[i];n===e?n={...n,[i]:o}:n[i]=o}return n}function aP(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(t.has(i))throw new Error(`duplicate name: ${i}`);return t.add(i),[r,n]}))}function rv(e){return Ei(e)?aP(e):e}function iv(e){return e===!0?e="frame":e===!1?e=null:e!=null&&(e=On(e,"clip",["frame","sphere"])),e}const Xn=Symbol("position"),Ar=Symbol("color"),as=Symbol("radius"),ss=Symbol("length"),ls=Symbol("opacity"),Ru=Symbol("symbol"),ov=Symbol("projection"),mt=new Map([["x",Xn],["y",Xn],["fx",Xn],["fy",Xn],["r",as],["color",Ar],["opacity",ls],["symbol",Ru],["length",ss],["projection",ov]]);function sP(e){return e===Xn||e===ov}function lP(e){return e===Xn||e===as||e===ss||e===ls}const uP=Math.sqrt(3),cP=2/uP,fP={draw(e,t){const n=Math.sqrt(t/Math.PI),r=n*cP,i=r/2;e.moveTo(0,r),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(0,-r),e.lineTo(-n,-i),e.lineTo(-n,i),e.closePath()}},pd=new Map([["asterisk",Sy],["circle",Ea],["cross",Ey],["diamond",Cy],["diamond2",Py],["hexagon",fP],["plus",xy],["square",Ny],["square2",Ty],["star",ky],["times",By],["triangle",$y],["triangle2",Dy],["wye",Fy]]);function bd(e){return e&&typeof e.draw=="function"}function hP(e){return bd(e)?!0:typeof e!="string"?!1:pd.has(e.toLowerCase())}function gd(e){if(e==null||bd(e))return e;const t=pd.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function dP(e){if(e==null||bd(e))return[void 0,e];if(typeof e=="string"){const t=pd.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function Lu({filter:e,sort:t,reverse:n,transform:r,initializer:i,...o}={},a){if(r===void 0&&(e!=null&&(r=av(e)),t!=null&&!co(t)&&(r=Cc(r,yd(t))),n&&(r=Cc(r,sv))),a!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...o,...(t===null||co(t))&&{sort:t},transform:Cc(r,a)}}function fo({filter:e,sort:t,reverse:n,initializer:r,...i}={},o){return r===void 0&&(e!=null&&(r=av(e)),t!=null&&!co(t)&&(r=Pc(r,yd(t))),n&&(r=Pc(r,sv))),{...i,...(t===null||co(t))&&{sort:t},initializer:Pc(r,o)}}function Cc(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i){return{data:n,facets:r}=e.call(this,n,r,i),t.call(this,rn(n),r,i)}}function Pc(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i,...o){let a,s,l,u,c,f;return{data:s=n,facets:l=r,channels:a}=e.call(this,n,r,i,...o),{data:c=s,facets:f=l,channels:u}=t.call(this,s,l,{...i,...a},...o),{data:c,facets:f,channels:{...a,...u}}}}function mP(e,t){return(e.initializer!=null?fo:Lu)(e,t)}function av(e){return(t,n)=>{const r=Mt(t,e);return{data:t,facets:n.map(i=>i.filter(o=>r[o]))}}}function sv(e,t){return{data:e,facets:t.map(n=>n.slice().reverse())}}function pP(e,{sort:t,...n}={}){return{...($u(e)&&e.channel!==void 0?fo:mP)(n,yd(e)),sort:co(t)?t:null}}function yd(e){return(typeof e=="function"&&e.length!==1?bP:gP)(e)}function bP(e){return(t,n)=>{const r=(i,o)=>e(t[i],t[o]);return{data:t,facets:n.map(i=>i.slice().sort(r))}}}function gP(e){let t,n;({channel:t,value:e,order:n}={...Du(e)});const r=t==null?void 0:t.startsWith("-");if(r&&(t=t.slice(1)),n===void 0&&(n=r?Ol:Rn),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=Rn;break;case"descending":n=Ol;break;default:throw new Error(`invalid order: ${n}`)}return(i,o,a)=>{let s;if(t===void 0)s=Mt(i,e);else{if(a===void 0)throw new Error("channel sort requires an initializer");if(s=a[t],!s)return{};s=s.value}const l=(u,c)=>n(s[u],s[c]);return{data:i,facets:o.map(u=>u.slice().sort(l))}}}function yP(e={y:"count"},t={}){const{x:n=Tt}=t;if(n==null)throw new Error("missing channel: x");return lv(n,null,e,t)}function _P(e={fill:"count"},t={}){let{x:n,y:r}=t;if([n,r]=Eo(n,r),n==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return lv(n,r,e,t)}function lv(e,t,{data:n=mv,filter:r,sort:i,reverse:o,...a}={},s={}){a=SP(a,s),n=dv(n,Tt),i=i==null?void 0:fv("sort",i,s),r=r==null?void 0:hv("filter",r,s);const[l,u]=Bi(e),[c,f]=Bi(t),{z:h,fill:d,stroke:p,x1:b,x2:y,y1:_,y2:v,...M}=s,[g,w]=Bi(h),[E]=vr(d),[N]=vr(p),[x,T]=Bi(E),[S,P]=Bi(N);return{..."z"in s&&{z:g||h},..."fill"in s&&{fill:x||d},..."stroke"in s&&{stroke:S||p},...Lu(M,(I,$,D)=>{const A=Vf(Mt(I,e),D==null?void 0:D.x),F=Vf(Mt(I,t),D==null?void 0:D.y),L=Mt(I,h),X=Mt(I,E),U=Mt(I,N),z=AP(a,{z:L,fill:X,stroke:U}),G=[],R=[],Y=A&&u([]),re=F&&f([]),Q=L&&w([]),J=X&&T([]),K=U&&P([]);let ee=0;for(const j of a)j.initialize(I);i&&i.initialize(I),r&&r.initialize(I);for(const j of $){const V=[];for(const te of a)te.scope("facet",j);i&&i.scope("facet",j),r&&r.scope("facet",j);for(const[te,B]of xc(j,z))for(const[se,Z]of xc(B,F))for(const[ie,le]of xc(Z,A)){const ve={data:I};if(A&&(ve.x=ie),F&&(ve.y=se),z&&(ve.z=te),!(r&&!r.reduce(le,ve))){V.push(ee++),R.push(n.reduceIndex(le,I,ve)),A&&Y.push(ie),F&&re.push(se),L&&Q.push(z===L?te:L[le[0]]),X&&J.push(z===X?te:X[le[0]]),U&&K.push(z===U?te:U[le[0]]);for(const we of a)we.reduce(le,ve);i&&i.reduce(le,ve)}}G.push(V)}return CP(G,i,o),{data:R,facets:G}}),...!G0(a,"x")&&(l?{x:l}:{x1:b,x2:y}),...!G0(a,"y")&&(c?{y:c}:{y1:_,y2:v}),...Object.fromEntries(a.map(({name:I,output:$})=>[I,$]))}}function G0(e,...t){for(const{name:n}of e)if(t.includes(n))return!0;return!1}function vP(e,t,n=uv){const r=Object.entries(e);return t.title!=null&&e.title===void 0&&r.push(["title",NP]),t.href!=null&&e.href===void 0&&r.push(["href",pv]),r.filter(([,i])=>i!==void 0).map(([i,o])=>o===null?wP(i):n(i,o,t))}function uv(e,t,n,r=cv){let i;Wr(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);const o=r(e,t,n),[a,s]=Gl(o.label);let l;return{name:e,output:i===void 0?a:{value:a,scale:i},initialize(u){o.initialize(u),l=s([])},scope(u,c){o.scope(u,c)},reduce(u,c){l.push(o.reduce(u,c))}}}function wP(e){return{name:e,initialize(){},scope(){},reduce(){}}}function cv(e,t,n,r=_d){const i=XC(e,n),o=r(t,i);let a,s;return{label:Ao(o===Wf?null:i,o.label),initialize(l){a=i===void 0?l:Mt(l,i),o.scope==="data"&&(s=o.reduceIndex(Er(l),a))},scope(l,u){o.scope===l&&(s=o.reduceIndex(u,a))},reduce(l,u){return o.scope==null?o.reduceIndex(l,a,u):o.reduceIndex(l,a,s,u)}}}function xc(e,t){return t?ru(e,n=>t[n]):[[,e]]}function _d(e,t,n=MP){if(e==null)return n(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&Wr(e))return PP(e);if(typeof e=="function")return xP(e);if(/^p\d{2}$/i.test(e))return ur(VC(e));switch(`${e}`.toLowerCase()){case"first":return pv;case"last":return TP;case"identity":return mv;case"count":return Wf;case"distinct":return IP;case"sum":return t==null?Wf:kP;case"proportion":return q0(t,"data");case"proportion-facet":return q0(t,"facet");case"deviation":return ur(R5);case"min":return ur(Gt);case"min-index":return ur(pb);case"max":return ur(ot);case"max-index":return ur(W5);case"mean":return U0(yb);case"median":return U0(al);case"variance":return ur(ub);case"mode":return ur(K5)}return n(e)}function MP(e){throw new Error(`invalid reduce: ${e}`)}function SP(e,t){return vP(e,t,fv)}function fv(e,t,n){return uv(e,t,n,hv)}function hv(e,t,n){return cv(e,t,n,dv)}function dv(e,t){return _d(e,t,EP)}function EP(e){switch(`${e}`.toLowerCase()){case"x":return $P;case"y":return DP;case"z":return FP}throw new Error(`invalid group reduce: ${e}`)}function AP(e,t){for(const n in t){const r=t[n];if(r!==void 0&&!e.some(i=>i.name===n))return r}}function CP(e,t,n){if(t){const r=t.output.transform(),i=(o,a)=>Rn(r[o],r[a]);e.forEach(o=>o.sort(i))}n&&e.forEach(r=>r.reverse())}function PP(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function xP(e){return{reduceIndex(t,n,r){return e(dd(n,t),r)}}}function ur(e){return{reduceIndex(t,n){return e(t,r=>n[r])}}}function U0(e){return{reduceIndex(t,n){const r=e(t,i=>n[i]);return wn(n)?new Date(r):r}}}const mv={reduceIndex(e,t){return dd(t,e)}},pv={reduceIndex(e,t){return t[e[0]]}},NP={reduceIndex(e,t){const r=nl(qi(e,o=>o.length,o=>t[o]),zf),i=r.slice(-5).reverse();if(i.length<r.length){const o=r.slice(0,-4);i[4]=[` ${o.length.toLocaleString("en-US")} more`,Br(o,zf)]}return i.map(([o,a])=>`${o} (${a.toLocaleString("en-US")})`).join(`
`)}},TP={reduceIndex(e,t){return t[e[e.length-1]]}},Wf={label:"Frequency",reduceIndex(e){return e.length}},IP={label:"Distinct",reduceIndex(e,t){const n=new Ua;for(const r of e)n.add(t[r]);return n.size}},kP=ur(Br);function q0(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:t,reduceIndex:(n,r,i=1)=>Br(n,o=>r[o])/i}}const $P={reduceIndex(e,t,{x:n}){return n}},DP={reduceIndex(e,t,{y:n}){return n}},FP={reduceIndex(e,t,{z:n}){return n}};function xa(e,{scale:t,type:n,value:r,filter:i,hint:o,label:a=Ao(r)},s){return o===void 0&&typeof(r==null?void 0:r.transform)=="function"&&(o=r.hint),bv(s,{scale:t,type:n,value:Mt(e,r),label:a,filter:i,hint:o})}function BP(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,xa(t,r,n)]))}function RP(e,t){const n=Object.fromEntries(Object.entries(e).map(([r,{scale:i,value:o}])=>{const a=i==null?null:t[i];return[r,a==null?o:At(o,a)]}));return n.channels=e,n}function bv(e,t){const{scale:n,value:r}=t;if(n===!0||n==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=n!==!0&&Ac(r,Fu)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=n!==!0&&Ac(r,rP)?null:"opacity";break;case"symbol":n!==!0&&Ac(r,hP)?(t.scale=null,t.value=At(r,gd)):t.scale="symbol";break;default:t.scale=mt.has(e)?e:null;break}else if(n===!1)t.scale=null;else if(n!=null&&!mt.has(n))throw new Error(`unknown scale: ${n}`);return t}function LP(e,t,n,r,i){const{order:o,reverse:a,reduce:s=!0,limit:l}=i;for(const u in i){if(!mt.has(u))continue;let{value:c,order:f=o,reverse:h=a,reduce:d=s,limit:p=l}=Du(i[u]);const b=c==null?void 0:c.startsWith("-");if(b&&(c=c.slice(1)),f=f===void 0?b!==(c==="width"||c==="height")?yv:gv:UP(f),d==null||d===!1)continue;const y=u==="fx"||u==="fy"?GP(t,r[u]):OP(n,u);if(!y)throw new Error(`missing channel for scale: ${u}`);const _=y.value,[v=0,M=1/0]=Ei(p)?p:p<0?[p]:[0,p];if(c==null)y.domain=()=>{let g=Array.from(new Ua(_));return h&&(g=g.reverse()),(v!==0||M!==1/0)&&(g=g.slice(v,M)),g};else{const g=c==="data"?e:c==="height"?z0(n,"y1","y2"):c==="width"?z0(n,"x1","x2"):jf(n,c,c==="y"?"y2":c==="x"?"x2":void 0),w=_d(d===!0?"max":d,g);y.domain=()=>{let E=L5(Er(_),N=>w.reduceIndex(N,g),N=>_[N]);return f&&E.sort(f),h&&E.reverse(),(v!==0||M!==1/0)&&(E=E.slice(v,M)),E.map(W_)}}}}function OP(e,t){for(const n in e){const r=e[n];if(r.scale===t)return r}}function GP(e,t){const n=e.original;if(n===e)return t;const r=t.value,i=t.value=[];for(let o=0;o<n.length;++o){const a=r[n[o][0]];for(const s of e[o])i[s]=a}return t}function z0(e,t,n){const r=jf(e,t),i=jf(e,n);return At(i,(o,a)=>Math.abs(o-r[a]),Float64Array)}function jf(e,t,n){let r=e[t];if(!r&&n!==void 0&&(r=e[n]),r)return r.value;throw new Error(`missing channel: ${t}`)}function UP(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return gv;case"descending":return yv}throw new Error(`invalid order: ${e}`)}function gv([e,t],[n,r]){return Rn(t,r)||Rn(e,n)}function yv([e,t],[n,r]){return Ol(t,r)||Rn(e,n)}function H0(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}function vd(e={}){const{document:t=typeof window<"u"?window.document:void 0,clip:n}=e;return{document:t,clip:iv(n)}}function yt(e,{document:t}){return ta(au(e).call(t.documentElement))}let Xf=0,Kf;function qP(){const e=Xf;return Xf=0,Kf=void 0,e}function Fr(e){e!==Kf&&(Kf=e,console.warn(e),++Xf)}const _v=Math.PI,ar=2*_v,V0=.618;function zP({projection:e,inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:o=t}={},a){if(e==null)return;if(typeof e.stream=="function")return e;let s,l,u="frame";if(Wr(e)){let w;if({type:e,domain:l,inset:w,insetTop:n=w!==void 0?w:n,insetRight:r=w!==void 0?w:r,insetBottom:i=w!==void 0?w:i,insetLeft:o=w!==void 0?w:o,clip:u=u,...s}=e,e==null)return}typeof e!="function"&&({type:e}=vv(e));const{width:c,height:f,marginLeft:h,marginRight:d,marginTop:p,marginBottom:b}=a,y=c-h-d-o-r,_=f-p-b-n-i;if(e=e==null?void 0:e({width:y,height:_,clip:u,...s}),e==null)return;u=HP(u,h,p,c-d,f-b);let v=h+o,M=p+n,g;if(l!=null){const[[w,E],[N,x]]=hu(e).bounds(l),T=Math.min(y/(N-w),_/(x-E));T>0?(v-=(T*(w+N)-y)/2,M-=(T*(E+x)-_)/2,g=Nf({point(S,P){this.stream.point(S*T+v,P*T+M)}})):Fr("Warning: the projection could not be fit to the specified domain; using the default scale.")}return g??(g=v===0&&M===0?wv():Nf({point(w,E){this.stream.point(w+v,E+M)}})),{stream:w=>e.stream(g.stream(u(w)))}}function vv(e){switch(`${e}`.toLowerCase()){case"albers-usa":return xn(C8,.7463,.4673);case"albers":return ks(xg,.7463,.4673);case"azimuthal-equal-area":return xn(P8,4,4);case"azimuthal-equidistant":return xn(x8,ar,ar);case"conic-conformal":return ks(I8,ar,ar);case"conic-equal-area":return ks(Al,6.1702,2.9781);case"conic-equidistant":return ks(D8,7.312,3.6282);case"equal-earth":return xn(B8,5.4133,2.6347);case"equirectangular":return xn(k8,ar,_v);case"gnomonic":return xn(R8,3.4641,3.4641);case"identity":return{type:wv};case"reflect-y":return{type:VP};case"mercator":return xn(N8,ar,ar);case"orthographic":return xn(L8,2,2);case"stereographic":return xn(O8,2,2);case"transverse-mercator":return xn(G8,ar,ar);default:throw new Error(`unknown projection type: ${e}`)}}function HP(e,t,n,r,i){if(e===!1||e==null||typeof e=="number")return o=>o;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return hg(t,n,r,i);default:throw new Error(`unknown projection clip type: ${e}`)}}function xn(e,t,n){return{type:({width:r,height:i,rotate:o,precision:a=.15,clip:s})=>{var u,c,f;const l=e();return a!=null&&((u=l.precision)==null||u.call(l,a)),o!=null&&((c=l.rotate)==null||c.call(l,o)),typeof s=="number"&&((f=l.clipAngle)==null||f.call(l,s)),l.scale(Math.min(r/t,i/n)),l.translate([r/2,i/2]),l},aspectRatio:n/t}}function ks(e,t,n){const{type:r,aspectRatio:i}=xn(e,t,n);return{type:o=>{const{parallels:a,domain:s,width:l,height:u}=o,c=r(o);return a!=null&&(c.parallels(a),s===void 0&&c.fitSize([l,u],{type:"Sphere"})),c},aspectRatio:i}}const wv=is({stream:e=>e}),VP=is(Nf({point(e,t){this.stream.point(e,-t)}}));function YP(e,t,n,r){const i=n[e],o=n[t],a=i.length,s=n[e]=new Float64Array(a).fill(NaN),l=n[t]=new Float64Array(a).fill(NaN);let u;const c=r.stream({point(f,h){s[u]=f,l[u]=h}});for(u=0;u<a;++u)c.point(i[u],o[u])}function WP({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(Wr(e)&&(e=e.type),e!=null)}function jP(e){if(typeof(e==null?void 0:e.stream)=="function")return V0;if(Wr(e)&&(e=e.type),e!=null){if(typeof e!="function"){const{aspectRatio:t}=vv(e);if(t)return t}return V0}}function XP(e){const t=[],n=[],r={scale:"x",value:t},i={scale:"y",value:n},o={point(a,s){t.push(a),n.push(s)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const a of e.value)ei(a,o);return[r,i]}const Mv=new Map([["accent",cS],["category10",uS],["dark2",fS],["observable10",hS],["paired",dS],["pastel1",mS],["pastel2",pS],["set1",bS],["set2",gS],["set3",yS],["tableau10",_S]]);function KP(e){return e!=null&&Mv.has(`${e}`.toLowerCase())}const Y0=new Map([...Mv,["brbg",sr(d2,m2)],["prgn",sr(p2,b2)],["piyg",sr(g2,y2)],["puor",sr(_2,v2)],["rdbu",sr(Df,Nl)],["rdgy",sr(w2,M2)],["rdylbu",sr(Ff,Sa)],["rdylgn",sr(S2,E2)],["spectral",sr(A2,C2)],["burd",W0(Df,Nl)],["buylrd",W0(Ff,Sa)],["blues",vt(Z2,Q2)],["greens",vt(J2,ey)],["greys",vt(ty,ny)],["oranges",vt(sy,ly)],["purples",vt(ry,iy)],["reds",vt(oy,ay)],["turbo",lr(py)],["viridis",lr(by)],["magma",lr(gy)],["inferno",lr(yy)],["plasma",lr(_y)],["cividis",lr(uy)],["cubehelix",lr(cy)],["warm",lr(fy)],["cool",lr(hy)],["bugn",vt(P2,x2)],["bupu",vt(N2,T2)],["gnbu",vt(I2,k2)],["orrd",vt($2,D2)],["pubu",vt(R2,L2)],["pubugn",vt(F2,B2)],["purd",vt(O2,G2)],["rdpu",vt(U2,q2)],["ylgn",vt(V2,Y2)],["ylgnbu",vt(z2,H2)],["ylorbr",vt(W2,j2)],["ylorrd",vt(X2,K2)],["rainbow",j0(dy)],["sinebow",j0(my)]]);function vt(e,t){return({length:n})=>n===1?[e[3][1]]:n===2?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?$n(t,n):e[n])}function sr(e,t){return({length:n})=>n===2?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?$n(t,n):e[n])}function W0(e,t){return({length:n})=>n===2?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?$n(r=>t(1-r),n):e[n].slice().reverse())}function lr(e){return({length:t})=>$n(e,Math.max(2,Math.floor(t)))}function j0(e){return({length:t})=>$n(e,Math.floor(t)+1).slice(0,-1)}function Sv(e){const t=`${e}`.toLowerCase();if(!Y0.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return Y0.get(t)}function Ou(e,t){const n=Sv(e),r=typeof n=="function"?n({length:t}):n;return r.length!==t?r.slice(0,t):r}function ZP(e,t="greys"){const n=new Set,[r,i]=Ou(t,2);for(const o of e)if(o!=null)if(o===!0)n.add(i);else if(o===!1)n.add(r);else return;return[...n]}const X0=new Map([["brbg",m2],["prgn",b2],["piyg",y2],["puor",v2],["rdbu",Nl],["rdgy",M2],["rdylbu",Sa],["rdylgn",E2],["spectral",C2],["burd",e=>Nl(1-e)],["buylrd",e=>Sa(1-e)],["blues",Q2],["greens",ey],["greys",ny],["purples",iy],["reds",ay],["oranges",ly],["turbo",py],["viridis",by],["magma",gy],["inferno",yy],["plasma",_y],["cividis",uy],["cubehelix",cy],["warm",fy],["cool",hy],["bugn",x2],["bupu",T2],["gnbu",k2],["orrd",D2],["pubugn",B2],["pubu",L2],["purd",G2],["rdpu",q2],["ylgnbu",H2],["ylgn",Y2],["ylorbr",j2],["ylorrd",K2],["rainbow",dy],["sinebow",my]]);function wd(e){const t=`${e}`.toLowerCase();if(!X0.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return X0.get(t)}const QP=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function JP(e){return e!=null&&QP.has(`${e}`.toLowerCase())}const Ev=e=>t=>e(1-t),Nc=[0,1],K0=new Map([["number",It],["rgb",fi],["hsl",w7],["hcl",E7],["lab",M7]]);function Av(e){const t=`${e}`.toLowerCase();if(!K0.has(t))throw new Error(`unknown interpolator: ${t}`);return K0.get(t)}function us(e,t,n,{type:r,nice:i,clamp:o,zero:a,domain:s=Pv(e,n),unknown:l,round:u,scheme:c,interval:f,range:h=mt.get(e)===as?cx(n,s):mt.get(e)===ss?fx(n,s):mt.get(e)===ls?Nc:void 0,interpolate:d=mt.get(e)===Ar?c==null&&h!==void 0?fi:wd(c!==void 0?c:r==="cyclical"?"rainbow":"turbo"):u?Nh:It,reverse:p}){if(f=os(f,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof d!="function"&&(d=Av(d)),p=!!p,h!==void 0){const b=(s=rn(s)).length,y=(h=rn(h)).length;if(b!==y){if(d.length===1)throw new Error("invalid piecewise interpolator");d=uu(d,h),h=void 0}}if(d.length===1?(p&&(d=Ev(d),p=!1),h===void 0&&(h=Float64Array.from(s,(b,y)=>y/(s.length-1)),h.length===2&&(h=Nc)),t.interpolate((h===Nc?is:Sd)(d))):t.interpolate(d),a){const[b,y]=Yt(s);(b>0||y<0)&&(s=Ca(s),uo(s)!==Math.sign(b)?s[s.length-1]=0:s[0]=0)}return p&&(s=sl(s)),t.domain(s).unknown(l),i&&(t.nice(ex(i,r)),s=t.domain()),h!==void 0&&t.range(h),o&&t.clamp(o),{type:r,domain:s,range:h,scale:t,interpolate:d,interval:f}}function ex(e,t){return e===!0?void 0:typeof e=="number"?e:KC(e,t)}function tx(e,t,n){return us(e,Gh(),t,n)}function nx(e,t,n){return Cv(e,t,{...n,exponent:.5})}function Cv(e,t,{exponent:n=1,...r}){return us(e,Wg().exponent(n),t,{...r,type:"pow"})}function rx(e,t,{base:n=10,domain:r=hx(t),...i}){return us(e,zg().base(n),t,{...i,domain:r})}function ix(e,t,{constant:n=1,...r}){return us(e,Vg().constant(n),t,r)}function ox(e,t,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:o="rdylbu",domain:a=dx(t),unknown:s,interpolate:l,reverse:u}){return n===void 0&&(n=l!==void 0?$n(l,i):mt.get(e)===Ar?Ou(o,i):void 0),a.length>0&&(a=jg(a,n===void 0?{length:i}:n).quantiles()),Md(e,t,{domain:a,range:n,reverse:u,unknown:s})}function ax(e,t,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:o=Pv(e,t),unknown:a,interpolate:s,reverse:l}){const[u,c]=Yt(o);let f;return n===void 0?(f=ma(u,c,r),f[0]<=u&&f.splice(0,1),f[f.length-1]>=c&&f.pop(),r=f.length+1,n=s!==void 0?$n(s,r):mt.get(e)===Ar?Ou(i,r):void 0):(f=$n(It(u,c),r+1).slice(1,-1),u instanceof Date&&(f=f.map(h=>new Date(h)))),uo(rn(o))<0&&f.reverse(),Md(e,t,{domain:f,range:n,reverse:l,unknown:a})}function Md(e,t,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:o,range:a=o!==void 0?$n(o,n.length+1):mt.get(e)===Ar?Ou(i,n.length+1):void 0,reverse:s}){n=rn(n);const l=uo(n);if(!isNaN(l)&&!sx(n,l))throw new Error(`the ${e} scale has a non-monotonic domain`);return s&&(a=sl(a)),{type:"threshold",scale:Xg(l<0?sl(n):n,a===void 0?[]:a).unknown(r),domain:n,range:a}}function sx(e,t){for(let n=1,r=e.length,i=e[0];n<r;++n){const o=Ga(i,i=e[n]);if(o!==0&&o!==t)return!1}return!0}function lx(e){return{type:"identity",scale:lP(mt.get(e))?Gg():t=>t}}function Na(e,t=L_){return e.length?[Gt(e,({value:n})=>n===void 0?n:Gt(n,t)),ot(e,({value:n})=>n===void 0?n:ot(n,t))]:[0,1]}function Pv(e,t){const n=mt.get(e);return(n===as||n===ls||n===ss?ux:Na)(t)}function ux(e){return[0,e.length?ot(e,({value:t})=>t===void 0?t:ot(t,L_)):1]}function cx(e,t){const n=e.find(({radius:a})=>a!==void 0);if(n!==void 0)return[0,n.radius];const r=ol(e,.5,({value:a})=>a===void 0?NaN:ol(a,.25,Iu)),i=t.map(a=>3*Math.sqrt(a/r)),o=30/ot(i);return o<1?i.map(a=>a*o):i}function fx(e,t){const n=al(e,({value:o})=>o===void 0?NaN:al(o,Math.abs)),r=t.map(o=>12*o/n),i=60/ot(r);return i<1?r.map(o=>o*i):r}function hx(e){for(const{value:t}of e)if(t!==void 0)for(let n of t){if(n>0)return Na(e,Iu);if(n<0)return Na(e,ld)}return[1,10]}function dx(e){const t=[];for(const{value:n}of e)if(n!==void 0)for(const r of n)t.push(r);return t}function Sd(e){return(t,n)=>r=>e(t+r*(n-t))}function Gu(e,t,n,r,{type:i,nice:o,clamp:a,domain:s=Na(r),unknown:l,pivot:u=0,scheme:c,range:f,symmetric:h=!0,interpolate:d=mt.get(e)===Ar?c==null&&f!==void 0?fi:wd(c!==void 0?c:"rdbu"):It,reverse:p}){u=+u,s=rn(s);let[b,y]=s;if(s.length>2&&Fr(`Warning: the diverging ${e} scale domain contains extra elements.`),Ga(b,y)<0&&([b,y]=[y,b],p=!p),b=Math.min(b,u),y=Math.max(y,u),typeof d!="function"&&(d=Av(d)),f!==void 0&&(d=d.length===1?Sd(d)(...f):uu(d,f)),p&&(d=Ev(d)),h){const _=n.apply(u),v=_-n.apply(b),M=n.apply(y)-_;v<M?b=n.invert(_-M):v>M&&(y=n.invert(_+v))}return t.domain([b,u,y]).unknown(l).interpolator(d),a&&t.clamp(a),o&&t.nice(o),{type:i,domain:[b,y],pivot:u,interpolate:d,scale:t}}function mx(e,t,n){return Gu(e,u2(),yx,t,n)}function px(e,t,n){return xv(e,t,{...n,exponent:.5})}function xv(e,t,{exponent:n=1,...r}){return Gu(e,h2().exponent(n=+n),wx(n),t,{...r,type:"diverging-pow"})}function bx(e,t,{base:n=10,pivot:r=1,domain:i=Na(t,r<0?ld:Iu),...o}){return Gu(e,c2().base(n=+n),_x,t,{domain:i,pivot:r,...o})}function gx(e,t,{constant:n=1,...r}){return Gu(e,f2().constant(n=+n),Mx(n),t,r)}const yx={apply(e){return e},invert(e){return e}},_x={apply:Math.log,invert:Math.exp},vx={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function wx(e){return e===.5?vx:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function Mx(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function Nv(e,t,n,r){return us(e,t,n,r)}function Sx(e,t,n){return Nv(e,sS(),t,n)}function Ex(e,t,n){return Nv(e,lS(),t,n)}const cs=Symbol("ordinal");function Tv(e,t,n,{type:r,interval:i,domain:o,range:a,reverse:s,hint:l}){return i=os(i,r),o===void 0&&(o=kv(n,i,e)),(r==="categorical"||r===cs)&&(r="ordinal"),s&&(o=sl(o)),o=t.domain(o).domain(),a!==void 0&&(typeof a=="function"&&(a=a(o)),t.range(a)),{type:r,domain:o,range:a,scale:t,hint:l,interval:i}}function Ax(e,t,{type:n,interval:r,domain:i,range:o,scheme:a,unknown:s,...l}){r=os(r,n),i===void 0&&(i=kv(t,r,e));let u;if(mt.get(e)===Ru)u=xx(t),o=o===void 0?Nx(u):At(o,gd);else if(mt.get(e)===Ar&&(o===void 0&&(n==="ordinal"||n===cs)&&(o=ZP(i,a),o!==void 0&&(a=void 0)),a===void 0&&o===void 0&&(a=n==="ordinal"?"turbo":"observable10"),a!==void 0))if(o!==void 0){const c=wd(a),f=o[0],h=o[1]-o[0];o=({length:d})=>$n(p=>c(f+h*p),d)}else o=Sv(a);if(s===If)throw new Error(`implicit unknown on ${e} scale is not supported`);return Tv(e,Oh().unknown(s),t,{...l,type:n,domain:i,range:o,hint:u})}function Cx(e,t,{align:n=.5,padding:r=.5,...i}){return Iv(U8().align(n).padding(r),t,i,e)}function Px(e,t,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:o=e==="fx"||e==="fy"?0:r,...a}){return Iv(bu().align(n).paddingInner(i).paddingOuter(o),t,a,e)}function Iv(e,t,n,r){let{round:i}=n;return i!==void 0&&e.round(i=!!i),e=Tv(r,e,t,n),e.round=i,e}function kv(e,t,n){const r=new Ua;for(const{value:i,domain:o}of e){if(o!==void 0)return o();if(i!==void 0)for(const a of i)r.add(a)}if(t!==void 0){const[i,o]=Yt(r).map(t.floor,t);return t.range(i,t.offset(o))}if(r.size>1e4&&mt.get(n)===Xn)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return nl(r,Rn)}function Z0(e,t){let n;for(const{hint:r}of e){const i=r==null?void 0:r[t];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function xx(e){return{fill:Z0(e,"fill"),stroke:Z0(e,"stroke")}}function Nx(e){return zt(e.fill)?RS:BS}function Zf(e,{label:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:a=n,round:s,nice:l,clamp:u,zero:c,align:f,padding:h,projection:d,facet:{label:p=t}={},...b}={}){const y={};for(const[_,v]of e){const M=b[_],g=Dx(_,v,{round:mt.get(_)===Xn?s:void 0,nice:l,clamp:u,zero:c,align:f,padding:h,projection:d,...M});if(g){let{label:w=_==="fx"||_==="fy"?p:t,percent:E,transform:N,inset:x,insetTop:T=x!==void 0?x:_==="y"?r:0,insetRight:S=x!==void 0?x:_==="x"?i:0,insetBottom:P=x!==void 0?x:_==="y"?o:0,insetLeft:I=x!==void 0?x:_==="x"?a:0}=M||{};if(N==null)N=void 0;else if(typeof N!="function")throw new Error("invalid scale transform; not a function");g.percent=!!E,g.label=w===void 0?Ix(v,g):w,g.transform=N,_==="x"||_==="fx"?(g.insetLeft=+I,g.insetRight=+S):(_==="y"||_==="fy")&&(g.insetTop=+T,g.insetBottom=+P),y[_]=g}}return y}function Q0(e){const t={},n={scales:t};for(const[r,i]of Object.entries(e)){const{scale:o,type:a,interval:s,label:l}=i;t[r]=Ox(i),n[r]=o,o.type=a,s!=null&&(o.interval=s),l!=null&&(o.label=l)}return n}function Tx(e,t){const{x:n,y:r,fx:i,fy:o}=e,a=i||o?Ed(t):t;i&&J0(i,a),o&&e1(o,a);const s=i||o?$v(e,t):t;n&&J0(n,s),r&&e1(r,s)}function Ix(e=[],t){let n;for(const{label:r}of e)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!Ai(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function kx(e){return Math.sign(uo(e.domain()))*Math.sign(uo(e.range()))}function Ed(e){const{marginTop:t,marginRight:n,marginBottom:r,marginLeft:i,width:o,height:a,facet:{marginTop:s,marginRight:l,marginBottom:u,marginLeft:c}}=e;return{marginTop:Math.max(t,s),marginRight:Math.max(n,l),marginBottom:Math.max(r,u),marginLeft:Math.max(i,c),width:o,height:a}}function $v({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:s,height:l}=Ed(n);return{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:e?e.scale.bandwidth()+a+i:s,height:t?t.scale.bandwidth()+r+o:l,facet:{width:s,height:l}}}function J0(e,t){if(e.range===void 0){const{insetLeft:n,insetRight:r}=e,{width:i,marginLeft:o=0,marginRight:a=0}=t,s=o+n,l=i-a-r;e.range=[s,Math.max(s,l)],Ai(e)||(e.range=Fv(e)),e.scale.range(e.range)}Dv(e)}function e1(e,t){if(e.range===void 0){const{insetTop:n,insetBottom:r}=e,{height:i,marginTop:o=0,marginBottom:a=0}=t,s=o+n,l=i-a-r;e.range=[Math.max(s,l),s],Ai(e)?e.range.reverse():e.range=Fv(e),e.scale.range(e.range)}Dv(e)}function Dv(e){e.round===void 0&&Bx(e)&&$x(e)<=30&&e.scale.round(!0)}function $x({scale:e}){const t=e.domain().length,[n,r]=e.range(),i=e.paddingInner?e.paddingInner():1,o=e.paddingOuter?e.paddingOuter():e.padding(),a=t-i,s=Math.abs(r-n)/Math.max(1,a+o*2);return(s-Math.floor(s))*a}function Fv(e){const t=e.scale.domain().length+Bv(e);if(!(t>2))return e.range;const[n,r]=e.range;return Array.from({length:t},(i,o)=>n+o/(t-1)*(r-n))}function Dx(e,t=[],n={}){const r=Fx(e,t,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&e!=="fx"&&e!=="fy"&&Ai({type:r})){const i=t.map(({value:o})=>o).filter(o=>o!==void 0);i.some(wn)?Fr(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Di(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${Di(r)}".`):i.some(JC)?Fr(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Di(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${Di(r)}".`):i.some(eP)&&Fr(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Di(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${Di(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=$s(t,n,Dr);break;case"identity":switch(mt.get(e)){case Xn:n=$s(t,n,Dr);break;case Ru:n=$s(t,n,Rx);break}break;case"utc":case"time":n=$s(t,n,YC);break}switch(r){case"diverging":return mx(e,t,n);case"diverging-sqrt":return px(e,t,n);case"diverging-pow":return xv(e,t,n);case"diverging-log":return bx(e,t,n);case"diverging-symlog":return gx(e,t,n);case"categorical":case"ordinal":case cs:return Ax(e,t,n);case"cyclical":case"sequential":case"linear":return tx(e,t,n);case"sqrt":return nx(e,t,n);case"threshold":return Md(e,t,n);case"quantile":return ox(e,t,n);case"quantize":return ax(e,t,n);case"pow":return Cv(e,t,n);case"log":return rx(e,t,n);case"symlog":return ix(e,t,n);case"utc":return Ex(e,t,n);case"time":return Sx(e,t,n);case"point":return Cx(e,t,n);case"band":return Px(e,t,n);case"identity":return lx(e);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function Di(e){return typeof e=="symbol"?e.description:e}function t1(e){return typeof e=="string"?`${e}`.toLowerCase():e}const n1={toString:()=>"projection"};function Fx(e,t,{type:n,domain:r,range:i,scheme:o,pivot:a,projection:s}){if(n=t1(n),e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&s!=null&&(n=n1);for(const u of t){const c=t1(u.type);if(c!==void 0){if(n===void 0)n=c;else if(n!==c)throw new Error(`scale incompatible with channel: ${n} !== ${c}`)}}if(n===n1)return;if(n!==void 0)return n;if(r===void 0&&!t.some(({value:u})=>u!==void 0))return;const l=mt.get(e);if(l===as)return"sqrt";if(l===ls||l===ss)return"linear";if(l===Ru)return"ordinal";if((r||i||[]).length>2)return Tc(l);if(r!==void 0){if(O0(r))return Tc(l);if(wn(r))return"utc"}else{const u=t.map(({value:c})=>c).filter(c=>c!==void 0);if(u.some(O0))return Tc(l);if(u.some(wn))return"utc"}if(l===Ar){if(a!=null||JP(o))return"diverging";if(KP(o))return"categorical"}return"linear"}function Tc(e){switch(e){case Xn:return"point";case Ar:return cs;default:return"ordinal"}}function Ai({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===cs}function Bv({type:e}){return e==="threshold"}function Bx({type:e}){return e==="point"||e==="band"}function zr(e){if(e===void 0)return!0;const t=e.domain(),n=e(t[0]);for(let r=1,i=t.length;r<i;++r)if(e(t[r])-n)return!1;return!0}function $s(e,{domain:t,...n},r){var i;for(const o of e)o.value!==void 0&&(t===void 0&&(t=(i=o.value)==null?void 0:i.domain),o.value=r(o.value));return{domain:t===void 0?t:r(t),...n}}function Rx(e){return At(e,gd)}function Lx(e){return t=>{if(!mt.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return e[t]}}function Ox({scale:e,type:t,domain:n,range:r,interpolate:i,interval:o,transform:a,percent:s,pivot:l}){if(t==="identity")return{type:"identity",apply:c=>c,invert:c=>c};const u=e.unknown?e.unknown():void 0;return{type:t,domain:Ca(n),...r!==void 0&&{range:Ca(r)},...a!==void 0&&{transform:a},...s&&{percent:s},...u!==void 0&&{unknown:u},...o!==void 0&&{interval:o},...i!==void 0&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...l!==void 0&&{pivot:l,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:c=>e(c),...e.invert&&{invert:c=>e.invert(c)}}}function Gx(e){let t,n;return(...r)=>(((n==null?void 0:n.length)!==r.length||n.some((i,o)=>i!==r[o]))&&(n=r,t=e(...r)),t)}const Ux=Gx(e=>new Intl.NumberFormat(e));function qx(e="en-US"){const t=Ux(e);return n=>n!=null&&!isNaN(n)?t.format(n):void 0}function zx(e){return $C(e,"Invalid Date")}function Hx(e="en-US"){const t=qx(e);return n=>(n instanceof Date?zx:typeof n=="number"?t:Rt)(n)}const bi=Hx(),Ht=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let Vx=0;function r1(){return`plot-clip-${++Vx}`}function Yx(e,{title:t,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:s,fillOpacity:l,stroke:u,strokeWidth:c,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:b,strokeDashoffset:y,opacity:_,mixBlendMode:v,imageFilter:M,paintOrder:g,pointerEvents:w,shapeRendering:E,channels:N},{ariaLabel:x,fill:T="currentColor",fillOpacity:S,stroke:P="none",strokeOpacity:I,strokeWidth:$,strokeLinecap:D,strokeLinejoin:A,strokeMiterlimit:F,paintOrder:L}){T===null&&(s=null,l=null),P===null&&(u=null,f=null),zt(T)?!zt(P)&&(!zt(s)||N!=null&&N.fill)&&(P="none"):zt(P)&&(!zt(u)||N!=null&&N.stroke)&&(T="none");const[X,U]=vr(s,T),[z,G]=Ot(l,S),[R,Y]=vr(u,P),[re,Q]=Ot(f,I),[J,K]=Ot(_);Pa(Y)||(c===void 0&&(c=$),d===void 0&&(d=D),h===void 0&&(h=A),p===void 0&&!iP(h)&&(p=F),!Pa(U)&&g===void 0&&(g=L));const[ee,j]=Ot(c);return T!==null&&(e.fill=xt(U,"currentColor"),e.fillOpacity=Lo(G,1)),P!==null&&(e.stroke=xt(Y,"none"),e.strokeWidth=Lo(j,1),e.strokeOpacity=Lo(Q,1),e.strokeLinejoin=xt(h,"miter"),e.strokeLinecap=xt(d,"butt"),e.strokeMiterlimit=Lo(p,4),e.strokeDasharray=xt(b,"none"),e.strokeDashoffset=xt(y,"0")),e.target=Rt(a),e.ariaLabel=Rt(x),e.ariaDescription=Rt(i),e.ariaHidden=Rt(o),e.opacity=Lo(K,1),e.mixBlendMode=xt(v,"normal"),e.imageFilter=xt(M,"none"),e.paintOrder=xt(g,"normal"),e.pointerEvents=xt(w,"auto"),e.shapeRendering=xt(E,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:X,scale:"auto",optional:!0},fillOpacity:{value:z,scale:"auto",optional:!0},stroke:{value:R,scale:"auto",optional:!0},strokeOpacity:{value:re,scale:"auto",optional:!0},strokeWidth:{value:ee,optional:!0},opacity:{value:J,scale:"auto",optional:!0}}}function Wx(e,t){t&&e.filter(n=>sd(t[n])).append("title").call(Xx,t)}function jx(e,t){t&&e.filter(([n])=>sd(t[n])).append("title").call(Kx,t)}function Xx(e,t){t&&e.text(n=>bi(t[n]))}function Kx(e,t){t&&e.text(([n])=>bi(t[n]))}function Cr(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:s,strokeOpacity:l,strokeWidth:u,opacity:c,href:f}){r&&Ie(e,"aria-label",h=>r[h]),o&&Ie(e,"fill",h=>o[h]),a&&Ie(e,"fill-opacity",h=>a[h]),s&&Ie(e,"stroke",h=>s[h]),l&&Ie(e,"stroke-opacity",h=>l[h]),u&&Ie(e,"stroke-width",h=>u[h]),c&&Ie(e,"opacity",h=>c[h]),f&&Rv(e,h=>f[h],t),n||Wx(e,i)}function Zx(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:s,strokeOpacity:l,strokeWidth:u,opacity:c,href:f}){r&&Ie(e,"aria-label",([h])=>r[h]),o&&Ie(e,"fill",([h])=>o[h]),a&&Ie(e,"fill-opacity",([h])=>a[h]),s&&Ie(e,"stroke",([h])=>s[h]),l&&Ie(e,"stroke-opacity",([h])=>l[h]),u&&Ie(e,"stroke-width",([h])=>u[h]),c&&Ie(e,"opacity",([h])=>c[h]),f&&Rv(e,([h])=>f[h],t),n||jx(e,i)}function Qx({ariaLabel:e,title:t,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:a,opacity:s,href:l},{tip:u}){return[e,u?void 0:t,n,r,i,o,a,s,l].filter(c=>c!==void 0)}function Jx(e,t,n){const r=ru(e,i=>t[i]);return n===void 0&&r.size>1+e.length>>1&&Fr("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*eN(e,t,n,r){const{z:i}=n,{z:o}=r,a=Qx(r,n),s=[...t,...a];for(const l of o?Jx(e,o,i):[e]){let u,c;e:for(const f of l){for(const h of s)if(!qr(h[f])){c&&c.push(-1);continue e}if(u===void 0){c&&(yield c),u=a.map(h=>ri(h[f])),c=[f];continue}c.push(f);for(let h=0;h<a.length;++h)if(ri(a[h][f])!==u[h]){yield c,u=a.map(p=>ri(p[f])),c=[f];continue e}}c&&(yield c)}}function tN(e,t,n,r){let i;const{clip:o=r.clip}=t;switch(o){case"frame":{const{width:a,height:s,marginLeft:l,marginRight:u,marginTop:c,marginBottom:f}=n,h=r1();i=`url(#${h})`,e=yt("svg:g",r).call(d=>d.append("svg:clipPath").attr("id",h).append("rect").attr("x",l).attr("y",c).attr("width",a-u-l).attr("height",s-c-f)).each(function(){this.appendChild(e.node()),e.node=()=>this});break}case"sphere":{const{projection:a}=r;if(!a)throw new Error('the "sphere" clip option requires a projection');const s=r1();i=`url(#${s})`,e.append("clipPath").attr("id",s).append("path").attr("d",hu(a)({type:"Sphere"}));break}}Ie(e,"aria-label",t.ariaLabel),Ie(e,"aria-description",t.ariaDescription),Ie(e,"aria-hidden",t.ariaHidden),Ie(e,"clip-path",i)}function Gn(e,t,n,r){tN(e,t,n,r),Ie(e,"fill",t.fill),Ie(e,"fill-opacity",t.fillOpacity),Ie(e,"stroke",t.stroke),Ie(e,"stroke-width",t.strokeWidth),Ie(e,"stroke-opacity",t.strokeOpacity),Ie(e,"stroke-linejoin",t.strokeLinejoin),Ie(e,"stroke-linecap",t.strokeLinecap),Ie(e,"stroke-miterlimit",t.strokeMiterlimit),Ie(e,"stroke-dasharray",t.strokeDasharray),Ie(e,"stroke-dashoffset",t.strokeDashoffset),Ie(e,"shape-rendering",t.shapeRendering),Ie(e,"filter",t.imageFilter),Ie(e,"paint-order",t.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=t;Ie(e,"pointer-events",i)}function Un(e,t){nN(e,"mix-blend-mode",t.mixBlendMode),Ie(e,"opacity",t.opacity)}function Rv(e,t,n){e.each(function(r){const i=t(r);if(i!=null){const o=this.ownerDocument.createElementNS(Ji.svg,"a");o.setAttribute("fill","inherit"),o.setAttributeNS(Ji.xlink,"href",i),n!=null&&o.setAttribute("target",n),this.parentNode.insertBefore(o,this).appendChild(this)}})}function Ie(e,t,n){n!=null&&e.attr(t,n)}function nN(e,t,n){n!=null&&e.style(t,n)}function on(e,t,{x:n,y:r},i=Ht,o=Ht){i+=t.dx,o+=t.dy,n!=null&&n.bandwidth&&(i+=n.bandwidth()/2),r!=null&&r.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&e.attr("transform",`translate(${i},${o})`)}function xt(e,t){if((e=Rt(e))!==t)return e}function Lo(e,t){if((e=rt(e))!==t)return e}const rN=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Ad(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!rN.test(e))throw new Error(`invalid class name: ${e}`);return e}function Cd(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const n of e)Object.assign(n.style,t)}function fs({frameAnchor:e},{width:t,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(e)?a:/right$/.test(e)?t-i:(a+t-i)/2,/^top/.test(e)?r:/^bottom/.test(e)?n-o:(r+n-o)/2]}function iN(e,t,n={}){let r=.5-Ht,i=.5+Ht,o=.5+Ht,a=.5-Ht;for(const{marginTop:b,marginRight:y,marginBottom:_,marginLeft:v}of t)b>r&&(r=b),y>i&&(i=y),_>o&&(o=_),v>a&&(a=v);let{margin:s,marginTop:l=s!==void 0?s:r,marginRight:u=s!==void 0?s:i,marginBottom:c=s!==void 0?s:o,marginLeft:f=s!==void 0?s:a}=n;l=+l,u=+u,c=+c,f=+f;let{width:h=640,height:d=oN(e,n,{width:h,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:o,marginLeftDefault:a})+Math.max(0,l-r+c-o)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:l,marginRight:u,marginBottom:c,marginLeft:f};if(e.fx||e.fy){let{margin:b,marginTop:y=b!==void 0?b:l,marginRight:_=b!==void 0?b:u,marginBottom:v=b!==void 0?b:c,marginLeft:M=b!==void 0?b:f}=n.facet??{};y=+y,_=+_,v=+v,M=+M,p.facet={marginTop:y,marginRight:_,marginBottom:v,marginLeft:M}}return p}function oN({x:e,y:t,fy:n,fx:r},{projection:i,aspectRatio:o},{width:a,marginTopDefault:s,marginRightDefault:l,marginBottomDefault:u,marginLeftDefault:c}){const f=n?n.scale.domain().length:1,h=jP(i);if(h){const p=r?r.scale.domain().length:1,b=(1.1*f-.1)/(1.1*p-.1)*h,y=Math.max(.1,Math.min(10,b));return Math.round((a-c-l)*y+s+u)}const d=t?Ai(t)?t.scale.domain().length:Math.max(7,17/f):1;if(o!=null){if(o=+o,!(isFinite(o)&&o>0))throw new Error(`invalid aspectRatio: ${o}`);const p=i1("y",t)/(i1("x",e)*o),b=r?r.scale.bandwidth():1,y=n?n.scale.bandwidth():1,_=b*(a-c-l)-e.insetLeft-e.insetRight;return(p*_+t.insetTop+t.insetBottom)/y+s+u}return!!(t||n)*Math.max(1,Math.min(60,d*f))*20+!!r*30+60}function i1(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:n,domain:r}=t;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const s=t.scale.exponent();i=l=>Math.pow(l,s);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${n}`)}const[o,a]=Yt(r);return Math.abs(i(a)-i(o))}function aN(e,t){const{fx:n,fy:r}=Zf(e,t),i=n==null?void 0:n.scale.domain(),o=r==null?void 0:r.scale.domain();return i&&o?F5(i,o).map(([a,s],l)=>({x:a,y:s,i:l})):i?i.map((a,s)=>({x:a,i:s})):o?o.map((a,s)=>({y:a,i:s})):void 0}function sN(e,{x:t,y:n}){return t&&(t=Qf(t)),n&&(n=Qf(n)),e.filter(t&&n?r=>t.has(r.x)&&n.has(r.y):t?r=>t.has(r.x):r=>n.has(r.y)).sort(t&&n?(r,i)=>t.get(r.x)-t.get(i.x)||n.get(r.y)-n.get(i.y):t?(r,i)=>t.get(r.x)-t.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function Pd(e,{fx:t,fy:n}){const r=Er(e),i=t==null?void 0:t.value,o=n==null?void 0:n.value;return t&&n?qi(r,a=>(a.fx=i[a[0]],a.fy=o[a[0]],a),a=>i[a],a=>o[a]):t?qi(r,a=>(a.fx=i[a[0]],a),a=>i[a]):qi(r,a=>(a.fy=o[a[0]],a),a=>o[a])}function lN(e,t,{marginTop:n,marginLeft:r}){return e&&t?({x:i,y:o})=>`translate(${e(i)-r},${t(o)-n})`:e?({x:i})=>`translate(${e(i)-r},0)`:({y:i})=>`translate(0,${t(i)-n})`}function uN(e){const t=[],n=new Uint32Array(Br(e,r=>r.length));for(const r of e){let i=0;for(const o of e)r!==o&&(n.set(o,i),i+=o.length);t.push(n.slice(0,i))}return t}const cN=new Map([["top",Ic],["right",Dc],["bottom",kc],["left",$c],["top-left",Ds(Ic,$c)],["top-right",Ds(Ic,Dc)],["bottom-left",Ds(kc,$c)],["bottom-right",Ds(kc,Dc)],["top-empty",dN],["right-empty",bN],["bottom-empty",mN],["left-empty",pN],["empty",gN]]);function fN(e){if(e==null)return null;const t=cN.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const o1=new WeakMap;function Qf(e){let t=o1.get(e);return t||o1.set(e,t=new ui(At(e,(n,r)=>[n,r]))),t}function jr(e,t){return Qf(e).get(t)}function hN(e,t,n){return t=ri(t),n=ri(n),e.find(r=>Object.is(ri(r.x),t)&&Object.is(ri(r.y),n))}function Uu(e,t,n){var r;return(r=hN(e,t,n))==null?void 0:r.empty}function Ic(e,{y:t},{y:n}){return t?jr(t,n)===0:!0}function kc(e,{y:t},{y:n}){return t?jr(t,n)===t.length-1:!0}function $c(e,{x:t},{x:n}){return t?jr(t,n)===0:!0}function Dc(e,{x:t},{x:n}){return t?jr(t,n)===t.length-1:!0}function dN(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=jr(t,r);if(o>0)return Uu(e,n,t[o-1])}function mN(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=jr(t,r);if(o<t.length-1)return Uu(e,n,t[o+1])}function pN(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=jr(t,n);if(o>0)return Uu(e,t[o-1],r)}function bN(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=jr(t,n);if(o<t.length-1)return Uu(e,t[o+1],r)}function gN(e,t,{empty:n}){return n}function Ds(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function Fc(e,{channels:{fx:t,fy:n},groups:r}){return t&&n?e.map(({x:i,y:o})=>{var a;return((a=r.get(i))==null?void 0:a.get(o))??[]}):t?e.map(({x:i})=>r.get(i)??[]):e.map(({y:i})=>r.get(i)??[])}class Kt{constructor(t,n={},r={},i){const{facet:o="auto",facetAnchor:a,fx:s,fy:l,sort:u,dx:c=0,dy:f=0,margin:h=0,marginTop:d=h,marginRight:p=h,marginBottom:b=h,marginLeft:y=h,clip:_=i==null?void 0:i.clip,channels:v,tip:M,render:g}=r;if(this.data=t,this.sort=co(u)?u:null,this.initializer=fo(r).initializer,this.transform=this.initializer?r.transform:Lu(r).transform,o===null||o===!1?this.facet=null:(this.facet=On(o===!0?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===Xs&&typeof s=="string"?[s]:s,this.fy=t===Xs&&typeof l=="string"?[l]:l),this.facetAnchor=fN(a),n=rv(n),v!==void 0&&(n={...yN(v),...n}),i!==void 0&&(n={...Yx(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([w,E])=>{if($u(E.value)){const{value:N,label:x=E.label,scale:T=E.scale}=E.value;E={...E,label:x,scale:T,value:N}}if(t===Xs&&typeof E.value=="string"){const{value:N}=E;E={...E,value:[N]}}return[w,E]}).filter(([w,{value:E,optional:N}])=>{if(E!=null)return!0;if(N)return!1;throw new Error(`missing channel value: ${w}`)})),this.dx=+c,this.dy=+f,this.marginTop=+d,this.marginRight=+p,this.marginBottom=+b,this.marginLeft=+y,this.clip=iv(_),this.tip=_N(M),this.facet==="super"){if(s||l)throw new Error("super-faceting cannot use fx or fy");for(const w in this.channels){const{scale:E}=n[w];if(!(E!=="x"&&E!=="y"))throw new Error("super-faceting cannot use x or y")}}g!=null&&(this.render=Ov(g,this.render))}initialize(t,n,r){let i=rn(this.data);t===void 0&&i!=null&&(t=[Er(i)]);const o=t;this.transform!=null&&({facets:t,data:i}=this.transform(i,t,r),i=rn(i)),t!==void 0&&(t.original=o);const a=BP(this.channels,i);return this.sort!=null&&LP(i,t,a,n,this.sort),{data:i,facets:t,channels:a}}filter(t,n,r){for(const i in n){const{filter:o=qr}=n[i];if(o!==null){const a=r[i];t=t.filter(s=>o(a[s]))}}return t}project(t,n,r){for(const i in t)if(t[i].scale==="x"&&/^x|x$/.test(i)){const o=i.replace(/^x|x$/,"y");o in t&&t[o].scale==="y"&&YP(i,o,n,r.projection)}}scale(t,n,r){const i=RP(t,n);return r.projection&&this.project(t,i,r),i}}function Lv(...e){return e.plot=Kt.prototype.plot,e}function Ov(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(n,r,i,o,a,s){return e.call(this,n,r,i,o,a,(l,u,c,f,h)=>t.call(this,l,u,c,f,h,s))}}function yN(e){return Object.fromEntries(Object.entries(rv(e)).map(([t,n])=>(n=typeof n=="string"?{value:n,label:t}:Du(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[t,n])))}function _N(e){return e===!0?"xy":e===!1||e==null?null:typeof e=="string"?On(e,"tip",["x","y","xy"]):e}function qu(e,t){return(e==null?void 0:e.tip)===!0?{...e,tip:t}:Wr(e==null?void 0:e.tip)&&e.tip.pointer===void 0?{...e,tip:{...e.tip,pointer:t}}:e}const a1=new WeakMap;function xd(e,t,{x:n,y:r,px:i,py:o,maxRadius:a=40,channels:s,render:l,...u}={}){return a=+a,i!=null&&(n??(n=null),s={...s,px:{value:i,scale:"x"}}),o!=null&&(r??(r=null),s={...s,py:{value:o,scale:"y"}}),{x:n,y:r,channels:s,...u,render:Ov(function(c,f,h,d,p,b){p={...p,pointerSticky:!1};const y=p.ownerSVGElement,{data:_}=p.getMarkState(this);let v=a1.get(y);v||a1.set(y,v={sticky:!1,roots:[],renders:[]});let M=v.renders.push(Y)-1;const{x:g,y:w,fx:E,fy:N}=f;let x=E?E(c.fx)-d.marginLeft:0,T=N?N(c.fy)-d.marginTop:0;g!=null&&g.bandwidth&&(x+=g.bandwidth()/2),w!=null&&w.bandwidth&&(T+=w.bandwidth()/2);const S=c.fi!=null;let P;if(S){let K=v.facetStates;K||(v.facetStates=K=new Map),P=K.get(this),P||K.set(this,P=new Map)}const[I,$]=fs(this,d),{px:D,py:A}=h,F=D?K=>D[K]:Gv(h,I),L=A?K=>A[K]:Uv(h,$);let X,U,z,G;function R(K,ee){if(S)if(G&&(G=cancelAnimationFrame(G)),K==null)P.delete(c.fi);else{P.set(c.fi,ee),G=requestAnimationFrame(()=>{G=null;for(const[j,V]of P)if(V<ee||V===ee&&j<c.fi){K=null;break}Y(K)});return}Y(K)}function Y(K){if(X===K&&z===v.sticky)return;X=K,z=p.pointerSticky=v.sticky;const ee=X==null?[]:[X];S&&(ee.fx=c.fx,ee.fy=c.fy,ee.fi=c.fi);const j=b(ee,f,h,d,p);if(U){if(S){const V=U.parentNode,te=U.getAttribute("transform"),B=j.getAttribute("transform");te?j.setAttribute("transform",te):j.removeAttribute("transform"),B?V.setAttribute("transform",B):V.removeAttribute("transform"),j.removeAttribute("aria-label"),j.removeAttribute("aria-description"),j.removeAttribute("aria-hidden")}U.replaceWith(j)}return v.roots[M]=U=j,X==null&&(P==null?void 0:P.size)>1||p.dispatchValue(X==null?null:_[X]),j}function re(K){if(v.sticky||K.pointerType==="mouse"&&K.buttons===1)return;let[ee,j]=z6(K);ee-=x,j-=T;const V=ee<d.marginLeft||ee>d.width-d.marginRight?1:e,te=j<d.marginTop||j>d.height-d.marginBottom?1:t;let B=null,se=a*a;for(const Z of c){const ie=V*(F(Z)-ee),le=te*(L(Z)-j),ve=ie*ie+le*le;ve<=se&&(B=Z,se=ve)}if(B!=null&&(e!==1||t!==1)){const Z=F(B)-ee,ie=L(B)-j;se=Z*Z+ie*ie}R(B,se)}function Q(K){K.pointerType==="mouse"&&X!=null&&(v.sticky&&v.roots.some(ee=>ee==null?void 0:ee.contains(K.target))||(v.sticky?(v.sticky=!1,v.renders.forEach(ee=>ee(null))):(v.sticky=!0,Y(X)),K.stopImmediatePropagation()))}function J(K){K.pointerType==="mouse"&&(v.sticky||R(null))}return y.addEventListener("pointerenter",re),y.addEventListener("pointermove",re),y.addEventListener("pointerdown",Q),y.addEventListener("pointerleave",J),Y(null)},l)}}function vN(e){return xd(1,1,e)}function wN(e){return xd(1,.01,e)}function s1(e){return xd(.01,1,e)}function Gv({x1:e,x2:t,x:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function Uv({y1:e,y2:t,y:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function qv(e){return Ai(e)&&e.interval===void 0?void 0:"tabular-nums"}function MN(e,t){let{label:n=e.label,tickSize:r=6,width:i=240,height:o=44+r,marginTop:a=18,marginRight:s=0,marginBottom:l=16+r,marginLeft:u=0,style:c,ticks:f=(i-u-s)/64,tickFormat:h,fontVariant:d=qv(e),round:p=!0,opacity:b,className:y}=t;const _=vd(t);y=Ad(y),b=Ot(b)[1],h===null&&(h=()=>null);const v=yt("svg",_).attr("class",`${y}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).call(I=>I.append("style").text(`:where(.${y}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${y}-ramp text) {
  white-space: pre;
}`)).call(Cd,c);let M=I=>I.selectAll(".tick line").attr("y1",a+l-o),g;const w=p?(I,$)=>I.rangeRound($):(I,$)=>I.range($),{type:E,domain:N,range:x,interpolate:T,scale:S,pivot:P}=e;if(T){const I=x===void 0?T:uu(T.length===1?Sd(T):T,x);g=w(S.copy(),$n(It(u,i-s),Math.min(N.length+(P!==void 0),x===void 0?1/0:x.length)));const $=256,D=_.document.createElement("canvas");D.width=$,D.height=1;const A=D.getContext("2d");for(let F=0,L=$-1;F<$;++F)A.fillStyle=I(F/L),A.fillRect(F,0,1,1);v.append("image").attr("opacity",b).attr("x",u).attr("y",a).attr("width",i-u-s).attr("height",o-a-l).attr("preserveAspectRatio","none").attr("xlink:href",D.toDataURL())}else if(E==="threshold"){const I=N,$=h===void 0?D=>D:typeof h=="string"?Mo(h):h;g=w(Gh().domain([-1,x.length-1]),[u,i-s]),v.append("g").attr("fill-opacity",b).selectAll().data(x).enter().append("rect").attr("x",(D,A)=>g(A-1)).attr("y",a).attr("width",(D,A)=>g(A)-g(A-1)).attr("height",o-a-l).attr("fill",D=>D),f=At(I,(D,A)=>A),h=D=>$(I[D],D)}else g=w(bu().domain(N),[u,i-s]),v.append("g").attr("fill-opacity",b).selectAll().data(N).enter().append("rect").attr("x",g).attr("y",a).attr("width",Math.max(0,g.bandwidth()-1)).attr("height",o-a-l).attr("fill",S),M=()=>{};return v.append("g").attr("transform",`translate(0,${o-l})`).call(a4(g).ticks(Array.isArray(f)?null:f,typeof h=="string"?h:void 0).tickFormat(typeof h=="function"?h:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",xt(d,"normal")).call(M).call(I=>I.select(".domain").remove()),n!==void 0&&v.append("text").attr("x",u).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),v.node()}const zv=Math.PI/180;function hs(e,{marker:t,markerStart:n=t,markerMid:r=t,markerEnd:i=t}={}){e.markerStart=Bc(n),e.markerMid=Bc(r),e.markerEnd=Bc(i)}function Bc(e){if(e==null||e===!1)return null;if(e===!0)return u1;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return l1("auto");case"arrow-reverse":return l1("auto-start-reverse");case"dot":return SN;case"circle":case"circle-fill":return u1;case"circle-stroke":return EN;case"tick":return Rc("auto");case"tick-x":return Rc(90);case"tick-y":return Rc(0)}throw new Error(`invalid marker: ${e}`)}function l1(e){return(t,n)=>yt("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function SN(e,t){return yt("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function u1(e,t){return yt("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function EN(e,t){return yt("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function Rc(e){return(t,n)=>yt("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let AN=0;function zu(e,t,{stroke:n},r){return Hv(e,t,n&&(i=>n[i]),r)}function CN(e,t,{stroke:n},r){return Hv(e,t,n&&(([i])=>n[i]),r)}function Hv(e,{markerStart:t,markerMid:n,markerEnd:r,stroke:i},o=()=>i,a){const s=new Map;function l(u){return function(c){const f=o(c);let h=s.get(u);h||s.set(u,h=new Map);let d=h.get(f);if(!d){const p=this.parentNode.insertBefore(u(f,a),this),b=`plot-marker-${++AN}`;p.setAttribute("id",b),h.set(f,d=`url(#${b})`)}return d}}t&&e.attr("marker-start",l(t)),n&&e.attr("marker-mid",l(n)),r&&e.attr("marker-end",l(r))}function Vv({inset:e,insetLeft:t,insetRight:n,...r}={}){return[t,n]=Wv(e,t,n),{inset:e,insetLeft:t,insetRight:n,...r}}function Yv({inset:e,insetTop:t,insetBottom:n,...r}={}){return[t,n]=Wv(e,t,n),{inset:e,insetTop:t,insetBottom:n,...r}}function Wv(e,t,n){return e===void 0&&t===void 0&&n===void 0?Ht?[1,0]:[.5,.5]:[t,n]}function jv(e,{interval:t}){return e={...Du(e)},e.interval=md(e.interval===void 0?t:e.interval),e}function Xv(e,t,n,r){const{[e]:i,[`${e}1`]:o,[`${e}2`]:a}=n,{value:s,interval:l}=jv(i,n);if(s==null||l==null&&!r)return n;const u=Ao(i);if(l==null){let d;const p={transform:b=>d||(d=Mt(b,s)),label:u};return{...n,[e]:void 0,[`${e}1`]:o===void 0?p:o,[`${e}2`]:a===void 0&&!(o===a&&r)?p:a}}let c,f;function h(d){return f!==void 0&&d===c?f:f=At(Mt(c=d,s),p=>l.floor(p))}return t({...n,[e]:void 0,[`${e}1`]:o===void 0?{transform:h,label:u}:o,[`${e}2`]:a===void 0?{transform:d=>h(d).map(p=>l.offset(p)),label:u}:a})}function Kv(e,t,n){const{[e]:r}=n,{value:i,interval:o}=jv(r,n);return i==null||o==null?n:t({...n,[e]:{label:Ao(r),transform:a=>{const s=At(Mt(a,i),u=>o.floor(u)),l=s.map(u=>o.offset(u));return s.map(wn(s)?(u,c)=>u==null||isNaN(u=+u)||(c=l[c],c==null)||isNaN(c=+c)?void 0:new Date((u+c)/2):(u,c)=>u==null||(c=l[c],c==null)?NaN:(+u+ +c)/2)}}})}function Zv(e={}){return Xv("x",Vv,e)}function Qv(e={}){return Xv("y",Yv,e)}function PN(e={}){return Kv("x",Vv,e)}function xN(e={}){return Kv("y",Yv,e)}const Jv={ariaLabel:"rule",fill:null,stroke:"currentColor"};class NN extends Kt{constructor(t,n={}){const{x:r,y1:i,y2:o,inset:a=0,insetTop:s=a,insetBottom:l=a}=n;super(t,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},qu(n,"x"),Jv),this.insetTop=rt(s),this.insetBottom=rt(l),hs(this,n)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y1:u,y2:c}=r,{width:f,height:h,marginTop:d,marginRight:p,marginLeft:b,marginBottom:y}=i,{insetTop:_,insetBottom:v}=this;return yt("svg:g",o).call(Gn,this,i,o).call(on,this,{x:l&&a},Ht,0).call(M=>M.selectAll().data(t).enter().append("line").call(Un,this).attr("x1",l?g=>l[g]:(b+f-p)/2).attr("x2",l?g=>l[g]:(b+f-p)/2).attr("y1",u&&!zr(s)?g=>u[g]+_:d+_).attr("y2",c&&!zr(s)?s.bandwidth?g=>c[g]+s.bandwidth()-v:g=>c[g]-v:h-y-v).call(Cr,this,r).call(zu,this,r,o)).node()}}class TN extends Kt{constructor(t,n={}){const{x1:r,x2:i,y:o,inset:a=0,insetRight:s=a,insetLeft:l=a}=n;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},qu(n,"y"),Jv),this.insetRight=rt(s),this.insetLeft=rt(l),hs(this,n)}render(t,n,r,i,o){const{x:a,y:s}=n,{y:l,x1:u,x2:c}=r,{width:f,height:h,marginTop:d,marginRight:p,marginLeft:b,marginBottom:y}=i,{insetLeft:_,insetRight:v}=this;return yt("svg:g",o).call(Gn,this,i,o).call(on,this,{y:l&&s},0,Ht).call(M=>M.selectAll().data(t).enter().append("line").call(Un,this).attr("x1",u&&!zr(a)?g=>u[g]+_:b+_).attr("x2",c&&!zr(a)?a.bandwidth?g=>c[g]+a.bandwidth()-v:g=>c[g]-v:f-p-v).attr("y1",l?g=>l[g]:(d+h-y)/2).attr("y2",l?g=>l[g]:(d+h-y)/2).call(Cr,this,r).call(zu,this,r,o)).node()}}function $t(e,t){let{x:n=Tt,y:r,y1:i,y2:o,...a}=Qv(t);return[i,o]=ew(r,i,o),new NN(e,{...a,x:n,y1:i,y2:o})}function Nt(e,t){let{y:n=Tt,x:r,x1:i,x2:o,...a}=Zv(t);return[i,o]=ew(r,i,o),new TN(e,{...a,y:n,x1:i,x2:o})}function ew(e,t,n){if(e==null){if(t===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,t]}else{if(t===void 0)return n===void 0?[0,e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}function Nd(e,...t){let n=t.length;for(let r=0,i=!0;r<n;++r)typeof t[r]!="function"&&(i&&(e=e.slice(),i=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--n);return r=>{let i=e[0];for(let o=0;o<n;++o)i+=t[o](r)+e[o+1];return i}}const IN={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},tw="";class Td extends Kt{constructor(t,n={}){const{x:r,y:i,text:o=Ei(t)&&nv(t)?Tt:fd,frameAnchor:a,textAnchor:s=/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle",lineAnchor:l=/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle",lineHeight:u=1,lineWidth:c=1/0,textOverflow:f,monospace:h,fontFamily:d=h?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:b,fontVariant:y,fontWeight:_,rotate:v}=n,[M,g]=Ot(v,0),[w,E]=RN(p);if(super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:w,optional:!0},rotate:{value:QC(M),optional:!0},text:{value:o,filter:sd,optional:!0}},n,IN),this.rotate=g,this.textAnchor=xt(s,"middle"),this.lineAnchor=On(l,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+u,this.lineWidth=+c,this.textOverflow=nw(f),this.monospace=!!h,this.fontFamily=Rt(d),this.fontSize=E,this.fontStyle=Rt(b),this.fontVariant=Rt(y),this.fontWeight=Rt(_),this.frameAnchor=Bu(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${c}`);this.splitLines=iw(this),this.clipLine=ow(this)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:u,rotate:c,text:f,title:h,fontSize:d}=r,{rotate:p}=this,[b,y]=fs(this,i);return yt("svg:g",o).call(Gn,this,i,o).call(rw,this,f,i).call(on,this,{x:l&&a,y:u&&s}).call(_=>_.selectAll().data(t).enter().append("text").call(Un,this).call(kN,this,f,h).attr("transform",Nd`translate(${l?v=>l[v]:b},${u?v=>u[v]:y})${c?v=>` rotate(${c[v]})`:p?` rotate(${p})`:""}`).call(Ie,"font-size",d&&(v=>d[v])).call(Cr,this,r)).node()}}function nw(e){return e==null?null:On(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function kN(e,t,n,r){if(!n)return;const{lineAnchor:i,lineHeight:o,textOverflow:a,splitLines:s,clipLine:l}=t;e.each(function(u){const c=s(bi(n[u])??"").map(l),f=c.length,h=i==="top"?.71:i==="bottom"?1-f:(164-f*100)/200;if(f>1){let d=0;for(let p=0;p<f;++p){if(++d,!c[p])continue;const b=this.ownerDocument.createElementNS(Ji.svg,"tspan");b.setAttribute("x",0),p===d-1?b.setAttribute("y",`${(h+p)*o}em`):b.setAttribute("dy",`${d*o}em`),b.textContent=c[p],this.appendChild(b),d=0}}else h&&this.setAttribute("y",`${h*o}em`),this.textContent=c[0];if(a&&!r&&c[0]!==n[u]){const d=this.ownerDocument.createElementNS(Ji.svg,"title");d.textContent=n[u],this.appendChild(d)}})}function wr(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Eo(t,n)),new Td(e,{...r,x:t,y:n})}function $N(e,{x:t=Tt,...n}={}){return new Td(e,xN({...n,x:t}))}function DN(e,{y:t=Tt,...n}={}){return new Td(e,PN({...n,y:t}))}function rw(e,t,n){Ie(e,"text-anchor",t.textAnchor),Ie(e,"font-family",t.fontFamily),Ie(e,"font-size",t.fontSize),Ie(e,"font-style",t.fontStyle),Ie(e,"font-variant",t.fontVariant===void 0?FN(n):t.fontVariant),Ie(e,"font-weight",t.fontWeight)}function FN(e){return e&&(tP(e)||wn(e))?"tabular-nums":void 0}const BN=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function RN(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),BN.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function LN(e,t,n){const r=[];let i,o=0;for(const[a,s,l]of ON(e)){if(i===void 0&&(i=a),o>i&&n(e,i,s)>t&&(r.push(e.slice(i,o)+(e[o-1]===tw?"-":"")),i=a),l){r.push(e.slice(i,s)),i=void 0;continue}o=s}return r}function*ON(e){let t=0,n=0;const r=e.length;for(;n<r;){let i=1;switch(e[n]){case tw:case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];e[++n]===" ";);t=n;break;case"\r":e[n+1]===`
`&&++i;case`
`:yield[t,n,!0],n+=i,t=n;break;default:++n;break}}yield[t,n,!0]}const c1={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"":31,"":31,"":47,"":47,"":82};function Id(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=Co(e,i))r+=c1[e[i]]??(sw(e,i)?120:c1.e);return r}function kd(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=Co(e,i))r+=sw(e,i)?126:63;return r}function iw({monospace:e,lineWidth:t,textOverflow:n}){if(n!=null||t==1/0)return o=>o.split(/\r\n?|\n/g);const r=e?kd:Id,i=t*100;return o=>LN(o,i,r)}function ow({monospace:e,lineWidth:t,textOverflow:n}){if(n==null||t==1/0)return o=>o;const r=e?kd:Id,i=t*100;switch(n){case"clip-start":return o=>h1(o,i,r,"");case"clip-end":return o=>f1(o,i,r,"");case"ellipsis-start":return o=>h1(o,i,r,Vi);case"ellipsis-middle":return o=>GN(o,i,r,Vi);case"ellipsis-end":return o=>f1(o,i,r,Vi)}}const Vi="";function ho(e,t,n,r){const i=[];let o=0;for(let a=0,s=0,l=e.length;a<l;a=s){s=Co(e,a);const u=n(e,a,s);if(o+u>t){for(o+=r;o>t&&a>0;)s=a,a=i.pop(),o-=n(e,a,s);return[a,t-o]}o+=u,i.push(a)}return[-1,0]}function f1(e,t,n,r){e=e.trim();const i=n(r),[o]=ho(e,t,n,i);return o<0?e:e.slice(0,o).trimEnd()+r}function GN(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const o=n(r)/2,[a,s]=ho(e,t/2,n,o),[l]=ho(e,i-t/2-s+o,n,-o);return l<0?r:e.slice(0,a).trimEnd()+r+e.slice(Co(e,l)).trimStart()}function h1(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const o=n(r),[a]=ho(e,i-t+o,n,-o);return a<0?r:r+e.slice(Co(e,a)).trimStart()}const Jf=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,d1=new RegExp("\\p{Extended_Pictographic}","uy");function Co(e,t){return t+=UN(e,t)?2:1,zN(e,t)&&(t=Jf.lastIndex),qN(e,t)?Co(e,t+1):t}function aw(e,t){return e.charCodeAt(t)<128}function UN(e,t){const n=e.charCodeAt(t);if(n>=55296&&n<56320){const r=e.charCodeAt(t+1);return r>=56320&&r<57344}return!1}function qN(e,t){return e.charCodeAt(t)===8205}function zN(e,t){return aw(e,t)?!1:(Jf.lastIndex=t,Jf.test(e))}function sw(e,t){return aw(e,t)?!1:(d1.lastIndex=t,d1.test(e))}const HN={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},lw=3.5,VN=lw*5,uw={draw(e,t,n){const r=t*n/VN;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},YN={draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}},WN=new Map([["arrow",uw],["spike",YN]]);function jN(e){return e&&typeof e.draw=="function"}function XN(e){if(jN(e))return e;const t=WN.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class cw extends Kt{constructor(t,n={}){const{x:r,y:i,r:o=lw,length:a,rotate:s,shape:l=uw,anchor:u="middle",frameAnchor:c}=n,[f,h]=Ot(a,12),[d,p]=Ot(s,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:f,scale:"length",optional:!0},rotate:{value:d,optional:!0}},n,HN),this.r=+o,this.length=h,this.rotate=p,this.shape=XN(l),this.anchor=On(u,"anchor",["start","middle","end"]),this.frameAnchor=Bu(c)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:u,length:c,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:b,r:y}=this,[_,v]=fs(this,i);return yt("svg:g",o).call(Gn,this,i,o).call(on,this,{x:l&&a,y:u&&s}).call(M=>M.selectAll().data(t).enter().append("path").call(Un,this).attr("transform",Nd`translate(${l?g=>l[g]:_},${u?g=>u[g]:v})${f?g=>` rotate(${f[g]})`:d?` rotate(${d})`:""}${p==="start"?"":p==="end"?c?g=>` translate(0,${c[g]})`:` translate(0,${h})`:c?g=>` translate(0,${c[g]/2})`:` translate(0,${h/2})`}`).attr("d",c?g=>{const w=Ir();return b.draw(w,c[g],y),w}:(()=>{const g=Ir();return b.draw(g,h,y),g})()).call(Cr,this,r)).node()}}function KN(e,t={}){const{x:n=Tt,...r}=t;return new cw(e,{...r,x:n})}function ZN(e,t={}){const{y:n=Tt,...r}=t;return new cw(e,{...r,y:n})}function Xr(e,t){return arguments.length<2&&!Ei(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function Hu({anchor:e}={},t){return e===void 0?t[0]:On(e,"anchor",t)}function fw(e){return Hu(e,["left","right"])}function hw(e){return Hu(e,["right","left"])}function dw(e){return Hu(e,["bottom","top"])}function mw(e){return Hu(e,["top","bottom"])}function pw(){const[e,t]=Xr(...arguments);return gw("y",fw(t),e,t)}function QN(){const[e,t]=Xr(...arguments);return gw("fy",hw(t),e,t)}function bw(){const[e,t]=Xr(...arguments);return yw("x",dw(t),e,t)}function JN(){const[e,t]=Xr(...arguments);return yw("fx",mw(t),e,t)}function gw(e,t,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:s=1,fill:l=r,fillOpacity:u=i,textAnchor:c,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=e==="y"?6:0,tickPadding:b,tickRotate:y,x:_,margin:v,marginTop:M=v===void 0?20:v,marginRight:g=v===void 0?t==="right"?40:0:v,marginBottom:w=v===void 0?20:v,marginLeft:E=v===void 0?t==="left"?40:0:v,label:N,labelAnchor:x,labelArrow:T,labelOffset:S,...P}){return p=rt(p),b=rt(b),y=rt(y),x!==void 0&&(x=On(x,"labelAnchor",["center","top","bottom"])),T=Cw(T),Lv(p&&!zt(o)?eT(e,t,n,{stroke:o,strokeOpacity:a,strokeWidth:s,tickSize:p,tickPadding:b,tickRotate:y,x:_,...P}):null,zt(l)?null:nT(e,t,n,{fill:l,fillOpacity:u,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:c,tickSize:p,tickPadding:b,tickRotate:y,x:_,marginTop:M,marginRight:g,marginBottom:w,marginLeft:E,...P}),!zt(l)&&N!==null?wr([],Mw({fill:l,fillOpacity:u,...P},function(I,$,D,A,F){const L=A[e],{marginTop:X,marginRight:U,marginBottom:z,marginLeft:G}=e==="y"&&F.inset||F,R=x??(L.bandwidth?"center":"top"),Y=S??(t==="right"?U:G)-3;return R==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=R,this.frameAnchor=`${R}-${t}`,this.rotate=0),this.dy=R==="top"?3-X:R==="bottom"?z-3:0,this.dx=t==="right"?Y:-Y,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[Aw(e,L,{anchor:t,label:N,labelAnchor:R,labelArrow:T})]}}}})):null)}function yw(e,t,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:s=1,fill:l=r,fillOpacity:u=i,textAnchor:c,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=e==="x"?6:0,tickPadding:b,tickRotate:y,y:_,margin:v,marginTop:M=v===void 0?t==="top"?30:0:v,marginRight:g=v===void 0?20:v,marginBottom:w=v===void 0?t==="bottom"?30:0:v,marginLeft:E=v===void 0?20:v,label:N,labelAnchor:x,labelArrow:T,labelOffset:S,...P}){return p=rt(p),b=rt(b),y=rt(y),x!==void 0&&(x=On(x,"labelAnchor",["center","left","right"])),T=Cw(T),Lv(p&&!zt(o)?tT(e,t,n,{stroke:o,strokeOpacity:a,strokeWidth:s,tickSize:p,tickPadding:b,tickRotate:y,y:_,...P}):null,zt(l)?null:rT(e,t,n,{fill:l,fillOpacity:u,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:c,tickSize:p,tickPadding:b,tickRotate:y,y:_,marginTop:M,marginRight:g,marginBottom:w,marginLeft:E,...P}),!zt(l)&&N!==null?wr([],Mw({fill:l,fillOpacity:u,...P},function(I,$,D,A,F){const L=A[e],{marginTop:X,marginRight:U,marginBottom:z,marginLeft:G}=e==="x"&&F.inset||F,R=x??(L.bandwidth?"center":"right"),Y=S??(t==="top"?X:z)-3;return R==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${R}`,this.textAnchor=R==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-Y:Y,this.dx=R==="right"?U-3:R==="left"?3-G:0,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[Aw(e,L,{anchor:t,label:N,labelAnchor:R,labelArrow:T})]}}}})):null)}function eT(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=t+(e==="y"?"-empty":""),frameAnchor:s=t,tickSize:l,inset:u=0,insetLeft:c=u,insetRight:f=u,dx:h=0,y:d=e==="y"?void 0:null,...p}){return Po(ZN,e,n,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:o,facetAnchor:a,frameAnchor:s,y:d,...p,dx:t==="left"?+h-Ht+ +c:+h+Ht-f,anchor:"start",length:l,shape:t==="left"?fT:hT})}function tT(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=t+(e==="x"?"-empty":""),frameAnchor:s=t,tickSize:l,inset:u=0,insetTop:c=u,insetBottom:f=u,dy:h=0,x:d=e==="x"?void 0:null,...p}){return Po(KN,e,n,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:o,strokeLinecap:i,facetAnchor:a,frameAnchor:s,x:d,...p,dy:t==="bottom"?+h-Ht-f:+h+Ht+ +c,anchor:"start",length:l,shape:t==="bottom"?uT:cT})}function nT(e,t,n,{facetAnchor:r=t+(e==="y"?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:a=0,tickPadding:s=Math.max(3,9-o)+(Math.abs(a)>60?4*Math.cos(a*zv):0),text:l,textAnchor:u=Math.abs(a)>60?"middle":t==="left"?"end":"start",lineAnchor:c=a>60?"top":a<-60?"bottom":"middle",fontVariant:f,inset:h=0,insetLeft:d=h,insetRight:p=h,dx:b=0,y=e==="y"?void 0:null,..._}){return Po(DN,e,n,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:l,textAnchor:u,lineAnchor:c,fontVariant:f,rotate:a,y,..._,dx:t==="left"?+b-o-s+ +d:+b+ +o+ +s-p},function(v,M,g,w,E){f===void 0&&(this.fontVariant=Ew(v)),l===void 0&&(E.text=Sw(v,M,g,w,t))})}function rT(e,t,n,{facetAnchor:r=t+(e==="x"?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:a=0,tickPadding:s=Math.max(3,9-o)+(Math.abs(a)>=10?4*Math.cos(a*zv):0),text:l,textAnchor:u=Math.abs(a)>=10?a<0^t==="bottom"?"start":"end":"middle",lineAnchor:c=Math.abs(a)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:f,inset:h=0,insetTop:d=h,insetBottom:p=h,dy:b=0,x:y=e==="x"?void 0:null,..._}){return Po($N,e,n,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:l===void 0?null:l,textAnchor:u,lineAnchor:c,fontVariant:f,rotate:a,x:y,..._,dy:t==="bottom"?+b+ +o+ +s-p:+b-o-s+ +d},function(v,M,g,w,E){f===void 0&&(this.fontVariant=Ew(v)),l===void 0&&(E.text=Sw(v,M,g,w,t))})}function iT(){const[e,t]=Xr(...arguments);return _w("y",fw(t),e,t)}function oT(){const[e,t]=Xr(...arguments);return _w("fy",hw(t),e,t)}function aT(){const[e,t]=Xr(...arguments);return vw("x",dw(t),e,t)}function sT(){const[e,t]=Xr(...arguments);return vw("fx",mw(t),e,t)}function _w(e,t,n,{y:r=e==="y"?void 0:null,x:i=null,x1:o=t==="left"?i:null,x2:a=t==="right"?i:null,...s}){return Po(Nt,e,n,{ariaLabel:`${e}-grid`,ariaHidden:!0},{y:r,x1:o,x2:a,...ww(s)})}function vw(e,t,n,{x:r=e==="x"?void 0:null,y:i=null,y1:o=t==="top"?i:null,y2:a=t==="bottom"?i:null,...s}){return Po($t,e,n,{ariaLabel:`${e}-grid`,ariaHidden:!0},{x:r,y1:o,y2:a,...ww(s)})}function ww({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:r=t,strokeWidth:i=1,...o}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...o}}function Mw({fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:s,pointerEvents:l,shapeRendering:u,clip:c=!1},f){return[,e]=vr(e),[,t]=Ot(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:s,pointerEvents:l,shapeRendering:u,clip:c,initializer:f}}function Po(e,t,n,r,i,o){let a;function s(c,f,h,d,p,b){const y=c==null&&(t==="fx"||t==="fy"),{[t]:_}=d;if(!_)throw new Error(`missing scale: ${t}`);const v=_.domain();let{interval:M,ticks:g,tickFormat:w,tickSpacing:E=t==="x"?80:35}=i;if(typeof g=="string"&&Pw(_)&&(M=g,g=void 0),g===void 0&&(g=os(M,_.type)??lT(_,E)),c==null){if(Ei(g))c=rn(g);else if(ZC(g))c=Lc(g,...Yt(v));else if(_.interval){let x=_.interval;if(_.ticks){const[T,S]=Yt(v),P=(S-T)/x[rs];x=F0(x,P/g)??x,c=Lc(x,T,S)}else{c=v;const T=c.length;x=F0(x,T/g)??x,x!==_.interval&&(c=Lc(x,...Yt(c)))}if(x===_.interval){const T=Math.round(c.length/g);T>1&&(c=c.filter((S,P)=>P%T===0))}}else _.ticks?c=_.ticks(g):c=v;if(!_.ticks&&c.length&&c!==v){const x=new Ua(v);c=c.filter(T=>x.has(T)),c.length||Fr(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}t==="y"||t==="x"?f=[Er(c)]:a[t]={scale:t,value:Tt}}o==null||o.call(this,_,c,g,w,a);const N=Object.fromEntries(Object.entries(a).map(([x,T])=>[x,{...T,value:Mt(c,T.value)}]));return y&&(f=b.filterFacets(c,N)),{data:c,facets:f,channels:N}}const l=fo(i).initializer,u=e(n,fo({...i,initializer:s},l));return n==null?(a=u.channels,u.channels={}):a={},r!==void 0&&Object.assign(u,r),u.clip===void 0&&(u.clip=!1),u}function lT(e,t){const[n,r]=Yt(e.range());return(r-n)/t}function Sw(e,t,n,r,i){return{value:$d(e,t,n,r,i)}}function $d(e,t,n,r,i){return typeof r=="function"?r:r===void 0&&t&&wn(t)?OC(e.type,t,i)??bi:e.tickFormat?e.tickFormat(typeof n=="number"?n:null,r):r===void 0?bi:typeof r=="string"?(wn(e.domain())?es:Mo)(r):is(r)}function Lc(e,t,n){return e.range(t,e.offset(e.floor(n)))}const uT={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},cT={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},fT={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},hT={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function Ew(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function Aw(e,t,{anchor:n,label:r=t.label,labelAnchor:i,labelArrow:o}={}){if(!(r==null||r.inferred&&Pw(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),o==="auto"&&(o=(!t.bandwidth||t.interval)&&!/[]/.test(r)),!o)return r;if(o===!0){const a=kx(t);a&&(o=/x$/.test(e)||i==="center"?/x$/.test(e)===a<0?"left":"right":a<0?"up":"down")}switch(o){case"left":return` ${r}`;case"right":return`${r} `;case"up":return n==="right"?`${r} `:` ${r}`;case"down":return n==="right"?`${r} `:` ${r}`}return r}}function Cw(e="auto"){return zt(e)?!1:typeof e=="boolean"?e:On(e,"labelArrow",["auto","up","right","down","left"])}function Pw(e){return wn(e.domain())}function m1(e,t){if(t==null)return t;const n=e(t);if(!n)throw new Error(`scale not found: ${t}`);return n}function dT(e,{opacity:t,...n}={}){if(!Ai(e)&&!Bv(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return xw(e,n,(r,i,o,a)=>r.append("svg").attr("width",o).attr("height",a).attr("fill",i.scale).attr("fill-opacity",Ot(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function mT(e,{fill:t=(u=>(u=e.hint)==null?void 0:u.fill)()!==void 0?e.hint.fill:"none",fillOpacity:n=1,stroke:r=(c=>(c=e.hint)==null?void 0:c.stroke)()!==void 0?e.hint.stroke:zt(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:o=1.5,r:a=4.5,...s}={},l){const[f,h]=vr(t),[d,p]=vr(r),b=m1(l,f),y=m1(l,d),_=a*a*Math.PI;return n=Ot(n)[1],i=Ot(i)[1],o=Ot(o)[1],xw(e,s,(v,M,g,w)=>v.append("svg").attr("viewBox","-8 -8 16 16").attr("width",g).attr("height",w).attr("fill",f==="color"?E=>b.scale(E):h).attr("fill-opacity",n).attr("stroke",d==="color"?E=>y.scale(E):p).attr("stroke-opacity",i).attr("stroke-width",o).append("path").attr("d",E=>{const N=Ir();return e.scale(E).draw(N,_),N}))}function xw(e,t={},n){let{columns:r,tickFormat:i,fontVariant:o=qv(e),swatchSize:a=15,swatchWidth:s=a,swatchHeight:l=a,marginLeft:u=0,className:c,style:f,width:h}=t;const d=vd(t);c=Ad(c),i=$d(e.scale,e.domain,void 0,i);const p=yt("div",d).attr("class",`${c}-swatches ${c}-swatches-${r!=null?"columns":"wrap"}`);let b;return r!=null?(b=`:where(.${c}-swatches-columns .${c}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${c}-swatches-columns .${c}-swatch::before) {
  flex-shrink: 0;
}
:where(.${c}-swatches-columns .${c}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",r).selectAll().data(e.domain).enter().append("div").attr("class",`${c}-swatch`).call(n,e,s,l).call(y=>y.append("div").attr("class",`${c}-swatch-label`).attr("title",i).text(i))):(b=`:where(.${c}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${c}-swatches-wrap .${c}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(e.domain).enter().append("span").attr("class",`${c}-swatch`).call(n,e,s,l).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),p.call(y=>y.insert("style","*").text(`:where(.${c}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${c}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${b}`)).style("margin-left",u?`${+u}px`:null).style("width",h===void 0?null:`${+h}px`).style("font-variant",xt(o,"normal")).call(Cd,f).node()}const eh=new Map([["symbol",mT],["color",Tw],["opacity",bT]]);function pT(e,t,n={}){return(r,i)=>{if(!eh.has(r))throw new Error(`unknown legend type: ${r}`);if(r in e)return eh.get(r)(e[r],Nw(t,n[r],i),o=>e[o])}}function Nw({className:e,...t},{label:n,ticks:r,tickFormat:i}={},o){return oP(o,{className:e,...t},{label:n,ticks:r,tickFormat:i})}function Tw(e,{legend:t=!0,...n}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return dT(e,n);case"ramp":return MN(e,n);default:throw new Error(`unknown legend type: ${t}`)}}function bT({type:e,interpolate:t,...n},{legend:r=!0,color:i=Lr(0,0,0),...o}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return Tw({type:e,...n,interpolate:gT(i)},{legend:r,...o})}function gT(e){const{r:t,g:n,b:r}=Lr(e)||Lr(0,0,0);return i=>`rgba(${t},${n},${r},${i})`}function yT(e,t,n){const r=[];for(const[i,o]of eh){const a=n[i];if(a!=null&&a.legend&&i in e){const s=o(e[i],Nw(t,e[i],a),l=>e[l]);s!=null&&r.push(s)}}return r}const _T={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},vT={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class wT extends Kt{constructor(t={}){const{anchor:n=null,inset:r=0,insetTop:i=r,insetRight:o=r,insetBottom:a=r,insetLeft:s=r,rx:l,ry:u}=t;super(Xs,void 0,t,n==null?_T:vT),this.anchor=j_(n,"anchor",["top","right","bottom","left"]),this.insetTop=rt(i),this.insetRight=rt(o),this.insetBottom=rt(a),this.insetLeft=rt(s),this.rx=rt(l),this.ry=rt(u)}render(t,n,r,i,o){const{marginTop:a,marginRight:s,marginBottom:l,marginLeft:u,width:c,height:f}=i,{anchor:h,insetTop:d,insetRight:p,insetBottom:b,insetLeft:y,rx:_,ry:v}=this,M=u+y,g=c-s-p,w=a+d,E=f-l-b;return yt(h?"svg:line":"svg:rect",o).datum(0).call(Gn,this,i,o).call(Un,this).call(Cr,this,r).call(on,this,{}).call(h==="left"?N=>N.attr("x1",M).attr("x2",M).attr("y1",w).attr("y2",E):h==="right"?N=>N.attr("x1",g).attr("x2",g).attr("y1",w).attr("y2",E):h==="top"?N=>N.attr("x1",M).attr("x2",g).attr("y1",w).attr("y2",w):h==="bottom"?N=>N.attr("x1",M).attr("x2",g).attr("y1",E).attr("y2",E):N=>N.attr("x",M).attr("y",w).attr("width",g-M).attr("height",E-w).attr("rx",_).attr("ry",v)).node()}}function MT(e){return new wT(e)}const Oc={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},ST=new Set(["geometry","href","src","ariaLabel","scales"]);class ET extends Kt{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&Ei(t)&&nv(t)&&(n={...n,title:Tt});const{x:r,y:i,x1:o,x2:a,y1:s,y2:l,anchor:u,preferredAnchor:c="bottom",monospace:f,fontFamily:h=f?"ui-monospace, monospace":void 0,fontSize:d,fontStyle:p,fontVariant:b,fontWeight:y,lineHeight:_=1,lineWidth:v=20,frameAnchor:M,format:g,textAnchor:w="start",textOverflow:E,textPadding:N=8,title:x,pointerSize:T=12,pathFilter:S="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:o!=null&&a!=null?null:r,scale:"x",optional:!0},y:{value:s!=null&&l!=null?null:i,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:a==null},y1:{value:s,scale:"y",optional:l==null},x2:{value:a,scale:"x",optional:o==null},y2:{value:l,scale:"y",optional:s==null},title:{value:x,optional:!0}},n,Oc),this.anchor=Yf(u,"anchor"),this.preferredAnchor=Yf(c,"preferredAnchor"),this.frameAnchor=Bu(M),this.textAnchor=xt(w,"middle"),this.textPadding=+N,this.pointerSize=+T,this.pathFilter=Rt(S),this.lineHeight=+_,this.lineWidth=+v,this.textOverflow=nw(E),this.monospace=!!f,this.fontFamily=Rt(h),this.fontSize=rt(d),this.fontStyle=Rt(p),this.fontVariant=Rt(b),this.fontWeight=Rt(y);for(const P in Oc)P in this.channels&&(this[P]=Oc[P]);this.splitLines=iw(this),this.clipLine=ow(this),this.format={...g}}render(t,n,r,i,o){const a=this,{x:s,y:l,fx:u,fy:c}=n,{ownerSVGElement:f,document:h}=o,{anchor:d,monospace:p,lineHeight:b,lineWidth:y}=this,{textPadding:_,pointerSize:v,pathFilter:M}=this,{marginTop:g,marginLeft:w}=i,{x1:E,y1:N,x2:x,y2:T,x:S=E??x,y:P=N??T}=r,I=u?u(t.fx)-w:0,$=c?c(t.fy)-g:0,[D,A]=fs(this,i),F=Gv(r,D),L=Uv(r,A),X=p?kd:Id,U=X(Vi);let z,G;"title"in r?(z=r.channels,G=TT):(z=NT.call(this,r,n),G=IT);const R=yt("svg:g",o).call(Gn,this,i,o).call(rw,this).call(on,this,{x:S&&s,y:P&&l}).call(Q=>Q.selectAll().data(t).enter().append("g").attr("transform",J=>`translate(${Math.round(F(J))},${Math.round(L(J))})`).call(Un,this).call(J=>J.append("path").attr("filter",M)).call(J=>J.append("text").each(function(K){const ee=ta(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const j=G.call(a,K,t,z,n,r);if(typeof j=="string")for(const V of a.splitLines(j))Y(ee,{value:a.clipLine(V)});else{const V=new Set;for(const te of j){const{label:B=""}=te;B&&V.has(B)||(V.add(B),Y(ee,te))}}})));function Y(Q,{label:J,value:K,color:ee,opacity:j}){J??(J=""),K??(K="");const V=ee!=null||j!=null;let te,B=y*100;const[se]=ho(J,B,X,U);if(se>=0)J=J.slice(0,se).trimEnd()+Vi,te=K.trim(),K="";else{(J||!K&&!V)&&(K=" "+K);const[ie]=ho(K,B-X(J),X,U);ie>=0&&(te=K.trim(),K=K.slice(0,ie).trimEnd()+Vi)}const Z=Q.append("tspan").attr("x",0).attr("dy",`${b}em`).text("");J&&Z.append("tspan").attr("font-weight","bold").text(J),K&&Z.append(()=>h.createTextNode(K)),V&&Z.append("tspan").text(" ").attr("fill",ee).attr("fill-opacity",j).style("user-select","none"),te&&Z.append("title").text(te)}function re(){const{width:Q,height:J}=i.facet??i;R.selectChildren().each(function(K){let{x:ee,width:j,height:V}=this.getBBox();j=Math.round(j),V=Math.round(V);let te=d;if(te===void 0){const Z=F(K)+I,ie=L(K)+$,le=Z+j+v+_*2<Q,ve=Z-j-v-_*2>0,we=ie+V+v+_*2<J,H=ie-V-v-_*2>0;te=le&&ve?we&&H?a.preferredAnchor:H?"bottom":"top":we&&H?le?"left":"right":(le||ve)&&(we||H)?`${H?"bottom":"top"}-${le?"left":"right"}`:a.preferredAnchor}const B=this.firstChild,se=this.lastChild;if(B.setAttribute("d",xT(te,v,_,j,V)),ee)for(const Z of se.childNodes)Z.setAttribute("x",-ee);se.setAttribute("y",`${+CT(te,se.childNodes.length,b).toFixed(6)}em`),se.setAttribute("transform",`translate(${PT(te,v,_,j,V)})`)}),R.attr("visibility",null)}return t.length&&(R.attr("visibility","hidden"),f.isConnected?Promise.resolve().then(re):typeof requestAnimationFrame<"u"&&requestAnimationFrame(re)),R.node()}}function AT(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Eo(t,n)),new ET(e,{...r,x:t,y:n})}function CT(e,t,n){return/^top(?:-|$)/.test(e)?.94-n:-.29-t*n}function PT(e,t,n,r,i){switch(e){case"middle":return[-r/2,i/2];case"top-left":return[n,t+n];case"top":return[-r/2,t/2+n];case"top-right":return[-r-n,t+n];case"right":return[-t/2-r-n,i/2];case"bottom-left":return[n,-t-n];case"bottom":return[-r/2,-t/2-n];case"bottom-right":return[-r-n,-t-n];case"left":return[n+t/2,i/2]}}function xT(e,t,n,r,i){const o=r+n*2,a=i+n*2;switch(e){case"middle":return`M${-o/2},${-a/2}h${o}v${a}h${-o}z`;case"top-left":return`M0,0l${t},${t}h${o-t}v${a}h${-o}z`;case"top":return`M0,0l${t/2},${t/2}h${(o-t)/2}v${a}h${-o}v${-a}h${(o-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-o}v${a}h${o}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-a/2}h${-o}v${a}h${o}v${t/2-a/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${o-t}v${-a}h${-o}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(o-t)/2}v${-a}h${-o}v${a}h${(o-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-o}v${-a}h${o}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-a/2}h${o}v${a}h${-o}v${t/2-a/2}z`}}function NT({channels:e},t){var i,o;const n={};let r=this.format;r=p1(r,e,"x"),r=p1(r,e,"y"),this.format=r;for(const a in r){const s=r[a];if(!(s===null||s===!1))if(a==="fx"||a==="fy")n[a]=!0;else{const l=H0(e,a);l&&(n[a]=l)}}for(const a in e){if(a in n||a in r||ST.has(a))continue;const s=H0(e,a);s&&(n[a]=s)}this.facet&&(t.fx&&!("fx"in r)&&(n.fx=!0),t.fy&&!("fy"in r)&&(n.fy=!0));for(const a in n){const s=this.format[a];if(typeof s=="string"){const l=((i=n[a])==null?void 0:i.value)??((o=t[a])==null?void 0:o.domain())??[];this.format[a]=(wn(l)?es:Mo)(s)}else if(s===void 0||s===!0){const l=t[a];this.format[a]=l!=null&&l.bandwidth?$d(l,l.domain()):bi}}return n}function p1(e,t,n){if(!(n in e))return e;const r=`${n}1`,i=`${n}2`;if((r in e||!(r in t))&&(i in e||!(i in t)))return e;const o=Object.entries(e),a=e[n];return o.splice(o.findIndex(([s])=>s===n)+1,0,[r,a],[i,a]),Object.fromEntries(o)}function TT(e,t,{title:n}){return bi(n.value[e],e)}function*IT(e,t,n,r,i){for(const o in n){if(o==="fx"||o==="fy"){yield{label:Ul(r,n,o),value:this.format[o](t[o],e)};continue}if(o==="x1"&&"x2"in n||o==="y1"&&"y2"in n)continue;const a=n[o];if(o==="x2"&&"x1"in n)yield{label:g1(r,n,"x"),value:b1(this.format.x2,n.x1,a,e)};else if(o==="y2"&&"y1"in n)yield{label:g1(r,n,"y"),value:b1(this.format.y2,n.y1,a,e)};else{const s=a.value[e],l=a.scale;if(!qr(s)&&l==null)continue;yield{label:Ul(r,n,o),value:this.format[o](s,e),color:l==="color"?i[o][e]:null,opacity:l==="opacity"?i[o][e]:null}}}}function b1(e,t,n,r){var i;return(i=n.hint)!=null&&i.length?`${e(n.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}${e(n.value[r],r)}`}function g1(e,t,n){const r=Ul(e,t,`${n}1`,n),i=Ul(e,t,`${n}2`,n);return r===i?r:`${r}${i}`}function Ul(e,t,n,r=n){const i=t[n],o=e[(i==null?void 0:i.scale)??n];return String((o==null?void 0:o.label)??(i==null?void 0:i.label)??r)}function et(e={}){var U;const{facet:t,style:n,title:r,subtitle:i,caption:o,ariaLabel:a,ariaDescription:s}=e,l=Ad(e.className),u=e.marks===void 0?[]:_1(e.marks);u.push(...OT(u));const c=RT(t,e),f=new Map;for(const z of u){const G=v1(z,c,e);G&&f.set(z,G)}const h=new Map;c&&Oo(h,[c],e),Oo(h,f,e);const d=_1(GT(u,h,e));for(const z of d){const G=v1(z,c,e);G&&f.set(z,G)}u.unshift(...d);let p=aN(h,e);if(p!==void 0){const z=c?Fc(p,c):void 0;for(const R of u){if(R.facet===null||R.facet==="super")continue;const Y=f.get(R);Y!==void 0&&(Y.facetsIndex=R.fx!=null||R.fy!=null?Fc(p,Y):z)}const G=new Set;for(const{facetsIndex:R}of f.values())R==null||R.forEach((Y,re)=>{(Y==null?void 0:Y.length)>0&&G.add(re)});p.forEach(0<G.size&&G.size<p.length?(R,Y)=>R.empty=!G.has(Y):R=>R.empty=!1);for(const R of u)if(R.facet==="exclude"){const Y=f.get(R);Y!==void 0&&(Y.facetsIndex=uN(Y.facetsIndex))}}for(const z of mt.keys())Hf(e[z])&&z!=="fx"&&z!=="fy"&&h.set(z,[]);const b=new Map;for(const z of u){if(b.has(z))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:G,channels:R}=f.get(z)??{},{data:Y,facets:re,channels:Q}=z.initialize(G,R,e);Dd(Q,e),b.set(z,{data:Y,facets:re,channels:Q})}const y=Zf(Oo(h,b,e),e),_=iN(y,u,e);Tx(y,_);const v=Q0(y),{fx:M,fy:g}=v,w=M||g?$v(y,_):_,E=M||g?WT(v,_):_,N=vd(e),x=N.document,T=au("svg").call(x.documentElement);let S=T;N.ownerSVGElement=T,N.className=l,N.projection=zP(e,w),N.filterFacets=(z,G)=>Fc(p,{channels:G,groups:Pd(z,G)}),N.getMarkState=z=>{const G=b.get(z),R=f.get(z);return{...G,channels:{...G.channels,...R==null?void 0:R.channels}}},N.dispatchValue=z=>{S.value!==z&&(S.value=z,S.dispatchEvent(new Event("input",{bubbles:!0})))};const P=new Set;for(const[z,G]of b)if(z.initializer!=null){const R=z.facet==="super"?E:w,Y=z.initializer(G.data,G.facets,G.channels,v,R,N);if(Y.data!==void 0&&(G.data=Y.data),Y.facets!==void 0&&(G.facets=Y.facets),Y.channels!==void 0){const{fx:re,fy:Q,...J}=Y.channels;BT(J),Object.assign(G.channels,J);for(const K of Object.values(J)){const{scale:ee}=K;ee!=null&&!sP(mt.get(ee))&&(Iw(K,e),P.add(ee))}(re!=null||Q!=null)&&f.set(z,!0)}}if(P.size){const z=new Map;Oo(z,b,e,re=>P.has(re)),Oo(h,b,e,re=>P.has(re));const G=YT(Zf(z,e),y),{scales:R,...Y}=Q0(G);Object.assign(y,G),Object.assign(v,Y),Object.assign(v.scales,R)}let I,$;p!==void 0&&(I={x:M==null?void 0:M.domain(),y:g==null?void 0:g.domain()},p=sN(p,I),$=lN(M,g,_));for(const[z,G]of b)G.values=z.scale(G.channels,v,N);const{width:D,height:A}=_;ta(T).attr("class",l).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",D).attr("height",A).attr("viewBox",`0 0 ${D} ${A}`).attr("aria-label",a).attr("aria-description",s).call(z=>z.append("style").text(`:where(.${l}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${l} text),
:where(.${l} tspan) {
  white-space: pre;
}`)).call(Cd,n);for(const z of u){const{channels:G,values:R,facets:Y}=b.get(z);if(p===void 0||z.facet==="super"){let re=null;if(Y&&(re=Y[0],re=z.filter(re,G,R),re.length===0))continue;const Q=z.render(re,v,R,E,N);if(Q==null)continue;T.appendChild(Q)}else{let re;for(const Q of p){if(!(((U=z.facetAnchor)==null?void 0:U.call(z,p,I,Q))??!Q.empty))continue;let J=null;if(Y){const ee=f.has(z);if(J=Y[ee?Q.i:0],J=z.filter(J,G,R),J.length===0)continue;!ee&&J===Y[0]&&(J=jC(J)),J.fx=Q.x,J.fy=Q.y,J.fi=Q.i}const K=z.render(J,v,R,w,N);if(K!=null){(re??(re=ta(T).append("g"))).append(()=>K).datum(Q);for(const ee of["aria-label","aria-description","aria-hidden","transform"])K.hasAttribute(ee)&&(re.attr(ee,K.getAttribute(ee)),K.removeAttribute(ee))}}re==null||re.selectChildren().attr("transform",$)}}const F=yT(y,N,e),{figure:L=r!=null||i!=null||o!=null||F.length>0}=e;L&&(S=x.createElement("figure"),S.className=`${l}-figure`,S.style.maxWidth="initial",r!=null&&S.append(y1(x,r,"h2")),i!=null&&S.append(y1(x,i,"h3")),S.append(...F,T),o!=null&&S.append(kT(x,o))),S.scale=Lx(v.scales),S.legend=pT(y,N,e);const X=qP();return X>0&&ta(T).append("text").attr("x",D).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("").append("title").text(`${X.toLocaleString("en-US")} warning${X===1?"":"s"}. Please check the console.`),S}function y1(e,t,n){if(t.ownerDocument)return t;const r=e.createElement(n);return r.append(t),r}function kT(e,t){const n=e.createElement("figcaption");return n.append(t),n}function $T({marks:e=[],...t}={}){return et({...t,marks:[...e,this]})}Kt.prototype.plot=$T;function _1(e){return e.flat(1/0).filter(t=>t!=null).map(DT)}function DT(e){return typeof e.render=="function"?e:new FT(e)}class FT extends Kt{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function Dd(e,t){for(const n in e)Iw(e[n],t);return e}function Iw(e,t){const{scale:n,transform:r=!0}=e;if(n==null||!r)return;const{type:i,percent:o,interval:a,transform:s=o?l=>l*100:tv(a,i)}=t[n]??{};s!=null&&(e.value=At(e.value,s),e.transform=!1)}function BT(e){for(const t in e)bv(t,e[t])}function Oo(e,t,n,r=HC){var i,o;for(const{channels:a}of t.values())for(const s in a){const l=a[s],{scale:u}=l;if(u!=null&&r(u))if(u==="projection"){if(!WP(n)){const c=((i=n.x)==null?void 0:i.domain)===void 0,f=((o=n.y)==null?void 0:o.domain)===void 0;if(c||f){const[h,d]=XP(l);c&&Gc(e,"x",h),f&&Gc(e,"y",d)}}}else Gc(e,u,l)}return e}function Gc(e,t,n){const r=e.get(t);r!==void 0?r.push(n):e.set(t,[n])}function RT(e,t){if(e==null)return;const{x:n,y:r}=e;if(n==null&&r==null)return;const i=rn(e.data);if(i==null)throw new Error("missing facet data");const o={};n!=null&&(o.fx=xa(i,{value:n,scale:"fx"})),r!=null&&(o.fy=xa(i,{value:r,scale:"fy"})),Dd(o,t);const a=Pd(i,o);return{channels:o,groups:a,data:e.data}}function v1(e,t,n){var l;if(e.facet===null||e.facet==="super")return;const{fx:r,fy:i}=e;if(r!=null||i!=null){const u=rn(e.data??r??i);if(u===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(u===null)return;const c={};return r!=null&&(c.fx=xa(u,{value:r,scale:"fx"})),i!=null&&(c.fy=xa(u,{value:i,scale:"fy"})),Dd(c,n),{channels:c,groups:Pd(u,c)}}if(t===void 0)return;const{channels:o,groups:a,data:s}=t;if(e.facet!=="auto"||e.data===s)return{channels:o,groups:a};s.length>0&&(a.size>1||a.size===1&&o.fx&&o.fy&&[...a][0][1].size>1)&&((l=rn(e.data))==null?void 0:l.length)===s.length&&Fr(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isnt faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function LT(e,t={}){return fo({...t,x:null,y:null},(n,r,i,o,a,s)=>s.getMarkState(e))}function OT(e){const t=[];for(const n of e){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:o}=r;i=/^x$/i.test(i)?wN:/^y$/i.test(i)?s1:vN,r=i(LT(n,r)),r.title=null,o===void 0&&(r.preferredAnchor=i===s1?"left":"bottom");const a=AT(n.data,r);a.facet=n.facet,a.facetAnchor=n.facetAnchor,t.push(a)}}return t}function GT(e,t,n){let{projection:r,x:i={},y:o={},fx:a={},fy:s={},axis:l,grid:u,facet:c={},facet:{axis:f=l,grid:h}=c,x:{axis:d=l,grid:p=d===null?null:u}=i,y:{axis:b=l,grid:y=b===null?null:u}=o,fx:{axis:_=f,grid:v=_===null?null:h}=a,fy:{axis:M=f,grid:g=M===null?null:h}=s}=n;(r||!Hf(i)&&!w1("x",e))&&(d=p=null),(r||!Hf(o)&&!w1("y",e))&&(b=y=null),t.has("fx")||(_=v=null),t.has("fy")||(M=g=null),d===void 0&&(d=!Rs(e,"x")),b===void 0&&(b=!Rs(e,"y")),_===void 0&&(_=!Rs(e,"fx")),M===void 0&&(M=!Rs(e,"fy")),d===!0&&(d="bottom"),b===!0&&(b="left"),_===!0&&(_=d==="top"||d===null?"bottom":"top"),M===!0&&(M=b==="right"||b===null?"left":"right");const w=[];return Bs(w,g,oT,s),Fs(w,M,QN,"right","left",c,s),Bs(w,v,sT,a),Fs(w,_,JN,"top","bottom",c,a),Bs(w,y,iT,o),Fs(w,b,pw,"left","right",n,o),Bs(w,p,aT,i),Fs(w,d,bw,"bottom","top",n,i),w}function Fs(e,t,n,r,i,o,a){if(!t)return;const s=UT(t);a=qT(s?r:t,o,a);const{line:l}=a;(n===pw||n===bw)&&l&&!Pa(l)&&e.push(MT(zT(a))),e.push(n(a)),s&&e.push(n({...a,anchor:i,label:null}))}function Bs(e,t,n,r){!t||Pa(t)||e.push(n(HT(t,r)))}function UT(e){return/^\s*both\s*$/i.test(e)}function qT(e,t,{line:n=t.line,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:s,tickRotate:l,fontVariant:u,ariaLabel:c,ariaDescription:f,label:h=t.label,labelAnchor:d,labelArrow:p=t.labelArrow,labelOffset:b}){return{anchor:e,line:n,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:s,tickRotate:l,fontVariant:u,ariaLabel:c,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:b}}function zT(e){const{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:n===!0?void 0:n}}function HT(e,{stroke:t=Fu(e)?e:void 0,ticks:n=VT(e)?e:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:o}){return{stroke:t,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:o}}function VT(e){switch(typeof e){case"number":return!0;case"string":return!Fu(e)}return Ei(e)||typeof(e==null?void 0:e.range)=="function"}function Rs(e,t){const n=`${t}-axis `;return e.some(r=>{var i;return(i=r.ariaLabel)==null?void 0:i.startsWith(n)})}function w1(e,t){for(const n of t)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===e||i==="projection")return!0}return!1}function YT(e,t){for(const n in e){const r=e[n],i=t[n];r.label===void 0&&i&&(r.label=i.label)}return e}function WT({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:s,height:l}=Ed(n),u=e&&M1(e),c=t&&M1(t);return{marginTop:t?c[0]:r,marginRight:e?s-u[1]:i,marginBottom:t?l-c[1]:o,marginLeft:e?u[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:s,height:l}}function M1(e){const t=e.domain();let n=e(t[0]),r=e(t[t.length-1]);return r<n&&([n,r]=[r,n]),[n,r+e.bandwidth()]}const jT=new Map([["basis",LS],["basis-closed",OS],["basis-open",GS],["bundle",US],["bump-x",PS],["bump-y",xS],["cardinal",qS],["cardinal-closed",zS],["cardinal-open",HS],["catmull-rom",VS],["catmull-rom-closed",YS],["catmull-rom-open",WS],["linear",Eu],["linear-closed",jS],["monotone-x",XS],["monotone-y",KS],["natural",ZS],["step",QS],["step-after",eE],["step-before",JS]]);function XT(e=Eu,t){if(typeof e=="function")return e;const n=jT.get(`${e}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}function kw(e=mo,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?mo:XT(e,t)}function mo(e){return Eu(e)}function KT(e={}){return X_(e)?e:{...e,x:Tt}}function ZT(e={}){return K_(e)?e:{...e,y:Tt}}function QT(e,t){if(t.length===1)return{data:e,facets:t};const n=e.length,r=new Uint8Array(n);let i=0;for(const s of t)for(const l of s)r[l]&&++i,r[l]=1;if(i===0)return{data:e,facets:t};e=Ca(e);const o=e[V_]=new Uint32Array(n+i);t=t.map(s=>Ca(s,Uint32Array));let a=n;r.fill(0);for(const s of t)for(let l=0,u=s.length;l<u;++l){const c=s[l];r[c]?(s[l]=a,e[a]=e[c],o[a]=c,++a):o[c]=c,r[c]=1}return{data:e,facets:t}}function JT(e={},t={}){arguments.length===1&&([e,t]=$w(e));const{y1:n,y:r=n,x:i,...o}=t,[a,s,l,u]=Dw(r,i,"y","x",e,o);return{...a,y1:n,y:s,x1:l,x2:u,x:ev(l,u)}}function eI(e={},t={}){arguments.length===1&&([e,t]=$w(e));const{x1:n,x:r=n,y:i,...o}=t,[a,s,l,u]=Dw(r,i,"x","y",e,o);return{...a,x1:n,x:s,y1:l,y2:u,y:ev(l,u)}}function tI({x:e,x1:t,x2:n,...r}={}){return r=qu(r,"y"),t===void 0&&n===void 0?JT({x:e,...r}):([t,n]=Q_(e,t,n),{...r,x1:t,x2:n})}function nI({y:e,y1:t,y2:n,...r}={}){return r=qu(r,"x"),t===void 0&&n===void 0?eI({y:e,...r}):([t,n]=Q_(e,t,n),{...r,y1:t,y2:n})}function $w(e){const{offset:t,order:n,reverse:r,...i}=e;return[{offset:t,order:n,reverse:r},i]}const rI={length:!0};function Dw(e,t=zC,n,r,{offset:i,order:o,reverse:a},s){if(t===null)throw new Error(`stack requires ${r}`);const l=J_(s),[u,c]=Bi(e),[f,h]=Gl(t),[d,p]=Gl(t);return f.hint=d.hint=rI,i=iI(i),o=sI(o,i,r),[Lu(s,(b,y,_)=>{({data:b,facets:y}=QT(b,y));const v=e==null?void 0:c(Vf(Mt(b,e),_==null?void 0:_[n])),M=Mt(b,t,Float64Array),g=Mt(b,l),w=o&&o(b,v,M,g),E=b.length,N=h(new Float64Array(E)),x=p(new Float64Array(E)),T=[];for(const S of y){const P=v?Array.from(ru(S,I=>v[I]).values()):[S];if(w)for(const I of P)I.sort(w);for(const I of P){let $=0,D=0;a&&I.reverse();for(const A of I){const F=M[A];F<0?$=x[A]=(N[A]=$)+F:F>0?D=x[A]=(N[A]=D)+F:x[A]=N[A]=D}}T.push(P)}return i&&i(T,N,x,g),{data:b,facets:y}}),u,f,d]}function iI(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return oI;case"center":case"silhouette":return aI;case"wiggle":return Bw}throw new Error(`unknown offset: ${e}`)}}function Fw(e,t){let n=0,r=0;for(const i of e){const o=t[i];o<n&&(n=o),o>r&&(r=o)}return[n,r]}function oI(e,t,n){for(const r of e)for(const i of r){const[o,a]=Fw(i,n);for(const s of i){const l=1/(a-o||1);t[s]=l*(t[s]-o),n[s]=l*(n[s]-o)}}}function aI(e,t,n){for(const r of e){for(const i of r){const[o,a]=Fw(i,n);for(const s of i){const l=(a+o)/2;t[s]-=l,n[s]-=l}}Rw(r,t,n)}Lw(e,t,n)}function Bw(e,t,n,r){for(const i of e){const o=new ui;let a=0;for(const s of i){let l=-1;const u=s.map(d=>Math.abs(n[d]-t[d])),c=s.map(d=>{l=r?r[d]:++l;const p=n[d]-t[d],b=o.has(l)?p-o.get(l):0;return o.set(l,p),b}),f=[0,...B5(c)];for(const d of s)t[d]+=a,n[d]+=a;const h=Br(u);h&&(a-=Br(u,(d,p)=>(c[p]/2+f[p])*d)/h)}Rw(i,t,n)}Lw(e,t,n)}function Rw(e,t,n){const r=Gt(e,i=>Gt(i,o=>t[o]));for(const i of e)for(const o of i)t[o]-=r,n[o]-=r}function Lw(e,t,n){const r=e.length;if(r===1)return;const i=e.map(s=>s.flat()),o=i.map(s=>(Gt(s,l=>t[l])+ot(s,l=>n[l]))/2),a=Gt(o);for(let s=0;s<r;s++){const l=a-o[s];for(const u of i[s])t[u]+=l,n[u]+=l}}function sI(e,t,n){if(e===void 0&&t===Bw)return S1(Rn);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),i=r?Ol:Rn;switch((r?e.slice(1):e).toLowerCase()){case"value":case n:return lI(i);case"z":return uI(i);case"sum":return cI(i);case"appearance":return fI(i);case"inside-out":return S1(i)}return E1(Y_(e))}if(typeof e=="function")return(e.length===1?E1:hI)(e);if(Array.isArray(e))return dI(e);throw new Error(`invalid order: ${e}`)}}function lI(e){return(t,n,r)=>(i,o)=>e(r[i],r[o])}function uI(e){return(t,n,r,i)=>(o,a)=>e(i[o],i[a])}function cI(e){return Vu(e,(t,n,r,i)=>Mh(Er(t),o=>Br(o,a=>r[a]),o=>i[o]))}function fI(e){return Vu(e,(t,n,r,i)=>Mh(Er(t),o=>n[gb(o,a=>r[a])],o=>i[o]))}function S1(e){return Vu(e,(t,n,r,i)=>{const o=Er(t),a=Mh(o,f=>n[gb(f,h=>r[h])],f=>i[f]),s=qi(o,f=>Br(f,h=>r[h]),f=>i[f]),l=[],u=[];let c=0;for(const f of a)c<0?(c+=s.get(f),l.push(f)):(c-=s.get(f),u.push(f));return u.reverse().concat(l)})}function E1(e){return t=>{const n=Mt(t,e);return(r,i)=>Rn(n[r],n[i])}}function hI(e){return t=>(n,r)=>e(t[n],t[r])}function dI(e){return Vu(Rn,()=>e)}function Vu(e,t){return(n,r,i,o)=>{if(!o)throw new Error("missing channel: z");const a=new ui(t(n,r,i,o).map((s,l)=>[s,l]));return(s,l)=>e(a.get(o[s]),a.get(o[l]))}}const mI={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class pI extends Kt{constructor(t,n={}){const{x1:r,y1:i,x2:o,y2:a,curve:s,tension:l}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,mI),this.curve=kw(s,l),hs(this,n)}project(t,n,r){this.curve!==mo&&super.project(t,n,r)}render(t,n,r,i,o){const{x1:a,y1:s,x2:l=a,y2:u=s}=r,{curve:c}=this;return yt("svg:g",o).call(Gn,this,i,o).call(on,this,n).call(f=>f.selectAll().data(t).enter().append("path").call(Un,this).attr("d",c===mo&&o.projection?bI(o.projection,a,s,l,u):h=>{const d=Ir(),p=c(d);return p.lineStart(),p.point(a[h],s[h]),p.point(l[h],u[h]),p.lineEnd(),d}).call(Cr,this,r).call(zu,this,r,o)).node()}}function bI(e,t,n,r,i){const o=hu(e);return t=Dr(t),n=Dr(n),r=Dr(r),i=Dr(i),a=>o({type:"LineString",coordinates:[[t[a],n[a]],[r[a],i[a]]]})}function A1(e,{x:t,x1:n,x2:r,y:i,y1:o,y2:a,...s}={}){return[n,r]=C1(t,n,r),[o,a]=C1(i,o,a),new pI(e,{...s,x1:n,x2:r,y1:o,y2:a})}function C1(e,t,n){if(e===void 0){if(t===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[t]}else{if(t===void 0)return n===void 0?[e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}class Fd extends Kt{constructor(t,n,r={},i){super(t,n,r,i);const{inset:o=0,insetTop:a=o,insetRight:s=o,insetBottom:l=o,insetLeft:u=o,rx:c,ry:f}=r;this.insetTop=rt(a),this.insetRight=rt(s),this.insetBottom=rt(l),this.insetLeft=rt(u),this.rx=xt(c,"auto"),this.ry=xt(f,"auto")}render(t,n,r,i,o){const{rx:a,ry:s}=this;return yt("svg:g",o).call(Gn,this,i,o).call(this._transform,this,n).call(l=>l.selectAll().data(t).enter().append("rect").call(Un,this).attr("x",this._x(n,r,i)).attr("width",this._width(n,r,i)).attr("y",this._y(n,r,i)).attr("height",this._height(n,r,i)).call(Ie,"rx",a).call(Ie,"ry",s).call(Cr,this,r)).node()}_x(t,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?o=>n[o]+i:r+i}_y(t,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?o=>n[o]+i:r+i}_width({x:t},{x:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:s}=this,l=n&&t?t.bandwidth():o-r-i;return Math.max(0,l-a-s)}_height({y:t},{y:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:s}=this,l=n&&t?t.bandwidth():o-r-i;return Math.max(0,l-a-s)}}const Ow={ariaLabel:"bar"};class gI extends Fd{constructor(t,n={}){const{x1:r,x2:i,y:o}=n;super(t,{x1:{value:r,scale:"x"},x2:{value:i,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n,Ow)}_transform(t,n,{x:r}){t.call(on,n,{x:r},0,0)}_x({x:t},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:o}=this;return zr(t)?i+o:a=>Math.min(n[a],r[a])+o}_width({x:t},{x1:n,x2:r},{marginRight:i,marginLeft:o,width:a}){const{insetLeft:s,insetRight:l}=this;return zr(t)?a-i-o-s-l:u=>Math.max(0,Math.abs(r[u]-n[u])-s-l)}}class yI extends Fd{constructor(t,n={}){const{x:r,y1:i,y2:o}=n;super(t,{y1:{value:i,scale:"y"},y2:{value:o,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},n,Ow)}_transform(t,n,{y:r}){t.call(on,n,{y:r},0,0)}_y({y:t},{y1:n,y2:r},{marginTop:i}){const{insetTop:o}=this;return zr(t)?i+o:a=>Math.min(n[a],r[a])+o}_height({y:t},{y1:n,y2:r},{marginTop:i,marginBottom:o,height:a}){const{insetTop:s,insetBottom:l}=this;return zr(t)?a-i-o-s-l:u=>Math.max(0,Math.abs(r[u]-n[u])-s-l)}}function ds(e,t={}){return Z_(t)||(t={...t,y:fd,x2:Tt}),new gI(e,tI(Zv(KT(t))))}function po(e,t={}){return Z_(t)||(t={...t,x:fd,y2:Tt}),new yI(e,nI(Qv(ZT(t))))}const _I={ariaLabel:"cell"};class vI extends Fd{constructor(t,{x:n,y:r,...i}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},i,_I)}_transform(t,n){t.call(on,n,{},0,0)}}function th(e,{x:t,y:n,...r}={}){return[t,n]=Eo(t,n),new vI(e,{...r,x:t,y:n})}const wI={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function MI(e){return e.sort===void 0&&e.reverse===void 0?pP({channel:"-r"},e):e}class SI extends Kt{constructor(t,n={}){const{x:r,y:i,r:o,rotate:a,symbol:s=Ea,frameAnchor:l}=n,[u,c]=Ot(a,0),[f,h]=dP(s),[d,p]=Ot(o,f==null?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:d,scale:"r",filter:Iu,optional:!0},rotate:{value:u,optional:!0},symbol:{value:f,scale:"auto",optional:!0}},MI(n),wI),this.r=p,this.rotate=c,this.symbol=h,this.frameAnchor=Bu(l);const{channels:b}=this,{symbol:y}=b;if(y){const{fill:_,stroke:v}=b;y.hint={fill:_?_.value===y.value?"color":"currentColor":this.fill??"currentColor",stroke:v?v.value===y.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:u,r:c,rotate:f,symbol:h}=r,{r:d,rotate:p,symbol:b}=this,[y,_]=fs(this,i),v=b===Ea,M=c?void 0:d*d*Math.PI;return ld(d)&&(t=[]),yt("svg:g",o).call(Gn,this,i,o).call(on,this,{x:l&&a,y:u&&s}).call(g=>g.selectAll().data(t).enter().append(v?"circle":"path").call(Un,this).call(v?w=>{w.attr("cx",l?E=>l[E]:y).attr("cy",u?E=>u[E]:_).attr("r",c?E=>c[E]:d)}:w=>{w.attr("transform",Nd`translate(${l?E=>l[E]:y},${u?E=>u[E]:_})${f?E=>` rotate(${f[E]})`:p?` rotate(${p})`:""}`).attr("d",c&&h?E=>{const N=Ir();return h[E].draw(N,c[E]*c[E]*Math.PI),N}:c?E=>{const N=Ir();return b.draw(N,c[E]*c[E]*Math.PI),N}:h?E=>{const N=Ir();return h[E].draw(N,M),N}:(()=>{const E=Ir();return b.draw(E,M),E})())}).call(Cr,this,r)).node()}}function _n(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=Eo(t,n)),new SI(e,{...r,x:t,y:n})}const EI={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class AI extends Kt{constructor(t,n={}){const{x:r,y:i,z:o,curve:a,tension:s}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:J_(n),optional:!0}},n,EI),this.z=o,this.curve=kw(a,s),hs(this,n)}filter(t){return t}project(t,n,r){this.curve!==mo&&super.project(t,n,r)}render(t,n,r,i,o){const{x:a,y:s}=r,{curve:l}=this;return yt("svg:g",o).call(Gn,this,i,o).call(on,this,n).call(u=>u.selectAll().data(eN(t,[a,s],this,r)).enter().append("path").call(Un,this).call(Zx,this,r).call(CN,this,r,o).attr("d",l===mo&&o.projection?CI(o.projection,a,s):CS().curve(l).defined(c=>c>=0).x(c=>a[c]).y(c=>s[c]))).node()}}function CI(e,t,n){const r=hu(e);return t=Dr(t),n=Dr(n),i=>{let o=[];const a=[o];for(const s of i)s===-1?(o=[],a.push(o)):o.push([t[s],n[s]]);return r({type:"MultiLineString",coordinates:a})}}function Gw(e,{x:t,y:n,...r}={}){return[t,n]=Eo(t,n),new AI(e,{...r,x:t,y:n})}const PI={ariaLabel:"tick",fill:null,stroke:"currentColor"};class xI extends Kt{constructor(t,n,r){super(t,n,r,PI),hs(this,r)}render(t,n,r,i,o){return yt("svg:g",o).call(Gn,this,i,o).call(this._transform,this,n).call(a=>a.selectAll().data(t).enter().append("line").call(Un,this).attr("x1",this._x1(n,r,i)).attr("x2",this._x2(n,r,i)).attr("y1",this._y1(n,r,i)).attr("y2",this._y2(n,r,i)).call(Cr,this,r).call(zu,this,r,o)).node()}}class NI extends xI{constructor(t,n={}){const{x:r,y:i,inset:o=0,insetTop:a=o,insetBottom:s=o}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},n),this.insetTop=rt(a),this.insetBottom=rt(s)}_transform(t,n,{x:r}){t.call(on,n,{x:r},Ht,0)}_x1(t,{x:n}){return r=>n[r]}_x2(t,{x:n}){return r=>n[r]}_y1({y:t},{y:n},{marginTop:r}){const{insetTop:i}=this;return n&&t?o=>n[o]+i:r+i}_y2({y:t},{y:n},{height:r,marginBottom:i}){const{insetBottom:o}=this;return n&&t?a=>n[a]+t.bandwidth()-o:r-i-o}}function nh(e,{x:t=Tt,...n}={}){return new NI(e,{...n,x:t})}const Uw=new Map,qw=new Map,TI=new Map,II=new Map;function kI(e){return Uw.get(e)}function zw(e){return qw.get(e)}function la(e){const t=e%12;return t===1||t===3||t===6||t===8||t===10}const $I=new Map([["Cb","B"],["Db","C#"],["Eb","D#"],["Fb","E"],["Gb","F#"],["Ab","G#"],["Bb","A#"]]),xo=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],ms=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Ta=[{pitch:0,name:"C",octave:-1,label:"C-1",frequency:8.176},{pitch:1,name:"C#",octave:-1,label:"C#-1",frequency:8.662},{pitch:2,name:"D",octave:-1,label:"D-1",frequency:9.177},{pitch:3,name:"D#",octave:-1,label:"D#-1",frequency:9.723},{pitch:4,name:"E",octave:-1,label:"E-1",frequency:10.301},{pitch:5,name:"F",octave:-1,label:"F-1",frequency:10.913},{pitch:6,name:"F#",octave:-1,label:"F#-1",frequency:11.562},{pitch:7,name:"G",octave:-1,label:"G-1",frequency:12.25},{pitch:8,name:"G#",octave:-1,label:"G#-1",frequency:12.978},{pitch:9,name:"A",octave:-1,label:"A-1",frequency:13.75},{pitch:10,name:"A#",octave:-1,label:"A#-1",frequency:14.568},{pitch:11,name:"B",octave:-1,label:"B-1",frequency:15.434},{pitch:12,name:"C",octave:0,label:"C0",frequency:16.352},{pitch:13,name:"C#",octave:0,label:"C#0",frequency:17.324},{pitch:14,name:"D",octave:0,label:"D0",frequency:18.354},{pitch:15,name:"D#",octave:0,label:"D#0",frequency:19.445},{pitch:16,name:"E",octave:0,label:"E0",frequency:20.602},{pitch:17,name:"F",octave:0,label:"F0",frequency:21.827},{pitch:18,name:"F#",octave:0,label:"F#0",frequency:23.125},{pitch:19,name:"G",octave:0,label:"G0",frequency:24.5},{pitch:20,name:"G#",octave:0,label:"G#0",frequency:25.957},{pitch:21,name:"A",octave:0,label:"A0",frequency:27.5},{pitch:22,name:"A#",octave:0,label:"A#0",frequency:29.135},{pitch:23,name:"B",octave:0,label:"B0",frequency:30.868},{pitch:24,name:"C",octave:1,label:"C1",frequency:32.703},{pitch:25,name:"C#",octave:1,label:"C#1",frequency:34.648},{pitch:26,name:"D",octave:1,label:"D1",frequency:36.708},{pitch:27,name:"D#",octave:1,label:"D#1",frequency:38.891},{pitch:28,name:"E",octave:1,label:"E1",frequency:41.203},{pitch:29,name:"F",octave:1,label:"F1",frequency:43.654},{pitch:30,name:"F#",octave:1,label:"F#1",frequency:46.249},{pitch:31,name:"G",octave:1,label:"G1",frequency:48.999},{pitch:32,name:"G#",octave:1,label:"G#1",frequency:51.913},{pitch:33,name:"A",octave:1,label:"A1",frequency:55},{pitch:34,name:"A#",octave:1,label:"A#1",frequency:58.27},{pitch:35,name:"B",octave:1,label:"B1",frequency:61.735},{pitch:36,name:"C",octave:2,label:"C2",frequency:65.406},{pitch:37,name:"C#",octave:2,label:"C#2",frequency:69.296},{pitch:38,name:"D",octave:2,label:"D2",frequency:73.416},{pitch:39,name:"D#",octave:2,label:"D#2",frequency:77.782},{pitch:40,name:"E",octave:2,label:"E2",frequency:82.407},{pitch:41,name:"F",octave:2,label:"F2",frequency:87.307},{pitch:42,name:"F#",octave:2,label:"F#2",frequency:92.499},{pitch:43,name:"G",octave:2,label:"G2",frequency:97.999},{pitch:44,name:"G#",octave:2,label:"G#2",frequency:103.826},{pitch:45,name:"A",octave:2,label:"A2",frequency:110},{pitch:46,name:"A#",octave:2,label:"A#2",frequency:116.541},{pitch:47,name:"B",octave:2,label:"B2",frequency:123.471},{pitch:48,name:"C",octave:3,label:"C3",frequency:130.813},{pitch:49,name:"C#",octave:3,label:"C#3",frequency:138.591},{pitch:50,name:"D",octave:3,label:"D3",frequency:146.832},{pitch:51,name:"D#",octave:3,label:"D#3",frequency:155.563},{pitch:52,name:"E",octave:3,label:"E3",frequency:164.814},{pitch:53,name:"F",octave:3,label:"F3",frequency:174.614},{pitch:54,name:"F#",octave:3,label:"F#3",frequency:184.997},{pitch:55,name:"G",octave:3,label:"G3",frequency:195.998},{pitch:56,name:"G#",octave:3,label:"G#3",frequency:207.652},{pitch:57,name:"A",octave:3,label:"A3",frequency:220},{pitch:58,name:"A#",octave:3,label:"A#3",frequency:233.082},{pitch:59,name:"B",octave:3,label:"B3",frequency:246.942},{pitch:60,name:"C",octave:4,label:"C4",frequency:261.626},{pitch:61,name:"C#",octave:4,label:"C#4",frequency:277.183},{pitch:62,name:"D",octave:4,label:"D4",frequency:293.665},{pitch:63,name:"D#",octave:4,label:"D#4",frequency:311.127},{pitch:64,name:"E",octave:4,label:"E4",frequency:329.628},{pitch:65,name:"F",octave:4,label:"F4",frequency:349.228},{pitch:66,name:"F#",octave:4,label:"F#4",frequency:369.994},{pitch:67,name:"G",octave:4,label:"G4",frequency:391.995},{pitch:68,name:"G#",octave:4,label:"G#4",frequency:415.305},{pitch:69,name:"A",octave:4,label:"A4",frequency:440},{pitch:70,name:"A#",octave:4,label:"A#4",frequency:466.164},{pitch:71,name:"B",octave:4,label:"B4",frequency:493.883},{pitch:72,name:"C",octave:5,label:"C5",frequency:523.251},{pitch:73,name:"C#",octave:5,label:"C#5",frequency:554.365},{pitch:74,name:"D",octave:5,label:"D5",frequency:587.33},{pitch:75,name:"D#",octave:5,label:"D#5",frequency:622.254},{pitch:76,name:"E",octave:5,label:"E5",frequency:659.255},{pitch:77,name:"F",octave:5,label:"F5",frequency:698.456},{pitch:78,name:"F#",octave:5,label:"F#5",frequency:739.989},{pitch:79,name:"G",octave:5,label:"G5",frequency:783.991},{pitch:80,name:"G#",octave:5,label:"G#5",frequency:830.609},{pitch:81,name:"A",octave:5,label:"A5",frequency:880},{pitch:82,name:"A#",octave:5,label:"A#5",frequency:932.328},{pitch:83,name:"B",octave:5,label:"B5",frequency:987.767},{pitch:84,name:"C",octave:6,label:"C6",frequency:1046.502},{pitch:85,name:"C#",octave:6,label:"C#6",frequency:1108.731},{pitch:86,name:"D",octave:6,label:"D6",frequency:1174.659},{pitch:87,name:"D#",octave:6,label:"D#6",frequency:1244.508},{pitch:88,name:"E",octave:6,label:"E6",frequency:1318.51},{pitch:89,name:"F",octave:6,label:"F6",frequency:1396.913},{pitch:90,name:"F#",octave:6,label:"F#6",frequency:1479.978},{pitch:91,name:"G",octave:6,label:"G6",frequency:1567.982},{pitch:92,name:"G#",octave:6,label:"G#6",frequency:1661.219},{pitch:93,name:"A",octave:6,label:"A6",frequency:1760},{pitch:94,name:"A#",octave:6,label:"A#6",frequency:1864.655},{pitch:95,name:"B",octave:6,label:"B6",frequency:1975.533},{pitch:96,name:"C",octave:7,label:"C7",frequency:2093.005},{pitch:97,name:"C#",octave:7,label:"C#7",frequency:2217.461},{pitch:98,name:"D",octave:7,label:"D7",frequency:2349.318},{pitch:99,name:"D#",octave:7,label:"D#7",frequency:2489.016},{pitch:100,name:"E",octave:7,label:"E7",frequency:2637.02},{pitch:101,name:"F",octave:7,label:"F7",frequency:2793.826},{pitch:102,name:"F#",octave:7,label:"F#7",frequency:2959.955},{pitch:103,name:"G",octave:7,label:"G7",frequency:3135.963},{pitch:104,name:"G#",octave:7,label:"G#7",frequency:3322.438},{pitch:105,name:"A",octave:7,label:"A7",frequency:3520},{pitch:106,name:"A#",octave:7,label:"A#7",frequency:3729.31},{pitch:107,name:"B",octave:7,label:"B7",frequency:3951.066},{pitch:108,name:"C",octave:8,label:"C8",frequency:4186.009},{pitch:109,name:"C#",octave:8,label:"C#8",frequency:4434.922},{pitch:110,name:"D",octave:8,label:"D8",frequency:4698.636},{pitch:111,name:"D#",octave:8,label:"D#8",frequency:4978.032},{pitch:112,name:"E",octave:8,label:"E8",frequency:5274.041},{pitch:113,name:"F",octave:8,label:"F8",frequency:5587.652},{pitch:114,name:"F#",octave:8,label:"F#8",frequency:5919.911},{pitch:115,name:"G",octave:8,label:"G8",frequency:6271.927},{pitch:116,name:"G#",octave:8,label:"G#8",frequency:6644.875},{pitch:117,name:"A",octave:8,label:"A8",frequency:7040},{pitch:118,name:"A#",octave:8,label:"A#8",frequency:7458.62},{pitch:119,name:"B",octave:8,label:"B8",frequency:7902.133},{pitch:120,name:"C",octave:9,label:"C9",frequency:8372.018},{pitch:121,name:"C#",octave:9,label:"C#9",frequency:8869.844},{pitch:122,name:"D",octave:9,label:"D9",frequency:9397.273},{pitch:123,name:"D#",octave:9,label:"D#9",frequency:9956.063},{pitch:124,name:"E",octave:9,label:"E9",frequency:10548.08},{pitch:125,name:"F",octave:9,label:"F9",frequency:11175.3},{pitch:126,name:"F#",octave:9,label:"F#9",frequency:11839.82},{pitch:127,name:"G",octave:9,label:"G9",frequency:12543.85}],DI=[{number:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,group:"Piano",label:"Bright Acoustic Piano"},{number:2,group:"Piano",label:"Electric Grand Piano"},{number:3,group:"Piano",label:"Honky-tonk Piano"},{number:4,group:"Piano",label:"Electric Piano 1"},{number:5,group:"Piano",label:"Electric Piano 2"},{number:6,group:"Piano",label:"Harpsichord"},{number:7,group:"Piano",label:"Clavinet"},{number:8,group:"Chromatic Percussion",label:"Celesta"},{number:9,group:"Chromatic Percussion",label:"Glockenspiel"},{number:10,group:"Chromatic Percussion",label:"Music Box"},{number:11,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,group:"Chromatic Percussion",label:"Marimba"},{number:13,group:"Chromatic Percussion",label:"Xylophone"},{number:14,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,group:"Chromatic Percussion",label:"Dulcimer"},{number:16,group:"Organ",label:"Drawbar Organ"},{number:17,group:"Organ",label:"Percussive Organ"},{number:18,group:"Organ",label:"Rock Organ"},{number:19,group:"Organ",label:"Church Organ"},{number:20,group:"Organ",label:"Reed Organ"},{number:21,group:"Organ",label:"Accordion"},{number:22,group:"Organ",label:"Harmonica"},{number:23,group:"Organ",label:"Tango Accordion"},{number:24,group:"Guitar",label:"Acoustic Guitar(nylon)"},{number:25,group:"Guitar",label:"Acoustic Guitar(steel)"},{number:26,group:"Guitar",label:"Electric Guitar(jazz)"},{number:27,group:"Guitar",label:"Electric Guitar(clean)"},{number:28,group:"Guitar",label:"Electric Guitar(muted)"},{number:29,group:"Guitar",label:"Overdriven Guitar"},{number:30,group:"Guitar",label:"Distortion Guitar"},{number:31,group:"Guitar",label:"Guitar harmonics"},{number:32,group:"Bass",label:"Acoustic Bass"},{number:33,group:"Bass",label:"Electric Bass(finger)"},{number:34,group:"Bass",label:"Electric Bass(pick)"},{number:35,group:"Bass",label:"Fretless Bass"},{number:36,group:"Bass",label:"Slap Bass 1"},{number:37,group:"Bass",label:"Slap Bass 2"},{number:38,group:"Bass",label:"Synth Bass 1"},{number:39,group:"Bass",label:"Synth Bass 2"},{number:40,group:"Strings",label:"Violin"},{number:41,group:"Strings",label:"Viola"},{number:42,group:"Strings",label:"Cello"},{number:43,group:"Strings",label:"Contrabass"},{number:44,group:"Strings",label:"Tremolo Strings"},{number:45,group:"Strings",label:"Pizzicato Strings"},{number:46,group:"Strings",label:"Orchestral Harp"},{number:47,group:"Strings",label:"Timpani"},{number:48,group:"Strings (continued)",label:"String Ensemble 1"},{number:49,group:"Strings (continued)",label:"String Ensemble 2"},{number:50,group:"Strings (continued)",label:"Synth Strings 1"},{number:51,group:"Strings (continued)",label:"Synth Strings 2"},{number:52,group:"Strings (continued)",label:"Choir Aahs"},{number:53,group:"Strings (continued)",label:"Voice Oohs"},{number:54,group:"Strings (continued)",label:"Synth Voice"},{number:55,group:"Strings (continued)",label:"Orchestra Hit"},{number:56,group:"Brass",label:"Trumpet"},{number:57,group:"Brass",label:"Trombone"},{number:58,group:"Brass",label:"Tuba"},{number:59,group:"Brass",label:"Muted Trumpet"},{number:60,group:"Brass",label:"French Horn"},{number:61,group:"Brass",label:"Brass Section"},{number:62,group:"Brass",label:"Synth Brass 1"},{number:63,group:"Brass",label:"Synth Brass 2"},{number:64,group:"Reed",label:"Soprano Sax"},{number:65,group:"Reed",label:"Alto Sax"},{number:66,group:"Reed",label:"Tenor Sax"},{number:67,group:"Reed",label:"Baritone Sax"},{number:68,group:"Reed",label:"Oboe"},{number:69,group:"Reed",label:"English Horn"},{number:70,group:"Reed",label:"Bassoon"},{number:71,group:"Reed",label:"Clarinet"},{number:72,group:"Pipe",label:"Piccolo"},{number:73,group:"Pipe",label:"Flute"},{number:74,group:"Pipe",label:"Recorder"},{number:75,group:"Pipe",label:"Pan Flute"},{number:76,group:"Pipe",label:"Blown Bottle"},{number:77,group:"Pipe",label:"Shakuhachi"},{number:78,group:"Pipe",label:"Whistle"},{number:79,group:"Pipe",label:"Ocarina"},{number:80,group:"Synth Lead",label:"Lead 1(square)"},{number:81,group:"Synth Lead",label:"Lead 2(sawtooth)"},{number:82,group:"Synth Lead",label:"Lead 3(calliope)"},{number:83,group:"Synth Lead",label:"Lead 4(chiff)"},{number:84,group:"Synth Lead",label:"Lead 5(charang)"},{number:85,group:"Synth Lead",label:"Lead 6(voice)"},{number:86,group:"Synth Lead",label:"Lead 7(fifths)"},{number:87,group:"Synth Lead",label:"Lead 8(bass + lead)"},{number:88,group:"Synth Pad",label:"Pad 1(new age)"},{number:89,group:"Synth Pad",label:"Pad 2(warm)"},{number:90,group:"Synth Pad",label:"Pad 3(polysynth)"},{number:91,group:"Synth Pad",label:"Pad 4(choir)"},{number:92,group:"Synth Pad",label:"Pad 5(bowed)"},{number:93,group:"Synth Pad",label:"Pad 6(metallic)"},{number:94,group:"Synth Pad",label:"Pad 7(halo)"},{number:95,group:"Synth Pad",label:"Pad 8(sweep)"},{number:96,group:"Synth Effects",label:"FX 1(rain)"},{number:97,group:"Synth Effects",label:"FX 2(soundtrack)"},{number:98,group:"Synth Effects",label:"FX 3(crystal)"},{number:99,group:"Synth Effects",label:"FX 4(atmosphere)"},{number:100,group:"Synth Effects",label:"FX 5(brightness)"},{number:101,group:"Synth Effects",label:"FX 6(goblins)"},{number:102,group:"Synth Effects",label:"FX 7(echoes)"},{number:103,group:"Synth Effects",label:"FX 8(sci-fi)"},{number:104,group:"Ethnic",label:"Sitar"},{number:105,group:"Ethnic",label:"Banjo"},{number:106,group:"Ethnic",label:"Shamisen"},{number:107,group:"Ethnic",label:"Koto"},{number:108,group:"Ethnic",label:"Kalimba"},{number:109,group:"Ethnic",label:"Bag pipe"},{number:110,group:"Ethnic",label:"Fiddle"},{number:111,group:"Ethnic",label:"Shanai"},{number:112,group:"Percussive",label:"Tinkle Bell"},{number:113,group:"Percussive",label:"Agogo"},{number:114,group:"Percussive",label:"Steel Drums"},{number:115,group:"Percussive",label:"Woodblock"},{number:116,group:"Percussive",label:"Taiko Drum"},{number:117,group:"Percussive",label:"Melodic Tom"},{number:118,group:"Percussive",label:"Synth Drum"},{number:119,group:"Sound Effects",label:"Reverse Cymbal"},{number:120,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,group:"Sound Effects",label:"Breath Noise"},{number:122,group:"Sound Effects",label:"Seashore"},{number:123,group:"Sound Effects",label:"Bird Tweet"},{number:124,group:"Sound Effects",label:"Telephone Ring"},{number:125,group:"Sound Effects",label:"Helicopter"},{number:126,group:"Sound Effects",label:"Applause"},{number:127,group:"Sound Effects",label:"Gunshot"}],FI=[{number:1,subnumber:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,subnumber:1,group:"Piano",label:"Wide Acoustic Grand"},{number:1,subnumber:2,group:"Piano",label:"Dark Acoustic Grand"},{number:2,subnumber:0,group:"Piano",label:"Bright Acoustic Piano"},{number:2,subnumber:1,group:"Piano",label:"Wide Bright Acoustic"},{number:3,subnumber:0,group:"Piano",label:"Electric Grand Piano"},{number:3,subnumber:1,group:"Piano",label:"Wide Electric Grand"},{number:4,subnumber:0,group:"Piano",label:"Honky-tonk Piano"},{number:4,subnumber:1,group:"Piano",label:"Wide Honky-tonk"},{number:5,subnumber:0,group:"Piano",label:"Rhodes Piano"},{number:5,subnumber:1,group:"Piano",label:"Detuned Electric Piano 1"},{number:5,subnumber:2,group:"Piano",label:"Electric Piano 1 Variation"},{number:5,subnumber:3,group:"Piano",label:"60's Electric Piano"},{number:6,subnumber:0,group:"Piano",label:"Chorused Electric Piano"},{number:6,subnumber:1,group:"Piano",label:"Detuned Electric Piano 2"},{number:6,subnumber:2,group:"Piano",label:"Electric Piano 2 Variation"},{number:6,subnumber:3,group:"Piano",label:"Electric Piano Legend"},{number:6,subnumber:4,group:"Piano",label:"Electric Piano Phase"},{number:7,subnumber:0,group:"Piano",label:"Harpsichord"},{number:7,subnumber:1,group:"Piano",label:"Coupled Harpsichord"},{number:7,subnumber:2,group:"Piano",label:"Wide Harpsichord"},{number:7,subnumber:3,group:"Piano",label:"Open Harpsichord"},{number:8,subnumber:0,group:"Piano",label:"Clavinet"},{number:8,subnumber:1,group:"Piano",label:"Pulse Clavinet"},{number:9,subnumber:0,group:"Chromatic Percussion",label:"Celesta"},{number:10,subnumber:0,group:"Chromatic Percussion",label:"Glockenspiel"},{number:11,subnumber:0,group:"Chromatic Percussion",label:"Music Box"},{number:12,subnumber:0,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,subnumber:1,group:"Chromatic Percussion",label:"Wet Vibraphone"},{number:13,subnumber:0,group:"Chromatic Percussion",label:"Marimba"},{number:13,subnumber:1,group:"Chromatic Percussion",label:"Wide Marimba"},{number:14,subnumber:0,group:"Chromatic Percussion",label:"Xylophone"},{number:15,subnumber:0,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,subnumber:1,group:"Chromatic Percussion",label:"Church Bells"},{number:15,subnumber:2,group:"Chromatic Percussion",label:"Carillon"},{number:16,subnumber:0,group:"Chromatic Percussion",label:"Dulcimer / Santur"},{number:17,subnumber:0,group:"Organ",label:"Hammond Organ"},{number:17,subnumber:1,group:"Organ",label:"Detuned Organ 1"},{number:17,subnumber:2,group:"Organ",label:"60's Organ 1"},{number:17,subnumber:3,group:"Organ",label:"Organ 4"},{number:18,subnumber:0,group:"Organ",label:"Percussive Organ"},{number:18,subnumber:1,group:"Organ",label:"Detuned Organ 2"},{number:18,subnumber:2,group:"Organ",label:"Organ 5"},{number:19,subnumber:0,group:"Organ",label:"Rock Organ"},{number:20,subnumber:0,group:"Organ",label:"Church Organ 1"},{number:20,subnumber:1,group:"Organ",label:"Church Organ 2"},{number:20,subnumber:2,group:"Organ",label:"Church Organ 3"},{number:21,subnumber:0,group:"Organ",label:"Reed Organ"},{number:21,subnumber:1,group:"Organ",label:"Puff Organ"},{number:22,subnumber:0,group:"Organ",label:"French Accordion"},{number:22,subnumber:1,group:"Organ",label:"Italian Accordion"},{number:23,subnumber:0,group:"Organ",label:"Harmonica"},{number:24,subnumber:0,group:"Organ",label:"Bandoneon"},{number:25,subnumber:0,group:"Guitar",label:"Nylon-String Guitar"},{number:25,subnumber:1,group:"Guitar",label:"Ukelele"},{number:25,subnumber:2,group:"Guitar",label:"Open Nylon Guitar"},{number:25,subnumber:3,group:"Guitar",label:"Nylon Guitar 2"},{number:26,subnumber:0,group:"Guitar",label:"Steel-String Guitar"},{number:26,subnumber:1,group:"Guitar",label:"12-String Guitar"},{number:26,subnumber:2,group:"Guitar",label:"Mandolin"},{number:26,subnumber:3,group:"Guitar",label:"Steel + Body"},{number:27,subnumber:0,group:"Guitar",label:"Jazz Guitar"},{number:27,subnumber:1,group:"Guitar",label:"Hawaiian Guitar"},{number:28,subnumber:0,group:"Guitar",label:"Clean Electric Guitar"},{number:28,subnumber:1,group:"Guitar",label:"Chorus Guitar"},{number:28,subnumber:2,group:"Guitar",label:"Mid Tone Guitar"},{number:29,subnumber:0,group:"Guitar",label:"Muted Electric Guitar"},{number:29,subnumber:1,group:"Guitar",label:"Funk Guitar"},{number:29,subnumber:2,group:"Guitar",label:"Funk Guitar 2"},{number:29,subnumber:3,group:"Guitar",label:"Jazz Man"},{number:30,subnumber:0,group:"Guitar",label:"Overdriven Guitar"},{number:30,subnumber:1,group:"Guitar",label:"Guitar Pinch"},{number:31,subnumber:0,group:"Guitar",label:"Distortion Guitar"},{number:31,subnumber:1,group:"Guitar",label:"Feedback Guitar"},{number:31,subnumber:2,group:"Guitar",label:"Distortion Rtm Guitar"},{number:32,subnumber:0,group:"Guitar",label:"Guitar Harmonics"},{number:32,subnumber:1,group:"Guitar",label:"Guitar Feedback"},{number:33,subnumber:0,group:"Bass",label:"Acoustic Bass"},{number:34,subnumber:0,group:"Bass",label:"Fingered Bass"},{number:34,subnumber:1,group:"Bass",label:"Finger Slap"},{number:35,subnumber:0,group:"Bass",label:"Picked Bass"},{number:36,subnumber:0,group:"Bass",label:"Fretless Bass"},{number:37,subnumber:0,group:"Bass",label:"Slap Bass 1"},{number:38,subnumber:0,group:"Bass",label:"Slap Bass 2"},{number:39,subnumber:0,group:"Bass",label:"Synth Bass 1"},{number:39,subnumber:1,group:"Bass",label:"Synth Bass 101"},{number:39,subnumber:2,group:"Bass",label:"Synth Bass 3"},{number:39,subnumber:3,group:"Bass",label:"Clavi Bass"},{number:39,subnumber:4,group:"Bass",label:"Hammer"},{number:40,subnumber:0,group:"Bass",label:"Synth Bass 2"},{number:40,subnumber:1,group:"Bass",label:"Synth Bass 4"},{number:40,subnumber:2,group:"Bass",label:"Rubber Bass"},{number:40,subnumber:3,group:"Bass",label:"Attack Pulse"},{number:41,subnumber:0,group:"Strings",label:"Violin"},{number:41,subnumber:1,group:"Strings",label:"Slow Violin"},{number:42,subnumber:0,group:"Strings",label:"Viola"},{number:43,subnumber:0,group:"Strings",label:"Cello"},{number:44,subnumber:0,group:"Strings",label:"Contrabass"},{number:45,subnumber:0,group:"Strings",label:"Tremolo Strings"},{number:46,subnumber:0,group:"Strings",label:"Pizzicato Strings"},{number:47,subnumber:0,group:"Strings",label:"Harp"},{number:47,subnumber:1,group:"Strings",label:"Yang Qin"},{number:48,subnumber:0,group:"Strings",label:"Timpani"},{number:49,subnumber:0,group:"Orchestral Ensemble",label:"String Ensemble"},{number:49,subnumber:1,group:"Orchestral Ensemble",label:"Orchestra Strings"},{number:49,subnumber:2,group:"Orchestral Ensemble",label:"60's Strings"},{number:50,subnumber:0,group:"Orchestral Ensemble",label:"Slow String Ensemble"},{number:51,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 1"},{number:51,subnumber:1,group:"Orchestral Ensemble",label:"Synth Strings 3"},{number:52,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 2"},{number:53,subnumber:0,group:"Orchestral Ensemble",label:"Choir Aahs"},{number:53,subnumber:1,group:"Orchestral Ensemble",label:"Choir Aahs 2"},{number:54,subnumber:0,group:"Orchestral Ensemble",label:"Voice Oohs"},{number:54,subnumber:1,group:"Orchestral Ensemble",label:"Humming"},{number:55,subnumber:0,group:"Orchestral Ensemble",label:"Synth Voice"},{number:55,subnumber:1,group:"Orchestral Ensemble",label:"Analog Voice"},{number:56,subnumber:0,group:"Orchestral Ensemble",label:"Orchestra Hit"},{number:56,subnumber:1,group:"Orchestral Ensemble",label:"Bass Hit"},{number:56,subnumber:2,group:"Orchestral Ensemble",label:"6th Hit"},{number:56,subnumber:3,group:"Orchestral Ensemble",label:"Euro Hit"},{number:57,subnumber:0,group:"Brass",label:"Trumpet"},{number:57,subnumber:1,group:"Brass",label:"Dark Trumpet"},{number:58,subnumber:0,group:"Brass",label:"Trombone"},{number:58,subnumber:1,group:"Brass",label:"Trombone 2"},{number:58,subnumber:2,group:"Brass",label:"Bright Trombone"},{number:59,subnumber:0,group:"Brass",label:"Tuba"},{number:60,subnumber:0,group:"Brass",label:"Muted Trumpet"},{number:60,subnumber:1,group:"Brass",label:"Muted Trumpet 2"},{number:61,subnumber:0,group:"Brass",label:"French Horn"},{number:61,subnumber:1,group:"Brass",label:"French Horn 2"},{number:62,subnumber:0,group:"Brass",label:"Brass Section"},{number:62,subnumber:1,group:"Brass",label:"Brass Section"},{number:63,subnumber:0,group:"Brass",label:"Synth Brass 1"},{number:63,subnumber:1,group:"Brass",label:"Synth Brass 3"},{number:63,subnumber:2,group:"Brass",label:"Analog Brass 1"},{number:63,subnumber:3,group:"Brass",label:"Jump Brass"},{number:64,subnumber:0,group:"Brass",label:"Synth Brass 2"},{number:64,subnumber:1,group:"Brass",label:"Synth Brass 4"},{number:64,subnumber:2,group:"Brass",label:"Analog Brass 2"},{number:65,subnumber:0,group:"Reed",label:"Soprano Sax"},{number:66,subnumber:0,group:"Reed",label:"Alto Sax"},{number:67,subnumber:0,group:"Reed",label:"Tenor Sax"},{number:68,subnumber:0,group:"Reed",label:"Baritone Sax"},{number:69,subnumber:0,group:"Reed",label:"Oboe"},{number:70,subnumber:0,group:"Reed",label:"English Horn"},{number:71,subnumber:0,group:"Reed",label:"Bassoon"},{number:72,subnumber:0,group:"Reed",label:"Clarinet"},{number:73,subnumber:0,group:"Wind",label:"Piccolo"},{number:74,subnumber:0,group:"Wind",label:"Flute"},{number:75,subnumber:0,group:"Wind",label:"Recorder"},{number:76,subnumber:0,group:"Wind",label:"Pan Flute"},{number:77,subnumber:0,group:"Wind",label:"Blown Bottle"},{number:78,subnumber:0,group:"Wind",label:"Shakuhachi"},{number:79,subnumber:0,group:"Wind",label:"Whistle"},{number:80,subnumber:0,group:"Wind",label:"Ocarina"},{number:81,subnumber:0,group:"Lead",label:"Square Lead"},{number:81,subnumber:1,group:"Lead",label:"Square Wave"},{number:81,subnumber:2,group:"Lead",label:"Sine Wave"},{number:82,subnumber:0,group:"Lead",label:"Saw Lead"},{number:82,subnumber:1,group:"Lead",label:"Saw Wave"},{number:82,subnumber:2,group:"Lead",label:"Doctor Solo"},{number:82,subnumber:3,group:"Lead",label:"Natural Lead"},{number:82,subnumber:4,group:"Lead",label:"Sequenced Saw"},{number:83,subnumber:0,group:"Lead",label:"Synth Calliope"},{number:84,subnumber:0,group:"Lead",label:"Chiffer Lead"},{number:85,subnumber:0,group:"Lead",label:"Charang"},{number:85,subnumber:1,group:"Lead",label:"Wire Lead"},{number:86,subnumber:0,group:"Lead",label:"Solo Synth Vox"},{number:87,subnumber:0,group:"Lead",label:"5th Saw Wave"},{number:88,subnumber:0,group:"Lead",label:"Bass & Lead"},{number:88,subnumber:1,group:"Lead",label:"Delayed Lead"},{number:89,subnumber:0,group:"Synth Pad",label:"Fantasia Pad"},{number:90,subnumber:0,group:"Synth Pad",label:"Warm Pad"},{number:90,subnumber:1,group:"Synth Pad",label:"Sine Pad"},{number:91,subnumber:0,group:"Synth Pad",label:"Polysynth Pad"},{number:92,subnumber:0,group:"Synth Pad",label:"Space Voice Pad"},{number:92,subnumber:1,group:"Synth Pad",label:"Itopia"},{number:93,subnumber:0,group:"Synth Pad",label:"Bowed Glass Pad"},{number:94,subnumber:0,group:"Synth Pad",label:"Metal Pad"},{number:95,subnumber:0,group:"Synth Pad",label:"Halo Pad"},{number:96,subnumber:0,group:"Synth Pad",label:"Sweep Pad"},{number:97,subnumber:0,group:"Synth Effects",label:"Ice Rain"},{number:98,subnumber:0,group:"Synth Effects",label:"Soundtrack"},{number:99,subnumber:0,group:"Synth Effects",label:"Crystal"},{number:99,subnumber:1,group:"Synth Effects",label:"Synth Mallet"},{number:100,subnumber:0,group:"Synth Effects",label:"Atmosphere"},{number:101,subnumber:0,group:"Synth Effects",label:"Brightness"},{number:102,subnumber:0,group:"Synth Effects",label:"Goblin"},{number:103,subnumber:0,group:"Synth Effects",label:"Echo Drops"},{number:103,subnumber:1,group:"Synth Effects",label:"Echo Bell"},{number:103,subnumber:2,group:"Synth Effects",label:"Echo Pan"},{number:104,subnumber:0,group:"Synth Effects",label:"Star Theme"},{number:105,subnumber:0,group:"Ethnic",label:"Sitar"},{number:105,subnumber:1,group:"Ethnic",label:"Sitar 2"},{number:106,subnumber:0,group:"Ethnic",label:"Banjo"},{number:107,subnumber:0,group:"Ethnic",label:"Shamisen"},{number:108,subnumber:0,group:"Ethnic",label:"Koto"},{number:108,subnumber:1,group:"Ethnic",label:"Taisho Koto"},{number:109,subnumber:0,group:"Ethnic",label:"Kalimba"},{number:110,subnumber:0,group:"Ethnic",label:"Bagpipe"},{number:111,subnumber:0,group:"Ethnic",label:"Fiddle"},{number:112,subnumber:0,group:"Ethnic",label:"Shanai"},{number:113,subnumber:0,group:"Percussive",label:"Tinkle Bell"},{number:114,subnumber:0,group:"Percussive",label:"Agogo"},{number:115,subnumber:0,group:"Percussive",label:"Steel Drums"},{number:116,subnumber:0,group:"Percussive",label:"Woodblock"},{number:116,subnumber:1,group:"Percussive",label:"Castanets"},{number:117,subnumber:0,group:"Percussive",label:"Taiko Drum"},{number:117,subnumber:1,group:"Percussive",label:"Concert Bass Drum"},{number:118,subnumber:0,group:"Percussive",label:"Melodic Tom 1"},{number:118,subnumber:1,group:"Percussive",label:"Melodic Tom 2"},{number:119,subnumber:0,group:"Percussive",label:"Synth Drum"},{number:119,subnumber:1,group:"Percussive",label:"808 Tom"},{number:119,subnumber:2,group:"Percussive",label:"Electric Percussion"},{number:120,subnumber:0,group:"Percussive",label:"Reverse Cymbal"},{number:121,subnumber:0,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,subnumber:1,group:"Sound Effects",label:"Guitar Cut Noise"},{number:121,subnumber:2,group:"Sound Effects",label:"String Slap"},{number:122,subnumber:0,group:"Sound Effects",label:"Breath Noise"},{number:122,subnumber:1,group:"Sound Effects",label:"Flute Key Click"},{number:123,subnumber:0,group:"Sound Effects",label:"Seashore"},{number:123,subnumber:1,group:"Sound Effects",label:"Rain"},{number:123,subnumber:2,group:"Sound Effects",label:"Thunder"},{number:123,subnumber:3,group:"Sound Effects",label:"Wind"},{number:123,subnumber:4,group:"Sound Effects",label:"Stream"},{number:123,subnumber:5,group:"Sound Effects",label:"Bubble"},{number:124,subnumber:0,group:"Sound Effects",label:"Bird Tweet"},{number:124,subnumber:1,group:"Sound Effects",label:"Dog"},{number:124,subnumber:2,group:"Sound Effects",label:"Horse Gallop"},{number:124,subnumber:3,group:"Sound Effects",label:"Bird 2"},{number:125,subnumber:0,group:"Sound Effects",label:"Telephone 1"},{number:125,subnumber:1,group:"Sound Effects",label:"Telephone 2"},{number:125,subnumber:2,group:"Sound Effects",label:"Door Creaking"},{number:125,subnumber:3,group:"Sound Effects",label:"Door Closing"},{number:125,subnumber:4,group:"Sound Effects",label:"Scratch"},{number:125,subnumber:5,group:"Sound Effects",label:"Wind Chimes"},{number:126,subnumber:0,group:"Sound Effects",label:"Helicopter"},{number:126,subnumber:1,group:"Sound Effects",label:"Car Engine"},{number:126,subnumber:2,group:"Sound Effects",label:"Car Stop"},{number:126,subnumber:3,group:"Sound Effects",label:"Car Pass"},{number:126,subnumber:4,group:"Sound Effects",label:"Car Crash"},{number:126,subnumber:5,group:"Sound Effects",label:"Siren"},{number:126,subnumber:6,group:"Sound Effects",label:"Train"},{number:126,subnumber:7,group:"Sound Effects",label:"Jetplane"},{number:126,subnumber:8,group:"Sound Effects",label:"Starship"},{number:126,subnumber:9,group:"Sound Effects",label:"Burst Noise"},{number:127,subnumber:0,group:"Sound Effects",label:"Applause"},{number:127,subnumber:1,group:"Sound Effects",label:"Laughing"},{number:127,subnumber:2,group:"Sound Effects",label:"Screaming"},{number:127,subnumber:3,group:"Sound Effects",label:"Punch"},{number:127,subnumber:4,group:"Sound Effects",label:"Heart Beat"},{number:127,subnumber:5,group:"Sound Effects",label:"Footsteps"},{number:128,subnumber:0,group:"Sound Effects",label:"Gun Shot"},{number:128,subnumber:1,group:"Sound Effects",label:"Machine Gun"},{number:128,subnumber:2,group:"Sound Effects",label:"Lasergun"},{number:128,subnumber:3,group:"Sound Effects",label:"Explosion"}];for(const e of Ta)Uw.set(e.pitch,e),qw.set(e.label,e);for(const e of DI)TI.set(e.number,e);for(const e of FI){const t=`${e.number}-${e.subnumber}`;II.set(t,e)}var BI={value:()=>{}};function Hw(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ks(n)}function Ks(e){this._=e}function RI(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ks.prototype=Hw.prototype={constructor:Ks,on:function(e,t){var n=this._,r=RI(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=LI(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=P1(n[i],e.name,t);else if(t==null)for(i in n)n[i]=P1(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ks(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function LI(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function P1(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=BI,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var rh="http://www.w3.org/1999/xhtml";const x1={svg:"http://www.w3.org/2000/svg",xhtml:rh,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Yu(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),x1.hasOwnProperty(t)?{space:x1[t],local:e}:e}function OI(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===rh&&t.documentElement.namespaceURI===rh?t.createElement(e):t.createElementNS(n,e)}}function GI(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Vw(e){var t=Yu(e);return(t.local?GI:OI)(t)}function UI(){}function Bd(e){return e==null?UI:function(){return this.querySelector(e)}}function qI(e){typeof e!="function"&&(e=Bd(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=e.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new Mn(r,this._parents)}function Yw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function zI(){return[]}function Ww(e){return e==null?zI:function(){return this.querySelectorAll(e)}}function HI(e){return function(){var t=e.apply(this,arguments);return t==null?[]:Yw(t)}}function VI(e){typeof e=="function"?e=HI(e):e=Ww(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(r.push(e.call(l,l.__data__,u,a)),i.push(l));return new Mn(r,i)}function jw(e){return function(){return this.matches(e)}}function Xw(e){return function(t){return t.matches(e)}}var YI=Array.prototype.find;function WI(e){return function(){return YI.call(this.children,e)}}function jI(){return this.firstElementChild}function XI(e){return this.select(e==null?jI:WI(typeof e=="function"?e:Xw(e)))}var KI=Array.prototype.filter;function ZI(){return this.children}function QI(e){return function(){return KI.call(this.children,e)}}function JI(e){return this.selectAll(e==null?ZI:QI(typeof e=="function"?e:Xw(e)))}function ek(e){typeof e!="function"&&(e=jw(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new Mn(r,this._parents)}function Kw(e){return new Array(e.length)}function tk(){return new Mn(this._enter||this._groups.map(Kw),this._parents)}function ql(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ql.prototype={constructor:ql,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function nk(e){return function(){return e}}function rk(e,t,n,r,i,o){for(var a=0,s,l=t.length,u=o.length;a<u;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new ql(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function ik(e,t,n,r,i,o,a){var s,l,u=new Map,c=t.length,f=o.length,h=new Array(c),d;for(s=0;s<c;++s)(l=t[s])&&(h[s]=d=a.call(l,l.__data__,s,t)+"",u.has(d)?i[s]=l:u.set(d,l));for(s=0;s<f;++s)d=a.call(e,o[s],s,o)+"",(l=u.get(d))?(r[s]=l,l.__data__=o[s],u.delete(d)):n[s]=new ql(e,o[s]);for(s=0;s<c;++s)(l=t[s])&&u.get(h[s])===l&&(i[s]=l)}function ok(e){return e.__data__}function ak(e,t){if(!arguments.length)return Array.from(this,ok);var n=t?ik:rk,r=this._parents,i=this._groups;typeof e!="function"&&(e=nk(e));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],f=i[u],h=f.length,d=Yw(e.call(c,c&&c.__data__,u,r)),p=d.length,b=s[u]=new Array(p),y=a[u]=new Array(p),_=l[u]=new Array(h);n(c,f,b,y,_,d,t);for(var v=0,M=0,g,w;v<p;++v)if(g=b[v]){for(v>=M&&(M=v+1);!(w=y[M])&&++M<p;);g._next=w||null}}return a=new Mn(a,r),a._enter=s,a._exit=l,a}function sk(){return new Mn(this._exit||this._groups.map(Kw),this._parents)}function lk(e,t,n){var r=this.enter(),i=this,o=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(i=t(i)),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function uk(e){if(!(e instanceof Mn))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=t[s],u=n[s],c=l.length,f=a[s]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;s<r;++s)a[s]=t[s];return new Mn(a,this._parents)}function ck(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function fk(e){e||(e=hk);function t(f,h){return f&&h?e(f.__data__,h.__data__):!f-!h}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,l=i[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(t)}return new Mn(i,this._parents).order()}function hk(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function dk(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function mk(){return Array.from(this)}function pk(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function bk(){let e=0;for(const t of this)++e;return e}function gk(){return!this.node()}function yk(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function _k(e){return function(){this.removeAttribute(e)}}function vk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wk(e,t){return function(){this.setAttribute(e,t)}}function Mk(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Sk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ek(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ak(e,t){var n=Yu(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?vk:_k:typeof t=="function"?n.local?Ek:Sk:n.local?Mk:wk)(n,t))}function Zw(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ck(e){return function(){this.style.removeProperty(e)}}function Pk(e,t,n){return function(){this.style.setProperty(e,t,n)}}function xk(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Nk(e,t,n){return arguments.length>1?this.each((t==null?Ck:typeof t=="function"?xk:Pk)(e,t,n??"")):bo(this.node(),e)}function bo(e,t){return e.style.getPropertyValue(t)||Zw(e).getComputedStyle(e,null).getPropertyValue(t)}function Tk(e){return function(){delete this[e]}}function Ik(e,t){return function(){this[e]=t}}function kk(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function $k(e,t){return arguments.length>1?this.each((t==null?Tk:typeof t=="function"?kk:Ik)(e,t)):this.node()[e]}function Qw(e){return e.trim().split(/^|\s+/)}function Rd(e){return e.classList||new Jw(e)}function Jw(e){this._node=e,this._names=Qw(e.getAttribute("class")||"")}Jw.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function e3(e,t){for(var n=Rd(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function t3(e,t){for(var n=Rd(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Dk(e){return function(){e3(this,e)}}function Fk(e){return function(){t3(this,e)}}function Bk(e,t){return function(){(t.apply(this,arguments)?e3:t3)(this,e)}}function Rk(e,t){var n=Qw(e+"");if(arguments.length<2){for(var r=Rd(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Bk:t?Dk:Fk)(n,t))}function Lk(){this.textContent=""}function Ok(e){return function(){this.textContent=e}}function Gk(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Uk(e){return arguments.length?this.each(e==null?Lk:(typeof e=="function"?Gk:Ok)(e)):this.node().textContent}function qk(){this.innerHTML=""}function zk(e){return function(){this.innerHTML=e}}function Hk(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Vk(e){return arguments.length?this.each(e==null?qk:(typeof e=="function"?Hk:zk)(e)):this.node().innerHTML}function Yk(){this.nextSibling&&this.parentNode.appendChild(this)}function Wk(){return this.each(Yk)}function jk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Xk(){return this.each(jk)}function Kk(e){var t=typeof e=="function"?e:Vw(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Zk(){return null}function Qk(e,t){var n=typeof e=="function"?e:Vw(e),r=t==null?Zk:typeof t=="function"?t:Bd(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Jk(){var e=this.parentNode;e&&e.removeChild(this)}function e$(){return this.each(Jk)}function t$(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function n$(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function r$(e){return this.select(e?n$:t$)}function i$(e){return arguments.length?this.property("__data__",e):this.node().__data__}function o$(e){return function(t){e.call(this,t,this.__data__)}}function a$(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function s$(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function l$(e,t,n){return function(){var r=this.__on,i,o=o$(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function u$(e,t,n){var r=a$(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=t?l$:s$,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function n3(e,t,n){var r=Zw(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function c$(e,t){return function(){return n3(this,e,t)}}function f$(e,t){return function(){return n3(this,e,t.apply(this,arguments))}}function h$(e,t){return this.each((typeof t=="function"?f$:c$)(e,t))}function*d$(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var m$=[null];function Mn(e,t){this._groups=e,this._parents=t}function ps(){return new Mn([[document.documentElement]],m$)}function p$(){return this}Mn.prototype=ps.prototype={constructor:Mn,select:qI,selectAll:VI,selectChild:XI,selectChildren:JI,filter:ek,data:ak,enter:tk,exit:sk,join:lk,merge:uk,selection:p$,order:ck,sort:fk,call:dk,nodes:mk,node:pk,size:bk,empty:gk,each:yk,attr:Ak,style:Nk,property:$k,classed:Rk,text:Uk,html:Vk,raise:Wk,lower:Xk,append:Kk,insert:Qk,remove:e$,clone:r$,datum:i$,on:u$,dispatch:h$,[Symbol.iterator]:d$};function Ld(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function r3(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function bs(){}var Ia=.7,zl=1/Ia,Yi="\\s*([+-]?\\d+)\\s*",ka="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Qn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",b$=/^#([0-9a-f]{3,8})$/,g$=new RegExp("^rgb\\("+[Yi,Yi,Yi]+"\\)$"),y$=new RegExp("^rgb\\("+[Qn,Qn,Qn]+"\\)$"),_$=new RegExp("^rgba\\("+[Yi,Yi,Yi,ka]+"\\)$"),v$=new RegExp("^rgba\\("+[Qn,Qn,Qn,ka]+"\\)$"),w$=new RegExp("^hsl\\("+[ka,Qn,Qn]+"\\)$"),M$=new RegExp("^hsla\\("+[ka,Qn,Qn,ka]+"\\)$"),N1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ld(bs,go,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:T1,formatHex:T1,formatHsl:S$,formatRgb:I1,toString:I1});function T1(){return this.rgb().formatHex()}function S$(){return i3(this).formatHsl()}function I1(){return this.rgb().formatRgb()}function go(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=b$.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?k1(t):n===3?new en(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ls(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ls(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=g$.exec(e))?new en(t[1],t[2],t[3],1):(t=y$.exec(e))?new en(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_$.exec(e))?Ls(t[1],t[2],t[3],t[4]):(t=v$.exec(e))?Ls(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=w$.exec(e))?F1(t[1],t[2]/100,t[3]/100,1):(t=M$.exec(e))?F1(t[1],t[2]/100,t[3]/100,t[4]):N1.hasOwnProperty(e)?k1(N1[e]):e==="transparent"?new en(NaN,NaN,NaN,0):null}function k1(e){return new en(e>>16&255,e>>8&255,e&255,1)}function Ls(e,t,n,r){return r<=0&&(e=t=n=NaN),new en(e,t,n,r)}function E$(e){return e instanceof bs||(e=go(e)),e?(e=e.rgb(),new en(e.r,e.g,e.b,e.opacity)):new en}function ih(e,t,n,r){return arguments.length===1?E$(e):new en(e,t,n,r??1)}function en(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ld(en,ih,r3(bs,{brighter:function(e){return e=e==null?zl:Math.pow(zl,e),new en(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ia:Math.pow(Ia,e),new en(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$1,formatHex:$1,formatRgb:D1,toString:D1}));function $1(){return"#"+Uc(this.r)+Uc(this.g)+Uc(this.b)}function D1(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Uc(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function F1(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new jn(e,t,n,r)}function i3(e){if(e instanceof jn)return new jn(e.h,e.s,e.l,e.opacity);if(e instanceof bs||(e=go(e)),!e)return new jn;if(e instanceof jn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new jn(a,s,l,e.opacity)}function o3(e,t,n,r){return arguments.length===1?i3(e):new jn(e,t,n,r??1)}function jn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ld(jn,o3,r3(bs,{brighter:function(e){return e=e==null?zl:Math.pow(zl,e),new jn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ia:Math.pow(Ia,e),new jn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new en(qc(e>=240?e-240:e+120,i,r),qc(e,i,r),qc(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function qc(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const a3=e=>()=>e;function A$(e,t){return function(n){return e+n*t}}function C$(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function P$(e){return(e=+e)==1?s3:function(t,n){return n-t?C$(t,n,e):a3(isNaN(t)?n:t)}}function s3(e,t){var n=t-e;return n?A$(e,n):a3(isNaN(e)?t:e)}const oh=function e(t){var n=P$(t);function r(i,o){var a=n((i=ih(i)).r,(o=ih(o)).r),s=n(i.g,o.g),l=n(i.b,o.b),u=s3(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function Tr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ah=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zc=new RegExp(ah.source,"g");function x$(e){return function(){return e}}function N$(e){return function(t){return e(t)+""}}function T$(e,t){var n=ah.lastIndex=zc.lastIndex=0,r,i,o,a=-1,s=[],l=[];for(e=e+"",t=t+"";(r=ah.exec(e))&&(i=zc.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:Tr(r,i)})),n=zc.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?N$(l[0].x):x$(t):(t=l.length,function(u){for(var c=0,f;c<t;++c)s[(f=l[c]).i]=f.x(u);return s.join("")})}var B1=180/Math.PI,sh={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function l3(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*B1,skewX:Math.atan(l)*B1,scaleX:a,scaleY:s}}var Os;function I$(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?sh:l3(t.a,t.b,t.c,t.d,t.e,t.f)}function k$(e){return e==null||(Os||(Os=document.createElementNS("http://www.w3.org/2000/svg","g")),Os.setAttribute("transform",e),!(e=Os.transform.baseVal.consolidate()))?sh:(e=e.matrix,l3(e.a,e.b,e.c,e.d,e.e,e.f))}function u3(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,f,h,d,p){if(u!==f||c!==h){var b=d.push("translate(",null,t,null,n);p.push({i:b-4,x:Tr(u,f)},{i:b-2,x:Tr(c,h)})}else(f||h)&&d.push("translate("+f+t+h+n)}function a(u,c,f,h){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),h.push({i:f.push(i(f)+"rotate(",null,r)-2,x:Tr(u,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(u,c,f,h){u!==c?h.push({i:f.push(i(f)+"skewX(",null,r)-2,x:Tr(u,c)}):c&&f.push(i(f)+"skewX("+c+r)}function l(u,c,f,h,d,p){if(u!==f||c!==h){var b=d.push(i(d)+"scale(",null,",",null,")");p.push({i:b-4,x:Tr(u,f)},{i:b-2,x:Tr(c,h)})}else(f!==1||h!==1)&&d.push(i(d)+"scale("+f+","+h+")")}return function(u,c){var f=[],h=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,f,h),a(u.rotate,c.rotate,f,h),s(u.skewX,c.skewX,f,h),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,f,h),u=c=null,function(d){for(var p=-1,b=h.length,y;++p<b;)f[(y=h[p]).i]=y.x(d);return f.join("")}}}var $$=u3(I$,"px, ","px)","deg)"),D$=u3(k$,", ",")",")"),yo=0,Ko=0,Go=0,c3=1e3,Hl,Zo,Vl=0,gi=0,Wu=0,$a=typeof performance=="object"&&performance.now?performance:Date,f3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Od(){return gi||(f3(F$),gi=$a.now()+Wu)}function F$(){gi=0}function Yl(){this._call=this._time=this._next=null}Yl.prototype=h3.prototype={constructor:Yl,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Od():+n)+(t==null?0:+t),!this._next&&Zo!==this&&(Zo?Zo._next=this:Hl=this,Zo=this),this._call=e,this._time=n,lh()},stop:function(){this._call&&(this._call=null,this._time=1/0,lh())}};function h3(e,t,n){var r=new Yl;return r.restart(e,t,n),r}function B$(){Od(),++yo;for(var e=Hl,t;e;)(t=gi-e._time)>=0&&e._call.call(null,t),e=e._next;--yo}function R1(){gi=(Vl=$a.now())+Wu,yo=Ko=0;try{B$()}finally{yo=0,L$(),gi=0}}function R$(){var e=$a.now(),t=e-Vl;t>c3&&(Wu-=t,Vl=e)}function L$(){for(var e,t=Hl,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Hl=n);Zo=e,lh(r)}function lh(e){if(!yo){Ko&&(Ko=clearTimeout(Ko));var t=e-gi;t>24?(e<1/0&&(Ko=setTimeout(R1,e-$a.now()-Wu)),Go&&(Go=clearInterval(Go))):(Go||(Vl=$a.now(),Go=setInterval(R$,c3)),yo=1,f3(R1))}}function L1(e,t,n){var r=new Yl;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var O$=Hw("start","end","cancel","interrupt"),G$=[],d3=0,O1=1,uh=2,Zs=3,G1=4,ch=5,Qs=6;function ju(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;U$(e,n,{name:t,index:r,group:i,on:O$,tween:G$,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:d3})}function Gd(e,t){var n=qn(e,t);if(n.state>d3)throw new Error("too late; already scheduled");return n}function ir(e,t){var n=qn(e,t);if(n.state>Zs)throw new Error("too late; already running");return n}function qn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function U$(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=h3(o,0,n.time);function o(u){n.state=O1,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,f,h,d;if(n.state!==O1)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Zs)return L1(a);d.state===G1?(d.state=Qs,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[c]):+c<t&&(d.state=Qs,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[c])}if(L1(function(){n.state===Zs&&(n.state=G1,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=uh,n.on.call("start",e,e.__data__,n.index,n.group),n.state===uh){for(n.state=Zs,i=new Array(h=n.tween.length),c=0,f=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=d);i.length=f+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=ch,1),f=-1,h=i.length;++f<h;)i[f].call(e,c);n.state===ch&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Qs,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function q$(e,t){var n=e.__transition,r,i,o=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>uh&&r.state<ch,r.state=Qs,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function z$(e){return this.each(function(){q$(this,e)})}function H$(e,t){var n,r;return function(){var i=ir(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function V$(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=ir(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function Y$(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=qn(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?H$:V$)(n,e,t))}function Ud(e,t,n){var r=e._id;return e.each(function(){var i=ir(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return qn(i,r).value[t]}}function m3(e,t){var n;return(typeof t=="number"?Tr:t instanceof go?oh:(n=go(t))?(t=n,oh):T$)(e,t)}function W$(e){return function(){this.removeAttribute(e)}}function j$(e){return function(){this.removeAttributeNS(e.space,e.local)}}function X$(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function K$(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function Z$(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function Q$(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function J$(e,t){var n=Yu(e),r=n==="transform"?D$:m3;return this.attrTween(e,typeof t=="function"?(n.local?Q$:Z$)(n,r,Ud(this,"attr."+e,t)):t==null?(n.local?j$:W$)(n):(n.local?K$:X$)(n,r,t))}function eD(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function tD(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function nD(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&tD(e,o)),n}return i._value=t,i}function rD(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&eD(e,o)),n}return i._value=t,i}function iD(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Yu(e);return this.tween(n,(r.local?nD:rD)(r,t))}function oD(e,t){return function(){Gd(this,e).delay=+t.apply(this,arguments)}}function aD(e,t){return t=+t,function(){Gd(this,e).delay=t}}function sD(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?oD:aD)(t,e)):qn(this.node(),t).delay}function lD(e,t){return function(){ir(this,e).duration=+t.apply(this,arguments)}}function uD(e,t){return t=+t,function(){ir(this,e).duration=t}}function cD(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?lD:uD)(t,e)):qn(this.node(),t).duration}function fD(e,t){if(typeof t!="function")throw new Error;return function(){ir(this,e).ease=t}}function hD(e){var t=this._id;return arguments.length?this.each(fD(t,e)):qn(this.node(),t).ease}function dD(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ir(this,e).ease=n}}function mD(e){if(typeof e!="function")throw new Error;return this.each(dD(this._id,e))}function pD(e){typeof e!="function"&&(e=jw(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new Mr(r,this._parents,this._name,this._id)}function bD(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=t[s],u=n[s],c=l.length,f=a[s]=new Array(c),h,d=0;d<c;++d)(h=l[d]||u[d])&&(f[d]=h);for(;s<r;++s)a[s]=t[s];return new Mr(a,this._parents,this._name,this._id)}function gD(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function yD(e,t,n){var r,i,o=gD(t)?Gd:ir;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function _D(e,t){var n=this._id;return arguments.length<2?qn(this.node(),n).on.on(e):this.each(yD(n,e,t))}function vD(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function wD(){return this.on("end.remove",vD(this._id))}function MD(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Bd(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],l=s.length,u=o[a]=new Array(l),c,f,h=0;h<l;++h)(c=s[h])&&(f=e.call(c,c.__data__,h,s))&&("__data__"in c&&(f.__data__=c.__data__),u[h]=f,ju(u[h],t,n,h,u,qn(c,n)));return new Mr(o,this._parents,t,n)}function SD(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ww(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,f=0;f<u;++f)if(c=l[f]){for(var h=e.call(c,c.__data__,f,l),d,p=qn(c,n),b=0,y=h.length;b<y;++b)(d=h[b])&&ju(d,t,n,b,h,p);o.push(h),a.push(c)}return new Mr(o,a,t,n)}var ED=ps.prototype.constructor;function AD(){return new ED(this._groups,this._parents)}function CD(e,t){var n,r,i;return function(){var o=bo(this,e),a=(this.style.removeProperty(e),bo(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function p3(e){return function(){this.style.removeProperty(e)}}function PD(e,t,n){var r,i=n+"",o;return function(){var a=bo(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function xD(e,t,n){var r,i,o;return function(){var a=bo(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),bo(this,e))),a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s))}}function ND(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var l=ir(this,e),u=l.on,c=l.value[o]==null?s||(s=p3(t)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(a,i=c),l.on=r}}function TD(e,t,n){var r=(e+="")=="transform"?$$:m3;return t==null?this.styleTween(e,CD(e,r)).on("end.style."+e,p3(e)):typeof t=="function"?this.styleTween(e,xD(e,r,Ud(this,"style."+e,t))).each(ND(this._id,e)):this.styleTween(e,PD(e,r,t),n).on("end.style."+e,null)}function ID(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function kD(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&ID(e,a,n)),r}return o._value=t,o}function $D(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,kD(e,t,n??""))}function DD(e){return function(){this.textContent=e}}function FD(e){return function(){var t=e(this);this.textContent=t??""}}function BD(e){return this.tween("text",typeof e=="function"?FD(Ud(this,"text",e)):DD(e==null?"":e+""))}function RD(e){return function(t){this.textContent=e.call(this,t)}}function LD(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&RD(i)),t}return r._value=e,r}function OD(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,LD(e))}function GD(){for(var e=this._name,t=this._id,n=b3(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=qn(l,t);ju(l,e,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Mr(r,this._parents,e,n)}function UD(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--i===0&&o()}};n.each(function(){var u=ir(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),u.on=t}),i===0&&o()})}var qD=0;function Mr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function b3(){return++qD}var Qr=ps.prototype;Mr.prototype={constructor:Mr,select:MD,selectAll:SD,filter:pD,merge:bD,selection:AD,transition:GD,call:Qr.call,nodes:Qr.nodes,node:Qr.node,size:Qr.size,empty:Qr.empty,each:Qr.each,on:_D,attr:J$,attrTween:iD,style:TD,styleTween:$D,text:BD,textTween:OD,remove:wD,tween:Y$,delay:sD,duration:cD,ease:hD,easeVarying:mD,end:UD,[Symbol.iterator]:Qr[Symbol.iterator]};function zD(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var HD={time:null,delay:0,duration:250,ease:zD};function VD(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function YD(e){var t,n;e instanceof Mr?(t=e._id,e=e._name):(t=b3(),(n=HD).time=Od(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&ju(l,e,t,u,a,n||VD(l,t));return new Mr(r,this._parents,e,t)}ps.prototype.interrupt=z$;ps.prototype.transition=YD;function Qo(e,t,n){this.k=e,this.x=t,this.y=n}Qo.prototype={constructor:Qo,scale:function(e){return e===1?this:new Qo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Qo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Qo.prototype;var WD={exports:{}};(function(e){(function(){const t=function(r){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;if(r=r.replace(/^.*?base64,/,""),r=String(r).replace(/[\t\n\f\r ]+/g,""),!o.test(r))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");r+="==".slice(2-(r.length&3));let a,s="",l,u,c=0;for(;c<r.length;)a=i.indexOf(r.charAt(c++))<<18|i.indexOf(r.charAt(c++))<<12|(l=i.indexOf(r.charAt(c++)))<<6|(u=i.indexOf(r.charAt(c++))),s+=l===64?String.fromCharCode(a>>16&255):u===64?String.fromCharCode(a>>16&255,a>>8&255):String.fromCharCode(a>>16&255,a>>8&255,a&255);return s},n={debug:!1,parse:function(r,i){if(r instanceof Uint8Array)return n.Uint8(r);if(typeof r=="string")return n.Base64(r);if(r instanceof HTMLElement&&r.type==="file")return n.addListener(r,i);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(r,i){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(r===void 0||!(r instanceof HTMLElement)||r.tagName!=="INPUT"||r.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;i=i||function(){},r.addEventListener("change",function(o){if(!o.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let a=new FileReader;a.readAsArrayBuffer(o.target.files[0]),a.onload=function(s){i(n.Uint8(new Uint8Array(s.target.result)))}})},Base64:function(r){r=String(r);let i=t(r),o=i.length,a=new Uint8Array(new ArrayBuffer(o));for(let s=0;s<o;s++)a[s]=i.charCodeAt(s);return n.Uint8(a)},Uint8:function(r){let i={data:null,pointer:0,movePointer:function(l){return this.pointer+=l,this.pointer},readInt:function(l){if(l=Math.min(l,this.data.byteLength-this.pointer),l<1)return-1;let u=0;if(l>1)for(let c=1;c<=l-1;c++)u+=this.data.getUint8(this.pointer)*Math.pow(256,l-c),this.pointer++;return u+=this.data.getUint8(this.pointer),this.pointer++,u},readStr:function(l){let u="";for(let c=1;c<=l;c++)u+=String.fromCharCode(this.readInt(1));return u},readIntVLV:function(){let l=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)l=this.readInt(1);else{let u=[];for(;this.data.getUint8(this.pointer)>=128;)u.push(this.readInt(1)-128);let c=this.readInt(1);for(let f=1;f<=u.length;f++)l+=u[u.length-f]*Math.pow(128,f);l+=c}return l}};if(i.data=new DataView(r.buffer,r.byteOffset,r.byteLength),i.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;i.readInt(4);let o={};o.formatType=i.readInt(2),o.tracks=i.readInt(2),o.track=[];let a=i.readInt(1),s=i.readInt(1);a>=128?(o.timeDivision=[],o.timeDivision[0]=a-128,o.timeDivision[1]=s):o.timeDivision=a*256+s;for(let l=1;l<=o.tracks;l++){o.track[l-1]={event:[]};let u=i.readInt(4);if(u===-1)break;if(u!==1297379947)return!1;i.readInt(4);let c=0,f=!1,h,d;for(;!f&&(c++,o.track[l-1].event[c-1]={},o.track[l-1].event[c-1].deltaTime=i.readIntVLV(),h=i.readInt(1),h!==-1);)if(h>=128?d=h:(h=d,i.movePointer(-1)),h===255){o.track[l-1].event[c-1].type=255,o.track[l-1].event[c-1].metaType=i.readInt(1);let p=i.readIntVLV();switch(o.track[l-1].event[c-1].metaType){case 47:case-1:f=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:o.track[l-1].event[c-1].data=i.readStr(p);break;case 33:case 89:case 81:o.track[l-1].event[c-1].data=i.readInt(p);break;case 84:o.track[l-1].event[c-1].data=[],o.track[l-1].event[c-1].data[0]=i.readInt(1),o.track[l-1].event[c-1].data[1]=i.readInt(1),o.track[l-1].event[c-1].data[2]=i.readInt(1),o.track[l-1].event[c-1].data[3]=i.readInt(1),o.track[l-1].event[c-1].data[4]=i.readInt(1);break;case 88:o.track[l-1].event[c-1].data=[],o.track[l-1].event[c-1].data[0]=i.readInt(1),o.track[l-1].event[c-1].data[1]=i.readInt(1),o.track[l-1].event[c-1].data[2]=i.readInt(1),o.track[l-1].event[c-1].data[3]=i.readInt(1);break;default:this.customInterpreter!==null&&(o.track[l-1].event[c-1].data=this.customInterpreter(o.track[l-1].event[c-1].metaType,i,p)),(this.customInterpreter===null||o.track[l-1].event[c-1].data===!1)&&(i.readInt(p),o.track[l-1].event[c-1].data=i.readInt(p),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch(h=h.toString(16).split(""),h[1]||h.unshift("0"),o.track[l-1].event[c-1].type=parseInt(h[0],16),o.track[l-1].event[c-1].channel=parseInt(h[1],16),o.track[l-1].event[c-1].type){case 15:{if(this.customInterpreter!==null&&(o.track[l-1].event[c-1].data=this.customInterpreter(o.track[l-1].event[c-1].type,i,!1)),this.customInterpreter===null||o.track[l-1].event[c-1].data===!1){let p=i.readIntVLV();o.track[l-1].event[c-1].data=i.readInt(p),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer")}break}case 10:case 11:case 14:case 8:case 9:o.track[l-1].event[c-1].data=[],o.track[l-1].event[c-1].data[0]=i.readInt(1),o.track[l-1].event[c-1].data[1]=i.readInt(1);break;case 12:case 13:o.track[l-1].event[c-1].data=i.readInt(1);break;case-1:f=!0;break;default:if(this.customInterpreter!==null&&(o.track[l-1].event[c-1].data=this.customInterpreter(o.track[l-1].event[c-1].metaType,i,!1)),this.customInterpreter===null||o.track[l-1].event[c-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return o},customInterpreter:null};e.exports=n})()})(WD);function Lt(e){return 1/(e/60)}const g3=[],jD=[2,1,1/2,1/4,1/8,1/16,1/32,1/64];for(const e of jD)for(let t=0;t<4;t++){let n=e,r=e;for(let i=0;i<t;i++)r/=2,n+=r;g3.push({type:e,dots:t,duration:n})}g3.sort((e,t)=>e.duration-t.duration);function fh(e,t,n,r){e.beginPath(),e.arc(t,n,r,0,2*Math.PI),e.stroke()}class Te{constructor(t,n){this.name=t,this.notes=n,this.short=n.join(" "),this.pitches=n.map(r=>zw(r).pitch),this.stringCount=n.length}}const XD=new Map([["Guitar",new Map([[6,[new Te("E stand.",["E2","A2","D3","G3","B3","E4"]),new Te("Drop D",["D2","A2","D3","G3","B3","E4"]),new Te("Drop C",["C2","G2","C3","F3","A3","D4"]),new Te("1/2 down",["D#2","G#2","C#3","F#3","A#3","D#4"]),new Te("1 down",["D2","G2","C3","F3","A3","D4"]),new Te("1 1/2 down",["C#2","F#2","B2","E3","G#3","C#4"]),new Te("2 down",["C2","F2","A#2","D#3","G3","C4"]),new Te("DADGAG",["D2","A2","D3","G3","A3","D4"])]],[7,[new Te("B stand.",["B1","E2","A2","D3","G3","B3","E4"]),new Te("Drop A",["A1","E2","A2","D3","G3","B3","E4"]),new Te("1/2 down",["A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new Te("1 down",["A1","D2","G2","C3","F3","A3","D4"]),new Te("1 1/2 down",["G#1","C#2","F#2","B2","E3","G#3","C#4"]),new Te("2 down",["G1","C2","F2","A#2","D#3","G3","C4"])]],[8,[new Te("F# stand.",["F#1","B1","E2","A2","D3","G3","B3","E4"]),new Te("Drop E",["E1","B1","E2","A2","D3","G3","B3","E4"]),new Te("1/2 down",["F1","A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new Te("1 down",["E1","A1","D2","G2","C3","F3","A3","D4"]),new Te("1 1/2 down",["D#1","G#1","C#2","F#2","B2","E3","G#3","C#4"]),new Te("2 down",["D1","G1","C2","F2","A#2","D#3","G3","C4"])]]])],["Bass",new Map([[4,[new Te("E stand.",["E1","A1","D2","G2"]),new Te("Drop D",["D1","A1","D2","G2"]),new Te("1/2 down",["D#1","G#1","C#2","F#2"]),new Te("1 down",["D1","G1","C2","F2"]),new Te("1 1/2 down",["C#1","F#1","B1","E2"]),new Te("2 down",["C1","F1","A#1","D#2"])]],[5,[new Te("B stand.",["B0","E1","A1","D2","G2"]),new Te("Drop A",["A0","D1","A1","D2","G2"]),new Te("1/2 down",["A#0","D#1","G#1","C#2","F#2"]),new Te("1 down",["A0","D1","G1","C2","F2"]),new Te("1 1/2 down",["G#0","C#1","F#1","B1","E2"]),new Te("2 down",["G0","C1","F1","A#1","D#2"])]],[6,[new Te("F# stand.",["F#0","B0","E1","A1","D2","G2"]),new Te("Drop E",["E0","A0","D1","A1","D2","G2"]),new Te("1/2 down",["F0","A#0","D#1","G#1","C#2","F#2"]),new Te("1 down",["E1","A0","D1","G1","C2","F2"]),new Te("1 1/2 down",["D#0","G#0","C#1","F#1","B1","E2"]),new Te("2 down",["D0","G0","C1","F1","A#1","D#2"])]]])],["Ukulele",new Map([[4,[new Te("Hawaii",["G4","C4","E4","A4"]),new Te("Low G",["G3","C4","E4","A4"]),new Te("D-tuning",["A4","D4","F#4","B4"]),new Te("Canadian",["A3","D4","F#4","B4"]),new Te("Bariton",["D3","G3","B3","E4"])]]])]]);class xr{constructor(t,n){this.name=t,this.notes=n,this.short=n.join(" "),this.pitches=n.map(r=>zw(r).pitch),this.pitchesSorted=[...this.pitches].sort((r,i)=>r-i),this.keyCount=n.length}getNumbers(){const t=this.pitchesSorted,n=new Map;for(const[r,i]of t.entries()){let o=r+1,a="",s=i-12;for(;s>0&&n.has(s);)o=n.get(s).number,a+="",s-=12;n.set(i,{number:o,numberString:`${o}${a}`})}return[...n.values()].map(r=>r.numberString)}getLetters(){const t=this.pitchesSorted,n=new Map;for(const[r,i]of t.entries()){let o=r+1,a="",s=i-12;for(;s>0&&n.has(s);)o=n.get(s).number,a+="",s-=12;const l=kI(i).name;n.set(i,{number:o,letterString:`${l}${a}`})}return[...n.values()].map(r=>r.letterString)}}new xr("9 A Major",["A5","C#6","C#5","A5","A4","F#5","E5","E6","B5"]),new xr("9 A Minor",["A5","C6","C5","A5","A4","F5","E5","E6","B5"]),new xr("9 A Minor 7",["A5","C6","C5","A5","A4","F#5","E5","E6","B5"]),new xr("9 A Ake Bono",["A5","D6","D5","A5","A4","F5","E5","E6","A#5"]),new xr("9 A Hijaz",["G5","D6","D5","A5","A4","F#5","D#5","D#6","A#5"]),new xr("9 A Pygmy",["G5","C6","C5","G5","G4","D#5","D5","D#6","A#5"]),new xr("17 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","C4","E4","G4","B4","D5","F5","A5","C6","E6"]),new xr("21 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","B3","G3","F3","A3","C4","E4","G4","B4","D5","F5","A5","C6","E6"]);function KD(e){const{r:t,g:n,b:r}=go(e).rgb();return(t+t+t+r+n+n+n+n>>3)/2.55}function ZD(e,t=1){const n=o3(e);return n.s=t,n.toString()}const QD=["#ff0000","#ff4e00","#db7b00","#ffcc00","#e4ed00","#81d700","#00ffb4","#00ffea","#00baff","#3c00ff","#a800ff","#ff00fd"].map(e=>ZD(e,.5)),JD=["#6699ff","#66ffff","#000000","#647878","#993366","#ff0000","#ffcc99","#ffff01","#ff9900","#009900","#66ff99","#0000cc"],eF=["#9aebff","#add5ff","#d6d6ff","#ebd5ff","#ffc2eb","#ffcbcc","#ffd5c2","#ffebc2","#ebffc2","#c2d599","#99ebbe","#adebeb"],tF=["#FA0B0C","#FA0B0C","#F88010","#F88010","#F5F43C","#149033","#149033","#FA0B0C","#FA0B0C","#7F087C","#7F087C","#908791"],nF=["#1C0D82","#F5F5F5","#149033","#709226","#F5F43C","#F5D23B","#F88010","#FA0B0C","#A00C09","#D71386","#4B0E7D","#7F087C"],rF=["#1C0D82","#1C0D82","#7F087C","#7F087C","#FA0B0C","#F88010","#F88010","#F5F43C","#F5F43C","#709226","#709226","#149033"],iF=["#FA0B0C","#F44712","#F88010","#F5D23B","#F5F43C","#149033","#1B9081","#1C0D82","#4B0E7D","#7F087C","#A61586","#D71386"],oF=["#6A1C1C","#FA0B0C","#F88010","#F5D23B","#F5F43C","#709226","#1B9081","#1C0D82","#7F087C","#D71386","#6A1C1C","#070707"],aF=["#FA0B0C","#A00C09","#F44712","#F88010","#F5F43C","#709226","#149033","#27A481","#1B9081","#7F087C","#1C0D82","#D71386"],sF=["#FA0B0C","#A00C09","#F88010","#F6D111","#F5F43C","#BCE039","#149033","#27A481","#7F087C","#D71386","#D91951","#FA0B0C"],lF=["#F5F43C","#149033","#1B9081","#1C5BA0","#7F087C","#D71386","#9D0E55","#FA0B0C","#D32C0A","#D32C0A","#F62E0D","#F17A0F"],uF=["#FA0B0C","#D71386","#F5F43C","#5A5685","#1C5BA0","#A00C09","#1C0D82","#F88010","#7F087C","#149033","#5A5685","#1C5BA0"],cF=["#C40A09","#FA0B0C","#F44712","#F88010","#F5F43C","#BCE039","#149033","#1B9081","#1C0D82","#781887","#D71386","#9D0E55"],fF=["#FA0B0C","#FA0B0C","#F88010","#F88010","#F5F43C","#F5F43C","#149033","#1B9081","#1B9081","#1C5BA0","#4B0E7D","#7F087C"],hF=["#FA0B0C","#F44712","#F88010","#F6D111","#F5F43C","#BCE039","#149033","#1B9081","#1C0D82","#A61586","#D71386","#AD0E48"],dF=["#BCE039","#149033","#1B9081","#1C0D82","#7F087C","#D71386","#6F0D45","#A00C09","#FA0B0C","#F88010","#EDF087","#F5F43C"],mF=oh("black","steelblue");Array.from({length:12}).map((e,t)=>mF(t/11));function pF(e,t,n){const r=e.slice();return r[18]=t[n],r}function bF(e){let t;return{c(){t=C("option"),t.textContent=`${e[18]}`,t.__value=e[18],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function gF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N=Pe(["velocity","piano","channel","none"]),x=[];for(let T=0;T<4;T+=1)x[T]=bF(pF(e,N,T));return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`The guitar tab below shows incoming MIDI notes as rectangles with their
        string (y position) and start and end times (x left and right side of
        the rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,s=O(),l=C("div"),u=C("label"),c=q(`color
            `),f=C("select");for(let T=0;T<4;T+=1)x[T].c();h=O(),d=C("label"),p=q(`time
            `),b=C("input"),y=O(),_=C("div"),v=O(),M=C("div"),g=C("button"),g.textContent="reset",k(a,"class","explanation"),e[3]===void 0&&at(()=>e[7].call(f)),k(b,"type","number"),k(b,"min","10"),k(b,"max","300"),k(b,"step","10"),k(d,"title","time in seconds for past notes to be shown"),k(l,"class","control"),k(_,"class","visualization"),k(g,"title","Clear all played notes"),k(M,"class","control"),k(t,"class","demo")},m(T,S){fe(T,t,S),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f);for(let P=0;P<4;P+=1)x[P]&&x[P].m(f,null);$e(f,e[3],!0),m(l,h),m(l,d),m(d,p),m(d,b),be(b,e[2]),m(t,y),m(t,_),e[9](_),m(t,v),m(t,M),m(M,g),w||(E=[ne(f,"change",e[7]),ne(b,"input",e[8]),ne(g,"click",e[10])],w=!0)},p(T,[S]){S&1&&r!==(r=T[0].title+"")&&he(i,r),S&8&&$e(f,T[3]),S&4&&Ne(b.value)!==T[2]&&be(b,T[2])},i:ge,o:ge,d(T){T&&ce(t),Ue(x,T),e[9](null),w=!1,Ve(E)}}}let yF=1e3,_F=500,vF=6;function wF(e,t,n){let{toolInfo:r}=t,i=[64,59,55,50,45,40],o,a=30,s="velocity",l=0,u=[],c=new Map,f=null;const h=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((g,w)=>{console.log(`MIDI device ${w}: ${g.name}`),g.addListener("noteon",d),g.addListener("noteoff",p)}),[...W.inputs])},d=g=>{const w=(g.timestamp-l)/1e3,E=g.message.channel-1,N={number:g.note.number,velocity:g.rawVelocity,time:w,channel:g.message.channel,string:E,fret:g.note.number-i[E]};if(c.has(g.note.number)){const x=c.get(g.note.number);x.end===void 0&&(x.end=w)}u.push(N),c.set(g.note.number,N)},p=g=>{if(c.has(g.note.number)){const w=c.get(g.note.number),E=(g.timestamp-l)/1e3;w.end=E}},b=()=>{const g=(performance.now()-l)/1e3,w=g-a,E=u.filter(I=>I.end>w||I.end===void 0),N=Yt(E,I=>I.number),x=i.map(Ut.fromMidiSharps);let T,S;s==="velocity"?(T={label:"Note velocity",scheme:"blues",domain:[0,127]},S="velocity"):s==="piano"?(T={label:"Piano key color",domain:["black","white"],range:["black","white"]},S=I=>la(I.number)?"black":"white"):s==="channel"?(T={type:"categorical",label:"MIDI channel",scheme:"tableau10"},S=I=>I.channel):s==="none"&&(S="#ddd");const P=et({insetRight:10,width:yF,height:_F,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[w,g]},y:{label:"String",grid:!0,domain:Ce(0,vF),tickFormat:I=>x[I]},color:{...T,legend:s!=="none",marginLeft:100,width:300},marks:[Nt(Ce(Math.ceil((N[0]-1)/12)*12,N[1]+2,12)),$t([g],{stroke:"#888"}),ds(E,{clip:!0,x1:"time",x2:I=>I.end===void 0?g:Math.max(I.end,I.time+.025),y:"string",fill:S,stroke:"#ccc",rx:5}),wr(E,{clip:!0,x:"time",y:"string",fill:"black",stroke:"white",text:"fret",textAnchor:"start",dx:2})]});n(1,o.textContent="",o),o.appendChild(P),f=requestAnimationFrame(b)};st(()=>{W.enable().then(h).catch(g=>alert(g)),n(4,l=performance.now()),f=requestAnimationFrame(b)}),lt(()=>{for(const g of W.inputs)g.removeListener();cancelAnimationFrame(f)});function y(){s=pt(this),n(3,s)}function _(){a=Ne(this.value),n(2,a)}function v(g){xe[g?"unshift":"push"](()=>{o=g,n(1,o)})}const M=()=>{confirm("Reset played notes?")&&(n(5,u=[]),n(6,c=new Map),n(4,l=performance.now()))};return e.$$set=g=>{"toolInfo"in g&&n(0,r=g.toolInfo)},[r,o,a,s,l,u,c,y,_,v,M]}class MF extends He{constructor(t){super(),ze(this,t,wF,gF,qe,{toolInfo:0})}}function SF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b=e[3]?"":"",y,_,v,M,g=e[4]?"":"",w,E,N,x,T,S,P,I,$=e[1]>=6?"guitar":"bass guitar",D,A,F=e[2]===0?"in standard tuning":`${Math.abs(e[2])} ${e[2]<0?"steps down":"steps up"}`,L,X,U=e[3]?"and dropped":"",z,G,R,Y,re,Q,J,K,ee,j;return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("label"),s=q(`strings
        `),l=C("input"),u=O(),c=C("label"),f=q(`tune up/down (semitones)
        `),h=C("input"),d=O(),p=C("button"),y=q(b),_=q(" dropped"),v=O(),M=C("button"),w=q(g),E=q(" octave shown"),N=O(),x=C("div"),T=C("p"),S=q("You selected a "),P=q(e[1]),I=q(" string "),D=q($),A=q(", tuned "),L=q(F),X=O(),z=q(U),G=O(),R=C("p"),Y=q("Resulting tuning, low to high:"),re=C("br"),Q=O(),J=C("b"),K=q(e[5]),k(l,"type","number"),k(l,"min","4"),k(l,"max","8"),k(l,"step","1"),k(h,"type","number"),k(h,"min","-12"),k(h,"max","12"),k(h,"step","1")},m(V,te){fe(V,t,te),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,l),be(l,e[1]),m(t,u),m(t,c),m(c,f),m(c,h),be(h,e[2]),m(t,d),m(t,p),m(p,y),m(p,_),m(t,v),m(t,M),m(M,w),m(M,E),m(t,N),m(t,x),m(x,T),m(T,S),m(T,P),m(T,I),m(T,D),m(T,A),m(T,L),m(T,X),m(T,z),m(x,G),m(x,R),m(R,Y),m(R,re),m(R,Q),m(R,J),m(J,K),ee||(j=[ne(l,"input",e[6]),ne(h,"input",e[7]),ne(p,"click",e[8]),ne(M,"click",e[9])],ee=!0)},p(V,[te]){te&1&&r!==(r=V[0].title+"")&&he(i,r),te&2&&Ne(l.value)!==V[1]&&be(l,V[1]),te&4&&Ne(h.value)!==V[2]&&be(h,V[2]),te&8&&b!==(b=V[3]?"":"")&&he(y,b),te&16&&g!==(g=V[4]?"":"")&&he(w,g),te&2&&he(P,V[1]),te&2&&$!==($=V[1]>=6?"guitar":"bass guitar")&&he(D,$),te&4&&F!==(F=V[2]===0?"in standard tuning":`${Math.abs(V[2])} ${V[2]<0?"steps down":"steps up"}`)&&he(L,F),te&8&&U!==(U=V[3]?"and dropped":"")&&he(z,U),te&32&&he(K,V[5])},i:ge,o:ge,d(V){V&&ce(t),ee=!1,Ve(j)}}}function EF(e,t,n){let r,{toolInfo:i}=t,o=6,a=0,s=!1,l=!0;const u=(p,b,y,_)=>{let M=XD.get(p>5?"Guitar":"Bass").get(p)[0].pitches.map(g=>g+b);return y&&(M[0]-=2),_?M=M.map(g=>Ta[g].label):M=M.map(g=>Ta[g].name),M.join(" ")};function c(){o=Ne(this.value),n(1,o)}function f(){a=Ne(this.value),n(2,a)}const h=()=>{n(3,s=!s)},d=()=>{n(4,l=!l)};return e.$$set=p=>{"toolInfo"in p&&n(0,i=p.toolInfo)},e.$$.update=()=>{e.$$.dirty&30&&n(5,r=u(o,a,s,l))},[i,o,a,s,l,r,c,f,h,d]}class AF extends He{constructor(t){super(),ze(this,t,EF,SF,qe,{toolInfo:0})}}function U1(e,t,n){const r=e.slice();return r[6]=t[n],r}function q1(e){let t,n,r=e[6].timestamp.toFixed(1)+"",i,o,a,s=e[6].port.manufacturer+"",l,u,c,f=e[6].port.name+"",h,d,p,b=e[6].message.channel+"",y,_,v,M=e[6].message.command+"",g,w,E=e[6].message.type+"",N,x,T,S=e[6].message.dataBytes+"",P,I,$,D=(["noteon","noteoff"].includes(e[6].message.type)?Ut.fromMidiSharps(e[6].message.dataBytes[0]):"")+"",A,F,L,X=(["noteon","noteoff"].includes(e[6].message.type)?e[6].message.dataBytes[1]:"")+"",U,z;return{c(){t=C("tr"),n=C("td"),i=q(r),o=O(),a=C("td"),l=q(s),u=O(),c=C("td"),h=q(f),d=O(),p=C("td"),y=q(b),_=O(),v=C("td"),g=q(M),w=O(),N=q(E),x=O(),T=C("td"),P=q(S),I=O(),$=C("td"),A=q(D),F=O(),L=C("td"),U=q(X),z=O(),k(n,"class","svelte-1x83ix2"),k(a,"class","svelte-1x83ix2"),k(c,"class","svelte-1x83ix2"),k(p,"class","svelte-1x83ix2"),k(v,"class","svelte-1x83ix2"),k(T,"class","svelte-1x83ix2"),k($,"class","svelte-1x83ix2"),k(L,"class","svelte-1x83ix2"),k(t,"class","svelte-1x83ix2")},m(G,R){fe(G,t,R),m(t,n),m(n,i),m(t,o),m(t,a),m(a,l),m(t,u),m(t,c),m(c,h),m(t,d),m(t,p),m(p,y),m(t,_),m(t,v),m(v,g),m(v,w),m(v,N),m(t,x),m(t,T),m(T,P),m(t,I),m(t,$),m($,A),m(t,F),m(t,L),m(L,U),m(t,z)},p(G,R){R&2&&r!==(r=G[6].timestamp.toFixed(1)+"")&&he(i,r),R&2&&s!==(s=G[6].port.manufacturer+"")&&he(l,s),R&2&&f!==(f=G[6].port.name+"")&&he(h,f),R&2&&b!==(b=G[6].message.channel+"")&&he(y,b),R&2&&M!==(M=G[6].message.command+"")&&he(g,M),R&2&&E!==(E=G[6].message.type+"")&&he(N,E),R&2&&S!==(S=G[6].message.dataBytes+"")&&he(P,S),R&2&&D!==(D=(["noteon","noteoff"].includes(G[6].message.type)?Ut.fromMidiSharps(G[6].message.dataBytes[0]):"")+"")&&he(A,D),R&2&&X!==(X=(["noteon","noteoff"].includes(G[6].message.type)?G[6].message.dataBytes[1]:"")+"")&&he(U,X)},d(G){G&&ce(t)}}}function CF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d=e[1].length+"",p,b,y,_,v,M,g,w,E,N=Pe(e[1].slice(0,100)),x=[];for(let T=0;T<N.length;T+=1)x[T]=q1(U1(e,N,T));return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent="Input anything on a MIDI device to see the incoming messages below.",s=O(),l=C("div"),u=C("button"),u.textContent="reset",c=O(),f=C("div"),h=C("p"),p=q(d),b=q(" messages received"),y=O(),_=C("table"),v=C("thead"),v.innerHTML="<th>timestamp</th> <th>manufacturer</th> <th>name</th> <th>channel</th> <th>command</th> <th>data</th> <th>note</th> <th>velocity</th>",M=O(),g=C("tbody");for(let T=0;T<x.length;T+=1)x[T].c();k(a,"class","explanation"),k(u,"title","Clear all messages"),k(l,"class","control"),k(_,"class","svelte-1x83ix2"),k(f,"class","visualization"),k(t,"class","demo")},m(T,S){fe(T,t,S),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(t,c),m(t,f),m(f,h),m(h,p),m(h,b),m(f,y),m(f,_),m(_,v),m(_,M),m(_,g);for(let P=0;P<x.length;P+=1)x[P]&&x[P].m(g,null);w||(E=ne(u,"click",e[2]),w=!0)},p(T,[S]){if(S&1&&r!==(r=T[0].title+"")&&he(i,r),S&2&&d!==(d=T[1].length+"")&&he(p,d),S&2){N=Pe(T[1].slice(0,100));let P;for(P=0;P<N.length;P+=1){const I=U1(T,N,P);x[P]?x[P].p(I,S):(x[P]=q1(I),x[P].c(),x[P].m(g,null))}for(;P<x.length;P+=1)x[P].d(1);x.length=N.length}},i:ge,o:ge,d(T){T&&ce(t),Ue(x,T),w=!1,E()}}}function PF(e,t,n){let{toolInfo:r}=t,i=[];const o=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((s,l)=>{console.log(`MIDI device ${l}: ${s.name}`),s.addListener("midimessage",u=>{n(1,i=[u,...i]),console.log(u)})}),[...W.inputs])};st(()=>{W.enable().then(o).catch(s=>alert(s)),performance.now()}),lt(()=>{for(const s of W.inputs)s.removeListener()});const a=()=>{n(1,i=[])};return e.$$set=s=>{"toolInfo"in s&&n(0,r=s.toolInfo)},[r,i,a]}class xF extends He{constructor(t){super(),ze(this,t,PF,CF,qe,{toolInfo:0})}}const ua={noteColormap:QD,noteColormapAccessible:JD,noteColormapAccessible2:eF,newton:tF,castel:nF,field:rF,jameson:iF,seemann:oF,rimington:aF,bishop:sF,helmholtz:lF,scriabin:uF,klein:cF,aeppli:fF,belmont:hF,zieverink:dF};function z1(e,t,n){const r=e.slice();return r[2]=t[n],r}function H1(e,t,n){const r=e.slice();return r[5]=t[n],r[7]=n,r}function NF(e,t,n){const r=e.slice();return r[8]=t[n],r}function TF(e){let t;return{c(){t=C("th"),t.textContent=`${e[8]}`},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function V1(e){let t,n=e[5]+"",r;return{c(){t=C("td"),r=q(n),k(t,"title",xo[e[7]]),St(t,"background-color",e[5]),St(t,"color",KD(e[5])>50?"black":"white"),St(t,"font-size","12px"),k(t,"class","svelte-1xnq8ek")},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function Y1(e){let t,n,r,i,o=Pe(e[2].colors),a=[];for(let s=0;s<o.length;s+=1)a[s]=V1(H1(e,o,s));return{c(){t=C("tr"),n=C("td"),n.textContent=`${e[2].name}`,r=O();for(let s=0;s<a.length;s+=1)a[s].c();i=O(),k(n,"class","svelte-1xnq8ek"),k(t,"class","svelte-1xnq8ek")},m(s,l){fe(s,t,l),m(t,n),m(t,r);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(t,null);m(t,i)},p(s,l){if(l&2){o=Pe(s[2].colors);let u;for(u=0;u<o.length;u+=1){const c=H1(s,o,u);a[u]?a[u].p(c,l):(a[u]=V1(c),a[u].c(),a[u].m(t,i))}for(;u<a.length;u+=1)a[u].d(1);a.length=o.length}},d(s){s&&ce(t),Ue(a,s)}}}function IF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b=Pe(xo),y=[];for(let M=0;M<b.length;M+=1)y[M]=TF(NF(e,b,M));let _=Pe(e[1]),v=[];for(let M=0;M<_.length;M+=1)v[M]=Y1(z1(e,_,M));return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.innerHTML=`See <a href="https://github.com/fheyen/musicvis-lib/blob/905edbdc8280e8ca76a329ffc83a160f3cda674a/src/utils/NoteColorUtils.js" target="_blank">here</a>
        for literature references and color string arrays. Most schemes are found
        in:
        <i>Schmidt, Kathryn L. (2019) Meaningful Music Visualizations. Purdue
            University Graduate School. <a href="https://doi.org/10.25394/PGS.7498700.v1" target="_blank">DOI</a>
            (page 13)</i>`,s=O(),l=C("div"),u=C("table"),c=C("thead"),f=C("th"),f.textContent="name",h=O();for(let M=0;M<y.length;M+=1)y[M].c();d=O(),p=C("tbody");for(let M=0;M<v.length;M+=1)v[M].c();k(a,"class","explanation"),k(u,"class","svelte-1xnq8ek"),k(l,"class","visualization"),k(t,"class","demo")},m(M,g){fe(M,t,g),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(c,f),m(c,h);for(let w=0;w<y.length;w+=1)y[w]&&y[w].m(c,null);m(u,d),m(u,p);for(let w=0;w<v.length;w+=1)v[w]&&v[w].m(p,null)},p(M,[g]){if(g&1&&r!==(r=M[0].title+"")&&he(i,r),g&2){_=Pe(M[1]);let w;for(w=0;w<_.length;w+=1){const E=z1(M,_,w);v[w]?v[w].p(E,g):(v[w]=Y1(E),v[w].c(),v[w].m(p,null))}for(;w<v.length;w+=1)v[w].d(1);v.length=_.length}},i:ge,o:ge,d(M){M&&ce(t),Ue(y,M),Ue(v,M)}}}function kF(e,t,n){let{toolInfo:r}=t;const i=[];for(const o in ua)ua.hasOwnProperty(o)&&i.push({name:o,colors:ua[o].map(a=>Rr(a).formatHex())});return e.$$set=o=>{"toolInfo"in o&&n(0,r=o.toolInfo)},[r,i]}class $F extends He{constructor(t){super(),ze(this,t,kF,IF,qe,{toolInfo:0})}}function DF(e,t,n){const r=e.slice();return r[17]=t[n],r}function FF(e){let t;return{c(){t=C("option"),t.textContent=`${e[17]}`,t.__value=e[17],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function BF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N=Pe(["velocity","piano","channel","none"]),x=[];for(let T=0;T<4;T+=1)x[T]=FF(DF(e,N,T));return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`The piano roll below shows incoming MIDI notes as rectangles with their
        pitch (y position) and start and end times (x left and right side of the
        rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,s=O(),l=C("div"),u=C("label"),c=q(`color
            `),f=C("select");for(let T=0;T<4;T+=1)x[T].c();h=O(),d=C("label"),p=q(`time
            `),b=C("input"),y=O(),_=C("div"),v=O(),M=C("div"),g=C("button"),g.textContent="reset",k(a,"class","explanation"),e[3]===void 0&&at(()=>e[6].call(f)),k(b,"type","number"),k(b,"min","10"),k(b,"max","300"),k(b,"step","10"),k(d,"title","time in seconds for past notes to be shown"),k(l,"class","control"),k(_,"class","visualization"),k(g,"title","Clear all played notes"),k(M,"class","control"),k(t,"class","demo")},m(T,S){fe(T,t,S),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f);for(let P=0;P<4;P+=1)x[P]&&x[P].m(f,null);$e(f,e[3],!0),m(l,h),m(l,d),m(d,p),m(d,b),be(b,e[2]),m(t,y),m(t,_),e[8](_),m(t,v),m(t,M),m(M,g),w||(E=[ne(f,"change",e[6]),ne(b,"input",e[7]),ne(g,"click",e[9])],w=!0)},p(T,[S]){S&1&&r!==(r=T[0].title+"")&&he(i,r),S&8&&$e(f,T[3]),S&4&&Ne(b.value)!==T[2]&&be(b,T[2])},i:ge,o:ge,d(T){T&&ce(t),Ue(x,T),e[8](null),w=!1,Ve(E)}}}let RF=1e3,LF=500;function OF(e,t,n){let{toolInfo:r}=t,i,o=30,a="velocity",s=0,l=[];const u=new Map;let c=null;const f=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((M,g)=>{console.log(`MIDI device ${g}: ${M.name}`),M.addListener("noteon",h),M.addListener("noteoff",d)}),[...W.inputs])},h=M=>{const g=(M.timestamp-s)/1e3,w={number:M.note.number,velocity:M.rawVelocity,time:g,channel:M.message.channel};if(u.has(M.note.number)){const E=u.get(M.note.number);E.end===void 0&&(E.end=g)}l.push(w),u.set(M.note.number,w)},d=M=>{if(u.has(M.note.number)){const g=u.get(M.note.number),w=(M.timestamp-s)/1e3;g.end=w}},p=()=>{const M=(performance.now()-s)/1e3,g=M-o,w=l.filter(S=>S.end>g||S.end===void 0),E=Yt(w,S=>S.number);let N,x;a==="velocity"?(N={label:"Note velocity",scheme:"blues",domain:[0,127]},x="velocity"):a==="piano"?(N={label:"Piano key color",domain:["black","white"],range:["black","white"]},x=S=>la(S.number)?"black":"white"):a==="channel"?(N={type:"categorical",label:"MIDI channel",scheme:"tableau10"},x=S=>S.channel):a==="none"&&(x="#ddd");const T=et({insetRight:10,width:RF,height:LF,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[g,M]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,domain:Ce(E[0]-1,E[1]+2),tickFormat:S=>Ta[S].label},color:{...N,legend:a!=="none",marginLeft:100,width:300},marks:[Nt(Wy(E[0]-1,E[1]+2)),$t([M],{stroke:"#888"}),ds(w,{clip:!0,x1:"time",x2:S=>S.end===void 0?M:Math.max(S.end,S.time+.025),y:"number",fill:x,stroke:"#ccc",rx:5})]});n(1,i.textContent="",i),i.appendChild(T),c=requestAnimationFrame(p)};st(()=>{W.enable().then(f).catch(M=>alert(M)),n(4,s=performance.now()),c=requestAnimationFrame(p)}),lt(()=>{for(const M of W.inputs)M.removeListener();cancelAnimationFrame(c)});function b(){a=pt(this),n(3,a)}function y(){o=Ne(this.value),n(2,o)}function _(M){xe[M?"unshift":"push"](()=>{i=M,n(1,i)})}const v=()=>{confirm("Reset played notes?")&&(n(5,l=[]),n(4,s=performance.now()))};return e.$$set=M=>{"toolInfo"in M&&n(0,r=M.toolInfo)},[r,i,o,a,s,l,b,y,_,v]}class GF extends He{constructor(t){super(),ze(this,t,OF,BF,qe,{toolInfo:0})}}function Zt(e){if(this.size=e|0,this.size<=1||this.size&this.size-1)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=e<<1;for(var t=new Array(this.size*2),n=0;n<t.length;n+=2){const l=Math.PI*n/this.size;t[n]=Math.cos(l),t[n+1]=-Math.sin(l)}this.table=t;for(var r=0,i=1;this.size>i;i<<=1)r++;this._width=r%2===0?r-1:r,this._bitrev=new Array(1<<this._width);for(var o=0;o<this._bitrev.length;o++){this._bitrev[o]=0;for(var a=0;a<this._width;a+=2){var s=this._width-a-2;this._bitrev[o]|=(o>>>a&3)<<s}}this._out=null,this._data=null,this._inv=0}var UF=Zt;Zt.prototype.fromComplexArray=function(t,n){for(var r=n||new Array(t.length>>>1),i=0;i<t.length;i+=2)r[i>>>1]=t[i];return r};Zt.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var n=0;n<t.length;n++)t[n]=0;return t};Zt.prototype.toComplexArray=function(t,n){for(var r=n||this.createComplexArray(),i=0;i<r.length;i+=2)r[i]=t[i>>>1],r[i+1]=0;return r};Zt.prototype.completeSpectrum=function(t){for(var n=this._csize,r=n>>>1,i=2;i<r;i+=2)t[n-i]=t[i],t[n-i+1]=-t[i+1]};Zt.prototype.transform=function(t,n){if(t===n)throw new Error("Input and output buffers must be different");this._out=t,this._data=n,this._inv=0,this._transform4(),this._out=null,this._data=null};Zt.prototype.realTransform=function(t,n){if(t===n)throw new Error("Input and output buffers must be different");this._out=t,this._data=n,this._inv=0,this._realTransform4(),this._out=null,this._data=null};Zt.prototype.inverseTransform=function(t,n){if(t===n)throw new Error("Input and output buffers must be different");this._out=t,this._data=n,this._inv=1,this._transform4();for(var r=0;r<t.length;r++)t[r]/=this.size;this._out=null,this._data=null};Zt.prototype._transform4=function(){var t=this._out,n=this._csize,r=this._width,i=1<<r,o=n/i<<1,a,s,l=this._bitrev;if(o===4)for(a=0,s=0;a<n;a+=o,s++){const b=l[s];this._singleTransform2(a,b,i)}else for(a=0,s=0;a<n;a+=o,s++){const b=l[s];this._singleTransform4(a,b,i)}var u=this._inv?-1:1,c=this.table;for(i>>=2;i>=2;i>>=2){o=n/i<<1;var f=o>>>2;for(a=0;a<n;a+=o)for(var h=a+f,d=a,p=0;d<h;d+=2,p+=i){const b=d,y=b+f,_=y+f,v=_+f,M=t[b],g=t[b+1],w=t[y],E=t[y+1],N=t[_],x=t[_+1],T=t[v],S=t[v+1],P=M,I=g,$=c[p],D=u*c[p+1],A=w*$-E*D,F=w*D+E*$,L=c[2*p],X=u*c[2*p+1],U=N*L-x*X,z=N*X+x*L,G=c[3*p],R=u*c[3*p+1],Y=T*G-S*R,re=T*R+S*G,Q=P+U,J=I+z,K=P-U,ee=I-z,j=A+Y,V=F+re,te=u*(A-Y),B=u*(F-re),se=Q+j,Z=J+V,ie=Q-j,le=J-V,ve=K+B,we=ee-te,H=K-B,ue=ee+te;t[b]=se,t[b+1]=Z,t[y]=ve,t[y+1]=we,t[_]=ie,t[_+1]=le,t[v]=H,t[v+1]=ue}}};Zt.prototype._singleTransform2=function(t,n,r){const i=this._out,o=this._data,a=o[n],s=o[n+1],l=o[n+r],u=o[n+r+1],c=a+l,f=s+u,h=a-l,d=s-u;i[t]=c,i[t+1]=f,i[t+2]=h,i[t+3]=d};Zt.prototype._singleTransform4=function(t,n,r){const i=this._out,o=this._data,a=this._inv?-1:1,s=r*2,l=r*3,u=o[n],c=o[n+1],f=o[n+r],h=o[n+r+1],d=o[n+s],p=o[n+s+1],b=o[n+l],y=o[n+l+1],_=u+d,v=c+p,M=u-d,g=c-p,w=f+b,E=h+y,N=a*(f-b),x=a*(h-y),T=_+w,S=v+E,P=M+x,I=g-N,$=_-w,D=v-E,A=M-x,F=g+N;i[t]=T,i[t+1]=S,i[t+2]=P,i[t+3]=I,i[t+4]=$,i[t+5]=D,i[t+6]=A,i[t+7]=F};Zt.prototype._realTransform4=function(){var t=this._out,n=this._csize,r=this._width,i=1<<r,o=n/i<<1,a,s,l=this._bitrev;if(o===4)for(a=0,s=0;a<n;a+=o,s++){const Zr=l[s];this._singleRealTransform2(a,Zr>>>1,i>>>1)}else for(a=0,s=0;a<n;a+=o,s++){const Zr=l[s];this._singleRealTransform4(a,Zr>>>1,i>>>1)}var u=this._inv?-1:1,c=this.table;for(i>>=2;i>=2;i>>=2){o=n/i<<1;var f=o>>>1,h=f>>>1,d=h>>>1;for(a=0;a<n;a+=o)for(var p=0,b=0;p<=d;p+=2,b+=i){var y=a+p,_=y+h,v=_+h,M=v+h,g=t[y],w=t[y+1],E=t[_],N=t[_+1],x=t[v],T=t[v+1],S=t[M],P=t[M+1],I=g,$=w,D=c[b],A=u*c[b+1],F=E*D-N*A,L=E*A+N*D,X=c[2*b],U=u*c[2*b+1],z=x*X-T*U,G=x*U+T*X,R=c[3*b],Y=u*c[3*b+1],re=S*R-P*Y,Q=S*Y+P*R,J=I+z,K=$+G,ee=I-z,j=$-G,V=F+re,te=L+Q,B=u*(F-re),se=u*(L-Q),Z=J+V,ie=K+te,le=ee+se,ve=j-B;if(t[y]=Z,t[y+1]=ie,t[_]=le,t[_+1]=ve,p===0){var we=J-V,H=K-te;t[v]=we,t[v+1]=H;continue}if(p!==d){var ue=ee,ye=-j,Fe=J,We=-K,pe=-u*se,de=-u*B,Oe=-u*te,Re=-u*V,fn=ue+pe,En=ye+de,_t=Fe+Re,zn=We-Oe,Ni=a+h-p,Pr=a+f-p;t[Ni]=fn,t[Ni+1]=En,t[Pr]=_t,t[Pr+1]=zn}}}};Zt.prototype._singleRealTransform2=function(t,n,r){const i=this._out,o=this._data,a=o[n],s=o[n+r],l=a+s,u=a-s;i[t]=l,i[t+1]=0,i[t+2]=u,i[t+3]=0};Zt.prototype._singleRealTransform4=function(t,n,r){const i=this._out,o=this._data,a=this._inv?-1:1,s=r*2,l=r*3,u=o[n],c=o[n+r],f=o[n+s],h=o[n+l],d=u+f,p=u-f,b=c+h,y=a*(c-h),_=d+b,v=p,M=-y,g=d-b,w=p,E=y;i[t]=_,i[t+1]=0,i[t+2]=v,i[t+3]=M,i[t+4]=g,i[t+5]=0,i[t+6]=w,i[t+7]=E};const qF=Xy(UF);class ca{constructor(t,n){Ft(this,"_inputLength");Ft(this,"_fft");Ft(this,"_bufferSupplier");Ft(this,"_paddedInputBuffer");Ft(this,"_transformBuffer");Ft(this,"_inverseBuffer");if(t<1)throw new Error("Input length must be at least one");this._inputLength=t,this._fft=new qF(VF(2*t)),this._bufferSupplier=n,this._paddedInputBuffer=this._bufferSupplier(this._fft.size),this._transformBuffer=this._bufferSupplier(2*this._fft.size),this._inverseBuffer=this._bufferSupplier(2*this._fft.size)}static forFloat32Array(t){return new ca(t,n=>new Float32Array(n))}static forFloat64Array(t){return new ca(t,n=>new Float64Array(n))}static forNumberArray(t){return new ca(t,n=>Array(n))}get inputLength(){return this._inputLength}autocorrelate(t,n=this._bufferSupplier(t.length)){if(t.length!==this._inputLength)throw new Error(`Input must have length ${this._inputLength} but had length ${t.length}`);for(let i=0;i<t.length;i++)this._paddedInputBuffer[i]=t[i];for(let i=t.length;i<this._paddedInputBuffer.length;i++)this._paddedInputBuffer[i]=0;this._fft.realTransform(this._transformBuffer,this._paddedInputBuffer),this._fft.completeSpectrum(this._transformBuffer);const r=this._transformBuffer;for(let i=0;i<r.length;i+=2)r[i]=r[i]*r[i]+r[i+1]*r[i+1],r[i+1]=0;this._fft.inverseTransform(this._inverseBuffer,this._transformBuffer);for(let i=0;i<t.length;i++)n[i]=this._inverseBuffer[2*i];return n}}function zF(e){const t=[];let n=!1,r=-1/0,i=-1;for(let o=1;o<e.length-1;o++)e[o-1]<=0&&e[o]>0?(n=!0,i=o,r=e[o]):e[o-1]>0&&e[o]<=0?(n=!1,i!==-1&&t.push(i)):n&&e[o]>r&&(r=e[o],i=o);return t}function HF(e,t){const[n,r,i]=[e-1,e,e+1],[o,a,s]=[t[n],t[r],t[i]],l=o/2-a+s/2,u=-(o/2)*(r+i)+a*(n+i)-s/2*(n+r),c=o*r*i/2-a*n*i+s*n*r/2,f=-u/(2*l),h=l*f*f+u*f+c;return[f,h]}class Wi{constructor(t,n){Ft(this,"_autocorrelator");Ft(this,"_nsdfBuffer");Ft(this,"_clarityThreshold",.9);Ft(this,"_minVolumeAbsolute",0);Ft(this,"_maxInputAmplitude",1);this._autocorrelator=new ca(t,n),this._nsdfBuffer=n(t)}static forFloat32Array(t){return new Wi(t,n=>new Float32Array(n))}static forFloat64Array(t){return new Wi(t,n=>new Float64Array(n))}static forNumberArray(t){return new Wi(t,n=>Array(n))}get inputLength(){return this._autocorrelator.inputLength}set clarityThreshold(t){if(!Number.isFinite(t)||t<=0||t>1)throw new Error("clarityThreshold must be a number in the range (0, 1]");this._clarityThreshold=t}set minVolumeAbsolute(t){if(!Number.isFinite(t)||t<0||t>this._maxInputAmplitude)throw new Error(`minVolumeAbsolute must be a number in the range [0, ${this._maxInputAmplitude}]`);this._minVolumeAbsolute=t}set minVolumeDecibels(t){if(!Number.isFinite(t)||t>0)throw new Error("minVolumeDecibels must be a number <= 0");this._minVolumeAbsolute=this._maxInputAmplitude*10**(t/10)}set maxInputAmplitude(t){if(!Number.isFinite(t)||t<=0)throw new Error("maxInputAmplitude must be a number > 0");this._maxInputAmplitude=t}findPitch(t,n){if(this._belowMinimumVolume(t))return[0,0];this._nsdf(t);const r=zF(this._nsdfBuffer);if(r.length===0)return[0,0];const i=Math.max(...r.map(l=>this._nsdfBuffer[l])),o=r.find(l=>this._nsdfBuffer[l]>=this._clarityThreshold*i),[a,s]=HF(o,this._nsdfBuffer);return[n/a,Math.min(s,1)]}_belowMinimumVolume(t){if(this._minVolumeAbsolute===0)return!1;let n=0;for(let r=0;r<t.length;r++)n+=t[r]**2;return Math.sqrt(n/t.length)<this._minVolumeAbsolute}_nsdf(t){this._autocorrelator.autocorrelate(t,this._nsdfBuffer);let n=2*this._nsdfBuffer[0],r;for(r=0;r<this._nsdfBuffer.length&&n>0;r++)this._nsdfBuffer[r]=2*this._nsdfBuffer[r]/n,n-=t[r]**2+t[t.length-r-1]**2;for(;r<this._nsdfBuffer.length;r++)this._nsdfBuffer[r]=0}}function VF(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}function YF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d=e[2].toFixed(1)+"",p,b,y,_,v,M=(e[3]*100).toFixed()+"",g,w,E,N,x,T,S,P,I;return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Allow microphone access and make a sound, the detected pitch will be
        displayed below together with the closest note and the offset from this
        notes in cents.`,s=O(),l=C("div"),u=O(),c=C("div"),f=C("div"),h=q("frequency: "),p=q(d),b=q(" Hz"),y=O(),_=C("div"),v=q("clarity: "),g=q(M),w=q(" %"),E=O(),N=C("div"),x=q("note: "),T=C("b"),S=q(e[4]),P=O(),I=C("div"),k(a,"class","explanation"),k(l,"class","control"),k(I,"class","visualization"),k(t,"class","demo")},m($,D){fe($,t,D),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(t,u),m(t,c),m(c,f),m(f,h),m(f,p),m(f,b),m(c,y),m(c,_),m(_,v),m(_,g),m(_,w),m(c,E),m(c,N),m(N,x),m(N,T),m(T,S),m(t,P),m(t,I),e[5](I)},p($,[D]){D&1&&r!==(r=$[0].title+"")&&he(i,r),D&4&&d!==(d=$[2].toFixed(1)+"")&&he(p,d),D&8&&M!==(M=($[3]*100).toFixed()+"")&&he(g,M),D&16&&he(S,$[4])},i:ge,o:ge,d($){$&&ce(t),e[5](null)}}}let WF=1e3,jF=300;function XF(e,t,n){let{toolInfo:r}=t,i,o,a,s,l=-20,u=0,c=0,f="",h=0,d=0,p=[];function b(v,M,g,w){v.getFloatTimeDomainData(g);const E=M.findPitch(g,w);n(2,u=E[0]),n(3,c=E[1]),n(4,f=Ut.fromFreq(u)),h=Ut.midi(f),d=(Uf.freqToMidi(u)-h)*100,p=[...p.slice(-50),d],y(),s=requestAnimationFrame(()=>b(v,M,g,w))}const y=()=>{n(1,i.textContent="",i);const v=et({width:WF,height:jF,marginLeft:40,x:{label:"offset in cents",domain:[-50,50]},y:{reverse:!0,ticks:[]},marks:[$t([-50,0,50],{stroke:"#ddd"}),nh(p,{stroke:"#333",x:M=>M,y:(M,g)=>g})]});i.appendChild(v)};st(()=>{o=new window.AudioContext,a=o.createAnalyser(),navigator.mediaDevices.getUserMedia({audio:!0}).then(v=>{o.createMediaStreamSource(v).connect(a);const M=Wi.forFloat32Array(a.fftSize);M.minVolumeDecibels=l;const g=new Float32Array(M.inputLength);b(a,M,g,o.sampleRate)})}),lt(()=>{cancelAnimationFrame(s)});function _(v){xe[v?"unshift":"push"](()=>{i=v,n(1,i)})}return e.$$set=v=>{"toolInfo"in v&&n(0,r=v.toolInfo)},[r,i,u,c,f,_]}class KF extends He{constructor(t){super(),ze(this,t,XF,YF,qe,{toolInfo:0})}}function W1(e,t,n){const r=e.slice();return r[15]=t[n],r}function j1(e,t,n){const r=e.slice();return r[18]=t[n],r}function X1(e,t,n){const r=e.slice();return r[21]=t[n],r}function K1(e,t,n){const r=e.slice();return r[24]=t[n],r}function Z1(e,t,n){const r=e.slice();return r[27]=t[n],r}function Q1(e){let t,n=e[27]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[27],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function J1(e){let t,n=e[24]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[24],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function ep(e){let t,n,r,i=e[21].name+"",o,a,s=e[21].notes.join(" ")+"",l,u,c=[...ll(e[3].notes,e[21].notes)].join(" ")+"",f,h,d,p;function b(){return e[12](e[21])}return{c(){t=C("div"),n=C("button"),n.textContent="show",r=O(),o=q(i),a=q(`:
                `),l=q(s),u=q(`
                (no `),f=q(c),h=q(")")},m(y,_){fe(y,t,_),m(t,n),m(t,r),m(t,o),m(t,a),m(t,l),m(t,u),m(t,f),m(t,h),d||(p=ne(n,"click",b),d=!0)},p(y,_){e=y,_&128&&i!==(i=e[21].name+"")&&he(o,i),_&128&&s!==(s=e[21].notes.join(" ")+"")&&he(l,s),_&136&&c!==(c=[...ll(e[3].notes,e[21].notes)].join(" ")+"")&&he(f,c)},d(y){y&&ce(t),d=!1,p()}}}function tp(e){let t,n,r,i=e[18].name+"",o,a,s=e[18].notes.join(" ")+"",l,u,c=[...ll(e[18].notes,e[3].notes)].join(" ")+"",f,h,d,p;function b(){return e[13](e[18])}return{c(){t=C("div"),n=C("button"),n.textContent="show",r=O(),o=q(i),a=q(`:
                `),l=q(s),u=q(`
                (adds `),f=q(c),h=q(")")},m(y,_){fe(y,t,_),m(t,n),m(t,r),m(t,o),m(t,a),m(t,l),m(t,u),m(t,f),m(t,h),d||(p=ne(n,"click",b),d=!0)},p(y,_){e=y,_&64&&i!==(i=e[18].name+"")&&he(o,i),_&64&&s!==(s=e[18].notes.join(" ")+"")&&he(l,s),_&72&&c!==(c=[...ll(e[18].notes,e[3].notes)].join(" ")+"")&&he(f,c)},d(y){y&&ce(t),d=!1,p()}}}function np(e){let t,n,r,i=e[15]+"",o,a,s=Ll.get(`${e[1]} ${e[15]}`).notes.join(" ")+"",l,u;return{c(){t=C("div"),n=q(e[1]),r=O(),o=q(i),a=q(`:
                `),l=q(s),u=O()},m(c,f){fe(c,t,f),m(t,n),m(t,r),m(t,o),m(t,a),m(t,l),m(t,u)},p(c,f){f&2&&he(n,c[1]),f&32&&i!==(i=c[15]+"")&&he(o,i),f&34&&s!==(s=Ll.get(`${c[1]} ${c[15]}`).notes.join(" ")+"")&&he(l,s)},d(c){c&&ce(t)}}}function ZF(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v=e[3].name+"",M,g,w,E,N=e[3].notes.join(" ")+"",x,T,S,P,I,$,D,A,F,L,X,U,z=Pe(e[8]),G=[];for(let V=0;V<z.length;V+=1)G[V]=Q1(Z1(e,z,V));let R=Pe(e[9]),Y=[];for(let V=0;V<R.length;V+=1)Y[V]=J1(K1(e,R,V));let re=Pe(e[7]),Q=[];for(let V=0;V<re.length;V+=1)Q[V]=ep(X1(e,re,V));let J=Pe(e[6]),K=[];for(let V=0;V<J.length;V+=1)K[V]=tp(j1(e,J,V));let ee=Pe(e[5]),j=[];for(let V=0;V<ee.length;V+=1)j[V]=np(W1(e,ee,V));return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.innerHTML=`Select a root note and scale and see how this scale relates to others.
        This tool is mainly a graphical interface for <a href="https://github.com/tonaljs/tonal/tree/main/packages/scale" target="_blank">tonaljs.</a>`,s=O(),l=C("div"),u=C("label"),c=q(`scale
            `),f=C("select");for(let V=0;V<G.length;V+=1)G[V].c();h=O(),d=C("select");for(let V=0;V<Y.length;V+=1)Y[V].c();p=O(),b=C("div"),y=C("h2"),_=q("current scale: "),M=q(v),g=O(),w=C("h3"),w.textContent="notes",E=O(),x=q(N),T=O(),S=C("h3"),S.textContent="scales that are subsets",P=O();for(let V=0;V<Q.length;V+=1)Q[V].c();I=O(),$=C("h3"),$.textContent="scales that are supersets",D=O();for(let V=0;V<K.length;V+=1)K[V].c();A=O(),F=C("h3"),F.textContent="chords",L=O();for(let V=0;V<j.length;V+=1)j[V].c();k(a,"class","explanation"),e[1]===void 0&&at(()=>e[10].call(f)),e[2]===void 0&&at(()=>e[11].call(d)),k(l,"class","control"),k(b,"class","visualization"),k(t,"class","demo")},m(V,te){fe(V,t,te),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f);for(let B=0;B<G.length;B+=1)G[B]&&G[B].m(f,null);$e(f,e[1],!0),m(u,h),m(u,d);for(let B=0;B<Y.length;B+=1)Y[B]&&Y[B].m(d,null);$e(d,e[2],!0),m(t,p),m(t,b),m(b,y),m(y,_),m(y,M),m(b,g),m(b,w),m(b,E),m(b,x),m(b,T),m(b,S),m(b,P);for(let B=0;B<Q.length;B+=1)Q[B]&&Q[B].m(b,null);m(b,I),m(b,$),m(b,D);for(let B=0;B<K.length;B+=1)K[B]&&K[B].m(b,null);m(b,A),m(b,F),m(b,L);for(let B=0;B<j.length;B+=1)j[B]&&j[B].m(b,null);e[14](b),X||(U=[ne(f,"change",e[10]),ne(d,"change",e[11])],X=!0)},p(V,[te]){if(te&1&&r!==(r=V[0].title+"")&&he(i,r),te&256){z=Pe(V[8]);let B;for(B=0;B<z.length;B+=1){const se=Z1(V,z,B);G[B]?G[B].p(se,te):(G[B]=Q1(se),G[B].c(),G[B].m(f,null))}for(;B<G.length;B+=1)G[B].d(1);G.length=z.length}if(te&258&&$e(f,V[1]),te&512){R=Pe(V[9]);let B;for(B=0;B<R.length;B+=1){const se=K1(V,R,B);Y[B]?Y[B].p(se,te):(Y[B]=J1(se),Y[B].c(),Y[B].m(d,null))}for(;B<Y.length;B+=1)Y[B].d(1);Y.length=R.length}if(te&516&&$e(d,V[2]),te&8&&v!==(v=V[3].name+"")&&he(M,v),te&8&&N!==(N=V[3].notes.join(" ")+"")&&he(x,N),te&140){re=Pe(V[7]);let B;for(B=0;B<re.length;B+=1){const se=X1(V,re,B);Q[B]?Q[B].p(se,te):(Q[B]=ep(se),Q[B].c(),Q[B].m(b,I))}for(;B<Q.length;B+=1)Q[B].d(1);Q.length=re.length}if(te&76){J=Pe(V[6]);let B;for(B=0;B<J.length;B+=1){const se=j1(V,J,B);K[B]?K[B].p(se,te):(K[B]=tp(se),K[B].c(),K[B].m(b,A))}for(;B<K.length;B+=1)K[B].d(1);K.length=J.length}if(te&34){ee=Pe(V[5]);let B;for(B=0;B<ee.length;B+=1){const se=W1(V,ee,B);j[B]?j[B].p(se,te):(j[B]=np(se),j[B].c(),j[B].m(b,null))}for(;B<j.length;B+=1)j[B].d(1);j.length=ee.length}},i:ge,o:ge,d(V){V&&ce(t),Ue(G,V),Ue(Y,V),Ue(Q,V),Ue(K,V),Ue(j,V),e[14](null),X=!1,Ve(U)}}}function QF(e,t,n){let r,i,o,a,{toolInfo:s}=t,l,u="A",c="minor";const f=ms,h=wt.names();function d(){u=pt(this),n(1,u),n(8,f)}function p(){c=pt(this),n(2,c),n(9,h)}const b=v=>n(2,c=v.type),y=v=>n(2,c=v.type);function _(v){xe[v?"unshift":"push"](()=>{l=v,n(4,l)})}return e.$$set=v=>{"toolInfo"in v&&n(0,s=v.toolInfo)},e.$$.update=()=>{e.$$.dirty&6&&n(3,r=wt.get(`${u} ${c}`)),e.$$.dirty&10&&n(7,i=wt.reduced(r.name).map(v=>wt.get(`${u} ${v}`))),e.$$.dirty&10&&n(6,o=wt.extended(r.name).map(v=>wt.get(`${u} ${v}`))),e.$$.dirty&6&&n(5,a=wt.scaleChords(`${u} ${c}`))},[s,u,c,r,l,a,o,i,f,h,d,p,b,y,_]}class JF extends He{constructor(t){super(),ze(this,t,QF,ZF,qe,{toolInfo:0})}}const ft="",ht="";function eB(e,t,n){const r=e.slice();return r[17]=t[n],r}function rp(e,t,n){const r=e.slice();return r[20]=t[n],r}function ip(e){let t,n=e[20]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[20],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function tB(e){let t;return{c(){t=C("option"),t.textContent=`${e[17]}`,t.__value=e[17],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function nB(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M=(e[5]?ft:ht)+"",g,w,E,N,x,T,S=Pe(e[6]),P=[];for(let D=0;D<S.length;D+=1)P[D]=ip(rp(e,S,D));let I=Pe(["default","name","notes","number of notes"]),$=[];for(let D=0;D<4;D+=1)$[D]=tB(eB(e,I,D));return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.innerHTML=`Select a root note and see all scales with this root and their notes.
        Using <a href="https://github.com/tonaljs/tonal/tree/main/packages/scale" target="_blank">tonaljs.</a>
        Ported from
        <a href="https://observablehq.com/@fheyen/musical-scales" target="_blank">here.</a>`,s=O(),l=C("div"),u=C("label"),c=q(`scale
            `),f=C("select");for(let D=0;D<P.length;D+=1)P[D].c();h=O(),d=C("label"),p=q(`ordering
            `),b=C("select");for(let D=0;D<4;D+=1)$[D].c();y=O(),_=C("button"),v=q("colors "),g=q(M),w=O(),E=C("div"),N=C("canvas"),k(a,"class","explanation"),e[1]===void 0&&at(()=>e[10].call(f)),e[2]===void 0&&at(()=>e[11].call(b)),k(_,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),k(l,"class","control"),St(N,"width",hh+"px"),St(N,"height",Js+"px"),k(E,"class","visualization"),k(t,"class","demo")},m(D,A){fe(D,t,A),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f);for(let F=0;F<P.length;F+=1)P[F]&&P[F].m(f,null);$e(f,e[1],!0),m(l,h),m(l,d),m(d,p),m(d,b);for(let F=0;F<4;F+=1)$[F]&&$[F].m(b,null);$e(b,e[2],!0),m(l,y),m(l,_),m(_,v),m(_,g),m(t,w),m(t,E),m(E,N),e[13](N),e[14](E),x||(T=[ne(f,"change",e[10]),ne(b,"change",e[11]),ne(_,"click",e[12])],x=!0)},p(D,[A]){if(A&1&&r!==(r=D[0].title+"")&&he(i,r),A&64){S=Pe(D[6]);let F;for(F=0;F<S.length;F+=1){const L=rp(D,S,F);P[F]?P[F].p(L,A):(P[F]=ip(L),P[F].c(),P[F].m(f,null))}for(;F<P.length;F+=1)P[F].d(1);P.length=S.length}A&66&&$e(f,D[1]),A&4&&$e(b,D[2]),A&32&&M!==(M=(D[5]?ft:ht)+"")&&he(g,M)},i:ge,o:ge,d(D){D&&ce(t),Ue(P,D),Ue($,D),e[13](null),e[14](null),x=!1,Ve(T)}}}const hh=400,Js=1200;function rB(e,t,n){let r,i,{toolInfo:o}=t,a,s,l="C",u="default",c=!0;const f=xo,h=wt.names(),d=(g,w)=>{if(g==="default")return[...w];if(g==="name")return[...w].sort((E,N)=>E.name<N.name?-1:1);if(g==="notes")return[...w].sort((E,N)=>E.notes.join(" ")<N.notes.join(" ")?-1:1);if(g==="number of notes")return[...w].sort((E,N)=>E.notes.length>N.notes.length?-1:1)},p=()=>{if(!s)return;const g=s.getContext("2d"),w=window.devicePixelRatio,E=s.getBoundingClientRect();n(4,s.width=E.width*w,s),n(4,s.height=E.height*w,s),g.scale(w,w),n(4,s.style.width=`${E.width}px`,s),n(4,s.style.height=`${E.height}px`,s),g.fillStyle="white",g.fillRect(0,0,hh,Js);const N=130,x=(hh-N)/12,T=x*.9,S=(Js-30)/r.length,P=S*.9;g.textAlign="center",g.fillStyle="black";for(const[$,D]of f.entries()){const A=N+($+.5)*x;g.fillText(D,A,10),g.fillText(D,A,Js-3)}const I=new Map(f.map(($,D)=>[$,D]));for(const[$,D]of i.entries()){const A=15+$*S;g.fillStyle="black",g.textAlign="right",g.fillText(D.type,N-5,A+S-2.5),g.fillStyle="#666";for(const F of D.notes){const L=I.get(F);c?g.fillStyle=ua.noteColormap[L]:g.fillStyle=F===l?"#777":"#bbb";const X=N+L*x+x*.05;g.fillRect(X,A,T,P),g.fillStyle="white",g.textAlign="center";const U=N+(L+.5)*x;g.fillText(F,U,A+S-3.5)}}};st(p);function b(){l=pt(this),n(1,l),n(6,f)}function y(){u=pt(this),n(2,u)}const _=()=>{n(5,c=!c),p()};function v(g){xe[g?"unshift":"push"](()=>{s=g,n(4,s)})}function M(g){xe[g?"unshift":"push"](()=>{a=g,n(3,a)})}return e.$$set=g=>{"toolInfo"in g&&n(0,o=g.toolInfo)},e.$$.update=()=>{e.$$.dirty&2&&n(9,r=h.map(g=>wt.get(`${l} ${g}`)).filter(g=>!g.empty).map(g=>(g.notes=g.notes.map(w=>$I.get(w)??w),g))),e.$$.dirty&516&&n(8,i=d(u,r)),e.$$.dirty&256&&i&&p()},[o,l,u,a,s,c,f,p,i,r,b,y,_,v,M]}class iB extends He{constructor(t){super(),ze(this,t,rB,nB,qe,{toolInfo:0})}}function op(e,t,n){const r=e.slice();return r[3]=t[n],r}function oB(e){let t,n,r;var i=e[0].component;function o(a,s){return{props:{toolInfo:a[0]}}}return i&&(n=tl(i,o(e))),{c(){t=C("div"),n&&Ae(n.$$.fragment)},m(a,s){fe(a,t,s),n&&Se(n,t,null),r=!0},p(a,s){if(s&1&&i!==(i=a[0].component)){if(n){Jl();const l=n;Me(l.$$.fragment,1,0,()=>{Ee(l,1)}),eu()}i?(n=tl(i,o(a)),Ae(n.$$.fragment),_e(n.$$.fragment,1),Se(n,t,null)):n=null}else if(i){const l={};s&1&&(l.toolInfo=a[0]),n.$set(l)}},i(a){r||(n&&_e(n.$$.fragment,a),r=!0)},o(a){n&&Me(n.$$.fragment,a),r=!1},d(a){a&&ce(t),n&&Ee(n)}}}function aB(e){let t,n,r,i=Pe(e[1]),o=[];for(let a=0;a<i.length;a+=1)o[a]=ap(op(e,i,a));return{c(){t=C("p"),t.textContent="This page contains a collection of simple but useful tools.",n=O(),r=C("div");for(let a=0;a<o.length;a+=1)o[a].c();k(t,"class","explanation"),k(r,"class","grid")},m(a,s){fe(a,t,s),fe(a,n,s),fe(a,r,s);for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(r,null)},p(a,s){if(s&3){i=Pe(a[1]);let l;for(l=0;l<i.length;l+=1){const u=op(a,i,l);o[l]?o[l].p(u,s):(o[l]=ap(u),o[l].c(),o[l].m(r,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=i.length}},i:ge,o:ge,d(a){a&&(ce(t),ce(n),ce(r)),Ue(o,a)}}}function ap(e){let t,n,r,i,o,a,s;function l(){return e[2](e[3])}return{c(){t=C("div"),n=C("h2"),n.textContent=`${e[3].title}`,r=O(),i=C("div"),i.textContent=`${e[3].description}`,o=O(),k(i,"class","description"),k(t,"class","card")},m(u,c){fe(u,t,c),m(t,n),m(t,r),m(t,i),m(t,o),a||(s=ne(t,"click",l),a=!0)},p(u,c){e=u},d(u){u&&ce(t),a=!1,s()}}}function sB(e){let t,n,r,i;const o=[aB,oB],a=[];function s(l,u){return l[0]?1:0}return n=s(e),r=a[n]=o[n](e),{c(){t=C("main"),r.c()},m(l,u){fe(l,t,u),a[n].m(t,null),i=!0},p(l,[u]){let c=n;n=s(l),n===c?a[n].p(l,u):(Jl(),Me(a[c],1,1,()=>{a[c]=null}),eu(),r=a[n],r?r.p(l,u):(r=a[n]=o[n](l),r.c()),_e(r,1),r.m(t,null))},i(l){i||(_e(r),i=!0)},o(l){Me(r),i=!1},d(l){l&&ce(t),a[n].d()}}}function lB(e,t,n){let r=[{id:"midi-logger",title:"MIDI Logger",description:"Logs all incoming MIDI messages. Useful for getting to know a device or debugging MIDI issues.",component:xF},{id:"piano-roll",title:"Piano Roll",description:"Shows MIDI input as a piano roll.",component:GF},{id:"guitar-tab",title:"Guitar Tab",description:"Shows MIDI input as guitar tab.",component:MF},{id:"guitar-tunings",title:"Guitar Tunings",description:"Small tool that computes the notes for a guitar tuning based on parameters. Open tunings are not included.",component:AF},{id:"chord-detection",title:"Chord Detection",description:"Play a chord and see what it's named.",component:kC},{id:"note-colors",title:"Note Colors",description:"Different note coor schemes.",component:$F},{id:"scale-sets",title:"Scale Sets",description:"See how different musical scales relate to each other.",component:JF},{id:"scale-notes",title:"Scale Notes",description:"See which notes are in each scale.",component:iB},{id:"tuner",title:"Tuner",description:"Tries to detect the currently most prominent pitch from microphone audio. Useful for tuning instruments.",component:KF}],{currentTool:i}=t;const o=a=>{n(0,i=a)};return e.$$set=a=>{"currentTool"in a&&n(0,i=a.currentTool)},[i,r,o]}class uB extends He{constructor(t){super(),ze(this,t,lB,sB,qe,{currentTool:0})}}function sp(e,t){return e==null?t:typeof e=="function"?e:n=>n[e]}function cB(e,t,n,r,i,o){const a=new Float64Array(o),s=(o-1)/(i-r);for(let l=0;l<e.length;++l){const u=e[l],c=t(u,l,e),f=n(u,l,e);if(!(Number.isFinite(c)&&Number.isFinite(f)))continue;const h=(c-r)*s,d=Math.floor(h),p=d+1;0<=d&&p<o?(a[d]+=(p-h)*f,a[p]+=(h-d)*f):d===-1?a[p]+=(h-d)*f:p===o&&(a[d]+=(p-h)*f)}return a}function lp(e,t=!1){const n=new Float64Array(5),r=new Float64Array(4);fB(n,r,e);const i=Float64Array.of(0,r[1]-n[1]*r[0],r[2]-n[2]*r[0],r[3]-n[3]*r[0],-n[4]*r[0]),o=1+n[1]+n[2]+n[3]+n[4],a=(r[0]+r[1]+r[2]+r[3])/o,s=(i[1]+i[2]+i[3]+i[4])/o;return{sigma:e,negative:t,a:n,b_causal:r,b_anticausal:i,sum_causal:a,sum_anticausal:s}}function fB(e,t,n){const i=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),o=Math.exp(-1.783/n),a=Math.exp(-1.723/n),s=.6318/n,l=1.997/n,u=Float64Array.of(-o*Math.cos(s),o*Math.sin(s),-o*Math.cos(-s),o*Math.sin(-s),-a*Math.cos(l),a*Math.sin(l),-a*Math.cos(-l),a*Math.sin(-l)),c=n*2.5066282746310007,f=Float64Array.of(i[0],i[1],0,0,0,0,0,0),h=Float64Array.of(1,0,u[0],u[1],0,0,0,0,0,0);let d,p;for(p=2;p<8;p+=2){for(f[p]=u[p]*f[p-2]-u[p+1]*f[p-1],f[p+1]=u[p]*f[p-1]+u[p+1]*f[p-2],d=p-2;d>0;d-=2)f[d]+=u[p]*f[d-2]-u[p+1]*f[d-1],f[d+1]+=u[p]*f[d-1]+u[p+1]*f[d-2];for(d=0;d<=p;d+=2)f[d]+=i[p]*h[d]-i[p+1]*h[d+1],f[d+1]+=i[p]*h[d+1]+i[p+1]*h[d];for(h[p+2]=u[p]*h[p]-u[p+1]*h[p+1],h[p+3]=u[p]*h[p+1]+u[p+1]*h[p],d=p;d>0;d-=2)h[d]+=u[p]*h[d-2]-u[p+1]*h[d-1],h[d+1]+=u[p]*h[d-1]+u[p+1]*h[d-2]}for(p=0;p<4;++p)d=p<<1,t[p]=f[d]/c,e[p+1]=h[d+2]}function hB(e,t,n,r=1,i=new Float64Array(n),o=new Float64Array(n),a=new Float64Array(5),s=i,l=dB){const u=r*2,c=r*3,f=r*4,h=r*n;let d,p;for(l(i,t,n,r,e.b_causal,3,e.a,4,e.sum_causal,a,e.sigma),p=4,d=f;p<n;++p,d+=r)i[p]=e.b_causal[0]*t[d]+e.b_causal[1]*t[d-r]+e.b_causal[2]*t[d-u]+e.b_causal[3]*t[d-c]-e.a[1]*i[p-1]-e.a[2]*i[p-2]-e.a[3]*i[p-3]-e.a[4]*i[p-4];for(l(o,t,n,-r,e.b_anticausal,4,e.a,4,e.sum_anticausal,a,e.sigma),p=4,d=h-r*5;p<n;++p,d-=r)o[p]=e.b_anticausal[1]*t[d+r]+e.b_anticausal[2]*t[d+u]+e.b_anticausal[3]*t[d+c]+e.b_anticausal[4]*t[d+f]-e.a[1]*o[p-1]-e.a[2]*o[p-2]-e.a[3]*o[p-3]-e.a[4]*o[p-4];if(e.negative)for(p=0,d=0;p<n;++p,d+=r)s[d]=i[p]+o[n-p-1];else for(p=0,d=0;p<n;++p,d+=r)s[d]=Math.max(0,i[p]+o[n-p-1]);return s}function dB(e,t,n,r,i,o,a,s,l,u,c,f=.5){const h=Math.abs(r)*n,d=r<0?h+r:0;let p,b,y;for(b=0;b<s;++b)for(u[b]=b<=o?i[b]:0,y=1;y<=s&&y<=b;++y)u[b]-=a[y]*u[b-y];for(y=0;y<s;++y)for(e[y]=0,b=1;b<=y;++b)p=d+r*b,p>=0&&p<h&&(e[y]+=u[y-b]*t[p]);const _=t[d],v=Math.ceil(c*10);for(b=0;b<v;++b){for(y=0;y<s;++y)e[y]+=u[y]*_;if(l-=Math.abs(u[0]),l<=f)break;for(u[s]=b+s<=o?i[b+s]:0,y=1;y<=s;++y)u[s]-=a[y]*u[s-y];for(y=0;y<s;++y)u[y]=u[y+1]}}function mB(e,t,n=0){const r=e.length;let i,o;for(let a=0;a<r;++a){const s=t(e[a],a,e);s!=null&&(i===void 0?s>=s&&(i=o=s):(s<i&&(i=s),s>o&&(o=s)))}return[i-n,o+n]}function pB(e,t){const n=e.map(t).filter(u=>u!=null&&u>=u);n.sort((u,c)=>u-c);const r=bB(n),i=up(n,.25),o=up(n,.75),a=n.length,s=(o-i)/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i)||1)*Math.pow(a,-.2)}function bB(e){const t=e.length;let n=0,r,i=0,o=0;for(let a=0;a<t;++a){const s=e[a];r=s-i,i+=r/++n,o+=r*(s-i)}return n>1?Math.sqrt(o/(n-1)):NaN}function up(e,t){const n=e.length;if(!n)return NaN;if((t=+t)<=0||n<2)return e[0];if(t>=1)return e[n-1];const r=(n-1)*t,i=Math.floor(r),o=e[i];return o+(e[i+1]-o)*(r-i)}function y3(e,t={}){const{adjust:n=1,pad:r=3,bins:i=512}=t,o=sp(t.x,_=>_),a=sp(t.weight,()=>1/e.length);let s=t.bandwidth??n*pB(e,o);const[l,u]=t.extent??mB(e,o,r*s),c=cB(e,o,a,l,u,i),f=(u-l)/(i-1),h=c.some(_=>_<0);let d=lp(s/f,h),p;function*b(_="x",v="y"){const M=y.grid(),g=1/f;for(let w=0;w<i;++w)yield{[_]:l+w*f,[v]:M[w]*g}}const y={[Symbol.iterator]:b,points:b,grid:()=>p||(p=hB(d,c,i)),extent:()=>[l,u],bandwidth(_){return arguments.length?(_!==s&&(s=_,p=null,d=lp(s/f,h)),y):s}};return y}function gB(e){let t,n,r,i,o;return{c(){t=C("button"),t.textContent="import",n=O(),r=C("input"),k(t,"title","Import all data and settings"),k(r,"type","file"),k(r,"id","file-input"),St(r,"display","none")},m(a,s){fe(a,t,s),fe(a,n,s),fe(a,r,s),e[3](r),i||(o=[ne(t,"click",e[2]),ne(r,"input",function(){vo(e[0])&&e[0].apply(this,arguments)})],i=!0)},p(a,[s]){e=a},i:ge,o:ge,d(a){a&&(ce(t),ce(n),ce(r)),e[3](null),i=!1,Ve(o)}}}function yB(e,t,n){let{importFunction:r}=t,i;const o=()=>i.click();function a(s){xe[s?"unshift":"push"](()=>{i=s,n(1,i)})}return e.$$set=s=>{"importFunction"in s&&n(0,r=s.importFunction)},[r,i,o,a]}class an extends He{constructor(t){super(),ze(this,t,yB,gB,qe,{importFunction:0})}}function _B(e){let t,n,r;return{c(){t=C("button"),t.textContent="export",k(t,"title","Export all data and settings")},m(i,o){fe(i,t,o),n||(r=ne(t,"click",function(){vo(e[0])&&e[0].apply(this,arguments)}),n=!0)},p(i,[o]){e=i},i:ge,o:ge,d(i){i&&ce(t),n=!1,r()}}}function vB(e,t,n){let{exportFunction:r}=t;return e.$$set=i=>{"exportFunction"in i&&n(0,r=i.exportFunction)},[r]}class sn extends He{constructor(t){super(),ze(this,t,vB,_B,qe,{exportFunction:0})}}var Kl,Zl,Ql,ji,Ra,ii,La,Xi,Oa,Nn,Vn,Ki;class qd{constructor(){Jt(this,Kl,.03);Jt(this,Zl,.25);Jt(this,Ql,100);Jt(this,ji,!1);Jt(this,Ra,null);Jt(this,ii,null);Jt(this,La,4);Jt(this,Xi,1/0);Jt(this,Oa,void 0);Jt(this,Nn,null);Jt(this,Vn,new AudioContext);Jt(this,Ki,null);Ft(this,"_scheduler",()=>{const t=Ke(this,La),n=60/Ke(this,ii);let r=Ke(this,Oa)+Ke(this,Nn)*n;for(;r<Ke(this,Vn).currentTime+Ke(this,Zl);)if(Ke(this,Nn)<Ke(this,Xi)-1){r+=n;const i=Ke(this,Nn)%t===t-1||Ke(this,Nn)===-1,o=r-Ke(this,Vn).currentTime,a=performance.now()+o*1e3;this._playSound(r,a,i),am(this,Nn)._++}Ke(this,Nn)<Ke(this,Xi)-1?Pn(this,Ra,setTimeout(this._scheduler,Ke(this,Ql))):this.stop()})}get bpm(){return Ke(this,ii)}get beatCount(){return Ke(this,Nn)}onClick(t){Pn(this,Ki,t)}start(t,n=4,r=1/0){if(!t||Number.isNaN(+t)){console.error(`[Metronome] Invalid bpm ${t}`);return}if(!n||Number.isNaN(+n)){console.error(`[Metronome] Invalid accent ${n}`);return}if(!r||Number.isNaN(+r)){console.error(`[Metronome] Invalid maxBeeps ${r}`);return}Ke(this,Vn).state==="suspended"&&Ke(this,Vn).resume(),Pn(this,ii,+t),Pn(this,La,+n),Pn(this,Xi,+r),Pn(this,ji,!0),console.log(`Metronome @ ${t}bpm, accent every ${n}. beat, limited to ${r}`),Pn(this,Nn,-1),Pn(this,Oa,Ke(this,Vn).currentTime),this._scheduler()}stop(){console.log("[Metronome] stopped"),clearTimeout(Ke(this,Ra)),Pn(this,ji,!1)}toggle(t,n=4){Ke(this,ji)?this.stop():(t===void 0&&(t=Ke(this,ii)),this.start(t,n))}_playSound(t,n,r){Ke(this,Ki)&&Ke(this,Ki).call(this,t,n,r);const i=Ke(this,Vn).createOscillator();i.connect(Ke(this,Vn).destination);const o=r?300:200;i.frequency.value=o,i.start(t),i.stop(t+Ke(this,Kl))}}Kl=new WeakMap,Zl=new WeakMap,Ql=new WeakMap,ji=new WeakMap,Ra=new WeakMap,ii=new WeakMap,La=new WeakMap,Xi=new WeakMap,Oa=new WeakMap,Nn=new WeakMap,Vn=new WeakMap,Ki=new WeakMap;function wB(e){let t,n,r;return{c(){t=C("button"),t.textContent="metronome",k(t,"title","Toggle metronome (click)")},m(i,o){fe(i,t,o),n||(r=ne(t,"click",e[3]),n=!0)},p:ge,i:ge,o:ge,d(i){i&&ce(t),n=!1,r()}}}function MB(e,t,n){let{tempo:r=120}=t,{accent:i=4}=t;const o=new qd;lt(()=>{o.stop()});const a=()=>{o.toggle(r,i)};return e.$$set=s=>{"tempo"in s&&n(0,r=s.tempo),"accent"in s&&n(1,i=s.accent)},[r,i,o,a]}class Xu extends He{constructor(t){super(),ze(this,t,MB,wB,qe,{tempo:0,accent:1})}}function SB(e){let t,n,r,i,o,a;return{c(){t=C("label"),n=q(e[2]),r=O(),i=C("input"),k(i,"type","number"),k(i,"step","5"),k(i,"min","10"),k(i,"max","400"),St(i,"width","55px"),k(t,"title",e[3])},m(s,l){fe(s,t,l),m(t,n),m(t,r),m(t,i),be(i,e[0]),o||(a=[ne(i,"input",e[4]),ne(i,"change",function(){vo(e[1])&&e[1].apply(this,arguments)})],o=!0)},p(s,[l]){e=s,l&4&&he(n,e[2]),l&1&&Ne(i.value)!==e[0]&&be(i,e[0]),l&8&&k(t,"title",e[3])},i:ge,o:ge,d(s){s&&ce(t),o=!1,Ve(a)}}}function EB(e,t,n){let{value:r}=t,{callback:i=()=>{}}=t,{label:o="tempo"}=t,{title:a="The tempo in beats per minute (bpm)"}=t;function s(){r=Ne(this.value),n(0,r)}return e.$$set=l=>{"value"in l&&n(0,r=l.value),"callback"in l&&n(1,i=l.callback),"label"in l&&n(2,o=l.label),"title"in l&&n(3,a=l.title)},[r,i,o,a,s]}class Hr extends He{constructor(t){super(),ze(this,t,EB,SB,qe,{value:0,callback:1,label:2,title:3})}}function AB(e,t){return t instanceof Map?{dataType:"Map",value:Array.from(t.entries())}:t}function CB(e,t){return typeof t=="object"&&t!==null&&t.dataType==="Map"?new Map(t.value):t}async function ln(e){const n=await e.target.files[0].text();return JSON.parse(n,CB)}function un(e,t){t._demoId=e,t._date=new Date().toISOString();const n=JSON.stringify(t,AB,2),r=new Blob([n],{type:"text/plain;charset=utf-8"});Zy(r,`${e}.json`)}function PB(e){let t,n,r;return{c(){t=C("button"),t.textContent="reset",k(t,"title","Clear all played notes")},m(i,o){fe(i,t,o),n||(r=ne(t,"click",e[2]),n=!0)},p:ge,i:ge,o:ge,d(i){i&&ce(t),n=!1,r()}}}function xB(e,t,n){let{notes:r=[]}=t,{callback:i=()=>{}}=t;const o=()=>{confirm("Reset played notes?")&&(n(0,r=[]),i())};return e.$$set=a=>{"notes"in a&&n(0,r=a.notes),"callback"in a&&n(1,i=a.callback)},[r,i,o]}class Sn extends He{constructor(t){super(),ze(this,t,xB,PB,qe,{notes:0,callback:1})}}function NB(e,t,n){const r=e.slice();return r[27]=t[n],r}function cp(e,t,n){const r=e.slice();return r[27]=t[n],r}function fp(e){let t,n=e[27]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[27],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function TB(e){let t;return{c(){t=C("option"),t.textContent=`1/${e[27]} note`,t.__value=e[27],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function IB(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S,P,I,$,D,A,F,L,X,U=e[8]?"area":"bars",z,G,R,Y,re,Q,J,K,ee,j,V,te,B,se,Z,ie,le;function ve(de){e[14](de)}let we={callback:e[11]};e[3]!==void 0&&(we.value=e[3]),b=new Hr({props:we}),xe.push(()=>nt(b,"value",ve));let H=Pe(e[10]),ue=[];for(let de=0;de<H.length;de+=1)ue[de]=fp(cp(e,H,de));let ye=Pe([16,32,64,128]),Fe=[];for(let de=0;de<4;de+=1)Fe[de]=TB(NB(e,ye,de));function We(de){e[21](de)}let pe={callback:e[11]};return e[9]!==void 0&&(pe.notes=e[9]),J=new Sn({props:pe}),xe.push(()=>nt(J,"notes",We)),j=new sn({props:{exportFunction:e[12]}}),te=new an({props:{importFunction:e[13]}}),se=new Xu({props:{tempo:e[3],accent:+e[4].split(":")[0]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected), choose
        your tempo and subdivision, and start playing. The bar chart will show you
        how often you hit each time bin and the last `),f=q(e[7]),h=q(` notes will be
        shown as ticks that fade out one new notes come in (from red for new to blue
        for old). You can play freely, use the integrated metronome, or play a song
        in the background (in another tab). All notes will be timed relative to the
        first one, but you can adjust all notes to make them earlier or later in
        case you messed up the first one.`),d=O(),p=C("div"),Ae(b.$$.fragment),_=O(),v=C("label"),M=q(`grid
            `),g=C("select");for(let de=0;de<ue.length;de+=1)ue[de].c();w=O(),E=C("label"),N=q(`binning
            `),x=C("select");for(let de=0;de<4;de+=1)Fe[de].c();T=O(),S=C("label"),P=q(`adjust
            `),I=C("input"),$=O(),D=C("label"),A=q(`note ticks
            `),F=C("input"),L=O(),X=C("button"),z=q(U),G=O(),R=C("div"),Y=C("canvas"),re=O(),Q=C("div"),Ae(J.$$.fragment),ee=O(),Ae(j.$$.fragment),V=O(),Ae(te.$$.fragment),B=O(),Ae(se.$$.fragment),k(a,"class","explanation"),e[4]===void 0&&at(()=>e[15].call(g)),k(v,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[5]===void 0&&at(()=>e[16].call(x)),k(E,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),k(I,"type","number"),k(I,"step","0.01"),k(I,"min","-2"),k(I,"max","2"),St(I,"width","55px"),k(S,"title","Shift all notes by an amount in seconds"),k(F,"type","number"),k(F,"step","1"),k(F,"min","0"),k(F,"max","100"),St(F,"width","55px"),k(D,"title","The number of most recent notes that are shown as ticks."),k(X,"title","Toggle between bars and area"),k(p,"class","control"),St(Y,"width",Jo+"px"),St(Y,"height",dh+"px"),k(R,"class","visualization"),k(Q,"class","control"),k(t,"class","demo")},m(de,Oe){fe(de,t,Oe),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(a,f),m(a,h),m(t,d),m(t,p),Se(b,p,null),m(p,_),m(p,v),m(v,M),m(v,g);for(let Re=0;Re<ue.length;Re+=1)ue[Re]&&ue[Re].m(g,null);$e(g,e[4],!0),m(p,w),m(p,E),m(E,N),m(E,x);for(let Re=0;Re<4;Re+=1)Fe[Re]&&Fe[Re].m(x,null);$e(x,e[5],!0),m(p,T),m(p,S),m(S,P),m(S,I),be(I,e[6]),m(p,$),m(p,D),m(D,A),m(D,F),be(F,e[7]),m(p,L),m(p,X),m(X,z),m(t,G),m(t,R),m(R,Y),e[20](Y),m(t,re),m(t,Q),Se(J,Q,null),m(Q,ee),Se(j,Q,null),m(Q,V),Se(te,Q,null),m(Q,B),Se(se,Q,null),Z=!0,ie||(le=[ne(g,"change",e[15]),ne(g,"change",e[11]),ne(x,"change",e[16]),ne(x,"change",e[11]),ne(I,"input",e[17]),ne(I,"change",e[11]),ne(F,"input",e[18]),ne(F,"change",e[11]),ne(X,"click",e[19])],ie=!0)},p(de,Oe){(!Z||Oe[0]&1)&&r!==(r=de[0].title+"")&&he(i,r),(!Z||Oe[0]&4)&&l!==(l=de[2].length+"")&&he(u,l),(!Z||Oe[0]&128)&&he(f,de[7]);const Re={};if(!y&&Oe[0]&8&&(y=!0,Re.value=de[3],tt(()=>y=!1)),b.$set(Re),Oe[0]&1024){H=Pe(de[10]);let _t;for(_t=0;_t<H.length;_t+=1){const zn=cp(de,H,_t);ue[_t]?ue[_t].p(zn,Oe):(ue[_t]=fp(zn),ue[_t].c(),ue[_t].m(g,null))}for(;_t<ue.length;_t+=1)ue[_t].d(1);ue.length=H.length}Oe[0]&1040&&$e(g,de[4]),Oe[0]&32&&$e(x,de[5]),Oe[0]&64&&Ne(I.value)!==de[6]&&be(I,de[6]),Oe[0]&128&&Ne(F.value)!==de[7]&&be(F,de[7]),(!Z||Oe[0]&256)&&U!==(U=de[8]?"area":"bars")&&he(z,U);const fn={};!K&&Oe[0]&512&&(K=!0,fn.notes=de[9],tt(()=>K=!1)),J.$set(fn);const En={};Oe[0]&8&&(En.tempo=de[3]),Oe[0]&16&&(En.accent=+de[4].split(":")[0]),se.$set(En)},i(de){Z||(_e(b.$$.fragment,de),_e(J.$$.fragment,de),_e(j.$$.fragment,de),_e(te.$$.fragment,de),_e(se.$$.fragment,de),Z=!0)},o(de){Me(b.$$.fragment,de),Me(J.$$.fragment,de),Me(j.$$.fragment,de),Me(te.$$.fragment,de),Me(se.$$.fragment,de),Z=!1},d(de){de&&ce(t),Ee(b),Ue(ue,de),Ue(Fe,de),e[20](null),Ee(J),Ee(j),Ee(te),Ee(se),ie=!1,Ve(le)}}}let Jo=1e3,dh=1e3;function kB(e,t,n){let{demoInfo:r}=t;const i=["4:2","4:3","4:4","4:5","3:2","3:3","3:4","3:5","2:2","2:3","2:4","2:5"],o=Math.PI*2;let a,s=[],l=120,u=i[0],c=64,f=0,h=1,d=!1,p=0,b=[];const y=()=>{n(2,s=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((D,A)=>{console.log(`MIDI device ${A}: ${D.name}`),D.addListener("noteon",_),D.addListener("controlchange",v)}),n(2,s=[...W.inputs]))},_=D=>{b.length===0&&(p=D.timestamp);const A=(D.timestamp-p)/1e3;b.push(A),M()},v=D=>{n(6,f=(Pu(D.rawValue,0,100)-50)/100),M()},M=()=>{const D=Jo/2,A=dh/2,F=Jo*.4,L=F*.8,X=F*.9,U=F*1.1,z=F*.95,G=Math.PI/2,R=a.getContext("2d"),Y=window.devicePixelRatio,re=a.getBoundingClientRect();n(1,a.width=re.width*Y,a),n(1,a.height=re.height*Y,a),R.scale(Y,Y),n(1,a.style.width=`${re.width}px`,a),n(1,a.style.height=`${re.height}px`,a),R.clearRect(0,0,Jo,dh);const[Q,J]=u.split(":").map(Z=>+Z),K=Lt(l)*Q,ee=b.map(Z=>Z+f),V=ee.map(Z=>Z%K).map(Z=>Z/K*o),te=Jo*.08;if(!d){const Z=c*Q/4;R.fillStyle="#f8f8f8",R.strokeStyle="#aaa";const le=mb().domain([0,o]).thresholds(Ce(Z).map(we=>we/Z*o))(V),ve=ot(le,we=>we.length);for(const we of le){if(we.length===0)continue;const H=we.length/ve*te,ue=F+H,ye=we.x0-G,Fe=Math.cos(ye),We=Math.sin(ye),pe=we.x1-G,de=Math.cos(pe),Oe=Math.sin(pe);R.beginPath(),R.moveTo(D+Fe*F,A+We*F),R.lineTo(D+Fe*ue,A+We*ue),R.arc(D,A,ue,ye,pe),R.lineTo(D+de*F,A+Oe*F),R.closePath(),R.fill(),R.stroke()}}if(d&&V.length>0){let Z=4/c;const we=y3(V,{bandwidth:Z,pad:.1,bins:360}).bandwidth(Z),H=ot([...we],ye=>ye.y);console.log([...we]),R.beginPath();let ue=0;for(const ye of we){console.log(ue++,ye);const Fe=ye.x-G,We=F+ye.y/H*te,pe=Math.cos(Fe),de=Math.sin(Fe);R.lineTo(D+pe*We,A+de*We)}R.closePath(),R.fillStyle="#e4f0fa",R.fill(),R.strokeStyle="#aaa",R.stroke()}if(h>0){R.lineWidth=3;const Z=le=>Sa(1-le),ie=ee.slice(-h);for(const[le,ve]of ie.entries()){const we=ve/K*o-G,H=Math.cos(we),ue=Math.sin(we);R.strokeStyle=Z(le/ie.length),R.beginPath(),R.moveTo(D+H*F,A+ue*F),R.lineTo(D+H*U,A+ue*U),R.stroke()}}R.strokeStyle="#aaa",R.fillStyle="white",fh(R,D,A,F),R.lineWidth=2,R.fill(),R.stroke();const B=Ce(Q).map(Z=>o/Q*Z-G),se=Ce(Q*J).map(Z=>o/(Q*J)*Z-G);R.beginPath(),R.lineWidth=2;for(const Z of B){const ie=Math.cos(Z),le=Math.sin(Z);R.moveTo(D+ie*L,A+le*L),R.lineTo(D+ie*z,A+le*z)}R.stroke(),R.lineWidth=1,R.beginPath();for(const Z of se){const ie=Math.cos(Z),le=Math.sin(Z);R.moveTo(D+ie*X,A+le*X),R.lineTo(D+ie*z,A+le*z)}R.stroke()},g=()=>{const D={tempo:l,grid:u,binNote:c,adjustTime:f,noteTickLimit:h,showKde:d,noteOnTimes:b};un(r.id,D)},w=async D=>{if(b.length===0||confirm("Import data and overwrite currently unsaved data?")){const A=await ln(D);n(3,l=A.tempo),n(4,u=A.grid),n(5,c=A.binNote),n(6,f=A.adjustTime),n(7,h=A.noteTickLimit),n(9,b=A.noteOnTimes),n(8,d=A.showKde??!1),M()}};st(()=>{W.enable().then(y).catch(D=>alert(D)),M()}),lt(()=>{for(const D of W.inputs)D.removeListener()});function E(D){l=D,n(3,l)}function N(){u=pt(this),n(4,u),n(10,i)}function x(){c=pt(this),n(5,c)}function T(){f=Ne(this.value),n(6,f)}function S(){h=Ne(this.value),n(7,h)}const P=()=>{n(8,d=!d),M()};function I(D){xe[D?"unshift":"push"](()=>{a=D,n(1,a)})}function $(D){b=D,n(9,b)}return e.$$set=D=>{"demoInfo"in D&&n(0,r=D.demoInfo)},[r,a,s,l,u,c,f,h,d,b,i,M,g,w,E,N,x,T,S,P,I,$]}class $B extends He{constructor(t){super(),ze(this,t,kB,IB,qe,{demoInfo:0},null,[-1,-1])}}function DB(e,t,n){const r=e.slice();return r[22]=t[n],r}function FB(e,t,n){const r=e.slice();return r[22]=t[n],r}function BB(e){let t;return{c(){t=C("option"),t.textContent=`1/${e[22]} note`,t.__value=e[22],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function RB(e){let t;return{c(){t=C("option"),t.textContent=`1/${e[22]} note`,t.__value=e[22],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function hp(e){let t,n,r=e[8].toFixed(1)+"",i,o;return{c(){t=C("div"),n=q("estimated: "),i=q(r),o=q(" bpm"),k(t,"class","svelte-1ruiyqw")},m(a,s){fe(a,t,s),m(t,n),m(t,i),m(t,o)},p(a,s){s&256&&r!==(r=a[8].toFixed(1)+"")&&he(i,r)},d(a){a&&ce(t)}}}function LB(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S,P,I,$,D,A,F,L,X,U,z,G,R,Y,re,Q,J,K,ee,j,V,te,B=Pe([16,32,64,128]),se=[];for(let H=0;H<4;H+=1)se[H]=BB(FB(e,B,H));let Z=Pe([16,32,64,128]),ie=[];for(let H=0;H<4;H+=1)ie[H]=RB(DB(e,Z,H));let le=e[8]&&hp(e);function ve(H){e[18](H)}let we={callback:e[9]};return e[7]!==void 0&&(we.notes=e[7]),Y=new Sn({props:we}),xe.push(()=>nt(Y,"notes",ve)),J=new sn({props:{exportFunction:e[10]}}),ee=new an({props:{importFunction:e[11]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected), choose
        your tempo, and start playing. The time between two note onsets will be shown
        as a bar, so you can see how well you still hit, for example, quarter notes
        after playing for some time. Bar heights are either exact or rounded to the
        closest, for example, 64th note (binning dropdown). You can filter very short
        inter-note times, which happen whan playing two notes at roughly the same
        time as in a chord.`),f=O(),h=C("p"),h.textContent=`One possible exercise is trying to play at a given tempo without any
        count in. You can use the randomize tempo button () to get challenged.`,d=O(),p=C("div"),b=C("label"),y=q(`tempo
            `),_=C("input"),v=O(),M=C("button"),M.textContent="",g=O(),w=C("label"),E=q(`binning
            `),N=C("select"),x=C("option"),x.textContent="off";for(let H=0;H<4;H+=1)se[H].c();T=O(),S=C("label"),P=q(`filtering
            `),I=C("select"),$=C("option"),$.textContent="off";for(let H=0;H<4;H+=1)ie[H].c();D=O(),A=C("label"),F=q(`bars
            `),L=C("input"),X=O(),U=C("div"),z=O(),le&&le.c(),G=O(),R=C("div"),Ae(Y.$$.fragment),Q=O(),Ae(J.$$.fragment),K=O(),Ae(ee.$$.fragment),k(a,"class","explanation"),k(h,"class","explanation"),k(_,"type","number"),k(_,"step","1"),k(_,"min","10"),k(_,"max","400"),St(_,"width","55px"),k(b,"title","The tempo in beats per minute (bpm)"),k(M,"title","randomize tempo"),x.__value=0,be(x,x.__value),e[4]===void 0&&at(()=>e[14].call(N)),k(w,"title","You can change between seeing exact bar heights and binned (rounded) heights."),$.__value=0,be($,$.__value),e[5]===void 0&&at(()=>e[15].call(I)),k(S,"title","You can filter out bars that are shorter than a given note duration."),k(L,"type","number"),k(L,"step","25"),k(L,"min","25"),k(L,"max","1000"),St(L,"width","55px"),k(A,"title","The number of most recent notes that are shown as bars."),k(p,"class","control svelte-1ruiyqw"),k(U,"class","visualization svelte-1ruiyqw"),k(R,"class","control svelte-1ruiyqw"),k(t,"class","demo")},m(H,ue){fe(H,t,ue),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(t,f),m(t,h),m(t,d),m(t,p),m(p,b),m(b,y),m(b,_),be(_,e[3]),m(p,v),m(p,M),m(p,g),m(p,w),m(w,E),m(w,N),m(N,x);for(let ye=0;ye<4;ye+=1)se[ye]&&se[ye].m(N,null);$e(N,e[4],!0),m(p,T),m(p,S),m(S,P),m(S,I),m(I,$);for(let ye=0;ye<4;ye+=1)ie[ye]&&ie[ye].m(I,null);$e(I,e[5],!0),m(p,D),m(p,A),m(A,F),m(A,L),be(L,e[6]),m(t,X),m(t,U),e[17](U),m(t,z),le&&le.m(t,null),m(t,G),m(t,R),Se(Y,R,null),m(R,Q),Se(J,R,null),m(R,K),Se(ee,R,null),j=!0,V||(te=[ne(_,"input",e[12]),ne(_,"change",e[9]),ne(M,"click",e[13]),ne(N,"change",e[14]),ne(N,"change",e[9]),ne(I,"change",e[15]),ne(I,"change",e[9]),ne(L,"input",e[16]),ne(L,"change",e[9])],V=!0)},p(H,[ue]){(!j||ue&1)&&r!==(r=H[0].title+"")&&he(i,r),(!j||ue&4)&&l!==(l=H[2].length+"")&&he(u,l),ue&8&&Ne(_.value)!==H[3]&&be(_,H[3]),ue&16&&$e(N,H[4]),ue&32&&$e(I,H[5]),ue&64&&Ne(L.value)!==H[6]&&be(L,H[6]),H[8]?le?le.p(H,ue):(le=hp(H),le.c(),le.m(t,G)):le&&(le.d(1),le=null);const ye={};!re&&ue&128&&(re=!0,ye.notes=H[7],tt(()=>re=!1)),Y.$set(ye)},i(H){j||(_e(Y.$$.fragment,H),_e(J.$$.fragment,H),_e(ee.$$.fragment,H),j=!0)},o(H){Me(Y.$$.fragment,H),Me(J.$$.fragment,H),Me(ee.$$.fragment,H),j=!1},d(H){H&&ce(t),Ue(se,H),Ue(ie,H),e[17](null),le&&le.d(),Ee(Y),Ee(J),Ee(ee),V=!1,Ve(te)}}}let OB=1e3,GB=750;function UB(e,t,n){let{demoInfo:r}=t,i,o=[],a=120,s=64,l=0,u=50,c=0,f=[],h=0;const d=()=>{n(2,o=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((T,S)=>{console.log(`MIDI device ${S}: ${T.name}`),T.addListener("noteon",p)}),n(2,o=[...W.inputs]))},p=T=>{f.length===0&&(c=T.timestamp);const S=(T.timestamp-c)/1e3;f.push(S),b()},b=()=>{const T=Lt(a),S=T/4,P=T/2,I=T*2,$=T*4,A=[0,T/3,S,P,P*1.5,T,T*1.5,I,I*1.5],F=["0","","","",".","",".","","."];let L=f.map((G,R)=>R===0?0:G-f[R-1]);if(l!==0){const G=$/l;L=L.filter(R=>R>=G)}let X=L;if(s!==0){const G=$/s;X=L.map(R=>Math.round(R/G)*G)}const U=et({width:OB,height:GB,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:A,tickFormat:G=>{const R=A.indexOf(G);return F[R]},domain:[0,I*1.1],tickSize:0},marks:[po(X.slice(-u),{x:(G,R)=>R,y:G=>G,fill:"#ddd",inset:0,dx:.5}),Nt(A,{stroke:"#aaa"})]});n(1,i.textContent="",i),i.appendChild(U);const z=L.filter(G=>G>.8*S&&G<1.25*T).slice(-24).map(G=>G<.6*T?G*2:G>1.5*T?G/2:G);n(8,h=tE(yb(z)))},y=()=>{const T={tempo:a,binNote:s,filterNote:l,barLimit:u,noteOnTimes:f};un(r.id,T)},_=async T=>{if(f.length===0||confirm("Import data and overwrite currently unsaved data?")){const S=await ln(T);n(3,a=S.tempo),n(4,s=S.binNote),n(5,l=S.filterNote),n(6,u=S.barLimit),n(7,f=S.noteOnTimes),b()}};st(()=>{W.enable().then(d).catch(T=>alert(T)),b()}),lt(()=>{for(const T of W.inputs)T.removeListener()});function v(){a=Ne(this.value),n(3,a)}const M=()=>{let T=a;for(;T===a;)T=Math.round(Math.random()*24+12)*5;n(3,a=T)};function g(){s=pt(this),n(4,s)}function w(){l=pt(this),n(5,l)}function E(){u=Ne(this.value),n(6,u)}function N(T){xe[T?"unshift":"push"](()=>{i=T,n(1,i)})}function x(T){f=T,n(7,f)}return e.$$set=T=>{"demoInfo"in T&&n(0,r=T.demoInfo)},[r,i,o,a,s,l,u,f,h,b,y,_,v,M,g,w,E,N,x]}class qB extends He{constructor(t){super(),ze(this,t,UB,LB,qe,{demoInfo:0})}}function zB(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b,y,_=(e[3]?ft:ht)+"",v,M,g,w,E,N,x,T,S,P,I,$,D,A,F,L,X,U;function z(R){e[12](R)}let G={callback:e[6]};return e[5]!==void 0&&(G.notes=e[5]),P=new Sn({props:G}),xe.push(()=>nt(P,"notes",z)),D=new sn({props:{exportFunction:e[7]}}),F=new an({props:{importFunction:e[8]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected) and
        start playing. The loudness of each note will be shown as a bar. Bar heights
        are either exact or rounded to the
        `),f=C("a"),f.textContent="closest rough dynamics",h=q(", for example a forte."),d=O(),p=C("div"),b=C("button"),y=q("binning "),v=q(_),M=O(),g=C("label"),w=q(`bars
            `),E=C("input"),N=O(),x=C("div"),T=O(),S=C("div"),Ae(P.$$.fragment),$=O(),Ae(D.$$.fragment),A=O(),Ae(F.$$.fragment),k(f,"href","https://en.wikipedia.org/wiki/Dynamics_(music)"),k(a,"class","explanation"),k(b,"title","You can change between seeing exact bar heights and binned (rounded) heights."),k(E,"type","number"),k(E,"step","25"),k(E,"min","25"),k(E,"max","1000"),St(E,"width","55px"),k(g,"title","The number of most recent notes that are shown as bars."),k(p,"class","control svelte-1p166uy"),k(x,"class","visualization svelte-1p166uy"),k(S,"class","control svelte-1p166uy"),k(t,"class","demo")},m(R,Y){fe(R,t,Y),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(a,f),m(a,h),m(t,d),m(t,p),m(p,b),m(b,y),m(b,v),m(p,M),m(p,g),m(g,w),m(g,E),be(E,e[4]),m(t,N),m(t,x),e[11](x),m(t,T),m(t,S),Se(P,S,null),m(S,$),Se(D,S,null),m(S,A),Se(F,S,null),L=!0,X||(U=[ne(b,"click",e[9]),ne(E,"input",e[10]),ne(E,"change",e[6])],X=!0)},p(R,[Y]){(!L||Y&1)&&r!==(r=R[0].title+"")&&he(i,r),(!L||Y&4)&&l!==(l=R[2].length+"")&&he(u,l),(!L||Y&8)&&_!==(_=(R[3]?ft:ht)+"")&&he(v,_),Y&16&&Ne(E.value)!==R[4]&&be(E,R[4]);const re={};!I&&Y&32&&(I=!0,re.notes=R[5],tt(()=>I=!1)),P.$set(re)},i(R){L||(_e(P.$$.fragment,R),_e(D.$$.fragment,R),_e(F.$$.fragment,R),L=!0)},o(R){Me(P.$$.fragment,R),Me(D.$$.fragment,R),Me(F.$$.fragment,R),L=!1},d(R){R&&ce(t),e[11](null),Ee(P),Ee(D),Ee(F),X=!1,Ve(U)}}}let HB=1e3,VB=600;function YB(e,t,n){let{demoInfo:r}=t,i,o=[];const s=new Map([[0,"silent"],[16,"ppp"],[32,"pp"],[48,"p"],[64,"mp"],[80,"mf"],[96,"f"],[112,"ff"],[127,"fff"]]);let l=!0,u=50,c=[];const f=()=>{console.log("MIDI enabled"),n(2,o=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((g,w)=>{console.log(`MIDI device ${w}: ${g.name}`),g.addListener("noteon",h)}),n(2,o=[...W.inputs]))},h=g=>{c.push(g.rawVelocity),d()},d=()=>{console.log("draw");let g=c;l&&(g=c.map(N=>{for(const x of s.keys())if(N<=x)return x}));const w=[...s.keys()],E=et({width:HB,height:VB,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:w,tickFormat:N=>s.get(N),domain:[0,128],tickSize:0},marks:[po(g.slice(-u),{x:(N,x)=>x,y:N=>N,fill:"#ddd",inset:0,dx:.5}),Nt(w,{stroke:"#888"})]});n(1,i.textContent="",i),i.appendChild(E)},p=()=>{const g={isBinning:l,barLimit:u,noteVelocities:c};un(r.id,g)},b=async g=>{if(c.length===0||confirm("Import data and overwrite currently unsaved data?")){const w=await ln(g);n(3,l=w.isBinning),n(4,u=w.barLimit),n(5,c=w.noteVelocities),d()}};st(()=>{W.enable().then(f).catch(g=>alert(g)),d()}),lt(()=>{for(const g of W.inputs)g.removeListener()});const y=()=>{n(3,l=!l),d()};function _(){u=Ne(this.value),n(4,u)}function v(g){xe[g?"unshift":"push"](()=>{i=g,n(1,i)})}function M(g){c=g,n(5,c)}return e.$$set=g=>{"demoInfo"in g&&n(0,r=g.demoInfo)},[r,i,o,l,u,c,d,p,b,y,_,v,M]}class WB extends He{constructor(t){super(),ze(this,t,YB,zB,qe,{demoInfo:0})}}function jB(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b=(e[3]?ht:ft)+"",y,_,v,M,g=(e[4]?ft:ht)+"",w,E,N,x,T=(e[5]?ft:ht)+"",S,P,I,$,D,A,F,L,X,U,z,G,R,Y;function re(J){e[14](J)}let Q={callback:e[7]};return e[6]!==void 0&&(Q.notes=e[6]),A=new Sn({props:Q}),xe.push(()=>nt(A,"notes",re)),X=new sn({props:{exportFunction:e[8]}}),z=new an({props:{importFunction:e[9]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected) and
        start playing. The bar chart below shows how often you played each interval:
        when you go up in pitch, the bar of the played interval in the top half will
        increase. If you go down, it will show up in the bottom half. Colors denote
        the type of interval, so you can quickly see if you play, for example, more
        major or minor intervals.`),f=O(),h=C("div"),d=C("button"),p=q("unison "),y=q(b),_=O(),v=C("button"),M=q("colors "),w=q(g),E=O(),N=C("button"),x=q("semitones "),S=q(T),P=O(),I=C("div"),$=O(),D=C("div"),Ae(A.$$.fragment),L=O(),Ae(X.$$.fragment),U=O(),Ae(z.$$.fragment),k(a,"class","explanation"),k(d,"title","Toggle filtering unison intervals"),k(v,"title","Use colors for interval types"),k(N,"title","Show number of semitones instead of musical names for intervals on the y axis"),k(h,"class","control svelte-13613lz"),k(I,"class","visualization svelte-13613lz"),k(D,"class","control svelte-13613lz"),k(t,"class","demo")},m(J,K){fe(J,t,K),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(t,f),m(t,h),m(h,d),m(d,p),m(d,y),m(h,_),m(h,v),m(v,M),m(v,w),m(h,E),m(h,N),m(N,x),m(N,S),m(t,P),m(t,I),e[13](I),m(t,$),m(t,D),Se(A,D,null),m(D,L),Se(X,D,null),m(D,U),Se(z,D,null),G=!0,R||(Y=[ne(d,"click",e[10]),ne(v,"click",e[11]),ne(N,"click",e[12])],R=!0)},p(J,[K]){(!G||K&1)&&r!==(r=J[0].title+"")&&he(i,r),(!G||K&4)&&l!==(l=J[2].length+"")&&he(u,l),(!G||K&8)&&b!==(b=(J[3]?ht:ft)+"")&&he(y,b),(!G||K&16)&&g!==(g=(J[4]?ft:ht)+"")&&he(w,g),(!G||K&32)&&T!==(T=(J[5]?ft:ht)+"")&&he(S,T);const ee={};!F&&K&64&&(F=!0,ee.notes=J[6],tt(()=>F=!1)),A.$set(ee)},i(J){G||(_e(A.$$.fragment,J),_e(X.$$.fragment,J),_e(z.$$.fragment,J),G=!0)},o(J){Me(A.$$.fragment,J),Me(X.$$.fragment,J),Me(z.$$.fragment,J),G=!1},d(J){J&&ce(t),e[13](null),Ee(A),Ee(X),Ee(z),R=!1,Ve(Y)}}}let XB=1e3,KB=650;function ZB(e,t,n){let{demoInfo:r}=t,i,o=[],a=!0,s=!1,l=!1,u=[];const c=[{semitones:0,name:"Unison",short:"P1",type:"perfect"},{semitones:1,name:"Minor 2nd",short:"m2",type:"minor"},{semitones:2,name:"Major 2nd",short:"M2",type:"major"},{semitones:3,name:"Minor 3rd",short:"m3",type:"minor"},{semitones:4,name:"Major 3rd",short:"M3",type:"major"},{semitones:5,name:"Perfect 4th",short:"P4",type:"perfect"},{semitones:6,name:"Augmented 4th",short:"A4",type:"tritone"},{semitones:7,name:"Perfect 5th",short:"P5",type:"perfect"},{semitones:8,name:"Minor 6th",short:"m6",type:"minor"},{semitones:9,name:"Major 6th",short:"M6",type:"major"},{semitones:10,name:"Minor 7th",short:"m7",type:"minor"},{semitones:11,name:"Major 7th",short:"M7",type:"major"},{semitones:12,name:"Perfect 8ve",short:"P8",type:"perfect"}],f=()=>{n(2,o=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((w,E)=>{console.log(`MIDI device ${E}: ${w.name}`),w.addListener("noteon",h)}),n(2,o=[...W.inputs]))},h=w=>{const E={number:w.note.number,velocity:w.rawVelocity,time:w.timestamp};u.push(E),d()},d=()=>{let w=u.map((x,T)=>T===0?0:x.number-u[T-1].number);a&&(w=w.filter(x=>x!==0)),w=w.map(x=>{if(Math.abs(x)<=12)return x;{const T=x>0?12:-12;for(;Math.abs(x)>12;)x-=T;return x}});const E=da(w,x=>x).map(([x,T])=>({interval:x,count:T.length})),N=et({width:XB,height:KB,marginLeft:120,marginRight:10,color:{legend:s,domain:["minor","major","perfect","tritone"],range:["#7da2e8","#ed796a","gold","#ccc"]},x:{},y:{tickFormat:l?x=>x:x=>x>=0?c[x].name:c[-x].name,domain:Ce(-12,13,1),label:` going down ${" ".repeat(75)} going up      `,reverse:!0},marks:[Nt([-12,0,12],{stroke:"#888",strokeWidth:1.5}),ds(E,{x:"count",y:"interval",fill:s?x=>c[Math.abs(x.interval)].type:"#ddd",dx:.5,rx:4})]});n(1,i.textContent="",i),i.appendChild(N)},p=()=>{const w={filterUnison:a,useColors:s,useSemitones:l,notes:u};un(r.id,w)},b=async w=>{if(u.length===0||confirm("Import data and overwrite currently unsaved data?")){const E=await ln(w);n(3,a=E.filterUnison),n(4,s=E.useColors),n(5,l=E.useSemitones),n(6,u=E.notes),d()}};st(()=>{W.enable().then(f).catch(w=>alert(w)),d()}),lt(()=>{for(const w of W.inputs)w.removeListener()});const y=()=>{n(3,a=!a),d()},_=()=>{n(4,s=!s),d()},v=()=>{n(5,l=!l),d()};function M(w){xe[w?"unshift":"push"](()=>{i=w,n(1,i)})}function g(w){u=w,n(6,u)}return e.$$set=w=>{"demoInfo"in w&&n(0,r=w.demoInfo)},[r,i,o,a,s,l,u,d,p,b,y,_,v,M,g]}class QB extends He{constructor(t){super(),ze(this,t,ZB,jB,qe,{demoInfo:0})}}function dp(e,t,n){const r=e.slice();return r[21]=t[n],r}function mp(e,t,n){const r=e.slice();return r[24]=t[n],r}function pp(e){let t,n=e[24]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[24],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function bp(e){let t,n=e[21]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[21],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function JB(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b,y,_,v,M,g,w,E=(e[5]?ft:ht)+"",N,x,T,S,P=(e[6]?ft:ht)+"",I,$,D,A,F,L,X,U,z,G,R,Y,re,Q,J=Pe(e[8]),K=[];for(let B=0;B<J.length;B+=1)K[B]=pp(mp(e,J,B));let ee=Pe(e[9]),j=[];for(let B=0;B<ee.length;B+=1)j[B]=bp(dp(e,ee,B));function V(B){e[18](B)}let te={callback:e[10]};return e[7]!==void 0&&(te.notes=e[7]),L=new Sn({props:te}),xe.push(()=>nt(L,"notes",V)),z=new sn({props:{exportFunction:e[11]}}),R=new an({props:{importFunction:e[12]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected) and
        start playing. The bar chart below shows how often you played each scale
        degree.`),f=O(),h=C("div"),d=C("label"),p=q(`scale
            `),b=C("select");for(let B=0;B<K.length;B+=1)K[B].c();y=O(),_=C("select");for(let B=0;B<j.length;B+=1)j[B].c();v=O(),M=C("div"),g=C("button"),w=q("colors "),N=q(E),x=O(),T=C("button"),S=q("non-scale notes "),I=q(P),$=O(),D=C("div"),A=O(),F=C("div"),Ae(L.$$.fragment),U=O(),Ae(z.$$.fragment),G=O(),Ae(R.$$.fragment),k(a,"class","explanation"),e[3]===void 0&&at(()=>e[13].call(b)),e[4]===void 0&&at(()=>e[14].call(_)),k(h,"class","control svelte-13613lz"),k(g,"title","Use colors for root, in-scale, outside-scale"),k(T,"title","Show notes outside the scale"),k(M,"class","control svelte-13613lz"),k(D,"class","visualization svelte-13613lz"),k(F,"class","control svelte-13613lz"),k(t,"class","demo")},m(B,se){fe(B,t,se),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(t,f),m(t,h),m(h,d),m(d,p),m(d,b);for(let Z=0;Z<K.length;Z+=1)K[Z]&&K[Z].m(b,null);$e(b,e[3],!0),m(d,y),m(d,_);for(let Z=0;Z<j.length;Z+=1)j[Z]&&j[Z].m(_,null);$e(_,e[4],!0),m(t,v),m(t,M),m(M,g),m(g,w),m(g,N),m(M,x),m(M,T),m(T,S),m(T,I),m(t,$),m(t,D),e[17](D),m(t,A),m(t,F),Se(L,F,null),m(F,U),Se(z,F,null),m(F,G),Se(R,F,null),Y=!0,re||(Q=[ne(b,"change",e[13]),ne(b,"change",e[10]),ne(_,"change",e[14]),ne(_,"change",e[10]),ne(g,"click",e[15]),ne(T,"click",e[16])],re=!0)},p(B,[se]){if((!Y||se&1)&&r!==(r=B[0].title+"")&&he(i,r),(!Y||se&4)&&l!==(l=B[2].length+"")&&he(u,l),se&256){J=Pe(B[8]);let ie;for(ie=0;ie<J.length;ie+=1){const le=mp(B,J,ie);K[ie]?K[ie].p(le,se):(K[ie]=pp(le),K[ie].c(),K[ie].m(b,null))}for(;ie<K.length;ie+=1)K[ie].d(1);K.length=J.length}if(se&264&&$e(b,B[3]),se&512){ee=Pe(B[9]);let ie;for(ie=0;ie<ee.length;ie+=1){const le=dp(B,ee,ie);j[ie]?j[ie].p(le,se):(j[ie]=bp(le),j[ie].c(),j[ie].m(_,null))}for(;ie<j.length;ie+=1)j[ie].d(1);j.length=ee.length}se&528&&$e(_,B[4]),(!Y||se&32)&&E!==(E=(B[5]?ft:ht)+"")&&he(N,E),(!Y||se&64)&&P!==(P=(B[6]?ft:ht)+"")&&he(I,P);const Z={};!X&&se&128&&(X=!0,Z.notes=B[7],tt(()=>X=!1)),L.$set(Z)},i(B){Y||(_e(L.$$.fragment,B),_e(z.$$.fragment,B),_e(R.$$.fragment,B),Y=!0)},o(B){Me(L.$$.fragment,B),Me(z.$$.fragment,B),Me(R.$$.fragment,B),Y=!1},d(B){B&&ce(t),Ue(K,B),Ue(j,B),e[17](null),Ee(L),Ee(z),Ee(R),re=!1,Ve(Q)}}}let eR=1e3,tR=650;function nR(e,t,n){let{demoInfo:r}=t,i,o=[],a="A",s="minor pentatonic",l=!0,u=!0,c=[];const f=ms,h=wt.names(),d=()=>{n(2,o=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((x,T)=>{console.log(`MIDI device ${T}: ${x.name}`),x.addListener("noteon",p)}),n(2,o=[...W.inputs]))},p=x=>{const T={number:x.note.number,velocity:x.rawVelocity,time:x.timestamp};c.push(T),b()},b=()=>{if(n(1,i.textContent="",i),c.length===0)return;const x=f.indexOf(a),T=wt.get(`${a} ${s}`),S=T.notes.map((F,L)=>{const X=f.indexOf(F);let U=X-x;return U=U>=0?U:U+12,{name:F,chroma:X,interval:T.intervals[L],degree:L,offset:U}}),P=new Set(S.map(F=>F.offset)),$=c.map(F=>F.number%12).map(F=>{const L=F-x;return L>=0?L:L+12}),D=da($,F=>F).map(([F,L])=>({value:F,count:L.length})),A=et({width:eR,height:tR,marginLeft:70,marginRight:10,color:{legend:l,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:F=>f[(F+x)%12],domain:u?Ce(0,12,1):[...P],reverse:!0,label:"notes, increasing semitones from root "},marks:[ds(D,{x:"count",y:"value",fill:F=>l?F.value===0?"#666":P.has(F.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});i.appendChild(A)},y=()=>{const x={root:a,scale:s,useColors:l,showOutsideScale:u,notes:c};un(r.id,x)},_=async x=>{if(c.length===0||confirm("Import data and overwrite currently unsaved data?")){const T=await ln(x);n(3,a=T.root),n(4,s=T.scale),n(5,l=T.useColors),n(6,u=T.showOutsideScale),n(7,c=T.notes),b()}};st(()=>{W.enable().then(d).catch(x=>alert(x)),b()}),lt(()=>{for(const x of W.inputs)x.removeListener()});function v(){a=pt(this),n(3,a),n(8,f)}function M(){s=pt(this),n(4,s),n(9,h)}const g=()=>{n(5,l=!l),b()},w=()=>{n(6,u=!u),b()};function E(x){xe[x?"unshift":"push"](()=>{i=x,n(1,i)})}function N(x){c=x,n(7,c)}return e.$$set=x=>{"demoInfo"in x&&n(0,r=x.demoInfo)},[r,i,o,a,s,l,u,c,f,h,b,y,_,v,M,g,w,E,N]}class rR extends He{constructor(t){super(),ze(this,t,nR,JB,qe,{demoInfo:0})}}function iR(e){let t,n,r,i,o,a;return{c(){t=C("label"),n=q(e[2]),r=O(),i=C("input"),k(i,"type","number"),k(i,"step","10"),k(i,"min",e[4]),k(i,"max",e[5]),St(i,"width","55px"),k(t,"title",e[3])},m(s,l){fe(s,t,l),m(t,n),m(t,r),m(t,i),be(i,e[0]),o||(a=[ne(i,"input",e[6]),ne(i,"change",function(){vo(e[1])&&e[1].apply(this,arguments)})],o=!0)},p(s,[l]){e=s,l&4&&he(n,e[2]),l&16&&k(i,"min",e[4]),l&32&&k(i,"max",e[5]),l&1&&Ne(i.value)!==e[0]&&be(i,e[0]),l&8&&k(t,"title",e[3])},i:ge,o:ge,d(s){s&&ce(t),o=!1,Ve(a)}}}function oR(e,t,n){let{value:r}=t,{callback:i=()=>{}}=t,{label:o="note count"}=t,{title:a="The number of most recently played notes that are shown"}=t,{min:s=10}=t,{max:l=500}=t;function u(){r=Ne(this.value),n(0,r)}return e.$$set=c=>{"value"in c&&n(0,r=c.value),"callback"in c&&n(1,i=c.callback),"label"in c&&n(2,o=c.label),"title"in c&&n(3,a=c.title),"min"in c&&n(4,s=c.min),"max"in c&&n(5,l=c.max)},[r,i,o,a,s,l,u]}class Ku extends He{constructor(t){super(),ze(this,t,oR,iR,qe,{value:0,callback:1,label:2,title:3,min:4,max:5})}}function aR(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_;function v(E){e[5](E)}let M={callback:e[4]};e[2]!==void 0&&(M.value=e[2]),u=new Ku({props:M}),xe.push(()=>nt(u,"value",v));function g(E){e[7](E)}let w={callback:e[4]};return e[3]!==void 0&&(w.notes=e[3]),b=new Sn({props:w}),xe.push(()=>nt(b,"notes",g)),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Connect a MIDI guitar and start playing. The heatmap below shows how
        often you played each fretboard position.`,s=O(),l=C("div"),Ae(u.$$.fragment),f=O(),h=C("div"),d=O(),p=C("div"),Ae(b.$$.fragment),k(a,"class","explanation"),k(l,"class","control"),k(h,"class","visualization"),k(p,"class","control"),k(t,"class","demo")},m(E,N){fe(E,t,N),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),Se(u,l,null),m(t,f),m(t,h),e[6](h),m(t,d),m(t,p),Se(b,p,null),_=!0},p(E,[N]){(!_||N&1)&&r!==(r=E[0].title+"")&&he(i,r);const x={};!c&&N&4&&(c=!0,x.value=E[2],tt(()=>c=!1)),u.$set(x);const T={};!y&&N&8&&(y=!0,T.notes=E[3],tt(()=>y=!1)),b.$set(T)},i(E){_||(_e(u.$$.fragment,E),_e(b.$$.fragment,E),_=!0)},o(E){Me(u.$$.fragment,E),Me(b.$$.fragment,E),_=!1},d(E){E&&ce(t),Ee(u),e[6](null),Ee(b)}}}let gp=1e3,sR=280,yp=6,Hc=24;function lR(e,t,n){let{demoInfo:r}=t,i=[64,59,55,50,45,40],o,a=200,s=[];const l=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((p,b)=>{console.log(`MIDI device ${b}: ${p.name}`),p.addListener("noteon",u)}),[...W.inputs])},u=p=>{const b=p.message.channel-1,y={number:p.note.number,velocity:p.rawVelocity,time:p.timestamp,channel:p.message.channel,string:b,fret:p.note.number-i[b]};s.push(y),c()},c=()=>{const p=i.map(Ut.fromMidiSharps),b=s.slice(-a),y=(gp-100)/25,_=et({width:gp,height:sR,marginLeft:60,marginBottom:50,padding:0,x:{domain:Ce(0,Hc+1),ticks:Ce(0,Hc+1),tickSize:0},y:{domain:Ce(0,yp),tickFormat:v=>p[v],tickSize:0},color:{legend:!0,marginLeft:100,width:400,scheme:"blues"},marks:[$t(Ce(0,Hc+1),{stroke:"#ddd",dx:y/2}),Nt(Ce(0,yp),{stroke:"#ddd",strokeWidth:v=>Math.sqrt(v+1)}),_n([3,5,7,9,15,17,19,21],{x:v=>v,y:2,dy:y/2,fill:"#ddd",r:8}),_n([12,12,24,24],{x:v=>v,y:(v,M)=>M%2===0?1:3,dy:y/2,fill:"#ddd",r:8}),th(b,_P({fill:"count"},{x:"fret",y:"string",fill:"count",inset:5,rx:"50%",tip:!0}))]});n(1,o.textContent="",o),o.appendChild(_)};st(()=>{W.enable().then(l).catch(p=>alert(p)),c()}),lt(()=>{for(const p of W.inputs)p.removeListener()});function f(p){a=p,n(2,a)}function h(p){xe[p?"unshift":"push"](()=>{o=p,n(1,o)})}function d(p){s=p,n(3,s)}return e.$$set=p=>{"demoInfo"in p&&n(0,r=p.demoInfo)},[r,o,a,s,c,f,h,d]}class uR extends He{constructor(t){super(),ze(this,t,lR,aR,qe,{demoInfo:0})}}function cR(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E;return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Play chords or short arpeggios with pauses inbetween. In the
        visualization below, you can then see how long the time between the
        first and last note of each chord/arpeggio was and how much time lies
        between consecutive chords/arpeggios.`,s=O(),l=C("div"),u=C("label"),c=q(`max. note distance
            `),f=C("input"),h=O(),d=C("label"),p=q(`time
            `),b=C("input"),y=O(),_=C("div"),v=O(),M=C("div"),g=C("button"),g.textContent="reset",k(a,"class","explanation"),k(f,"type","number"),k(f,"min","0.05"),k(f,"max","5"),k(f,"step","0.05"),k(u,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),k(b,"type","number"),k(b,"min","10"),k(b,"max","300"),k(b,"step","10"),k(d,"title","time in seconds for past notes to be shown"),k(l,"class","control"),k(_,"class","visualization"),k(g,"title","Clear all played notes"),k(M,"class","control"),k(t,"class","demo")},m(N,x){fe(N,t,x),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f),be(f,e[3]),m(l,h),m(l,d),m(d,p),m(d,b),be(b,e[2]),m(t,y),m(t,_),e[9](_),m(t,v),m(t,M),m(M,g),w||(E=[ne(f,"input",e[7]),ne(f,"change",e[6]),ne(b,"input",e[8]),ne(b,"change",e[6]),ne(g,"click",e[10])],w=!0)},p(N,[x]){x&1&&r!==(r=N[0].title+"")&&he(i,r),x&8&&Ne(f.value)!==N[3]&&be(f,N[3]),x&4&&Ne(b.value)!==N[2]&&be(b,N[2])},i:ge,o:ge,d(N){N&&ce(t),e[9](null),w=!1,Ve(E)}}}let Vc=1e3,fR=400;function hR(e,t,n){let{demoInfo:r}=t,i,o=10,a=.2,s=0,l=[];const u=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((y,_)=>{console.log(`MIDI device ${_}: ${y.name}`),y.addListener("noteon",c)}),[...W.inputs])},c=y=>{const _=(y.timestamp-s)/1e3,v={number:y.note.number,velocity:y.rawVelocity,time:_,channel:y.message.channel};l.push(v),f()},f=()=>{const y=ot(l,S=>S.time)+.5,_=y-o,v=l.filter(S=>S.end>_||S.end===void 0),M=[];let g=[];for(const S of v)g.length===0||S.time-g.at(-1).time<a?g.push(S):(M.push(g),g=[S]);M.push(g);const w=M.map(S=>Yt(S,P=>P.time)),E=w.slice(1).map((S,P)=>[w[P][0],S[0]]),N=et({insetRight:10,width:Vc,height:fR,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[_,y]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,tickFormat:S=>Ta[S].label},marks:[nh(v,{clip:!0,x:"time",y:"number",fill:"#ddd",stroke:"#ccc"})]}),x=et({insetRight:10,width:Vc,height:100,marginLeft:60,marginTop:0,marginBottom:0,padding:0,x:{label:null,domain:[_,y],axis:!1},y:{ticks:[],label:"durations (s)"},marks:[A1(w,{clip:!0,x1:S=>S[0],x2:S=>S[1],y:0}),wr(w,{clip:!0,x:S=>S[0],y:0,text:(S,P)=>(S[1]-S[0]).toFixed(2),dy:10,textAnchor:"start"})]}),T=et({insetRight:10,width:Vc,height:100,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[_,y]},y:{ticks:[],label:"gaps (s)"},marks:[A1(E,{clip:!0,x1:S=>S[0],x2:S=>S[1],y:0}),nh(E,{clip:!0,x:S=>S[0]}),wr(E,{clip:!0,x:S=>S[0],y:0,text:(S,P)=>(S[1]-S[0]).toFixed(2),dx:2,dy:10,textAnchor:"start"})]});n(1,i.textContent="",i),i.appendChild(N),i.appendChild(x),i.appendChild(T)};st(()=>{W.enable().then(u).catch(y=>alert(y)),n(4,s=performance.now()),f()}),lt(()=>{for(const y of W.inputs)y.removeListener()});function h(){a=Ne(this.value),n(3,a)}function d(){o=Ne(this.value),n(2,o)}function p(y){xe[y?"unshift":"push"](()=>{i=y,n(1,i)})}const b=()=>{confirm("Reset played notes?")&&(n(5,l=[]),n(4,s=performance.now()))};return e.$$set=y=>{"demoInfo"in y&&n(0,r=y.demoInfo)},[r,i,o,a,s,l,f,h,d,p,b]}class dR extends He{constructor(t){super(),ze(this,t,hR,cR,qe,{demoInfo:0})}}function mR(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w;function E(S){e[7](S)}let N={callback:e[4]};e[2]!==void 0&&(N.value=e[2]),u=new Ku({props:N}),xe.push(()=>nt(u,"value",E));function x(S){e[9](S)}let T={callback:e[4]};return e[3]!==void 0&&(T.notes=e[3]),b=new Sn({props:T}),xe.push(()=>nt(b,"notes",x)),v=new sn({props:{exportFunction:e[5]}}),g=new an({props:{importFunction:e[6]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Connect a MIDI keyboard and start playing. The heatmap below shows how
        often you played each keyboard key.`,s=O(),l=C("div"),Ae(u.$$.fragment),f=O(),h=C("div"),d=O(),p=C("div"),Ae(b.$$.fragment),_=O(),Ae(v.$$.fragment),M=O(),Ae(g.$$.fragment),k(a,"class","explanation"),k(l,"class","control"),k(h,"class","visualization"),k(p,"class","control"),k(t,"class","demo")},m(S,P){fe(S,t,P),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),Se(u,l,null),m(t,f),m(t,h),e[8](h),m(t,d),m(t,p),Se(b,p,null),m(p,_),Se(v,p,null),m(p,M),Se(g,p,null),w=!0},p(S,[P]){(!w||P&1)&&r!==(r=S[0].title+"")&&he(i,r);const I={};!c&&P&4&&(c=!0,I.value=S[2],tt(()=>c=!1)),u.$set(I);const $={};!y&&P&8&&(y=!0,$.notes=S[3],tt(()=>y=!1)),b.$set($)},i(S){w||(_e(u.$$.fragment,S),_e(b.$$.fragment,S),_e(v.$$.fragment,S),_e(g.$$.fragment,S),w=!0)},o(S){Me(u.$$.fragment,S),Me(b.$$.fragment,S),Me(v.$$.fragment,S),Me(g.$$.fragment,S),w=!1},d(S){S&&ce(t),Ee(u),e[8](null),Ee(b),Ee(v),Ee(g)}}}let pR=1200,bR=280;const Yc=21,Wc=108;function gR(e,t,n){let{demoInfo:r}=t,i,o=500,a=[];const s=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((y,_)=>{console.log(`MIDI device ${_}: ${y.name}`),y.addListener("noteon",l),y.addListener("controlchange",u)}),[...W.inputs])},l=y=>{const _={number:y.note.number,velocity:y.rawVelocity,time:y.timestamp,channel:y.message.channel};a.push(_),c()},u=y=>{const _=Pu(y.rawValue*2,20,250);n(2,o=_),c()},c=()=>{const y=a.slice(-o),_=da(y,g=>g.number),v=ot(_,g=>g[1].length),M=et({width:pR,height:bR,marginLeft:80,marginBottom:50,padding:0,x:{domain:Ce(Yc,Wc),tickFormat:g=>la(g)?"":g%12===0?`
`+Ut.fromMidiSharps(g):Ut.fromMidiSharps(g).slice(0,-1)},y:{},marks:[$t(Wy(Yc,Wc),{stroke:"#ddd"}),Nt([0],{stroke:"#ddd"}),po(Ce(Yc,Wc).filter(g=>la(g)),{x:g=>g,y:()=>v,fill:"#f8f8f8",inset:.5}),po(y,yP({y:"count"},{x:"number",fill:g=>la(g.number)?"#444":"#ccc",inset:.5,rx:4,tip:!0}))]});n(1,i.textContent="",i),i.appendChild(M)},f=()=>{const y={notes:a,pastNoteCount:o};un(r.id,y)},h=async y=>{if(a.length===0||confirm("Import data and overwrite currently unsaved data?")){const _=await ln(y);n(3,a=_.notes),n(2,o=_.pastNoteCount),c()}};st(()=>{W.enable().then(s).catch(y=>alert(y)),c()}),lt(()=>{for(const y of W.inputs)y.removeListener()});function d(y){o=y,n(2,o)}function p(y){xe[y?"unshift":"push"](()=>{i=y,n(1,i)})}function b(y){a=y,n(3,a)}return e.$$set=y=>{"demoInfo"in y&&n(0,r=y.demoInfo)},[r,i,o,a,c,f,h,d,p,b]}class yR extends He{constructor(t){super(),ze(this,t,gR,mR,qe,{demoInfo:0})}}function _p(e,t,n){const r=e.slice();return r[17]=t[n],r}function vp(e,t,n){const r=e.slice();return r[20]=t[n],r}function wp(e){let t,n=e[20]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[20],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function Mp(e){let t,n=e[17]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[17],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function _R(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N=Pe(e[5]),x=[];for(let $=0;$<N.length;$+=1)x[$]=wp(vp(e,N,$));let T=Pe(e[6]),S=[];for(let $=0;$<T.length;$+=1)S[$]=Mp(_p(e,T,$));function P($){e[11]($)}let I={callback:e[7]};return e[4]!==void 0&&(I.notes=e[4]),v=new Sn({props:I}),xe.push(()=>nt(v,"notes",P)),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Each time you play a note, the fretboard below shows you how far each
        note of the scale is away from the note you just played.`,s=O(),l=C("div"),u=C("label"),c=q(`scale
            `),f=C("select");for(let $=0;$<x.length;$+=1)x[$].c();h=O(),d=C("select");for(let $=0;$<S.length;$+=1)S[$].c();p=O(),b=C("div"),y=O(),_=C("div"),Ae(v.$$.fragment),k(a,"class","explanation"),e[2]===void 0&&at(()=>e[8].call(f)),e[3]===void 0&&at(()=>e[9].call(d)),k(l,"class","control"),k(b,"class","visualization"),k(_,"class","control"),k(t,"class","demo")},m($,D){fe($,t,D),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f);for(let A=0;A<x.length;A+=1)x[A]&&x[A].m(f,null);$e(f,e[2],!0),m(u,h),m(u,d);for(let A=0;A<S.length;A+=1)S[A]&&S[A].m(d,null);$e(d,e[3],!0),m(t,p),m(t,b),e[10](b),m(t,y),m(t,_),Se(v,_,null),g=!0,w||(E=[ne(f,"change",e[8]),ne(f,"change",e[7]),ne(d,"change",e[9]),ne(d,"change",e[7])],w=!0)},p($,[D]){if((!g||D&1)&&r!==(r=$[0].title+"")&&he(i,r),D&32){N=Pe($[5]);let F;for(F=0;F<N.length;F+=1){const L=vp($,N,F);x[F]?x[F].p(L,D):(x[F]=wp(L),x[F].c(),x[F].m(f,null))}for(;F<x.length;F+=1)x[F].d(1);x.length=N.length}if(D&36&&$e(f,$[2]),D&64){T=Pe($[6]);let F;for(F=0;F<T.length;F+=1){const L=_p($,T,F);S[F]?S[F].p(L,D):(S[F]=Mp(L),S[F].c(),S[F].m(d,null))}for(;F<S.length;F+=1)S[F].d(1);S.length=T.length}D&72&&$e(d,$[3]);const A={};!M&&D&16&&(M=!0,A.notes=$[4],tt(()=>M=!1)),v.$set(A)},i($){g||(_e(v.$$.fragment,$),g=!0)},o($){Me(v.$$.fragment,$),g=!1},d($){$&&ce(t),Ue(x,$),Ue(S,$),e[10](null),Ee(v),w=!1,Ve(E)}}}let Sp=1e3,vR=280,jc=6,Xc=24;function wR(e,t,n){let{demoInfo:r}=t,i,o="A",a="minor pentatonic",s=[],l=[64,59,55,50,45,40];const u=l.map(Ut.fromMidiSharps),c=ms,f=wt.names(),h=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((M,g)=>{console.log(`MIDI device ${g}: ${M.name}`),M.addListener("noteon",d)}),[...W.inputs])},d=M=>{const g=M.message.channel-1,w={number:M.note.number,velocity:M.rawVelocity,time:M.timestamp,channel:M.message.channel,string:g,fret:M.note.number-l[g]};s.push(w),p()},p=()=>{const M=s.at(-1),g=[];if(M){const N=M.number%12,x=wt.get(`${o} ${a}`),T=new Map(x.notes.map((S,P)=>{const I=c.indexOf(S);let $=I-N;$=$>=0?$:$+12;const D={name:S,chroma:I,interval:x.intervals[P],degree:P,offset:$};return[I,D]}));for(let S=0;S<jc;S++)for(let P=0;P<Xc+1;P++){const I=(l[S]+P)%12;T.has(I)&&g.push({string:S,fret:P,step:T.get(I).offset})}}const w=(Sp-100)/25,E=et({width:Sp,height:vR,marginLeft:60,marginBottom:50,padding:0,x:{domain:Ce(0,Xc+1),tickSize:0},y:{domain:Ce(0,jc),tickFormat:N=>u[N],tickSize:0},color:{legend:!0,marginLeft:100,width:400,type:"categorical"},marks:[$t(Ce(0,Xc+1),{stroke:"#ddd",dx:w/2}),Nt(Ce(0,jc),{stroke:"#ddd",strokeWidth:N=>Math.sqrt(N+1)}),_n([3,5,7,9,15,17,19,21],{x:N=>N,y:2,dy:w/2,fill:"#ddd",r:8}),_n([12,12,24,24],{x:N=>N,y:(N,x)=>x%2===0?1:3,dy:w/2,fill:"#ddd",r:8}),M?th([M],{x:"fret",y:"string",fill:"black",tip:!0,inset:5,rx:5}):null,th(g,{x:"fret",y:"string",fill:"step",inset:10,rx:"50%",tip:!0})]});n(1,i.textContent="",i),i.appendChild(E)};st(()=>{W.enable().then(h).catch(M=>alert(M)),p()}),lt(()=>{for(const M of W.inputs)M.removeListener()});function b(){o=pt(this),n(2,o),n(5,c)}function y(){a=pt(this),n(3,a),n(6,f)}function _(M){xe[M?"unshift":"push"](()=>{i=M,n(1,i)})}function v(M){s=M,n(4,s)}return e.$$set=M=>{"demoInfo"in M&&n(0,r=M.demoInfo)},[r,i,o,a,s,c,f,p,b,y,_,v]}class MR extends He{constructor(t){super(),ze(this,t,wR,_R,qe,{demoInfo:0})}}function SR(e,t,n){const r=e.slice();return r[33]=t[n],r}function ER(e,t,n){const r=e.slice();return r[33]=t[n],r}function AR(e){let t;return{c(){t=C("option"),t.textContent=`${e[33]}`,t.__value=e[33],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function CR(e){let t;return{c(){t=C("option"),t.textContent=`${e[33]}`,t.__value=e[33],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function PR(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S,P,I,$,D,A,F,L,X,U,z,G,R,Y,re,Q,J,K,ee,j,V,te,B,se,Z,ie,le,ve,we,H,ue,ye,Fe,We,pe,de,Oe,Re,fn,En;function _t(ae){e[19](ae)}let zn={label:"initial tempo",title:"Set a tempo at which you are able to input the exercise precisely (in BPM)",callback:e[15]};e[2]!==void 0&&(zn.value=e[2]),u=new Hr({props:zn}),xe.push(()=>nt(u,"value",_t));function Ni(ae){e[20](ae)}let Pr={label:"target tempo",title:"Set the tempo you want to be able to play the exercise at (in BPM)",callback:e[15]};e[3]!==void 0&&(Pr.value=e[3]),h=new Hr({props:Pr}),xe.push(()=>nt(h,"value",Ni));let Zr=Pe(["off","32nd","16th","8th"]),An=[];for(let ae=0;ae<4;ae+=1)An[ae]=AR(ER(e,Zr,ae));let Ju=Pe(["quarter","eighth","quarter-triplets","swing"]),Cn=[];for(let ae=0;ae<4;ae+=1)Cn[ae]=CR(SR(e,Ju,ae));return pe=new sn({props:{exportFunction:e[17]}}),Oe=new an({props:{importFunction:e[18]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo.`,s=O(),l=C("div"),Ae(u.$$.fragment),f=O(),Ae(h.$$.fragment),p=O(),b=C("label"),y=q(`tempo increase
            `),_=C("input"),v=O(),M=C("label"),g=q(`quantize exercise
            `),w=C("select");for(let ae=0;ae<4;ae+=1)An[ae].c();E=O(),N=C("div"),x=C("label"),T=q(`pre-defined exercise
            `),S=C("select");for(let ae=0;ae<4;ae+=1)Cn[ae].c();P=O(),I=C("button"),$=q("input exercise"),A=O(),F=C("button"),L=q("save exercise"),U=O(),z=C("button"),G=q("start practice"),Y=O(),re=C("button"),Q=q("stop practice"),K=O(),ee=C("div"),j=q("current step: "),V=C("b"),te=q(e[6]),B=q(" current tempo: "),se=C("b"),Z=q(e[7]),ie=q(" BPM"),le=O(),ve=C("div"),we=O(),H=C("div"),ue=C("button"),ye=q("reset practice"),We=O(),Ae(pe.$$.fragment),de=O(),Ae(Oe.$$.fragment),k(a,"class","explanation"),k(_,"type","number"),k(_,"min","1"),k(_,"max","20"),k(_,"step","1"),k(b,"title","Set the tempo increase between practice runs (in BPM)"),e[5]===void 0&&at(()=>e[22].call(w)),k(l,"class","control"),k(I,"title","Start recording the exercise."),I.disabled=D=e[6]==="input exercise"||e[6]==="practice",k(F,"title","Stop recording the exercise."),F.disabled=X=e[6]!=="input exercise",k(z,"title","Start recording the practice with speed-up."),z.disabled=R=e[9].length===0,k(re,"title","Stop recording the practice with speed-up."),re.disabled=J=e[6]!=="practice",k(N,"class","control"),k(ve,"class","visualization"),k(ue,"title","Clear practice but not exercise"),ue.disabled=Fe=e[6]!=="",k(H,"class","control"),k(t,"class","demo")},m(ae,Xe){fe(ae,t,Xe),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),Se(u,l,null),m(l,f),Se(h,l,null),m(l,p),m(l,b),m(b,y),m(b,_),be(_,e[4]),m(l,v),m(l,M),m(M,g),m(M,w);for(let Je=0;Je<4;Je+=1)An[Je]&&An[Je].m(w,null);$e(w,e[5],!0),m(t,E),m(t,N),m(N,x),m(x,T),m(x,S);for(let Je=0;Je<4;Je+=1)Cn[Je]&&Cn[Je].m(S,null);m(N,P),m(N,I),m(I,$),m(N,A),m(N,F),m(F,L),m(N,U),m(N,z),m(z,G),m(N,Y),m(N,re),m(re,Q),m(t,K),m(t,ee),m(ee,j),m(ee,V),m(V,te),m(ee,B),m(ee,se),m(se,Z),m(ee,ie),m(t,le),m(t,ve),e[23](ve),m(t,we),m(t,H),m(H,ue),m(ue,ye),m(H,We),Se(pe,H,null),m(H,de),Se(Oe,H,null),Re=!0,fn||(En=[ne(_,"input",e[21]),ne(w,"change",e[22]),ne(w,"change",e[15]),ne(S,"change",e[16]),ne(I,"click",e[11]),ne(F,"click",e[12]),ne(z,"click",e[13]),ne(re,"click",e[14]),ne(ue,"click",e[24])],fn=!0)},p(ae,Xe){(!Re||Xe[0]&1)&&r!==(r=ae[0].title+"")&&he(i,r);const Je={};!c&&Xe[0]&4&&(c=!0,Je.value=ae[2],tt(()=>c=!1)),u.$set(Je);const Io={};!d&&Xe[0]&8&&(d=!0,Io.value=ae[3],tt(()=>d=!1)),h.$set(Io),Xe[0]&16&&Ne(_.value)!==ae[4]&&be(_,ae[4]),Xe[0]&32&&$e(w,ae[5]),(!Re||Xe[0]&64&&D!==(D=ae[6]==="input exercise"||ae[6]==="practice"))&&(I.disabled=D),(!Re||Xe[0]&64&&X!==(X=ae[6]!=="input exercise"))&&(F.disabled=X),(!Re||Xe[0]&512&&R!==(R=ae[9].length===0))&&(z.disabled=R),(!Re||Xe[0]&64&&J!==(J=ae[6]!=="practice"))&&(re.disabled=J),(!Re||Xe[0]&64)&&he(te,ae[6]),(!Re||Xe[0]&128)&&he(Z,ae[7]),(!Re||Xe[0]&64&&Fe!==(Fe=ae[6]!==""))&&(ue.disabled=Fe)},i(ae){Re||(_e(u.$$.fragment,ae),_e(h.$$.fragment,ae),_e(pe.$$.fragment,ae),_e(Oe.$$.fragment,ae),Re=!0)},o(ae){Me(u.$$.fragment,ae),Me(h.$$.fragment,ae),Me(pe.$$.fragment,ae),Me(Oe.$$.fragment,ae),Re=!1},d(ae){ae&&ce(t),Ee(u),Ee(h),Ue(An,ae),Ue(Cn,ae),e[23](null),Ee(pe),Ee(Oe),fn=!1,Ve(En)}}}let Ep=1e3,xR=60;function NR(e,t,n){const r=e[0];return e.map(o=>{let a=o-r;if(t!=="off"){let s;t==="8th"&&(s=n/2),t==="16th"&&(s=n/4),t==="32nd"&&(s=n/8),a=Math.round(a/s)*s}return a/n})}function TR(e,t,n){let{demoInfo:r}=t,i,o=new qd,a=60,s=120,l=10,u="off",c="",f=s,h=0,d=[],p,b=new Map,y=!0,_;const v=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((U,z)=>{console.log(`MIDI device ${z}: ${U.name}`),U.addListener("noteon",M)}),[...W.inputs])},M=async U=>{const G=(U.timestamp-h)/1e3;if(c==="input exercise")n(9,d=[...d,G]);else if(c==="practice"){b.has(f)||b.set(f,[]);const R=b.get(f);y&&R.push(G)}T()},g=async()=>{const U=b.get(f);if(!U||!U.length)return;const z=Gt(U),R=(performance.now()-h)/1e3-z;let Y=Lt(f);R/Y>=p&&(console.log("increasing bpm"),o.stop(),f<=s?(n(7,f+=l),y=!1,await jy(1),o.start(f,4),b.has(f)&&b.set(f,[]),y=!0):x())},w=()=>{n(6,c="input exercise"),n(9,d=[]),n(10,b=new Map),o.start(a,4),T()},E=()=>{if(n(6,c=""),o.stop(),d.length>0){const U=ot(d)-Gt(d);let z=Lt(a);p=Math.ceil(U/z)}},N=async()=>{if(d.length===0){alert("You need to input an exercise first");return}n(6,c="practice"),n(7,f=a),n(10,b=new Map),o.start(f,4),_=setInterval(g,100)},x=()=>{console.log("stop practice"),n(6,c=""),n(7,f=s),clearInterval(_),o.stop()},T=()=>{if(n(1,i.textContent="",i),d.length===0)return;let U=Lt(a);const z=NR(d,u,U);let G=Math.ceil(ot(z)/4*4)+.5;console.log(z,G);const R=et({width:Ep,height:xR,marginLeft:40,x:{label:"time in beats",domain:[0,G]},y:{},marks:[$t(Ce(0,G,1),{stroke:"#ddd"}),$t(Ce(0,G,4)),_n(z,{symbol:"times",stroke:"#333",x:Y=>Y,r:5})]});i.appendChild(R);for(const[Y,re]of b){const Q=re[0];U=Lt(Y);const J=re.map(ee=>(ee-Q)/U),K=et({width:Ep,height:70,marginLeft:40,x:{label:"time in beats",domain:[0,G]},y:{label:`${Y} BPM`,ticks:[]},marks:[$t(Ce(0,G,1),{stroke:"#ddd"}),$t(Ce(0,G,4)),_n(J,{symbol:"times",stroke:"#333",x:ee=>ee,y:0,r:5})]});i.appendChild(K)}};st(()=>{W.enable().then(v).catch(U=>alert(U)),n(8,h=performance.now()),T()}),lt(()=>{for(const U of W.inputs)U.removeListener();clearInterval(_),o.stop()});const S=U=>{const z=U.target.value,G=new Map([["quarter",Ce(0,8,1)],["eighth",Ce(0,8,.5)],["quarter-triplets",Ce(0,8,1/3)],["swing",Ce(0,8,.5).map((re,Q)=>Q%2===0?Q:Q+.2)]]),R=Lt(a);n(5,u="off");const Y=G.get(z);n(9,d=Y.map(re=>re*R)),p=Math.ceil(ot(Y)+1),console.log(z,d),T()},P=()=>{const U={initialTempo:a,targetTempo:s,tempoIncrease:l,quantize:u,currentStep:c,currentTempo:f,firstTimeStamp:h,exerciseNotes:d,exerciseBeatCount:p,practiceRecordings:b};un(r.id,U)},I=async U=>{if(d.length===0||confirm("Import data and overwrite currently unsaved data?")){const z=await ln(U);n(2,a=z.initialTempo),n(3,s=z.targetTempo),n(4,l=z.tempoIncrease),n(5,u=z.quantize),n(6,c=z.currentStep),n(7,f=z.currentTempo),n(8,h=z.firstTimeStamp),n(9,d=z.exerciseNotes),p=z.exerciseBeatCount,n(10,b=z.practiceRecordings),T()}};function $(U){a=U,n(2,a)}function D(U){s=U,n(3,s)}function A(){l=Ne(this.value),n(4,l)}function F(){u=pt(this),n(5,u)}function L(U){xe[U?"unshift":"push"](()=>{i=U,n(1,i)})}const X=()=>{confirm("Reset practice?")&&(n(10,b=new Map),n(8,h=performance.now()),T())};return e.$$set=U=>{"demoInfo"in U&&n(0,r=U.demoInfo)},[r,i,a,s,l,u,c,f,h,d,b,w,E,N,x,T,S,P,I,$,D,A,F,L,X]}class IR extends He{constructor(t){super(),ze(this,t,TR,PR,qe,{demoInfo:0},null,[-1,-1])}}function kR(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_=(e[4]?ft:ht)+"",v,M,g,w,E,N,x,T,S,P,I;function $(L){e[8](L)}let D={callback:e[7]};e[2]!==void 0&&(D.value=e[2]),u=new Hr({props:D}),xe.push(()=>nt(u,"value",$));function A(L){e[9](L)}let F={callback:e[7]};return e[3]!==void 0&&(F.value=e[3]),h=new Ku({props:F}),xe.push(()=>nt(h,"value",A)),T=new Xu({props:{tempo:e[2],accent:4}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Set a tempo and start playing. The time between the notes you play will
        be displayed as note symbols, so you can see whether you play, for
        example, correct quarter notes.`,s=O(),l=C("div"),Ae(u.$$.fragment),f=O(),Ae(h.$$.fragment),p=O(),b=C("button"),y=q("dotted notes "),v=q(_),M=O(),g=C("div"),w=O(),E=C("div"),N=C("button"),N.textContent="reset",x=O(),Ae(T.$$.fragment),k(a,"class","explanation"),k(b,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),k(l,"class","control"),k(g,"class","visualization"),k(N,"title","Clear played notes"),k(E,"class","control"),k(t,"class","demo")},m(L,X){fe(L,t,X),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),Se(u,l,null),m(l,f),Se(h,l,null),m(l,p),m(l,b),m(b,y),m(b,v),m(t,M),m(t,g),e[11](g),m(t,w),m(t,E),m(E,N),m(E,x),Se(T,E,null),S=!0,P||(I=[ne(b,"click",e[10]),ne(N,"click",e[12])],P=!0)},p(L,[X]){(!S||X&1)&&r!==(r=L[0].title+"")&&he(i,r);const U={};!c&&X&4&&(c=!0,U.value=L[2],tt(()=>c=!1)),u.$set(U);const z={};!d&&X&8&&(d=!0,z.value=L[3],tt(()=>d=!1)),h.$set(z),(!S||X&16)&&_!==(_=(L[4]?ft:ht)+"")&&he(v,_);const G={};X&4&&(G.tempo=L[2]),T.$set(G)},i(L){S||(_e(u.$$.fragment,L),_e(h.$$.fragment,L),_e(T.$$.fragment,L),S=!0)},o(L){Me(u.$$.fragment,L),Me(h.$$.fragment,L),Me(T.$$.fragment,L),S=!1},d(L){L&&ce(t),Ee(u),Ee(h),e[11](null),Ee(T),P=!1,Ve(I)}}}let Ap=1e3;function $R(e,t,n){let{demoInfo:r}=t,i,o=120,a=10,s=!0,l=0,u=[];const c=[{name:"double-whole",beats:8,symbol:"_"},{name:"dotted-whole",beats:6,symbol:".",dotted:!0},{name:"whole",beats:4,symbol:""},{name:"dotted-half",beats:3,symbol:".",dotted:!0},{name:"half",beats:2,symbol:""},{name:"dotted-quarter",beats:1.5,symbol:".",dotted:!0},{name:"quarter",beats:1,symbol:""},{name:"dotted-eighth",beats:.75,symbol:".",dotted:!0},{name:"eighth",beats:.5,symbol:""},{name:"dotted-sixteenth",beats:.375,symbol:".",dotted:!0},{name:"sixteenth",beats:.25,symbol:""},{name:"thirtysecond",beats:.125,symbol:""},{name:"sixtyfourth",beats:.0625,symbol:""}],f=c.filter(g=>!g.dotted),h=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((g,w)=>{console.log(`MIDI device ${w}: ${g.name}`),g.addListener("noteon",d)}),[...W.inputs])},d=async g=>{const E=(g.timestamp-l)/1e3;u.push(E),p()},p=()=>{if(n(1,i.textContent="",i),u.length===0)return;let g=Lt(o);const w=u.slice(-(a+1)),N=w.map((I,$)=>$===0?0:I-w[$-1]).map(I=>I/g),x=s?c:f,T=N.map(I=>{const $=pb(x,A=>Math.abs(I-A.beats)),D=x[$];return{...D,beats:I,offsetPercent:(I/D.beats*100).toFixed()}}),S=et({width:Ap,height:100,marginLeft:80,x:{label:"",domain:Ce(1,a),ticks:[]},y:{domain:[1,0],ticks:Ce(3),tickFormat:I=>["note","beats"][I]},marks:[wr(T,{text:"symbol",x:(I,$)=>$,y:0,fontSize:40}),wr(T,{text:"beats",x:(I,$)=>$,y:1,fontSize:20})]});i.appendChild(S);const P=et({width:Ap,height:200,marginLeft:80,x:{label:"Note",domain:Ce(1,a),tickSize:0,ticks:[]},y:{domain:[0,150],ticks:[0,50,100,150]},marks:[po(T,{x:(I,$)=>$,y:"offsetPercent",fill:"#ddd"}),Nt([50,150],{stroke:"#aaa"}),Nt([100])]});i.appendChild(P)};st(()=>{W.enable().then(h).catch(g=>alert(g)),n(5,l=performance.now()),p()}),lt(()=>{for(const g of W.inputs)g.removeListener()});function b(g){o=g,n(2,o)}function y(g){a=g,n(3,a)}const _=()=>{n(4,s=!s),p()};function v(g){xe[g?"unshift":"push"](()=>{i=g,n(1,i)})}const M=()=>{confirm("Clear notes?")&&(n(5,l=performance.now()),n(6,u=[]),p())};return e.$$set=g=>{"demoInfo"in g&&n(0,r=g.demoInfo)},[r,i,o,a,s,l,u,p,b,y,_,v,M]}class DR extends He{constructor(t){super(),ze(this,t,$R,kR,qe,{demoInfo:0})}}function FR(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S;return{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent="Play chords on a guitar and see the chord names and diagrams.",s=O(),l=C("div"),u=C("label"),c=q(`max. note distance
            `),f=C("input"),h=O(),d=C("label"),p=q(`max. fret span
            `),b=C("input"),y=O(),_=C("label"),v=q(`chord count
            `),M=C("input"),g=O(),w=C("div"),E=O(),N=C("div"),x=C("button"),x.textContent="reset",k(a,"class","explanation"),k(f,"type","number"),k(f,"min","0.05"),k(f,"max","5"),k(f,"step","0.05"),k(u,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),k(b,"type","number"),k(b,"min","5"),k(b,"max","25"),k(b,"step","1"),k(d,"title","maximum distance between the lowest and highest fret"),k(M,"type","number"),k(M,"min","10"),k(M,"max","300"),k(M,"step","10"),k(_,"title","The number of played chords that is displayed"),k(l,"class","control"),k(w,"class","visualization"),k(x,"title","Clear all played notes"),k(N,"class","control"),k(t,"class","demo")},m(P,I){fe(P,t,I),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f),be(f,e[4]),m(l,h),m(l,d),m(d,p),m(d,b),be(b,e[3]),m(l,y),m(l,_),m(_,v),m(_,M),be(M,e[2]),m(t,g),m(t,w),e[11](w),m(t,E),m(t,N),m(N,x),T||(S=[ne(f,"input",e[8]),ne(f,"change",e[7]),ne(b,"input",e[9]),ne(b,"change",e[7]),ne(M,"input",e[10]),ne(M,"change",e[7]),ne(x,"click",e[12])],T=!0)},p(P,[I]){I&1&&r!==(r=P[0].title+"")&&he(i,r),I&16&&Ne(f.value)!==P[4]&&be(f,P[4]),I&8&&Ne(b.value)!==P[3]&&be(b,P[3]),I&4&&Ne(M.value)!==P[2]&&be(M,P[2])},i:ge,o:ge,d(P){P&&ce(t),e[11](null),T=!1,Ve(S)}}}let Cp=200,Pp=6,BR=24;function RR(e,t,n){let{demoInfo:r}=t,i,o=5,a=5,s=.1,l=[64,59,55,50,45,40];const u=l.map(Ut.fromMidiSharps);let c=0,f=[];const h=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((g,w)=>{console.log(`MIDI device ${w}: ${g.name}`),g.addListener("noteon",d)}),[...W.inputs])},d=g=>{const w=(g.timestamp-c)/1e3,E=g.message.channel-1,N={number:g.note.number,velocity:g.rawVelocity,time:w,channel:g.message.channel,string:E,fret:g.note.number-l[E]};f.push(N),p()},p=()=>{let g=[],w=[];for(const T of f)w.length===0||T.time-w.at(-1).time<s?w.push(T):(g.push(w),w=[T]);g.push(w),g=g.map(T=>{const S=T.filter($=>$.fret>0);let P;S.length===0?P=0:P=Gt(S,$=>$.fret);const I=P+a;return T.filter($=>$.fret<=I)}),g=g.filter(T=>T.length>2).slice(-o);for(const[T,S]of g.entries())for(const P of S)P.chordId=T;const E=g.map(T=>{let S=T.sort((P,I)=>P.number-I.number).map(P=>Ut.fromMidiSharps(P.number));return S=[...new Set(S)],Ll.detect(S)}),N=(Cp-35)/3*(a+1)+50,x=(N-100)/(a+2);n(1,i.textContent="",i);for(const[T,S]of g.entries()){const P=S.filter(A=>A.fret>0);let I=0;P.length>0&&(I=Gt(P,A=>A.fret));const $=I+a,D=et({width:N,height:Cp,marginLeft:40,marginRight:10,marginBottom:25,padding:0,figure:!0,subtitle:E[T].join(", "),style:{textAlign:"center"},x:{domain:Ce(I===0?0:I-1,$+2),label:"",tickSize:0,tickPadding:15},y:{domain:Ce(0,Pp),tickFormat:A=>u[A],label:"",tickSize:0,tickPadding:15},color:{domain:Ce(12),range:ua.noteColormap,legend:T===0,marginLeft:100,width:600,type:"categorical",tickFormat:A=>xo[A]},r:{domain:[0,100],range:[5,10]},marks:[$t(Ce(0,BR+1),{stroke:"#ddd",dx:x/2}),Nt(Ce(0,Pp),{stroke:"#ddd",strokeWidth:A=>Math.sqrt(A+1)}),_n([3,5,7,9,15,17,19,21],{x:A=>A,y:2,dy:x/2,fill:"#ddd",r:8}),_n([12,12,24,24],{x:A=>A,y:(A,F)=>F%2===0?1:3,dy:x/2,fill:"#ddd",r:8}),_n(S.filter(A=>A.fret>0),{x:"fret",y:"string",r:"velocity",fill:A=>A.number%12,tip:!0}),_n(S.filter(A=>A.fret===0),{x:I===0?0:I-1,y:"string",r:"velocity",stroke:A=>A.number%12,tip:!0})]});i.appendChild(D)}};st(()=>{W.enable().then(h).catch(g=>alert(g)),n(5,c=performance.now()),p()}),lt(()=>{for(const g of W.inputs)g.removeListener()});function b(){s=Ne(this.value),n(4,s)}function y(){a=Ne(this.value),n(3,a)}function _(){o=Ne(this.value),n(2,o)}function v(g){xe[g?"unshift":"push"](()=>{i=g,n(1,i)})}const M=()=>{confirm("Reset played notes?")&&(n(6,f=[]),n(5,c=performance.now()))};return e.$$set=g=>{"demoInfo"in g&&n(0,r=g.demoInfo)},[r,i,o,a,s,c,f,p,b,y,_,v,M]}class LR extends He{constructor(t){super(),ze(this,t,RR,FR,qe,{demoInfo:0})}}var _3="1.13.6",xp=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},Zu=Array.prototype,zd=Object.prototype,Np=typeof Symbol<"u"?Symbol.prototype:null,OR=Zu.push,gs=Zu.slice,Da=zd.toString,GR=zd.hasOwnProperty,v3=typeof ArrayBuffer<"u",UR=typeof DataView<"u",qR=Array.isArray,Tp=Object.keys,Ip=Object.create,kp=v3&&ArrayBuffer.isView,zR=isNaN,HR=isFinite,w3=!{toString:null}.propertyIsEnumerable("toString"),$p=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],VR=Math.pow(2,53)-1;function jt(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=r,e.apply(this,o)}}function Ci(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function YR(e){return e===null}function M3(e){return e===void 0}function S3(e){return e===!0||e===!1||Da.call(e)==="[object Boolean]"}function WR(e){return!!(e&&e.nodeType===1)}function Dt(e){var t="[object "+e+"]";return function(n){return Da.call(n)===t}}const Hd=Dt("String"),E3=Dt("Number"),jR=Dt("Date"),XR=Dt("RegExp"),KR=Dt("Error"),A3=Dt("Symbol"),C3=Dt("ArrayBuffer");var P3=Dt("Function"),ZR=xp.document&&xp.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof ZR!="function"&&(P3=function(e){return typeof e=="function"||!1});const qt=P3,x3=Dt("Object");var N3=UR&&x3(new DataView(new ArrayBuffer(8))),Vd=typeof Map<"u"&&x3(new Map),QR=Dt("DataView");function JR(e){return e!=null&&qt(e.getInt8)&&C3(e.buffer)}const Wl=N3?JR:QR,Pi=qR||Dt("Array");function Kr(e,t){return e!=null&&GR.call(e,t)}var mh=Dt("Arguments");(function(){mh(arguments)||(mh=function(e){return Kr(e,"callee")})})();const Yd=mh;function eL(e){return!A3(e)&&HR(e)&&!isNaN(parseFloat(e))}function T3(e){return E3(e)&&zR(e)}function I3(e){return function(){return e}}function k3(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=VR}}function $3(e){return function(t){return t==null?void 0:t[e]}}const jl=$3("byteLength"),tL=k3(jl);var nL=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function rL(e){return kp?kp(e)&&!Wl(e):tL(e)&&nL.test(Da.call(e))}const D3=v3?rL:I3(!1),Xt=$3("length");function iL(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return{contains:function(i){return t[i]===!0},push:function(i){return t[i]=!0,e.push(i)}}}function F3(e,t){t=iL(t);var n=$p.length,r=e.constructor,i=qt(r)&&r.prototype||zd,o="constructor";for(Kr(e,o)&&!t.contains(o)&&t.push(o);n--;)o=$p[n],o in e&&e[o]!==i[o]&&!t.contains(o)&&t.push(o)}function Ct(e){if(!Ci(e))return[];if(Tp)return Tp(e);var t=[];for(var n in e)Kr(e,n)&&t.push(n);return w3&&F3(e,t),t}function oL(e){if(e==null)return!0;var t=Xt(e);return typeof t=="number"&&(Pi(e)||Hd(e)||Yd(e))?t===0:Xt(Ct(e))===0}function B3(e,t){var n=Ct(t),r=n.length;if(e==null)return!r;for(var i=Object(e),o=0;o<r;o++){var a=n[o];if(t[a]!==i[a]||!(a in i))return!1}return!0}function je(e){if(e instanceof je)return e;if(!(this instanceof je))return new je(e);this._wrapped=e}je.VERSION=_3;je.prototype.value=function(){return this._wrapped};je.prototype.valueOf=je.prototype.toJSON=je.prototype.value;je.prototype.toString=function(){return String(this._wrapped)};function Dp(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,jl(e))}var Fp="[object DataView]";function ph(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!=="function"&&i!=="object"&&typeof t!="object"?!1:R3(e,t,n,r)}function R3(e,t,n,r){e instanceof je&&(e=e._wrapped),t instanceof je&&(t=t._wrapped);var i=Da.call(e);if(i!==Da.call(t))return!1;if(N3&&i=="[object Object]"&&Wl(e)){if(!Wl(t))return!1;i=Fp}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Np.valueOf.call(e)===Np.valueOf.call(t);case"[object ArrayBuffer]":case Fp:return R3(Dp(e),Dp(t),n,r)}var o=i==="[object Array]";if(!o&&D3(e)){var a=jl(e);if(a!==jl(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;o=!0}if(!o){if(typeof e!="object"||typeof t!="object")return!1;var s=e.constructor,l=t.constructor;if(s!==l&&!(qt(s)&&s instanceof s&&qt(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),o){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!ph(e[u],t[u],n,r))return!1}else{var c=Ct(e),f;if(u=c.length,Ct(t).length!==u)return!1;for(;u--;)if(f=c[u],!(Kr(t,f)&&ph(e[f],t[f],n,r)))return!1}return n.pop(),r.pop(),!0}function aL(e,t){return ph(e,t)}function ys(e){if(!Ci(e))return[];var t=[];for(var n in e)t.push(n);return w3&&F3(e,t),t}function Wd(e){var t=Xt(e);return function(n){if(n==null)return!1;var r=ys(n);if(Xt(r))return!1;for(var i=0;i<t;i++)if(!qt(n[e[i]]))return!1;return e!==G3||!qt(n[jd])}}var jd="forEach",L3="has",Xd=["clear","delete"],O3=["get",L3,"set"],sL=Xd.concat(jd,O3),G3=Xd.concat(O3),lL=["add"].concat(Xd,jd,L3);const uL=Vd?Wd(sL):Dt("Map"),cL=Vd?Wd(G3):Dt("WeakMap"),fL=Vd?Wd(lL):Dt("Set"),hL=Dt("WeakSet");function No(e){for(var t=Ct(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r}function dL(e){for(var t=Ct(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r}function U3(e){for(var t={},n=Ct(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t}function bh(e){var t=[];for(var n in e)qt(e[n])&&t.push(n);return t.sort()}function Kd(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||n==null)return n;for(var i=1;i<r;i++)for(var o=arguments[i],a=e(o),s=a.length,l=0;l<s;l++){var u=a[l];(!t||n[u]===void 0)&&(n[u]=o[u])}return n}}const q3=Kd(ys),Xl=Kd(Ct),z3=Kd(ys,!0);function mL(){return function(){}}function H3(e){if(!Ci(e))return{};if(Ip)return Ip(e);var t=mL();t.prototype=e;var n=new t;return t.prototype=null,n}function pL(e,t){var n=H3(e);return t&&Xl(n,t),n}function bL(e){return Ci(e)?Pi(e)?e.slice():q3({},e):e}function gL(e,t){return t(e),e}function V3(e){return Pi(e)?e:[e]}je.toPath=V3;function _s(e){return je.toPath(e)}function Zd(e,t){for(var n=t.length,r=0;r<n;r++){if(e==null)return;e=e[t[r]]}return n?e:void 0}function Y3(e,t,n){var r=Zd(e,_s(t));return M3(r)?n:r}function yL(e,t){t=_s(t);for(var n=t.length,r=0;r<n;r++){var i=t[r];if(!Kr(e,i))return!1;e=e[i]}return!!n}function Qd(e){return e}function Fa(e){return e=Xl({},e),function(t){return B3(t,e)}}function Jd(e){return e=_s(e),function(t){return Zd(t,e)}}function vs(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(r){return e.call(t,r)};case 3:return function(r,i,o){return e.call(t,r,i,o)};case 4:return function(r,i,o,a){return e.call(t,r,i,o,a)}}return function(){return e.apply(t,arguments)}}function W3(e,t,n){return e==null?Qd:qt(e)?vs(e,t,n):Ci(e)&&!Pi(e)?Fa(e):Jd(e)}function em(e,t){return W3(e,t,1/0)}je.iteratee=em;function Qt(e,t,n){return je.iteratee!==em?je.iteratee(e,t):W3(e,t,n)}function _L(e,t,n){t=Qt(t,n);for(var r=Ct(e),i=r.length,o={},a=0;a<i;a++){var s=r[a];o[s]=t(e[s],s,e)}return o}function j3(){}function vL(e){return e==null?j3:function(t){return Y3(e,t)}}function wL(e,t,n){var r=Array(Math.max(0,e));t=vs(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r}function gh(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const Ba=Date.now||function(){return new Date().getTime()};function X3(e){var t=function(o){return e[o]},n="(?:"+Ct(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(o){return o=o==null?"":""+o,r.test(o)?o.replace(i,t):o}}const K3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ML=X3(K3),SL=U3(K3),EL=X3(SL),AL=je.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Kc=/(.)^/,CL={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},PL=/\\|'|\r|\n|\u2028|\u2029/g;function xL(e){return"\\"+CL[e]}var NL=/^\s*(\w|\$)+\s*$/;function TL(e,t,n){!t&&n&&(t=n),t=z3({},t,je.templateSettings);var r=RegExp([(t.escape||Kc).source,(t.interpolate||Kc).source,(t.evaluate||Kc).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(r,function(u,c,f,h,d){return o+=e.slice(i,d).replace(PL,xL),i=d+u.length,c?o+=`'+
((__t=(`+c+`))==null?'':_.escape(__t))+
'`:f?o+=`'+
((__t=(`+f+`))==null?'':__t)+
'`:h&&(o+=`';
`+h+`
__p+='`),u}),o+=`';
`;var a=t.variable;if(a){if(!NL.test(a))throw new Error("variable is not a bare identifier: "+a)}else o=`with(obj||{}){
`+o+`}
`,a="obj";o=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+o+`return __p;
`;var s;try{s=new Function(a,"_",o)}catch(u){throw u.source=o,u}var l=function(u){return s.call(this,u,je)};return l.source="function("+a+`){
`+o+"}",l}function IL(e,t,n){t=_s(t);var r=t.length;if(!r)return qt(n)?n.call(e):n;for(var i=0;i<r;i++){var o=e==null?void 0:e[t[i]];o===void 0&&(o=n,i=r),e=qt(o)?o.call(e):o}return e}var kL=0;function $L(e){var t=++kL+"";return e?e+t:t}function DL(e){var t=je(e);return t._chain=!0,t}function Z3(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var o=H3(e.prototype),a=e.apply(o,i);return Ci(a)?a:o}var To=jt(function(e,t){var n=To.placeholder,r=function(){for(var i=0,o=t.length,a=Array(o),s=0;s<o;s++)a[s]=t[s]===n?arguments[i++]:t[s];for(;i<arguments.length;)a.push(arguments[i++]);return Z3(e,r,this,this,a)};return r});To.placeholder=je;const Q3=jt(function(e,t,n){if(!qt(e))throw new TypeError("Bind must be called on a function");var r=jt(function(i){return Z3(e,r,t,this,n.concat(i))});return r}),cn=k3(Xt);function xi(e,t,n,r){if(r=r||[],!t&&t!==0)t=1/0;else if(t<=0)return r.concat(e);for(var i=r.length,o=0,a=Xt(e);o<a;o++){var s=e[o];if(cn(s)&&(Pi(s)||Yd(s)))if(t>1)xi(s,t-1,n,r),i=r.length;else for(var l=0,u=s.length;l<u;)r[i++]=s[l++];else n||(r[i++]=s)}return r}const FL=jt(function(e,t){t=xi(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=Q3(e[r],e)}return e});function BL(e,t){var n=function(r){var i=n.cache,o=""+(t?t.apply(this,arguments):r);return Kr(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return n.cache={},n}const J3=jt(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),RL=To(J3,je,1);function e5(e,t,n){var r,i,o,a,s=0;n||(n={});var l=function(){s=n.leading===!1?0:Ba(),r=null,a=e.apply(i,o),r||(i=o=null)},u=function(){var c=Ba();!s&&n.leading===!1&&(s=c);var f=t-(c-s);return i=this,o=arguments,f<=0||f>t?(r&&(clearTimeout(r),r=null),s=c,a=e.apply(i,o),r||(i=o=null)):!r&&n.trailing!==!1&&(r=setTimeout(l,f)),a};return u.cancel=function(){clearTimeout(r),s=0,r=i=o=null},u}function LL(e,t,n){var r,i,o,a,s,l=function(){var c=Ba()-i;t>c?r=setTimeout(l,t-c):(r=null,n||(a=e.apply(s,o)),r||(o=s=null))},u=jt(function(c){return s=this,o=c,i=Ba(),r||(r=setTimeout(l,t),n&&(a=e.apply(s,o))),a});return u.cancel=function(){clearTimeout(r),r=o=s=null},u}function OL(e,t){return To(t,e)}function tm(e){return function(){return!e.apply(this,arguments)}}function GL(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}}function UL(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function t5(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const qL=To(t5,2);function n5(e,t,n){t=Qt(t,n);for(var r=Ct(e),i,o=0,a=r.length;o<a;o++)if(i=r[o],t(e[i],i,e))return i}function r5(e){return function(t,n,r){n=Qt(n,r);for(var i=Xt(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(n(t[o],o,t))return o;return-1}}const nm=r5(1),i5=r5(-1);function o5(e,t,n,r){n=Qt(n,r,1);for(var i=n(t),o=0,a=Xt(e);o<a;){var s=Math.floor((o+a)/2);n(e[s])<i?o=s+1:a=s}return o}function a5(e,t,n){return function(r,i,o){var a=0,s=Xt(r);if(typeof o=="number")e>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(r,i),r[o]===i?o:-1;if(i!==i)return o=t(gs.call(r,a,s),T3),o>=0?o+a:-1;for(o=e>0?a:s-1;o>=0&&o<s;o+=e)if(r[o]===i)return o;return-1}}const s5=a5(1,nm,o5),zL=a5(-1,i5);function yh(e,t,n){var r=cn(e)?nm:n5,i=r(e,t,n);if(i!==void 0&&i!==-1)return e[i]}function HL(e,t){return yh(e,Fa(t))}function Sr(e,t,n){t=vs(t,n);var r,i;if(cn(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=Ct(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e}function yi(e,t,n){t=Qt(t,n);for(var r=!cn(e)&&Ct(e),i=(r||e).length,o=Array(i),a=0;a<i;a++){var s=r?r[a]:a;o[a]=t(e[s],s,e)}return o}function l5(e){var t=function(n,r,i,o){var a=!cn(n)&&Ct(n),s=(a||n).length,l=e>0?0:s-1;for(o||(i=n[a?a[l]:l],l+=e);l>=0&&l<s;l+=e){var u=a?a[l]:l;i=r(i,n[u],u,n)}return i};return function(n,r,i,o){var a=arguments.length>=3;return t(n,vs(r,o,4),i,a)}}const Zc=l5(1),Bp=l5(-1);function _o(e,t,n){var r=[];return t=Qt(t,n),Sr(e,function(i,o,a){t(i,o,a)&&r.push(i)}),r}function VL(e,t,n){return _o(e,tm(Qt(t)),n)}function Rp(e,t,n){t=Qt(t,n);for(var r=!cn(e)&&Ct(e),i=(r||e).length,o=0;o<i;o++){var a=r?r[o]:o;if(!t(e[a],a,e))return!1}return!0}function Lp(e,t,n){t=Qt(t,n);for(var r=!cn(e)&&Ct(e),i=(r||e).length,o=0;o<i;o++){var a=r?r[o]:o;if(t(e[a],a,e))return!0}return!1}function pr(e,t,n,r){return cn(e)||(e=No(e)),(typeof n!="number"||r)&&(n=0),s5(e,t,n)>=0}const YL=jt(function(e,t,n){var r,i;return qt(t)?i=t:(t=_s(t),r=t.slice(0,-1),t=t[t.length-1]),yi(e,function(o){var a=i;if(!a){if(r&&r.length&&(o=Zd(o,r)),o==null)return;a=o[t]}return a==null?a:a.apply(o,n)})});function rm(e,t){return yi(e,Jd(t))}function WL(e,t){return _o(e,Fa(t))}function u5(e,t,n){var r=-1/0,i=-1/0,o,a;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=cn(e)?e:No(e);for(var s=0,l=e.length;s<l;s++)o=e[s],o!=null&&o>r&&(r=o)}else t=Qt(t,n),Sr(e,function(u,c,f){a=t(u,c,f),(a>i||a===-1/0&&r===-1/0)&&(r=u,i=a)});return r}function jL(e,t,n){var r=1/0,i=1/0,o,a;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=cn(e)?e:No(e);for(var s=0,l=e.length;s<l;s++)o=e[s],o!=null&&o<r&&(r=o)}else t=Qt(t,n),Sr(e,function(u,c,f){a=t(u,c,f),(a<i||a===1/0&&r===1/0)&&(r=u,i=a)});return r}var XL=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function c5(e){return e?Pi(e)?gs.call(e):Hd(e)?e.match(XL):cn(e)?yi(e,Qd):No(e):[]}function f5(e,t,n){if(t==null||n)return cn(e)||(e=No(e)),e[gh(e.length-1)];var r=c5(e),i=Xt(r);t=Math.max(Math.min(t,i),0);for(var o=i-1,a=0;a<t;a++){var s=gh(a,o),l=r[a];r[a]=r[s],r[s]=l}return r.slice(0,t)}function KL(e){return f5(e,1/0)}function ZL(e,t,n){var r=0;return t=Qt(t,n),rm(yi(e,function(i,o,a){return{value:i,index:r++,criteria:t(i,o,a)}}).sort(function(i,o){var a=i.criteria,s=o.criteria;if(a!==s){if(a>s||a===void 0)return 1;if(a<s||s===void 0)return-1}return i.index-o.index}),"value")}function Qu(e,t){return function(n,r,i){var o=t?[[],[]]:{};return r=Qt(r,i),Sr(n,function(a,s){var l=r(a,s,n);e(o,a,l)}),o}}const QL=Qu(function(e,t,n){Kr(e,n)?e[n].push(t):e[n]=[t]}),JL=Qu(function(e,t,n){e[n]=t}),eO=Qu(function(e,t,n){Kr(e,n)?e[n]++:e[n]=1}),tO=Qu(function(e,t,n){e[n?0:1].push(t)},!0);function nO(e){return e==null?0:cn(e)?e.length:Ct(e).length}function rO(e,t,n){return t in n}const h5=jt(function(e,t){var n={},r=t[0];if(e==null)return n;qt(r)?(t.length>1&&(r=vs(r,t[1])),t=ys(e)):(r=rO,t=xi(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var a=t[i],s=e[a];r(s,a,e)&&(n[a]=s)}return n}),iO=jt(function(e,t){var n=t[0],r;return qt(n)?(n=tm(n),t.length>1&&(r=t[1])):(t=yi(xi(t,!1,!1),String),n=function(i,o){return!pr(t,o)}),h5(e,n,r)});function d5(e,t,n){return gs.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function Qc(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:d5(e,e.length-t)}function el(e,t,n){return gs.call(e,t==null||n?1:t)}function oO(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:el(e,Math.max(0,e.length-t))}function aO(e){return _o(e,Boolean)}function sO(e,t){return xi(e,t,!1)}const m5=jt(function(e,t){return t=xi(t,!0,!0),_o(e,function(n){return!pr(t,n)})}),lO=jt(function(e,t){return m5(e,t)});function _h(e,t,n,r){S3(t)||(r=n,n=t,t=!1),n!=null&&(n=Qt(n,r));for(var i=[],o=[],a=0,s=Xt(e);a<s;a++){var l=e[a],u=n?n(l,a,e):l;t&&!n?((!a||o!==u)&&i.push(l),o=u):n?pr(o,u)||(o.push(u),i.push(l)):pr(i,l)||i.push(l)}return i}const uO=jt(function(e){return _h(xi(e,!0,!0))});function cO(e){for(var t=[],n=arguments.length,r=0,i=Xt(e);r<i;r++){var o=e[r];if(!pr(t,o)){var a;for(a=1;a<n&&pr(arguments[a],o);a++);a===n&&t.push(o)}}return t}function vh(e){for(var t=e&&u5(e,Xt).length||0,n=Array(t),r=0;r<t;r++)n[r]=rm(e,r);return n}const fO=jt(vh);function hO(e,t){for(var n={},r=0,i=Xt(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n}function dO(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;o<r;o++,e+=n)i[o]=e;return i}function mO(e,t){if(t==null||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(gs.call(e,r,r+=t));return n}function im(e,t){return e._chain?je(t).chain():t}function p5(e){return Sr(bh(e),function(t){var n=je[t]=e[t];je.prototype[t]=function(){var r=[this._wrapped];return OR.apply(r,arguments),im(this,n.apply(je,r))}}),je}Sr(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Zu[e];je.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),im(this,n)}});Sr(["concat","join","slice"],function(e){var t=Zu[e];je.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),im(this,n)}});const pO=Object.freeze(Object.defineProperty({__proto__:null,VERSION:_3,after:UL,all:Rp,allKeys:ys,any:Lp,assign:Xl,before:t5,bind:Q3,bindAll:FL,chain:DL,chunk:mO,clone:bL,collect:yi,compact:aO,compose:GL,constant:I3,contains:pr,countBy:eO,create:pL,debounce:LL,default:je,defaults:z3,defer:RL,delay:J3,detect:yh,difference:m5,drop:el,each:Sr,escape:ML,every:Rp,extend:q3,extendOwn:Xl,filter:_o,find:yh,findIndex:nm,findKey:n5,findLastIndex:i5,findWhere:HL,first:Qc,flatten:sO,foldl:Zc,foldr:Bp,forEach:Sr,functions:bh,get:Y3,groupBy:QL,has:yL,head:Qc,identity:Qd,include:pr,includes:pr,indexBy:JL,indexOf:s5,initial:d5,inject:Zc,intersection:cO,invert:U3,invoke:YL,isArguments:Yd,isArray:Pi,isArrayBuffer:C3,isBoolean:S3,isDataView:Wl,isDate:jR,isElement:WR,isEmpty:oL,isEqual:aL,isError:KR,isFinite:eL,isFunction:qt,isMap:uL,isMatch:B3,isNaN:T3,isNull:YR,isNumber:E3,isObject:Ci,isRegExp:XR,isSet:fL,isString:Hd,isSymbol:A3,isTypedArray:D3,isUndefined:M3,isWeakMap:cL,isWeakSet:hL,iteratee:em,keys:Ct,last:oO,lastIndexOf:zL,map:yi,mapObject:_L,matcher:Fa,matches:Fa,max:u5,memoize:BL,methods:bh,min:jL,mixin:p5,negate:tm,noop:j3,now:Ba,object:hO,omit:iO,once:qL,pairs:dL,partial:To,partition:tO,pick:h5,pluck:rm,property:Jd,propertyOf:vL,random:gh,range:dO,reduce:Zc,reduceRight:Bp,reject:VL,rest:el,restArguments:jt,result:IL,sample:f5,select:_o,shuffle:KL,size:nO,some:Lp,sortBy:ZL,sortedIndex:o5,tail:el,take:Qc,tap:gL,template:TL,templateSettings:AL,throttle:e5,times:wL,toArray:c5,toPath:V3,transpose:vh,unescape:EL,union:uO,uniq:_h,unique:_h,uniqueId:$L,unzip:vh,values:No,where:WL,without:lO,wrap:OL,zip:fO},Symbol.toStringTag,{value:"Module"}));var Op=p5(pO);Op._=Op;function bO(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x;function T(P){e[9](P)}let S={callback:e[4]};return e[3]!==void 0&&(S.notes=e[3]),y=new Sn({props:S}),xe.push(()=>nt(y,"notes",T)),M=new sn({props:{exportFunction:e[5]}}),w=new an({props:{importFunction:e[6]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Connect a MIDI device and play pitch bends or vibratos. The line chart
        below shows how far you bend up and down over time`,s=O(),l=C("div"),u=C("label"),c=q(`past seconds
            `),f=C("input"),h=O(),d=C("div"),p=O(),b=C("div"),Ae(y.$$.fragment),v=O(),Ae(M.$$.fragment),g=O(),Ae(w.$$.fragment),k(a,"class","explanation"),k(f,"type","number"),k(f,"min","5"),k(f,"max","60"),k(f,"step","5"),k(l,"class","control"),k(d,"class","visualization"),k(b,"class","control"),k(t,"class","demo")},m(P,I){fe(P,t,I),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f),be(f,e[2]),m(t,h),m(t,d),e[8](d),m(t,p),m(t,b),Se(y,b,null),m(b,v),Se(M,b,null),m(b,g),Se(w,b,null),E=!0,N||(x=ne(f,"input",e[7]),N=!0)},p(P,[I]){(!E||I&1)&&r!==(r=P[0].title+"")&&he(i,r),I&4&&Ne(f.value)!==P[2]&&be(f,P[2]);const $={};!_&&I&8&&(_=!0,$.notes=P[3],tt(()=>_=!1)),y.$set($)},i(P){E||(_e(y.$$.fragment,P),_e(M.$$.fragment,P),_e(w.$$.fragment,P),E=!0)},o(P){Me(y.$$.fragment,P),Me(M.$$.fragment,P),Me(w.$$.fragment,P),E=!1},d(P){P&&ce(t),e[8](null),Ee(y),Ee(M),Ee(w),N=!1,x()}}}let gO=1200,yO=700;function _O(e,t,n){let{demoInfo:r}=t,i,o=10,a=0,s=[];const l=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((_,v)=>{console.log(`MIDI device ${v}: ${_.name}`),_.addListener("pitchbend",u)}),[...W.inputs])},u=_=>{const v=(_.timestamp-a)/1e3,M={value:_.value,time:v};s.push(M),f()},c=()=>{const _=(performance.now()-a)/1e3,v=_-o,M=s.filter(w=>w.time>v),g=et({width:gO,height:yO,marginLeft:80,marginBottom:50,padding:0,x:{domain:[v,_],label:"time in seconds"},y:{domain:[-1,1],label:"bend value"},marks:[Nt([-1,-.5,0,.5,1],{stroke:"#ddd"}),Nt([0]),Gw(M,{x:"time",y:"value",clip:!0,curve:"basis"})]});n(1,i.textContent="",i),i.appendChild(g)},f=e5(c,33),h=()=>{const _={pastTime:o,firstTimeStamp:a,bendValues:s};un(r.id,_)},d=async _=>{if(s.length===0||confirm("Import data and overwrite currently unsaved data?")){const v=await ln(_);n(2,o=v.pastTime),a=v.firstTimeStamp,n(3,s=v.bendValues),c()}};st(()=>{W.enable().then(l).catch(_=>alert(_)),a=performance.now(),c()}),lt(()=>{for(const _ of W.inputs)_.removeListener()});function p(){o=Ne(this.value),n(2,o)}function b(_){xe[_?"unshift":"push"](()=>{i=_,n(1,i)})}function y(_){s=_,n(3,s)}return e.$$set=_=>{"demoInfo"in _&&n(0,r=_.demoInfo)},[r,i,o,s,c,h,d,p,b,y]}class vO extends He{constructor(t){super(),ze(this,t,_O,bO,qe,{demoInfo:0})}}function wO(e,t,n){const r=e.slice();return r[35]=t[n],r}function MO(e,t,n){const r=e.slice();return r[35]=t[n],r}function SO(e){let t;return{c(){t=C("option"),t.textContent=`${e[35]}`,t.__value=e[35],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function EO(e){let t;return{c(){t=C("option"),t.textContent=`${e[35]}`,t.__value=e[35],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function AO(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S,P,I,$,D,A,F,L,X,U,z,G,R,Y,re,Q,J,K,ee,j,V,te,B,se,Z,ie,le,ve,we,H,ue,ye,Fe,We,pe,de,Oe,Re,fn,En;function _t(ae){e[19](ae)}let zn={label:"initial tempo",title:"Set a tempo at which you are able to input the exercise precisely (in BPM)",callback:e[15]};e[2]!==void 0&&(zn.value=e[2]),u=new Hr({props:zn}),xe.push(()=>nt(u,"value",_t));function Ni(ae){e[20](ae)}let Pr={label:"target tempo",title:"Set the tempo you want to be able to play the exercise at (in BPM)",callback:e[15]};e[3]!==void 0&&(Pr.value=e[3]),h=new Hr({props:Pr}),xe.push(()=>nt(h,"value",Ni));let Zr=Pe(["off","32nd","16th","8th"]),An=[];for(let ae=0;ae<4;ae+=1)An[ae]=SO(MO(e,Zr,ae));let Ju=Pe(["quarter","eighth","quarter-triplets","swing"]),Cn=[];for(let ae=0;ae<4;ae+=1)Cn[ae]=EO(wO(e,Ju,ae));return pe=new sn({props:{exportFunction:e[17]}}),Oe=new an({props:{importFunction:e[18]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo. The notes you play are displayed in a guitar-tab-like
        visualization with crosses, numbers above notes indicate the fret. The
        darkness (white to black) encodes the notes' velocities, so eventual
        noise (unintended notes) is less distracting.`,s=O(),l=C("div"),Ae(u.$$.fragment),f=O(),Ae(h.$$.fragment),p=O(),b=C("label"),y=q(`tempo increase
            `),_=C("input"),v=O(),M=C("label"),g=q(`quantize exercise
            `),w=C("select");for(let ae=0;ae<4;ae+=1)An[ae].c();E=O(),N=C("div"),x=C("label"),T=q(`pre-defined exercise
            `),S=C("select");for(let ae=0;ae<4;ae+=1)Cn[ae].c();P=O(),I=C("button"),$=q("input exercise"),A=O(),F=C("button"),L=q("save exercise"),U=O(),z=C("button"),G=q("start practice"),Y=O(),re=C("button"),Q=q("stop practice"),K=O(),ee=C("div"),j=q("current step: "),V=C("b"),te=q(e[6]),B=q(" current tempo: "),se=C("b"),Z=q(e[7]),ie=q(" BPM"),le=O(),ve=C("div"),we=O(),H=C("div"),ue=C("button"),ye=q("reset practice"),We=O(),Ae(pe.$$.fragment),de=O(),Ae(Oe.$$.fragment),k(a,"class","explanation"),k(_,"type","number"),k(_,"min","1"),k(_,"max","20"),k(_,"step","1"),k(b,"title","Set the tempo increase between practice runs (in BPM)"),e[5]===void 0&&at(()=>e[22].call(w)),k(l,"class","control"),k(I,"title","Start recording the exercise."),I.disabled=D=e[6]==="input exercise"||e[6]==="practice",k(F,"title","Stop recording the exercise."),F.disabled=X=e[6]!=="input exercise",k(z,"title","Start recording the practice with speed-up."),z.disabled=R=e[9].length===0,k(re,"title","Stop recording the practice with speed-up."),re.disabled=J=e[6]!=="practice",k(N,"class","control"),k(ve,"class","visualization"),k(ue,"title","Clear practice but not exercise"),ue.disabled=Fe=e[6]!=="",k(H,"class","control"),k(t,"class","demo")},m(ae,Xe){fe(ae,t,Xe),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),Se(u,l,null),m(l,f),Se(h,l,null),m(l,p),m(l,b),m(b,y),m(b,_),be(_,e[4]),m(l,v),m(l,M),m(M,g),m(M,w);for(let Je=0;Je<4;Je+=1)An[Je]&&An[Je].m(w,null);$e(w,e[5],!0),m(t,E),m(t,N),m(N,x),m(x,T),m(x,S);for(let Je=0;Je<4;Je+=1)Cn[Je]&&Cn[Je].m(S,null);m(N,P),m(N,I),m(I,$),m(N,A),m(N,F),m(F,L),m(N,U),m(N,z),m(z,G),m(N,Y),m(N,re),m(re,Q),m(t,K),m(t,ee),m(ee,j),m(ee,V),m(V,te),m(ee,B),m(ee,se),m(se,Z),m(ee,ie),m(t,le),m(t,ve),e[23](ve),m(t,we),m(t,H),m(H,ue),m(ue,ye),m(H,We),Se(pe,H,null),m(H,de),Se(Oe,H,null),Re=!0,fn||(En=[ne(_,"input",e[21]),ne(w,"change",e[22]),ne(w,"change",e[15]),ne(S,"change",e[16]),ne(I,"click",e[11]),ne(F,"click",e[12]),ne(z,"click",e[13]),ne(re,"click",e[14]),ne(ue,"click",e[24])],fn=!0)},p(ae,Xe){(!Re||Xe[0]&1)&&r!==(r=ae[0].title+"")&&he(i,r);const Je={};!c&&Xe[0]&4&&(c=!0,Je.value=ae[2],tt(()=>c=!1)),u.$set(Je);const Io={};!d&&Xe[0]&8&&(d=!0,Io.value=ae[3],tt(()=>d=!1)),h.$set(Io),Xe[0]&16&&Ne(_.value)!==ae[4]&&be(_,ae[4]),Xe[0]&32&&$e(w,ae[5]),(!Re||Xe[0]&64&&D!==(D=ae[6]==="input exercise"||ae[6]==="practice"))&&(I.disabled=D),(!Re||Xe[0]&64&&X!==(X=ae[6]!=="input exercise"))&&(F.disabled=X),(!Re||Xe[0]&512&&R!==(R=ae[9].length===0))&&(z.disabled=R),(!Re||Xe[0]&64&&J!==(J=ae[6]!=="practice"))&&(re.disabled=J),(!Re||Xe[0]&64)&&he(te,ae[6]),(!Re||Xe[0]&128)&&he(Z,ae[7]),(!Re||Xe[0]&64&&Fe!==(Fe=ae[6]!==""))&&(ue.disabled=Fe)},i(ae){Re||(_e(u.$$.fragment,ae),_e(h.$$.fragment,ae),_e(pe.$$.fragment,ae),_e(Oe.$$.fragment,ae),Re=!0)},o(ae){Me(u.$$.fragment,ae),Me(h.$$.fragment,ae),Me(pe.$$.fragment,ae),Me(Oe.$$.fragment,ae),Re=!1},d(ae){ae&&ce(t),Ee(u),Ee(h),Ue(An,ae),Ue(Cn,ae),e[23](null),Ee(pe),Ee(Oe),fn=!1,Ve(En)}}}let Gp=1e3,Up=150,Gs=6;function CO(e,t,n){const r=e[0].time;return e.map(o=>{let a=o.time-r;if(t!=="off"){let l;t==="8th"&&(l=n/2),t==="16th"&&(l=n/4),t==="32nd"&&(l=n/8),a=Math.round(a/l)*l}const s=a/n;return{...o,time:s}})}function PO(e,t,n){let{demoInfo:r}=t,i,o=new qd,a=!0,s,l=60,u=120,c=10,f="off",h="",d=u,p=0,b=[],y,_=new Map,v=[64,59,55,50,45,40];const M=v.map(Ut.fromMidiSharps),g=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((G,R)=>{console.log(`MIDI device ${R}: ${G.name}`),G.addListener("noteon",w)}),[...W.inputs])},w=async G=>{const R=(G.timestamp-p)/1e3,Y=G.message.channel-1,re={time:R,string:Y,fret:G.note.number-v[Y],velocity:G.velocity};if(h==="input exercise")n(9,b=[...b,re]);else if(h==="practice"){_.has(d)||_.set(d,[]);const Q=_.get(d);a&&Q.push(re)}P()},E=async()=>{const G=_.get(d);if(!G||!G.length)return;const R=Gt(G,K=>K.time),re=(performance.now()-p)/1e3-R;let Q=Lt(d);re/Q>=y&&(console.log("increasing bpm"),o.stop(),d<=u?(n(7,d+=c),a=!1,await jy(1),o.start(d,4),_.has(d)&&_.set(d,[]),a=!0):S())},N=()=>{n(6,h="input exercise"),n(9,b=[]),n(10,_=new Map),o.start(l,4),P()},x=()=>{if(n(6,h=""),o.stop(),b.length>0){const G=ot(b,Y=>Y.time)-Gt(b,Y=>Y.time);let R=Lt(l);y=Math.ceil(G/R)}},T=async()=>{if(b.length===0){alert("You need to input an exercise first");return}n(6,h="practice"),n(7,d=l),n(10,_=new Map),o.start(d,4),s=setInterval(E,100)},S=()=>{n(6,h=""),n(7,d=u),clearInterval(s),o.stop()},P=()=>{if(n(1,i.textContent="",i),b.length===0)return;let G=Lt(l);const R=CO(b,f,G);let Y=Math.ceil(ot(R,Q=>Q.time)/4*4)+.5;const re=et({width:Gp,height:Up,marginLeft:40,x:{label:"time in beats",domain:[0,Y]},y:{domain:Ce(0,Gs),tickFormat:Q=>M[Q],tickSize:0},marks:[$t(Ce(0,Y,1),{stroke:"#ddd"}),Nt(Ce(0,Gs),{stroke:"#ddd"}),$t(Ce(0,Y,4)),_n(R,{symbol:"times",stroke:"#333",x:Q=>Q.time,y:Q=>Q.string,r:5})]});i.appendChild(re);for(const[Q,J]of _){if(J.length===0)continue;const K=J[0].time;G=Lt(Q);const ee=J.map(V=>({...V,time:(V.time-K)/G})),j=et({width:Gp,height:Up,marginLeft:40,x:{label:"time in beats",domain:[0,Y]},y:{label:`${Q} BPM`,domain:Ce(0,Gs),tickFormat:V=>M[V],tickSize:0},color:{domain:[0,1],scheme:"Greys"},marks:[$t(Ce(0,Y,1),{stroke:"#ddd"}),$t(Ce(0,Y,4)),Nt(Ce(0,Gs),{stroke:"#ddd"}),_n(ee,{symbol:"times",stroke:"velocity",x:V=>V.time,y:V=>V.string,r:4}),wr(ee,{text:"fret",fill:"velocity",x:V=>V.time,y:V=>V.string,textAnchor:"middle",dy:-10})]});i.appendChild(j)}};st(()=>{W.enable().then(g).catch(G=>alert(G)),n(8,p=performance.now()),P()}),lt(()=>{for(const G of W.inputs)G.removeListener();clearInterval(s),o.stop()});const I=G=>{const R=G.target.value,Y=new Map([["quarter",Ce(0,8,1)],["eighth",Ce(0,8,.5)],["quarter-triplets",Ce(0,8,1/3)],["swing",Ce(0,8,.5).map((J,K)=>K%2===0?K:K+.2)]]),re=Lt(l);n(5,f="off");const Q=Y.get(R);n(9,b=Q.map(J=>J*re)),y=Math.ceil(ot(Q)+1),n(9,b=b.map(J=>({time:J,string:5,fret:5}))),P()},$=()=>{const G={initialTempo:l,targetTempo:u,tempoIncrease:c,quantize:f,currentStep:h,currentTempo:d,firstTimeStamp:p,exerciseNotes:b,exerciseBeatCount:y,practiceRecordings:_};un(r.id,G)},D=async G=>{if(b.length===0||confirm("Import data and overwrite currently unsaved data?")){const R=await ln(G);n(2,l=R.initialTempo),n(3,u=R.targetTempo),n(4,c=R.tempoIncrease),n(5,f=R.quantize),n(6,h=R.currentStep),n(7,d=R.currentTempo),n(8,p=R.firstTimeStamp),n(9,b=R.exerciseNotes),y=R.exerciseBeatCount,n(10,_=R.practiceRecordings),P()}};function A(G){l=G,n(2,l)}function F(G){u=G,n(3,u)}function L(){c=Ne(this.value),n(4,c)}function X(){f=pt(this),n(5,f)}function U(G){xe[G?"unshift":"push"](()=>{i=G,n(1,i)})}const z=()=>{confirm("Reset practice?")&&(n(10,_=new Map),n(8,p=performance.now()),P())};return e.$$set=G=>{"demoInfo"in G&&n(0,r=G.demoInfo)},[r,i,l,u,c,f,h,d,p,b,_,N,x,T,S,P,I,$,D,A,F,L,X,U,z]}class xO extends He{constructor(t){super(),ze(this,t,PO,AO,qe,{demoInfo:0},null,[-1,-1])}}function qp(e,t,n){const r=e.slice();return r[23]=t[n],r}function zp(e,t,n){const r=e.slice();return r[26]=t[n],r}function Hp(e){let t,n=e[26]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[26],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function Vp(e){let t,n=e[23]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[23],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function NO(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T=(e[5]?ft:ht)+"",S,P,I,$,D=(e[6]?ft:ht)+"",A,F,L,X,U,z,G,R,Y,re,Q,J,K,ee,j,V,te=Pe(e[9]),B=[];for(let H=0;H<te.length;H+=1)B[H]=Hp(zp(e,te,H));let se=Pe(e[10]),Z=[];for(let H=0;H<se.length;H+=1)Z[H]=Vp(qp(e,se,H));function ie(H){e[16](H)}let le={callback:e[11]};e[7]!==void 0&&(le.value=e[7]),g=new Hr({props:le}),xe.push(()=>nt(g,"value",ie));function ve(H){e[20](H)}let we={callback:e[11]};return e[8]!==void 0&&(we.notes=e[8]),z=new Sn({props:we}),xe.push(()=>nt(z,"notes",ve)),Y=new sn({props:{exportFunction:e[12]}}),Q=new an({props:{importFunction:e[13]}}),K=new Xu({props:{tempo:e[7],accent:4}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected) and
        start playing. The bar chart below shows how often you played each scale
        degree.`),f=O(),h=C("div"),d=C("label"),p=q(`scale
            `),b=C("select");for(let H=0;H<B.length;H+=1)B[H].c();y=O(),_=C("select");for(let H=0;H<Z.length;H+=1)Z[H].c();v=O(),M=C("div"),Ae(g.$$.fragment),E=O(),N=C("button"),x=q("colors "),S=q(T),P=O(),I=C("button"),$=q("non-scale notes "),A=q(D),F=O(),L=C("div"),X=O(),U=C("div"),Ae(z.$$.fragment),R=O(),Ae(Y.$$.fragment),re=O(),Ae(Q.$$.fragment),J=O(),Ae(K.$$.fragment),k(a,"class","explanation"),e[3]===void 0&&at(()=>e[14].call(b)),e[4]===void 0&&at(()=>e[15].call(_)),k(h,"class","control svelte-13613lz"),k(N,"title","Use colors for root, in-scale, outside-scale"),k(I,"title","Show notes outside the scale"),k(M,"class","control svelte-13613lz"),k(L,"class","visualization svelte-13613lz"),k(U,"class","control svelte-13613lz"),k(t,"class","demo")},m(H,ue){fe(H,t,ue),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(t,f),m(t,h),m(h,d),m(d,p),m(d,b);for(let ye=0;ye<B.length;ye+=1)B[ye]&&B[ye].m(b,null);$e(b,e[3],!0),m(d,y),m(d,_);for(let ye=0;ye<Z.length;ye+=1)Z[ye]&&Z[ye].m(_,null);$e(_,e[4],!0),m(t,v),m(t,M),Se(g,M,null),m(M,E),m(M,N),m(N,x),m(N,S),m(M,P),m(M,I),m(I,$),m(I,A),m(t,F),m(t,L),e[19](L),m(t,X),m(t,U),Se(z,U,null),m(U,R),Se(Y,U,null),m(U,re),Se(Q,U,null),m(U,J),Se(K,U,null),ee=!0,j||(V=[ne(b,"change",e[14]),ne(b,"change",e[11]),ne(_,"change",e[15]),ne(_,"change",e[11]),ne(N,"click",e[17]),ne(I,"click",e[18])],j=!0)},p(H,[ue]){if((!ee||ue&1)&&r!==(r=H[0].title+"")&&he(i,r),(!ee||ue&4)&&l!==(l=H[2].length+"")&&he(u,l),ue&512){te=Pe(H[9]);let pe;for(pe=0;pe<te.length;pe+=1){const de=zp(H,te,pe);B[pe]?B[pe].p(de,ue):(B[pe]=Hp(de),B[pe].c(),B[pe].m(b,null))}for(;pe<B.length;pe+=1)B[pe].d(1);B.length=te.length}if(ue&520&&$e(b,H[3]),ue&1024){se=Pe(H[10]);let pe;for(pe=0;pe<se.length;pe+=1){const de=qp(H,se,pe);Z[pe]?Z[pe].p(de,ue):(Z[pe]=Vp(de),Z[pe].c(),Z[pe].m(_,null))}for(;pe<Z.length;pe+=1)Z[pe].d(1);Z.length=se.length}ue&1040&&$e(_,H[4]);const ye={};!w&&ue&128&&(w=!0,ye.value=H[7],tt(()=>w=!1)),g.$set(ye),(!ee||ue&32)&&T!==(T=(H[5]?ft:ht)+"")&&he(S,T),(!ee||ue&64)&&D!==(D=(H[6]?ft:ht)+"")&&he(A,D);const Fe={};!G&&ue&256&&(G=!0,Fe.notes=H[8],tt(()=>G=!1)),z.$set(Fe);const We={};ue&128&&(We.tempo=H[7]),K.$set(We)},i(H){ee||(_e(g.$$.fragment,H),_e(z.$$.fragment,H),_e(Y.$$.fragment,H),_e(Q.$$.fragment,H),_e(K.$$.fragment,H),ee=!0)},o(H){Me(g.$$.fragment,H),Me(z.$$.fragment,H),Me(Y.$$.fragment,H),Me(Q.$$.fragment,H),Me(K.$$.fragment,H),ee=!1},d(H){H&&ce(t),Ue(B,H),Ue(Z,H),Ee(g),e[19](null),Ee(z),Ee(Y),Ee(Q),Ee(K),j=!1,Ve(V)}}}let TO=1e3,IO=650;function kO(e,t,n){let{demoInfo:r}=t,i,o=[],a="A",s="minor pentatonic",l=!0,u=!0,c=120,f=[];const h=ms,d=wt.names(),p=()=>{n(2,o=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((S,P)=>{console.log(`MIDI device ${P}: ${S.name}`),S.addListener("noteon",b)}),n(2,o=[...W.inputs]))},b=S=>{let P=0;f.length>0&&(P=S.timestamp/1e3-f[0].time);const I={number:S.note.number,velocity:S.rawVelocity,time:P};f.push(I),y()},y=()=>{if(f.length===0)return;const S=h.indexOf(a),P=wt.get(`${a} ${s}`),I=P.notes.map((z,G)=>{const R=h.indexOf(z);let Y=R-S;return Y=Y>=0?Y:Y+12,{name:z,chroma:R,interval:P.intervals[G],degree:G,offset:Y}}),$=new Set(I.map(z=>z.offset)),D=Lt(c)*4,A=da(f,z=>Math.floor(z.time/D));let F=[];for(const[z,G]of A){const R=G.map(re=>{const J=re.number%12-S;return J>=0?J:J+12}),Y=da(R,re=>re).map(([re,Q])=>({value:re,count:Q.length,barId:z}));F=F.concat(Y)}console.log(F);const X=Math.floor(f.at(-1).time/D)-9;console.log({minBar:X}),F=F.filter(z=>z.barId>=X);const U=et({width:TO,height:IO,marginLeft:70,marginRight:10,color:{legend:l,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:z=>h[(z+S)%12],domain:u?Ce(0,12,1):[...$],reverse:!0,label:"notes, increasing semitones from root "},marks:[ds(F,{x:"count",y:"value",fx:"barId",fill:z=>l?z.value===0?"#666":$.has(z.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});n(1,i.textContent="",i),i.appendChild(U)},_=()=>{const S={root:a,scale:s,useColors:l,showOutsideScale:u,notes:f,tempo:c};un(r.id,S)},v=async S=>{if(f.length===0||confirm("Import data and overwrite currently unsaved data?")){const P=await ln(S);n(3,a=P.root),n(4,s=P.scale),n(5,l=P.useColors),n(6,u=P.showOutsideScale),n(8,f=P.notes),n(7,c=P.tempo),y()}};st(()=>{W.enable().then(p).catch(S=>alert(S)),y()}),lt(()=>{for(const S of W.inputs)S.removeListener()});function M(){a=pt(this),n(3,a),n(9,h)}function g(){s=pt(this),n(4,s),n(10,d)}function w(S){c=S,n(7,c)}const E=()=>{n(5,l=!l),y()},N=()=>{n(6,u=!u),y()};function x(S){xe[S?"unshift":"push"](()=>{i=S,n(1,i)})}function T(S){f=S,n(8,f)}return e.$$set=S=>{"demoInfo"in S&&n(0,r=S.demoInfo)},[r,i,o,a,s,l,u,c,f,h,d,y,_,v,M,g,w,E,N,x,T]}class $O extends He{constructor(t){super(),ze(this,t,kO,NO,qe,{demoInfo:0})}}function DO(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M=(e[5]?ht:ft)+"",g,w,E,N,x,T,S,P,I,$,D,A,F,L,X,U;function z(R){e[17](R)}let G={callback:e[8]};return e[7]!==void 0&&(G.notes=e[7]),P=new Sn({props:G}),xe.push(()=>nt(P,"notes",z)),D=new sn({props:{exportFunction:e[9]}}),F=new an({props:{importFunction:e[10]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Allow microphone access and play pitch bends or vibratos. The line chart
        below shows how far you bend up and down over time.`,s=O(),l=C("div"),u=C("label"),c=q(`past seconds
            `),f=C("input"),h=O(),d=C("label"),p=q(`min. decibels
            `),b=C("input"),y=O(),_=C("button"),v=q("octave "),g=q(M),w=O(),E=C("button"),E.textContent="resume",N=O(),x=C("div"),T=O(),S=C("div"),Ae(P.$$.fragment),$=O(),Ae(D.$$.fragment),A=O(),Ae(F.$$.fragment),k(a,"class","explanation"),k(f,"type","number"),k(f,"min","5"),k(f,"max","60"),k(f,"step","5"),k(b,"type","number"),k(b,"min","-40"),k(b,"max","-5"),k(b,"step","5"),k(d,"title","The minimum loudness in decibels for a sound to be registered as input. Lower means fainter notes will be registered but there will be more noise such as octave errors."),k(_,"title","When ignoring the octave, the lower visualization will only show the note's chroma from C to B"),k(E,"title","Press this button if your browser prevents audio access because there needs to be a user interaction first"),k(l,"class","control"),k(x,"class","visualization"),k(S,"class","control"),k(t,"class","demo")},m(R,Y){fe(R,t,Y),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f),be(f,e[4]),m(l,h),m(l,d),m(d,p),m(d,b),be(b,e[6]),m(l,y),m(l,_),m(_,v),m(_,g),m(l,w),m(l,E),m(t,N),m(t,x),e[16](x),m(t,T),m(t,S),Se(P,S,null),m(S,$),Se(D,S,null),m(S,A),Se(F,S,null),L=!0,X||(U=[ne(f,"input",e[11]),ne(b,"input",e[12]),ne(b,"change",e[13]),ne(_,"click",e[14]),ne(E,"click",e[15])],X=!0)},p(R,[Y]){(!L||Y&1)&&r!==(r=R[0].title+"")&&he(i,r),Y&16&&Ne(f.value)!==R[4]&&be(f,R[4]),Y&64&&Ne(b.value)!==R[6]&&be(b,R[6]),(!L||Y&32)&&M!==(M=(R[5]?ht:ft)+"")&&he(g,M);const re={};!I&&Y&128&&(I=!0,re.notes=R[7],tt(()=>I=!1)),P.$set(re)},i(R){L||(_e(P.$$.fragment,R),_e(D.$$.fragment,R),_e(F.$$.fragment,R),L=!0)},o(R){Me(P.$$.fragment,R),Me(D.$$.fragment,R),Me(F.$$.fragment,R),L=!1},d(R){R&&ce(t),e[16](null),Ee(P),Ee(D),Ee(F),X=!1,Ve(U)}}}let FO=1200,BO=500;const Yp=16;function RO(e,t,n){let{demoInfo:r}=t,i,o,a,s,l,u=10,c=!0,f=-25,h=0,d=[],p=0;function b(S,P){a.getFloatTimeDomainData(S);const I=s.findPitch(S,P),$=I[0];I[1];const D=Ut.fromFreq($),A=Ut.midi(D),F=Uf.freqToMidi($),L=(F-A)*100,X=(performance.now()-h)/1e3,U={pitch:$,noteMidi:A,actualMidi:F,actualMidiChroma:F%12,value:L,time:X};d.push(U),n(7,d=d.slice(-(1e3/Yp)*u)),y(),l=requestAnimationFrame(()=>b(S,P))}const y=()=>{n(1,i.textContent="",i);const S=(performance.now()-h)/1e3,P=S-u,I=1e3/Yp;let $=Math.round(al(d.slice(-I),A=>A.actualMidi));isNaN($)?$=p:p=$;const D=et({width:FO,height:BO,marginLeft:80,marginBottom:50,padding:0,x:{domain:[P,S],label:"time in seconds"},y:{domain:c?[0,12]:[$-5,$+5],label:c?"chroma":"pitch",tickFormat:A=>Math.floor(A)===A?Uf.midiToNoteName(A,{pitchClass:c,sharps:!0}):"",grid:!0},marks:[Gw(d,{x:"time",y:c?"actualMidiChroma":"actualMidi",clip:!0,curve:"basis"})]});i.appendChild(D)},_=()=>{const S={pastTime:u,firstTimeStamp:h,bendValues:d};un(r.id,S)},v=async S=>{if(d.length===0||confirm("Import data and overwrite currently unsaved data?")){const P=await ln(S);n(4,u=P.pastTime),h=P.firstTimeStamp,n(7,d=P.bendValues),y()}};st(()=>{h=performance.now(),n(2,o=new window.AudioContext),a=o.createAnalyser(),navigator.mediaDevices.getUserMedia({audio:!0}).then(S=>{o.createMediaStreamSource(S).connect(a),n(3,s=Wi.forFloat32Array(a.fftSize)),n(3,s.minVolumeDecibels=f,s);const P=new Float32Array(s.inputLength);b(P,o.sampleRate)}),y()}),lt(()=>{clearTimeout(l),cancelAnimationFrame(l)});function M(){u=Ne(this.value),n(4,u)}function g(){f=Ne(this.value),n(6,f)}const w=()=>n(3,s.minVolumeDecibels=f,s),E=()=>{n(5,c=!c)},N=()=>o.resume();function x(S){xe[S?"unshift":"push"](()=>{i=S,n(1,i)})}function T(S){d=S,n(7,d)}return e.$$set=S=>{"demoInfo"in S&&n(0,r=S.demoInfo)},[r,i,o,s,u,c,f,d,y,_,v,M,g,w,E,N,x,T]}class LO extends He{constructor(t){super(),ze(this,t,RO,DO,qe,{demoInfo:0})}}function OO(e,t,n){const r=e.slice();return r[19]=t[n],r}function GO(e){let t;return{c(){t=C("option"),t.textContent=`${e[19]}`,t.__value=e[19],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function UO(e){let t,n,r=e[0].title+"",i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S,P=Pe(xo),I=[];for(let A=0;A<P.length;A+=1)I[A]=GO(OO(e,P,A));function $(A){e[10](A)}let D={callback:e[6]};return e[3]!==void 0&&(D.value=e[3]),d=new Ku({props:D}),xe.push(()=>nt(d,"value",$)),w=new sn({props:{exportFunction:e[7]}}),N=new an({props:{importFunction:e[8]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),a.textContent=`Notes that you play are shown as bars. The color shows which scale
        subset a note belongs to. The bars' height encodes the notes' durations.`,s=O(),l=C("div"),u=C("label"),c=q(`root note
            `),f=C("select");for(let A=0;A<I.length;A+=1)I[A].c();h=O(),Ae(d.$$.fragment),b=O(),y=C("div"),_=O(),v=C("div"),M=C("button"),M.textContent="reset",g=O(),Ae(w.$$.fragment),E=O(),Ae(N.$$.fragment),k(a,"class","explanation"),e[2]===void 0&&at(()=>e[9].call(f)),k(l,"class","control"),k(y,"class","visualization"),k(M,"title","Clear all played notes"),k(v,"class","control"),k(t,"class","demo")},m(A,F){fe(A,t,F),m(t,n),m(n,i),m(t,o),m(t,a),m(t,s),m(t,l),m(l,u),m(u,c),m(u,f);for(let L=0;L<I.length;L+=1)I[L]&&I[L].m(f,null);$e(f,e[2],!0),m(l,h),Se(d,l,null),m(t,b),m(t,y),e[11](y),m(t,_),m(t,v),m(v,M),m(v,g),Se(w,v,null),m(v,E),Se(N,v,null),x=!0,T||(S=[ne(f,"change",e[9]),ne(f,"change",e[6]),ne(M,"click",e[12])],T=!0)},p(A,[F]){(!x||F&1)&&r!==(r=A[0].title+"")&&he(i,r),F&4&&$e(f,A[2]);const L={};!p&&F&8&&(p=!0,L.value=A[3],tt(()=>p=!1)),d.$set(L)},i(A){x||(_e(d.$$.fragment,A),_e(w.$$.fragment,A),_e(N.$$.fragment,A),x=!0)},o(A){Me(d.$$.fragment,A),Me(w.$$.fragment,A),Me(N.$$.fragment,A),x=!1},d(A){A&&ce(t),Ue(I,A),Ee(d),e[11](null),Ee(w),Ee(N),T=!1,Ve(S)}}}let qO=1200,zO=280;function HO(e,t,n){let{demoInfo:r}=t,i,o="A",a=50,s=[],l,u=new Map;const c=()=>{W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((w,E)=>{console.log(`MIDI device ${E}: ${w.name}`),w.addListener("noteon",f),w.addListener("noteoff",h),w.addListener("controlchange",d)}),[...W.inputs])},f=w=>{s.length===0&&(l=w.timestamp);const E=(w.timestamp-l)/1e3,N={name:w.note.name,number:w.note.number,velocity:w.rawVelocity,time:E,channel:w.message.channel};if(u.has(w.note.number)){const x=u.get(w.note.number);x.end===void 0&&(x.end=E)}s.push(N),u.set(w.note.number,N),p()},h=w=>{if(u.has(w.note.number)){const E=u.get(w.note.number),N=(w.timestamp-l)/1e3;E.end=N,E.duration=E.end-E.time}},d=w=>{const E=Pu(w.rawValue*2,20,250);n(3,a=E),p()},p=()=>{const w=new Set(wt.get(`${o} minor`).notes),E=new Set(wt.get(`${o} minor blues`).notes),N=new Set(wt.get(`${o} minor pentatonic`).notes),x=ms.map(P=>P===o?"#1B5E20":N.has(P)?"#689F38":E.has(P)?"cornflowerblue":w.has(P)?"#D4E157":"lightgray"),T=s.slice(-a),S=et({width:qO,height:zO,marginLeft:80,marginBottom:50,padding:0,x:{axis:!1},y:{},color:{legend:!0,domain:Ce(12),range:x,tickFormat:P=>xo[P],marginLeft:290},marks:[Nt([0],{stroke:"#ddd"}),po(T,{x:(P,I)=>I,y:"duration",fill:P=>P.number%12,inset:.5,rx:4,tip:!0}),wr(T,{x:(P,I)=>I,y:"duration",text:"name",fontSize:14,dy:-10})]});n(1,i.textContent="",i),i.appendChild(S)},b=()=>{const w={root:o,notes:s,pastNoteCount:a};un(r.id,w)},y=async w=>{if(s.length===0||confirm("Import data and overwrite currently unsaved data?")){const E=await ln(w);n(2,o=E.root),n(4,s=E.notes),n(3,a=E.pastNoteCount),p()}};st(()=>{W.enable().then(c).catch(w=>alert(w)),p()}),lt(()=>{for(const w of W.inputs)w.removeListener()});function _(){o=pt(this),n(2,o)}function v(w){a=w,n(3,a)}function M(w){xe[w?"unshift":"push"](()=>{i=w,n(1,i)})}const g=()=>{confirm("Reset played notes?")&&(n(4,s=[]),n(5,u=new Map),p())};return e.$$set=w=>{"demoInfo"in w&&n(0,r=w.demoInfo)},[r,i,o,a,s,u,p,b,y,_,v,M,g]}class VO extends He{constructor(t){super(),ze(this,t,HO,UO,qe,{demoInfo:0})}}function YO(e,t,n){const r=e.slice();return r[25]=t[n],r}function Wp(e,t,n){const r=e.slice();return r[25]=t[n],r}function jp(e){let t,n=e[25]+"",r;return{c(){t=C("option"),r=q(n),t.__value=e[25],be(t,t.__value)},m(i,o){fe(i,t,o),m(t,r)},p:ge,d(i){i&&ce(t)}}}function WO(e){let t;return{c(){t=C("option"),t.textContent=`1/${e[25]} note`,t.__value=e[25],be(t,t.__value)},m(n,r){fe(n,t,r)},p:ge,d(n){n&&ce(t)}}}function jO(e){let t,n,r=e[0].title+"",i,o,a,s,l=e[2].length+"",u,c,f,h,d,p,b,y,_,v,M,g,w,E,N,x,T,S,P,I,$=e[7]?"area":"bars",D,A,F,L,X,U,z,G,R,Y,re,Q,J,K,ee,j,V;function te(H){e[13](H)}let B={callback:e[10]};e[3]!==void 0&&(B.value=e[3]),d=new Hr({props:B}),xe.push(()=>nt(d,"value",te));let se=Pe(e[9]),Z=[];for(let H=0;H<se.length;H+=1)Z[H]=jp(Wp(e,se,H));let ie=Pe([16,32,64,128]),le=[];for(let H=0;H<4;H+=1)le[H]=WO(YO(e,ie,H));function ve(H){e[19](H)}let we={callback:e[10]};return e[8]!==void 0&&(we.notes=e[8]),z=new Sn({props:we}),xe.push(()=>nt(z,"notes",ve)),Y=new sn({props:{exportFunction:e[11]}}),Q=new an({props:{importFunction:e[12]}}),K=new Xu({props:{tempo:e[3],accent:+e[4].split(":")[0]}}),{c(){t=C("main"),n=C("h2"),i=q(r),o=O(),a=C("p"),s=q("Connect a MIDI instrument (currently "),u=q(l),c=q(` connected), choose
        your tempo and subdivision, and start playing. The bar chart will show you
        how often you hit each time bin and the notes will be shown as ticks, one
        layer per bar. You can play freely, use the integrated metronome, or play
        a song in the background (in another tab). Light gray wedges show if you
        stayed within on bin size of your defined timing grid. All notes will be
        timed relative to the first one, but you can adjust all notes to make them
        earlier or later in case you messed up the first one.`),f=O(),h=C("div"),Ae(d.$$.fragment),b=O(),y=C("label"),_=q(`grid
            `),v=C("select");for(let H=0;H<Z.length;H+=1)Z[H].c();M=O(),g=C("label"),w=q(`binning
            `),E=C("select");for(let H=0;H<4;H+=1)le[H].c();N=O(),x=C("label"),T=q(`adjust
            `),S=C("input"),P=O(),I=C("button"),D=q($),A=O(),F=C("div"),L=C("canvas"),X=O(),U=C("div"),Ae(z.$$.fragment),R=O(),Ae(Y.$$.fragment),re=O(),Ae(Q.$$.fragment),J=O(),Ae(K.$$.fragment),k(a,"class","explanation"),e[4]===void 0&&at(()=>e[14].call(v)),k(y,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[5]===void 0&&at(()=>e[15].call(E)),k(g,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),k(S,"type","number"),k(S,"step","0.01"),k(S,"min","-2"),k(S,"max","2"),St(S,"width","55px"),k(x,"title","Shift all notes by an amount in seconds"),k(I,"title","Toggle between bars and area"),k(h,"class","control"),St(L,"width",Ri+"px"),St(L,"height",wh+"px"),k(F,"class","visualization"),k(U,"class","control"),k(t,"class","demo")},m(H,ue){fe(H,t,ue),m(t,n),m(n,i),m(t,o),m(t,a),m(a,s),m(a,u),m(a,c),m(t,f),m(t,h),Se(d,h,null),m(h,b),m(h,y),m(y,_),m(y,v);for(let ye=0;ye<Z.length;ye+=1)Z[ye]&&Z[ye].m(v,null);$e(v,e[4],!0),m(h,M),m(h,g),m(g,w),m(g,E);for(let ye=0;ye<4;ye+=1)le[ye]&&le[ye].m(E,null);$e(E,e[5],!0),m(h,N),m(h,x),m(x,T),m(x,S),be(S,e[6]),m(h,P),m(h,I),m(I,D),m(t,A),m(t,F),m(F,L),e[18](L),m(t,X),m(t,U),Se(z,U,null),m(U,R),Se(Y,U,null),m(U,re),Se(Q,U,null),m(U,J),Se(K,U,null),ee=!0,j||(V=[ne(v,"change",e[14]),ne(v,"change",e[10]),ne(E,"change",e[15]),ne(E,"change",e[10]),ne(S,"input",e[16]),ne(S,"change",e[10]),ne(I,"click",e[17])],j=!0)},p(H,[ue]){(!ee||ue&1)&&r!==(r=H[0].title+"")&&he(i,r),(!ee||ue&4)&&l!==(l=H[2].length+"")&&he(u,l);const ye={};if(!p&&ue&8&&(p=!0,ye.value=H[3],tt(()=>p=!1)),d.$set(ye),ue&512){se=Pe(H[9]);let pe;for(pe=0;pe<se.length;pe+=1){const de=Wp(H,se,pe);Z[pe]?Z[pe].p(de,ue):(Z[pe]=jp(de),Z[pe].c(),Z[pe].m(v,null))}for(;pe<Z.length;pe+=1)Z[pe].d(1);Z.length=se.length}ue&528&&$e(v,H[4]),ue&32&&$e(E,H[5]),ue&64&&Ne(S.value)!==H[6]&&be(S,H[6]),(!ee||ue&128)&&$!==($=H[7]?"area":"bars")&&he(D,$);const Fe={};!G&&ue&256&&(G=!0,Fe.notes=H[8],tt(()=>G=!1)),z.$set(Fe);const We={};ue&8&&(We.tempo=H[3]),ue&16&&(We.accent=+H[4].split(":")[0]),K.$set(We)},i(H){ee||(_e(d.$$.fragment,H),_e(z.$$.fragment,H),_e(Y.$$.fragment,H),_e(Q.$$.fragment,H),_e(K.$$.fragment,H),ee=!0)},o(H){Me(d.$$.fragment,H),Me(z.$$.fragment,H),Me(Y.$$.fragment,H),Me(Q.$$.fragment,H),Me(K.$$.fragment,H),ee=!1},d(H){H&&ce(t),Ee(d),Ue(Z,H),Ue(le,H),e[18](null),Ee(z),Ee(Y),Ee(Q),Ee(K),j=!1,Ve(V)}}}let Ri=1e3,wh=1e3;function XO(e,t,n){let{demoInfo:r}=t;const i=["4:2","4:3","4:4","4:5","3:2","3:3","3:4","3:5","2:2","2:3","2:4","2:5"],o=Math.PI*2;let a,s=[],l=120,u=i[0],c=64,f=0,h=!1,d=0,p=[];const b=()=>{n(2,s=[]),W.inputs.length<1?console.warn("No MIDI device detected"):(W.inputs.forEach((I,$)=>{console.log(`MIDI device ${$}: ${I.name}`),I.addListener("noteon",y),I.addListener("controlchange",_)}),n(2,s=[...W.inputs]))},y=I=>{p.length===0&&(d=I.timestamp);const $=(I.timestamp-d)/1e3;p.push($),v()},_=I=>{n(6,f=(Pu(I.rawValue,0,100)-50)/100),v()},v=()=>{const I=Ri/2,$=wh/2,D=Ri*.2,A=D*.8,F=D*.9,L=D*.95,X=Math.PI/2,U=a.getContext("2d"),z=window.devicePixelRatio,G=a.getBoundingClientRect();n(1,a.width=G.width*z,a),n(1,a.height=G.height*z,a),U.scale(z,z),n(1,a.style.width=`${G.width}px`,a),n(1,a.style.height=`${G.height}px`,a),U.clearRect(0,0,Ri,wh);const[R,Y]=u.split(":").map(ie=>+ie),re=Lt(l)*R,Q=p.map(ie=>ie+f),K=Q.map(ie=>ie%re).map(ie=>ie/re*o),ee=D*.2,j=c*R/4;U.fillStyle="#f8f8f8";const V=o/j,te=Ce(R*Y).map(ie=>o/(R*Y)*ie-X),B=Ri/2-10;for(const ie of te){const le=Math.cos(ie-V),ve=Math.sin(ie-V),we=Math.cos(ie+V),H=Math.sin(ie+V);U.moveTo(I,$),U.lineTo(I+le*B,$+ve*B),U.lineTo(I+we*B,$+H*B),U.closePath()}if(U.fill(),!h){U.fillStyle="#f8f8f8",U.strokeStyle="#aaa";const le=mb().domain([0,o]).thresholds(Ce(j).map(we=>we/j*o))(K),ve=ot(le,we=>we.length);for(const we of le){if(we.length===0)continue;const H=we.length/ve*ee,ue=D+H,ye=we.x0-X,Fe=Math.cos(ye),We=Math.sin(ye),pe=we.x1-X,de=Math.cos(pe),Oe=Math.sin(pe);U.beginPath(),U.moveTo(I+Fe*D,$+We*D),U.lineTo(I+Fe*ue,$+We*ue),U.arc(I,$,ue,ye,pe),U.lineTo(I+de*D,$+Oe*D),U.closePath(),U.fill(),U.stroke()}}if(h&&K.length>0){let ie=4/c;const H=y3(K,{bandwidth:ie,pad:.1,bins:360}).bandwidth(ie),ue=ot([...H],Fe=>Fe.y);console.log([...H]),U.beginPath();let ye=0;for(const Fe of H){console.log(ye++,Fe);const We=Fe.x-X,pe=D+Fe.y/ue*ee,de=Math.cos(We),Oe=Math.sin(We);U.lineTo(I+de*pe,$+Oe*pe)}U.closePath(),U.fillStyle="#e4f0fa",U.fill(),U.strokeStyle="#aaa",U.stroke()}if(Q.length>0){U.lineWidth=2,U.strokeStyle="#888";const ie=Q,le=Math.floor(Q.at(-1)/re)+1,ve=(Ri/2-D-ee-10)/le;for(const[we,H]of ie.entries()){const ue=H/re*o-X,ye=Math.cos(ue),Fe=Math.sin(ue),We=Math.floor(H/re),pe=D+ee+We*ve+5,de=pe+ve;U.beginPath(),U.moveTo(I+ye*pe,$+Fe*pe),U.lineTo(I+ye*de,$+Fe*de),U.stroke()}U.lineWidth=1,U.strokeStyle="#eee";for(let we=0;we<le;we++){const H=D+ee+we*ve+5;fh(U,I,$,H)}}U.strokeStyle="#aaa",U.fillStyle="white",fh(U,I,$,D),U.lineWidth=2,U.fill(),U.stroke();const se=Ce(R).map(ie=>o/R*ie-X),Z=Ce(R*Y).map(ie=>o/(R*Y)*ie-X);U.beginPath(),U.lineWidth=2;for(const ie of se){const le=Math.cos(ie),ve=Math.sin(ie);U.moveTo(I+le*A,$+ve*A),U.lineTo(I+le*L,$+ve*L)}U.stroke(),U.lineWidth=1,U.beginPath();for(const ie of Z){const le=Math.cos(ie),ve=Math.sin(ie);U.moveTo(I+le*F,$+ve*F),U.lineTo(I+le*L,$+ve*L)}U.stroke()},M=()=>{const I={tempo:l,grid:u,binNote:c,adjustTime:f,showKde:h,noteOnTimes:p};un(r.id,I)},g=async I=>{if(p.length===0||confirm("Import data and overwrite currently unsaved data?")){const $=await ln(I);n(3,l=$.tempo),n(4,u=$.grid),n(5,c=$.binNote),n(6,f=$.adjustTime),n(8,p=$.noteOnTimes),n(7,h=$.showKde??!1),v()}};st(()=>{W.enable().then(b).catch(I=>alert(I)),v()}),lt(()=>{for(const I of W.inputs)I.removeListener()});function w(I){l=I,n(3,l)}function E(){u=pt(this),n(4,u),n(9,i)}function N(){c=pt(this),n(5,c)}function x(){f=Ne(this.value),n(6,f)}const T=()=>{n(7,h=!h),v()};function S(I){xe[I?"unshift":"push"](()=>{a=I,n(1,a)})}function P(I){p=I,n(8,p)}return e.$$set=I=>{"demoInfo"in I&&n(0,r=I.demoInfo)},[r,a,s,l,u,c,f,h,p,i,v,M,g,w,E,N,x,T,S,P]}class KO extends He{constructor(t){super(),ze(this,t,XO,jO,qe,{demoInfo:0})}}function Xp(e,t,n){const r=e.slice();return r[26]=t[n],r}function Kp(e,t,n){const r=e.slice();return r[29]=t[n],r}function Zp(e,t,n){const r=e.slice();return r[29]=t[n],r}function Qp(e,t,n){const r=e.slice();return r[29]=t[n],r}function ZO(e){let t,n,r;var i=e[0].component;function o(a,s){return{props:{demoInfo:a[0]}}}return i&&(t=tl(i,o(e))),{c(){t&&Ae(t.$$.fragment),n=ob()},m(a,s){t&&Se(t,a,s),fe(a,n,s),r=!0},p(a,s){if(s[0]&1&&i!==(i=a[0].component)){if(t){Jl();const l=t;Me(l.$$.fragment,1,0,()=>{Ee(l,1)}),eu()}i?(t=tl(i,o(a)),Ae(t.$$.fragment),_e(t.$$.fragment,1),Se(t,n.parentNode,n)):t=null}else if(i){const l={};s[0]&1&&(l.demoInfo=a[0]),t.$set(l)}},i(a){r||(t&&_e(t.$$.fragment,a),r=!0)},o(a){t&&Me(t.$$.fragment,a),r=!1},d(a){a&&ce(n),t&&Ee(t,a)}}}function QO(e){let t,n,r;function i(a){e[24](a)}let o={};return e[5]!==void 0&&(o.currentTool=e[5]),t=new uB({props:o}),xe.push(()=>nt(t,"currentTool",i)),{c(){Ae(t.$$.fragment)},m(a,s){Se(t,a,s),r=!0},p(a,s){const l={};!n&&s[0]&32&&(n=!0,l.currentTool=a[5],tt(()=>n=!1)),t.$set(l)},i(a){r||(_e(t.$$.fragment,a),r=!0)},o(a){Me(t.$$.fragment,a),r=!1},d(a){Ee(t,a)}}}function JO(e){let t,n,r,i,o,a,s,l,u,c,f,h,d,p,b,y,_,v,M,g,w,E,N=Pe(e[7].values()),x=[];for(let A=0;A<N.length;A+=1)x[A]=Jp(Qp(e,N,A));let T=Pe(e[8].values()),S=[];for(let A=0;A<T.length;A+=1)S[A]=eb(Zp(e,T,A));let P=Pe(e[9].values()),I=[];for(let A=0;A<P.length;A+=1)I[A]=tb(Kp(e,P,A));let $=Pe(e[6]),D=[];for(let A=0;A<$.length;A+=1)D[A]=rb(Xp(e,$,A));return{c(){t=C("p"),t.textContent=`This page contains a collection of small tools (demos) that are each
      tailored to a specific musical skill and sometimes also specific kind of
      musical data. You can filter demos with the bottuns below. Click a button
      to toggle it, double click it to turn it on and all others of the same
      kind off. A demo will only be shown if it supports at least one of the
      active attributes.`,n=O(),r=C("div"),i=q(`task
      `),o=C("button"),o.textContent="all",a=O();for(let A=0;A<x.length;A+=1)x[A].c();s=O(),l=C("div"),u=q(`instrument
      `),c=C("button"),c.textContent="all",f=O();for(let A=0;A<S.length;A+=1)S[A].c();h=O(),d=C("div"),p=q(`input
      `),b=C("button"),b.textContent="all",y=O();for(let A=0;A<I.length;A+=1)I[A].c();_=O(),v=C("div");for(let A=0;A<D.length;A+=1)D[A].c();M=O(),g=C("button"),g.textContent=" export usage",k(t,"class","explanation"),k(v,"class","grid"),k(g,"title","Export usage statistics")},m(A,F){fe(A,t,F),fe(A,n,F),fe(A,r,F),m(r,i),m(r,o),m(r,a);for(let L=0;L<x.length;L+=1)x[L]&&x[L].m(r,null);fe(A,s,F),fe(A,l,F),m(l,u),m(l,c),m(l,f);for(let L=0;L<S.length;L+=1)S[L]&&S[L].m(l,null);fe(A,h,F),fe(A,d,F),m(d,p),m(d,b),m(d,y);for(let L=0;L<I.length;L+=1)I[L]&&I[L].m(d,null);fe(A,_,F),fe(A,v,F);for(let L=0;L<D.length;L+=1)D[L]&&D[L].m(v,null);fe(A,M,F),fe(A,g,F),w||(E=[ne(o,"click",e[13]),ne(c,"click",e[16]),ne(b,"click",e[19]),ne(g,"click",e[23])],w=!0)},p(A,F){if(F[0]&132){N=Pe(A[7].values());let L;for(L=0;L<N.length;L+=1){const X=Qp(A,N,L);x[L]?x[L].p(X,F):(x[L]=Jp(X),x[L].c(),x[L].m(r,null))}for(;L<x.length;L+=1)x[L].d(1);x.length=N.length}if(F[0]&264){T=Pe(A[8].values());let L;for(L=0;L<T.length;L+=1){const X=Zp(A,T,L);S[L]?S[L].p(X,F):(S[L]=eb(X),S[L].c(),S[L].m(l,null))}for(;L<S.length;L+=1)S[L].d(1);S.length=T.length}if(F[0]&528){P=Pe(A[9].values());let L;for(L=0;L<P.length;L+=1){const X=Kp(A,P,L);I[L]?I[L].p(X,F):(I[L]=tb(X),I[L].c(),I[L].m(d,null))}for(;L<I.length;L+=1)I[L].d(1);I.length=P.length}if(F[0]&93){$=Pe(A[6]);let L;for(L=0;L<$.length;L+=1){const X=Xp(A,$,L);D[L]?D[L].p(X,F):(D[L]=rb(X),D[L].c(),D[L].m(v,null))}for(;L<D.length;L+=1)D[L].d(1);D.length=$.length}},i:ge,o:ge,d(A){A&&(ce(t),ce(n),ce(r),ce(s),ce(l),ce(h),ce(d),ce(_),ce(v),ce(M),ce(g)),Ue(x,A),Ue(S,A),Ue(I,A),Ue(D,A),w=!1,Ve(E)}}}function eG(e){let t,n,r;return{c(){t=C("input"),k(t,"type","password"),k(t,"placeholder","password")},m(i,o){fe(i,t,o),be(t,e[1]),n||(r=ne(t,"input",e[12]),n=!0)},p(i,o){o[0]&2&&t.value!==i[1]&&be(t,i[1])},i:ge,o:ge,d(i){i&&ce(t),n=!1,r()}}}function Jp(e){let t,n=e[29]+"",r,i,o,a,s;function l(){return e[14](e[29])}function u(){return e[15](e[29])}return{c(){t=C("button"),r=q(n),i=O(),k(t,"class",o=Zi(e[2].has(e[29])?"active":"hidden")+" svelte-1auehli")},m(c,f){fe(c,t,f),m(t,r),m(t,i),a||(s=[ne(t,"click",l),ne(t,"dblclick",u)],a=!0)},p(c,f){e=c,f[0]&4&&o!==(o=Zi(e[2].has(e[29])?"active":"hidden")+" svelte-1auehli")&&k(t,"class",o)},d(c){c&&ce(t),a=!1,Ve(s)}}}function eb(e){let t,n=e[29]+"",r,i,o,a,s;function l(){return e[17](e[29])}function u(){return e[18](e[29])}return{c(){t=C("button"),r=q(n),i=O(),k(t,"class",o=Zi(e[3].has(e[29])?"active":"hidden")+" svelte-1auehli")},m(c,f){fe(c,t,f),m(t,r),m(t,i),a||(s=[ne(t,"click",l),ne(t,"dblclick",u)],a=!0)},p(c,f){e=c,f[0]&8&&o!==(o=Zi(e[3].has(e[29])?"active":"hidden")+" svelte-1auehli")&&k(t,"class",o)},d(c){c&&ce(t),a=!1,Ve(s)}}}function tb(e){let t,n=e[29]+"",r,i,o,a,s;function l(){return e[20](e[29])}function u(){return e[21](e[29])}return{c(){t=C("button"),r=q(n),i=O(),k(t,"class",o=Zi(e[4].has(e[29])?"active":"hidden")+" svelte-1auehli")},m(c,f){fe(c,t,f),m(t,r),m(t,i),a||(s=[ne(t,"click",l),ne(t,"dblclick",u)],a=!0)},p(c,f){e=c,f[0]&16&&o!==(o=Zi(e[4].has(e[29])?"active":"hidden")+" svelte-1auehli")&&k(t,"class",o)},d(c){c&&ce(t),a=!1,Ve(s)}}}function nb(e){let t,n,r,i,o,a,s,l,u,c,f,h,d;function p(){return e[22](e[26])}return{c(){t=C("div"),n=C("h2"),n.textContent=`${e[26].title}`,r=O(),i=C("div"),i.textContent=`${e[26].description}`,o=O(),a=C("div"),a.textContent=`instrument:
              ${e[26].instruments.includes("guitar/bass")?"":""} ${e[26].instruments.includes("drum")?"":""} ${e[26].instruments.includes("keyboard")?"":""} ${e[26].instruments.includes("wind")?"":""} ${e[26].instruments.includes("singing")?"":""} ${e[26].instruments.includes("strings")?"":""}`,s=O(),l=C("div"),l.textContent=`task:
              ${e[26].task==="dynamics"?"":""} ${e[26].task==="timing"?"":""} ${e[26].task==="pitch"?"":""} ${e[26].task==="chords"?"":""}`,u=O(),c=C("div"),c.textContent=`data: ${e[26].input}`,f=O(),k(i,"class","description"),k(a,"class","tags svelte-1auehli"),k(l,"class","tags svelte-1auehli"),k(c,"class","tags svelte-1auehli"),k(t,"class","card svelte-1auehli")},m(b,y){fe(b,t,y),m(t,n),m(t,r),m(t,i),m(t,o),m(t,a),m(t,s),m(t,l),m(t,u),m(t,c),m(t,f),h||(d=ne(t,"click",p),h=!0)},p(b,y){e=b},d(b){b&&ce(t),h=!1,d()}}}function rb(e){let t=e[2].has(e[26].task)&&_0(e[3],e[26].instruments)&&e[4].has(e[26].input),n,r=t&&nb(e);return{c(){r&&r.c(),n=ob()},m(i,o){r&&r.m(i,o),fe(i,n,o)},p(i,o){o[0]&28&&(t=i[2].has(i[26].task)&&_0(i[3],i[26].instruments)&&i[4].has(i[26].input)),t?r?r.p(i,o):(r=nb(i),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(i){i&&ce(n),r&&r.d(i)}}}function tG(e){let t,n,r,i,o,a,s,l,u,c,f,h,d;const p=[eG,JO,QO,ZO],b=[];function y(_,v){return _[1]!==nG?0:_[0]?_[0]==="tools"?2:3:1}return u=y(e),c=b[u]=p[u](e),{c(){t=C("main"),n=C("header"),r=C("h1"),r.textContent="Data-Driven Music Education Demos",i=O(),o=C("button"),o.textContent=" demos",a=O(),s=C("button"),s.textContent=" tools",l=O(),c.c()},m(_,v){fe(_,t,v),m(t,n),m(n,r),m(n,i),m(n,o),m(n,a),m(n,s),m(t,l),b[u].m(t,null),f=!0,h||(d=[ne(o,"click",e[10]),ne(s,"click",e[11])],h=!0)},p(_,v){let M=u;u=y(_),u===M?b[u].p(_,v):(Jl(),Me(b[M],1,1,()=>{b[M]=null}),eu(),c=b[u],c?c.p(_,v):(c=b[u]=p[u](_),c.c()),_e(c,1),c.m(t,null))},i(_){f||(_e(c),f=!0)},o(_){Me(c),f=!1},d(_){_&&ce(t),b[u].d(),h=!1,Ve(d)}}}let nG="rhyvis";function rG(e,t,n){const r=[{id:"sub-division",title:"Sub-Division",description:"Learn rhythmic playing in different sub-divisions.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:$B},{id:"sub-division-bar",title:"[new] Sub-Division (per Bar)",description:"Learn rhythmic playing in different sub-divisions.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:KO},{id:"tempo-drift",title:"Tempo Drift",description:"Keep your tempo constant over a longer stretch of playing.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:qB},{id:"dynamics",title:"Dynamics",description:"Check how well you control the loudness of notes.",tags:["task:dynamics","input:MIDI","encoding:bars"],task:"dynamics",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:WB},{id:"improvisation-intervals",title:"Improvisation Intervals",description:"See how often you use different intervals in improvisation.",task:"pitch",input:"MIDI",instruments:["guitar/bass","keyboard"],component:QB},{id:"improvisation-scale-degrees",title:"Improvisation Scale Degrees",description:"See how often you use different scale degrees in improvisation.",task:"pitch",input:"MIDI",instruments:["guitar/bass","keyboard"],component:rR},{id:"improvisation-scale-degrees-bar",title:"[new] Improvisation Scale Degrees (per Bar)",description:"See how often you use different scale degrees in improvisation. This version shows the distribution of notes for each played bar.",task:"pitch",input:"MIDI",instruments:["guitar/bass","keyboard"],component:$O},{id:"improvisation-note-colors",title:"[new] Improvisation Note Colors",description:"See how often you use different kinds of notes in improvisation.",task:"pitch",input:"MIDI",instruments:["guitar/bass","keyboard"],component:VO},{id:"keyboard-histogram",title:"Keyboard Histogram",description:"See how often you play different keyboard keys.",task:"pitch",input:"MIDI",instruments:["keyboard"],component:yR},{id:"fretboard-heatmap",title:"Fretboard Heatmap",description:"See how often you play different fretboard positions.",task:"pitch",input:"MIDI",instruments:["guitar/bass"],component:uR},{id:"fretboard-improvisation-intervals",title:"[changed] Fretboard Improvisation Intervals",description:"Once you play a note, see where on the fretboard you can reach different intervals to the last played note.",task:"pitch",input:"MIDI",instruments:["guitar/bass"],component:MR},{id:"chord-arpeggio-timing",title:"Chord and Arpeggio Timing",description:"See how spaced out the notes in a chord or arpeggio are, and how much time lies between these.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:dR},{id:"speed-up",title:"Speed-Up",description:"Record a short exercise at a slow tempo, then practice it with steadily increasing tempo.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:IR},{id:"speed-up-tab",title:" [new] Speed-Up Tab",description:"Record a short guitar exercise at a slow tempo, then practice it with steadily increasing tempo.",task:"timing",input:"MIDI",instruments:["guitar/bass"],component:xO},{id:"rhythm-sheet-music",title:"Rhythm Sheet Music",description:"This demo displays the notes you play as staff notation (, , , , ) and offset in percent.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:DR},{id:"chord-diagrams",title:"[changed] Chord Diagrams",description:"See what chords you play on a guitar/bass as chord diagrams.",task:"chords",input:"MIDI",instruments:["guitar/bass"],component:LR},{id:"pitch-bend",title:"[new] Pitch Bend",description:"Practice different kinds of pitch bends.",task:"pitch",input:"MIDI",instruments:["guitar/bass","keyboard"],component:vO},{id:"pitch-bend-audio",title:"[new] Pitch Bend (Audio)",description:"Practice different kinds of pitch bends.",task:"pitch",input:"audio",instruments:["guitar/bass","keyboard"],component:LO}];let i=null;const o=C5(window,"d");o&&o!==""&&(i=r.filter($=>$.id===o)[0]);let a=localStorage.getItem("pwd")??"";window.onpopstate=$=>{i!==null&&n(0,i=null)};const s=new Set(r.flatMap($=>$.task).sort()),l=new Set(r.flatMap($=>$.instruments).sort()),u=new Set(r.flatMap($=>$.input).sort());let c=new Set(s),f=new Set(l),h=new Set(u),d=null;const p=()=>{n(0,i=null),tc(window,"d","")},b=()=>{n(0,i="tools"),n(5,d=null),tc(window,"d","tools")};function y(){a=this.value,n(1,a)}const _=()=>{n(2,c=new Set(s))},v=$=>n(2,c=wc(c,$)),M=$=>n(2,c=new Set([$])),g=()=>{n(3,f=new Set(l))},w=$=>n(3,f=wc(f,$)),E=$=>n(3,f=new Set([$])),N=()=>{n(4,h=new Set(u))},x=$=>n(4,h=wc(h,$)),T=$=>n(4,h=new Set([$])),S=$=>{n(0,i=$),tc(window,"d",$.id)},P=()=>{const $=localStorage.getItem("usage"),D=new Blob([$],{type:"text/plain;charset=utf-8"});Zy(D,"usage.json")};function I($){d=$,n(5,d)}return e.$$.update=()=>{if(e.$$.dirty[0]&2&&localStorage.setItem("pwd",a),e.$$.dirty[0]&1&&i&&i!=="tools"){let $;localStorage.getItem("usage")!==null?($=localStorage.getItem("usage"),$=JSON.parse($)):$={demoClicks:{}};const D=$.demoClicks,A=D[i.id]??[];A.push(new Date().toUTCString()),D[i.id]=A,localStorage.setItem("usage",JSON.stringify($))}},[i,a,c,f,h,d,r,s,l,u,p,b,y,_,v,M,g,w,E,N,x,T,S,P,I]}class iG extends He{constructor(t){super(),ze(this,t,rG,tG,qe,{},null,[-1,-1])}}new iG({target:document.getElementById("app")});
