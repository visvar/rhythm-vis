var $3=Object.defineProperty;var T3=(e,t,n)=>t in e?$3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ss=(e,t,n)=>(T3(e,typeof t!="symbol"?t+"":t,n),n),Ld=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var Re=(e,t,n)=>(Ld(e,t,"read from private field"),n?n.call(e):t.get(e)),Ht=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},fn=(e,t,n,r)=>(Ld(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var Gd=(e,t,n,r)=>({set _(i){fn(e,t,i,n)},get _(){return Re(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function pe(){}function E1(e){return e()}function Ud(){return Object.create(null)}function qe(e){e.forEach(E1)}function xa(e){return typeof e=="function"}function He(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function k3(e){return Object.keys(e).length===0}function qs(e){return e??""}function p(e,t){e.appendChild(t)}function le(e,t,n){e.insertBefore(t,n||null)}function se(e){e.parentNode&&e.parentNode.removeChild(e)}function Ze(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function A(e){return document.createElement(e)}function z(e){return document.createTextNode(e)}function R(){return z(" ")}function th(){return z("")}function Q(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function P(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function xe(e){return e===""?null:+e}function I3(e){return Array.from(e.childNodes)}function _e(e,t){t=""+t,e.data!==t&&(e.data=t)}function me(e,t){e.value=t??""}function Jt(e,t,n,r){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function Le(e,t,n){for(let r=0;r<e.options.length;r+=1){const i=e.options[r];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Rt(e){const t=e.querySelector(":checked");return t&&t.__value}function Hs(e,t){return new e(t)}let Xo;function Lo(e){Xo=e}function S1(){if(!Xo)throw new Error("Function called outside component initialization");return Xo}function at(e){S1().$$.on_mount.push(e)}function ot(e){S1().$$.on_destroy.push(e)}const Mi=[],Ue=[];let Ci=[];const Rc=[],D3=Promise.resolve();let Bc=!1;function F3(){Bc||(Bc=!0,D3.then(x1))}function _t(e){Ci.push(e)}function Xr(e){Rc.push(e)}const Ou=new Set;let gi=0;function x1(){if(gi!==0)return;const e=Xo;do{try{for(;gi<Mi.length;){const t=Mi[gi];gi++,Lo(t),R3(t.$$)}}catch(t){throw Mi.length=0,gi=0,t}for(Lo(null),Mi.length=0,gi=0;Ue.length;)Ue.pop()();for(let t=0;t<Ci.length;t+=1){const n=Ci[t];Ou.has(n)||(Ou.add(n),n())}Ci.length=0}while(Mi.length);for(;Rc.length;)Rc.pop()();Bc=!1,Ou.clear(),Lo(e)}function R3(e){if(e.fragment!==null){e.update(),qe(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(_t)}}function B3(e){const t=[],n=[];Ci.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Ci=t}const Ps=new Set;let Ur;function Aa(){Ur={r:0,c:[],p:Ur}}function Ca(){Ur.r||qe(Ur.c),Ur=Ur.p}function we(e,t){e&&e.i&&(Ps.delete(e),e.i(t))}function Se(e,t,n,r){if(e&&e.o){if(Ps.has(e))return;Ps.add(e),Ur.c.push(()=>{Ps.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Pe(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function jr(e,t,n){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function Te(e){e&&e.c()}function Ne(e,t,n){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,n),_t(()=>{const o=e.$$.on_mount.map(E1).filter(xa);e.$$.on_destroy?e.$$.on_destroy.push(...o):qe(o),e.$$.on_mount=[]}),i.forEach(_t)}function $e(e,t){const n=e.$$;n.fragment!==null&&(B3(n.after_update),qe(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function O3(e,t){e.$$.dirty[0]===-1&&(Mi.push(e),F3(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ze(e,t,n,r,i,o,a=null,s=[-1]){const l=Xo;Lo(e);const u=e.$$={fragment:null,ctx:[],props:o,update:pe,not_equal:i,bound:Ud(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:Ud(),dirty:s,skip_bound:!1,root:t.target||l.$$.root};a&&a(u.root);let c=!1;if(u.ctx=n?n(e,t.props||{},(h,f,...d)=>{const m=d.length?d[0]:f;return u.ctx&&i(u.ctx[h],u.ctx[h]=m)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](m),c&&O3(e,h)),f}):[],u.update(),c=!0,qe(u.before_update),u.fragment=r?r(u.ctx):!1,t.target){if(t.hydrate){const h=I3(t.target);u.fragment&&u.fragment.l(h),h.forEach(se)}else u.fragment&&u.fragment.c();t.intro&&we(e.$$.fragment),Ne(e,t.target,t.anchor),x1()}Lo(l)}class Ve{constructor(){ss(this,"$$");ss(this,"$$set")}$destroy(){$e(this,1),this.$destroy=pe}$on(t,n){if(!xa(n))return pe;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!k3(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const L3="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(L3);function Lu(e,t,n){const r=new URLSearchParams(e.location.search);r.set(t,n);const i=`${e.location.protocol}//${e.location.host}${e.location.pathname}?${r.toString()}`;e.history.pushState({path:i},"",i)}function G3(e,t){return new URLSearchParams(e.location.search).get(t)}function Dt(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Pa(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ol(e){let t,n,r;e.length!==2?(t=Dt,n=(s,l)=>Dt(e(s),l),r=(s,l)=>e(s)-l):(t=e===Dt||e===Pa?e:U3,n=e,r=e);function i(s,l,u=0,c=s.length){if(u<c){if(t(l,l)!==0)return c;do{const h=u+c>>>1;n(s[h],l)<0?u=h+1:c=h}while(u<c)}return u}function o(s,l,u=0,c=s.length){if(u<c){if(t(l,l)!==0)return c;do{const h=u+c>>>1;n(s[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function a(s,l,u=0,c=s.length){const h=i(s,l,u,c-1);return h>u&&r(s[h-1],l)>-r(s[h],l)?h-1:h}return{left:i,center:a,right:o}}function U3(){return 0}function A1(e){return e===null?NaN:+e}function*q3(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const H3=Ol(Dt),Ll=H3.right;Ol(A1).center;function z3(e,t){let n=0;for(let r of e)r!=null&&(r=+r)>=r&&++n;return n}function V3(e){return e.length|0}function Y3(e){return!(e>0)}function W3(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function X3(e){return t=>e(...t)}function j3(...e){const t=typeof e[e.length-1]=="function"&&X3(e.pop());e=e.map(W3);const n=e.map(V3),r=e.length-1,i=new Array(r+1).fill(0),o=[];if(r<0||n.some(Y3))return o;for(;;){o.push(i.map((s,l)=>e[l][s]));let a=r;for(;++i[a]===n[a];){if(a===0)return t?o.map(t):o;i[a--]=0}}}function K3(e,t){var n=0;return Float64Array.from(e,r=>n+=+r||0)}function C1(e,t){let n=0,r,i=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,o+=r*(a-i));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,o+=r*(s-i))}if(n>1)return o/(n-1)}function Z3(e,t){const n=C1(e,t);return n&&Math.sqrt(n)}function Ft(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class Kr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[r++]=s),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}class Zr extends Map{constructor(t,n=$1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Oc(this,t))}has(t){return super.has(Oc(this,t))}set(t,n){return super.set(P1(this,t),n)}delete(t){return super.delete(N1(this,t))}}class Gl extends Set{constructor(t,n=$1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Oc(this,t))}add(t){return super.add(P1(this,t))}delete(t){return super.delete(N1(this,t))}}function Oc({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function P1({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function N1({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function $1(e){return e!==null&&typeof e=="object"?e.valueOf():e}function jo(e){return e}function Ul(e,...t){return ql(e,jo,jo,t)}function Ko(e,...t){return ql(e,Array.from,jo,t)}function Pi(e,t,...n){return ql(e,jo,t,n)}function Q3(e,t,...n){return ql(e,Array.from,t,n)}function ql(e,t,n,r){return function i(o,a){if(a>=r.length)return n(o);const s=new Zr,l=r[a++];let u=-1;for(const c of o){const h=l(c,++u,o),f=s.get(h);f?f.push(c):s.set(h,[c])}for(const[c,h]of s)s.set(c,i(h,a));return t(s)}(e,0)}function J3(e,t){return Array.from(t,n=>e[n])}function zs(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,o)=>o);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,o)=>{for(const a of t){const s=Vs(a[i],a[o]);if(s)return s}})):(n=e.map(n),r.sort((i,o)=>Vs(n[i],n[o]))),J3(e,r)}return e.sort(T1(n))}function T1(e=Dt){if(e===Dt)return Vs;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function Vs(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function nh(e,t,n){return(t.length!==2?zs(Pi(e,t,n),([r,i],[o,a])=>Dt(i,a)||Dt(r,o)):zs(Ul(e,n),([r,i],[o,a])=>t(i,a)||Dt(r,o))).map(([r])=>r)}var e5=Array.prototype,t5=e5.slice;function Gu(e){return()=>e}const n5=Math.sqrt(50),r5=Math.sqrt(10),i5=Math.sqrt(2);function Ys(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=n5?10:o>=r5?5:o>=i5?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(e*u),l=Math.round(t*u),s/u<e&&++s,l/u>t&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(e/u),l=Math.round(t/u),s*u<e&&++s,l*u>t&&--l),l<s&&.5<=n&&n<2?Ys(e,t,n*2):[s,l,u]}function Zo(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,a]=r?Ys(t,e,n):Ys(e,t,n);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function Ri(e,t,n){return t=+t,e=+e,n=+n,Ys(e,t,n)[2]}function Lc(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Ri(t,e,n):Ri(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function o5(e,t,n){let r;for(;;){const i=Ri(e,t,n);if(i===r||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function a5(e){return Math.max(1,Math.ceil(Math.log(z3(e))/Math.LN2)+1)}function s5(){var e=jo,t=Ft,n=a5;function r(i){Array.isArray(i)||(i=Array.from(i));var o,a=i.length,s,l,u=new Array(a);for(o=0;o<a;++o)u[o]=e(i[o],o,i);var c=t(u),h=c[0],f=c[1],d=n(u,h,f);if(!Array.isArray(d)){const y=f,v=+d;if(t===Ft&&([h,f]=o5(h,f,v)),d=Zo(h,f,v),d[0]<=h&&(l=Ri(h,f,v)),d[d.length-1]>=f)if(y>=f&&t===Ft){const x=Ri(h,f,v);isFinite(x)&&(x>0?f=(Math.floor(f/x)+1)*x:x<0&&(f=(Math.ceil(f*-x)+1)/-x))}else d.pop()}for(var m=d.length,b=0,g=m;d[b]<=h;)++b;for(;d[g-1]>f;)--g;(b||g<m)&&(d=d.slice(b,g),m=g-b);var E=new Array(m+1),_;for(o=0;o<=m;++o)_=E[o]=[],_.x0=o>0?d[o-1]:h,_.x1=o<m?d[o]:f;if(isFinite(l)){if(l>0)for(o=0;o<a;++o)(s=u[o])!=null&&h<=s&&s<=f&&E[Math.min(m,Math.floor((s-h)/l))].push(i[o]);else if(l<0){for(o=0;o<a;++o)if((s=u[o])!=null&&h<=s&&s<=f){const y=Math.floor((h-s)*l);E[Math.min(m,y+(d[y]<=s))].push(i[o])}}}else for(o=0;o<a;++o)(s=u[o])!=null&&h<=s&&s<=f&&E[Ll(d,s,0,m)].push(i[o]);return E}return r.value=function(i){return arguments.length?(e=typeof i=="function"?i:Gu(i),r):e},r.domain=function(i){return arguments.length?(t=typeof i=="function"?i:Gu([i[0],i[1]]),r):t},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:Gu(Array.isArray(i)?t5.call(i):i),r):n},r}function tt(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function l5(e,t){let n,r=-1,i=-1;if(t===void 0)for(const o of e)++i,o!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of e)(o=t(o,++i,e))!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);return r}function Nt(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function k1(e,t){let n,r=-1,i=-1;if(t===void 0)for(const o of e)++i,o!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of e)(o=t(o,++i,e))!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);return r}function I1(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?Vs:T1(i);r>n;){if(r-n>600){const l=r-n+1,u=t-n+1,c=Math.log(l),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1),d=Math.max(n,Math.floor(t-u*h/l+f)),m=Math.min(r,Math.floor(t+(l-u)*h/l+f));I1(e,t,d,m,i)}const o=e[t];let a=n,s=r;for(go(e,n,t),i(e[r],o)>0&&go(e,n,r);a<s;){for(go(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[n],o)===0?go(e,n,s):(++s,go(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function go(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function D1(e,t=Dt){let n,r=!1;if(t.length===1){let i;for(const o of e){const a=t(o);(r?Dt(a,i)>0:Dt(a,a)===0)&&(n=o,i=a,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function Ws(e,t,n){if(e=Float64Array.from(q3(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Nt(e);if(t>=1)return tt(e);var r,i=(r-1)*t,o=Math.floor(i),a=tt(I1(e,o).subarray(0,o+1)),s=Nt(e.subarray(o+1));return a+(s-a)*(i-o)}}function u5(e,t,n=A1){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function F1(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n}function Gc(e,t){return Ws(e,.5,t)}function*c5(e){for(const t of e)yield*t}function R1(e){return Array.from(c5(e))}function f5(e,t){const n=new Zr;if(t===void 0)for(let o of e)o!=null&&o>=o&&n.set(o,(n.get(o)||0)+1);else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&a>=a&&n.set(a,(n.get(a)||0)+1)}let r,i=0;for(const[o,a]of n)a>i&&(i=a,r=o);return r}function h5(e,t=d5){const n=[];let r,i=!1;for(const o of e)i&&n.push(t(r,o)),r=o,i=!0;return n}function d5(e,t){return[e,t]}function be(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function Mr(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Xs(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function m5(e){return e}var p5=3,qd=1e-6;function b5(e){return"translate("+e+",0)"}function g5(e){return t=>+e(t)}function y5(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function _5(){return!this.__axis}function v5(e,t){var n=[],r=null,i=null,o=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=1,c="y",h=b5;function f(d){var m=r??(t.ticks?t.ticks.apply(t,n):t.domain()),b=i??(t.tickFormat?t.tickFormat.apply(t,n):m5),g=Math.max(o,0)+s,E=t.range(),_=+E[0]+l,y=+E[E.length-1]+l,v=(t.bandwidth?y5:g5)(t.copy(),l),x=d.selection?d.selection():d,w=x.selectAll(".domain").data([null]),M=x.selectAll(".tick").data(m,t).order(),C=M.exit(),S=M.enter().append("g").attr("class","tick"),N=M.select("line"),$=M.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(S),N=N.merge(S.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),$=$.merge(S.append("text").attr("fill","currentColor").attr(c,u*g).attr("dy","0.71em")),d!==x&&(w=w.transition(d),M=M.transition(d),N=N.transition(d),$=$.transition(d),C=C.transition(d).attr("opacity",qd).attr("transform",function(T){return isFinite(T=v(T))?h(T+l):this.getAttribute("transform")}),S.attr("opacity",qd).attr("transform",function(T){var L=this.parentNode.__axis;return h((L&&isFinite(L=L(T))?L:v(T))+l)})),C.remove(),w.attr("d",a?"M"+_+","+u*a+"V"+l+"H"+y+"V"+u*a:"M"+_+","+l+"H"+y),M.attr("opacity",1).attr("transform",function(T){return h(v(T)+l)}),N.attr(c+"2",u*o),$.attr(c,u*g).text(b),x.filter(_5).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),x.each(function(){this.__axis=v})}return f.scale=function(d){return arguments.length?(t=d,f):t},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),f):n.slice()},f.tickValues=function(d){return arguments.length?(r=d==null?null:Array.from(d),f):r&&r.slice()},f.tickFormat=function(d){return arguments.length?(i=d,f):i},f.tickSize=function(d){return arguments.length?(o=a=+d,f):o},f.tickSizeInner=function(d){return arguments.length?(o=+d,f):o},f.tickSizeOuter=function(d){return arguments.length?(a=+d,f):a},f.tickPadding=function(d){return arguments.length?(s=+d,f):s},f.offset=function(d){return arguments.length?(l=+d,f):l},f}function w5(e){return v5(p5,e)}var M5={value:()=>{}};function B1(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ns(n)}function Ns(e){this._=e}function E5(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ns.prototype=B1.prototype={constructor:Ns,on:function(e,t){var n=this._,r=E5(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=S5(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=Hd(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Hd(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ns(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function S5(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Hd(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=M5,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Uc="http://www.w3.org/1999/xhtml";const Bi={svg:"http://www.w3.org/2000/svg",xhtml:Uc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Hl(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Bi.hasOwnProperty(t)?{space:Bi[t],local:e}:e}function x5(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Uc&&t.documentElement.namespaceURI===Uc?t.createElement(e):t.createElementNS(n,e)}}function A5(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function zl(e){var t=Hl(e);return(t.local?A5:x5)(t)}function C5(){}function rh(e){return e==null?C5:function(){return this.querySelector(e)}}function P5(e){typeof e!="function"&&(e=rh(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=e.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new Vt(r,this._parents)}function N5(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function $5(){return[]}function O1(e){return e==null?$5:function(){return this.querySelectorAll(e)}}function T5(e){return function(){return N5(e.apply(this,arguments))}}function k5(e){typeof e=="function"?e=T5(e):e=O1(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(r.push(e.call(l,l.__data__,u,a)),i.push(l));return new Vt(r,i)}function L1(e){return function(){return this.matches(e)}}function G1(e){return function(t){return t.matches(e)}}var I5=Array.prototype.find;function D5(e){return function(){return I5.call(this.children,e)}}function F5(){return this.firstElementChild}function R5(e){return this.select(e==null?F5:D5(typeof e=="function"?e:G1(e)))}var B5=Array.prototype.filter;function O5(){return Array.from(this.children)}function L5(e){return function(){return B5.call(this.children,e)}}function G5(e){return this.selectAll(e==null?O5:L5(typeof e=="function"?e:G1(e)))}function U5(e){typeof e!="function"&&(e=L1(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new Vt(r,this._parents)}function U1(e){return new Array(e.length)}function q5(){return new Vt(this._enter||this._groups.map(U1),this._parents)}function js(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}js.prototype={constructor:js,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function H5(e){return function(){return e}}function z5(e,t,n,r,i,o){for(var a=0,s,l=t.length,u=o.length;a<u;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new js(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function V5(e,t,n,r,i,o,a){var s,l,u=new Map,c=t.length,h=o.length,f=new Array(c),d;for(s=0;s<c;++s)(l=t[s])&&(f[s]=d=a.call(l,l.__data__,s,t)+"",u.has(d)?i[s]=l:u.set(d,l));for(s=0;s<h;++s)d=a.call(e,o[s],s,o)+"",(l=u.get(d))?(r[s]=l,l.__data__=o[s],u.delete(d)):n[s]=new js(e,o[s]);for(s=0;s<c;++s)(l=t[s])&&u.get(f[s])===l&&(i[s]=l)}function Y5(e){return e.__data__}function W5(e,t){if(!arguments.length)return Array.from(this,Y5);var n=t?V5:z5,r=this._parents,i=this._groups;typeof e!="function"&&(e=H5(e));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],h=i[u],f=h.length,d=X5(e.call(c,c&&c.__data__,u,r)),m=d.length,b=s[u]=new Array(m),g=a[u]=new Array(m),E=l[u]=new Array(f);n(c,h,b,g,E,d,t);for(var _=0,y=0,v,x;_<m;++_)if(v=b[_]){for(_>=y&&(y=_+1);!(x=g[y])&&++y<m;);v._next=x||null}}return a=new Vt(a,r),a._enter=s,a._exit=l,a}function X5(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function j5(){return new Vt(this._exit||this._groups.map(U1),this._parents)}function K5(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Z5(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u=n[l],c=r[l],h=u.length,f=s[l]=new Array(h),d,m=0;m<h;++m)(d=u[m]||c[m])&&(f[m]=d);for(;l<i;++l)s[l]=n[l];return new Vt(s,this._parents)}function Q5(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function J5(e){e||(e=e7);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,l=i[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(t)}return new Vt(i,this._parents).order()}function e7(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function t7(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function n7(){return Array.from(this)}function r7(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function i7(){let e=0;for(const t of this)++e;return e}function o7(){return!this.node()}function a7(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function s7(e){return function(){this.removeAttribute(e)}}function l7(e){return function(){this.removeAttributeNS(e.space,e.local)}}function u7(e,t){return function(){this.setAttribute(e,t)}}function c7(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function f7(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function h7(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function d7(e,t){var n=Hl(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?l7:s7:typeof t=="function"?n.local?h7:f7:n.local?c7:u7)(n,t))}function q1(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function m7(e){return function(){this.style.removeProperty(e)}}function p7(e,t,n){return function(){this.style.setProperty(e,t,n)}}function b7(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function g7(e,t,n){return arguments.length>1?this.each((t==null?m7:typeof t=="function"?b7:p7)(e,t,n??"")):Oi(this.node(),e)}function Oi(e,t){return e.style.getPropertyValue(t)||q1(e).getComputedStyle(e,null).getPropertyValue(t)}function y7(e){return function(){delete this[e]}}function _7(e,t){return function(){this[e]=t}}function v7(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function w7(e,t){return arguments.length>1?this.each((t==null?y7:typeof t=="function"?v7:_7)(e,t)):this.node()[e]}function H1(e){return e.trim().split(/^|\s+/)}function ih(e){return e.classList||new z1(e)}function z1(e){this._node=e,this._names=H1(e.getAttribute("class")||"")}z1.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function V1(e,t){for(var n=ih(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Y1(e,t){for(var n=ih(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function M7(e){return function(){V1(this,e)}}function E7(e){return function(){Y1(this,e)}}function S7(e,t){return function(){(t.apply(this,arguments)?V1:Y1)(this,e)}}function x7(e,t){var n=H1(e+"");if(arguments.length<2){for(var r=ih(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?S7:t?M7:E7)(n,t))}function A7(){this.textContent=""}function C7(e){return function(){this.textContent=e}}function P7(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function N7(e){return arguments.length?this.each(e==null?A7:(typeof e=="function"?P7:C7)(e)):this.node().textContent}function $7(){this.innerHTML=""}function T7(e){return function(){this.innerHTML=e}}function k7(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function I7(e){return arguments.length?this.each(e==null?$7:(typeof e=="function"?k7:T7)(e)):this.node().innerHTML}function D7(){this.nextSibling&&this.parentNode.appendChild(this)}function F7(){return this.each(D7)}function R7(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function B7(){return this.each(R7)}function O7(e){var t=typeof e=="function"?e:zl(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function L7(){return null}function G7(e,t){var n=typeof e=="function"?e:zl(e),r=t==null?L7:typeof t=="function"?t:rh(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function U7(){var e=this.parentNode;e&&e.removeChild(this)}function q7(){return this.each(U7)}function H7(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function z7(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function V7(e){return this.select(e?z7:H7)}function Y7(e){return arguments.length?this.property("__data__",e):this.node().__data__}function W7(e){return function(t){e.call(this,t,this.__data__)}}function X7(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function j7(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function K7(e,t,n){return function(){var r=this.__on,i,o=W7(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Z7(e,t,n){var r=X7(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=t?K7:j7,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function W1(e,t,n){var r=q1(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Q7(e,t){return function(){return W1(this,e,t)}}function J7(e,t){return function(){return W1(this,e,t.apply(this,arguments))}}function e4(e,t){return this.each((typeof t=="function"?J7:Q7)(e,t))}function*t4(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var X1=[null];function Vt(e,t){this._groups=e,this._parents=t}function Na(){return new Vt([[document.documentElement]],X1)}function n4(){return this}Vt.prototype=Na.prototype={constructor:Vt,select:P5,selectAll:k5,selectChild:R5,selectChildren:G5,filter:U5,data:W5,enter:q5,exit:j5,join:K5,merge:Z5,selection:n4,order:Q5,sort:J5,call:t7,nodes:n7,node:r7,size:i7,empty:o7,each:a7,attr:d7,style:g7,property:w7,classed:x7,text:N7,html:I7,raise:F7,lower:B7,append:O7,insert:G7,remove:q7,clone:V7,datum:Y7,on:Z7,dispatch:e4,[Symbol.iterator]:t4};function Go(e){return typeof e=="string"?new Vt([[document.querySelector(e)]],[document.documentElement]):new Vt([[e]],X1)}function r4(e){let t;for(;t=e.sourceEvent;)e=t;return e}function i4(e,t){if(e=r4(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}function no(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function $a(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Tr(){}var Qr=.7,Li=1/Qr,Ni="\\s*([+-]?\\d+)\\s*",Qo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o4=/^#([0-9a-f]{3,8})$/,a4=new RegExp(`^rgb\\(${Ni},${Ni},${Ni}\\)$`),s4=new RegExp(`^rgb\\(${Dn},${Dn},${Dn}\\)$`),l4=new RegExp(`^rgba\\(${Ni},${Ni},${Ni},${Qo}\\)$`),u4=new RegExp(`^rgba\\(${Dn},${Dn},${Dn},${Qo}\\)$`),c4=new RegExp(`^hsl\\(${Qo},${Dn},${Dn}\\)$`),f4=new RegExp(`^hsla\\(${Qo},${Dn},${Dn},${Qo}\\)$`),zd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};no(Tr,Er,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Vd,formatHex:Vd,formatHex8:h4,formatHsl:d4,formatRgb:Yd,toString:Yd});function Vd(){return this.rgb().formatHex()}function h4(){return this.rgb().formatHex8()}function d4(){return j1(this).formatHsl()}function Yd(){return this.rgb().formatRgb()}function Er(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=o4.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Wd(t):n===3?new mt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ls(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ls(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=a4.exec(e))?new mt(t[1],t[2],t[3],1):(t=s4.exec(e))?new mt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=l4.exec(e))?ls(t[1],t[2],t[3],t[4]):(t=u4.exec(e))?ls(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=c4.exec(e))?Kd(t[1],t[2]/100,t[3]/100,1):(t=f4.exec(e))?Kd(t[1],t[2]/100,t[3]/100,t[4]):zd.hasOwnProperty(e)?Wd(zd[e]):e==="transparent"?new mt(NaN,NaN,NaN,0):null}function Wd(e){return new mt(e>>16&255,e>>8&255,e&255,1)}function ls(e,t,n,r){return r<=0&&(e=t=n=NaN),new mt(e,t,n,r)}function oh(e){return e instanceof Tr||(e=Er(e)),e?(e=e.rgb(),new mt(e.r,e.g,e.b,e.opacity)):new mt}function Sr(e,t,n,r){return arguments.length===1?oh(e):new mt(e,t,n,r??1)}function mt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}no(mt,Sr,$a(Tr,{brighter(e){return e=e==null?Li:Math.pow(Li,e),new mt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Qr:Math.pow(Qr,e),new mt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new mt(Vr(this.r),Vr(this.g),Vr(this.b),Ks(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xd,formatHex:Xd,formatHex8:m4,formatRgb:jd,toString:jd}));function Xd(){return`#${qr(this.r)}${qr(this.g)}${qr(this.b)}`}function m4(){return`#${qr(this.r)}${qr(this.g)}${qr(this.b)}${qr((isNaN(this.opacity)?1:this.opacity)*255)}`}function jd(){const e=Ks(this.opacity);return`${e===1?"rgb(":"rgba("}${Vr(this.r)}, ${Vr(this.g)}, ${Vr(this.b)}${e===1?")":`, ${e})`}`}function Ks(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qr(e){return e=Vr(e),(e<16?"0":"")+e.toString(16)}function Kd(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new mn(e,t,n,r)}function j1(e){if(e instanceof mn)return new mn(e.h,e.s,e.l,e.opacity);if(e instanceof Tr||(e=Er(e)),!e)return new mn;if(e instanceof mn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new mn(a,s,l,e.opacity)}function qc(e,t,n,r){return arguments.length===1?j1(e):new mn(e,t,n,r??1)}function mn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}no(mn,qc,$a(Tr,{brighter(e){return e=e==null?Li:Math.pow(Li,e),new mn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qr:Math.pow(Qr,e),new mn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new mt(Uu(e>=240?e-240:e+120,i,r),Uu(e,i,r),Uu(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new mn(Zd(this.h),us(this.s),us(this.l),Ks(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ks(this.opacity);return`${e===1?"hsl(":"hsla("}${Zd(this.h)}, ${us(this.s)*100}%, ${us(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Zd(e){return e=(e||0)%360,e<0?e+360:e}function us(e){return Math.max(0,Math.min(1,e||0))}function Uu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const K1=Math.PI/180,Z1=180/Math.PI,Zs=18,Q1=.96422,J1=1,eb=.82521,tb=4/29,$i=6/29,nb=3*$i*$i,p4=$i*$i*$i;function rb(e){if(e instanceof Fn)return new Fn(e.l,e.a,e.b,e.opacity);if(e instanceof er)return ib(e);e instanceof mt||(e=oh(e));var t=Vu(e.r),n=Vu(e.g),r=Vu(e.b),i=qu((.2225045*t+.7168786*n+.0606169*r)/J1),o,a;return t===n&&n===r?o=a=i:(o=qu((.4360747*t+.3850649*n+.1430804*r)/Q1),a=qu((.0139322*t+.0971045*n+.7141733*r)/eb)),new Fn(116*i-16,500*(o-i),200*(i-a),e.opacity)}function Hc(e,t,n,r){return arguments.length===1?rb(e):new Fn(e,t,n,r??1)}function Fn(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}no(Fn,Hc,$a(Tr,{brighter(e){return new Fn(this.l+Zs*(e??1),this.a,this.b,this.opacity)},darker(e){return new Fn(this.l-Zs*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Q1*Hu(t),e=J1*Hu(e),n=eb*Hu(n),new mt(zu(3.1338561*t-1.6168667*e-.4906146*n),zu(-.9787684*t+1.9161415*e+.033454*n),zu(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function qu(e){return e>p4?Math.pow(e,1/3):e/nb+tb}function Hu(e){return e>$i?e*e*e:nb*(e-tb)}function zu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Vu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function b4(e){if(e instanceof er)return new er(e.h,e.c,e.l,e.opacity);if(e instanceof Fn||(e=rb(e)),e.a===0&&e.b===0)return new er(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Z1;return new er(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function zc(e,t,n,r){return arguments.length===1?b4(e):new er(e,t,n,r??1)}function er(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function ib(e){if(isNaN(e.h))return new Fn(e.l,0,0,e.opacity);var t=e.h*K1;return new Fn(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}no(er,zc,$a(Tr,{brighter(e){return new er(this.h,this.c,this.l+Zs*(e??1),this.opacity)},darker(e){return new er(this.h,this.c,this.l-Zs*(e??1),this.opacity)},rgb(){return ib(this).rgb()}}));var ob=-.14861,ah=1.78277,sh=-.29227,Vl=-.90649,Jo=1.97294,Qd=Jo*Vl,Jd=Jo*ah,em=ah*sh-Vl*ob;function g4(e){if(e instanceof Yr)return new Yr(e.h,e.s,e.l,e.opacity);e instanceof mt||(e=oh(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(em*r+Qd*t-Jd*n)/(em+Qd-Jd),o=r-i,a=(Jo*(n-i)-sh*o)/Vl,s=Math.sqrt(a*a+o*o)/(Jo*i*(1-i)),l=s?Math.atan2(a,o)*Z1-120:NaN;return new Yr(l<0?l+360:l,s,i,e.opacity)}function Bn(e,t,n,r){return arguments.length===1?g4(e):new Yr(e,t,n,r??1)}function Yr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}no(Yr,Bn,$a(Tr,{brighter(e){return e=e==null?Li:Math.pow(Li,e),new Yr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Qr:Math.pow(Qr,e),new Yr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*K1,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new mt(255*(t+n*(ob*r+ah*i)),255*(t+n*(sh*r+Vl*i)),255*(t+n*(Jo*r)),this.opacity)}}));function y4(e,t,n,r,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*r+a*i)/6}function _4(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],a=r>0?e[r-1]:2*i-o,s=r<t-1?e[r+2]:2*o-i;return y4((n-r/t)*t,a,i,o,s)}}const Yl=e=>()=>e;function ab(e,t){return function(n){return e+n*t}}function v4(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function lh(e,t){var n=t-e;return n?ab(e,n>180||n<-180?n-360*Math.round(n/360):n):Yl(isNaN(e)?t:e)}function w4(e){return(e=+e)==1?Mt:function(t,n){return n-t?v4(t,n,e):Yl(isNaN(t)?n:t)}}function Mt(e,t){var n=t-e;return n?ab(e,n):Yl(isNaN(e)?t:e)}const Jr=function e(t){var n=w4(t);function r(i,o){var a=n((i=Sr(i)).r,(o=Sr(o)).r),s=n(i.g,o.g),l=n(i.b,o.b),u=Mt(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function M4(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Sr(t[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=e(r),i=e(i),o=e(o),s.opacity=1,function(l){return s.r=r(l),s.g=i(l),s.b=o(l),s+""}}}var E4=M4(_4);function S4(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function x4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function A4(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Ta(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function C4(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function P4(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=Ta(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Vc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yu=new RegExp(Vc.source,"g");function N4(e){return function(){return e}}function $4(e){return function(t){return e(t)+""}}function sb(e,t){var n=Vc.lastIndex=Yu.lastIndex=0,r,i,o,a=-1,s=[],l=[];for(e=e+"",t=t+"";(r=Vc.exec(e))&&(i=Yu.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:wt(r,i)})),n=Yu.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?$4(l[0].x):N4(t):(t=l.length,function(u){for(var c=0,h;c<t;++c)s[(h=l[c]).i]=h.x(u);return s.join("")})}function Ta(e,t){var n=typeof t,r;return t==null||n==="boolean"?Yl(t):(n==="number"?wt:n==="string"?(r=Er(t))?(t=r,Jr):sb:t instanceof Er?Jr:t instanceof Date?C4:x4(t)?S4:Array.isArray(t)?A4:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?P4:wt)(e,t)}function uh(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var tm=180/Math.PI,Yc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function lb(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*tm,skewX:Math.atan(l)*tm,scaleX:a,scaleY:s}}var cs;function T4(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Yc:lb(t.a,t.b,t.c,t.d,t.e,t.f)}function k4(e){return e==null||(cs||(cs=document.createElementNS("http://www.w3.org/2000/svg","g")),cs.setAttribute("transform",e),!(e=cs.transform.baseVal.consolidate()))?Yc:(e=e.matrix,lb(e.a,e.b,e.c,e.d,e.e,e.f))}function ub(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,h,f,d,m){if(u!==h||c!==f){var b=d.push("translate(",null,t,null,n);m.push({i:b-4,x:wt(u,h)},{i:b-2,x:wt(c,f)})}else(h||f)&&d.push("translate("+h+t+f+n)}function a(u,c,h,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:wt(u,c)})):c&&h.push(i(h)+"rotate("+c+r)}function s(u,c,h,f){u!==c?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:wt(u,c)}):c&&h.push(i(h)+"skewX("+c+r)}function l(u,c,h,f,d,m){if(u!==h||c!==f){var b=d.push(i(d)+"scale(",null,",",null,")");m.push({i:b-4,x:wt(u,h)},{i:b-2,x:wt(c,f)})}else(h!==1||f!==1)&&d.push(i(d)+"scale("+h+","+f+")")}return function(u,c){var h=[],f=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,h,f),a(u.rotate,c.rotate,h,f),s(u.skewX,c.skewX,h,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,f),u=c=null,function(d){for(var m=-1,b=f.length,g;++m<b;)h[(g=f[m]).i]=g.x(d);return h.join("")}}}var I4=ub(T4,"px, ","px)","deg)"),D4=ub(k4,", ",")",")");function F4(e){return function(t,n){var r=e((t=qc(t)).h,(n=qc(n)).h),i=Mt(t.s,n.s),o=Mt(t.l,n.l),a=Mt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=o(s),t.opacity=a(s),t+""}}}const R4=F4(lh);function B4(e,t){var n=Mt((e=Hc(e)).l,(t=Hc(t)).l),r=Mt(e.a,t.a),i=Mt(e.b,t.b),o=Mt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=o(a),e+""}}function O4(e){return function(t,n){var r=e((t=zc(t)).h,(n=zc(n)).h),i=Mt(t.c,n.c),o=Mt(t.l,n.l),a=Mt(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=o(s),t.opacity=a(s),t+""}}}const L4=O4(lh);function cb(e){return function t(n){n=+n;function r(i,o){var a=e((i=Bn(i)).h,(o=Bn(o)).h),s=Mt(i.s,o.s),l=Mt(i.l,o.l),u=Mt(i.opacity,o.opacity);return function(c){return i.h=a(c),i.s=s(c),i.l=l(Math.pow(c,n)),i.opacity=u(c),i+""}}return r.gamma=t,r}(1)}cb(lh);var ch=cb(Mt);function Wl(e,t){t===void 0&&(t=e,e=Ta);for(var n=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);n<r;)o[n]=e(i,i=t[++n]);return function(a){var s=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return o[s](a-s)}}function gn(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var Gi=0,Ao=0,yo=0,fb=1e3,Qs,Co,Js=0,ei=0,Xl=0,ea=typeof performance=="object"&&performance.now?performance:Date,hb=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function fh(){return ei||(hb(G4),ei=ea.now()+Xl)}function G4(){ei=0}function el(){this._call=this._time=this._next=null}el.prototype=db.prototype={constructor:el,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?fh():+n)+(t==null?0:+t),!this._next&&Co!==this&&(Co?Co._next=this:Qs=this,Co=this),this._call=e,this._time=n,Wc()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wc())}};function db(e,t,n){var r=new el;return r.restart(e,t,n),r}function U4(){fh(),++Gi;for(var e=Qs,t;e;)(t=ei-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Gi}function nm(){ei=(Js=ea.now())+Xl,Gi=Ao=0;try{U4()}finally{Gi=0,H4(),ei=0}}function q4(){var e=ea.now(),t=e-Js;t>fb&&(Xl-=t,Js=e)}function H4(){for(var e,t=Qs,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qs=n);Co=e,Wc(r)}function Wc(e){if(!Gi){Ao&&(Ao=clearTimeout(Ao));var t=e-ei;t>24?(e<1/0&&(Ao=setTimeout(nm,e-ea.now()-Xl)),yo&&(yo=clearInterval(yo))):(yo||(Js=ea.now(),yo=setInterval(q4,fb)),Gi=1,hb(nm))}}function rm(e,t,n){var r=new el;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var z4=B1("start","end","cancel","interrupt"),V4=[],mb=0,im=1,Xc=2,$s=3,om=4,jc=5,Ts=6;function jl(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;Y4(e,n,{name:t,index:r,group:i,on:z4,tween:V4,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:mb})}function hh(e,t){var n=En(e,t);if(n.state>mb)throw new Error("too late; already scheduled");return n}function Gn(e,t){var n=En(e,t);if(n.state>$s)throw new Error("too late; already running");return n}function En(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Y4(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=db(o,0,n.time);function o(u){n.state=im,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,h,f,d;if(n.state!==im)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===$s)return rm(a);d.state===om?(d.state=Ts,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[c]):+c<t&&(d.state=Ts,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[c])}if(rm(function(){n.state===$s&&(n.state=om,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=Xc,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Xc){for(n.state=$s,i=new Array(f=n.tween.length),c=0,h=-1;c<f;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=jc,1),h=-1,f=i.length;++h<f;)i[h].call(e,c);n.state===jc&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Ts,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function W4(e,t){var n=e.__transition,r,i,o=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>Xc&&r.state<jc,r.state=Ts,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function X4(e){return this.each(function(){W4(this,e)})}function j4(e,t){var n,r;return function(){var i=Gn(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function K4(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Gn(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function Z4(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=En(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?j4:K4)(n,e,t))}function dh(e,t,n){var r=e._id;return e.each(function(){var i=Gn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return En(i,r).value[t]}}function pb(e,t){var n;return(typeof t=="number"?wt:t instanceof Er?Jr:(n=Er(t))?(t=n,Jr):sb)(e,t)}function Q4(e){return function(){this.removeAttribute(e)}}function J4(e){return function(){this.removeAttributeNS(e.space,e.local)}}function e6(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function t6(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function n6(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function r6(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function i6(e,t){var n=Hl(e),r=n==="transform"?D4:pb;return this.attrTween(e,typeof t=="function"?(n.local?r6:n6)(n,r,dh(this,"attr."+e,t)):t==null?(n.local?J4:Q4)(n):(n.local?t6:e6)(n,r,t))}function o6(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function a6(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function s6(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&a6(e,o)),n}return i._value=t,i}function l6(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&o6(e,o)),n}return i._value=t,i}function u6(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Hl(e);return this.tween(n,(r.local?s6:l6)(r,t))}function c6(e,t){return function(){hh(this,e).delay=+t.apply(this,arguments)}}function f6(e,t){return t=+t,function(){hh(this,e).delay=t}}function h6(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?c6:f6)(t,e)):En(this.node(),t).delay}function d6(e,t){return function(){Gn(this,e).duration=+t.apply(this,arguments)}}function m6(e,t){return t=+t,function(){Gn(this,e).duration=t}}function p6(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?d6:m6)(t,e)):En(this.node(),t).duration}function b6(e,t){if(typeof t!="function")throw new Error;return function(){Gn(this,e).ease=t}}function g6(e){var t=this._id;return arguments.length?this.each(b6(t,e)):En(this.node(),t).ease}function y6(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Gn(this,e).ease=n}}function _6(e){if(typeof e!="function")throw new Error;return this.each(y6(this._id,e))}function v6(e){typeof e!="function"&&(e=L1(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new ir(r,this._parents,this._name,this._id)}function w6(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=t[s],u=n[s],c=l.length,h=a[s]=new Array(c),f,d=0;d<c;++d)(f=l[d]||u[d])&&(h[d]=f);for(;s<r;++s)a[s]=t[s];return new ir(a,this._parents,this._name,this._id)}function M6(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function E6(e,t,n){var r,i,o=M6(t)?hh:Gn;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function S6(e,t){var n=this._id;return arguments.length<2?En(this.node(),n).on.on(e):this.each(E6(n,e,t))}function x6(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function A6(){return this.on("end.remove",x6(this._id))}function C6(e){var t=this._name,n=this._id;typeof e!="function"&&(e=rh(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],l=s.length,u=o[a]=new Array(l),c,h,f=0;f<l;++f)(c=s[f])&&(h=e.call(c,c.__data__,f,s))&&("__data__"in c&&(h.__data__=c.__data__),u[f]=h,jl(u[f],t,n,f,u,En(c,n)));return new ir(o,this._parents,t,n)}function P6(e){var t=this._name,n=this._id;typeof e!="function"&&(e=O1(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var f=e.call(c,c.__data__,h,l),d,m=En(c,n),b=0,g=f.length;b<g;++b)(d=f[b])&&jl(d,t,n,b,f,m);o.push(f),a.push(c)}return new ir(o,a,t,n)}var N6=Na.prototype.constructor;function $6(){return new N6(this._groups,this._parents)}function T6(e,t){var n,r,i;return function(){var o=Oi(this,e),a=(this.style.removeProperty(e),Oi(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function bb(e){return function(){this.style.removeProperty(e)}}function k6(e,t,n){var r,i=n+"",o;return function(){var a=Oi(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function I6(e,t,n){var r,i,o;return function(){var a=Oi(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),Oi(this,e))),a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s))}}function D6(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var l=Gn(this,e),u=l.on,c=l.value[o]==null?s||(s=bb(t)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(a,i=c),l.on=r}}function F6(e,t,n){var r=(e+="")=="transform"?I4:pb;return t==null?this.styleTween(e,T6(e,r)).on("end.style."+e,bb(e)):typeof t=="function"?this.styleTween(e,I6(e,r,dh(this,"style."+e,t))).each(D6(this._id,e)):this.styleTween(e,k6(e,r,t),n).on("end.style."+e,null)}function R6(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function B6(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&R6(e,a,n)),r}return o._value=t,o}function O6(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,B6(e,t,n??""))}function L6(e){return function(){this.textContent=e}}function G6(e){return function(){var t=e(this);this.textContent=t??""}}function U6(e){return this.tween("text",typeof e=="function"?G6(dh(this,"text",e)):L6(e==null?"":e+""))}function q6(e){return function(t){this.textContent=e.call(this,t)}}function H6(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&q6(i)),t}return r._value=e,r}function z6(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,H6(e))}function V6(){for(var e=this._name,t=this._id,n=gb(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=En(l,t);jl(l,e,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ir(r,this._parents,e,n)}function Y6(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--i===0&&o()}};n.each(function(){var u=Gn(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),u.on=t}),i===0&&o()})}var W6=0;function ir(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function gb(){return++W6}var Wn=Na.prototype;ir.prototype={constructor:ir,select:C6,selectAll:P6,selectChild:Wn.selectChild,selectChildren:Wn.selectChildren,filter:v6,merge:w6,selection:$6,transition:V6,call:Wn.call,nodes:Wn.nodes,node:Wn.node,size:Wn.size,empty:Wn.empty,each:Wn.each,on:S6,attr:i6,attrTween:u6,style:F6,styleTween:O6,text:U6,textTween:z6,remove:A6,tween:Z4,delay:h6,duration:p6,ease:g6,easeVarying:_6,end:Y6,[Symbol.iterator]:Wn[Symbol.iterator]};function X6(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var j6={time:null,delay:0,duration:250,ease:X6};function K6(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Z6(e){var t,n;e instanceof ir?(t=e._id,e=e._name):(t=gb(),(n=j6).time=fh(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&jl(l,e,t,u,a,n||K6(l,t));return new ir(r,this._parents,e,t)}Na.prototype.interrupt=X4;Na.prototype.transition=Z6;const Kc=Math.PI,Zc=2*Kc,Lr=1e-6,Q6=Zc-Lr;function yb(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function J6(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return yb;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class _b{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?yb:J6(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,l=r-t,u=i-n,c=a-t,h=s-n,f=c*c+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>Lr)if(!(Math.abs(h*l-u*c)>Lr)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let d=r-a,m=i-s,b=l*l+u*u,g=d*d+m*m,E=Math.sqrt(b),_=Math.sqrt(f),y=o*Math.tan((Kc-Math.acos((b+f-g)/(2*E*_)))/2),v=y/_,x=y/E;Math.abs(v-1)>Lr&&this._append`L${t+v*c},${n+v*h}`,this._append`A${o},${o},0,0,${+(h*d>c*m)},${this._x1=t+x*l},${this._y1=n+x*u}`}}arc(t,n,r,i,o,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),l=r*Math.sin(i),u=t+s,c=n+l,h=1^a,f=a?i-o:o-i;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Lr||Math.abs(this._y1-c)>Lr)&&this._append`L${u},${c}`,r&&(f<0&&(f=f%Zc+Zc),f>Q6?this._append`A${r},${r},0,1,${h},${t-s},${n-l}A${r},${r},0,1,${h},${this._x1=u},${this._y1=c}`:f>Lr&&this._append`A${r},${r},0,${+(f>=Kc)},${h},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function gr(e=3){return new _b(+e)}function eM(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function tl(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Ui(e){return e=tl(Math.abs(e)),e?e[1]:NaN}function tM(e,t){return function(n,r){for(var i=n.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function nM(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var rM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ta(e){if(!(t=rM.exec(e)))throw new Error("invalid format: "+e);var t;return new mh({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ta.prototype=mh.prototype;function mh(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}mh.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function iM(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var vb;function oM(e,t){var n=tl(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(vb=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+tl(e,Math.max(0,t+o-1))[0]}function am(e,t){var n=tl(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const sm={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:eM,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>am(e*100,t),r:am,s:oM,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function lm(e){return e}var um=Array.prototype.map,cm=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function aM(e){var t=e.grouping===void 0||e.thousands===void 0?lm:tM(um.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?lm:nM(um.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function u(h){h=ta(h);var f=h.fill,d=h.align,m=h.sign,b=h.symbol,g=h.zero,E=h.width,_=h.comma,y=h.precision,v=h.trim,x=h.type;x==="n"?(_=!0,x="g"):sm[x]||(y===void 0&&(y=12),v=!0,x="g"),(g||f==="0"&&d==="=")&&(g=!0,f="0",d="=");var w=b==="$"?n:b==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",M=b==="$"?r:/[%p]/.test(x)?a:"",C=sm[x],S=/[defgprs%]/.test(x);y=y===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function N($){var T=w,L=M,D,I,V;if(x==="c")L=C($)+L,$="";else{$=+$;var W=$<0||1/$<0;if($=isNaN($)?l:C(Math.abs($),y),v&&($=iM($)),W&&+$==0&&m!=="+"&&(W=!1),T=(W?m==="("?m:s:m==="-"||m==="("?"":m)+T,L=(x==="s"?cm[8+vb/3]:"")+L+(W&&m==="("?")":""),S){for(D=-1,I=$.length;++D<I;)if(V=$.charCodeAt(D),48>V||V>57){L=(V===46?i+$.slice(D+1):$.slice(D))+L,$=$.slice(0,D);break}}}_&&!g&&($=t($,1/0));var U=T.length+$.length+L.length,Y=U<E?new Array(E-U+1).join(f):"";switch(_&&g&&($=t(Y+$,Y.length?E-L.length:1/0),Y=""),d){case"<":$=T+$+L+Y;break;case"=":$=T+Y+$+L;break;case"^":$=Y.slice(0,U=Y.length>>1)+T+$+L+Y.slice(U);break;default:$=Y+T+$+L;break}return o($)}return N.toString=function(){return h+""},N}function c(h,f){var d=u((h=ta(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(Ui(f)/3)))*3,b=Math.pow(10,-m),g=cm[8+m/3];return function(E){return d(b*E)+g}}return{format:u,formatPrefix:c}}var fs,ro,wb;sM({thousands:",",grouping:[3],currency:["$",""]});function sM(e){return fs=aM(e),ro=fs.format,wb=fs.formatPrefix,fs}function lM(e){return Math.max(0,-Ui(Math.abs(e)))}function uM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ui(t)/3)))*3-Ui(Math.abs(e)))}function cM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ui(t)-Ui(e))+1}var Ee=1e-6,Mb=1e-12,Ce=Math.PI,Je=Ce/2,fm=Ce/4,Yt=Ce*2,xt=180/Ce,Qe=Ce/180,Be=Math.abs,io=Math.atan,or=Math.atan2,Ae=Math.cos,Eb=Math.exp,nl=Math.log,Wu=Math.pow,ve=Math.sin,en=Math.sign||function(e){return e>0?1:e<0?-1:0},Bt=Math.sqrt,ph=Math.tan;function Sb(e){return e>1?0:e<-1?Ce:Math.acos(e)}function an(e){return e>1?Je:e<-1?-Je:Math.asin(e)}function tn(){}function rl(e,t){e&&dm.hasOwnProperty(e.type)&&dm[e.type](e,t)}var hm={Feature:function(e,t){rl(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)rl(n[r].geometry,t)}},dm={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Qc(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Qc(n[r],t,0)},Polygon:function(e,t){mm(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)mm(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)rl(n[r],t)}};function Qc(e,t,n){var r=-1,i=e.length-n,o;for(t.lineStart();++r<i;)o=e[r],t.point(o[0],o[1],o[2]);t.lineEnd()}function mm(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Qc(e[n],t,1);t.polygonEnd()}function Gr(e,t){e&&hm.hasOwnProperty(e.type)?hm[e.type](e,t):rl(e,t)}function Jc(e){return[or(e[1],e[0]),an(e[2])]}function qi(e){var t=e[0],n=e[1],r=Ae(n);return[r*Ae(t),r*ve(t),ve(n)]}function hs(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function il(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Xu(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ds(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function ef(e){var t=Bt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function tf(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function nf(e,t){return Be(e)>Ce&&(e-=Math.round(e/Yt)*Yt),[e,t]}nf.invert=nf;function xb(e,t,n){return(e%=Yt)?t||n?tf(bm(e),gm(t,n)):bm(e):t||n?gm(t,n):nf}function pm(e){return function(t,n){return t+=e,Be(t)>Ce&&(t-=Math.round(t/Yt)*Yt),[t,n]}}function bm(e){var t=pm(e);return t.invert=pm(-e),t}function gm(e,t){var n=Ae(e),r=ve(e),i=Ae(t),o=ve(t);function a(s,l){var u=Ae(l),c=Ae(s)*u,h=ve(s)*u,f=ve(l),d=f*n+c*r;return[or(h*i-d*o,c*n-f*r),an(d*i+h*o)]}return a.invert=function(s,l){var u=Ae(l),c=Ae(s)*u,h=ve(s)*u,f=ve(l),d=f*i-h*o;return[or(h*i+f*o,c*n+d*r),an(d*n-c*r)]},a}function fM(e){e=xb(e[0]*Qe,e[1]*Qe,e.length>2?e[2]*Qe:0);function t(n){return n=e(n[0]*Qe,n[1]*Qe),n[0]*=xt,n[1]*=xt,n}return t.invert=function(n){return n=e.invert(n[0]*Qe,n[1]*Qe),n[0]*=xt,n[1]*=xt,n},t}function hM(e,t,n,r,i,o){if(n){var a=Ae(t),s=ve(t),l=r*n;i==null?(i=t+r*Yt,o=t-l/2):(i=ym(a,i),o=ym(a,o),(r>0?i<o:i>o)&&(i+=r*Yt));for(var u,c=i;r>0?c>o:c<o;c-=l)u=Jc([a,-s*Ae(c),-s*ve(c)]),e.point(u[0],u[1])}}function ym(e,t){t=qi(t),t[0]-=e,ef(t);var n=Sb(-t[1]);return((-t[2]<0?-n:n)+Yt-Ee)%Yt}function Ab(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:tn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function ks(e,t){return Be(e[0]-t[0])<Ee&&Be(e[1]-t[1])<Ee}function ms(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Cb(e,t,n,r,i){var o=[],a=[],s,l;if(e.forEach(function(m){if(!((b=m.length-1)<=0)){var b,g=m[0],E=m[b],_;if(ks(g,E)){if(!g[2]&&!E[2]){for(i.lineStart(),s=0;s<b;++s)i.point((g=m[s])[0],g[1]);i.lineEnd();return}E[0]+=2*Ee}o.push(_=new ms(g,m,null,!0)),a.push(_.o=new ms(g,null,_,!1)),o.push(_=new ms(E,m,null,!1)),a.push(_.o=new ms(E,null,_,!0))}}),!!o.length){for(a.sort(t),_m(o),_m(a),s=0,l=a.length;s<l;++s)a[s].e=n=!n;for(var u=o[0],c,h;;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(s=0,l=c.length;s<l;++s)i.point((h=c[s])[0],h[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(c=f.p.z,s=c.length-1;s>=0;--s)i.point((h=c[s])[0],h[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,c=f.z,d=!d}while(!f.v);i.lineEnd()}}}function _m(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function ju(e){return Be(e[0])<=Ce?e[0]:en(e[0])*((Be(e[0])+Ce)%Yt-Ce)}function dM(e,t){var n=ju(t),r=t[1],i=ve(r),o=[ve(n),-Ae(n),0],a=0,s=0,l=new Kr;i===1?r=Je+Ee:i===-1&&(r=-Je-Ee);for(var u=0,c=e.length;u<c;++u)if(f=(h=e[u]).length)for(var h,f,d=h[f-1],m=ju(d),b=d[1]/2+fm,g=ve(b),E=Ae(b),_=0;_<f;++_,m=v,g=w,E=M,d=y){var y=h[_],v=ju(y),x=y[1]/2+fm,w=ve(x),M=Ae(x),C=v-m,S=C>=0?1:-1,N=S*C,$=N>Ce,T=g*w;if(l.add(or(T*S*ve(N),E*M+T*Ae(N))),a+=$?C+S*Yt:C,$^m>=n^v>=n){var L=il(qi(d),qi(y));ef(L);var D=il(o,L);ef(D);var I=($^C>=0?-1:1)*an(D[2]);(r>I||r===I&&(L[0]||L[1]))&&(s+=$^C>=0?1:-1)}}return(a<-Ee||a<Ee&&l<-Mb)^s&1}function Pb(e,t,n,r){return function(i){var o=t(i),a=Ab(),s=t(a),l=!1,u,c,h,f={point:d,lineStart:b,lineEnd:g,polygonStart:function(){f.point=E,f.lineStart=_,f.lineEnd=y,c=[],u=[]},polygonEnd:function(){f.point=d,f.lineStart=b,f.lineEnd=g,c=R1(c);var v=dM(u,r);c.length?(l||(i.polygonStart(),l=!0),Cb(c,pM,v,n,i)):v&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(v,x){e(v,x)&&i.point(v,x)}function m(v,x){o.point(v,x)}function b(){f.point=m,o.lineStart()}function g(){f.point=d,o.lineEnd()}function E(v,x){h.push([v,x]),s.point(v,x)}function _(){s.lineStart(),h=[]}function y(){E(h[0][0],h[0][1]),s.lineEnd();var v=s.clean(),x=a.result(),w,M=x.length,C,S,N;if(h.pop(),u.push(h),h=null,!!M){if(v&1){if(S=x[0],(C=S.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),w=0;w<C;++w)i.point((N=S[w])[0],N[1]);i.lineEnd()}return}M>1&&v&2&&x.push(x.pop().concat(x.shift())),c.push(x.filter(mM))}}return f}}function mM(e){return e.length>1}function pM(e,t){return((e=e.x)[0]<0?e[1]-Je-Ee:Je-e[1])-((t=t.x)[0]<0?t[1]-Je-Ee:Je-t[1])}const vm=Pb(function(){return!0},bM,yM,[-Ce,-Je]);function bM(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(o,a){var s=o>0?Ce:-Ce,l=Be(o-t);Be(l-Ce)<Ee?(e.point(t,n=(n+a)/2>0?Je:-Je),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),i=0):r!==s&&l>=Ce&&(Be(t-r)<Ee&&(t-=r*Ee),Be(o-s)<Ee&&(o-=s*Ee),n=gM(t,n,o,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=o,n=a),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function gM(e,t,n,r){var i,o,a=ve(e-n);return Be(a)>Ee?io((ve(t)*(o=Ae(r))*ve(n)-ve(r)*(i=Ae(t))*ve(e))/(i*o*a)):(t+r)/2}function yM(e,t,n,r){var i;if(e==null)i=n*Je,r.point(-Ce,i),r.point(0,i),r.point(Ce,i),r.point(Ce,0),r.point(Ce,-i),r.point(0,-i),r.point(-Ce,-i),r.point(-Ce,0),r.point(-Ce,i);else if(Be(e[0]-t[0])>Ee){var o=e[0]<t[0]?Ce:-Ce;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function _M(e){var t=Ae(e),n=2*Qe,r=t>0,i=Be(t)>Ee;function o(c,h,f,d){hM(d,e,n,f,c,h)}function a(c,h){return Ae(c)*Ae(h)>t}function s(c){var h,f,d,m,b;return{lineStart:function(){m=d=!1,b=1},point:function(g,E){var _=[g,E],y,v=a(g,E),x=r?v?0:u(g,E):v?u(g+(g<0?Ce:-Ce),E):0;if(!h&&(m=d=v)&&c.lineStart(),v!==d&&(y=l(h,_),(!y||ks(h,y)||ks(_,y))&&(_[2]=1)),v!==d)b=0,v?(c.lineStart(),y=l(_,h),c.point(y[0],y[1])):(y=l(h,_),c.point(y[0],y[1],2),c.lineEnd()),h=y;else if(i&&h&&r^v){var w;!(x&f)&&(w=l(_,h,!0))&&(b=0,r?(c.lineStart(),c.point(w[0][0],w[0][1]),c.point(w[1][0],w[1][1]),c.lineEnd()):(c.point(w[1][0],w[1][1]),c.lineEnd(),c.lineStart(),c.point(w[0][0],w[0][1],3)))}v&&(!h||!ks(h,_))&&c.point(_[0],_[1]),h=_,d=v,f=x},lineEnd:function(){d&&c.lineEnd(),h=null},clean:function(){return b|(m&&d)<<1}}}function l(c,h,f){var d=qi(c),m=qi(h),b=[1,0,0],g=il(d,m),E=hs(g,g),_=g[0],y=E-_*_;if(!y)return!f&&c;var v=t*E/y,x=-t*_/y,w=il(b,g),M=ds(b,v),C=ds(g,x);Xu(M,C);var S=w,N=hs(M,S),$=hs(S,S),T=N*N-$*(hs(M,M)-1);if(!(T<0)){var L=Bt(T),D=ds(S,(-N-L)/$);if(Xu(D,M),D=Jc(D),!f)return D;var I=c[0],V=h[0],W=c[1],U=h[1],Y;V<I&&(Y=I,I=V,V=Y);var k=V-I,B=Be(k-Ce)<Ee,G=B||k<Ee;if(!B&&U<W&&(Y=W,W=U,U=Y),G?B?W+U>0^D[1]<(Be(D[0]-I)<Ee?W:U):W<=D[1]&&D[1]<=U:k>Ce^(I<=D[0]&&D[0]<=V)){var X=ds(S,(-N+L)/$);return Xu(X,M),[D,Jc(X)]}}}function u(c,h){var f=r?e:Ce-e,d=0;return c<-f?d|=1:c>f&&(d|=2),h<-f?d|=4:h>f&&(d|=8),d}return Pb(a,s,o,r?[0,-e]:[-Ce,e-Ce])}function vM(e,t,n,r,i,o){var a=e[0],s=e[1],l=t[0],u=t[1],c=0,h=1,f=l-a,d=u-s,m;if(m=n-a,!(!f&&m>0)){if(m/=f,f<0){if(m<c)return;m<h&&(h=m)}else if(f>0){if(m>h)return;m>c&&(c=m)}if(m=i-a,!(!f&&m<0)){if(m/=f,f<0){if(m>h)return;m>c&&(c=m)}else if(f>0){if(m<c)return;m<h&&(h=m)}if(m=r-s,!(!d&&m>0)){if(m/=d,d<0){if(m<c)return;m<h&&(h=m)}else if(d>0){if(m>h)return;m>c&&(c=m)}if(m=o-s,!(!d&&m<0)){if(m/=d,d<0){if(m>h)return;m>c&&(c=m)}else if(d>0){if(m<c)return;m<h&&(h=m)}return c>0&&(e[0]=a+c*f,e[1]=s+c*d),h<1&&(t[0]=a+h*f,t[1]=s+h*d),!0}}}}}var Po=1e9,ps=-Po;function Nb(e,t,n,r){function i(u,c){return e<=u&&u<=n&&t<=c&&c<=r}function o(u,c,h,f){var d=0,m=0;if(u==null||(d=a(u,h))!==(m=a(c,h))||l(u,c)<0^h>0)do f.point(d===0||d===3?e:n,d>1?r:t);while((d=(d+h+4)%4)!==m);else f.point(c[0],c[1])}function a(u,c){return Be(u[0]-e)<Ee?c>0?0:3:Be(u[0]-n)<Ee?c>0?2:1:Be(u[1]-t)<Ee?c>0?1:0:c>0?3:2}function s(u,c){return l(u.x,c.x)}function l(u,c){var h=a(u,1),f=a(c,1);return h!==f?h-f:h===0?c[1]-u[1]:h===1?u[0]-c[0]:h===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,h=Ab(),f,d,m,b,g,E,_,y,v,x,w,M={point:C,lineStart:T,lineEnd:L,polygonStart:N,polygonEnd:$};function C(I,V){i(I,V)&&c.point(I,V)}function S(){for(var I=0,V=0,W=d.length;V<W;++V)for(var U=d[V],Y=1,k=U.length,B=U[0],G,X,Z=B[0],ie=B[1];Y<k;++Y)G=Z,X=ie,B=U[Y],Z=B[0],ie=B[1],X<=r?ie>r&&(Z-G)*(r-X)>(ie-X)*(e-G)&&++I:ie<=r&&(Z-G)*(r-X)<(ie-X)*(e-G)&&--I;return I}function N(){c=h,f=[],d=[],w=!0}function $(){var I=S(),V=w&&I,W=(f=R1(f)).length;(V||W)&&(u.polygonStart(),V&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),W&&Cb(f,s,I,o,u),u.polygonEnd()),c=u,f=d=m=null}function T(){M.point=D,d&&d.push(m=[]),x=!0,v=!1,_=y=NaN}function L(){f&&(D(b,g),E&&v&&h.rejoin(),f.push(h.result())),M.point=C,v&&c.lineEnd()}function D(I,V){var W=i(I,V);if(d&&m.push([I,V]),x)b=I,g=V,E=W,x=!1,W&&(c.lineStart(),c.point(I,V));else if(W&&v)c.point(I,V);else{var U=[_=Math.max(ps,Math.min(Po,_)),y=Math.max(ps,Math.min(Po,y))],Y=[I=Math.max(ps,Math.min(Po,I)),V=Math.max(ps,Math.min(Po,V))];vM(U,Y,e,t,n,r)?(v||(c.lineStart(),c.point(U[0],U[1])),c.point(Y[0],Y[1]),W||c.lineEnd(),w=!1):W&&(c.lineStart(),c.point(I,V),w=!1)}_=I,y=V,v=W}return M}}const rf=e=>e;var Ku=new Kr,of=new Kr,$b,Tb,af,sf,Jn={point:tn,lineStart:tn,lineEnd:tn,polygonStart:function(){Jn.lineStart=wM,Jn.lineEnd=EM},polygonEnd:function(){Jn.lineStart=Jn.lineEnd=Jn.point=tn,Ku.add(Be(of)),of=new Kr},result:function(){var e=Ku/2;return Ku=new Kr,e}};function wM(){Jn.point=MM}function MM(e,t){Jn.point=kb,$b=af=e,Tb=sf=t}function kb(e,t){of.add(sf*e-af*t),af=e,sf=t}function EM(){kb($b,Tb)}var Hi=1/0,ol=Hi,na=-Hi,al=na,sl={point:SM,lineStart:tn,lineEnd:tn,polygonStart:tn,polygonEnd:tn,result:function(){var e=[[Hi,ol],[na,al]];return na=al=-(ol=Hi=1/0),e}};function SM(e,t){e<Hi&&(Hi=e),e>na&&(na=e),t<ol&&(ol=t),t>al&&(al=t)}var lf=0,uf=0,No=0,ll=0,ul=0,Si=0,cf=0,ff=0,$o=0,Ib,Db,$n,Tn,Qt={point:ti,lineStart:wm,lineEnd:Mm,polygonStart:function(){Qt.lineStart=CM,Qt.lineEnd=PM},polygonEnd:function(){Qt.point=ti,Qt.lineStart=wm,Qt.lineEnd=Mm},result:function(){var e=$o?[cf/$o,ff/$o]:Si?[ll/Si,ul/Si]:No?[lf/No,uf/No]:[NaN,NaN];return lf=uf=No=ll=ul=Si=cf=ff=$o=0,e}};function ti(e,t){lf+=e,uf+=t,++No}function wm(){Qt.point=xM}function xM(e,t){Qt.point=AM,ti($n=e,Tn=t)}function AM(e,t){var n=e-$n,r=t-Tn,i=Bt(n*n+r*r);ll+=i*($n+e)/2,ul+=i*(Tn+t)/2,Si+=i,ti($n=e,Tn=t)}function Mm(){Qt.point=ti}function CM(){Qt.point=NM}function PM(){Fb(Ib,Db)}function NM(e,t){Qt.point=Fb,ti(Ib=$n=e,Db=Tn=t)}function Fb(e,t){var n=e-$n,r=t-Tn,i=Bt(n*n+r*r);ll+=i*($n+e)/2,ul+=i*(Tn+t)/2,Si+=i,i=Tn*e-$n*t,cf+=i*($n+e),ff+=i*(Tn+t),$o+=i*3,ti($n=e,Tn=t)}function Rb(e){this._context=e}Rb.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Yt);break}}},result:tn};var hf=new Kr,Zu,Bb,Ob,To,ko,ra={point:tn,lineStart:function(){ra.point=$M},lineEnd:function(){Zu&&Lb(Bb,Ob),ra.point=tn},polygonStart:function(){Zu=!0},polygonEnd:function(){Zu=null},result:function(){var e=+hf;return hf=new Kr,e}};function $M(e,t){ra.point=Lb,Bb=To=e,Ob=ko=t}function Lb(e,t){To-=e,ko-=t,hf.add(Bt(To*To+ko*ko)),To=e,ko=t}let Em,cl,Sm,xm;class Am{constructor(t){this._append=t==null?Gb:TM(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Sm||this._append!==cl){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Sm=r,cl=this._append,xm=this._,this._=i}this._+=xm;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Gb(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function TM(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Gb;if(t!==Em){const n=10**t;Em=t,cl=function(i){let o=1;this._+=i[0];for(const a=i.length;o<a;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return cl}function Kl(e,t){let n=3,r=4.5,i,o;function a(s){return s&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),Gr(s,i(o))),o.result()}return a.area=function(s){return Gr(s,i(Jn)),Jn.result()},a.measure=function(s){return Gr(s,i(ra)),ra.result()},a.bounds=function(s){return Gr(s,i(sl)),sl.result()},a.centroid=function(s){return Gr(s,i(Qt)),Qt.result()},a.projection=function(s){return arguments.length?(i=s==null?(e=null,rf):(e=s).stream,a):e},a.context=function(s){return arguments.length?(o=s==null?(t=null,new Am(n)):new Rb(t=s),typeof r!="function"&&o.pointRadius(r),a):t},a.pointRadius=function(s){return arguments.length?(r=typeof s=="function"?s:(o.pointRadius(+s),+s),a):r},a.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);n=l}return t===null&&(o=new Am(n)),a},a.projection(e).digits(n).context(t)}function df(e){return{stream:Zl(e)}}function Zl(e){return function(t){var n=new mf;for(var r in e)n[r]=e[r];return n.stream=t,n}}function mf(){}mf.prototype={constructor:mf,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function bh(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Gr(n,e.stream(sl)),t(sl.result()),r!=null&&e.clipExtent(r),e}function gh(e,t,n){return bh(e,function(r){var i=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([s,l])},n)}function Ub(e,t,n){return gh(e,[[0,0],t],n)}function qb(e,t,n){return bh(e,function(r){var i=+t,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];e.scale(150*o).translate([a,s])},n)}function Hb(e,t,n){return bh(e,function(r){var i=+t,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var Cm=16,kM=Ae(30*Qe);function Pm(e,t){return+t?DM(e,t):IM(e)}function IM(e){return Zl({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function DM(e,t){function n(r,i,o,a,s,l,u,c,h,f,d,m,b,g){var E=u-r,_=c-i,y=E*E+_*_;if(y>4*t&&b--){var v=a+f,x=s+d,w=l+m,M=Bt(v*v+x*x+w*w),C=an(w/=M),S=Be(Be(w)-1)<Ee||Be(o-h)<Ee?(o+h)/2:or(x,v),N=e(S,C),$=N[0],T=N[1],L=$-r,D=T-i,I=_*L-E*D;(I*I/y>t||Be((E*L+_*D)/y-.5)>.3||a*f+s*d+l*m<kM)&&(n(r,i,o,a,s,l,$,T,S,v/=M,x/=M,w,b,g),g.point($,T),n($,T,S,v,x,w,u,c,h,f,d,m,b,g))}}return function(r){var i,o,a,s,l,u,c,h,f,d,m,b,g={point:E,lineStart:_,lineEnd:v,polygonStart:function(){r.polygonStart(),g.lineStart=x},polygonEnd:function(){r.polygonEnd(),g.lineStart=_}};function E(C,S){C=e(C,S),r.point(C[0],C[1])}function _(){h=NaN,g.point=y,r.lineStart()}function y(C,S){var N=qi([C,S]),$=e(C,S);n(h,f,c,d,m,b,h=$[0],f=$[1],c=C,d=N[0],m=N[1],b=N[2],Cm,r),r.point(h,f)}function v(){g.point=E,r.lineEnd()}function x(){_(),g.point=w,g.lineEnd=M}function w(C,S){y(i=C,S),o=h,a=f,s=d,l=m,u=b,g.point=y}function M(){n(h,f,c,d,m,b,o,a,i,s,l,u,Cm,r),g.lineEnd=v,v()}return g}}var FM=Zl({point:function(e,t){this.stream.point(e*Qe,t*Qe)}});function RM(e){return Zl({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function BM(e,t,n,r,i){function o(a,s){return a*=r,s*=i,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*r,(n-s)/e*i]},o}function Nm(e,t,n,r,i,o){if(!o)return BM(e,t,n,r,i);var a=Ae(o),s=ve(o),l=a*e,u=s*e,c=a/e,h=s/e,f=(s*n-a*t)/e,d=(s*t+a*n)/e;function m(b,g){return b*=r,g*=i,[l*b-u*g+t,n-u*b-l*g]}return m.invert=function(b,g){return[r*(c*b-h*g+f),i*(d-h*b-c*g)]},m}function kr(e){return zb(function(){return e})()}function zb(e){var t,n=150,r=480,i=250,o=0,a=0,s=0,l=0,u=0,c,h=0,f=1,d=1,m=null,b=vm,g=null,E,_,y,v=rf,x=.5,w,M,C,S,N;function $(I){return C(I[0]*Qe,I[1]*Qe)}function T(I){return I=C.invert(I[0],I[1]),I&&[I[0]*xt,I[1]*xt]}$.stream=function(I){return S&&N===I?S:S=FM(RM(c)(b(w(v(N=I)))))},$.preclip=function(I){return arguments.length?(b=I,m=void 0,D()):b},$.postclip=function(I){return arguments.length?(v=I,g=E=_=y=null,D()):v},$.clipAngle=function(I){return arguments.length?(b=+I?_M(m=I*Qe):(m=null,vm),D()):m*xt},$.clipExtent=function(I){return arguments.length?(v=I==null?(g=E=_=y=null,rf):Nb(g=+I[0][0],E=+I[0][1],_=+I[1][0],y=+I[1][1]),D()):g==null?null:[[g,E],[_,y]]},$.scale=function(I){return arguments.length?(n=+I,L()):n},$.translate=function(I){return arguments.length?(r=+I[0],i=+I[1],L()):[r,i]},$.center=function(I){return arguments.length?(o=I[0]%360*Qe,a=I[1]%360*Qe,L()):[o*xt,a*xt]},$.rotate=function(I){return arguments.length?(s=I[0]%360*Qe,l=I[1]%360*Qe,u=I.length>2?I[2]%360*Qe:0,L()):[s*xt,l*xt,u*xt]},$.angle=function(I){return arguments.length?(h=I%360*Qe,L()):h*xt},$.reflectX=function(I){return arguments.length?(f=I?-1:1,L()):f<0},$.reflectY=function(I){return arguments.length?(d=I?-1:1,L()):d<0},$.precision=function(I){return arguments.length?(w=Pm(M,x=I*I),D()):Bt(x)},$.fitExtent=function(I,V){return gh($,I,V)},$.fitSize=function(I,V){return Ub($,I,V)},$.fitWidth=function(I,V){return qb($,I,V)},$.fitHeight=function(I,V){return Hb($,I,V)};function L(){var I=Nm(n,0,0,f,d,h).apply(null,t(o,a)),V=Nm(n,r-I[0],i-I[1],f,d,h);return c=xb(s,l,u),M=tf(t,V),C=tf(c,M),w=Pm(M,x),D()}function D(){return S=N=null,$}return function(){return t=e.apply(this,arguments),$.invert=t.invert&&T,L()}}function yh(e){var t=0,n=Ce/3,r=zb(e),i=r(t,n);return i.parallels=function(o){return arguments.length?r(t=o[0]*Qe,n=o[1]*Qe):[t*xt,n*xt]},i}function OM(e){var t=Ae(e);function n(r,i){return[r*t,ve(i)/t]}return n.invert=function(r,i){return[r/t,an(i*t)]},n}function LM(e,t){var n=ve(e),r=(n+ve(t))/2;if(Be(r)<Ee)return OM(e);var i=1+n*(2*r-n),o=Bt(i)/r;function a(s,l){var u=Bt(i-2*r*ve(l))/r;return[u*ve(s*=r),o-u*Ae(s)]}return a.invert=function(s,l){var u=o-l,c=or(s,Be(u))*en(u);return u*r<0&&(c-=Ce*en(s)*en(u)),[c/r,an((i-(s*s+u*u)*r*r)/(2*r))]},a}function fl(){return yh(LM).scale(155.424).center([0,33.6442])}function Vb(){return fl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function GM(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function UM(){var e,t,n=Vb(),r,i=fl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=fl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,l,u={point:function(f,d){l=[f,d]}};function c(f){var d=f[0],m=f[1];return l=null,r.point(d,m),l||(o.point(d,m),l)||(s.point(d,m),l)}c.invert=function(f){var d=n.scale(),m=n.translate(),b=(f[0]-m[0])/d,g=(f[1]-m[1])/d;return(g>=.12&&g<.234&&b>=-.425&&b<-.214?i:g>=.166&&g<.234&&b>=-.214&&b<-.115?a:n).invert(f)},c.stream=function(f){return e&&t===f?e:e=GM([n.stream(t=f),i.stream(f),a.stream(f)])},c.precision=function(f){return arguments.length?(n.precision(f),i.precision(f),a.precision(f),h()):n.precision()},c.scale=function(f){return arguments.length?(n.scale(f),i.scale(f*.35),a.scale(f),c.translate(n.translate())):n.scale()},c.translate=function(f){if(!arguments.length)return n.translate();var d=n.scale(),m=+f[0],b=+f[1];return r=n.translate(f).clipExtent([[m-.455*d,b-.238*d],[m+.455*d,b+.238*d]]).stream(u),o=i.translate([m-.307*d,b+.201*d]).clipExtent([[m-.425*d+Ee,b+.12*d+Ee],[m-.214*d-Ee,b+.234*d-Ee]]).stream(u),s=a.translate([m-.205*d,b+.212*d]).clipExtent([[m-.214*d+Ee,b+.166*d+Ee],[m-.115*d-Ee,b+.234*d-Ee]]).stream(u),h()},c.fitExtent=function(f,d){return gh(c,f,d)},c.fitSize=function(f,d){return Ub(c,f,d)},c.fitWidth=function(f,d){return qb(c,f,d)},c.fitHeight=function(f,d){return Hb(c,f,d)};function h(){return e=t=null,c}return c.scale(1070)}function Yb(e){return function(t,n){var r=Ae(t),i=Ae(n),o=e(r*i);return o===1/0?[2,0]:[o*i*ve(t),o*ve(n)]}}function ka(e){return function(t,n){var r=Bt(t*t+n*n),i=e(r),o=ve(i),a=Ae(i);return[or(t*o,r*a),an(r&&n*o/r)]}}var Wb=Yb(function(e){return Bt(2/(1+e))});Wb.invert=ka(function(e){return 2*an(e/2)});function qM(){return kr(Wb).scale(124.75).clipAngle(180-.001)}var Xb=Yb(function(e){return(e=Sb(e))&&e/ve(e)});Xb.invert=ka(function(e){return e});function HM(){return kr(Xb).scale(79.4188).clipAngle(180-.001)}function Ql(e,t){return[e,nl(ph((Je+t)/2))]}Ql.invert=function(e,t){return[e,2*io(Eb(t))-Je]};function zM(){return jb(Ql).scale(961/Yt)}function jb(e){var t=kr(e),n=t.center,r=t.scale,i=t.translate,o=t.clipExtent,a=null,s,l,u;t.scale=function(h){return arguments.length?(r(h),c()):r()},t.translate=function(h){return arguments.length?(i(h),c()):i()},t.center=function(h){return arguments.length?(n(h),c()):n()},t.clipExtent=function(h){return arguments.length?(h==null?a=s=l=u=null:(a=+h[0][0],s=+h[0][1],l=+h[1][0],u=+h[1][1]),c()):a==null?null:[[a,s],[l,u]]};function c(){var h=Ce*r(),f=t(fM(t.rotate()).invert([0,0]));return o(a==null?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:e===Ql?[[Math.max(f[0]-h,a),s],[Math.min(f[0]+h,l),u]]:[[a,Math.max(f[1]-h,s)],[l,Math.min(f[1]+h,u)]])}return c()}function bs(e){return ph((Je+e)/2)}function VM(e,t){var n=Ae(e),r=e===t?ve(e):nl(n/Ae(t))/nl(bs(t)/bs(e)),i=n*Wu(bs(e),r)/r;if(!r)return Ql;function o(a,s){i>0?s<-Je+Ee&&(s=-Je+Ee):s>Je-Ee&&(s=Je-Ee);var l=i/Wu(bs(s),r);return[l*ve(r*a),i-l*Ae(r*a)]}return o.invert=function(a,s){var l=i-s,u=en(r)*Bt(a*a+l*l),c=or(a,Be(l))*en(l);return l*r<0&&(c-=Ce*en(a)*en(l)),[c/r,2*io(Wu(i/u,1/r))-Je]},o}function YM(){return yh(VM).scale(109.5).parallels([30,30])}function hl(e,t){return[e,t]}hl.invert=hl;function WM(){return kr(hl).scale(152.63)}function XM(e,t){var n=Ae(e),r=e===t?ve(e):(n-Ae(t))/(t-e),i=n/r+e;if(Be(r)<Ee)return hl;function o(a,s){var l=i-s,u=r*a;return[l*ve(u),i-l*Ae(u)]}return o.invert=function(a,s){var l=i-s,u=or(a,Be(l))*en(l);return l*r<0&&(u-=Ce*en(a)*en(l)),[u/r,i-en(r)*Bt(a*a+l*l)]},o}function jM(){return yh(XM).scale(131.154).center([0,13.9389])}var Uo=1.340264,qo=-.081106,Ho=893e-6,zo=.003796,dl=Bt(3)/2,KM=12;function Kb(e,t){var n=an(dl*ve(t)),r=n*n,i=r*r*r;return[e*Ae(n)/(dl*(Uo+3*qo*r+i*(7*Ho+9*zo*r))),n*(Uo+qo*r+i*(Ho+zo*r))]}Kb.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,o=0,a,s,l;o<KM&&(s=n*(Uo+qo*r+i*(Ho+zo*r))-t,l=Uo+3*qo*r+i*(7*Ho+9*zo*r),n-=a=s/l,r=n*n,i=r*r*r,!(Be(a)<Mb));++o);return[dl*e*(Uo+3*qo*r+i*(7*Ho+9*zo*r))/Ae(n),an(ve(n)/dl)]};function ZM(){return kr(Kb).scale(177.158)}function Zb(e,t){var n=Ae(t),r=Ae(e)*n;return[n*ve(e)/r,ve(t)/r]}Zb.invert=ka(io);function QM(){return kr(Zb).scale(144.049).clipAngle(60)}function Qb(e,t){return[Ae(t)*ve(e),ve(t)]}Qb.invert=ka(an);function JM(){return kr(Qb).scale(249.5).clipAngle(90+Ee)}function Jb(e,t){var n=Ae(t),r=1+Ae(e)*n;return[n*ve(e)/r,ve(t)/r]}Jb.invert=ka(function(e){return 2*io(e)});function e8(){return kr(Jb).scale(250).clipAngle(142)}function eg(e,t){return[nl(ph((Je+t)/2)),-e]}eg.invert=function(e,t){return[-t,2*io(Eb(e))-Je]};function t8(){var e=jb(eg),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function Un(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Jl(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const pf=Symbol("implicit");function _h(){var e=new Zr,t=[],n=[],r=pf;function i(o){let a=e.get(o);if(a===void 0){if(r!==pf)return r;e.set(o,a=t.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Zr;for(const a of o)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return _h(t,n).unknown(r)},Un.apply(i,arguments),i}function eu(){var e=_h().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,o,a,s=!1,l=0,u=0,c=.5;delete e.unknown;function h(){var f=t().length,d=i<r,m=d?i:r,b=d?r:i;o=(b-m)/Math.max(1,f-l+u*2),s&&(o=Math.floor(o)),m+=(b-m-o*(f-l))*c,a=o*(1-l),s&&(m=Math.round(m),a=Math.round(a));var g=be(f).map(function(E){return m+o*E});return n(d?g.reverse():g)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,h()):[r,i]},e.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,s=!0,h()},e.bandwidth=function(){return a},e.step=function(){return o},e.round=function(f){return arguments.length?(s=!!f,h()):s},e.padding=function(f){return arguments.length?(l=Math.min(1,u=+f),h()):l},e.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),h()):l},e.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},e.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),h()):c},e.copy=function(){return eu(t(),[r,i]).round(s).paddingInner(l).paddingOuter(u).align(c)},Un.apply(h(),arguments)}function tg(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return tg(t())},e}function n8(){return tg(eu.apply(null,arguments).paddingInner(1))}function r8(e){return function(){return e}}function bf(e){return+e}var $m=[0,1];function nn(e){return e}function gf(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:r8(isNaN(t)?NaN:.5)}function i8(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function o8(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=gf(i,r),o=n(a,o)):(r=gf(r,i),o=n(o,a)),function(s){return o(r(s))}}function a8(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=gf(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var l=Ll(e,s,1,r)-1;return o[l](i[l](s))}}function Ia(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function tu(){var e=$m,t=$m,n=Ta,r,i,o,a=nn,s,l,u;function c(){var f=Math.min(e.length,t.length);return a!==nn&&(a=i8(e[0],e[f-1])),s=f>2?a8:o8,l=u=null,h}function h(f){return f==null||isNaN(f=+f)?o:(l||(l=s(e.map(r),t,n)))(r(a(f)))}return h.invert=function(f){return a(i((u||(u=s(t,e.map(r),wt)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,bf),c()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),c()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),n=uh,c()},h.clamp=function(f){return arguments.length?(a=f?!0:nn,c()):a!==nn},h.interpolate=function(f){return arguments.length?(n=f,c()):n},h.unknown=function(f){return arguments.length?(o=f,h):o},function(f,d){return r=f,i=d,c()}}function ng(){return tu()(nn,nn)}function s8(e,t,n,r){var i=Lc(e,t,n),o;switch(r=ta(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=uM(i,a))&&(r.precision=o),wb(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=cM(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=lM(i))&&(r.precision=o-(r.type==="%")*2);break}}return ro(r)}function Da(e){var t=e.domain;return e.ticks=function(n){var r=t();return Zo(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return s8(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,a=r[i],s=r[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=i,i=o,o=u);c-- >0;){if(u=Ri(a,s,n),u===l)return r[i]=a,r[o]=s,t(r);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return e},e}function vh(){var e=ng();return e.copy=function(){return Ia(e,vh())},Un.apply(e,arguments),Da(e)}function rg(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,bf),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return rg(e).unknown(t)},e=arguments.length?Array.from(e,bf):[0,1],Da(n)}function ig(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],o=e[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),e[n]=t.floor(i),e[r]=t.ceil(o),e}function Tm(e){return Math.log(e)}function km(e){return Math.exp(e)}function l8(e){return-Math.log(-e)}function u8(e){return-Math.exp(-e)}function c8(e){return isFinite(e)?+("1e"+e):e<0?0:e}function f8(e){return e===10?c8:e===Math.E?Math.exp:t=>Math.pow(e,t)}function h8(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Im(e){return(t,n)=>-e(-t,n)}function og(e){const t=e(Tm,km),n=t.domain;let r=10,i,o;function a(){return i=h8(r),o=f8(r),n()[0]<0?(i=Im(i),o=Im(o),e(l8,u8)):e(Tm,km),t}return t.base=function(s){return arguments.length?(r=+s,a()):r},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=s=>{const l=n();let u=l[0],c=l[l.length-1];const h=c<u;h&&([u,c]=[c,u]);let f=i(u),d=i(c),m,b;const g=s==null?10:+s;let E=[];if(!(r%1)&&d-f<g){if(f=Math.floor(f),d=Math.ceil(d),u>0){for(;f<=d;++f)for(m=1;m<r;++m)if(b=f<0?m/o(-f):m*o(f),!(b<u)){if(b>c)break;E.push(b)}}else for(;f<=d;++f)for(m=r-1;m>=1;--m)if(b=f>0?m/o(-f):m*o(f),!(b<u)){if(b>c)break;E.push(b)}E.length*2<g&&(E=Zo(u,c,g))}else E=Zo(f,d,Math.min(d-f,g)).map(o);return h?E.reverse():E},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=ta(l)).precision==null&&(l.trim=!0),l=ro(l)),s===1/0)return l;const u=Math.max(1,r*s/t.ticks().length);return c=>{let h=c/o(Math.round(i(c)));return h*r<r-.5&&(h*=r),h<=u?l(c):""}},t.nice=()=>n(ig(n(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),t}function ag(){const e=og(tu()).domain([1,10]);return e.copy=()=>Ia(e,ag()).base(e.base()),Un.apply(e,arguments),e}function Dm(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Fm(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function sg(e){var t=1,n=e(Dm(t),Fm(t));return n.constant=function(r){return arguments.length?e(Dm(t=+r),Fm(t)):t},Da(n)}function lg(){var e=sg(tu());return e.copy=function(){return Ia(e,lg()).constant(e.constant())},Un.apply(e,arguments)}function Rm(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function d8(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function m8(e){return e<0?-e*e:e*e}function ug(e){var t=e(nn,nn),n=1;function r(){return n===1?e(nn,nn):n===.5?e(d8,m8):e(Rm(n),Rm(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Da(t)}function cg(){var e=ug(tu());return e.copy=function(){return Ia(e,cg()).exponent(e.exponent())},Un.apply(e,arguments),e}function fg(){var e=[],t=[],n=[],r;function i(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=u5(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?r:t[Ll(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Dt),i()},o.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.quantiles=function(){return n.slice()},o.copy=function(){return fg().domain(e).range(t).unknown(r)},Un.apply(o,arguments)}function hg(){var e=[.5],t=[0,1],n,r=1;function i(o){return o!=null&&o<=o?t[Ll(e,o,0,r)]:n}return i.domain=function(o){return arguments.length?(e=Array.from(o),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return hg().domain(e).range(t).unknown(n)},Un.apply(i,arguments)}const Qu=new Date,Ju=new Date;function st(e,t,n,r){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{const a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(t(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{const l=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;let u;do l.push(u=new Date(+o)),t(o,s),e(o);while(u<o&&o<a);return l},i.filter=o=>st(a=>{if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););}),n&&(i.count=(o,a)=>(Qu.setTime(+o),Ju.setTime(+a),e(Qu),e(Ju),Math.floor(n(Qu,Ju))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const ml=st(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ml.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?st(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):ml);ml.range;const tr=1e3,rn=tr*60,nr=rn*60,ar=nr*24,wh=ar*7,Bm=ar*30,ec=ar*365,pn=st(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*tr)},(e,t)=>(t-e)/tr,e=>e.getUTCSeconds());pn.range;const Fa=st(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*tr)},(e,t)=>{e.setTime(+e+t*rn)},(e,t)=>(t-e)/rn,e=>e.getMinutes());Fa.range;const Ra=st(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*rn)},(e,t)=>(t-e)/rn,e=>e.getUTCMinutes());Ra.range;const Ba=st(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*tr-e.getMinutes()*rn)},(e,t)=>{e.setTime(+e+t*nr)},(e,t)=>(t-e)/nr,e=>e.getHours());Ba.range;const Oa=st(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*nr)},(e,t)=>(t-e)/nr,e=>e.getUTCHours());Oa.range;const li=st(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*rn)/ar,e=>e.getDate()-1);li.range;const nu=st(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ar,e=>e.getUTCDate()-1);nu.range;const ru=st(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ar,e=>Math.floor(e/ar));ru.range;function ui(e){return st(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*rn)/wh)}const zi=ui(0),ia=ui(1),dg=ui(2),mg=ui(3),ni=ui(4),pg=ui(5),bg=ui(6);zi.range;ia.range;dg.range;mg.range;ni.range;pg.range;bg.range;function ci(e){return st(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/wh)}const Vi=ci(0),oa=ci(1),gg=ci(2),yg=ci(3),ri=ci(4),_g=ci(5),vg=ci(6);Vi.range;oa.range;gg.range;yg.range;ri.range;_g.range;vg.range;const La=st(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());La.range;const Ga=st(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Ga.range;const yn=st(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());yn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:st(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});yn.range;const _n=st(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_n.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:st(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});_n.range;function wg(e,t,n,r,i,o){const a=[[pn,1,tr],[pn,5,5*tr],[pn,15,15*tr],[pn,30,30*tr],[o,1,rn],[o,5,5*rn],[o,15,15*rn],[o,30,30*rn],[i,1,nr],[i,3,3*nr],[i,6,6*nr],[i,12,12*nr],[r,1,ar],[r,2,2*ar],[n,1,wh],[t,1,Bm],[t,3,3*Bm],[e,1,ec]];function s(u,c,h){const f=c<u;f&&([u,c]=[c,u]);const d=h&&typeof h.range=="function"?h:l(u,c,h),m=d?d.range(u,+c+1):[];return f?m.reverse():m}function l(u,c,h){const f=Math.abs(c-u)/h,d=Ol(([,,g])=>g).right(a,f);if(d===a.length)return e.every(Lc(u/ec,c/ec,h));if(d===0)return ml.every(Math.max(Lc(u,c,h),1));const[m,b]=a[f/a[d-1][2]<a[d][2]/f?d-1:d];return m.every(b)}return[s,l]}const[p8,b8]=wg(_n,Ga,Vi,ru,Oa,Ra),[g8,y8]=wg(yn,La,zi,li,Ba,Fa);function tc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nc(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _o(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function _8(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,u=vo(i),c=wo(i),h=vo(o),f=wo(o),d=vo(a),m=wo(a),b=vo(s),g=wo(s),E=vo(l),_=wo(l),y={a:W,A:U,b:Y,B:k,c:null,d:Hm,e:Hm,f:q8,g:Q8,G:e9,H:L8,I:G8,j:U8,L:Mg,m:H8,M:z8,p:B,q:G,Q:Ym,s:Wm,S:V8,u:Y8,U:W8,V:X8,w:j8,W:K8,x:null,X:null,y:Z8,Y:J8,Z:t9,"%":Vm},v={a:X,A:Z,b:ie,B:ee,c:null,d:zm,e:zm,f:o9,g:p9,G:g9,H:n9,I:r9,j:i9,L:Sg,m:a9,M:s9,p:j,q:J,Q:Ym,s:Wm,S:l9,u:u9,U:c9,V:f9,w:h9,W:d9,x:null,X:null,y:m9,Y:b9,Z:y9,"%":Vm},x={a:N,A:$,b:T,B:L,c:D,d:Um,e:Um,f:F8,g:Gm,G:Lm,H:qm,I:qm,j:T8,L:D8,m:$8,M:k8,p:S,q:N8,Q:B8,s:O8,S:I8,u:S8,U:x8,V:A8,w:E8,W:C8,x:I,X:V,y:Gm,Y:Lm,Z:P8,"%":R8};y.x=w(n,y),y.X=w(r,y),y.c=w(t,y),v.x=w(n,v),v.X=w(r,v),v.c=w(t,v);function w(F,ne){return function(re){var q=[],ce=-1,H=0,ue=F.length,ae,he,de;for(re instanceof Date||(re=new Date(+re));++ce<ue;)F.charCodeAt(ce)===37&&(q.push(F.slice(H,ce)),(he=Om[ae=F.charAt(++ce)])!=null?ae=F.charAt(++ce):he=ae==="e"?" ":"0",(de=ne[ae])&&(ae=de(re,he)),q.push(ae),H=ce+1);return q.push(F.slice(H,ce)),q.join("")}}function M(F,ne){return function(re){var q=_o(1900,void 0,1),ce=C(q,F,re+="",0),H,ue;if(ce!=re.length)return null;if("Q"in q)return new Date(q.Q);if("s"in q)return new Date(q.s*1e3+("L"in q?q.L:0));if(ne&&!("Z"in q)&&(q.Z=0),"p"in q&&(q.H=q.H%12+q.p*12),q.m===void 0&&(q.m="q"in q?q.q:0),"V"in q){if(q.V<1||q.V>53)return null;"w"in q||(q.w=1),"Z"in q?(H=nc(_o(q.y,0,1)),ue=H.getUTCDay(),H=ue>4||ue===0?oa.ceil(H):oa(H),H=nu.offset(H,(q.V-1)*7),q.y=H.getUTCFullYear(),q.m=H.getUTCMonth(),q.d=H.getUTCDate()+(q.w+6)%7):(H=tc(_o(q.y,0,1)),ue=H.getDay(),H=ue>4||ue===0?ia.ceil(H):ia(H),H=li.offset(H,(q.V-1)*7),q.y=H.getFullYear(),q.m=H.getMonth(),q.d=H.getDate()+(q.w+6)%7)}else("W"in q||"U"in q)&&("w"in q||(q.w="u"in q?q.u%7:"W"in q?1:0),ue="Z"in q?nc(_o(q.y,0,1)).getUTCDay():tc(_o(q.y,0,1)).getDay(),q.m=0,q.d="W"in q?(q.w+6)%7+q.W*7-(ue+5)%7:q.w+q.U*7-(ue+6)%7);return"Z"in q?(q.H+=q.Z/100|0,q.M+=q.Z%100,nc(q)):tc(q)}}function C(F,ne,re,q){for(var ce=0,H=ne.length,ue=re.length,ae,he;ce<H;){if(q>=ue)return-1;if(ae=ne.charCodeAt(ce++),ae===37){if(ae=ne.charAt(ce++),he=x[ae in Om?ne.charAt(ce++):ae],!he||(q=he(F,re,q))<0)return-1}else if(ae!=re.charCodeAt(q++))return-1}return q}function S(F,ne,re){var q=u.exec(ne.slice(re));return q?(F.p=c.get(q[0].toLowerCase()),re+q[0].length):-1}function N(F,ne,re){var q=d.exec(ne.slice(re));return q?(F.w=m.get(q[0].toLowerCase()),re+q[0].length):-1}function $(F,ne,re){var q=h.exec(ne.slice(re));return q?(F.w=f.get(q[0].toLowerCase()),re+q[0].length):-1}function T(F,ne,re){var q=E.exec(ne.slice(re));return q?(F.m=_.get(q[0].toLowerCase()),re+q[0].length):-1}function L(F,ne,re){var q=b.exec(ne.slice(re));return q?(F.m=g.get(q[0].toLowerCase()),re+q[0].length):-1}function D(F,ne,re){return C(F,t,ne,re)}function I(F,ne,re){return C(F,n,ne,re)}function V(F,ne,re){return C(F,r,ne,re)}function W(F){return a[F.getDay()]}function U(F){return o[F.getDay()]}function Y(F){return l[F.getMonth()]}function k(F){return s[F.getMonth()]}function B(F){return i[+(F.getHours()>=12)]}function G(F){return 1+~~(F.getMonth()/3)}function X(F){return a[F.getUTCDay()]}function Z(F){return o[F.getUTCDay()]}function ie(F){return l[F.getUTCMonth()]}function ee(F){return s[F.getUTCMonth()]}function j(F){return i[+(F.getUTCHours()>=12)]}function J(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var ne=w(F+="",y);return ne.toString=function(){return F},ne},parse:function(F){var ne=M(F+="",!1);return ne.toString=function(){return F},ne},utcFormat:function(F){var ne=w(F+="",v);return ne.toString=function(){return F},ne},utcParse:function(F){var ne=M(F+="",!0);return ne.toString=function(){return F},ne}}}var Om={"-":"",_:" ",0:"0"},gt=/^\s*\d+/,v8=/^%/,w8=/[\\^$*+?|[\]().{}]/g;function De(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function M8(e){return e.replace(w8,"\\$&")}function vo(e){return new RegExp("^(?:"+e.map(M8).join("|")+")","i")}function wo(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function E8(e,t,n){var r=gt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function S8(e,t,n){var r=gt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function x8(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function A8(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function C8(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Lm(e,t,n){var r=gt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Gm(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function P8(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function N8(e,t,n){var r=gt.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function $8(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Um(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function T8(e,t,n){var r=gt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function qm(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function k8(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function I8(e,t,n){var r=gt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function D8(e,t,n){var r=gt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function F8(e,t,n){var r=gt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function R8(e,t,n){var r=v8.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function B8(e,t,n){var r=gt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function O8(e,t,n){var r=gt.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Hm(e,t){return De(e.getDate(),t,2)}function L8(e,t){return De(e.getHours(),t,2)}function G8(e,t){return De(e.getHours()%12||12,t,2)}function U8(e,t){return De(1+li.count(yn(e),e),t,3)}function Mg(e,t){return De(e.getMilliseconds(),t,3)}function q8(e,t){return Mg(e,t)+"000"}function H8(e,t){return De(e.getMonth()+1,t,2)}function z8(e,t){return De(e.getMinutes(),t,2)}function V8(e,t){return De(e.getSeconds(),t,2)}function Y8(e){var t=e.getDay();return t===0?7:t}function W8(e,t){return De(zi.count(yn(e)-1,e),t,2)}function Eg(e){var t=e.getDay();return t>=4||t===0?ni(e):ni.ceil(e)}function X8(e,t){return e=Eg(e),De(ni.count(yn(e),e)+(yn(e).getDay()===4),t,2)}function j8(e){return e.getDay()}function K8(e,t){return De(ia.count(yn(e)-1,e),t,2)}function Z8(e,t){return De(e.getFullYear()%100,t,2)}function Q8(e,t){return e=Eg(e),De(e.getFullYear()%100,t,2)}function J8(e,t){return De(e.getFullYear()%1e4,t,4)}function e9(e,t){var n=e.getDay();return e=n>=4||n===0?ni(e):ni.ceil(e),De(e.getFullYear()%1e4,t,4)}function t9(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+De(t/60|0,"0",2)+De(t%60,"0",2)}function zm(e,t){return De(e.getUTCDate(),t,2)}function n9(e,t){return De(e.getUTCHours(),t,2)}function r9(e,t){return De(e.getUTCHours()%12||12,t,2)}function i9(e,t){return De(1+nu.count(_n(e),e),t,3)}function Sg(e,t){return De(e.getUTCMilliseconds(),t,3)}function o9(e,t){return Sg(e,t)+"000"}function a9(e,t){return De(e.getUTCMonth()+1,t,2)}function s9(e,t){return De(e.getUTCMinutes(),t,2)}function l9(e,t){return De(e.getUTCSeconds(),t,2)}function u9(e){var t=e.getUTCDay();return t===0?7:t}function c9(e,t){return De(Vi.count(_n(e)-1,e),t,2)}function xg(e){var t=e.getUTCDay();return t>=4||t===0?ri(e):ri.ceil(e)}function f9(e,t){return e=xg(e),De(ri.count(_n(e),e)+(_n(e).getUTCDay()===4),t,2)}function h9(e){return e.getUTCDay()}function d9(e,t){return De(oa.count(_n(e)-1,e),t,2)}function m9(e,t){return De(e.getUTCFullYear()%100,t,2)}function p9(e,t){return e=xg(e),De(e.getUTCFullYear()%100,t,2)}function b9(e,t){return De(e.getUTCFullYear()%1e4,t,4)}function g9(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ri(e):ri.ceil(e),De(e.getUTCFullYear()%1e4,t,4)}function y9(){return"+0000"}function Vm(){return"%"}function Ym(e){return+e}function Wm(e){return Math.floor(+e/1e3)}var yi,Mh,Ua;_9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _9(e){return yi=_8(e),Mh=yi.format,yi.parse,Ua=yi.utcFormat,yi.utcParse,yi}function v9(e){return new Date(e)}function w9(e){return e instanceof Date?+e:+new Date(+e)}function Eh(e,t,n,r,i,o,a,s,l,u){var c=ng(),h=c.invert,f=c.domain,d=u(".%L"),m=u(":%S"),b=u("%I:%M"),g=u("%I %p"),E=u("%a %d"),_=u("%b %d"),y=u("%B"),v=u("%Y");function x(w){return(l(w)<w?d:s(w)<w?m:a(w)<w?b:o(w)<w?g:r(w)<w?i(w)<w?E:_:n(w)<w?y:v)(w)}return c.invert=function(w){return new Date(h(w))},c.domain=function(w){return arguments.length?f(Array.from(w,w9)):f().map(v9)},c.ticks=function(w){var M=f();return e(M[0],M[M.length-1],w??10)},c.tickFormat=function(w,M){return M==null?x:u(M)},c.nice=function(w){var M=f();return(!w||typeof w.range!="function")&&(w=t(M[0],M[M.length-1],w??10)),w?f(ig(M,w)):c},c.copy=function(){return Ia(c,Eh(e,t,n,r,i,o,a,s,l,u))},c}function M9(){return Un.apply(Eh(g8,y8,yn,La,zi,li,Ba,Fa,pn,Mh).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function E9(){return Un.apply(Eh(p8,b8,_n,Ga,Vi,nu,Oa,Ra,pn,Ua).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function iu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ou(){var e=0,t=.5,n=1,r=1,i,o,a,s,l,u=nn,c,h=!1,f;function d(b){return isNaN(b=+b)?f:(b=.5+((b=+c(b))-o)*(r*b<r*o?s:l),u(h?Math.max(0,Math.min(1,b)):b))}d.domain=function(b){return arguments.length?([e,t,n]=b,i=c(e=+e),o=c(t=+t),a=c(n=+n),s=i===o?0:.5/(o-i),l=o===a?0:.5/(a-o),r=o<i?-1:1,d):[e,t,n]},d.clamp=function(b){return arguments.length?(h=!!b,d):h},d.interpolator=function(b){return arguments.length?(u=b,d):u};function m(b){return function(g){var E,_,y;return arguments.length?([E,_,y]=g,u=Wl(b,[E,_,y]),d):[u(0),u(.5),u(1)]}}return d.range=m(Ta),d.rangeRound=m(uh),d.unknown=function(b){return arguments.length?(f=b,d):f},function(b){return c=b,i=b(e),o=b(t),a=b(n),s=i===o?0:.5/(o-i),l=o===a?0:.5/(a-o),r=o<i?-1:1,d}}function Ag(){var e=Da(ou()(nn));return e.copy=function(){return iu(e,Ag())},Jl.apply(e,arguments)}function Cg(){var e=og(ou()).domain([.1,1,10]);return e.copy=function(){return iu(e,Cg()).base(e.base())},Jl.apply(e,arguments)}function Pg(){var e=sg(ou());return e.copy=function(){return iu(e,Pg()).constant(e.constant())},Jl.apply(e,arguments)}function Ng(){var e=ug(ou());return e.copy=function(){return iu(e,Ng()).exponent(e.exponent())},Jl.apply(e,arguments)}function Me(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const S9=Me("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),x9=Me("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),A9=Me("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),C9=Me("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),P9=Me("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),N9=Me("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),$9=Me("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),T9=Me("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),k9=Me("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),I9=Me("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),D9=Me("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ye=e=>E4(e[e.length-1]);var $g=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Me);const Tg=Ye($g);var kg=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Me);const Ig=Ye(kg);var Dg=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Me);const Fg=Ye(Dg);var Rg=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Me);const Bg=Ye(Rg);var yf=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Me);const pl=Ye(yf);var Og=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Me);const Lg=Ye(Og);var _f=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Me);const aa=Ye(_f);var Gg=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Me);const Ug=Ye(Gg);var qg=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Me);const Hg=Ye(qg);var zg=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Me);const Vg=Ye(zg);var Yg=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Me);const Wg=Ye(Yg);var Xg=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Me);const jg=Ye(Xg);var Kg=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Me);const Zg=Ye(Kg);var Qg=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Me);const Jg=Ye(Qg);var e2=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Me);const t2=Ye(e2);var n2=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Me);const r2=Ye(n2);var i2=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Me);const o2=Ye(i2);var a2=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Me);const s2=Ye(a2);var l2=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Me);const u2=Ye(l2);var c2=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Me);const f2=Ye(c2);var h2=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Me);const d2=Ye(h2);var m2=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Me);const p2=Ye(m2);var b2=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Me);const g2=Ye(b2);var y2=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Me);const _2=Ye(y2);var v2=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Me);const w2=Ye(v2);var M2=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Me);const E2=Ye(M2);var S2=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Me);const x2=Ye(S2);function A2(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const C2=ch(Bn(300,.5,0),Bn(-240,.5,1));var P2=ch(Bn(-100,.75,.35),Bn(80,1.5,.8)),N2=ch(Bn(260,.75,.35),Bn(80,1.5,.8)),gs=Bn();function $2(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return gs.h=360*e-100,gs.s=1.5-1.5*t,gs.l=.8-.9*t,gs+""}var ys=Sr(),F9=Math.PI/3,R9=Math.PI*2/3;function T2(e){var t;return e=(.5-e)*Math.PI,ys.r=255*(t=Math.sin(e))*t,ys.g=255*(t=Math.sin(e+F9))*t,ys.b=255*(t=Math.sin(e+R9))*t,ys+""}function k2(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function au(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const I2=au(Me("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var D2=au(Me("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),F2=au(Me("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),R2=au(Me("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function _i(e){return function(){return e}}const B2=Math.cos,Sh=Math.min,bl=Math.sin,lt=Math.sqrt,Xm=1e-12,gl=Math.PI,su=2*gl;function B9(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new _b(t)}function O9(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function O2(e){this._context=e}O2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function lu(e){return new O2(e)}function L9(e){return e[0]}function G9(e){return e[1]}function U9(e,t){var n=_i(!0),r=null,i=lu,o=null,a=B9(s);e=typeof e=="function"?e:e===void 0?L9:_i(e),t=typeof t=="function"?t:t===void 0?G9:_i(t);function s(l){var u,c=(l=O9(l)).length,h,f=!1,d;for(r==null&&(o=i(d=a())),u=0;u<=c;++u)!(u<c&&n(h=l[u],u,l))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(h,u,l),+t(h,u,l));if(d)return o=null,d+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:_i(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:_i(+l),s):t},s.defined=function(l){return arguments.length?(n=typeof l=="function"?l:_i(!!l),s):n},s.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),s):i},s.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),s):r},s}class L2{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function q9(e){return new L2(e,!0)}function H9(e){return new L2(e,!1)}const z9=lt(3),G2={draw(e,t){const n=lt(t+Sh(t/28,.75))*.59436,r=n/2,i=r*z9;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},sa={draw(e,t){const n=lt(t/gl);e.moveTo(n,0),e.arc(0,0,n,0,su)}},U2={draw(e,t){const n=lt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},q2=lt(1/3),V9=q2*2,H2={draw(e,t){const n=lt(t/V9),r=n*q2;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},z2={draw(e,t){const n=lt(t)*.62625;e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},V2={draw(e,t){const n=lt(t-Sh(t/7,2))*.87559;e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},Y2={draw(e,t){const n=lt(t),r=-n/2;e.rect(r,r,n,n)}},W2={draw(e,t){const n=lt(t)*.4431;e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},Y9=.8908130915292852,X2=bl(gl/10)/bl(7*gl/10),W9=bl(su/10)*X2,X9=-B2(su/10)*X2,j2={draw(e,t){const n=lt(t*Y9),r=W9*n,i=X9*n;e.moveTo(0,-n),e.lineTo(r,i);for(let o=1;o<5;++o){const a=su*o/5,s=B2(a),l=bl(a);e.lineTo(l*n,-s*n),e.lineTo(s*r-l*i,l*r+s*i)}e.closePath()}},rc=lt(3),K2={draw(e,t){const n=-lt(t/(rc*3));e.moveTo(0,n*2),e.lineTo(-rc*n,-n),e.lineTo(rc*n,-n),e.closePath()}},j9=lt(3),Z2={draw(e,t){const n=lt(t)*.6824,r=n/2,i=n*j9/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},Kt=-.5,Zt=lt(3)/2,vf=1/lt(12),K9=(vf/2+1)*3,Q2={draw(e,t){const n=lt(t/K9),r=n/2,i=n*vf,o=r,a=n*vf+n,s=-o,l=a;e.moveTo(r,i),e.lineTo(o,a),e.lineTo(s,l),e.lineTo(Kt*r-Zt*i,Zt*r+Kt*i),e.lineTo(Kt*o-Zt*a,Zt*o+Kt*a),e.lineTo(Kt*s-Zt*l,Zt*s+Kt*l),e.lineTo(Kt*r+Zt*i,Kt*i-Zt*r),e.lineTo(Kt*o+Zt*a,Kt*a-Zt*o),e.lineTo(Kt*s+Zt*l,Kt*l-Zt*s),e.closePath()}},J2={draw(e,t){const n=lt(t-Sh(t/6,1.7))*.6189;e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},Z9=[sa,U2,H2,Y2,j2,K2,Q2],Q9=[sa,V2,J2,Z2,G2,W2,z2];function xr(){}function yl(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function uu(e){this._context=e}uu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:yl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:yl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function J9(e){return new uu(e)}function ey(e){this._context=e}ey.prototype={areaStart:xr,areaEnd:xr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:yl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eE(e){return new ey(e)}function ty(e){this._context=e}ty.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:yl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tE(e){return new ty(e)}function ny(e,t){this._basis=new uu(e),this._beta=t}ny.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],o=e[n]-r,a=t[n]-i,s=-1,l;++s<=n;)l=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+l*o),this._beta*t[s]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const nE=function e(t){function n(r){return t===1?new uu(r):new ny(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function _l(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function xh(e,t){this._context=e,this._k=(1-t)/6}xh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_l(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:_l(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const rE=function e(t){function n(r){return new xh(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Ah(e,t){this._context=e,this._k=(1-t)/6}Ah.prototype={areaStart:xr,areaEnd:xr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:_l(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const iE=function e(t){function n(r){return new Ah(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Ch(e,t){this._context=e,this._k=(1-t)/6}Ch.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:_l(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const oE=function e(t){function n(r){return new Ch(r,t)}return n.tension=function(r){return e(+r)},n}(0);function Ph(e,t,n){var r=e._x1,i=e._y1,o=e._x2,a=e._y2;if(e._l01_a>Xm){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>Xm){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*u+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*u+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,o,a,e._x2,e._y2)}function ry(e,t){this._context=e,this._alpha=t}ry.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Ph(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aE=function e(t){function n(r){return t?new ry(r,t):new xh(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function iy(e,t){this._context=e,this._alpha=t}iy.prototype={areaStart:xr,areaEnd:xr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ph(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const sE=function e(t){function n(r){return t?new iy(r,t):new Ah(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function oy(e,t){this._context=e,this._alpha=t}oy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ph(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const lE=function e(t){function n(r){return t?new oy(r,t):new Ch(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function ay(e){this._context=e}ay.prototype={areaStart:xr,areaEnd:xr,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function uE(e){return new ay(e)}function jm(e){return e<0?-1:1}function Km(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(jm(o)+jm(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Zm(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function ic(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-r)/3;e._context.bezierCurveTo(r+s,i+s*t,o-s,a-s*n,o,a)}function vl(e){this._context=e}vl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ic(this,this._t0,Zm(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ic(this,Zm(this,n=Km(this,e,t)),n);break;default:ic(this,this._t0,n=Km(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function sy(e){this._context=new ly(e)}(sy.prototype=Object.create(vl.prototype)).point=function(e,t){vl.prototype.point.call(this,t,e)};function ly(e){this._context=e}ly.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function cE(e){return new vl(e)}function fE(e){return new sy(e)}function uy(e){this._context=e}uy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Qm(e),i=Qm(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Qm(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),a=new Array(n);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function hE(e){return new uy(e)}function cu(e,t){this._context=e,this._t=t}cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function dE(e){return new cu(e,.5)}function mE(e){return new cu(e,0)}function pE(e){return new cu(e,1)}function Io(e,t,n){this.k=e,this.x=t,this.y=n}Io.prototype={constructor:Io,scale:function(e){return e===1?this:new Io(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Io(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Io.prototype;function bE(e){return 60*1/e}function cy(e,t){return be(Math.ceil(e/12)*12,t+1,12)}function gE(e,t,n){return e<t?t:e>n?n:e}function fy(e){return new Promise(t=>{setTimeout(t,e*1e3)})}function Jm(e,t){return e.has(t)?e.delete(t):e.add(t),new Set(e)}function ep(e,t){for(const n of t)if(e.has(n))return!0;return!1}var Mo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var hy={exports:{}};(function(e,t){(function(n,r){r()})(Mo,function(){function n(u,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function r(u,c,h){var f=new XMLHttpRequest;f.open("GET",u),f.responseType="blob",f.onload=function(){l(f.response,c,h)},f.onerror=function(){console.error("could not download file")},f.send()}function i(u){var c=new XMLHttpRequest;c.open("HEAD",u,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(c)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Mo=="object"&&Mo.global===Mo?Mo:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,c,h){var f=a.URL||a.webkitURL,d=document.createElement("a");c=c||u.name||"download",d.download=c,d.rel="noopener",typeof u=="string"?(d.href=u,d.origin===location.origin?o(d):i(d.href)?r(u,c,h):o(d,d.target="_blank")):(d.href=f.createObjectURL(u),setTimeout(function(){f.revokeObjectURL(d.href)},4e4),setTimeout(function(){o(d)},0))}:"msSaveOrOpenBlob"in navigator?function(u,c,h){if(c=c||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(n(u,h),c);else if(i(u))r(u,c,h);else{var f=document.createElement("a");f.href=u,f.target="_blank",setTimeout(function(){o(f)})}}:function(u,c,h,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof u=="string")return r(u,c,h);var d=u.type==="application/octet-stream",m=/constructor/i.test(a.HTMLElement)||a.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||d&&m||s)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var y=g.result;y=b?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=y:location=y,f=null},g.readAsDataURL(u)}else{var E=a.URL||a.webkitURL,_=E.createObjectURL(u);f?f.location=_:location.href=_,f=null,setTimeout(function(){E.revokeObjectURL(_)},4e4)}});a.saveAs=l.saveAs=l,e.exports=l})})(hy);var _E=hy.exports;const dy=yE(_E);class bn{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,n,r={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==bn.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof n!="function")throw new TypeError("The callback must be a function.");const i=new tp(t,this,n,r);return this.eventMap[t]||(this.eventMap[t]=[]),r.prepend?this.eventMap[t].unshift(i):this.eventMap[t].push(i),i}addOneTimeListener(t,n,r={}){r.remaining=1,this.addListener(t,n,r)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,n){return t===void 0?this.eventMap[bn.ANY_EVENT]&&this.eventMap[bn.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,r])=>r.length>0):this.eventMap[t]&&this.eventMap[t].length>0?n instanceof tp?this.eventMap[t].filter(i=>i===n).length>0:typeof n=="function"?this.eventMap[t].filter(i=>i.callback===n).length>0:n==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(n=>{n.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(n=>{n.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...n){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let r=[],i=this.eventMap[bn.ANY_EVENT]||[];return this.eventMap[t]&&(i=i.concat(this.eventMap[t])),i.forEach(o=>{if(o.suspended)return;let a=[...n];Array.isArray(o.arguments)&&(a=a.concat(o.arguments)),o.remaining>0&&(r.push(o.callback.apply(o.context,a)),o.count++),--o.remaining<1&&o.remove()}),r}removeListener(t,n,r={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let i=this.eventMap[t].filter(o=>n&&o.callback!==n||r.remaining&&r.remaining!==o.remaining||r.context&&r.context!==o.context);i.length?this.eventMap[t]=i:delete this.eventMap[t]}async waitFor(t,n={}){return n.duration=parseInt(n.duration),(isNaN(n.duration)||n.duration<=0)&&(n.duration=1/0),new Promise((r,i)=>{let o,a=this.addListener(t,()=>{clearTimeout(o),r()},{remaining:1});n.duration!==1/0&&(o=setTimeout(()=>{a.remove(),i("The duration expired before the event was emitted.")},n.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class tp{constructor(t,n,r,i={}){if(typeof t!="string"&&!(t instanceof String)&&t!==bn.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!n)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof r!="function")throw new TypeError("The 'callback' must be a function.");i.arguments!==void 0&&!Array.isArray(i.arguments)&&(i.arguments=[i.arguments]),i=Object.assign({context:n,remaining:1/0,arguments:void 0,duration:1/0},i),i.duration!==1/0&&setTimeout(()=>this.remove(),i.duration),this.arguments=i.arguments,this.callback=r,this.context=i.context,this.count=0,this.event=t,this.remaining=parseInt(i.remaining)>=1?parseInt(i.remaining):1/0,this.suspended=!1,this.target=n}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class K{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),K.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),K.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),K.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),K.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class xi{constructor(t,n={}){this.duration=O.defaults.note.duration,this.attack=O.defaults.note.attack,this.release=O.defaults.note.release,n.duration!=null&&(this.duration=n.duration),n.attack!=null&&(this.attack=n.attack),n.rawAttack!=null&&(this.attack=oe.from7bitToFloat(n.rawAttack)),n.release!=null&&(this.release=n.release),n.rawRelease!=null&&(this.release=oe.from7bitToFloat(n.rawRelease)),Number.isInteger(t)?this.identifier=oe.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const n=oe.getNoteDetails(t);if(O.validation&&!t)throw new Error("Invalid note identifier");this._name=n.name,this._accidental=n.accidental,this._octave=n.octave}get name(){return this._name}set name(t){if(O.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(O.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(O.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(O.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(O.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(O.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return oe.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=oe.from7bitToFloat(t)}get rawRelease(){return oe.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=oe.from7bitToFloat(t)}get number(){return oe.toNoteNumber(this.identifier)}getOffsetNumber(t=0,n=0){return O.validation&&(t=parseInt(t)||0,n=parseInt(n)||0),Math.min(Math.max(this.number+t*12+n,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class oe{static toNoteNumber(t,n=0){if(n=n==null?0:parseInt(n),isNaN(n))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const r=this.getNoteDetails(t);if(!r)throw new TypeError("Invalid note identifier");const i={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let o=(r.octave+1+n)*12;if(o+=i[r.name],r.accidental&&(r.accidental.startsWith("b")?o-=r.accidental.length:o+=r.accidental.length),o<0||o>127)throw new RangeError("Invalid octaveOffset value");return o}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const n=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!n)throw new TypeError("Invalid note identifier");const r=n[1].toUpperCase(),i=parseInt(n[3]);let o=n[2].toLowerCase();return o=o===""?void 0:o,{accidental:o,identifier:r+(o||"")+i,name:r,octave:i}}static sanitizeChannels(t){let n;if(O.validation){if(t==="all")n=["all"];else if(t==="none")return[]}return Array.isArray(t)?n=t:n=[t],n.indexOf("all")>-1&&(n=K.MIDI_CHANNEL_NUMBERS),n.map(function(r){return parseInt(r)}).filter(function(r){return r>=1&&r<=16})}static toTimestamp(t){let n=!1;const r=parseFloat(t);return isNaN(r)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?r>=0&&(n=O.time+r):r>=0&&(n=r),n)}static guessNoteNumber(t,n){n=parseInt(n)||0;let r=!1;if(Number.isInteger(t)&&t>=0&&t<=127)r=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)r=parseInt(t);else if(typeof t=="string"||t instanceof String)try{r=this.toNoteNumber(t.trim(),n)}catch{return!1}return r}static toNoteIdentifier(t,n){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(n=n==null?0:parseInt(n),isNaN(n))throw new RangeError("Invalid octaveOffset value");const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],i=Math.floor(t/12-1)+n;return r[t%12]+i.toString()}static buildNote(t,n={}){if(n.octaveOffset=parseInt(n.octaveOffset)||0,t instanceof xi)return t;let r=this.guessNoteNumber(t,n.octaveOffset);if(r===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return n.octaveOffset=void 0,new xi(r,n)}static buildNoteArray(t,n={}){let r=[];return Array.isArray(t)||(t=[t]),t.forEach(i=>{r.push(this.buildNote(i,n))}),r}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,n=0){O.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),n=Math.min(Math.max(parseInt(n)||0,0),127));const r=((t<<7)+n)/16383;return Math.min(Math.max(r,0),1)}static fromFloatToMsbLsb(t){O.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const n=Math.round(t*16383);return{msb:n>>7,lsb:n&127}}static offsetNumber(t,n=0,r=0){if(O.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");n=parseInt(n)||0,r=parseInt(r)||0}return Math.min(Math.max(t+n*12+r,0),127)}static getPropertyByValue(t,n){return Object.keys(t).find(r=>t[r]===n)}static getCcNameByNumber(t){if(!(O.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return K.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let n=K.CONTROL_CHANGE_MESSAGES.find(r=>r.name===t);return n?n.number:K.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let n in K.CHANNEL_MODE_MESSAGES)if(K.CHANNEL_MODE_MESSAGES.hasOwnProperty(n)&&t===K.CHANNEL_MODE_MESSAGES[n])return n;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class vE extends bn{constructor(t,n){super(),this._output=t,this._number=n,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,n={time:0}){return this.output.send(t,n),this}sendKeyAftertouch(t,n,r={}){if(O.validation){if(r.useRawValue&&(r.rawValue=r.useRawValue),isNaN(parseFloat(n)))throw new RangeError("Invalid key aftertouch value.");if(r.rawValue){if(!(n>=0&&n<=127&&Number.isInteger(n)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(n>=0&&n<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}r.rawValue||(n=oe.fromFloatTo7Bit(n));const i=O.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),oe.buildNoteArray(t).forEach(o=>{this.send([(K.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),o.getOffsetNumber(i),n],{time:oe.toTimestamp(r.time)})}),this}sendControlChange(t,n,r={}){if(typeof t=="string"&&(t=oe.getCcNumberByName(t)),Array.isArray(n)||(n=[n]),O.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(n=n.map(i=>{const o=Math.min(Math.max(parseInt(i),0),127);if(isNaN(o))throw new TypeError("Values must be integers between 0 and 127");return o}),n.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return n.forEach((i,o)=>{this.send([(K.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+o*32,n[o]],{time:oe.toTimestamp(r.time)})}),this}_selectNonRegisteredParameter(t,n={}){return this.sendControlChange(99,t[0],n),this.sendControlChange(98,t[1],n),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,n={}){return this.sendControlChange(101,t[0],n),this.sendControlChange(100,t[1],n),this}_setCurrentParameter(t,n={}){return t=[].concat(t),this.sendControlChange(6,t[0],n),t.length<2?this:(this.sendControlChange(38,t[1],n),this)}sendRpnDecrement(t,n={}){if(Array.isArray(t)||(t=K.REGISTERED_PARAMETERS[t]),O.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(K.REGISTERED_PARAMETERS).forEach(i=>{K.REGISTERED_PARAMETERS[i][0]===t[0]&&K.REGISTERED_PARAMETERS[i][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,n),this.sendControlChange(97,0,n),this._deselectRegisteredParameter(n),this}sendRpnIncrement(t,n={}){if(Array.isArray(t)||(t=K.REGISTERED_PARAMETERS[t]),O.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(K.REGISTERED_PARAMETERS).forEach(i=>{K.REGISTERED_PARAMETERS[i][0]===t[0]&&K.REGISTERED_PARAMETERS[i][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,n),this.sendControlChange(96,0,n),this._deselectRegisteredParameter(n),this}playNote(t,n={}){this.sendNoteOn(t,n);const r=Array.isArray(t)?t:[t];for(let i of r)if(parseInt(i.duration)>0){const o={time:(oe.toTimestamp(n.time)||O.time)+parseInt(i.duration),release:i.release,rawRelease:i.rawRelease};this.sendNoteOff(i,o)}else if(parseInt(n.duration)>0){const o={time:(oe.toTimestamp(n.time)||O.time)+parseInt(n.duration),release:n.release,rawRelease:n.rawRelease};this.sendNoteOff(i,o)}return this}sendNoteOff(t,n={}){if(O.validation){if(n.rawRelease!=null&&!(n.rawRelease>=0&&n.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(n.release!=null&&!(n.release>=0&&n.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");n.rawVelocity&&(n.rawRelease=n.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),n.velocity&&(n.release=n.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;n.rawRelease!=null?r=n.rawRelease:isNaN(n.release)||(r=Math.round(n.release*127));const i=O.octaveOffset+this.output.octaveOffset+this.octaveOffset;return oe.buildNoteArray(t,{rawRelease:parseInt(r)}).forEach(o=>{this.send([(K.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),o.getOffsetNumber(i),o.rawRelease],{time:oe.toTimestamp(n.time)})}),this}stopNote(t,n={}){return this.sendNoteOff(t,n)}sendNoteOn(t,n={}){if(O.validation){if(n.rawAttack!=null&&!(n.rawAttack>=0&&n.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(n.attack!=null&&!(n.attack>=0&&n.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");n.rawVelocity&&(n.rawAttack=n.velocity,n.rawRelease=n.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),n.velocity&&(n.attack=n.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;n.rawAttack!=null?r=n.rawAttack:isNaN(n.attack)||(r=Math.round(n.attack*127));const i=O.octaveOffset+this.output.octaveOffset+this.octaveOffset;return oe.buildNoteArray(t,{rawAttack:r}).forEach(o=>{this.send([(K.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),o.getOffsetNumber(i),o.rawAttack],{time:oe.toTimestamp(n.time)})}),this}sendChannelMode(t,n=0,r={}){if(typeof t=="string"&&(t=K.CHANNEL_MODE_MESSAGES[t]),O.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(n))||n<0||n>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(K.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,n],{time:oe.toTimestamp(r.time)}),this}sendOmniMode(t,n={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,n):this.sendChannelMode("omnimodeoff",0,n),this}sendChannelAftertouch(t,n={}){if(O.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(n.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return n.rawValue||(t=oe.fromFloatTo7Bit(t)),this.send([(K.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:oe.toTimestamp(n.time)}),this}sendMasterTuning(t,n={}){if(t=parseFloat(t)||0,O.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let r=Math.floor(t)+64,i=t-Math.floor(t);i=Math.round((i+1)/2*16383);let o=i>>7&127,a=i&127;return this.sendRpnValue("channelcoarsetuning",r,n),this.sendRpnValue("channelfinetuning",[o,a],n),this}sendModulationRange(t,n,r={}){if(O.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(n!=null&&(!Number.isInteger(n)||!(n>=0&&n<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return n>=0&&n<=127||(n=0),this.sendRpnValue("modulationrange",[t,n],r),this}sendNrpnValue(t,n,r={}){if(n=[].concat(n),O.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");n.forEach(i=>{if(!(i>=0&&i<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,r),this._setCurrentParameter(n,r),this._deselectNonRegisteredParameter(r),this}sendPitchBend(t,n={}){if(O.validation)if(n.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(n.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let r=0,i=0;if(n.rawValue&&Array.isArray(t))r=t[0],i=t[1];else if(n.rawValue&&!Array.isArray(t))r=t;else{const o=oe.fromFloatToMsbLsb((t+1)/2);r=o.msb,i=o.lsb}return this.send([(K.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),i,r],{time:oe.toTimestamp(n.time)}),this}sendPitchBendRange(t,n,r={}){if(O.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(n)||!(n>=0&&n<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,n],r),this}sendProgramChange(t,n={}){if(t=parseInt(t)||0,O.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(K.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:oe.toTimestamp(n.time)}),this}sendRpnValue(t,n,r={}){if(Array.isArray(t)||(t=K.REGISTERED_PARAMETERS[t]),O.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(n).forEach(i=>{if(!(i>=0&&i<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,r),this._setCurrentParameter(n,r),this._deselectRegisteredParameter(r),this}sendTuningBank(t,n={}){if(O.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,n),this}sendTuningProgram(t,n={}){if(O.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,n),this}sendLocalControl(t,n={}){return t?this.sendChannelMode("localcontrol",127,n):this.sendChannelMode("localcontrol",0,n)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,n={}){return t==="mono"?this.sendChannelMode("monomodeon",0,n):this.sendChannelMode("polymodeon",0,n)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class wf extends bn{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let n=1;n<=16;n++)this.channels[n]=new vE(this,n);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let n={timestamp:O.time};t.port.connection==="open"?(n.type="opened",n.target=this,n.port=n.target,this.emit("opened",n)):t.port.connection==="closed"&&t.port.state==="connected"?(n.type="closed",n.target=this,n.port=n.target,this.emit("closed",n)):t.port.connection==="closed"&&t.port.state==="disconnected"?(n.type="disconnected",n.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",n)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,n={time:0},r=0){if(t instanceof my&&(t=oe.isNode?t.data:t.rawData),t instanceof Uint8Array&&oe.isNode&&(t=Array.from(t)),O.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(n)&&(t=t.concat(n)),n=isNaN(r)?{time:0}:{time:r}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(i=>{if(i=parseInt(i),!(i>=0&&i<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),n||(n={time:0})}return this._midiOutput.send(t,oe.toTimestamp(n.time)),this}sendSysex(t,n=[],r={}){if(t=[].concat(t),n instanceof Uint8Array){const i=new Uint8Array(1+t.length+n.length+1);i[0]=K.SYSTEM_MESSAGES.sysex,i.set(Uint8Array.from(t),1),i.set(n,1+t.length),i[i.length-1]=K.SYSTEM_MESSAGES.sysexend,this.send(i,{time:r.time})}else{const i=t.concat(n,K.SYSTEM_MESSAGES.sysexend);this.send([K.SYSTEM_MESSAGES.sysex].concat(i),{time:r.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():O.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,n={}){if(O.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([K.SYSTEM_MESSAGES.timecode,t],{time:n.time}),this}sendSongPosition(t=0,n={}){t=Math.floor(t)||0;var r=t>>7&127,i=t&127;return this.send([K.SYSTEM_MESSAGES.songposition,r,i],{time:n.time}),this}sendSongSelect(t=0,n={}){if(O.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([K.SYSTEM_MESSAGES.songselect,t],{time:n.time}),this}sendTuneRequest(t={}){return this.send([K.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([K.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([K.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([K.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([K.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([K.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([K.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return O.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,n,r={}){return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendKeyAftertouch(t,n,r)}),this}sendControlChange(t,n,r={},i={}){if(O.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendControlChange(t,n,r)}),this}sendPitchBendRange(t=0,n=0,r={}){return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendPitchBendRange(t,n,r)}),this}setPitchBendRange(t=0,n=0,r="all",i={}){return O.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),i.channels=r,i.channels==="all"&&(i.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,n,i)}sendRpnValue(t,n,r={}){return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnValue(t,n,r)}),this}setRegisteredParameter(t,n=[],r="all",i={}){return O.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),i.channels=r,i.channels==="all"&&(i.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,n,i)}sendChannelAftertouch(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendChannelAftertouch(t,n)}),this}sendPitchBend(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendPitchBend(t,n)}),this}sendProgramChange(t=0,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendProgramChange(t,n)}),this}sendModulationRange(t,n,r={}){return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendModulationRange(t,n,r)}),this}setModulationRange(t=0,n=0,r="all",i={}){return O.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),i.channels=r,i.channels==="all"&&(i.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,n,i)}sendMasterTuning(t,n={}){return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendMasterTuning(t,n)}),this}setMasterTuning(t,n={},r={}){return O.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),r.channels=n,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,r)}sendTuningProgram(t,n={}){return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendTuningProgram(t,n)}),this}setTuningProgram(t,n="all",r={}){return O.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),r.channels=n,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,r)}sendTuningBank(t=0,n={}){return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendTuningBank(t,n)}),this}setTuningBank(t,n="all",r={}){return O.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),r.channels=n,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,r)}sendChannelMode(t,n=0,r={},i={}){if(O.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const o=r;r=i,r.channels=o,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendChannelMode(t,n,r)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},n={}){if(O.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=K.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendPolyphonicMode(t,n)}),this}sendLocalControl(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendLocalControl(t,n)}),this}sendOmniMode(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendOmniMode(t,n)}),this}sendNrpnValue(t,n,r={}){return r.channels==null&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendNrpnValue(t,n,r)}),this}setNonRegisteredParameter(t,n=[],r="all",i={}){return O.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),i.channels=r,i.channels==="all"&&(i.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,n,i)}sendRpnIncrement(t,n={}){return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnIncrement(t,n)}),this}incrementRegisteredParameter(t,n="all",r={}){return O.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),r.channels=n,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,r)}sendRpnDecrement(t,n={}){return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnDecrement(t,n)}),this}decrementRegisteredParameter(t,n="all",r={}){return O.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),r.channels=n,r.channels==="all"&&(r.channels=K.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,r)}sendNoteOff(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendNoteOff(t,n)}),this}stopNote(t,n){return this.sendNoteOff(t,n)}playNote(t,n={},r={}){if(O.validation&&(n.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),n.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].playNote(t,n)}),this}sendNoteOn(t,n={},r={}){if(O.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=K.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendNoteOn(t,n)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class np{constructor(t=[],n={}){this.destinations=[],this.types=[...Object.keys(K.SYSTEM_MESSAGES),...Object.keys(K.CHANNEL_MESSAGES)],this.channels=K.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),n.types&&!Array.isArray(n.types)&&(n.types=[n.types]),n.channels&&!Array.isArray(n.channels)&&(n.channels=[n.channels]),O.validation&&(t.forEach(r=>{if(!(r instanceof wf))throw new TypeError("Destinations must be of type 'Output'.")}),n.types!==void 0&&n.types.forEach(r=>{if(!K.SYSTEM_MESSAGES.hasOwnProperty(r)&&!K.CHANNEL_MESSAGES.hasOwnProperty(r))throw new TypeError("Type must be a valid message type.")}),n.channels!==void 0&&n.channels.forEach(r=>{if(!K.MIDI_CHANNEL_NUMBERS.includes(r))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,n.types&&(this.types=n.types),n.channels&&(this.channels=n.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(n=>{O.validation&&!(n instanceof wf)||n.send(t)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class wE extends bn{constructor(t,n){super(),this._input=t,this._number=n,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const n=Object.assign({},t);n.port=this.input,n.target=this,n.type="midimessage",this.emit(n.type,n),this._parseEventForStandardMessages(n)}_parseEventForStandardMessages(t){const n=Object.assign({},t);n.type=n.message.type||"unknownmessage";const r=t.message.dataBytes[0],i=t.message.dataBytes[1];if(n.type==="noteoff"||n.type==="noteon"&&i===0)this.notesState[r]=!1,n.type="noteoff",n.note=new xi(oe.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+O.octaveOffset),{rawAttack:0,rawRelease:i}),n.value=oe.from7bitToFloat(i),n.rawValue=i,n.velocity=n.note.release,n.rawVelocity=n.note.rawRelease;else if(n.type==="noteon")this.notesState[r]=!0,n.note=new xi(oe.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+O.octaveOffset),{rawAttack:i}),n.value=oe.from7bitToFloat(i),n.rawValue=i,n.velocity=n.note.attack,n.rawVelocity=n.note.rawAttack;else if(n.type==="keyaftertouch")n.note=new xi(oe.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+O.octaveOffset)),n.value=oe.from7bitToFloat(i),n.rawValue=i,n.identifier=n.note.identifier,n.key=n.note.number,n.rawKey=r;else if(n.type==="controlchange"){n.controller={number:r,name:K.CONTROL_CHANGE_MESSAGES[r].name,description:K.CONTROL_CHANGE_MESSAGES[r].description,position:K.CONTROL_CHANGE_MESSAGES[r].position},n.subtype=n.controller.name||"controller"+r,n.value=oe.from7bitToFloat(i),n.rawValue=i;const o=Object.assign({},n);o.type=`${n.type}-controller${r}`,delete o.subtype,this.emit(o.type,o);const a=Object.assign({},n);a.type=`${n.type}-`+K.CONTROL_CHANGE_MESSAGES[r].name,delete a.subtype,a.type.indexOf("controller")!==0&&this.emit(a.type,a),n.message.dataBytes[0]>=120&&this._parseChannelModeMessage(n),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(n.message.dataBytes[0])&&this._parseEventForParameterNumber(n)}else n.type==="programchange"?(n.value=r,n.rawValue=n.value):n.type==="channelaftertouch"?(n.value=oe.from7bitToFloat(r),n.rawValue=r):n.type==="pitchbend"?(n.value=((i<<7)+r-8192)/8192,n.rawValue=(i<<7)+r):n.type="unknownmessage";this.emit(n.type,n)}_parseChannelModeMessage(t){const n=Object.assign({},t);n.type=n.controller.name,n.type==="localcontrol"&&(n.value=n.message.data[2]===127,n.rawValue=n.message.data[2]),n.type==="omnimodeon"?(n.type="omnimode",n.value=!0,n.rawValue=n.message.data[2]):n.type==="omnimodeoff"&&(n.type="omnimode",n.value=!1,n.rawValue=n.message.data[2]),n.type==="monomodeon"?(n.type="monomode",n.value=!0,n.rawValue=n.message.data[2]):n.type==="polymodeon"&&(n.type="monomode",n.value=!1,n.rawValue=n.message.data[2]),this.emit(n.type,n)}_parseEventForParameterNumber(t){const n=t.message.dataBytes[0],r=t.message.dataBytes[1];n===99||n===101?(this._nrpnBuffer=[],this._rpnBuffer=[],n===99?this._nrpnBuffer=[t.message]:r!==127&&(this._rpnBuffer=[t.message])):n===98||n===100?n===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&r!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(n===6||n===38||n===96||n===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,n,r,i){t=t==="nrpn"?"nrpn":"rpn";const o={target:i.target,timestamp:i.timestamp,message:i.message,parameterMsb:n,parameterLsb:r,value:oe.from7bitToFloat(i.message.dataBytes[1]),rawValue:i.message.dataBytes[1]};t==="rpn"?o.parameter=Object.keys(K.REGISTERED_PARAMETERS).find(l=>K.REGISTERED_PARAMETERS[l][0]===n&&K.REGISTERED_PARAMETERS[l][1]===r):o.parameter=(n<<7)+r;const a=K.CONTROL_CHANGE_MESSAGES[i.message.dataBytes[0]].name;o.type=`${t}-${a}`,this.emit(o.type,o);const s=Object.assign({},o);s.type==="nrpn-dataincrement"?s.type="nrpn-databuttonincrement":s.type==="nrpn-datadecrement"?s.type="nrpn-databuttondecrement":s.type==="rpn-dataincrement"?s.type="rpn-databuttonincrement":s.type==="rpn-datadecrement"&&(s.type="rpn-databuttondecrement"),this.emit(s.type,s),o.type=t,o.subtype=a,this.emit(o.type,o)}getChannelModeByNumber(t){return O.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),oe.getChannelModeByNumber(t)}getCcNameByNumber(t){if(O.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return oe.getCcNameByNumber(t)}getNoteState(t){t instanceof xi&&(t=t.identifier);const n=oe.guessNoteNumber(t,O.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[n]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class my{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=oe.getPropertyByValue(K.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=oe.getPropertyByValue(K.SYSTEM_MESSAGES,this.command)),this.statusByte===K.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class ME extends bn{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let n=1;n<=16;n++)this.channels[n]=new wE(this,n);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let n={timestamp:O.time,target:this,port:this};t.port.connection==="open"?(n.type="opened",this.emit("opened",n)):t.port.connection==="closed"&&t.port.state==="connected"?(n.type="closed",this.emit("closed",n)):t.port.connection==="closed"&&t.port.state==="disconnected"?(n.type="disconnected",n.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",n)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const n=new my(t.data),r={port:this,target:this,message:n,timestamp:t.timeStamp,type:"midimessage",data:n.data,rawData:n.data,statusByte:n.data[0],dataBytes:n.dataBytes};this.emit("midimessage",r),n.isSystemMessage?this._parseEvent(r):n.isChannelMessage&&this.channels[n.channel]._processMidiMessageEvent(r),this._forwarders.forEach(i=>i.forward(n))}_parseEvent(t){const n=Object.assign({},t);n.type=n.message.type||"unknownmidimessage",n.type==="songselect"&&(n.song=t.data[1]+1,n.value=t.data[1],n.rawValue=n.value),this.emit(n.type,n)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){O.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,n,r={}){if(O.validation&&typeof r=="function"){let i=n!=null?[].concat(n):void 0;n=r,r={channels:i}}if(K.CHANNEL_EVENTS.includes(t)){r.channels===void 0&&(r.channels=K.MIDI_CHANNEL_NUMBERS);let i=[];return oe.sanitizeChannels(r.channels).forEach(o=>{i.push(this.channels[o].addListener(t,n,r))}),i}else return super.addListener(t,n,r)}addOneTimeListener(t,n,r={}){return r.remaining=1,this.addListener(t,n,r)}on(t,n,r,i){return this.addListener(t,n,r,i)}hasListener(t,n,r={}){if(O.validation&&typeof r=="function"){let i=[].concat(n);n=r,r={channels:i}}return K.CHANNEL_EVENTS.includes(t)?(r.channels===void 0&&(r.channels=K.MIDI_CHANNEL_NUMBERS),oe.sanitizeChannels(r.channels).every(i=>this.channels[i].hasListener(t,n))):super.hasListener(t,n)}removeListener(t,n,r={}){if(O.validation&&typeof r=="function"){let i=[].concat(n);n=r,r={channels:i}}if(r.channels===void 0&&(r.channels=K.MIDI_CHANNEL_NUMBERS),t==null)return oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i]&&this.channels[i].removeListener()}),super.removeListener();K.CHANNEL_EVENTS.includes(t)?oe.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].removeListener(t,n,r)}):super.removeListener(t,n,r)}addForwarder(t,n={}){let r;return t instanceof np?r=t:r=new np(t,n),this._forwarders.push(r),r}removeForwarder(t){this._forwarders=this._forwarders.filter(n=>n!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return O.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class EE extends bn{constructor(){super(),this.defaults={note:{attack:oe.from7bitToFloat(64),release:oe.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},n=!1){if(oe.isNode){try{window.navigator}catch{let s=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,s)}try{}catch{global.performance=await Object.getPrototypeOf(async function(){}).constructor(`
        let perf_hooks = await import("perf_hooks");
        return perf_hooks.performance;
        `)()}}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:n}),n&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const r={timestamp:this.time,target:this,type:"error",error:void 0},i={timestamp:this.time,target:this,type:"midiaccessgranted"},o={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(a){return r.error=a,this.emit("error",r),typeof t.callback=="function"&&t.callback(a),Promise.reject(a)}this.emit("midiaccessgranted",i),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(a){return r.error=a,this.emit("error",r),typeof t.callback=="function"&&t.callback(a),Promise.reject(a)}return this.emit("enabled",o),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(n.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(this._disconnectedInputs[r].id===t.toString())return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(this.inputs[r].id===t.toString())return this.inputs[r]}getInputByName(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(n.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(~this._disconnectedInputs[r].name.indexOf(t))return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(~this.inputs[r].name.indexOf(t))return this.inputs[r]}getOutputByName(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(n.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(~this._disconnectedOutputs[r].name.indexOf(t))return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(~this.outputs[r].name.indexOf(t))return this.outputs[r]}getOutputById(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(n.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(this._disconnectedOutputs[r].id===t.toString())return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(this.outputs[r].id===t.toString())return this.outputs[r]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),oe.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?oe.getNoteDetails(oe.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),oe.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),oe.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),oe.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,n={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),oe.buildNoteArray(t,n)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),oe.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(n=>t.push(n.destroy())),this.outputs.forEach(n=>t.push(n.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let n={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?n.port=this.getOutputById(t.port.id):t.port.type==="input"&&(n.port=this.getInputById(t.port.id)),this.emit(t.port.state,n);const r=Object.assign({},n);r.type="portschanged",this.emit(r.type,r)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?n.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(n.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,n);const r=Object.assign({},n);r.type="portschanged",this.emit(r.type,r)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let n=this._inputs.length-1;n>=0;n--){const r=this._inputs[n];Array.from(this.interface.inputs.values()).find(o=>o===r._midiInput)||(this._disconnectedInputs.push(r),this._inputs.splice(n,1))}let t=[];return this.interface.inputs.forEach(n=>{if(!this._inputs.find(r=>r._midiInput===n)){let r=this._disconnectedInputs.find(i=>i._midiInput===n);r||(r=new ME(n)),this._inputs.push(r),t.push(r.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let n=this._outputs.length-1;n>=0;n--){const r=this._outputs[n];Array.from(this.interface.outputs.values()).find(o=>o===r._midiOutput)||(this._disconnectedOutputs.push(r),this._outputs.splice(n,1))}let t=[];return this.interface.outputs.forEach(n=>{if(!this._outputs.find(r=>r._midiOutput===n)){let r=this._disconnectedOutputs.find(i=>i._midiOutput===n);r||(r=new wf(n)),this._outputs.push(r),t.push(r.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),oe.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),oe.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.9"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),K.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),K.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),K.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),K.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),K.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const O=new EE;O.constructor=null;function py(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function by(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var gy=[0,2,4,-1,1,3,5],yy=gy.map(e=>Math.floor(e*7/12));function _y(e){const{step:t,alt:n,oct:r,dir:i=1}=e,o=gy[t]+7*n;if(r===void 0)return[i*o];const a=r-yy[t]-4*n;return[i*o,i*a]}var SE=[3,0,4,1,5,2,6];function xE(e){const[t,n,r]=e,i=SE[AE(t)],o=Math.floor((t+1)/7);if(n===void 0)return{step:i,alt:o,dir:r};const a=n+4*o+yy[i];return{step:i,alt:o,oct:a,dir:r}}function AE(e){const t=(e+1)%7;return t<0?7+t:t}var rp=(e,t)=>Array(Math.abs(t)+1).join(e),Mf=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),CE="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",PE="(AA|A|P|M|m|d|dd)([-+]?\\d+)",NE=new RegExp("^"+CE+"|"+PE+"$");function $E(e){const t=NE.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var ip={};function wl(e){return typeof e=="string"?ip[e]||(ip[e]=TE(e)):by(e)?wl(IE(e)):py(e)?wl(e.name):Mf}var op=[0,2,4,5,7,9,11],vy="PMMPPMM";function TE(e){const t=$E(e);if(t[0]==="")return Mf;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,o=vy[i];if(o==="M"&&r==="P")return Mf;const a=o==="M"?"majorable":"perfectable",s=""+n+r,l=n<0?-1:1,u=n===8||n===-8?n:l*(i+1),c=kE(a,r),h=Math.floor((Math.abs(n)-1)/7),f=l*(op[i]+c+12*h),d=(l*(op[i]+c)%12+12)%12,m=_y({step:i,alt:c,oct:h,dir:l});return{empty:!1,name:s,num:n,q:r,step:i,alt:c,dir:l,type:a,simple:u,semitones:f,chroma:d,coord:m,oct:h}}function kE(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function IE(e){const{step:t,alt:n,oct:r=0,dir:i}=e;if(!i)return"";const o=t+1+7*r,a=o===0?t+1:o,s=i<0?"-":"",l=vy[t]==="M"?"majorable":"perfectable";return s+a+DE(l,n)}function DE(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?rp("A",t):rp("d",e==="perfectable"?t:t+1)}var ap=(e,t)=>Array(Math.abs(t)+1).join(e),wy=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),sp=new Map,FE=e=>"CDEFGAB".charAt(e),RE=e=>e<0?ap("b",-e):ap("#",e),BE=e=>e[0]==="b"?-e.length:e.length;function nt(e){const t=JSON.stringify(e),n=sp.get(t);if(n)return n;const r=typeof e=="string"?qE(e):by(e)?nt(HE(e)):py(e)?nt(e.name):wy;return sp.set(t,r),r}var OE=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function LE(e){const t=OE.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function GE(e){return nt(xE(e))}var UE=(e,t)=>(e%t+t)%t,oc=[0,2,4,5,7,9,11];function qE(e){const t=LE(e);if(t[0]===""||t[3]!=="")return wy;const n=t[0],r=t[1],i=t[2],o=(n.charCodeAt(0)+3)%7,a=BE(r),s=i.length?+i:void 0,l=_y({step:o,alt:a,oct:s}),u=n+r+i,c=n+r,h=(oc[o]+a+120)%12,f=s===void 0?UE(oc[o]+a,12)-12*99:oc[o]+a+12*(s+1),d=f>=0&&f<=127?f:null,m=s===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:h,coord:l,freq:m,height:f,letter:n,midi:d,name:u,oct:s,pc:c,step:o}}function HE(e){const{step:t,alt:n,oct:r}=e,i=FE(t);if(!i)return"";const o=i+RE(n);return r||r===0?o+r:o}function Yi(e,t){const n=nt(e),r=Array.isArray(t)?t:wl(t).coord;if(n.empty||!r||r.length<2)return"";const i=n.coord,o=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return GE(o).name}function My(e,t){const n=e.length;return r=>{if(!t)return"";const i=r<0?(n- -r%n)%n:r%n,o=Math.floor(r/n),a=Yi(t,[0,o]);return Yi(a,e[i])}}function zE(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}function VE(e,t){const n=[];for(;t--;n[t]=t+e);return n}function YE(e,t){const n=[];for(;t--;n[t]=e-t);return n}function WE(e,t){return e<t?VE(e,t-e+1):YE(e,e-t+1)}function qa(e,t){const n=t.length,r=(e%n+n)%n;return t.slice(r,n).concat(t.slice(0,r))}function XE(e){return e.filter(t=>t===0||t)}var Ar={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Ey=e=>Number(e).toString(2).padStart(12,"0"),lp=e=>parseInt(e,2),jE=/^[01]{12}$/;function Nh(e){return jE.test(e)}var KE=e=>typeof e=="number"&&e>=0&&e<=4095,ZE=e=>e&&Nh(e.chroma),up={[Ar.chroma]:Ar};function sr(e){const t=Nh(e)?e:KE(e)?Ey(e):Array.isArray(e)?rS(e):ZE(e)?e.chroma:Ar.chroma;return up[t]=up[t]||nS(t)}var QE=e=>sr(e).chroma,JE=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function eS(e){const t=[];for(let n=0;n<12;n++)e.charAt(n)==="1"&&t.push(JE[n]);return t}function Sy(e,t=!0){const r=sr(e).chroma.split("");return XE(r.map((i,o)=>{const a=qa(o,r);return t&&a[0]==="0"?null:a.join("")}))}function $h(e){const t=sr(e).setNum;return n=>{const r=sr(n).setNum;return t&&t!==r&&(r&t)===r}}function Th(e){const t=sr(e).setNum;return n=>{const r=sr(n).setNum;return t&&t!==r&&(r|t)===r}}function tS(e){const t=e.split("");return t.map((n,r)=>qa(r,t).join(""))}function nS(e){const t=lp(e),n=tS(e).map(lp).filter(o=>o>=2048).sort()[0],r=Ey(n),i=eS(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:r,intervals:i}}function rS(e){if(e.length===0)return Ar.chroma;let t;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<e.length;r++)t=nt(e[r]),t.empty&&(t=wl(e[r])),t.empty||(n[t.chroma]=1);return n.join("")}var iS=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],oS=iS;({...Ar});var kh=[],Is={};function xy(){return kh.slice()}function aS(e,t,n){const r=lS(e),i={...sr(e),name:n||"",quality:r,intervals:e,aliases:t};kh.push(i),i.name&&(Is[i.name]=i),Is[i.setNum]=i,Is[i.chroma]=i,i.aliases.forEach(o=>sS(i,o))}function sS(e,t){Is[t]=e}function lS(e){const t=n=>e.indexOf(n)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}oS.forEach(([e,t,n])=>aS(e.split(" "),n.split(" "),t));kh.sort((e,t)=>e.setNum-t.setNum);var uS=e=>{const t=e.reduce((n,r)=>{const i=nt(r).chroma;return i!==void 0&&(n[i]=n[i]||nt(r).name),n},{});return n=>t[n]};function cS(e,t={}){const n=e.map(i=>nt(i).pc).filter(i=>i);return nt.length===0?[]:gS(n,1,t).filter(i=>i.weight).sort((i,o)=>o.weight-i.weight).map(i=>i.name)}var fu={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},hu=e=>t=>!!(t&e),fS=hu(fu.anyThirds),hS=hu(fu.perfectFifth),dS=hu(fu.anySeventh),mS=hu(fu.nonPerfectFifths);function pS(e){const t=parseInt(e.chroma,2);return fS(t)&&hS(t)&&dS(t)}function bS(e){const t=parseInt(e,2);return mS(t)?e:(t|16).toString(2)}function gS(e,t,n){const r=e[0],i=nt(r).chroma,o=uS(e),a=Sy(e,!1),s=[];return a.forEach((l,u)=>{const c=n.assumePerfectFifth&&bS(l);xy().filter(f=>n.assumePerfectFifth&&pS(f)?f.chroma===c:f.chroma===l).forEach(f=>{const d=f.aliases[0],m=o(u);u!==i?s.push({weight:.5*t,name:`${m}${d}/${r}`}):s.push({weight:1*t,name:`${m}${d}`})})}),s}function Ay(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function Cy(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var Py=[0,2,4,-1,1,3,5],Ny=Py.map(e=>Math.floor(e*7/12));function $y(e){const{step:t,alt:n,oct:r,dir:i=1}=e,o=Py[t]+7*n;if(r===void 0)return[i*o];const a=r-Ny[t]-4*n;return[i*o,i*a]}var yS=[3,0,4,1,5,2,6];function Ty(e){const[t,n,r]=e,i=yS[_S(t)],o=Math.floor((t+1)/7);if(n===void 0)return{step:i,alt:o,dir:r};const a=n+4*o+Ny[i];return{step:i,alt:o,oct:a,dir:r}}function _S(e){const t=(e+1)%7;return t<0?7+t:t}var cp=(e,t)=>Array(Math.abs(t)+1).join(e),Ef={empty:!0,name:"",acc:""},vS="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",wS="(AA|A|P|M|m|d|dd)([-+]?\\d+)",MS=new RegExp("^"+vS+"|"+wS+"$");function ES(e){const t=MS.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var fp={};function Ml(e){return typeof e=="string"?fp[e]||(fp[e]=SS(e)):Cy(e)?Ml(CS(e)):Ay(e)?Ml(e.name):Ef}var hp=[0,2,4,5,7,9,11],ky="PMMPPMM";function SS(e){const t=ES(e);if(t[0]==="")return Ef;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,o=ky[i];if(o==="M"&&r==="P")return Ef;const a=o==="M"?"majorable":"perfectable",s=""+n+r,l=n<0?-1:1,u=n===8||n===-8?n:l*(i+1),c=AS(a,r),h=Math.floor((Math.abs(n)-1)/7),f=l*(hp[i]+c+12*h),d=(l*(hp[i]+c)%12+12)%12,m=$y({step:i,alt:c,oct:h,dir:l});return{empty:!1,name:s,num:n,q:r,step:i,alt:c,dir:l,type:a,simple:u,semitones:f,chroma:d,coord:m,oct:h}}function xS(e,t){const[n,r=0]=e,i=n*7+r*12<0,o=t||i?[-n,-r,-1]:[n,r,1];return Ml(Ty(o))}function AS(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function CS(e){const{step:t,alt:n,oct:r=0,dir:i}=e;if(!i)return"";const o=t+1+7*r,a=o===0?t+1:o,s=i<0?"-":"",l=ky[t]==="M"?"majorable":"perfectable";return s+a+PS(l,n)}function PS(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?cp("A",t):cp("d",e==="perfectable"?t:t+1)}var dp=(e,t)=>Array(Math.abs(t)+1).join(e),Iy={empty:!0,name:"",pc:"",acc:""},mp=new Map,NS=e=>"CDEFGAB".charAt(e),$S=e=>e<0?dp("b",-e):dp("#",e),TS=e=>e[0]==="b"?-e.length:e.length;function Cr(e){const t=JSON.stringify(e),n=mp.get(t);if(n)return n;const r=typeof e=="string"?FS(e):Cy(e)?Cr(RS(e)):Ay(e)?Cr(e.name):Iy;return mp.set(t,r),r}var kS=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Dy(e){const t=kS.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function IS(e){return Cr(Ty(e))}var DS=(e,t)=>(e%t+t)%t,ac=[0,2,4,5,7,9,11];function FS(e){const t=Dy(e);if(t[0]===""||t[3]!=="")return Iy;const n=t[0],r=t[1],i=t[2],o=(n.charCodeAt(0)+3)%7,a=TS(r),s=i.length?+i:void 0,l=$y({step:o,alt:a,oct:s}),u=n+r+i,c=n+r,h=(ac[o]+a+120)%12,f=s===void 0?DS(ac[o]+a,12)-12*99:ac[o]+a+12*(s+1),d=f>=0&&f<=127?f:null,m=s===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:h,coord:l,freq:m,height:f,letter:n,midi:d,name:u,oct:s,pc:c,step:o}}function RS(e){const{step:t,alt:n,oct:r}=e,i=NS(t);if(!i)return"";const o=i+$S(n);return r||r===0?o+r:o}function El(e,t){const n=Cr(e),r=Array.isArray(t)?t:Ml(t).coord;if(n.empty||!r||r.length<2)return"";const i=n.coord,o=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return IS(o).name}function Fy(e,t){const n=e.length;return r=>{if(!t)return"";const i=r<0?(n- -r%n)%n:r%n,o=Math.floor(r/n),a=El(t,[0,o]);return El(a,e[i])}}function BS(e,t){const n=Cr(e),r=Cr(t);if(n.empty||r.empty)return"";const i=n.coord,o=r.coord,a=o[0]-i[0],s=i.length===2&&o.length===2?o[1]-i[1]:-Math.floor(a*7/12),l=r.height===n.height&&r.midi!==null&&n.midi!==null&&n.step>r.step;return xS([a,s],l).name}function OS(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}var LS=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],GS=LS,US={...Ar,name:"",quality:"Unknown",intervals:[],aliases:[]},Ih=[],Vo={};function qS(e){return Vo[e]||US}function Ry(){return Ih.slice()}function HS(e,t,n){const r=VS(e),i={...sr(e),name:n||"",quality:r,intervals:e,aliases:t};Ih.push(i),i.name&&(Vo[i.name]=i),Vo[i.setNum]=i,Vo[i.chroma]=i,i.aliases.forEach(o=>zS(i,o))}function zS(e,t){Vo[t]=e}function VS(e){const t=n=>e.indexOf(n)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}GS.forEach(([e,t,n])=>HS(e.split(" "),n.split(" "),t));Ih.sort((e,t)=>e.setNum-t.setNum);var YS=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],WS=YS,XS={...Ar,intervals:[],aliases:[]},Dh=[],Yo={};function jS(){return Dh.map(e=>e.name)}function By(e){return Yo[e]||XS}function du(){return Dh.slice()}function KS(e,t,n=[]){const r={...sr(e),name:t,intervals:e,aliases:n};return Dh.push(r),Yo[r.name]=r,Yo[r.setNum]=r,Yo[r.chroma]=r,r.aliases.forEach(i=>ZS(r,i)),r}function ZS(e,t){Yo[t]=e}WS.forEach(([e,t,...n])=>KS(e.split(" "),t,n));var Sf={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Fh(e){const[t,n,r,i]=Dy(e);return t===""?["",e]:t==="A"&&i==="ug"?["","aug"]:[t+n,r+i]}function fi(e){if(e==="")return Sf;if(Array.isArray(e)&&e.length===2)return Ds(e[1],e[0]);{const[t,n]=Fh(e),r=Ds(n,t);return r.empty?Ds(e):r}}function Ds(e,t,n){const r=qS(e),i=Cr(t||""),o=Cr(n||"");if(r.empty||t&&i.empty||n&&o.empty)return Sf;const a=BS(i.pc,o.pc),s=r.intervals.indexOf(a)+1;if(!o.empty&&!s)return Sf;const l=Array.from(r.intervals);for(let f=1;f<s;f++){const d=l[0][0],m=l[0][1],b=parseInt(d,10)+7;l.push(`${b}${m}`),l.shift()}const u=i.empty?[]:l.map(f=>El(i,f));e=r.aliases.indexOf(e)!==-1?e:r.aliases[0];const c=`${i.empty?"":i.pc}${e}${o.empty||s<=1?"":"/"+o.pc}`,h=`${t?i.pc+" ":""}${r.name}${s>1&&n?" over "+o.pc:""}`;return{...r,name:h,symbol:c,type:r.name,root:o.name,intervals:l,rootDegree:s,tonic:i.name,notes:u}}var QS=OS("Chord.chord","Chord.get",fi);function JS(e,t){const[n,r]=Fh(e);return n?El(n,t)+r:e}function ex(e){const t=fi(e),n=Th(t.chroma);return du().filter(r=>n(r.chroma)).map(r=>r.name)}function tx(e){const t=fi(e),n=Th(t.chroma);return Ry().filter(r=>n(r.chroma)).map(r=>t.tonic+r.aliases[0])}function nx(e){const t=fi(e),n=$h(t.chroma);return Ry().filter(r=>n(r.chroma)).map(r=>t.tonic+r.aliases[0])}function rx(e){const{intervals:t,tonic:n}=fi(e),r=Fy(t,n);return i=>i?r(i>0?i-1:i):""}function ix(e){const{intervals:t,tonic:n}=fi(e);return Fy(t,n)}var Oy={getChord:Ds,get:fi,detect:cS,chordScales:ex,extended:tx,reduced:nx,tokenize:Fh,transpose:JS,degrees:rx,steps:ix,chord:QS},ox=Math.log(2),ax=Math.log(440);function Ly(e){const t=12*(Math.log(e)-ax)/ox+69;return Math.round(t*100)/100}var sx="C C# D D# E F F# G G# A A# B".split(" "),lx="C Db D Eb E F Gb G Ab A Bb B".split(" ");function oo(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const r=(t.sharps===!0?sx:lx)[e%12];if(t.pitchClass)return r;const i=Math.floor(e/12)-1;return r+i}var ux=["C","D","E","F","G","A","B"],Gy=e=>e.name,Uy=e=>e.map(nt).filter(t=>!t.empty);function cx(e){return e===void 0?ux.slice():Array.isArray(e)?Uy(e).map(Gy):[]}var vn=nt,fx=e=>vn(e).name,hx=e=>vn(e).pc,dx=e=>vn(e).acc,mx=e=>vn(e).oct,px=e=>vn(e).midi,bx=e=>vn(e).freq,gx=e=>vn(e).chroma;function qy(e){return oo(e)}function yx(e){return oo(Ly(e))}function _x(e){return oo(Ly(e),{sharps:!0})}function vx(e){return oo(e,{sharps:!0})}var Ha=Yi,wx=Yi,Hy=e=>t=>Ha(t,e),Mx=Hy,zy=e=>t=>Ha(e,t),Ex=zy;function Vy(e,t){return Ha(e,[t,0])}var Sx=Vy;function xx(e,t){return Ha(e,[0,t])}var Rh=(e,t)=>e.height-t.height,Ax=(e,t)=>t.height-e.height;function Yy(e,t){return t=t||Rh,Uy(e).sort(t).map(Gy)}function Wy(e){return Yy(e,Rh).filter((t,n,r)=>n===0||t!==r[n-1])}var Cx=e=>{const t=vn(e);return t.empty?"":oo(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function Xy(e,t){const n=vn(e);if(n.empty)return"";const r=vn(t||oo(n.midi||n.chroma,{sharps:n.alt<0,pitchClass:!0}));if(r.empty||r.chroma!==n.chroma)return"";if(n.oct===void 0)return r.pc;const i=n.chroma-n.alt,o=r.chroma-r.alt,a=i>11||o<0?-1:i<0||o>11?1:0,s=n.oct+a;return r.pc+s}var wn={names:cx,get:vn,name:fx,pitchClass:hx,accidentals:dx,octave:mx,midi:px,ascending:Rh,descending:Ax,sortedNames:Yy,sortedUniqNames:Wy,fromMidi:qy,fromMidiSharps:vx,freq:bx,fromFreq:yx,fromFreqSharps:_x,chroma:gx,transpose:Ha,tr:wx,transposeBy:Hy,trBy:Mx,transposeFrom:zy,trFrom:Ex,transposeFifths:Vy,transposeOctaves:xx,trFifths:Sx,simplify:Cx,enharmonic:Xy},Bh=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],pp={...Ar,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},Px=Bh.map(Nx),xf={};Px.forEach(e=>{xf[e.name]=e,e.aliases.forEach(t=>{xf[t]=e})});function jy(e){return typeof e=="string"?xf[e.toLowerCase()]||pp:e&&e.name?jy(e.name):pp}function Nx(e){const[t,n,r,i,o,a,s]=e,l=s?[s]:[],u=Number(n).toString(2);return{empty:!1,intervals:By(i).intervals,modeNum:t,chroma:u,normalized:u,name:i,setNum:n,alt:r,triad:o,seventh:a,aliases:l}}function Ky(e){return(t,n)=>{const r=jy(t);if(r.empty)return[];const i=qa(r.modeNum,e),o=r.intervals.map(a=>Yi(n,a));return i.map((a,s)=>o[s]+a)}}Ky(Bh.map(e=>e[4]));Ky(Bh.map(e=>e[5]));var $x={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Zy(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),n=nt(e.substring(0,t));if(n.empty){const i=nt(e);return i.empty?["",e]:[i.name,""]}const r=e.substring(n.name.length+1).toLowerCase();return[n.name,r.length?r:""]}var Tx=jS;function On(e){const t=Array.isArray(e)?e:Zy(e),n=nt(t[0]).name,r=By(t[1]);if(r.empty)return $x;const i=r.name,o=n?r.intervals.map(s=>Yi(n,s)):[],a=n?n+" "+i:i;return{...r,name:a,type:i,tonic:n,notes:o}}var kx=zE("Scale.scale","Scale.get",On);function Ix(e,t={}){const n=QE(e),r=nt(t.tonic??e[0]??""),i=r.chroma;if(i===void 0)return[];const o=n.split("");o[i]="1";const a=qa(i,o).join(""),s=du().find(u=>u.chroma===a),l=[];return s&&l.push(r.name+" "+s.name),t.match==="exact"||Qy(a).forEach(u=>{l.push(r.name+" "+u)}),l}function Dx(e){const t=On(e),n=$h(t.chroma);return xy().filter(r=>n(r.chroma)).map(r=>r.aliases[0])}function Qy(e){const t=Nh(e)?e:On(e).chroma,n=Th(t);return du().filter(r=>n(r.chroma)).map(r=>r.name)}function Fx(e){const t=$h(On(e).chroma);return du().filter(n=>t(n.chroma)).map(n=>n.name)}function Jy(e){const t=e.map(i=>nt(i).pc).filter(i=>i),n=t[0],r=Wy(t);return qa(r.indexOf(n),r)}function Rx(e){const t=On(e);if(t.empty)return[];const n=t.tonic?t.notes:t.intervals;return Sy(t.chroma).map((r,i)=>{const o=On(r).name;return o?[n[i],o]:["",""]}).filter(r=>r[0])}function Bx(e){const t=Array.isArray(e)?Jy(e):On(e).notes,n=t.map(r=>nt(r).chroma);return r=>{const i=nt(typeof r=="number"?qy(r):r),o=i.height;if(o===void 0)return;const a=o%12,s=n.indexOf(a);if(s!==-1)return Xy(i.name,t[s])}}function Ox(e){const t=Bx(e);return(n,r)=>{const i=nt(n).height,o=nt(r).height;return i===void 0||o===void 0?[]:WE(i,o).map(t).filter(a=>a)}}function Lx(e){const{intervals:t,tonic:n}=On(e),r=My(t,n);return i=>i?r(i>0?i-1:i):""}function Gx(e){const{intervals:t,tonic:n}=On(e);return My(t,n)}var la={degrees:Lx,detect:Ix,extended:Qy,get:On,modeNames:Rx,names:Tx,rangeOf:Ox,reduced:Fx,scaleChords:Dx,scaleNotes:Jy,steps:Gx,tokenize:Zy,scale:kx};function Ux(e){let t,n,r,i,o,a,s,l,u=e[0].join(", ")+"",c,h,f,d,m=e[1].join(" or ")+"",b;return{c(){t=A("main"),n=A("h2"),n.textContent="Chord Detection",r=R(),i=A("p"),i.textContent=`Play a chord on a MIDI instrument. The notes you played and the detected
        chord will be shown below.`,o=R(),a=A("div"),s=z("Notes: "),l=A("b"),c=z(u),h=A("br"),f=z(`
        Detected chord: `),d=A("b"),b=z(m),P(i,"class","explanation"),P(a,"class","visualization"),P(t,"class","demo")},m(g,E){le(g,t,E),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(a,l),p(l,c),p(a,h),p(a,f),p(a,d),p(d,b)},p(g,[E]){E&1&&u!==(u=g[0].join(", ")+"")&&_e(c,u),E&2&&m!==(m=g[1].join(" or ")+"")&&_e(b,m)},i:pe,o:pe,d(g){g&&se(t)}}}function qx(e,t,n){let r=0,i=[],o=[],a=[];const s=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((c,h)=>{console.log(`MIDI device ${h}: ${c.name}`),c.addListener("noteon",l)}),[...O.inputs])},l=c=>{const h=(c.timestamp-r)/1e3,f={number:c.note.number,velocity:c.rawVelocity,time:h,channel:c.message.channel};i.push(f),u()},u=()=>{const c=tt(i,h=>h.time);n(0,o=i.filter(h=>h.time>c-1).sort((h,f)=>h.number-f.number).map(h=>wn.fromMidiSharps(h.number))),n(0,o=[...new Set(o)]),n(1,a=Oy.detect(o))};return at(()=>{O.enable().then(s).catch(c=>alert(c)),r=performance.now(),u()}),ot(()=>{for(const c of O.inputs)c.removeListener()}),[o,a]}class Hx extends Ve{constructor(t){super(),ze(this,t,qx,Ux,He,{})}}function Pr(e){return e!=null&&!Number.isNaN(e)}function Mn(e,t){return+Pr(t)-+Pr(e)||Dt(e,t)}function Sl(e,t){return+Pr(t)-+Pr(e)||Pa(e,t)}function Oh(e){return e!=null&&`${e}`!=""}function e_(e){return isFinite(e)?e:NaN}function mu(e){return e>0&&isFinite(e)?e:NaN}function Lh(e){return e<0&&isFinite(e)?e:NaN}function zx(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),o=e.getUTCMilliseconds();return`${Vx(e.getUTCFullYear())}-${Qn(e.getUTCMonth()+1,2)}-${Qn(e.getUTCDate(),2)}${n||r||i||o?`T${Qn(n,2)}:${Qn(r,2)}${i||o?`:${Qn(i,2)}${o?`.${Qn(o,3)}`:""}`:""}Z`:""}`}function Vx(e){return e<0?`-${Qn(-e,6)}`:e>9999?`+${Qn(e,6)}`:Qn(e,4)}function Qn(e,t){return`${e}`.padStart(t,"0")}const Yx=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function t_(e,t){return Yx.test(e+="")?new Date(e):typeof t=="function"?t(e):t}function Wi(e){if(e==null)return;const t=e[0],n=e[e.length-1];return Pa(t,n)}const Ai=1e3,yr=Ai*60,_r=yr*60,Ln=_r*24,Pn=Ln*7,Wr=Ln*30,pr=Ln*365,sc=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",Ai],["5 seconds",5*Ai],["15 seconds",15*Ai],["30 seconds",30*Ai],["minute",yr],["5 minutes",5*yr],["15 minutes",15*yr],["30 minutes",30*yr],["hour",_r],["3 hours",3*_r],["6 hours",6*_r],["12 hours",12*_r],["day",Ln],["2 days",2*Ln],["week",Pn],["2 weeks",2*Pn],["month",Wr],["3 months",3*Wr],["6 months",6*Wr],["year",pr],["2 years",2*pr],["5 years",5*pr],["10 years",10*pr],["20 years",20*pr],["50 years",50*pr],["100 years",100*pr]],Gh=new Map([["second",Ai],["minute",yr],["hour",_r],["day",Ln],["monday",Pn],["tuesday",Pn],["wednesday",Pn],["thursday",Pn],["friday",Pn],["saturday",Pn],["sunday",Pn],["week",Pn],["month",Wr],["year",pr]]),n_=new Map([["second",pn],["minute",Fa],["hour",Ba],["day",li],["monday",ia],["tuesday",dg],["wednesday",mg],["thursday",ni],["friday",pg],["saturday",bg],["sunday",zi],["week",zi],["month",La],["year",yn]]),Uh=new Map([["second",pn],["minute",Ra],["hour",Oa],["day",ru],["monday",oa],["tuesday",gg],["wednesday",yg],["thursday",ri],["friday",_g],["saturday",vg],["sunday",Vi],["week",Vi],["month",Ga],["year",_n]]),za=Symbol("intervalDuration"),pu=Symbol("intervalType");for(const[e,t]of n_)t[za]=Gh.get(e),t[pu]="time";for(const[e,t]of Uh)t[za]=Gh.get(e),t[pu]="utc";const Do=[["year",_n,"utc"],["month",Ga,"utc"],["day",ru,"utc",6*Wr],["hour",Oa,"utc",3*Ln],["minute",Ra,"utc",6*_r],["second",pn,"utc",30*yr]],Fs=[["year",yn,"time"],["month",La,"time"],["day",li,"time",6*Wr],["hour",Ba,"time",3*Ln],["minute",Fa,"time",6*_r],["second",pn,"time",30*yr]],Wx=[Do[0],Fs[0],Do[1],Fs[1],Do[2],Fs[2],...Do.slice(3)];function r_(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),n=+r[1]),t){case"quarter":t="month",n*=3;break;case"half":t="month",n*=6;break}let i=Uh.get(t);if(!i)throw new Error(`unknown interval: ${e}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${t}`);return[t,n]}function i_(e){return a_(r_(e),"time")}function o_(e){return a_(r_(e),"utc")}function a_([e,t],n){let r=(n==="time"?n_:Uh).get(e);return t>1&&(r=r.every(t),r[za]=Gh.get(e)*t,r[pu]=n),r}function bp(e,t){if(!(t>1))return;const n=e[za];if(!sc.some(([,i])=>i===n)||n%Ln===0&&Ln<n&&n<Wr)return;const[r]=sc[Ol(([,i])=>Math.log(i)).center(sc,Math.log(n*t))];return(e[pu]==="time"?i_:o_)(r)}function gp(e,t,n){const r=t==="time"?Mh:Ua;if(n==null)return r(e==="year"?"%Y":e==="month"?"%Y-%m":e==="day"?"%Y-%m-%d":e==="hour"||e==="minute"?"%Y-%m-%dT%H:%M":e==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=Xx(n);switch(e){case"millisecond":return vi(r(".%L"),r(":%M:%S"),i);case"second":return vi(r(":%S"),r("%-I:%M"),i);case"minute":return vi(r("%-I:%M"),r("%p"),i);case"hour":return vi(r("%-I %p"),r("%b %-d"),i);case"day":return vi(r("%-d"),r("%b"),i);case"month":return vi(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function Xx(e){return e==="left"||e==="right"?(t,n)=>`
${t}
${n}`:e==="top"?(t,n)=>`${n}
${t}`:(t,n)=>`${t}
${n}`}function jx(e){return e==="time"?Fs:e==="utc"?Do:Wx}function Kx(e,t,n){const r=tt(h5(t,(i,o)=>Math.abs(o-i)));if(r<1e3)return gp("millisecond","utc",n);for(const[i,o,a,s]of jx(e)){if(r>s||i==="hour"&&!r)break;if(t.every(l=>o.floor(l)>=l))return gp(i,a,n)}}function vi(e,t,n){return(r,i,o)=>{const a=e(r,i),s=t(r,i),l=i-Wi(o);return i!==l&&o[l]!==void 0&&s===t(o[l],l)?a:n(a,s)}}const ua=Object.getPrototypeOf(Uint8Array),Zx=Object.prototype.toString,s_=Symbol("reindex");function dt(e,t,n){const r=typeof t;return r==="string"?yp(e,l_(t),n):r==="function"?yp(e,t,n):r==="number"||t instanceof Date||r==="boolean"?pt(e,Va(t),n):typeof(t==null?void 0:t.transform)=="function"?_p(t.transform(e),n):Qx(_p(t,n),e==null?void 0:e[s_])}function Qx(e,t){return t?zh(e,t):e}function yp(e,t,n){return pt(e,(n==null?void 0:n.prototype)instanceof ua?Jx(t):t,n)}function _p(e,t){return t===void 0?Wt(e):e instanceof t?e:t.prototype instanceof ua&&!(e instanceof ua)?t.from(e,Hh):t.from(e)}function Jx(e){return(t,n)=>Hh(e(t,n))}const Rs=[null],l_=e=>t=>t[e],qh={transform:fr},vt={transform:e=>e},eA=()=>1,tA=()=>!0,At=e=>e==null?e:`${e}`,Ke=e=>e==null?e:+e,u_=e=>e?e[0]:void 0,Af=e=>e?e[1]:void 0,Va=e=>()=>e;function nA(e){const t=+`${e}`.slice(1)/100;return(n,r)=>Ws(n,t,r)}function vr(e){return e instanceof ua?e:pt(e,Hh,Float64Array)}function Hh(e){return e==null?NaN:Number(e)}function rA(e){return pt(e,iA)}function iA(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?t_(e):e==null||isNaN(e=+e)?void 0:new Date(e)}function lr(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:yu(e)?[void 0,e]:[e,void 0]}function Ct(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function c_(e,t,n){if(e!=null)return Sn(e,t,n)}function Sn(e,t,n){const r=`${e}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${t}: ${e}`);return r}function Wt(e){return e==null||e instanceof Array||e instanceof ua?e:Array.from(e)}function pt(e,t,n=Array){return e==null?e:e instanceof n?e.map(t):n.from(e,t)}function ca(e,t=Array){return e instanceof t?e.slice():t.from(e)}function f_({x:e,x1:t,x2:n}){return e!==void 0||t!==void 0||n!==void 0}function h_({y:e,y1:t,y2:n}){return e!==void 0||t!==void 0||n!==void 0}function d_(e){return f_(e)||h_(e)||e.interval!==void 0}function Ir(e){return(e==null?void 0:e.toString)===Zx}function Cf(e){return Ir(e)&&(e.type!==void 0||e.domain!==void 0)}function bu(e){return Ir(e)&&typeof e.transform!="function"}function Xi(e){return bu(e)&&e.value===void 0&&e.channel===void 0}function m_(e,t,n,r=vt){return t===void 0&&n===void 0?(t=0,n=e===void 0?r:e):t===void 0?t=e===void 0?0:e:n===void 0&&(n=e===void 0?0:e),[t,n]}function ao(e,t){return e===void 0&&t===void 0?[u_,Af]:[e,t]}function p_({z:e,fill:t,stroke:n}={}){return e===void 0&&([e]=lr(t)),e===void 0&&([e]=lr(n)),e}function fr(e){const t=e.length,n=new Uint32Array(t);for(let r=0;r<t;++r)n[r]=r;return n}function zh(e,t){return pt(t,n=>e[n],e.constructor)}function oA(e,t,n){return e.subarray?e.subarray(t,n):e.slice(t,n)}function Hr(e){return e!==null&&typeof e=="object"?e.valueOf():e}function aA(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function xl(e){let t;return[{transform:()=>t,label:so(e)},n=>t=n]}function Ei(e){return e==null?[e]:xl(e)}function so(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function b_(e,t){return{transform(n){const r=e.transform(n),i=t.transform(n);return sn(r)||sn(i)?pt(r,(o,a)=>new Date((+r[a]+ +i[a])/2)):pt(r,(o,a)=>(+r[a]+ +i[a])/2,Float64Array)},label:e.label}}function Pf(e,t){const n=g_(t==null?void 0:t.interval,t==null?void 0:t.type);return n?pt(e,n):e}function g_(e,t){const n=Vh(e,t);return n&&(r=>Pr(r)?n.floor(r):r)}function Vh(e,t){if(e!=null){if(typeof e=="number"){0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const n=Math.abs(e);return e<0?{floor:r=>Math.floor(r*n)/n,offset:r=>(r*n+1)/n,range:(r,i)=>be(Math.ceil(r*n),i*n).map(o=>o/n)}:{floor:r=>Math.floor(r/n)*n,offset:r=>r+n,range:(r,i)=>be(Math.ceil(r/n),i/n).map(o=>o*n)}}if(typeof e=="string")return(t==="time"?i_:o_)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function Ya(e,t){if(e=Vh(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function sA(e,t){if(e=Ya(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function lA(e){return typeof(e==null?void 0:e.range)=="function"}function gu(e){return e===void 0||bu(e)?e:{value:e}}function uA(e){return e==null?null:{transform:t=>dt(t,e,Float64Array),label:so(e)}}function hi(e){return e&&typeof e[Symbol.iterator]=="function"}function y_(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function vp(e){for(const t of e){if(t==null)continue;const n=typeof t;return n==="string"||n==="boolean"}}function sn(e){for(const t of e)if(t!=null)return t instanceof Date}function cA(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&t_(t)}function fA(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function hA(e){for(const t of e)if(t!=null)return typeof t=="number"}function lc(e,t){let n;for(const r of e)if(r!=null){if(!t(r))return!1;n=!0}return n}const dA=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function yu(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||dA.has(e))}function mA(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function Tt(e){return e==null||fa(e)}function fa(e){return/^\s*none\s*$/i.test(e)}function pA(e){return/^\s*round\s*$/i.test(e)}function Nf(e,t){return c_(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function _u(e="middle"){return Nf(e,"frameAnchor")}function bA(e={},...t){let n=e;for(const r of t)for(const i in r)if(n[i]===void 0){const o=r[i];n===e?n={...n,[i]:o}:n[i]=o}return n}function gA(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(t.has(i))throw new Error(`duplicate name: ${i}`);return t.add(i),[r,n]}))}function __(e){return hi(e)?gA(e):e}function v_(e){return e===!0?e="frame":e===!1?e=null:e!=null&&(e=Sn(e,"clip",["frame","sphere"])),e}const In=Symbol("position"),hr=Symbol("color"),Wa=Symbol("radius"),Xa=Symbol("length"),ja=Symbol("opacity"),vu=Symbol("symbol"),w_=Symbol("projection"),et=new Map([["x",In],["y",In],["fx",In],["fy",In],["r",Wa],["color",hr],["opacity",ja],["symbol",vu],["length",Xa],["projection",w_]]);function yA(e){return e===In||e===w_}function _A(e){return e===In||e===Wa||e===Xa||e===ja}const vA=Math.sqrt(3),wA=2/vA,MA={draw(e,t){const n=Math.sqrt(t/Math.PI),r=n*wA,i=r/2;e.moveTo(0,r),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(0,-r),e.lineTo(-n,-i),e.lineTo(-n,i),e.closePath()}},Yh=new Map([["asterisk",G2],["circle",sa],["cross",U2],["diamond",H2],["diamond2",z2],["hexagon",MA],["plus",V2],["square",Y2],["square2",W2],["star",j2],["times",J2],["triangle",K2],["triangle2",Z2],["wye",Q2]]);function Wh(e){return e&&typeof e.draw=="function"}function EA(e){return Wh(e)?!0:typeof e!="string"?!1:Yh.has(e.toLowerCase())}function Xh(e){if(e==null||Wh(e))return e;const t=Yh.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function SA(e){if(e==null||Wh(e))return[void 0,e];if(typeof e=="string"){const t=Yh.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function wu({filter:e,sort:t,reverse:n,transform:r,initializer:i,...o}={},a){if(r===void 0&&(e!=null&&(r=M_(e)),t!=null&&!Xi(t)&&(r=uc(r,jh(t))),n&&(r=uc(r,E_))),a!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...o,...(t===null||Xi(t))&&{sort:t},transform:uc(r,a)}}function ji({filter:e,sort:t,reverse:n,initializer:r,...i}={},o){return r===void 0&&(e!=null&&(r=M_(e)),t!=null&&!Xi(t)&&(r=cc(r,jh(t))),n&&(r=cc(r,E_))),{...i,...(t===null||Xi(t))&&{sort:t},initializer:cc(r,o)}}function uc(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i){return{data:n,facets:r}=e.call(this,n,r,i),t.call(this,Wt(n),r,i)}}function cc(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i,...o){let a,s,l,u,c,h;return{data:s=n,facets:l=r,channels:a}=e.call(this,n,r,i,...o),{data:c=s,facets:h=l,channels:u}=t.call(this,s,l,{...i,...a},...o),{data:c,facets:h,channels:{...a,...u}}}}function xA(e,t){return(e.initializer!=null?ji:wu)(e,t)}function M_(e){return(t,n)=>{const r=dt(t,e);return{data:t,facets:n.map(i=>i.filter(o=>r[o]))}}}function E_(e,t){return{data:e,facets:t.map(n=>n.slice().reverse())}}function AA(e,{sort:t,...n}={}){return{...(bu(e)&&e.channel!==void 0?ji:xA)(n,jh(e)),sort:Xi(t)?t:null}}function jh(e){return(typeof e=="function"&&e.length!==1?CA:PA)(e)}function CA(e){return(t,n)=>{const r=(i,o)=>e(t[i],t[o]);return{data:t,facets:n.map(i=>i.slice().sort(r))}}}function PA(e){let t,n;({channel:t,value:e,order:n}={...gu(e)});const r=t==null?void 0:t.startsWith("-");if(r&&(t=t.slice(1)),n===void 0&&(n=r?Sl:Mn),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=Mn;break;case"descending":n=Sl;break;default:throw new Error(`invalid order: ${n}`)}return(i,o,a)=>{let s;if(t===void 0)s=dt(i,e);else{if(a===void 0)throw new Error("channel sort requires an initializer");if(s=a[t],!s)return{};s=s.value}const l=(u,c)=>n(s[u],s[c]);return{data:i,facets:o.map(u=>u.slice().sort(l))}}}function NA(e={y:"count"},t={}){const{x:n=vt}=t;if(n==null)throw new Error("missing channel: x");return S_(n,null,e,t)}function $A(e={fill:"count"},t={}){let{x:n,y:r}=t;if([n,r]=ao(n,r),n==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return S_(n,r,e,t)}function S_(e,t,{data:n=$_,filter:r,sort:i,reverse:o,...a}={},s={}){a=DA(a,s),n=N_(n,vt),i=i==null?void 0:C_("sort",i,s),r=r==null?void 0:P_("filter",r,s);const[l,u]=Ei(e),[c,h]=Ei(t),{z:f,fill:d,stroke:m,x1:b,x2:g,y1:E,y2:_,...y}=s,[v,x]=Ei(f),[w]=lr(d),[M]=lr(m),[C,S]=Ei(w),[N,$]=Ei(M);return{..."z"in s&&{z:v||f},..."fill"in s&&{fill:C||d},..."stroke"in s&&{stroke:N||m},...wu(y,(T,L,D)=>{const I=Pf(dt(T,e),D==null?void 0:D.x),V=Pf(dt(T,t),D==null?void 0:D.y),W=dt(T,f),U=dt(T,w),Y=dt(T,M),k=RA(a,{z:W,fill:U,stroke:Y}),B=[],G=[],X=I&&u([]),Z=V&&h([]),ie=W&&x([]),ee=U&&S([]),j=Y&&$([]);let J=0;for(const F of a)F.initialize(T);i&&i.initialize(T),r&&r.initialize(T);for(const F of L){const ne=[];for(const re of a)re.scope("facet",F);i&&i.scope("facet",F),r&&r.scope("facet",F);for(const[re,q]of fc(F,k))for(const[ce,H]of fc(q,V))for(const[ue,ae]of fc(H,I)){const he={data:T};if(I&&(he.x=ue),V&&(he.y=ce),k&&(he.z=re),!(r&&!r.reduce(ae,he))){ne.push(J++),G.push(n.reduceIndex(ae,T,he)),I&&X.push(ue),V&&Z.push(ce),W&&ie.push(k===W?re:W[ae[0]]),U&&ee.push(k===U?re:U[ae[0]]),Y&&j.push(k===Y?re:Y[ae[0]]);for(const de of a)de.reduce(ae,he);i&&i.reduce(ae,he)}}B.push(ne)}return BA(B,i,o),{data:G,facets:B}}),...!wp(a,"x")&&(l?{x:l}:{x1:b,x2:g}),...!wp(a,"y")&&(c?{y:c}:{y1:E,y2:_}),...Object.fromEntries(a.map(({name:T,output:L})=>[T,L]))}}function wp(e,...t){for(const{name:n}of e)if(t.includes(n))return!0;return!1}function TA(e,t,n=x_){const r=Object.entries(e);return t.title!=null&&e.title===void 0&&r.push(["title",GA]),t.href!=null&&e.href===void 0&&r.push(["href",T_]),r.filter(([,i])=>i!==void 0).map(([i,o])=>o===null?kA(i):n(i,o,t))}function x_(e,t,n,r=A_){let i;Ir(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);const o=r(e,t,n),[a,s]=xl(o.label);let l;return{name:e,output:i===void 0?a:{value:a,scale:i},initialize(u){o.initialize(u),l=s([])},scope(u,c){o.scope(u,c)},reduce(u,c){l.push(o.reduce(u,c))}}}function kA(e){return{name:e,initialize(){},scope(){},reduce(){}}}function A_(e,t,n,r=Kh){const i=aA(e,n),o=r(t,i);let a,s;return{label:so(o===$f?null:i,o.label),initialize(l){a=i===void 0?l:dt(l,i),o.scope==="data"&&(s=o.reduceIndex(fr(l),a))},scope(l,u){o.scope===l&&(s=o.reduceIndex(u,a))},reduce(l,u){return o.scope==null?o.reduceIndex(l,a,u):o.reduceIndex(l,a,s,u)}}}function fc(e,t){return t?Ul(e,n=>t[n]):[[,e]]}function Kh(e,t,n=IA){if(e==null)return n(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&Ir(e))return OA(e);if(typeof e=="function")return LA(e);if(/^p\d{2}$/i.test(e))return Zn(nA(e));switch(`${e}`.toLowerCase()){case"first":return T_;case"last":return UA;case"identity":return $_;case"count":return $f;case"distinct":return qA;case"sum":return t==null?$f:HA;case"proportion":return Ep(t,"data");case"proportion-facet":return Ep(t,"facet");case"deviation":return Zn(Z3);case"min":return Zn(Nt);case"min-index":return Zn(k1);case"max":return Zn(tt);case"max-index":return Zn(l5);case"mean":return Mp(F1);case"median":return Mp(Gc);case"variance":return Zn(C1);case"mode":return Zn(f5)}return n(e)}function IA(e){throw new Error(`invalid reduce: ${e}`)}function DA(e,t){return TA(e,t,C_)}function C_(e,t,n){return x_(e,t,n,P_)}function P_(e,t,n){return A_(e,t,n,N_)}function N_(e,t){return Kh(e,t,FA)}function FA(e){switch(`${e}`.toLowerCase()){case"x":return zA;case"y":return VA;case"z":return YA}throw new Error(`invalid group reduce: ${e}`)}function RA(e,t){for(const n in t){const r=t[n];if(r!==void 0&&!e.some(i=>i.name===n))return r}}function BA(e,t,n){if(t){const r=t.output.transform(),i=(o,a)=>Mn(r[o],r[a]);e.forEach(o=>o.sort(i))}n&&e.forEach(r=>r.reverse())}function OA(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function LA(e){return{reduceIndex(t,n,r){return e(zh(n,t),r)}}}function Zn(e){return{reduceIndex(t,n){return e(t,r=>n[r])}}}function Mp(e){return{reduceIndex(t,n){const r=e(t,i=>n[i]);return sn(n)?new Date(r):r}}}const $_={reduceIndex(e,t){return zh(t,e)}},T_={reduceIndex(e,t){return t[e[0]]}},GA={reduceIndex(e,t){const r=zs(Pi(e,o=>o.length,o=>t[o]),Af),i=r.slice(-5).reverse();if(i.length<r.length){const o=r.slice(0,-4);i[4]=[`… ${o.length.toLocaleString("en-US")} more`,Mr(o,Af)]}return i.map(([o,a])=>`${o} (${a.toLocaleString("en-US")})`).join(`
`)}},UA={reduceIndex(e,t){return t[e[e.length-1]]}},$f={label:"Frequency",reduceIndex(e){return e.length}},qA={label:"Distinct",reduceIndex(e,t){const n=new Gl;for(const r of e)n.add(t[r]);return n.size}},HA=Zn(Mr);function Ep(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:t,reduceIndex:(n,r,i=1)=>Mr(n,o=>r[o])/i}}const zA={reduceIndex(e,t,{x:n}){return n}},VA={reduceIndex(e,t,{y:n}){return n}},YA={reduceIndex(e,t,{z:n}){return n}};function ha(e,{scale:t,type:n,value:r,filter:i,hint:o,label:a=so(r)},s){return o===void 0&&typeof(r==null?void 0:r.transform)=="function"&&(o=r.hint),k_(s,{scale:t,type:n,value:dt(e,r),label:a,filter:i,hint:o})}function WA(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,ha(t,r,n)]))}function XA(e,t){const n=Object.fromEntries(Object.entries(e).map(([r,{scale:i,value:o}])=>{const a=i==null?null:t[i];return[r,a==null?o:pt(o,a)]}));return n.channels=e,n}function k_(e,t){const{scale:n,value:r}=t;if(n===!0||n==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=n!==!0&&lc(r,yu)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=n!==!0&&lc(r,mA)?null:"opacity";break;case"symbol":n!==!0&&lc(r,EA)?(t.scale=null,t.value=pt(r,Xh)):t.scale="symbol";break;default:t.scale=et.has(e)?e:null;break}else if(n===!1)t.scale=null;else if(n!=null&&!et.has(n))throw new Error(`unknown scale: ${n}`);return t}function jA(e,t,n,r,i){const{order:o,reverse:a,reduce:s=!0,limit:l}=i;for(const u in i){if(!et.has(u))continue;let{value:c,order:h=o,reverse:f=a,reduce:d=s,limit:m=l}=gu(i[u]);const b=c==null?void 0:c.startsWith("-");if(b&&(c=c.slice(1)),h=h===void 0?b!==(c==="width"||c==="height")?D_:I_:QA(h),d==null||d===!1)continue;const g=u==="fx"||u==="fy"?ZA(t,r[u]):KA(n,u);if(!g)throw new Error(`missing channel for scale: ${u}`);const E=g.value,[_=0,y=1/0]=hi(m)?m:m<0?[m]:[0,m];if(c==null)g.domain=()=>{let v=Array.from(new Gl(E));return f&&(v=v.reverse()),(_!==0||y!==1/0)&&(v=v.slice(_,y)),v};else{const v=c==="data"?e:c==="height"?Sp(n,"y1","y2"):c==="width"?Sp(n,"x1","x2"):Tf(n,c,c==="y"?"y2":c==="x"?"x2":void 0),x=Kh(d===!0?"max":d,v);g.domain=()=>{let w=Q3(fr(E),M=>x.reduceIndex(M,v),M=>E[M]);return h&&w.sort(h),f&&w.reverse(),(_!==0||y!==1/0)&&(w=w.slice(_,y)),w.map(u_)}}}}function KA(e,t){for(const n in e){const r=e[n];if(r.scale===t)return r}}function ZA(e,t){const n=e.original;if(n===e)return t;const r=t.value,i=t.value=[];for(let o=0;o<n.length;++o){const a=r[n[o][0]];for(const s of e[o])i[s]=a}return t}function Sp(e,t,n){const r=Tf(e,t),i=Tf(e,n);return pt(i,(o,a)=>Math.abs(o-r[a]),Float64Array)}function Tf(e,t,n){let r=e[t];if(!r&&n!==void 0&&(r=e[n]),r)return r.value;throw new Error(`missing channel: ${t}`)}function QA(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return I_;case"descending":return D_}throw new Error(`invalid order: ${e}`)}function I_([e,t],[n,r]){return Mn(t,r)||Mn(e,n)}function D_([e,t],[n,r]){return Sl(t,r)||Mn(e,n)}function xp(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}function Zh(e={}){const{document:t=typeof window<"u"?window.document:void 0,clip:n}=e;return{document:t,clip:v_(n)}}function ut(e,{document:t}){return Go(zl(e).call(t.documentElement))}let kf=0,If;function JA(){const e=kf;return kf=0,If=void 0,e}function wr(e){e!==If&&(If=e,console.warn(e),++kf)}const F_=Math.PI,Xn=2*F_,Ap=.618;function eC({projection:e,inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:o=t}={},a){if(e==null)return;if(typeof e.stream=="function")return e;let s,l,u="frame";if(Ir(e)){let x;if({type:e,domain:l,inset:x,insetTop:n=x!==void 0?x:n,insetRight:r=x!==void 0?x:r,insetBottom:i=x!==void 0?x:i,insetLeft:o=x!==void 0?x:o,clip:u=u,...s}=e,e==null)return}typeof e!="function"&&({type:e}=R_(e));const{width:c,height:h,marginLeft:f,marginRight:d,marginTop:m,marginBottom:b}=a,g=c-f-d-o-r,E=h-m-b-n-i;if(e=e==null?void 0:e({width:g,height:E,clip:u,...s}),e==null)return;u=tC(u,f,m,c-d,h-b);let _=f+o,y=m+n,v;if(l!=null){const[[x,w],[M,C]]=Kl(e).bounds(l),S=Math.min(g/(M-x),E/(C-w));S>0?(_-=(S*(x+M)-g)/2,y-=(S*(w+C)-E)/2,v=df({point(N,$){this.stream.point(N*S+_,$*S+y)}})):wr("Warning: the projection could not be fit to the specified domain; using the default scale.")}return v??(v=_===0&&y===0?B_():df({point(x,w){this.stream.point(x+_,w+y)}})),{stream:x=>e.stream(v.stream(u(x)))}}function R_(e){switch(`${e}`.toLowerCase()){case"albers-usa":return hn(UM,.7463,.4673);case"albers":return _s(Vb,.7463,.4673);case"azimuthal-equal-area":return hn(qM,4,4);case"azimuthal-equidistant":return hn(HM,Xn,Xn);case"conic-conformal":return _s(YM,Xn,Xn);case"conic-equal-area":return _s(fl,6.1702,2.9781);case"conic-equidistant":return _s(jM,7.312,3.6282);case"equal-earth":return hn(ZM,5.4133,2.6347);case"equirectangular":return hn(WM,Xn,F_);case"gnomonic":return hn(QM,3.4641,3.4641);case"identity":return{type:B_};case"reflect-y":return{type:nC};case"mercator":return hn(zM,Xn,Xn);case"orthographic":return hn(JM,2,2);case"stereographic":return hn(e8,2,2);case"transverse-mercator":return hn(t8,Xn,Xn);default:throw new Error(`unknown projection type: ${e}`)}}function tC(e,t,n,r,i){if(e===!1||e==null||typeof e=="number")return o=>o;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return Nb(t,n,r,i);default:throw new Error(`unknown projection clip type: ${e}`)}}function hn(e,t,n){return{type:({width:r,height:i,rotate:o,precision:a=.15,clip:s})=>{var u,c,h;const l=e();return a!=null&&((u=l.precision)==null||u.call(l,a)),o!=null&&((c=l.rotate)==null||c.call(l,o)),typeof s=="number"&&((h=l.clipAngle)==null||h.call(l,s)),l.scale(Math.min(r/t,i/n)),l.translate([r/2,i/2]),l},aspectRatio:n/t}}function _s(e,t,n){const{type:r,aspectRatio:i}=hn(e,t,n);return{type:o=>{const{parallels:a,domain:s,width:l,height:u}=o,c=r(o);return a!=null&&(c.parallels(a),s===void 0&&c.fitSize([l,u],{type:"Sphere"})),c},aspectRatio:i}}const B_=Va({stream:e=>e}),nC=Va(df({point(e,t){this.stream.point(e,-t)}}));function rC(e,t,n,r){const i=n[e],o=n[t],a=i.length,s=n[e]=new Float64Array(a).fill(NaN),l=n[t]=new Float64Array(a).fill(NaN);let u;const c=r.stream({point(h,f){s[u]=h,l[u]=f}});for(u=0;u<a;++u)c.point(i[u],o[u])}function iC({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(Ir(e)&&(e=e.type),e!=null)}function oC(e){if(typeof(e==null?void 0:e.stream)=="function")return Ap;if(Ir(e)&&(e=e.type),e!=null){if(typeof e!="function"){const{aspectRatio:t}=R_(e);if(t)return t}return Ap}}function aC(e){const t=[],n=[],r={scale:"x",value:t},i={scale:"y",value:n},o={point(a,s){t.push(a),n.push(s)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const a of e.value)Gr(a,o);return[r,i]}const O_=new Map([["accent",x9],["category10",S9],["dark2",A9],["observable10",C9],["paired",P9],["pastel1",N9],["pastel2",$9],["set1",T9],["set2",k9],["set3",I9],["tableau10",D9]]);function sC(e){return e!=null&&O_.has(`${e}`.toLowerCase())}const Cp=new Map([...O_,["brbg",jn($g,Tg)],["prgn",jn(kg,Ig)],["piyg",jn(Dg,Fg)],["puor",jn(Rg,Bg)],["rdbu",jn(yf,pl)],["rdgy",jn(Og,Lg)],["rdylbu",jn(_f,aa)],["rdylgn",jn(Gg,Ug)],["spectral",jn(qg,Hg)],["burd",Pp(yf,pl)],["buylrd",Pp(_f,aa)],["blues",ct(m2,p2)],["greens",ct(b2,g2)],["greys",ct(y2,_2)],["oranges",ct(S2,x2)],["purples",ct(v2,w2)],["reds",ct(M2,E2)],["turbo",Kn(k2)],["viridis",Kn(I2)],["magma",Kn(D2)],["inferno",Kn(F2)],["plasma",Kn(R2)],["cividis",Kn(A2)],["cubehelix",Kn(C2)],["warm",Kn(P2)],["cool",Kn(N2)],["bugn",ct(zg,Vg)],["bupu",ct(Yg,Wg)],["gnbu",ct(Xg,jg)],["orrd",ct(Kg,Zg)],["pubu",ct(e2,t2)],["pubugn",ct(Qg,Jg)],["purd",ct(n2,r2)],["rdpu",ct(i2,o2)],["ylgn",ct(l2,u2)],["ylgnbu",ct(a2,s2)],["ylorbr",ct(c2,f2)],["ylorrd",ct(h2,d2)],["rainbow",Np($2)],["sinebow",Np(T2)]]);function ct(e,t){return({length:n})=>n===1?[e[3][1]]:n===2?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?gn(t,n):e[n])}function jn(e,t){return({length:n})=>n===2?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?gn(t,n):e[n])}function Pp(e,t){return({length:n})=>n===2?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?gn(r=>t(1-r),n):e[n].slice().reverse())}function Kn(e){return({length:t})=>gn(e,Math.max(2,Math.floor(t)))}function Np(e){return({length:t})=>gn(e,Math.floor(t)+1).slice(0,-1)}function L_(e){const t=`${e}`.toLowerCase();if(!Cp.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return Cp.get(t)}function Mu(e,t){const n=L_(e),r=typeof n=="function"?n({length:t}):n;return r.length!==t?r.slice(0,t):r}function lC(e,t="greys"){const n=new Set,[r,i]=Mu(t,2);for(const o of e)if(o!=null)if(o===!0)n.add(i);else if(o===!1)n.add(r);else return;return[...n]}const $p=new Map([["brbg",Tg],["prgn",Ig],["piyg",Fg],["puor",Bg],["rdbu",pl],["rdgy",Lg],["rdylbu",aa],["rdylgn",Ug],["spectral",Hg],["burd",e=>pl(1-e)],["buylrd",e=>aa(1-e)],["blues",p2],["greens",g2],["greys",_2],["purples",w2],["reds",E2],["oranges",x2],["turbo",k2],["viridis",I2],["magma",D2],["inferno",F2],["plasma",R2],["cividis",A2],["cubehelix",C2],["warm",P2],["cool",N2],["bugn",Vg],["bupu",Wg],["gnbu",jg],["orrd",Zg],["pubugn",Jg],["pubu",t2],["purd",r2],["rdpu",o2],["ylgnbu",s2],["ylgn",u2],["ylorbr",f2],["ylorrd",d2],["rainbow",$2],["sinebow",T2]]);function Qh(e){const t=`${e}`.toLowerCase();if(!$p.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return $p.get(t)}const uC=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function cC(e){return e!=null&&uC.has(`${e}`.toLowerCase())}const G_=e=>t=>e(1-t),hc=[0,1],Tp=new Map([["number",wt],["rgb",Jr],["hsl",R4],["hcl",L4],["lab",B4]]);function U_(e){const t=`${e}`.toLowerCase();if(!Tp.has(t))throw new Error(`unknown interpolator: ${t}`);return Tp.get(t)}function Ka(e,t,n,{type:r,nice:i,clamp:o,zero:a,domain:s=H_(e,n),unknown:l,round:u,scheme:c,interval:h,range:f=et.get(e)===Wa?wC(n,s):et.get(e)===Xa?MC(n,s):et.get(e)===ja?hc:void 0,interpolate:d=et.get(e)===hr?c==null&&f!==void 0?Jr:Qh(c!==void 0?c:r==="cyclical"?"rainbow":"turbo"):u?uh:wt,reverse:m}){if(h=Ya(h,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof d!="function"&&(d=U_(d)),m=!!m,f!==void 0){const b=(s=Wt(s)).length,g=(f=Wt(f)).length;if(b!==g){if(d.length===1)throw new Error("invalid piecewise interpolator");d=Wl(d,f),f=void 0}}if(d.length===1?(m&&(d=G_(d),m=!1),f===void 0&&(f=Float64Array.from(s,(b,g)=>g/(s.length-1)),f.length===2&&(f=hc)),t.interpolate((f===hc?Va:ed)(d))):t.interpolate(d),a){const[b,g]=Ft(s);(b>0||g<0)&&(s=ca(s),Wi(s)!==Math.sign(b)?s[s.length-1]=0:s[0]=0)}return m&&(s=Xs(s)),t.domain(s).unknown(l),i&&(t.nice(fC(i,r)),s=t.domain()),f!==void 0&&t.range(f),o&&t.clamp(o),{type:r,domain:s,range:f,scale:t,interpolate:d,interval:h}}function fC(e,t){return e===!0?void 0:typeof e=="number"?e:sA(e,t)}function hC(e,t,n){return Ka(e,vh(),t,n)}function dC(e,t,n){return q_(e,t,{...n,exponent:.5})}function q_(e,t,{exponent:n=1,...r}){return Ka(e,cg().exponent(n),t,{...r,type:"pow"})}function mC(e,t,{base:n=10,domain:r=EC(t),...i}){return Ka(e,ag().base(n),t,{...i,domain:r})}function pC(e,t,{constant:n=1,...r}){return Ka(e,lg().constant(n),t,r)}function bC(e,t,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:o="rdylbu",domain:a=SC(t),unknown:s,interpolate:l,reverse:u}){return n===void 0&&(n=l!==void 0?gn(l,i):et.get(e)===hr?Mu(o,i):void 0),a.length>0&&(a=fg(a,n===void 0?{length:i}:n).quantiles()),Jh(e,t,{domain:a,range:n,reverse:u,unknown:s})}function gC(e,t,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:o=H_(e,t),unknown:a,interpolate:s,reverse:l}){const[u,c]=Ft(o);let h;return n===void 0?(h=Zo(u,c,r),h[0]<=u&&h.splice(0,1),h[h.length-1]>=c&&h.pop(),r=h.length+1,n=s!==void 0?gn(s,r):et.get(e)===hr?Mu(i,r):void 0):(h=gn(wt(u,c),r+1).slice(1,-1),u instanceof Date&&(h=h.map(f=>new Date(f)))),Wi(Wt(o))<0&&h.reverse(),Jh(e,t,{domain:h,range:n,reverse:l,unknown:a})}function Jh(e,t,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:o,range:a=o!==void 0?gn(o,n.length+1):et.get(e)===hr?Mu(i,n.length+1):void 0,reverse:s}){n=Wt(n);const l=Wi(n);if(!isNaN(l)&&!yC(n,l))throw new Error(`the ${e} scale has a non-monotonic domain`);return s&&(a=Xs(a)),{type:"threshold",scale:hg(l<0?Xs(n):n,a===void 0?[]:a).unknown(r),domain:n,range:a}}function yC(e,t){for(let n=1,r=e.length,i=e[0];n<r;++n){const o=Pa(i,i=e[n]);if(o!==0&&o!==t)return!1}return!0}function _C(e){return{type:"identity",scale:_A(et.get(e))?rg():t=>t}}function da(e,t=e_){return e.length?[Nt(e,({value:n})=>n===void 0?n:Nt(n,t)),tt(e,({value:n})=>n===void 0?n:tt(n,t))]:[0,1]}function H_(e,t){const n=et.get(e);return(n===Wa||n===ja||n===Xa?vC:da)(t)}function vC(e){return[0,e.length?tt(e,({value:t})=>t===void 0?t:tt(t,e_)):1]}function wC(e,t){const n=e.find(({radius:a})=>a!==void 0);if(n!==void 0)return[0,n.radius];const r=Ws(e,.5,({value:a})=>a===void 0?NaN:Ws(a,.25,mu)),i=t.map(a=>3*Math.sqrt(a/r)),o=30/tt(i);return o<1?i.map(a=>a*o):i}function MC(e,t){const n=Gc(e,({value:o})=>o===void 0?NaN:Gc(o,Math.abs)),r=t.map(o=>12*o/n),i=60/tt(r);return i<1?r.map(o=>o*i):r}function EC(e){for(const{value:t}of e)if(t!==void 0)for(let n of t){if(n>0)return da(e,mu);if(n<0)return da(e,Lh)}return[1,10]}function SC(e){const t=[];for(const{value:n}of e)if(n!==void 0)for(const r of n)t.push(r);return t}function ed(e){return(t,n)=>r=>e(t+r*(n-t))}function Eu(e,t,n,r,{type:i,nice:o,clamp:a,domain:s=da(r),unknown:l,pivot:u=0,scheme:c,range:h,symmetric:f=!0,interpolate:d=et.get(e)===hr?c==null&&h!==void 0?Jr:Qh(c!==void 0?c:"rdbu"):wt,reverse:m}){u=+u,s=Wt(s);let[b,g]=s;if(s.length>2&&wr(`Warning: the diverging ${e} scale domain contains extra elements.`),Pa(b,g)<0&&([b,g]=[g,b],m=!m),b=Math.min(b,u),g=Math.max(g,u),typeof d!="function"&&(d=U_(d)),h!==void 0&&(d=d.length===1?ed(d)(...h):Wl(d,h)),m&&(d=G_(d)),f){const E=n.apply(u),_=E-n.apply(b),y=n.apply(g)-E;_<y?b=n.invert(E-y):_>y&&(g=n.invert(E+_))}return t.domain([b,u,g]).unknown(l).interpolator(d),a&&t.clamp(a),o&&t.nice(o),{type:i,domain:[b,g],pivot:u,interpolate:d,scale:t}}function xC(e,t,n){return Eu(e,Ag(),NC,t,n)}function AC(e,t,n){return z_(e,t,{...n,exponent:.5})}function z_(e,t,{exponent:n=1,...r}){return Eu(e,Ng().exponent(n=+n),kC(n),t,{...r,type:"diverging-pow"})}function CC(e,t,{base:n=10,pivot:r=1,domain:i=da(t,r<0?Lh:mu),...o}){return Eu(e,Cg().base(n=+n),$C,t,{domain:i,pivot:r,...o})}function PC(e,t,{constant:n=1,...r}){return Eu(e,Pg().constant(n=+n),IC(n),t,r)}const NC={apply(e){return e},invert(e){return e}},$C={apply:Math.log,invert:Math.exp},TC={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function kC(e){return e===.5?TC:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function IC(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function V_(e,t,n,r){return Ka(e,t,n,r)}function DC(e,t,n){return V_(e,M9(),t,n)}function FC(e,t,n){return V_(e,E9(),t,n)}const Za=Symbol("ordinal");function Y_(e,t,n,{type:r,interval:i,domain:o,range:a,reverse:s,hint:l}){return i=Ya(i,r),o===void 0&&(o=X_(n,i,e)),(r==="categorical"||r===Za)&&(r="ordinal"),s&&(o=Xs(o)),o=t.domain(o).domain(),a!==void 0&&(typeof a=="function"&&(a=a(o)),t.range(a)),{type:r,domain:o,range:a,scale:t,hint:l,interval:i}}function RC(e,t,{type:n,interval:r,domain:i,range:o,scheme:a,unknown:s,...l}){r=Ya(r,n),i===void 0&&(i=X_(t,r,e));let u;if(et.get(e)===vu)u=LC(t),o=o===void 0?GC(u):pt(o,Xh);else if(et.get(e)===hr&&(o===void 0&&(n==="ordinal"||n===Za)&&(o=lC(i,a),o!==void 0&&(a=void 0)),a===void 0&&o===void 0&&(a=n==="ordinal"?"turbo":"observable10"),a!==void 0))if(o!==void 0){const c=Qh(a),h=o[0],f=o[1]-o[0];o=({length:d})=>gn(m=>c(h+f*m),d)}else o=L_(a);if(s===pf)throw new Error(`implicit unknown on ${e} scale is not supported`);return Y_(e,_h().unknown(s),t,{...l,type:n,domain:i,range:o,hint:u})}function BC(e,t,{align:n=.5,padding:r=.5,...i}){return W_(n8().align(n).padding(r),t,i,e)}function OC(e,t,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:o=e==="fx"||e==="fy"?0:r,...a}){return W_(eu().align(n).paddingInner(i).paddingOuter(o),t,a,e)}function W_(e,t,n,r){let{round:i}=n;return i!==void 0&&e.round(i=!!i),e=Y_(r,e,t,n),e.round=i,e}function X_(e,t,n){const r=new Gl;for(const{value:i,domain:o}of e){if(o!==void 0)return o();if(i!==void 0)for(const a of i)r.add(a)}if(t!==void 0){const[i,o]=Ft(r).map(t.floor,t);return t.range(i,t.offset(o))}if(r.size>1e4&&et.get(n)===In)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return zs(r,Mn)}function kp(e,t){let n;for(const{hint:r}of e){const i=r==null?void 0:r[t];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function LC(e){return{fill:kp(e,"fill"),stroke:kp(e,"stroke")}}function GC(e){return Tt(e.fill)?Q9:Z9}function Df(e,{label:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:a=n,round:s,nice:l,clamp:u,zero:c,align:h,padding:f,projection:d,facet:{label:m=t}={},...b}={}){const g={};for(const[E,_]of e){const y=b[E],v=VC(E,_,{round:et.get(E)===In?s:void 0,nice:l,clamp:u,zero:c,align:h,padding:f,projection:d,...y});if(v){let{label:x=E==="fx"||E==="fy"?m:t,percent:w,transform:M,inset:C,insetTop:S=C!==void 0?C:E==="y"?r:0,insetRight:N=C!==void 0?C:E==="x"?i:0,insetBottom:$=C!==void 0?C:E==="y"?o:0,insetLeft:T=C!==void 0?C:E==="x"?a:0}=y||{};if(M==null)M=void 0;else if(typeof M!="function")throw new Error("invalid scale transform; not a function");v.percent=!!w,v.label=x===void 0?qC(_,v):x,v.transform=M,E==="x"||E==="fx"?(v.insetLeft=+T,v.insetRight=+N):(E==="y"||E==="fy")&&(v.insetTop=+S,v.insetBottom=+$),g[E]=v}}return g}function Ip(e){const t={},n={scales:t};for(const[r,i]of Object.entries(e)){const{scale:o,type:a,interval:s,label:l}=i;t[r]=KC(i),n[r]=o,o.type=a,s!=null&&(o.interval=s),l!=null&&(o.label=l)}return n}function UC(e,t){const{x:n,y:r,fx:i,fy:o}=e,a=i||o?td(t):t;i&&Dp(i,a),o&&Fp(o,a);const s=i||o?j_(e,t):t;n&&Dp(n,s),r&&Fp(r,s)}function qC(e=[],t){let n;for(const{label:r}of e)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!di(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function HC(e){return Math.sign(Wi(e.domain()))*Math.sign(Wi(e.range()))}function td(e){const{marginTop:t,marginRight:n,marginBottom:r,marginLeft:i,width:o,height:a,facet:{marginTop:s,marginRight:l,marginBottom:u,marginLeft:c}}=e;return{marginTop:Math.max(t,s),marginRight:Math.max(n,l),marginBottom:Math.max(r,u),marginLeft:Math.max(i,c),width:o,height:a}}function j_({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:s,height:l}=td(n);return{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:e?e.scale.bandwidth()+a+i:s,height:t?t.scale.bandwidth()+r+o:l,facet:{width:s,height:l}}}function Dp(e,t){if(e.range===void 0){const{insetLeft:n,insetRight:r}=e,{width:i,marginLeft:o=0,marginRight:a=0}=t,s=o+n,l=i-a-r;e.range=[s,Math.max(s,l)],di(e)||(e.range=Z_(e)),e.scale.range(e.range)}K_(e)}function Fp(e,t){if(e.range===void 0){const{insetTop:n,insetBottom:r}=e,{height:i,marginTop:o=0,marginBottom:a=0}=t,s=o+n,l=i-a-r;e.range=[Math.max(s,l),s],di(e)?e.range.reverse():e.range=Z_(e),e.scale.range(e.range)}K_(e)}function K_(e){e.round===void 0&&WC(e)&&zC(e)<=30&&e.scale.round(!0)}function zC({scale:e}){const t=e.domain().length,[n,r]=e.range(),i=e.paddingInner?e.paddingInner():1,o=e.paddingOuter?e.paddingOuter():e.padding(),a=t-i,s=Math.abs(r-n)/Math.max(1,a+o*2);return(s-Math.floor(s))*a}function Z_(e){const t=e.scale.domain().length+Q_(e);if(!(t>2))return e.range;const[n,r]=e.range;return Array.from({length:t},(i,o)=>n+o/(t-1)*(r-n))}function VC(e,t=[],n={}){const r=YC(e,t,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&e!=="fx"&&e!=="fy"&&di({type:r})){const i=t.map(({value:o})=>o).filter(o=>o!==void 0);i.some(sn)?wr(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${wi(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${wi(r)}".`):i.some(cA)?wr(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${wi(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${wi(r)}".`):i.some(fA)&&wr(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${wi(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${wi(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=vs(t,n,vr);break;case"identity":switch(et.get(e)){case In:n=vs(t,n,vr);break;case vu:n=vs(t,n,XC);break}break;case"utc":case"time":n=vs(t,n,rA);break}switch(r){case"diverging":return xC(e,t,n);case"diverging-sqrt":return AC(e,t,n);case"diverging-pow":return z_(e,t,n);case"diverging-log":return CC(e,t,n);case"diverging-symlog":return PC(e,t,n);case"categorical":case"ordinal":case Za:return RC(e,t,n);case"cyclical":case"sequential":case"linear":return hC(e,t,n);case"sqrt":return dC(e,t,n);case"threshold":return Jh(e,t,n);case"quantile":return bC(e,t,n);case"quantize":return gC(e,t,n);case"pow":return q_(e,t,n);case"log":return mC(e,t,n);case"symlog":return pC(e,t,n);case"utc":return FC(e,t,n);case"time":return DC(e,t,n);case"point":return BC(e,t,n);case"band":return OC(e,t,n);case"identity":return _C(e);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function wi(e){return typeof e=="symbol"?e.description:e}function Rp(e){return typeof e=="string"?`${e}`.toLowerCase():e}const Bp={toString:()=>"projection"};function YC(e,t,{type:n,domain:r,range:i,scheme:o,pivot:a,projection:s}){if(n=Rp(n),e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&s!=null&&(n=Bp);for(const u of t){const c=Rp(u.type);if(c!==void 0){if(n===void 0)n=c;else if(n!==c)throw new Error(`scale incompatible with channel: ${n} !== ${c}`)}}if(n===Bp)return;if(n!==void 0)return n;if(r===void 0&&!t.some(({value:u})=>u!==void 0))return;const l=et.get(e);if(l===Wa)return"sqrt";if(l===ja||l===Xa)return"linear";if(l===vu)return"ordinal";if((r||i||[]).length>2)return dc(l);if(r!==void 0){if(vp(r))return dc(l);if(sn(r))return"utc"}else{const u=t.map(({value:c})=>c).filter(c=>c!==void 0);if(u.some(vp))return dc(l);if(u.some(sn))return"utc"}if(l===hr){if(a!=null||cC(o))return"diverging";if(sC(o))return"categorical"}return"linear"}function dc(e){switch(e){case In:return"point";case hr:return Za;default:return"ordinal"}}function di({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===Za}function Q_({type:e}){return e==="threshold"}function WC({type:e}){return e==="point"||e==="band"}function Nr(e){if(e===void 0)return!0;const t=e.domain(),n=e(t[0]);for(let r=1,i=t.length;r<i;++r)if(e(t[r])-n)return!1;return!0}function vs(e,{domain:t,...n},r){var i;for(const o of e)o.value!==void 0&&(t===void 0&&(t=(i=o.value)==null?void 0:i.domain),o.value=r(o.value));return{domain:t===void 0?t:r(t),...n}}function XC(e){return pt(e,Xh)}function jC(e){return t=>{if(!et.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return e[t]}}function KC({scale:e,type:t,domain:n,range:r,interpolate:i,interval:o,transform:a,percent:s,pivot:l}){if(t==="identity")return{type:"identity",apply:c=>c,invert:c=>c};const u=e.unknown?e.unknown():void 0;return{type:t,domain:ca(n),...r!==void 0&&{range:ca(r)},...a!==void 0&&{transform:a},...s&&{percent:s},...u!==void 0&&{unknown:u},...o!==void 0&&{interval:o},...i!==void 0&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...l!==void 0&&{pivot:l,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:c=>e(c),...e.invert&&{invert:c=>e.invert(c)}}}function ZC(e){let t,n;return(...r)=>(((n==null?void 0:n.length)!==r.length||n.some((i,o)=>i!==r[o]))&&(n=r,t=e(...r)),t)}const QC=ZC(e=>new Intl.NumberFormat(e));function JC(e="en-US"){const t=QC(e);return n=>n!=null&&!isNaN(n)?t.format(n):void 0}function eP(e){return zx(e,"Invalid Date")}function tP(e="en-US"){const t=JC(e);return n=>(n instanceof Date?eP:typeof n=="number"?t:At)(n)}const ii=tP(),It=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let nP=0;function Op(){return`plot-clip-${++nP}`}function rP(e,{title:t,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:s,fillOpacity:l,stroke:u,strokeWidth:c,strokeOpacity:h,strokeLinejoin:f,strokeLinecap:d,strokeMiterlimit:m,strokeDasharray:b,strokeDashoffset:g,opacity:E,mixBlendMode:_,imageFilter:y,paintOrder:v,pointerEvents:x,shapeRendering:w,channels:M},{ariaLabel:C,fill:S="currentColor",fillOpacity:N,stroke:$="none",strokeOpacity:T,strokeWidth:L,strokeLinecap:D,strokeLinejoin:I,strokeMiterlimit:V,paintOrder:W}){S===null&&(s=null,l=null),$===null&&(u=null,h=null),Tt(S)?!Tt($)&&(!Tt(s)||M!=null&&M.fill)&&($="none"):Tt($)&&(!Tt(u)||M!=null&&M.stroke)&&(S="none");const[U,Y]=lr(s,S),[k,B]=Ct(l,N),[G,X]=lr(u,$),[Z,ie]=Ct(h,T),[ee,j]=Ct(E);fa(X)||(c===void 0&&(c=L),d===void 0&&(d=D),f===void 0&&(f=I),m===void 0&&!pA(f)&&(m=V),!fa(Y)&&v===void 0&&(v=W));const[J,F]=Ct(c);return S!==null&&(e.fill=yt(Y,"currentColor"),e.fillOpacity=Eo(B,1)),$!==null&&(e.stroke=yt(X,"none"),e.strokeWidth=Eo(F,1),e.strokeOpacity=Eo(ie,1),e.strokeLinejoin=yt(f,"miter"),e.strokeLinecap=yt(d,"butt"),e.strokeMiterlimit=Eo(m,4),e.strokeDasharray=yt(b,"none"),e.strokeDashoffset=yt(g,"0")),e.target=At(a),e.ariaLabel=At(C),e.ariaDescription=At(i),e.ariaHidden=At(o),e.opacity=Eo(j,1),e.mixBlendMode=yt(_,"normal"),e.imageFilter=yt(y,"none"),e.paintOrder=yt(v,"normal"),e.pointerEvents=yt(x,"auto"),e.shapeRendering=yt(w,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:U,scale:"auto",optional:!0},fillOpacity:{value:k,scale:"auto",optional:!0},stroke:{value:G,scale:"auto",optional:!0},strokeOpacity:{value:Z,scale:"auto",optional:!0},strokeWidth:{value:J,optional:!0},opacity:{value:ee,scale:"auto",optional:!0}}}function iP(e,t){t&&e.filter(n=>Oh(t[n])).append("title").call(aP,t)}function oP(e,t){t&&e.filter(([n])=>Oh(t[n])).append("title").call(sP,t)}function aP(e,t){t&&e.text(n=>ii(t[n]))}function sP(e,t){t&&e.text(([n])=>ii(t[n]))}function dr(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:s,strokeOpacity:l,strokeWidth:u,opacity:c,href:h}){r&&ye(e,"aria-label",f=>r[f]),o&&ye(e,"fill",f=>o[f]),a&&ye(e,"fill-opacity",f=>a[f]),s&&ye(e,"stroke",f=>s[f]),l&&ye(e,"stroke-opacity",f=>l[f]),u&&ye(e,"stroke-width",f=>u[f]),c&&ye(e,"opacity",f=>c[f]),h&&J_(e,f=>h[f],t),n||iP(e,i)}function lP(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:s,strokeOpacity:l,strokeWidth:u,opacity:c,href:h}){r&&ye(e,"aria-label",([f])=>r[f]),o&&ye(e,"fill",([f])=>o[f]),a&&ye(e,"fill-opacity",([f])=>a[f]),s&&ye(e,"stroke",([f])=>s[f]),l&&ye(e,"stroke-opacity",([f])=>l[f]),u&&ye(e,"stroke-width",([f])=>u[f]),c&&ye(e,"opacity",([f])=>c[f]),h&&J_(e,([f])=>h[f],t),n||oP(e,i)}function uP({ariaLabel:e,title:t,fill:n,fillOpacity:r,stroke:i,strokeOpacity:o,strokeWidth:a,opacity:s,href:l},{tip:u}){return[e,u?void 0:t,n,r,i,o,a,s,l].filter(c=>c!==void 0)}function cP(e,t,n){const r=Ul(e,i=>t[i]);return n===void 0&&r.size>1+e.length>>1&&wr("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*fP(e,t,n,r){const{z:i}=n,{z:o}=r,a=uP(r,n),s=[...t,...a];for(const l of o?cP(e,o,i):[e]){let u,c;e:for(const h of l){for(const f of s)if(!Pr(f[h])){c&&c.push(-1);continue e}if(u===void 0){c&&(yield c),u=a.map(f=>Hr(f[h])),c=[h];continue}c.push(h);for(let f=0;f<a.length;++f)if(Hr(a[f][h])!==u[f]){yield c,u=a.map(m=>Hr(m[h])),c=[h];continue e}}c&&(yield c)}}function hP(e,t,n,r){let i;const{clip:o=r.clip}=t;switch(o){case"frame":{const{width:a,height:s,marginLeft:l,marginRight:u,marginTop:c,marginBottom:h}=n,f=Op();i=`url(#${f})`,e=ut("svg:g",r).call(d=>d.append("svg:clipPath").attr("id",f).append("rect").attr("x",l).attr("y",c).attr("width",a-u-l).attr("height",s-c-h)).each(function(){this.appendChild(e.node()),e.node=()=>this});break}case"sphere":{const{projection:a}=r;if(!a)throw new Error('the "sphere" clip option requires a projection');const s=Op();i=`url(#${s})`,e.append("clipPath").attr("id",s).append("path").attr("d",Kl(a)({type:"Sphere"}));break}}ye(e,"aria-label",t.ariaLabel),ye(e,"aria-description",t.ariaDescription),ye(e,"aria-hidden",t.ariaHidden),ye(e,"clip-path",i)}function xn(e,t,n,r){hP(e,t,n,r),ye(e,"fill",t.fill),ye(e,"fill-opacity",t.fillOpacity),ye(e,"stroke",t.stroke),ye(e,"stroke-width",t.strokeWidth),ye(e,"stroke-opacity",t.strokeOpacity),ye(e,"stroke-linejoin",t.strokeLinejoin),ye(e,"stroke-linecap",t.strokeLinecap),ye(e,"stroke-miterlimit",t.strokeMiterlimit),ye(e,"stroke-dasharray",t.strokeDasharray),ye(e,"stroke-dashoffset",t.strokeDashoffset),ye(e,"shape-rendering",t.shapeRendering),ye(e,"filter",t.imageFilter),ye(e,"paint-order",t.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=t;ye(e,"pointer-events",i)}function An(e,t){dP(e,"mix-blend-mode",t.mixBlendMode),ye(e,"opacity",t.opacity)}function J_(e,t,n){e.each(function(r){const i=t(r);if(i!=null){const o=this.ownerDocument.createElementNS(Bi.svg,"a");o.setAttribute("fill","inherit"),o.setAttributeNS(Bi.xlink,"href",i),n!=null&&o.setAttribute("target",n),this.parentNode.insertBefore(o,this).appendChild(this)}})}function ye(e,t,n){n!=null&&e.attr(t,n)}function dP(e,t,n){n!=null&&e.style(t,n)}function Xt(e,t,{x:n,y:r},i=It,o=It){i+=t.dx,o+=t.dy,n!=null&&n.bandwidth&&(i+=n.bandwidth()/2),r!=null&&r.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&e.attr("transform",`translate(${i},${o})`)}function yt(e,t){if((e=At(e))!==t)return e}function Eo(e,t){if((e=Ke(e))!==t)return e}const mP=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function nd(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!mP.test(e))throw new Error(`invalid class name: ${e}`);return e}function rd(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const n of e)Object.assign(n.style,t)}function Qa({frameAnchor:e},{width:t,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(e)?a:/right$/.test(e)?t-i:(a+t-i)/2,/^top/.test(e)?r:/^bottom/.test(e)?n-o:(r+n-o)/2]}function pP(e,t,n={}){let r=.5-It,i=.5+It,o=.5+It,a=.5-It;for(const{marginTop:b,marginRight:g,marginBottom:E,marginLeft:_}of t)b>r&&(r=b),g>i&&(i=g),E>o&&(o=E),_>a&&(a=_);let{margin:s,marginTop:l=s!==void 0?s:r,marginRight:u=s!==void 0?s:i,marginBottom:c=s!==void 0?s:o,marginLeft:h=s!==void 0?s:a}=n;l=+l,u=+u,c=+c,h=+h;let{width:f=640,height:d=bP(e,n,{width:f,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:o,marginLeftDefault:a})+Math.max(0,l-r+c-o)}=n;f=+f,d=+d;const m={width:f,height:d,marginTop:l,marginRight:u,marginBottom:c,marginLeft:h};if(e.fx||e.fy){let{margin:b,marginTop:g=b!==void 0?b:l,marginRight:E=b!==void 0?b:u,marginBottom:_=b!==void 0?b:c,marginLeft:y=b!==void 0?b:h}=n.facet??{};g=+g,E=+E,_=+_,y=+y,m.facet={marginTop:g,marginRight:E,marginBottom:_,marginLeft:y}}return m}function bP({x:e,y:t,fy:n,fx:r},{projection:i,aspectRatio:o},{width:a,marginTopDefault:s,marginRightDefault:l,marginBottomDefault:u,marginLeftDefault:c}){const h=n?n.scale.domain().length:1,f=oC(i);if(f){const m=r?r.scale.domain().length:1,b=(1.1*h-.1)/(1.1*m-.1)*f,g=Math.max(.1,Math.min(10,b));return Math.round((a-c-l)*g+s+u)}const d=t?di(t)?t.scale.domain().length:Math.max(7,17/h):1;if(o!=null){if(o=+o,!(isFinite(o)&&o>0))throw new Error(`invalid aspectRatio: ${o}`);const m=Lp("y",t)/(Lp("x",e)*o),b=r?r.scale.bandwidth():1,g=n?n.scale.bandwidth():1,E=b*(a-c-l)-e.insetLeft-e.insetRight;return(m*E+t.insetTop+t.insetBottom)/g+s+u}return!!(t||n)*Math.max(1,Math.min(60,d*h))*20+!!r*30+60}function Lp(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:n,domain:r}=t;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const s=t.scale.exponent();i=l=>Math.pow(l,s);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${n}`)}const[o,a]=Ft(r);return Math.abs(i(a)-i(o))}function gP(e,t){const{fx:n,fy:r}=Df(e,t),i=n==null?void 0:n.scale.domain(),o=r==null?void 0:r.scale.domain();return i&&o?j3(i,o).map(([a,s],l)=>({x:a,y:s,i:l})):i?i.map((a,s)=>({x:a,i:s})):o?o.map((a,s)=>({y:a,i:s})):void 0}function yP(e,{x:t,y:n}){return t&&(t=Ff(t)),n&&(n=Ff(n)),e.filter(t&&n?r=>t.has(r.x)&&n.has(r.y):t?r=>t.has(r.x):r=>n.has(r.y)).sort(t&&n?(r,i)=>t.get(r.x)-t.get(i.x)||n.get(r.y)-n.get(i.y):t?(r,i)=>t.get(r.x)-t.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function id(e,{fx:t,fy:n}){const r=fr(e),i=t==null?void 0:t.value,o=n==null?void 0:n.value;return t&&n?Pi(r,a=>(a.fx=i[a[0]],a.fy=o[a[0]],a),a=>i[a],a=>o[a]):t?Pi(r,a=>(a.fx=i[a[0]],a),a=>i[a]):Pi(r,a=>(a.fy=o[a[0]],a),a=>o[a])}function _P(e,t,{marginTop:n,marginLeft:r}){return e&&t?({x:i,y:o})=>`translate(${e(i)-r},${t(o)-n})`:e?({x:i})=>`translate(${e(i)-r},0)`:({y:i})=>`translate(0,${t(i)-n})`}function vP(e){const t=[],n=new Uint32Array(Mr(e,r=>r.length));for(const r of e){let i=0;for(const o of e)r!==o&&(n.set(o,i),i+=o.length);t.push(n.slice(0,i))}return t}const wP=new Map([["top",mc],["right",gc],["bottom",pc],["left",bc],["top-left",ws(mc,bc)],["top-right",ws(mc,gc)],["bottom-left",ws(pc,bc)],["bottom-right",ws(pc,gc)],["top-empty",SP],["right-empty",CP],["bottom-empty",xP],["left-empty",AP],["empty",PP]]);function MP(e){if(e==null)return null;const t=wP.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const Gp=new WeakMap;function Ff(e){let t=Gp.get(e);return t||Gp.set(e,t=new Zr(pt(e,(n,r)=>[n,r]))),t}function Dr(e,t){return Ff(e).get(t)}function EP(e,t,n){return t=Hr(t),n=Hr(n),e.find(r=>Object.is(Hr(r.x),t)&&Object.is(Hr(r.y),n))}function Su(e,t,n){var r;return(r=EP(e,t,n))==null?void 0:r.empty}function mc(e,{y:t},{y:n}){return t?Dr(t,n)===0:!0}function pc(e,{y:t},{y:n}){return t?Dr(t,n)===t.length-1:!0}function bc(e,{x:t},{x:n}){return t?Dr(t,n)===0:!0}function gc(e,{x:t},{x:n}){return t?Dr(t,n)===t.length-1:!0}function SP(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=Dr(t,r);if(o>0)return Su(e,n,t[o-1])}function xP(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=Dr(t,r);if(o<t.length-1)return Su(e,n,t[o+1])}function AP(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=Dr(t,n);if(o>0)return Su(e,t[o-1],r)}function CP(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const o=Dr(t,n);if(o<t.length-1)return Su(e,t[o+1],r)}function PP(e,t,{empty:n}){return n}function ws(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function yc(e,{channels:{fx:t,fy:n},groups:r}){return t&&n?e.map(({x:i,y:o})=>{var a;return((a=r.get(i))==null?void 0:a.get(o))??[]}):t?e.map(({x:i})=>r.get(i)??[]):e.map(({y:i})=>r.get(i)??[])}class Gt{constructor(t,n={},r={},i){const{facet:o="auto",facetAnchor:a,fx:s,fy:l,sort:u,dx:c=0,dy:h=0,margin:f=0,marginTop:d=f,marginRight:m=f,marginBottom:b=f,marginLeft:g=f,clip:E=i==null?void 0:i.clip,channels:_,tip:y,render:v}=r;if(this.data=t,this.sort=Xi(u)?u:null,this.initializer=ji(r).initializer,this.transform=this.initializer?r.transform:wu(r).transform,o===null||o===!1?this.facet=null:(this.facet=Sn(o===!0?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===Rs&&typeof s=="string"?[s]:s,this.fy=t===Rs&&typeof l=="string"?[l]:l),this.facetAnchor=MP(a),n=__(n),_!==void 0&&(n={...NP(_),...n}),i!==void 0&&(n={...rP(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([x,w])=>{if(bu(w.value)){const{value:M,label:C=w.label,scale:S=w.scale}=w.value;w={...w,label:C,scale:S,value:M}}if(t===Rs&&typeof w.value=="string"){const{value:M}=w;w={...w,value:[M]}}return[x,w]}).filter(([x,{value:w,optional:M}])=>{if(w!=null)return!0;if(M)return!1;throw new Error(`missing channel value: ${x}`)})),this.dx=+c,this.dy=+h,this.marginTop=+d,this.marginRight=+m,this.marginBottom=+b,this.marginLeft=+g,this.clip=v_(E),this.tip=$P(y),this.facet==="super"){if(s||l)throw new Error("super-faceting cannot use fx or fy");for(const x in this.channels){const{scale:w}=n[x];if(!(w!=="x"&&w!=="y"))throw new Error("super-faceting cannot use x or y")}}v!=null&&(this.render=tv(v,this.render))}initialize(t,n,r){let i=Wt(this.data);t===void 0&&i!=null&&(t=[fr(i)]);const o=t;this.transform!=null&&({facets:t,data:i}=this.transform(i,t,r),i=Wt(i)),t!==void 0&&(t.original=o);const a=WA(this.channels,i);return this.sort!=null&&jA(i,t,a,n,this.sort),{data:i,facets:t,channels:a}}filter(t,n,r){for(const i in n){const{filter:o=Pr}=n[i];if(o!==null){const a=r[i];t=t.filter(s=>o(a[s]))}}return t}project(t,n,r){for(const i in t)if(t[i].scale==="x"&&/^x|x$/.test(i)){const o=i.replace(/^x|x$/,"y");o in t&&t[o].scale==="y"&&rC(i,o,n,r.projection)}}scale(t,n,r){const i=XA(t,n);return r.projection&&this.project(t,i,r),i}}function ev(...e){return e.plot=Gt.prototype.plot,e}function tv(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(n,r,i,o,a,s){return e.call(this,n,r,i,o,a,(l,u,c,h,f)=>t.call(this,l,u,c,h,f,s))}}function NP(e){return Object.fromEntries(Object.entries(__(e)).map(([t,n])=>(n=typeof n=="string"?{value:n,label:t}:gu(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[t,n])))}function $P(e){return e===!0?"xy":e===!1||e==null?null:typeof e=="string"?Sn(e,"tip",["x","y","xy"]):e}function xu(e,t){return(e==null?void 0:e.tip)===!0?{...e,tip:t}:Ir(e==null?void 0:e.tip)&&e.tip.pointer===void 0?{...e,tip:{...e.tip,pointer:t}}:e}const Up=new WeakMap;function od(e,t,{x:n,y:r,px:i,py:o,maxRadius:a=40,channels:s,render:l,...u}={}){return a=+a,i!=null&&(n??(n=null),s={...s,px:{value:i,scale:"x"}}),o!=null&&(r??(r=null),s={...s,py:{value:o,scale:"y"}}),{x:n,y:r,channels:s,...u,render:tv(function(c,h,f,d,m,b){m={...m,pointerSticky:!1};const g=m.ownerSVGElement,{data:E}=m.getMarkState(this);let _=Up.get(g);_||Up.set(g,_={sticky:!1,roots:[],renders:[]});let y=_.renders.push(X)-1;const{x:v,y:x,fx:w,fy:M}=h;let C=w?w(c.fx)-d.marginLeft:0,S=M?M(c.fy)-d.marginTop:0;v!=null&&v.bandwidth&&(C+=v.bandwidth()/2),x!=null&&x.bandwidth&&(S+=x.bandwidth()/2);const N=c.fi!=null;let $;if(N){let j=_.facetStates;j||(_.facetStates=j=new Map),$=j.get(this),$||j.set(this,$=new Map)}const[T,L]=Qa(this,d),{px:D,py:I}=f,V=D?j=>D[j]:nv(f,T),W=I?j=>I[j]:rv(f,L);let U,Y,k,B;function G(j,J){if(N)if(B&&(B=cancelAnimationFrame(B)),j==null)$.delete(c.fi);else{$.set(c.fi,J),B=requestAnimationFrame(()=>{B=null;for(const[F,ne]of $)if(ne<J||ne===J&&F<c.fi){j=null;break}X(j)});return}X(j)}function X(j){if(U===j&&k===_.sticky)return;U=j,k=m.pointerSticky=_.sticky;const J=U==null?[]:[U];N&&(J.fx=c.fx,J.fy=c.fy,J.fi=c.fi);const F=b(J,h,f,d,m);if(Y){if(N){const ne=Y.parentNode,re=Y.getAttribute("transform"),q=F.getAttribute("transform");re?F.setAttribute("transform",re):F.removeAttribute("transform"),q?ne.setAttribute("transform",q):ne.removeAttribute("transform"),F.removeAttribute("aria-label"),F.removeAttribute("aria-description"),F.removeAttribute("aria-hidden")}Y.replaceWith(F)}return _.roots[y]=Y=F,U==null&&($==null?void 0:$.size)>1||m.dispatchValue(U==null?null:E[U]),F}function Z(j){if(_.sticky||j.pointerType==="mouse"&&j.buttons===1)return;let[J,F]=i4(j);J-=C,F-=S;const ne=J<d.marginLeft||J>d.width-d.marginRight?1:e,re=F<d.marginTop||F>d.height-d.marginBottom?1:t;let q=null,ce=a*a;for(const H of c){const ue=ne*(V(H)-J),ae=re*(W(H)-F),he=ue*ue+ae*ae;he<=ce&&(q=H,ce=he)}if(q!=null&&(e!==1||t!==1)){const H=V(q)-J,ue=W(q)-F;ce=H*H+ue*ue}G(q,ce)}function ie(j){j.pointerType==="mouse"&&U!=null&&(_.sticky&&_.roots.some(J=>J==null?void 0:J.contains(j.target))||(_.sticky?(_.sticky=!1,_.renders.forEach(J=>J(null))):(_.sticky=!0,X(U)),j.stopImmediatePropagation()))}function ee(j){j.pointerType==="mouse"&&(_.sticky||G(null))}return g.addEventListener("pointerenter",Z),g.addEventListener("pointermove",Z),g.addEventListener("pointerdown",ie),g.addEventListener("pointerleave",ee),X(null)},l)}}function TP(e){return od(1,1,e)}function kP(e){return od(1,.01,e)}function qp(e){return od(.01,1,e)}function nv({x1:e,x2:t,x:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function rv({y1:e,y2:t,y:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function iv(e){return di(e)&&e.interval===void 0?void 0:"tabular-nums"}function IP(e,t){let{label:n=e.label,tickSize:r=6,width:i=240,height:o=44+r,marginTop:a=18,marginRight:s=0,marginBottom:l=16+r,marginLeft:u=0,style:c,ticks:h=(i-u-s)/64,tickFormat:f,fontVariant:d=iv(e),round:m=!0,opacity:b,className:g}=t;const E=Zh(t);g=nd(g),b=Ct(b)[1],f===null&&(f=()=>null);const _=ut("svg",E).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).call(T=>T.append("style").text(`:where(.${g}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${g}-ramp text) {
  white-space: pre;
}`)).call(rd,c);let y=T=>T.selectAll(".tick line").attr("y1",a+l-o),v;const x=m?(T,L)=>T.rangeRound(L):(T,L)=>T.range(L),{type:w,domain:M,range:C,interpolate:S,scale:N,pivot:$}=e;if(S){const T=C===void 0?S:Wl(S.length===1?ed(S):S,C);v=x(N.copy(),gn(wt(u,i-s),Math.min(M.length+($!==void 0),C===void 0?1/0:C.length)));const L=256,D=E.document.createElement("canvas");D.width=L,D.height=1;const I=D.getContext("2d");for(let V=0,W=L-1;V<L;++V)I.fillStyle=T(V/W),I.fillRect(V,0,1,1);_.append("image").attr("opacity",b).attr("x",u).attr("y",a).attr("width",i-u-s).attr("height",o-a-l).attr("preserveAspectRatio","none").attr("xlink:href",D.toDataURL())}else if(w==="threshold"){const T=M,L=f===void 0?D=>D:typeof f=="string"?ro(f):f;v=x(vh().domain([-1,C.length-1]),[u,i-s]),_.append("g").attr("fill-opacity",b).selectAll().data(C).enter().append("rect").attr("x",(D,I)=>v(I-1)).attr("y",a).attr("width",(D,I)=>v(I)-v(I-1)).attr("height",o-a-l).attr("fill",D=>D),h=pt(T,(D,I)=>I),f=D=>L(T[D],D)}else v=x(eu().domain(M),[u,i-s]),_.append("g").attr("fill-opacity",b).selectAll().data(M).enter().append("rect").attr("x",v).attr("y",a).attr("width",Math.max(0,v.bandwidth()-1)).attr("height",o-a-l).attr("fill",N),y=()=>{};return _.append("g").attr("transform",`translate(0,${o-l})`).call(w5(v).ticks(Array.isArray(h)?null:h,typeof f=="string"?f:void 0).tickFormat(typeof f=="function"?f:void 0).tickSize(r).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",yt(d,"normal")).call(y).call(T=>T.select(".domain").remove()),n!==void 0&&_.append("text").attr("x",u).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),_.node()}const ov=Math.PI/180;function Ja(e,{marker:t,markerStart:n=t,markerMid:r=t,markerEnd:i=t}={}){e.markerStart=_c(n),e.markerMid=_c(r),e.markerEnd=_c(i)}function _c(e){if(e==null||e===!1)return null;if(e===!0)return zp;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return Hp("auto");case"arrow-reverse":return Hp("auto-start-reverse");case"dot":return DP;case"circle":case"circle-fill":return zp;case"circle-stroke":return FP;case"tick":return vc("auto");case"tick-x":return vc(90);case"tick-y":return vc(0)}throw new Error(`invalid marker: ${e}`)}function Hp(e){return(t,n)=>ut("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function DP(e,t){return ut("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function zp(e,t){return ut("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function FP(e,t){return ut("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function vc(e){return(t,n)=>ut("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let RP=0;function Au(e,t,{stroke:n},r){return av(e,t,n&&(i=>n[i]),r)}function BP(e,t,{stroke:n},r){return av(e,t,n&&(([i])=>n[i]),r)}function av(e,{markerStart:t,markerMid:n,markerEnd:r,stroke:i},o=()=>i,a){const s=new Map;function l(u){return function(c){const h=o(c);let f=s.get(u);f||s.set(u,f=new Map);let d=f.get(h);if(!d){const m=this.parentNode.insertBefore(u(h,a),this),b=`plot-marker-${++RP}`;m.setAttribute("id",b),f.set(h,d=`url(#${b})`)}return d}}t&&e.attr("marker-start",l(t)),n&&e.attr("marker-mid",l(n)),r&&e.attr("marker-end",l(r))}function sv({inset:e,insetLeft:t,insetRight:n,...r}={}){return[t,n]=uv(e,t,n),{inset:e,insetLeft:t,insetRight:n,...r}}function lv({inset:e,insetTop:t,insetBottom:n,...r}={}){return[t,n]=uv(e,t,n),{inset:e,insetTop:t,insetBottom:n,...r}}function uv(e,t,n){return e===void 0&&t===void 0&&n===void 0?It?[1,0]:[.5,.5]:[t,n]}function cv(e,{interval:t}){return e={...gu(e)},e.interval=Vh(e.interval===void 0?t:e.interval),e}function fv(e,t,n,r){const{[e]:i,[`${e}1`]:o,[`${e}2`]:a}=n,{value:s,interval:l}=cv(i,n);if(s==null||l==null&&!r)return n;const u=so(i);if(l==null){let d;const m={transform:b=>d||(d=dt(b,s)),label:u};return{...n,[e]:void 0,[`${e}1`]:o===void 0?m:o,[`${e}2`]:a===void 0&&!(o===a&&r)?m:a}}let c,h;function f(d){return h!==void 0&&d===c?h:h=pt(dt(c=d,s),m=>l.floor(m))}return t({...n,[e]:void 0,[`${e}1`]:o===void 0?{transform:f,label:u}:o,[`${e}2`]:a===void 0?{transform:d=>f(d).map(m=>l.offset(m)),label:u}:a})}function hv(e,t,n){const{[e]:r}=n,{value:i,interval:o}=cv(r,n);return i==null||o==null?n:t({...n,[e]:{label:so(r),transform:a=>{const s=pt(dt(a,i),u=>o.floor(u)),l=s.map(u=>o.offset(u));return s.map(sn(s)?(u,c)=>u==null||isNaN(u=+u)||(c=l[c],c==null)||isNaN(c=+c)?void 0:new Date((u+c)/2):(u,c)=>u==null||(c=l[c],c==null)?NaN:(+u+ +c)/2)}}})}function dv(e={}){return fv("x",sv,e)}function mv(e={}){return fv("y",lv,e)}function OP(e={}){return hv("x",sv,e)}function LP(e={}){return hv("y",lv,e)}const pv={ariaLabel:"rule",fill:null,stroke:"currentColor"};class GP extends Gt{constructor(t,n={}){const{x:r,y1:i,y2:o,inset:a=0,insetTop:s=a,insetBottom:l=a}=n;super(t,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},xu(n,"x"),pv),this.insetTop=Ke(s),this.insetBottom=Ke(l),Ja(this,n)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y1:u,y2:c}=r,{width:h,height:f,marginTop:d,marginRight:m,marginLeft:b,marginBottom:g}=i,{insetTop:E,insetBottom:_}=this;return ut("svg:g",o).call(xn,this,i,o).call(Xt,this,{x:l&&a},It,0).call(y=>y.selectAll().data(t).enter().append("line").call(An,this).attr("x1",l?v=>l[v]:(b+h-m)/2).attr("x2",l?v=>l[v]:(b+h-m)/2).attr("y1",u&&!Nr(s)?v=>u[v]+E:d+E).attr("y2",c&&!Nr(s)?s.bandwidth?v=>c[v]+s.bandwidth()-_:v=>c[v]-_:f-g-_).call(dr,this,r).call(Au,this,r,o)).node()}}class UP extends Gt{constructor(t,n={}){const{x1:r,x2:i,y:o,inset:a=0,insetRight:s=a,insetLeft:l=a}=n;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},xu(n,"y"),pv),this.insetRight=Ke(s),this.insetLeft=Ke(l),Ja(this,n)}render(t,n,r,i,o){const{x:a,y:s}=n,{y:l,x1:u,x2:c}=r,{width:h,height:f,marginTop:d,marginRight:m,marginLeft:b,marginBottom:g}=i,{insetLeft:E,insetRight:_}=this;return ut("svg:g",o).call(xn,this,i,o).call(Xt,this,{y:l&&s},0,It).call(y=>y.selectAll().data(t).enter().append("line").call(An,this).attr("x1",u&&!Nr(a)?v=>u[v]+E:b+E).attr("x2",c&&!Nr(a)?a.bandwidth?v=>c[v]+a.bandwidth()-_:v=>c[v]-_:h-m-_).attr("y1",l?v=>l[v]:(d+f-g)/2).attr("y2",l?v=>l[v]:(d+f-g)/2).call(dr,this,r).call(Au,this,r,o)).node()}}function Pt(e,t){let{x:n=vt,y:r,y1:i,y2:o,...a}=mv(t);return[i,o]=bv(r,i,o),new GP(e,{...a,x:n,y1:i,y2:o})}function Et(e,t){let{y:n=vt,x:r,x1:i,x2:o,...a}=dv(t);return[i,o]=bv(r,i,o),new UP(e,{...a,y:n,x1:i,x2:o})}function bv(e,t,n){if(e==null){if(t===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,t]}else{if(t===void 0)return n===void 0?[0,e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}function ad(e,...t){let n=t.length;for(let r=0,i=!0;r<n;++r)typeof t[r]!="function"&&(i&&(e=e.slice(),i=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--n);return r=>{let i=e[0];for(let o=0;o<n;++o)i+=t[o](r)+e[o+1];return i}}const qP={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},gv="­";class sd extends Gt{constructor(t,n={}){const{x:r,y:i,text:o=hi(t)&&y_(t)?vt:qh,frameAnchor:a,textAnchor:s=/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle",lineAnchor:l=/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle",lineHeight:u=1,lineWidth:c=1/0,textOverflow:h,monospace:f,fontFamily:d=f?"ui-monospace, monospace":void 0,fontSize:m,fontStyle:b,fontVariant:g,fontWeight:E,rotate:_}=n,[y,v]=Ct(_,0),[x,w]=XP(m);if(super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:x,optional:!0},rotate:{value:uA(y),optional:!0},text:{value:o,filter:Oh,optional:!0}},n,qP),this.rotate=v,this.textAnchor=yt(s,"middle"),this.lineAnchor=Sn(l,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+u,this.lineWidth=+c,this.textOverflow=yv(h),this.monospace=!!f,this.fontFamily=At(d),this.fontSize=w,this.fontStyle=At(b),this.fontVariant=At(g),this.fontWeight=At(E),this.frameAnchor=_u(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${c}`);this.splitLines=vv(this),this.clipLine=wv(this)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:u,rotate:c,text:h,title:f,fontSize:d}=r,{rotate:m}=this,[b,g]=Qa(this,i);return ut("svg:g",o).call(xn,this,i,o).call(_v,this,h,i).call(Xt,this,{x:l&&a,y:u&&s}).call(E=>E.selectAll().data(t).enter().append("text").call(An,this).call(HP,this,h,f).attr("transform",ad`translate(${l?_=>l[_]:b},${u?_=>u[_]:g})${c?_=>` rotate(${c[_]})`:m?` rotate(${m})`:""}`).call(ye,"font-size",d&&(_=>d[_])).call(dr,this,r)).node()}}function yv(e){return e==null?null:Sn(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function HP(e,t,n,r){if(!n)return;const{lineAnchor:i,lineHeight:o,textOverflow:a,splitLines:s,clipLine:l}=t;e.each(function(u){const c=s(ii(n[u])??"").map(l),h=c.length,f=i==="top"?.71:i==="bottom"?1-h:(164-h*100)/200;if(h>1){let d=0;for(let m=0;m<h;++m){if(++d,!c[m])continue;const b=this.ownerDocument.createElementNS(Bi.svg,"tspan");b.setAttribute("x",0),m===d-1?b.setAttribute("y",`${(f+m)*o}em`):b.setAttribute("dy",`${d*o}em`),b.textContent=c[m],this.appendChild(b),d=0}}else f&&this.setAttribute("y",`${f*o}em`),this.textContent=c[0];if(a&&!r&&c[0]!==n[u]){const d=this.ownerDocument.createElementNS(Bi.svg,"title");d.textContent=n[u],this.appendChild(d)}})}function $r(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=ao(t,n)),new sd(e,{...r,x:t,y:n})}function zP(e,{x:t=vt,...n}={}){return new sd(e,LP({...n,x:t}))}function VP(e,{y:t=vt,...n}={}){return new sd(e,OP({...n,y:t}))}function _v(e,t,n){ye(e,"text-anchor",t.textAnchor),ye(e,"font-family",t.fontFamily),ye(e,"font-size",t.fontSize),ye(e,"font-style",t.fontStyle),ye(e,"font-variant",t.fontVariant===void 0?YP(n):t.fontVariant),ye(e,"font-weight",t.fontWeight)}function YP(e){return e&&(hA(e)||sn(e))?"tabular-nums":void 0}const WP=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function XP(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),WP.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function jP(e,t,n){const r=[];let i,o=0;for(const[a,s,l]of KP(e)){if(i===void 0&&(i=a),o>i&&n(e,i,s)>t&&(r.push(e.slice(i,o)+(e[o-1]===gv?"-":"")),i=a),l){r.push(e.slice(i,s)),i=void 0;continue}o=s}return r}function*KP(e){let t=0,n=0;const r=e.length;for(;n<r;){let i=1;switch(e[n]){case gv:case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];e[++n]===" ";);t=n;break;case"\r":e[n+1]===`
`&&++i;case`
`:yield[t,n,!0],n+=i,t=n;break;default:++n;break}}yield[t,n,!0]}const Vp={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function ld(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=lo(e,i))r+=Vp[e[i]]??(Ev(e,i)?120:Vp.e);return r}function ud(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=lo(e,i))r+=Ev(e,i)?126:63;return r}function vv({monospace:e,lineWidth:t,textOverflow:n}){if(n!=null||t==1/0)return o=>o.split(/\r\n?|\n/g);const r=e?ud:ld,i=t*100;return o=>jP(o,i,r)}function wv({monospace:e,lineWidth:t,textOverflow:n}){if(n==null||t==1/0)return o=>o;const r=e?ud:ld,i=t*100;switch(n){case"clip-start":return o=>Wp(o,i,r,"");case"clip-end":return o=>Yp(o,i,r,"");case"ellipsis-start":return o=>Wp(o,i,r,Ti);case"ellipsis-middle":return o=>ZP(o,i,r,Ti);case"ellipsis-end":return o=>Yp(o,i,r,Ti)}}const Ti="…";function Ki(e,t,n,r){const i=[];let o=0;for(let a=0,s=0,l=e.length;a<l;a=s){s=lo(e,a);const u=n(e,a,s);if(o+u>t){for(o+=r;o>t&&a>0;)s=a,a=i.pop(),o-=n(e,a,s);return[a,t-o]}o+=u,i.push(a)}return[-1,0]}function Yp(e,t,n,r){e=e.trim();const i=n(r),[o]=Ki(e,t,n,i);return o<0?e:e.slice(0,o).trimEnd()+r}function ZP(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const o=n(r)/2,[a,s]=Ki(e,t/2,n,o),[l]=Ki(e,i-t/2-s+o,n,-o);return l<0?r:e.slice(0,a).trimEnd()+r+e.slice(lo(e,l)).trimStart()}function Wp(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const o=n(r),[a]=Ki(e,i-t+o,n,-o);return a<0?r:r+e.slice(lo(e,a)).trimStart()}const Rf=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,Xp=new RegExp("\\p{Extended_Pictographic}","uy");function lo(e,t){return t+=QP(e,t)?2:1,eN(e,t)&&(t=Rf.lastIndex),JP(e,t)?lo(e,t+1):t}function Mv(e,t){return e.charCodeAt(t)<128}function QP(e,t){const n=e.charCodeAt(t);if(n>=55296&&n<56320){const r=e.charCodeAt(t+1);return r>=56320&&r<57344}return!1}function JP(e,t){return e.charCodeAt(t)===8205}function eN(e,t){return Mv(e,t)?!1:(Rf.lastIndex=t,Rf.test(e))}function Ev(e,t){return Mv(e,t)?!1:(Xp.lastIndex=t,Xp.test(e))}const tN={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Sv=3.5,nN=Sv*5,xv={draw(e,t,n){const r=t*n/nN;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},rN={draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}},iN=new Map([["arrow",xv],["spike",rN]]);function oN(e){return e&&typeof e.draw=="function"}function aN(e){if(oN(e))return e;const t=iN.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class Av extends Gt{constructor(t,n={}){const{x:r,y:i,r:o=Sv,length:a,rotate:s,shape:l=xv,anchor:u="middle",frameAnchor:c}=n,[h,f]=Ct(a,12),[d,m]=Ct(s,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:h,scale:"length",optional:!0},rotate:{value:d,optional:!0}},n,tN),this.r=+o,this.length=f,this.rotate=m,this.shape=aN(l),this.anchor=Sn(u,"anchor",["start","middle","end"]),this.frameAnchor=_u(c)}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:u,length:c,rotate:h}=r,{length:f,rotate:d,anchor:m,shape:b,r:g}=this,[E,_]=Qa(this,i);return ut("svg:g",o).call(xn,this,i,o).call(Xt,this,{x:l&&a,y:u&&s}).call(y=>y.selectAll().data(t).enter().append("path").call(An,this).attr("transform",ad`translate(${l?v=>l[v]:E},${u?v=>u[v]:_})${h?v=>` rotate(${h[v]})`:d?` rotate(${d})`:""}${m==="start"?"":m==="end"?c?v=>` translate(0,${c[v]})`:` translate(0,${f})`:c?v=>` translate(0,${c[v]/2})`:` translate(0,${f/2})`}`).attr("d",c?v=>{const x=gr();return b.draw(x,c[v],g),x}:(()=>{const v=gr();return b.draw(v,f,g),v})()).call(dr,this,r)).node()}}function sN(e,t={}){const{x:n=vt,...r}=t;return new Av(e,{...r,x:n})}function lN(e,t={}){const{y:n=vt,...r}=t;return new Av(e,{...r,y:n})}function Fr(e,t){return arguments.length<2&&!hi(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function Cu({anchor:e}={},t){return e===void 0?t[0]:Sn(e,"anchor",t)}function Cv(e){return Cu(e,["left","right"])}function Pv(e){return Cu(e,["right","left"])}function Nv(e){return Cu(e,["bottom","top"])}function $v(e){return Cu(e,["top","bottom"])}function Tv(){const[e,t]=Fr(...arguments);return Iv("y",Cv(t),e,t)}function uN(){const[e,t]=Fr(...arguments);return Iv("fy",Pv(t),e,t)}function kv(){const[e,t]=Fr(...arguments);return Dv("x",Nv(t),e,t)}function cN(){const[e,t]=Fr(...arguments);return Dv("fx",$v(t),e,t)}function Iv(e,t,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:s=1,fill:l=r,fillOpacity:u=i,textAnchor:c,textStroke:h,textStrokeOpacity:f,textStrokeWidth:d,tickSize:m=e==="y"?6:0,tickPadding:b,tickRotate:g,x:E,margin:_,marginTop:y=_===void 0?20:_,marginRight:v=_===void 0?t==="right"?40:0:_,marginBottom:x=_===void 0?20:_,marginLeft:w=_===void 0?t==="left"?40:0:_,label:M,labelAnchor:C,labelArrow:S,labelOffset:N,...$}){return m=Ke(m),b=Ke(b),g=Ke(g),C!==void 0&&(C=Sn(C,"labelAnchor",["center","top","bottom"])),S=qv(S),ev(m&&!Tt(o)?fN(e,t,n,{stroke:o,strokeOpacity:a,strokeWidth:s,tickSize:m,tickPadding:b,tickRotate:g,x:E,...$}):null,Tt(l)?null:dN(e,t,n,{fill:l,fillOpacity:u,stroke:h,strokeOpacity:f,strokeWidth:d,textAnchor:c,tickSize:m,tickPadding:b,tickRotate:g,x:E,marginTop:y,marginRight:v,marginBottom:x,marginLeft:w,...$}),!Tt(l)&&M!==null?$r([],Ov({fill:l,fillOpacity:u,...$},function(T,L,D,I,V){const W=I[e],{marginTop:U,marginRight:Y,marginBottom:k,marginLeft:B}=e==="y"&&V.inset||V,G=C??(W.bandwidth?"center":"top"),X=N??(t==="right"?Y:B)-3;return G==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=G,this.frameAnchor=`${G}-${t}`,this.rotate=0),this.dy=G==="top"?3-U:G==="bottom"?k-3:0,this.dx=t==="right"?X:-X,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[Uv(e,W,{anchor:t,label:M,labelAnchor:G,labelArrow:S})]}}}})):null)}function Dv(e,t,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:s=1,fill:l=r,fillOpacity:u=i,textAnchor:c,textStroke:h,textStrokeOpacity:f,textStrokeWidth:d,tickSize:m=e==="x"?6:0,tickPadding:b,tickRotate:g,y:E,margin:_,marginTop:y=_===void 0?t==="top"?30:0:_,marginRight:v=_===void 0?20:_,marginBottom:x=_===void 0?t==="bottom"?30:0:_,marginLeft:w=_===void 0?20:_,label:M,labelAnchor:C,labelArrow:S,labelOffset:N,...$}){return m=Ke(m),b=Ke(b),g=Ke(g),C!==void 0&&(C=Sn(C,"labelAnchor",["center","left","right"])),S=qv(S),ev(m&&!Tt(o)?hN(e,t,n,{stroke:o,strokeOpacity:a,strokeWidth:s,tickSize:m,tickPadding:b,tickRotate:g,y:E,...$}):null,Tt(l)?null:mN(e,t,n,{fill:l,fillOpacity:u,stroke:h,strokeOpacity:f,strokeWidth:d,textAnchor:c,tickSize:m,tickPadding:b,tickRotate:g,y:E,marginTop:y,marginRight:v,marginBottom:x,marginLeft:w,...$}),!Tt(l)&&M!==null?$r([],Ov({fill:l,fillOpacity:u,...$},function(T,L,D,I,V){const W=I[e],{marginTop:U,marginRight:Y,marginBottom:k,marginLeft:B}=e==="x"&&V.inset||V,G=C??(W.bandwidth?"center":"right"),X=N??(t==="top"?U:k)-3;return G==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${G}`,this.textAnchor=G==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-X:X,this.dx=G==="right"?Y-3:G==="left"?3-B:0,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[Uv(e,W,{anchor:t,label:M,labelAnchor:G,labelArrow:S})]}}}})):null)}function fN(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=t+(e==="y"?"-empty":""),frameAnchor:s=t,tickSize:l,inset:u=0,insetLeft:c=u,insetRight:h=u,dx:f=0,y:d=e==="y"?void 0:null,...m}){return uo(lN,e,n,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:o,facetAnchor:a,frameAnchor:s,y:d,...m,dx:t==="left"?+f-It+ +c:+f+It-h,anchor:"start",length:l,shape:t==="left"?MN:EN})}function hN(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=t+(e==="x"?"-empty":""),frameAnchor:s=t,tickSize:l,inset:u=0,insetTop:c=u,insetBottom:h=u,dy:f=0,x:d=e==="x"?void 0:null,...m}){return uo(sN,e,n,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:o,strokeLinecap:i,facetAnchor:a,frameAnchor:s,x:d,...m,dy:t==="bottom"?+f-It-h:+f+It+ +c,anchor:"start",length:l,shape:t==="bottom"?vN:wN})}function dN(e,t,n,{facetAnchor:r=t+(e==="y"?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:a=0,tickPadding:s=Math.max(3,9-o)+(Math.abs(a)>60?4*Math.cos(a*ov):0),text:l,textAnchor:u=Math.abs(a)>60?"middle":t==="left"?"end":"start",lineAnchor:c=a>60?"top":a<-60?"bottom":"middle",fontVariant:h,inset:f=0,insetLeft:d=f,insetRight:m=f,dx:b=0,y:g=e==="y"?void 0:null,...E}){return uo(VP,e,n,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:l,textAnchor:u,lineAnchor:c,fontVariant:h,rotate:a,y:g,...E,dx:t==="left"?+b-o-s+ +d:+b+ +o+ +s-m},function(_,y,v,x,w){h===void 0&&(this.fontVariant=Gv(_)),l===void 0&&(w.text=Lv(_,y,v,x,t))})}function mN(e,t,n,{facetAnchor:r=t+(e==="x"?"-empty":""),frameAnchor:i=t,tickSize:o,tickRotate:a=0,tickPadding:s=Math.max(3,9-o)+(Math.abs(a)>=10?4*Math.cos(a*ov):0),text:l,textAnchor:u=Math.abs(a)>=10?a<0^t==="bottom"?"start":"end":"middle",lineAnchor:c=Math.abs(a)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:h,inset:f=0,insetTop:d=f,insetBottom:m=f,dy:b=0,x:g=e==="x"?void 0:null,...E}){return uo(zP,e,n,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:l===void 0?null:l,textAnchor:u,lineAnchor:c,fontVariant:h,rotate:a,x:g,...E,dy:t==="bottom"?+b+ +o+ +s-m:+b-o-s+ +d},function(_,y,v,x,w){h===void 0&&(this.fontVariant=Gv(_)),l===void 0&&(w.text=Lv(_,y,v,x,t))})}function pN(){const[e,t]=Fr(...arguments);return Fv("y",Cv(t),e,t)}function bN(){const[e,t]=Fr(...arguments);return Fv("fy",Pv(t),e,t)}function gN(){const[e,t]=Fr(...arguments);return Rv("x",Nv(t),e,t)}function yN(){const[e,t]=Fr(...arguments);return Rv("fx",$v(t),e,t)}function Fv(e,t,n,{y:r=e==="y"?void 0:null,x:i=null,x1:o=t==="left"?i:null,x2:a=t==="right"?i:null,...s}){return uo(Et,e,n,{ariaLabel:`${e}-grid`,ariaHidden:!0},{y:r,x1:o,x2:a,...Bv(s)})}function Rv(e,t,n,{x:r=e==="x"?void 0:null,y:i=null,y1:o=t==="top"?i:null,y2:a=t==="bottom"?i:null,...s}){return uo(Pt,e,n,{ariaLabel:`${e}-grid`,ariaHidden:!0},{x:r,y1:o,y2:a,...Bv(s)})}function Bv({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:r=t,strokeWidth:i=1,...o}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...o}}function Ov({fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:s,pointerEvents:l,shapeRendering:u,clip:c=!1},h){return[,e]=lr(e),[,t]=Ct(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:s,pointerEvents:l,shapeRendering:u,clip:c,initializer:h}}function uo(e,t,n,r,i,o){let a;function s(c,h,f,d,m,b){const g=c==null&&(t==="fx"||t==="fy"),{[t]:E}=d;if(!E)throw new Error(`missing scale: ${t}`);const _=E.domain();let{interval:y,ticks:v,tickFormat:x,tickSpacing:w=t==="x"?80:35}=i;if(typeof v=="string"&&Hv(E)&&(y=v,v=void 0),v===void 0&&(v=Ya(y,E.type)??_N(E,w)),c==null){if(hi(v))c=Wt(v);else if(lA(v))c=wc(v,...Ft(_));else if(E.interval){let C=E.interval;if(E.ticks){const[S,N]=Ft(_),$=(N-S)/C[za];C=bp(C,$/v)??C,c=wc(C,S,N)}else{c=_;const S=c.length;C=bp(C,S/v)??C,C!==E.interval&&(c=wc(C,...Ft(c)))}if(C===E.interval){const S=Math.round(c.length/v);S>1&&(c=c.filter((N,$)=>$%S===0))}}else E.ticks?c=E.ticks(v):c=_;if(!E.ticks&&c.length&&c!==_){const C=new Gl(_);c=c.filter(S=>C.has(S)),c.length||wr(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}t==="y"||t==="x"?h=[fr(c)]:a[t]={scale:t,value:vt}}o==null||o.call(this,E,c,v,x,a);const M=Object.fromEntries(Object.entries(a).map(([C,S])=>[C,{...S,value:dt(c,S.value)}]));return g&&(h=b.filterFacets(c,M)),{data:c,facets:h,channels:M}}const l=ji(i).initializer,u=e(n,ji({...i,initializer:s},l));return n==null?(a=u.channels,u.channels={}):a={},r!==void 0&&Object.assign(u,r),u.clip===void 0&&(u.clip=!1),u}function _N(e,t){const[n,r]=Ft(e.range());return(r-n)/t}function Lv(e,t,n,r,i){return{value:cd(e,t,n,r,i)}}function cd(e,t,n,r,i){return typeof r=="function"?r:r===void 0&&t&&sn(t)?Kx(e.type,t,i)??ii:e.tickFormat?e.tickFormat(typeof n=="number"?n:null,r):r===void 0?ii:typeof r=="string"?(sn(e.domain())?Ua:ro)(r):Va(r)}function wc(e,t,n){return e.range(t,e.offset(e.floor(n)))}const vN={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},wN={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},MN={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},EN={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function Gv(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function Uv(e,t,{anchor:n,label:r=t.label,labelAnchor:i,labelArrow:o}={}){if(!(r==null||r.inferred&&Hv(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),o==="auto"&&(o=(!t.bandwidth||t.interval)&&!/[↑↓→←]/.test(r)),!o)return r;if(o===!0){const a=HC(t);a&&(o=/x$/.test(e)||i==="center"?/x$/.test(e)===a<0?"left":"right":a<0?"up":"down")}switch(o){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return n==="right"?`${r} ↑`:`↑ ${r}`;case"down":return n==="right"?`${r} ↓`:`↓ ${r}`}return r}}function qv(e="auto"){return Tt(e)?!1:typeof e=="boolean"?e:Sn(e,"labelArrow",["auto","up","right","down","left"])}function Hv(e){return sn(e.domain())}function jp(e,t){if(t==null)return t;const n=e(t);if(!n)throw new Error(`scale not found: ${t}`);return n}function SN(e,{opacity:t,...n}={}){if(!di(e)&&!Q_(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return zv(e,n,(r,i,o,a)=>r.append("svg").attr("width",o).attr("height",a).attr("fill",i.scale).attr("fill-opacity",Ct(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function xN(e,{fill:t=(u=>(u=e.hint)==null?void 0:u.fill)()!==void 0?e.hint.fill:"none",fillOpacity:n=1,stroke:r=(c=>(c=e.hint)==null?void 0:c.stroke)()!==void 0?e.hint.stroke:Tt(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:o=1.5,r:a=4.5,...s}={},l){const[h,f]=lr(t),[d,m]=lr(r),b=jp(l,h),g=jp(l,d),E=a*a*Math.PI;return n=Ct(n)[1],i=Ct(i)[1],o=Ct(o)[1],zv(e,s,(_,y,v,x)=>_.append("svg").attr("viewBox","-8 -8 16 16").attr("width",v).attr("height",x).attr("fill",h==="color"?w=>b.scale(w):f).attr("fill-opacity",n).attr("stroke",d==="color"?w=>g.scale(w):m).attr("stroke-opacity",i).attr("stroke-width",o).append("path").attr("d",w=>{const M=gr();return e.scale(w).draw(M,E),M}))}function zv(e,t={},n){let{columns:r,tickFormat:i,fontVariant:o=iv(e),swatchSize:a=15,swatchWidth:s=a,swatchHeight:l=a,marginLeft:u=0,className:c,style:h,width:f}=t;const d=Zh(t);c=nd(c),i=cd(e.scale,e.domain,void 0,i);const m=ut("div",d).attr("class",`${c}-swatches ${c}-swatches-${r!=null?"columns":"wrap"}`);let b;return r!=null?(b=`:where(.${c}-swatches-columns .${c}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${c}-swatches-columns .${c}-swatch::before) {
  flex-shrink: 0;
}
:where(.${c}-swatches-columns .${c}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,m.style("columns",r).selectAll().data(e.domain).enter().append("div").attr("class",`${c}-swatch`).call(n,e,s,l).call(g=>g.append("div").attr("class",`${c}-swatch-label`).attr("title",i).text(i))):(b=`:where(.${c}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${c}-swatches-wrap .${c}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,m.selectAll().data(e.domain).enter().append("span").attr("class",`${c}-swatch`).call(n,e,s,l).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),m.call(g=>g.insert("style","*").text(`:where(.${c}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${c}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${b}`)).style("margin-left",u?`${+u}px`:null).style("width",f===void 0?null:`${+f}px`).style("font-variant",yt(o,"normal")).call(rd,h).node()}const Bf=new Map([["symbol",xN],["color",Yv],["opacity",CN]]);function AN(e,t,n={}){return(r,i)=>{if(!Bf.has(r))throw new Error(`unknown legend type: ${r}`);if(r in e)return Bf.get(r)(e[r],Vv(t,n[r],i),o=>e[o])}}function Vv({className:e,...t},{label:n,ticks:r,tickFormat:i}={},o){return bA(o,{className:e,...t},{label:n,ticks:r,tickFormat:i})}function Yv(e,{legend:t=!0,...n}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return SN(e,n);case"ramp":return IP(e,n);default:throw new Error(`unknown legend type: ${t}`)}}function CN({type:e,interpolate:t,...n},{legend:r=!0,color:i=Sr(0,0,0),...o}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return Yv({type:e,...n,interpolate:PN(i)},{legend:r,...o})}function PN(e){const{r:t,g:n,b:r}=Sr(e)||Sr(0,0,0);return i=>`rgba(${t},${n},${r},${i})`}function NN(e,t,n){const r=[];for(const[i,o]of Bf){const a=n[i];if(a!=null&&a.legend&&i in e){const s=o(e[i],Vv(t,e[i],a),l=>e[l]);s!=null&&r.push(s)}}return r}const $N={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},TN={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class kN extends Gt{constructor(t={}){const{anchor:n=null,inset:r=0,insetTop:i=r,insetRight:o=r,insetBottom:a=r,insetLeft:s=r,rx:l,ry:u}=t;super(Rs,void 0,t,n==null?$N:TN),this.anchor=c_(n,"anchor",["top","right","bottom","left"]),this.insetTop=Ke(i),this.insetRight=Ke(o),this.insetBottom=Ke(a),this.insetLeft=Ke(s),this.rx=Ke(l),this.ry=Ke(u)}render(t,n,r,i,o){const{marginTop:a,marginRight:s,marginBottom:l,marginLeft:u,width:c,height:h}=i,{anchor:f,insetTop:d,insetRight:m,insetBottom:b,insetLeft:g,rx:E,ry:_}=this,y=u+g,v=c-s-m,x=a+d,w=h-l-b;return ut(f?"svg:line":"svg:rect",o).datum(0).call(xn,this,i,o).call(An,this).call(dr,this,r).call(Xt,this,{}).call(f==="left"?M=>M.attr("x1",y).attr("x2",y).attr("y1",x).attr("y2",w):f==="right"?M=>M.attr("x1",v).attr("x2",v).attr("y1",x).attr("y2",w):f==="top"?M=>M.attr("x1",y).attr("x2",v).attr("y1",x).attr("y2",x):f==="bottom"?M=>M.attr("x1",y).attr("x2",v).attr("y1",w).attr("y2",w):M=>M.attr("x",y).attr("y",x).attr("width",v-y).attr("height",w-x).attr("rx",E).attr("ry",_)).node()}}function IN(e){return new kN(e)}const Mc={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},DN=new Set(["geometry","href","src","ariaLabel","scales"]);class FN extends Gt{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&hi(t)&&y_(t)&&(n={...n,title:vt});const{x:r,y:i,x1:o,x2:a,y1:s,y2:l,anchor:u,preferredAnchor:c="bottom",monospace:h,fontFamily:f=h?"ui-monospace, monospace":void 0,fontSize:d,fontStyle:m,fontVariant:b,fontWeight:g,lineHeight:E=1,lineWidth:_=20,frameAnchor:y,format:v,textAnchor:x="start",textOverflow:w,textPadding:M=8,title:C,pointerSize:S=12,pathFilter:N="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:o!=null&&a!=null?null:r,scale:"x",optional:!0},y:{value:s!=null&&l!=null?null:i,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:a==null},y1:{value:s,scale:"y",optional:l==null},x2:{value:a,scale:"x",optional:o==null},y2:{value:l,scale:"y",optional:s==null},title:{value:C,optional:!0}},n,Mc),this.anchor=Nf(u,"anchor"),this.preferredAnchor=Nf(c,"preferredAnchor"),this.frameAnchor=_u(y),this.textAnchor=yt(x,"middle"),this.textPadding=+M,this.pointerSize=+S,this.pathFilter=At(N),this.lineHeight=+E,this.lineWidth=+_,this.textOverflow=yv(w),this.monospace=!!h,this.fontFamily=At(f),this.fontSize=Ke(d),this.fontStyle=At(m),this.fontVariant=At(b),this.fontWeight=At(g);for(const $ in Mc)$ in this.channels&&(this[$]=Mc[$]);this.splitLines=vv(this),this.clipLine=wv(this),this.format={...v}}render(t,n,r,i,o){const a=this,{x:s,y:l,fx:u,fy:c}=n,{ownerSVGElement:h,document:f}=o,{anchor:d,monospace:m,lineHeight:b,lineWidth:g}=this,{textPadding:E,pointerSize:_,pathFilter:y}=this,{marginTop:v,marginLeft:x}=i,{x1:w,y1:M,x2:C,y2:S,x:N=w??C,y:$=M??S}=r,T=u?u(t.fx)-x:0,L=c?c(t.fy)-v:0,[D,I]=Qa(this,i),V=nv(r,D),W=rv(r,I),U=m?ud:ld,Y=U(Ti);let k,B;"title"in r?(k=r.channels,B=UN):(k=GN.call(this,r,n),B=qN);const G=ut("svg:g",o).call(xn,this,i,o).call(_v,this).call(Xt,this,{x:N&&s,y:$&&l}).call(ie=>ie.selectAll().data(t).enter().append("g").attr("transform",ee=>`translate(${Math.round(V(ee))},${Math.round(W(ee))})`).call(An,this).call(ee=>ee.append("path").attr("filter",y)).call(ee=>ee.append("text").each(function(j){const J=Go(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const F=B.call(a,j,t,k,n,r);if(typeof F=="string")for(const ne of a.splitLines(F))X(J,{value:a.clipLine(ne)});else{const ne=new Set;for(const re of F){const{label:q=""}=re;q&&ne.has(q)||(ne.add(q),X(J,re))}}})));function X(ie,{label:ee,value:j,color:J,opacity:F}){ee??(ee=""),j??(j="");const ne=J!=null||F!=null;let re,q=g*100;const[ce]=Ki(ee,q,U,Y);if(ce>=0)ee=ee.slice(0,ce).trimEnd()+Ti,re=j.trim(),j="";else{(ee||!j&&!ne)&&(j=" "+j);const[ue]=Ki(j,q-U(ee),U,Y);ue>=0&&(re=j.trim(),j=j.slice(0,ue).trimEnd()+Ti)}const H=ie.append("tspan").attr("x",0).attr("dy",`${b}em`).text("​");ee&&H.append("tspan").attr("font-weight","bold").text(ee),j&&H.append(()=>f.createTextNode(j)),ne&&H.append("tspan").text(" ■").attr("fill",J).attr("fill-opacity",F).style("user-select","none"),re&&H.append("title").text(re)}function Z(){const{width:ie,height:ee}=i.facet??i;G.selectChildren().each(function(j){let{x:J,width:F,height:ne}=this.getBBox();F=Math.round(F),ne=Math.round(ne);let re=d;if(re===void 0){const H=V(j)+T,ue=W(j)+L,ae=H+F+_+E*2<ie,he=H-F-_-E*2>0,de=ue+ne+_+E*2<ee,ke=ue-ne-_-E*2>0;re=ae&&he?de&&ke?a.preferredAnchor:ke?"bottom":"top":de&&ke?ae?"left":"right":(ae||he)&&(de||ke)?`${ke?"bottom":"top"}-${ae?"left":"right"}`:a.preferredAnchor}const q=this.firstChild,ce=this.lastChild;if(q.setAttribute("d",LN(re,_,E,F,ne)),J)for(const H of ce.childNodes)H.setAttribute("x",-J);ce.setAttribute("y",`${+BN(re,ce.childNodes.length,b).toFixed(6)}em`),ce.setAttribute("transform",`translate(${ON(re,_,E,F,ne)})`)}),G.attr("visibility",null)}return t.length&&(G.attr("visibility","hidden"),h.isConnected?Promise.resolve().then(Z):typeof requestAnimationFrame<"u"&&requestAnimationFrame(Z)),G.node()}}function RN(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=ao(t,n)),new FN(e,{...r,x:t,y:n})}function BN(e,t,n){return/^top(?:-|$)/.test(e)?.94-n:-.29-t*n}function ON(e,t,n,r,i){switch(e){case"middle":return[-r/2,i/2];case"top-left":return[n,t+n];case"top":return[-r/2,t/2+n];case"top-right":return[-r-n,t+n];case"right":return[-t/2-r-n,i/2];case"bottom-left":return[n,-t-n];case"bottom":return[-r/2,-t/2-n];case"bottom-right":return[-r-n,-t-n];case"left":return[n+t/2,i/2]}}function LN(e,t,n,r,i){const o=r+n*2,a=i+n*2;switch(e){case"middle":return`M${-o/2},${-a/2}h${o}v${a}h${-o}z`;case"top-left":return`M0,0l${t},${t}h${o-t}v${a}h${-o}z`;case"top":return`M0,0l${t/2},${t/2}h${(o-t)/2}v${a}h${-o}v${-a}h${(o-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-o}v${a}h${o}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-a/2}h${-o}v${a}h${o}v${t/2-a/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${o-t}v${-a}h${-o}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(o-t)/2}v${-a}h${-o}v${a}h${(o-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-o}v${-a}h${o}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-a/2}h${o}v${a}h${-o}v${t/2-a/2}z`}}function GN({channels:e},t){var i,o;const n={};let r=this.format;r=Kp(r,e,"x"),r=Kp(r,e,"y"),this.format=r;for(const a in r){const s=r[a];if(!(s===null||s===!1))if(a==="fx"||a==="fy")n[a]=!0;else{const l=xp(e,a);l&&(n[a]=l)}}for(const a in e){if(a in n||a in r||DN.has(a))continue;const s=xp(e,a);s&&(n[a]=s)}this.facet&&(t.fx&&!("fx"in r)&&(n.fx=!0),t.fy&&!("fy"in r)&&(n.fy=!0));for(const a in n){const s=this.format[a];if(typeof s=="string"){const l=((i=n[a])==null?void 0:i.value)??((o=t[a])==null?void 0:o.domain())??[];this.format[a]=(sn(l)?Ua:ro)(s)}else if(s===void 0||s===!0){const l=t[a];this.format[a]=l!=null&&l.bandwidth?cd(l,l.domain()):ii}}return n}function Kp(e,t,n){if(!(n in e))return e;const r=`${n}1`,i=`${n}2`;if((r in e||!(r in t))&&(i in e||!(i in t)))return e;const o=Object.entries(e),a=e[n];return o.splice(o.findIndex(([s])=>s===n)+1,0,[r,a],[i,a]),Object.fromEntries(o)}function UN(e,t,{title:n}){return ii(n.value[e],e)}function*qN(e,t,n,r,i){for(const o in n){if(o==="fx"||o==="fy"){yield{label:Al(r,n,o),value:this.format[o](t[o],e)};continue}if(o==="x1"&&"x2"in n||o==="y1"&&"y2"in n)continue;const a=n[o];if(o==="x2"&&"x1"in n)yield{label:Qp(r,n,"x"),value:Zp(this.format.x2,n.x1,a,e)};else if(o==="y2"&&"y1"in n)yield{label:Qp(r,n,"y"),value:Zp(this.format.y2,n.y1,a,e)};else{const s=a.value[e],l=a.scale;if(!Pr(s)&&l==null)continue;yield{label:Al(r,n,o),value:this.format[o](s,e),color:l==="color"?i[o][e]:null,opacity:l==="opacity"?i[o][e]:null}}}}function Zp(e,t,n,r){var i;return(i=n.hint)!=null&&i.length?`${e(n.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}–${e(n.value[r],r)}`}function Qp(e,t,n){const r=Al(e,t,`${n}1`,n),i=Al(e,t,`${n}2`,n);return r===i?r:`${r}–${i}`}function Al(e,t,n,r=n){const i=t[n],o=e[(i==null?void 0:i.scale)??n];return String((o==null?void 0:o.label)??(i==null?void 0:i.label)??r)}function rt(e={}){var Y;const{facet:t,style:n,title:r,subtitle:i,caption:o,ariaLabel:a,ariaDescription:s}=e,l=nd(e.className),u=e.marks===void 0?[]:e0(e.marks);u.push(...KN(u));const c=XN(t,e),h=new Map;for(const k of u){const B=t0(k,c,e);B&&h.set(k,B)}const f=new Map;c&&So(f,[c],e),So(f,h,e);const d=e0(ZN(u,f,e));for(const k of d){const B=t0(k,c,e);B&&h.set(k,B)}u.unshift(...d);let m=gP(f,e);if(m!==void 0){const k=c?yc(m,c):void 0;for(const G of u){if(G.facet===null||G.facet==="super")continue;const X=h.get(G);X!==void 0&&(X.facetsIndex=G.fx!=null||G.fy!=null?yc(m,X):k)}const B=new Set;for(const{facetsIndex:G}of h.values())G==null||G.forEach((X,Z)=>{(X==null?void 0:X.length)>0&&B.add(Z)});m.forEach(0<B.size&&B.size<m.length?(G,X)=>G.empty=!B.has(X):G=>G.empty=!1);for(const G of u)if(G.facet==="exclude"){const X=h.get(G);X!==void 0&&(X.facetsIndex=vP(X.facetsIndex))}}for(const k of et.keys())Cf(e[k])&&k!=="fx"&&k!=="fy"&&f.set(k,[]);const b=new Map;for(const k of u){if(b.has(k))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:B,channels:G}=h.get(k)??{},{data:X,facets:Z,channels:ie}=k.initialize(B,G,e);fd(ie,e),b.set(k,{data:X,facets:Z,channels:ie})}const g=Df(So(f,b,e),e),E=pP(g,u,e);UC(g,E);const _=Ip(g),{fx:y,fy:v}=_,x=y||v?j_(g,E):E,w=y||v?i$(_,E):E,M=Zh(e),C=M.document,S=zl("svg").call(C.documentElement);let N=S;M.ownerSVGElement=S,M.className=l,M.projection=eC(e,x),M.filterFacets=(k,B)=>yc(m,{channels:B,groups:id(k,B)}),M.getMarkState=k=>{const B=b.get(k),G=h.get(k);return{...B,channels:{...B.channels,...G==null?void 0:G.channels}}},M.dispatchValue=k=>{N.value!==k&&(N.value=k,N.dispatchEvent(new Event("input",{bubbles:!0})))};const $=new Set;for(const[k,B]of b)if(k.initializer!=null){const G=k.facet==="super"?w:x,X=k.initializer(B.data,B.facets,B.channels,_,G,M);if(X.data!==void 0&&(B.data=X.data),X.facets!==void 0&&(B.facets=X.facets),X.channels!==void 0){const{fx:Z,fy:ie,...ee}=X.channels;WN(ee),Object.assign(B.channels,ee);for(const j of Object.values(ee)){const{scale:J}=j;J!=null&&!yA(et.get(J))&&(Wv(j,e),$.add(J))}(Z!=null||ie!=null)&&h.set(k,!0)}}if($.size){const k=new Map;So(k,b,e,Z=>$.has(Z)),So(f,b,e,Z=>$.has(Z));const B=r$(Df(k,e),g),{scales:G,...X}=Ip(B);Object.assign(g,B),Object.assign(_,X),Object.assign(_.scales,G)}let T,L;m!==void 0&&(T={x:y==null?void 0:y.domain(),y:v==null?void 0:v.domain()},m=yP(m,T),L=_P(y,v,E));for(const[k,B]of b)B.values=k.scale(B.channels,_,M);const{width:D,height:I}=E;Go(S).attr("class",l).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",D).attr("height",I).attr("viewBox",`0 0 ${D} ${I}`).attr("aria-label",a).attr("aria-description",s).call(k=>k.append("style").text(`:where(.${l}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${l} text),
:where(.${l} tspan) {
  white-space: pre;
}`)).call(rd,n);for(const k of u){const{channels:B,values:G,facets:X}=b.get(k);if(m===void 0||k.facet==="super"){let Z=null;if(X&&(Z=X[0],Z=k.filter(Z,B,G),Z.length===0))continue;const ie=k.render(Z,_,G,w,M);if(ie==null)continue;S.appendChild(ie)}else{let Z;for(const ie of m){if(!(((Y=k.facetAnchor)==null?void 0:Y.call(k,m,T,ie))??!ie.empty))continue;let ee=null;if(X){const J=h.has(k);if(ee=X[J?ie.i:0],ee=k.filter(ee,B,G),ee.length===0)continue;!J&&ee===X[0]&&(ee=oA(ee)),ee.fx=ie.x,ee.fy=ie.y,ee.fi=ie.i}const j=k.render(ee,_,G,x,M);if(j!=null){(Z??(Z=Go(S).append("g"))).append(()=>j).datum(ie);for(const J of["aria-label","aria-description","aria-hidden","transform"])j.hasAttribute(J)&&(Z.attr(J,j.getAttribute(J)),j.removeAttribute(J))}}Z==null||Z.selectChildren().attr("transform",L)}}const V=NN(g,M,e),{figure:W=r!=null||i!=null||o!=null||V.length>0}=e;W&&(N=C.createElement("figure"),N.className=`${l}-figure`,N.style.maxWidth="initial",r!=null&&N.append(Jp(C,r,"h2")),i!=null&&N.append(Jp(C,i,"h3")),N.append(...V,S),o!=null&&N.append(HN(C,o))),N.scale=jC(_.scales),N.legend=AN(g,M,e);const U=JA();return U>0&&Go(S).append("text").attr("x",D).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${U.toLocaleString("en-US")} warning${U===1?"":"s"}. Please check the console.`),N}function Jp(e,t,n){if(t.ownerDocument)return t;const r=e.createElement(n);return r.append(t),r}function HN(e,t){const n=e.createElement("figcaption");return n.append(t),n}function zN({marks:e=[],...t}={}){return rt({...t,marks:[...e,this]})}Gt.prototype.plot=zN;function e0(e){return e.flat(1/0).filter(t=>t!=null).map(VN)}function VN(e){return typeof e.render=="function"?e:new YN(e)}class YN extends Gt{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function fd(e,t){for(const n in e)Wv(e[n],t);return e}function Wv(e,t){const{scale:n,transform:r=!0}=e;if(n==null||!r)return;const{type:i,percent:o,interval:a,transform:s=o?l=>l*100:g_(a,i)}=t[n]??{};s!=null&&(e.value=pt(e.value,s),e.transform=!1)}function WN(e){for(const t in e)k_(t,e[t])}function So(e,t,n,r=tA){var i,o;for(const{channels:a}of t.values())for(const s in a){const l=a[s],{scale:u}=l;if(u!=null&&r(u))if(u==="projection"){if(!iC(n)){const c=((i=n.x)==null?void 0:i.domain)===void 0,h=((o=n.y)==null?void 0:o.domain)===void 0;if(c||h){const[f,d]=aC(l);c&&Ec(e,"x",f),h&&Ec(e,"y",d)}}}else Ec(e,u,l)}return e}function Ec(e,t,n){const r=e.get(t);r!==void 0?r.push(n):e.set(t,[n])}function XN(e,t){if(e==null)return;const{x:n,y:r}=e;if(n==null&&r==null)return;const i=Wt(e.data);if(i==null)throw new Error("missing facet data");const o={};n!=null&&(o.fx=ha(i,{value:n,scale:"fx"})),r!=null&&(o.fy=ha(i,{value:r,scale:"fy"})),fd(o,t);const a=id(i,o);return{channels:o,groups:a,data:e.data}}function t0(e,t,n){var l;if(e.facet===null||e.facet==="super")return;const{fx:r,fy:i}=e;if(r!=null||i!=null){const u=Wt(e.data??r??i);if(u===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(u===null)return;const c={};return r!=null&&(c.fx=ha(u,{value:r,scale:"fx"})),i!=null&&(c.fy=ha(u,{value:i,scale:"fy"})),fd(c,n),{channels:c,groups:id(u,c)}}if(t===void 0)return;const{channels:o,groups:a,data:s}=t;if(e.facet!=="auto"||e.data===s)return{channels:o,groups:a};s.length>0&&(a.size>1||a.size===1&&o.fx&&o.fy&&[...a][0][1].size>1)&&((l=Wt(e.data))==null?void 0:l.length)===s.length&&wr(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function jN(e,t={}){return ji({...t,x:null,y:null},(n,r,i,o,a,s)=>s.getMarkState(e))}function KN(e){const t=[];for(const n of e){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:o}=r;i=/^x$/i.test(i)?kP:/^y$/i.test(i)?qp:TP,r=i(jN(n,r)),r.title=null,o===void 0&&(r.preferredAnchor=i===qp?"left":"bottom");const a=RN(n.data,r);a.facet=n.facet,a.facetAnchor=n.facetAnchor,t.push(a)}}return t}function ZN(e,t,n){let{projection:r,x:i={},y:o={},fx:a={},fy:s={},axis:l,grid:u,facet:c={},facet:{axis:h=l,grid:f}=c,x:{axis:d=l,grid:m=d===null?null:u}=i,y:{axis:b=l,grid:g=b===null?null:u}=o,fx:{axis:E=h,grid:_=E===null?null:f}=a,fy:{axis:y=h,grid:v=y===null?null:f}=s}=n;(r||!Cf(i)&&!n0("x",e))&&(d=m=null),(r||!Cf(o)&&!n0("y",e))&&(b=g=null),t.has("fx")||(E=_=null),t.has("fy")||(y=v=null),d===void 0&&(d=!Ss(e,"x")),b===void 0&&(b=!Ss(e,"y")),E===void 0&&(E=!Ss(e,"fx")),y===void 0&&(y=!Ss(e,"fy")),d===!0&&(d="bottom"),b===!0&&(b="left"),E===!0&&(E=d==="top"||d===null?"bottom":"top"),y===!0&&(y=b==="right"||b===null?"left":"right");const x=[];return Es(x,v,bN,s),Ms(x,y,uN,"right","left",c,s),Es(x,_,yN,a),Ms(x,E,cN,"top","bottom",c,a),Es(x,g,pN,o),Ms(x,b,Tv,"left","right",n,o),Es(x,m,gN,i),Ms(x,d,kv,"bottom","top",n,i),x}function Ms(e,t,n,r,i,o,a){if(!t)return;const s=QN(t);a=JN(s?r:t,o,a);const{line:l}=a;(n===Tv||n===kv)&&l&&!fa(l)&&e.push(IN(e$(a))),e.push(n(a)),s&&e.push(n({...a,anchor:i,label:null}))}function Es(e,t,n,r){!t||fa(t)||e.push(n(t$(t,r)))}function QN(e){return/^\s*both\s*$/i.test(e)}function JN(e,t,{line:n=t.line,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:s,tickRotate:l,fontVariant:u,ariaLabel:c,ariaDescription:h,label:f=t.label,labelAnchor:d,labelArrow:m=t.labelArrow,labelOffset:b}){return{anchor:e,line:n,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:s,tickRotate:l,fontVariant:u,ariaLabel:c,ariaDescription:h,label:f,labelAnchor:d,labelArrow:m,labelOffset:b}}function e$(e){const{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:n===!0?void 0:n}}function t$(e,{stroke:t=yu(e)?e:void 0,ticks:n=n$(e)?e:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:o}){return{stroke:t,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:o}}function n$(e){switch(typeof e){case"number":return!0;case"string":return!yu(e)}return hi(e)||typeof(e==null?void 0:e.range)=="function"}function Ss(e,t){const n=`${t}-axis `;return e.some(r=>{var i;return(i=r.ariaLabel)==null?void 0:i.startsWith(n)})}function n0(e,t){for(const n of t)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===e||i==="projection")return!0}return!1}function r$(e,t){for(const n in e){const r=e[n],i=t[n];r.label===void 0&&i&&(r.label=i.label)}return e}function i$({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:s,height:l}=td(n),u=e&&r0(e),c=t&&r0(t);return{marginTop:t?c[0]:r,marginRight:e?s-u[1]:i,marginBottom:t?l-c[1]:o,marginLeft:e?u[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:s,height:l}}function r0(e){const t=e.domain();let n=e(t[0]),r=e(t[t.length-1]);return r<n&&([n,r]=[r,n]),[n,r+e.bandwidth()]}const o$=new Map([["basis",J9],["basis-closed",eE],["basis-open",tE],["bundle",nE],["bump-x",q9],["bump-y",H9],["cardinal",rE],["cardinal-closed",iE],["cardinal-open",oE],["catmull-rom",aE],["catmull-rom-closed",sE],["catmull-rom-open",lE],["linear",lu],["linear-closed",uE],["monotone-x",cE],["monotone-y",fE],["natural",hE],["step",dE],["step-after",pE],["step-before",mE]]);function a$(e=lu,t){if(typeof e=="function")return e;const n=o$.get(`${e}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}function Xv(e=Zi,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?Zi:a$(e,t)}function Zi(e){return lu(e)}function s$(e={}){return f_(e)?e:{...e,x:vt}}function l$(e={}){return h_(e)?e:{...e,y:vt}}function u$(e,t){if(t.length===1)return{data:e,facets:t};const n=e.length,r=new Uint8Array(n);let i=0;for(const s of t)for(const l of s)r[l]&&++i,r[l]=1;if(i===0)return{data:e,facets:t};e=ca(e);const o=e[s_]=new Uint32Array(n+i);t=t.map(s=>ca(s,Uint32Array));let a=n;r.fill(0);for(const s of t)for(let l=0,u=s.length;l<u;++l){const c=s[l];r[c]?(s[l]=a,e[a]=e[c],o[a]=c,++a):o[c]=c,r[c]=1}return{data:e,facets:t}}function c$(e={},t={}){arguments.length===1&&([e,t]=jv(e));const{y1:n,y:r=n,x:i,...o}=t,[a,s,l,u]=Kv(r,i,"y","x",e,o);return{...a,y1:n,y:s,x1:l,x2:u,x:b_(l,u)}}function f$(e={},t={}){arguments.length===1&&([e,t]=jv(e));const{x1:n,x:r=n,y:i,...o}=t,[a,s,l,u]=Kv(r,i,"x","y",e,o);return{...a,x1:n,x:s,y1:l,y2:u,y:b_(l,u)}}function h$({x:e,x1:t,x2:n,...r}={}){return r=xu(r,"y"),t===void 0&&n===void 0?c$({x:e,...r}):([t,n]=m_(e,t,n),{...r,x1:t,x2:n})}function d$({y:e,y1:t,y2:n,...r}={}){return r=xu(r,"x"),t===void 0&&n===void 0?f$({y:e,...r}):([t,n]=m_(e,t,n),{...r,y1:t,y2:n})}function jv(e){const{offset:t,order:n,reverse:r,...i}=e;return[{offset:t,order:n,reverse:r},i]}const m$={length:!0};function Kv(e,t=eA,n,r,{offset:i,order:o,reverse:a},s){if(t===null)throw new Error(`stack requires ${r}`);const l=p_(s),[u,c]=Ei(e),[h,f]=xl(t),[d,m]=xl(t);return h.hint=d.hint=m$,i=p$(i),o=y$(o,i,r),[wu(s,(b,g,E)=>{({data:b,facets:g}=u$(b,g));const _=e==null?void 0:c(Pf(dt(b,e),E==null?void 0:E[n])),y=dt(b,t,Float64Array),v=dt(b,l),x=o&&o(b,_,y,v),w=b.length,M=f(new Float64Array(w)),C=m(new Float64Array(w)),S=[];for(const N of g){const $=_?Array.from(Ul(N,T=>_[T]).values()):[N];if(x)for(const T of $)T.sort(x);for(const T of $){let L=0,D=0;a&&T.reverse();for(const I of T){const V=y[I];V<0?L=C[I]=(M[I]=L)+V:V>0?D=C[I]=(M[I]=D)+V:C[I]=M[I]=D}}S.push($)}return i&&i(S,M,C,v),{data:b,facets:g}}),u,h,d]}function p$(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return b$;case"center":case"silhouette":return g$;case"wiggle":return Qv}throw new Error(`unknown offset: ${e}`)}}function Zv(e,t){let n=0,r=0;for(const i of e){const o=t[i];o<n&&(n=o),o>r&&(r=o)}return[n,r]}function b$(e,t,n){for(const r of e)for(const i of r){const[o,a]=Zv(i,n);for(const s of i){const l=1/(a-o||1);t[s]=l*(t[s]-o),n[s]=l*(n[s]-o)}}}function g$(e,t,n){for(const r of e){for(const i of r){const[o,a]=Zv(i,n);for(const s of i){const l=(a+o)/2;t[s]-=l,n[s]-=l}}Jv(r,t,n)}ew(e,t,n)}function Qv(e,t,n,r){for(const i of e){const o=new Zr;let a=0;for(const s of i){let l=-1;const u=s.map(d=>Math.abs(n[d]-t[d])),c=s.map(d=>{l=r?r[d]:++l;const m=n[d]-t[d],b=o.has(l)?m-o.get(l):0;return o.set(l,m),b}),h=[0,...K3(c)];for(const d of s)t[d]+=a,n[d]+=a;const f=Mr(u);f&&(a-=Mr(u,(d,m)=>(c[m]/2+h[m])*d)/f)}Jv(i,t,n)}ew(e,t,n)}function Jv(e,t,n){const r=Nt(e,i=>Nt(i,o=>t[o]));for(const i of e)for(const o of i)t[o]-=r,n[o]-=r}function ew(e,t,n){const r=e.length;if(r===1)return;const i=e.map(s=>s.flat()),o=i.map(s=>(Nt(s,l=>t[l])+tt(s,l=>n[l]))/2),a=Nt(o);for(let s=0;s<r;s++){const l=a-o[s];for(const u of i[s])t[u]+=l,n[u]+=l}}function y$(e,t,n){if(e===void 0&&t===Qv)return i0(Mn);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),i=r?Sl:Mn;switch((r?e.slice(1):e).toLowerCase()){case"value":case n:return _$(i);case"z":return v$(i);case"sum":return w$(i);case"appearance":return M$(i);case"inside-out":return i0(i)}return o0(l_(e))}if(typeof e=="function")return(e.length===1?o0:E$)(e);if(Array.isArray(e))return S$(e);throw new Error(`invalid order: ${e}`)}}function _$(e){return(t,n,r)=>(i,o)=>e(r[i],r[o])}function v$(e){return(t,n,r,i)=>(o,a)=>e(i[o],i[a])}function w$(e){return Pu(e,(t,n,r,i)=>nh(fr(t),o=>Mr(o,a=>r[a]),o=>i[o]))}function M$(e){return Pu(e,(t,n,r,i)=>nh(fr(t),o=>n[D1(o,a=>r[a])],o=>i[o]))}function i0(e){return Pu(e,(t,n,r,i)=>{const o=fr(t),a=nh(o,h=>n[D1(h,f=>r[f])],h=>i[h]),s=Pi(o,h=>Mr(h,f=>r[f]),h=>i[h]),l=[],u=[];let c=0;for(const h of a)c<0?(c+=s.get(h),l.push(h)):(c-=s.get(h),u.push(h));return u.reverse().concat(l)})}function o0(e){return t=>{const n=dt(t,e);return(r,i)=>Mn(n[r],n[i])}}function E$(e){return t=>(n,r)=>e(t[n],t[r])}function S$(e){return Pu(Mn,()=>e)}function Pu(e,t){return(n,r,i,o)=>{if(!o)throw new Error("missing channel: z");const a=new Zr(t(n,r,i,o).map((s,l)=>[s,l]));return(s,l)=>e(a.get(o[s]),a.get(o[l]))}}const x$={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class A$ extends Gt{constructor(t,n={}){const{x1:r,y1:i,x2:o,y2:a,curve:s,tension:l}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,x$),this.curve=Xv(s,l),Ja(this,n)}project(t,n,r){this.curve!==Zi&&super.project(t,n,r)}render(t,n,r,i,o){const{x1:a,y1:s,x2:l=a,y2:u=s}=r,{curve:c}=this;return ut("svg:g",o).call(xn,this,i,o).call(Xt,this,n).call(h=>h.selectAll().data(t).enter().append("path").call(An,this).attr("d",c===Zi&&o.projection?C$(o.projection,a,s,l,u):f=>{const d=gr(),m=c(d);return m.lineStart(),m.point(a[f],s[f]),m.point(l[f],u[f]),m.lineEnd(),d}).call(dr,this,r).call(Au,this,r,o)).node()}}function C$(e,t,n,r,i){const o=Kl(e);return t=vr(t),n=vr(n),r=vr(r),i=vr(i),a=>o({type:"LineString",coordinates:[[t[a],n[a]],[r[a],i[a]]]})}function a0(e,{x:t,x1:n,x2:r,y:i,y1:o,y2:a,...s}={}){return[n,r]=s0(t,n,r),[o,a]=s0(i,o,a),new A$(e,{...s,x1:n,x2:r,y1:o,y2:a})}function s0(e,t,n){if(e===void 0){if(t===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[t]}else{if(t===void 0)return n===void 0?[e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}class hd extends Gt{constructor(t,n,r={},i){super(t,n,r,i);const{inset:o=0,insetTop:a=o,insetRight:s=o,insetBottom:l=o,insetLeft:u=o,rx:c,ry:h}=r;this.insetTop=Ke(a),this.insetRight=Ke(s),this.insetBottom=Ke(l),this.insetLeft=Ke(u),this.rx=yt(c,"auto"),this.ry=yt(h,"auto")}render(t,n,r,i,o){const{rx:a,ry:s}=this;return ut("svg:g",o).call(xn,this,i,o).call(this._transform,this,n).call(l=>l.selectAll().data(t).enter().append("rect").call(An,this).attr("x",this._x(n,r,i)).attr("width",this._width(n,r,i)).attr("y",this._y(n,r,i)).attr("height",this._height(n,r,i)).call(ye,"rx",a).call(ye,"ry",s).call(dr,this,r)).node()}_x(t,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?o=>n[o]+i:r+i}_y(t,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?o=>n[o]+i:r+i}_width({x:t},{x:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:s}=this,l=n&&t?t.bandwidth():o-r-i;return Math.max(0,l-a-s)}_height({y:t},{y:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:s}=this,l=n&&t?t.bandwidth():o-r-i;return Math.max(0,l-a-s)}}const tw={ariaLabel:"bar"};class P$ extends hd{constructor(t,n={}){const{x1:r,x2:i,y:o}=n;super(t,{x1:{value:r,scale:"x"},x2:{value:i,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n,tw)}_transform(t,n,{x:r}){t.call(Xt,n,{x:r},0,0)}_x({x:t},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:o}=this;return Nr(t)?i+o:a=>Math.min(n[a],r[a])+o}_width({x:t},{x1:n,x2:r},{marginRight:i,marginLeft:o,width:a}){const{insetLeft:s,insetRight:l}=this;return Nr(t)?a-i-o-s-l:u=>Math.max(0,Math.abs(r[u]-n[u])-s-l)}}class N$ extends hd{constructor(t,n={}){const{x:r,y1:i,y2:o}=n;super(t,{y1:{value:i,scale:"y"},y2:{value:o,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},n,tw)}_transform(t,n,{y:r}){t.call(Xt,n,{y:r},0,0)}_y({y:t},{y1:n,y2:r},{marginTop:i}){const{insetTop:o}=this;return Nr(t)?i+o:a=>Math.min(n[a],r[a])+o}_height({y:t},{y1:n,y2:r},{marginTop:i,marginBottom:o,height:a}){const{insetTop:s,insetBottom:l}=this;return Nr(t)?a-i-o-s-l:u=>Math.max(0,Math.abs(r[u]-n[u])-s-l)}}function es(e,t={}){return d_(t)||(t={...t,y:qh,x2:vt}),new P$(e,h$(dv(s$(t))))}function ma(e,t={}){return d_(t)||(t={...t,x:qh,y2:vt}),new N$(e,d$(mv(l$(t))))}const $$={ariaLabel:"cell"};class T$ extends hd{constructor(t,{x:n,y:r,...i}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},i,$$)}_transform(t,n){t.call(Xt,n,{},0,0)}}function Of(e,{x:t,y:n,...r}={}){return[t,n]=ao(t,n),new T$(e,{...r,x:t,y:n})}const k$={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function I$(e){return e.sort===void 0&&e.reverse===void 0?AA({channel:"-r"},e):e}class D$ extends Gt{constructor(t,n={}){const{x:r,y:i,r:o,rotate:a,symbol:s=sa,frameAnchor:l}=n,[u,c]=Ct(a,0),[h,f]=SA(s),[d,m]=Ct(o,h==null?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:d,scale:"r",filter:mu,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},I$(n),k$),this.r=m,this.rotate=c,this.symbol=f,this.frameAnchor=_u(l);const{channels:b}=this,{symbol:g}=b;if(g){const{fill:E,stroke:_}=b;g.hint={fill:E?E.value===g.value?"color":"currentColor":this.fill??"currentColor",stroke:_?_.value===g.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,i,o){const{x:a,y:s}=n,{x:l,y:u,r:c,rotate:h,symbol:f}=r,{r:d,rotate:m,symbol:b}=this,[g,E]=Qa(this,i),_=b===sa,y=c?void 0:d*d*Math.PI;return Lh(d)&&(t=[]),ut("svg:g",o).call(xn,this,i,o).call(Xt,this,{x:l&&a,y:u&&s}).call(v=>v.selectAll().data(t).enter().append(_?"circle":"path").call(An,this).call(_?x=>{x.attr("cx",l?w=>l[w]:g).attr("cy",u?w=>u[w]:E).attr("r",c?w=>c[w]:d)}:x=>{x.attr("transform",ad`translate(${l?w=>l[w]:g},${u?w=>u[w]:E})${h?w=>` rotate(${h[w]})`:m?` rotate(${m})`:""}`).attr("d",c&&f?w=>{const M=gr();return f[w].draw(M,c[w]*c[w]*Math.PI),M}:c?w=>{const M=gr();return b.draw(M,c[w]*c[w]*Math.PI),M}:f?w=>{const M=gr();return f[w].draw(M,y),M}:(()=>{const w=gr();return b.draw(w,y),w})())}).call(dr,this,r)).node()}}function on(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=ao(t,n)),new D$(e,{...r,x:t,y:n})}const F$={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class R$ extends Gt{constructor(t,n={}){const{x:r,y:i,z:o,curve:a,tension:s}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:p_(n),optional:!0}},n,F$),this.z=o,this.curve=Xv(a,s),Ja(this,n)}filter(t){return t}project(t,n,r){this.curve!==Zi&&super.project(t,n,r)}render(t,n,r,i,o){const{x:a,y:s}=r,{curve:l}=this;return ut("svg:g",o).call(xn,this,i,o).call(Xt,this,n).call(u=>u.selectAll().data(fP(t,[a,s],this,r)).enter().append("path").call(An,this).call(lP,this,r).call(BP,this,r,o).attr("d",l===Zi&&o.projection?B$(o.projection,a,s):U9().curve(l).defined(c=>c>=0).x(c=>a[c]).y(c=>s[c]))).node()}}function B$(e,t,n){const r=Kl(e);return t=vr(t),n=vr(n),i=>{let o=[];const a=[o];for(const s of i)s===-1?(o=[],a.push(o)):o.push([t[s],n[s]]);return r({type:"MultiLineString",coordinates:a})}}function O$(e,{x:t,y:n,...r}={}){return[t,n]=ao(t,n),new R$(e,{...r,x:t,y:n})}const L$={ariaLabel:"tick",fill:null,stroke:"currentColor"};class G$ extends Gt{constructor(t,n,r){super(t,n,r,L$),Ja(this,r)}render(t,n,r,i,o){return ut("svg:g",o).call(xn,this,i,o).call(this._transform,this,n).call(a=>a.selectAll().data(t).enter().append("line").call(An,this).attr("x1",this._x1(n,r,i)).attr("x2",this._x2(n,r,i)).attr("y1",this._y1(n,r,i)).attr("y2",this._y2(n,r,i)).call(dr,this,r).call(Au,this,r,o)).node()}}class U$ extends G${constructor(t,n={}){const{x:r,y:i,inset:o=0,insetTop:a=o,insetBottom:s=o}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},n),this.insetTop=Ke(a),this.insetBottom=Ke(s)}_transform(t,n,{x:r}){t.call(Xt,n,{x:r},It,0)}_x1(t,{x:n}){return r=>n[r]}_x2(t,{x:n}){return r=>n[r]}_y1({y:t},{y:n},{marginTop:r}){const{insetTop:i}=this;return n&&t?o=>n[o]+i:r+i}_y2({y:t},{y:n},{height:r,marginBottom:i}){const{insetBottom:o}=this;return n&&t?a=>n[a]+t.bandwidth()-o:r-i-o}}function l0(e,{x:t=vt,...n}={}){return new U$(e,{...n,x:t})}const nw=new Map,rw=new Map,q$=new Map,H$=new Map;function z$(e){return nw.get(e)}function iw(e){return rw.get(e)}function Wo(e){const t=e%12;return t===1||t===3||t===6||t===8||t===10}const dd=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],md=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],pa=[{pitch:0,name:"C",octave:-1,label:"C-1",frequency:8.176},{pitch:1,name:"C#",octave:-1,label:"C#-1",frequency:8.662},{pitch:2,name:"D",octave:-1,label:"D-1",frequency:9.177},{pitch:3,name:"D#",octave:-1,label:"D#-1",frequency:9.723},{pitch:4,name:"E",octave:-1,label:"E-1",frequency:10.301},{pitch:5,name:"F",octave:-1,label:"F-1",frequency:10.913},{pitch:6,name:"F#",octave:-1,label:"F#-1",frequency:11.562},{pitch:7,name:"G",octave:-1,label:"G-1",frequency:12.25},{pitch:8,name:"G#",octave:-1,label:"G#-1",frequency:12.978},{pitch:9,name:"A",octave:-1,label:"A-1",frequency:13.75},{pitch:10,name:"A#",octave:-1,label:"A#-1",frequency:14.568},{pitch:11,name:"B",octave:-1,label:"B-1",frequency:15.434},{pitch:12,name:"C",octave:0,label:"C0",frequency:16.352},{pitch:13,name:"C#",octave:0,label:"C#0",frequency:17.324},{pitch:14,name:"D",octave:0,label:"D0",frequency:18.354},{pitch:15,name:"D#",octave:0,label:"D#0",frequency:19.445},{pitch:16,name:"E",octave:0,label:"E0",frequency:20.602},{pitch:17,name:"F",octave:0,label:"F0",frequency:21.827},{pitch:18,name:"F#",octave:0,label:"F#0",frequency:23.125},{pitch:19,name:"G",octave:0,label:"G0",frequency:24.5},{pitch:20,name:"G#",octave:0,label:"G#0",frequency:25.957},{pitch:21,name:"A",octave:0,label:"A0",frequency:27.5},{pitch:22,name:"A#",octave:0,label:"A#0",frequency:29.135},{pitch:23,name:"B",octave:0,label:"B0",frequency:30.868},{pitch:24,name:"C",octave:1,label:"C1",frequency:32.703},{pitch:25,name:"C#",octave:1,label:"C#1",frequency:34.648},{pitch:26,name:"D",octave:1,label:"D1",frequency:36.708},{pitch:27,name:"D#",octave:1,label:"D#1",frequency:38.891},{pitch:28,name:"E",octave:1,label:"E1",frequency:41.203},{pitch:29,name:"F",octave:1,label:"F1",frequency:43.654},{pitch:30,name:"F#",octave:1,label:"F#1",frequency:46.249},{pitch:31,name:"G",octave:1,label:"G1",frequency:48.999},{pitch:32,name:"G#",octave:1,label:"G#1",frequency:51.913},{pitch:33,name:"A",octave:1,label:"A1",frequency:55},{pitch:34,name:"A#",octave:1,label:"A#1",frequency:58.27},{pitch:35,name:"B",octave:1,label:"B1",frequency:61.735},{pitch:36,name:"C",octave:2,label:"C2",frequency:65.406},{pitch:37,name:"C#",octave:2,label:"C#2",frequency:69.296},{pitch:38,name:"D",octave:2,label:"D2",frequency:73.416},{pitch:39,name:"D#",octave:2,label:"D#2",frequency:77.782},{pitch:40,name:"E",octave:2,label:"E2",frequency:82.407},{pitch:41,name:"F",octave:2,label:"F2",frequency:87.307},{pitch:42,name:"F#",octave:2,label:"F#2",frequency:92.499},{pitch:43,name:"G",octave:2,label:"G2",frequency:97.999},{pitch:44,name:"G#",octave:2,label:"G#2",frequency:103.826},{pitch:45,name:"A",octave:2,label:"A2",frequency:110},{pitch:46,name:"A#",octave:2,label:"A#2",frequency:116.541},{pitch:47,name:"B",octave:2,label:"B2",frequency:123.471},{pitch:48,name:"C",octave:3,label:"C3",frequency:130.813},{pitch:49,name:"C#",octave:3,label:"C#3",frequency:138.591},{pitch:50,name:"D",octave:3,label:"D3",frequency:146.832},{pitch:51,name:"D#",octave:3,label:"D#3",frequency:155.563},{pitch:52,name:"E",octave:3,label:"E3",frequency:164.814},{pitch:53,name:"F",octave:3,label:"F3",frequency:174.614},{pitch:54,name:"F#",octave:3,label:"F#3",frequency:184.997},{pitch:55,name:"G",octave:3,label:"G3",frequency:195.998},{pitch:56,name:"G#",octave:3,label:"G#3",frequency:207.652},{pitch:57,name:"A",octave:3,label:"A3",frequency:220},{pitch:58,name:"A#",octave:3,label:"A#3",frequency:233.082},{pitch:59,name:"B",octave:3,label:"B3",frequency:246.942},{pitch:60,name:"C",octave:4,label:"C4",frequency:261.626},{pitch:61,name:"C#",octave:4,label:"C#4",frequency:277.183},{pitch:62,name:"D",octave:4,label:"D4",frequency:293.665},{pitch:63,name:"D#",octave:4,label:"D#4",frequency:311.127},{pitch:64,name:"E",octave:4,label:"E4",frequency:329.628},{pitch:65,name:"F",octave:4,label:"F4",frequency:349.228},{pitch:66,name:"F#",octave:4,label:"F#4",frequency:369.994},{pitch:67,name:"G",octave:4,label:"G4",frequency:391.995},{pitch:68,name:"G#",octave:4,label:"G#4",frequency:415.305},{pitch:69,name:"A",octave:4,label:"A4",frequency:440},{pitch:70,name:"A#",octave:4,label:"A#4",frequency:466.164},{pitch:71,name:"B",octave:4,label:"B4",frequency:493.883},{pitch:72,name:"C",octave:5,label:"C5",frequency:523.251},{pitch:73,name:"C#",octave:5,label:"C#5",frequency:554.365},{pitch:74,name:"D",octave:5,label:"D5",frequency:587.33},{pitch:75,name:"D#",octave:5,label:"D#5",frequency:622.254},{pitch:76,name:"E",octave:5,label:"E5",frequency:659.255},{pitch:77,name:"F",octave:5,label:"F5",frequency:698.456},{pitch:78,name:"F#",octave:5,label:"F#5",frequency:739.989},{pitch:79,name:"G",octave:5,label:"G5",frequency:783.991},{pitch:80,name:"G#",octave:5,label:"G#5",frequency:830.609},{pitch:81,name:"A",octave:5,label:"A5",frequency:880},{pitch:82,name:"A#",octave:5,label:"A#5",frequency:932.328},{pitch:83,name:"B",octave:5,label:"B5",frequency:987.767},{pitch:84,name:"C",octave:6,label:"C6",frequency:1046.502},{pitch:85,name:"C#",octave:6,label:"C#6",frequency:1108.731},{pitch:86,name:"D",octave:6,label:"D6",frequency:1174.659},{pitch:87,name:"D#",octave:6,label:"D#6",frequency:1244.508},{pitch:88,name:"E",octave:6,label:"E6",frequency:1318.51},{pitch:89,name:"F",octave:6,label:"F6",frequency:1396.913},{pitch:90,name:"F#",octave:6,label:"F#6",frequency:1479.978},{pitch:91,name:"G",octave:6,label:"G6",frequency:1567.982},{pitch:92,name:"G#",octave:6,label:"G#6",frequency:1661.219},{pitch:93,name:"A",octave:6,label:"A6",frequency:1760},{pitch:94,name:"A#",octave:6,label:"A#6",frequency:1864.655},{pitch:95,name:"B",octave:6,label:"B6",frequency:1975.533},{pitch:96,name:"C",octave:7,label:"C7",frequency:2093.005},{pitch:97,name:"C#",octave:7,label:"C#7",frequency:2217.461},{pitch:98,name:"D",octave:7,label:"D7",frequency:2349.318},{pitch:99,name:"D#",octave:7,label:"D#7",frequency:2489.016},{pitch:100,name:"E",octave:7,label:"E7",frequency:2637.02},{pitch:101,name:"F",octave:7,label:"F7",frequency:2793.826},{pitch:102,name:"F#",octave:7,label:"F#7",frequency:2959.955},{pitch:103,name:"G",octave:7,label:"G7",frequency:3135.963},{pitch:104,name:"G#",octave:7,label:"G#7",frequency:3322.438},{pitch:105,name:"A",octave:7,label:"A7",frequency:3520},{pitch:106,name:"A#",octave:7,label:"A#7",frequency:3729.31},{pitch:107,name:"B",octave:7,label:"B7",frequency:3951.066},{pitch:108,name:"C",octave:8,label:"C8",frequency:4186.009},{pitch:109,name:"C#",octave:8,label:"C#8",frequency:4434.922},{pitch:110,name:"D",octave:8,label:"D8",frequency:4698.636},{pitch:111,name:"D#",octave:8,label:"D#8",frequency:4978.032},{pitch:112,name:"E",octave:8,label:"E8",frequency:5274.041},{pitch:113,name:"F",octave:8,label:"F8",frequency:5587.652},{pitch:114,name:"F#",octave:8,label:"F#8",frequency:5919.911},{pitch:115,name:"G",octave:8,label:"G8",frequency:6271.927},{pitch:116,name:"G#",octave:8,label:"G#8",frequency:6644.875},{pitch:117,name:"A",octave:8,label:"A8",frequency:7040},{pitch:118,name:"A#",octave:8,label:"A#8",frequency:7458.62},{pitch:119,name:"B",octave:8,label:"B8",frequency:7902.133},{pitch:120,name:"C",octave:9,label:"C9",frequency:8372.018},{pitch:121,name:"C#",octave:9,label:"C#9",frequency:8869.844},{pitch:122,name:"D",octave:9,label:"D9",frequency:9397.273},{pitch:123,name:"D#",octave:9,label:"D#9",frequency:9956.063},{pitch:124,name:"E",octave:9,label:"E9",frequency:10548.08},{pitch:125,name:"F",octave:9,label:"F9",frequency:11175.3},{pitch:126,name:"F#",octave:9,label:"F#9",frequency:11839.82},{pitch:127,name:"G",octave:9,label:"G9",frequency:12543.85}],V$=[{number:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,group:"Piano",label:"Bright Acoustic Piano"},{number:2,group:"Piano",label:"Electric Grand Piano"},{number:3,group:"Piano",label:"Honky-tonk Piano"},{number:4,group:"Piano",label:"Electric Piano 1"},{number:5,group:"Piano",label:"Electric Piano 2"},{number:6,group:"Piano",label:"Harpsichord"},{number:7,group:"Piano",label:"Clavinet"},{number:8,group:"Chromatic Percussion",label:"Celesta"},{number:9,group:"Chromatic Percussion",label:"Glockenspiel"},{number:10,group:"Chromatic Percussion",label:"Music Box"},{number:11,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,group:"Chromatic Percussion",label:"Marimba"},{number:13,group:"Chromatic Percussion",label:"Xylophone"},{number:14,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,group:"Chromatic Percussion",label:"Dulcimer"},{number:16,group:"Organ",label:"Drawbar Organ"},{number:17,group:"Organ",label:"Percussive Organ"},{number:18,group:"Organ",label:"Rock Organ"},{number:19,group:"Organ",label:"Church Organ"},{number:20,group:"Organ",label:"Reed Organ"},{number:21,group:"Organ",label:"Accordion"},{number:22,group:"Organ",label:"Harmonica"},{number:23,group:"Organ",label:"Tango Accordion"},{number:24,group:"Guitar",label:"Acoustic Guitar(nylon)"},{number:25,group:"Guitar",label:"Acoustic Guitar(steel)"},{number:26,group:"Guitar",label:"Electric Guitar(jazz)"},{number:27,group:"Guitar",label:"Electric Guitar(clean)"},{number:28,group:"Guitar",label:"Electric Guitar(muted)"},{number:29,group:"Guitar",label:"Overdriven Guitar"},{number:30,group:"Guitar",label:"Distortion Guitar"},{number:31,group:"Guitar",label:"Guitar harmonics"},{number:32,group:"Bass",label:"Acoustic Bass"},{number:33,group:"Bass",label:"Electric Bass(finger)"},{number:34,group:"Bass",label:"Electric Bass(pick)"},{number:35,group:"Bass",label:"Fretless Bass"},{number:36,group:"Bass",label:"Slap Bass 1"},{number:37,group:"Bass",label:"Slap Bass 2"},{number:38,group:"Bass",label:"Synth Bass 1"},{number:39,group:"Bass",label:"Synth Bass 2"},{number:40,group:"Strings",label:"Violin"},{number:41,group:"Strings",label:"Viola"},{number:42,group:"Strings",label:"Cello"},{number:43,group:"Strings",label:"Contrabass"},{number:44,group:"Strings",label:"Tremolo Strings"},{number:45,group:"Strings",label:"Pizzicato Strings"},{number:46,group:"Strings",label:"Orchestral Harp"},{number:47,group:"Strings",label:"Timpani"},{number:48,group:"Strings (continued)",label:"String Ensemble 1"},{number:49,group:"Strings (continued)",label:"String Ensemble 2"},{number:50,group:"Strings (continued)",label:"Synth Strings 1"},{number:51,group:"Strings (continued)",label:"Synth Strings 2"},{number:52,group:"Strings (continued)",label:"Choir Aahs"},{number:53,group:"Strings (continued)",label:"Voice Oohs"},{number:54,group:"Strings (continued)",label:"Synth Voice"},{number:55,group:"Strings (continued)",label:"Orchestra Hit"},{number:56,group:"Brass",label:"Trumpet"},{number:57,group:"Brass",label:"Trombone"},{number:58,group:"Brass",label:"Tuba"},{number:59,group:"Brass",label:"Muted Trumpet"},{number:60,group:"Brass",label:"French Horn"},{number:61,group:"Brass",label:"Brass Section"},{number:62,group:"Brass",label:"Synth Brass 1"},{number:63,group:"Brass",label:"Synth Brass 2"},{number:64,group:"Reed",label:"Soprano Sax"},{number:65,group:"Reed",label:"Alto Sax"},{number:66,group:"Reed",label:"Tenor Sax"},{number:67,group:"Reed",label:"Baritone Sax"},{number:68,group:"Reed",label:"Oboe"},{number:69,group:"Reed",label:"English Horn"},{number:70,group:"Reed",label:"Bassoon"},{number:71,group:"Reed",label:"Clarinet"},{number:72,group:"Pipe",label:"Piccolo"},{number:73,group:"Pipe",label:"Flute"},{number:74,group:"Pipe",label:"Recorder"},{number:75,group:"Pipe",label:"Pan Flute"},{number:76,group:"Pipe",label:"Blown Bottle"},{number:77,group:"Pipe",label:"Shakuhachi"},{number:78,group:"Pipe",label:"Whistle"},{number:79,group:"Pipe",label:"Ocarina"},{number:80,group:"Synth Lead",label:"Lead 1(square)"},{number:81,group:"Synth Lead",label:"Lead 2(sawtooth)"},{number:82,group:"Synth Lead",label:"Lead 3(calliope)"},{number:83,group:"Synth Lead",label:"Lead 4(chiff)"},{number:84,group:"Synth Lead",label:"Lead 5(charang)"},{number:85,group:"Synth Lead",label:"Lead 6(voice)"},{number:86,group:"Synth Lead",label:"Lead 7(fifths)"},{number:87,group:"Synth Lead",label:"Lead 8(bass + lead)"},{number:88,group:"Synth Pad",label:"Pad 1(new age)"},{number:89,group:"Synth Pad",label:"Pad 2(warm)"},{number:90,group:"Synth Pad",label:"Pad 3(polysynth)"},{number:91,group:"Synth Pad",label:"Pad 4(choir)"},{number:92,group:"Synth Pad",label:"Pad 5(bowed)"},{number:93,group:"Synth Pad",label:"Pad 6(metallic)"},{number:94,group:"Synth Pad",label:"Pad 7(halo)"},{number:95,group:"Synth Pad",label:"Pad 8(sweep)"},{number:96,group:"Synth Effects",label:"FX 1(rain)"},{number:97,group:"Synth Effects",label:"FX 2(soundtrack)"},{number:98,group:"Synth Effects",label:"FX 3(crystal)"},{number:99,group:"Synth Effects",label:"FX 4(atmosphere)"},{number:100,group:"Synth Effects",label:"FX 5(brightness)"},{number:101,group:"Synth Effects",label:"FX 6(goblins)"},{number:102,group:"Synth Effects",label:"FX 7(echoes)"},{number:103,group:"Synth Effects",label:"FX 8(sci-fi)"},{number:104,group:"Ethnic",label:"Sitar"},{number:105,group:"Ethnic",label:"Banjo"},{number:106,group:"Ethnic",label:"Shamisen"},{number:107,group:"Ethnic",label:"Koto"},{number:108,group:"Ethnic",label:"Kalimba"},{number:109,group:"Ethnic",label:"Bag pipe"},{number:110,group:"Ethnic",label:"Fiddle"},{number:111,group:"Ethnic",label:"Shanai"},{number:112,group:"Percussive",label:"Tinkle Bell"},{number:113,group:"Percussive",label:"Agogo"},{number:114,group:"Percussive",label:"Steel Drums"},{number:115,group:"Percussive",label:"Woodblock"},{number:116,group:"Percussive",label:"Taiko Drum"},{number:117,group:"Percussive",label:"Melodic Tom"},{number:118,group:"Percussive",label:"Synth Drum"},{number:119,group:"Sound Effects",label:"Reverse Cymbal"},{number:120,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,group:"Sound Effects",label:"Breath Noise"},{number:122,group:"Sound Effects",label:"Seashore"},{number:123,group:"Sound Effects",label:"Bird Tweet"},{number:124,group:"Sound Effects",label:"Telephone Ring"},{number:125,group:"Sound Effects",label:"Helicopter"},{number:126,group:"Sound Effects",label:"Applause"},{number:127,group:"Sound Effects",label:"Gunshot"}],Y$=[{number:1,subnumber:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,subnumber:1,group:"Piano",label:"Wide Acoustic Grand"},{number:1,subnumber:2,group:"Piano",label:"Dark Acoustic Grand"},{number:2,subnumber:0,group:"Piano",label:"Bright Acoustic Piano"},{number:2,subnumber:1,group:"Piano",label:"Wide Bright Acoustic"},{number:3,subnumber:0,group:"Piano",label:"Electric Grand Piano"},{number:3,subnumber:1,group:"Piano",label:"Wide Electric Grand"},{number:4,subnumber:0,group:"Piano",label:"Honky-tonk Piano"},{number:4,subnumber:1,group:"Piano",label:"Wide Honky-tonk"},{number:5,subnumber:0,group:"Piano",label:"Rhodes Piano"},{number:5,subnumber:1,group:"Piano",label:"Detuned Electric Piano 1"},{number:5,subnumber:2,group:"Piano",label:"Electric Piano 1 Variation"},{number:5,subnumber:3,group:"Piano",label:"60's Electric Piano"},{number:6,subnumber:0,group:"Piano",label:"Chorused Electric Piano"},{number:6,subnumber:1,group:"Piano",label:"Detuned Electric Piano 2"},{number:6,subnumber:2,group:"Piano",label:"Electric Piano 2 Variation"},{number:6,subnumber:3,group:"Piano",label:"Electric Piano Legend"},{number:6,subnumber:4,group:"Piano",label:"Electric Piano Phase"},{number:7,subnumber:0,group:"Piano",label:"Harpsichord"},{number:7,subnumber:1,group:"Piano",label:"Coupled Harpsichord"},{number:7,subnumber:2,group:"Piano",label:"Wide Harpsichord"},{number:7,subnumber:3,group:"Piano",label:"Open Harpsichord"},{number:8,subnumber:0,group:"Piano",label:"Clavinet"},{number:8,subnumber:1,group:"Piano",label:"Pulse Clavinet"},{number:9,subnumber:0,group:"Chromatic Percussion",label:"Celesta"},{number:10,subnumber:0,group:"Chromatic Percussion",label:"Glockenspiel"},{number:11,subnumber:0,group:"Chromatic Percussion",label:"Music Box"},{number:12,subnumber:0,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,subnumber:1,group:"Chromatic Percussion",label:"Wet Vibraphone"},{number:13,subnumber:0,group:"Chromatic Percussion",label:"Marimba"},{number:13,subnumber:1,group:"Chromatic Percussion",label:"Wide Marimba"},{number:14,subnumber:0,group:"Chromatic Percussion",label:"Xylophone"},{number:15,subnumber:0,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,subnumber:1,group:"Chromatic Percussion",label:"Church Bells"},{number:15,subnumber:2,group:"Chromatic Percussion",label:"Carillon"},{number:16,subnumber:0,group:"Chromatic Percussion",label:"Dulcimer / Santur"},{number:17,subnumber:0,group:"Organ",label:"Hammond Organ"},{number:17,subnumber:1,group:"Organ",label:"Detuned Organ 1"},{number:17,subnumber:2,group:"Organ",label:"60's Organ 1"},{number:17,subnumber:3,group:"Organ",label:"Organ 4"},{number:18,subnumber:0,group:"Organ",label:"Percussive Organ"},{number:18,subnumber:1,group:"Organ",label:"Detuned Organ 2"},{number:18,subnumber:2,group:"Organ",label:"Organ 5"},{number:19,subnumber:0,group:"Organ",label:"Rock Organ"},{number:20,subnumber:0,group:"Organ",label:"Church Organ 1"},{number:20,subnumber:1,group:"Organ",label:"Church Organ 2"},{number:20,subnumber:2,group:"Organ",label:"Church Organ 3"},{number:21,subnumber:0,group:"Organ",label:"Reed Organ"},{number:21,subnumber:1,group:"Organ",label:"Puff Organ"},{number:22,subnumber:0,group:"Organ",label:"French Accordion"},{number:22,subnumber:1,group:"Organ",label:"Italian Accordion"},{number:23,subnumber:0,group:"Organ",label:"Harmonica"},{number:24,subnumber:0,group:"Organ",label:"Bandoneon"},{number:25,subnumber:0,group:"Guitar",label:"Nylon-String Guitar"},{number:25,subnumber:1,group:"Guitar",label:"Ukelele"},{number:25,subnumber:2,group:"Guitar",label:"Open Nylon Guitar"},{number:25,subnumber:3,group:"Guitar",label:"Nylon Guitar 2"},{number:26,subnumber:0,group:"Guitar",label:"Steel-String Guitar"},{number:26,subnumber:1,group:"Guitar",label:"12-String Guitar"},{number:26,subnumber:2,group:"Guitar",label:"Mandolin"},{number:26,subnumber:3,group:"Guitar",label:"Steel + Body"},{number:27,subnumber:0,group:"Guitar",label:"Jazz Guitar"},{number:27,subnumber:1,group:"Guitar",label:"Hawaiian Guitar"},{number:28,subnumber:0,group:"Guitar",label:"Clean Electric Guitar"},{number:28,subnumber:1,group:"Guitar",label:"Chorus Guitar"},{number:28,subnumber:2,group:"Guitar",label:"Mid Tone Guitar"},{number:29,subnumber:0,group:"Guitar",label:"Muted Electric Guitar"},{number:29,subnumber:1,group:"Guitar",label:"Funk Guitar"},{number:29,subnumber:2,group:"Guitar",label:"Funk Guitar 2"},{number:29,subnumber:3,group:"Guitar",label:"Jazz Man"},{number:30,subnumber:0,group:"Guitar",label:"Overdriven Guitar"},{number:30,subnumber:1,group:"Guitar",label:"Guitar Pinch"},{number:31,subnumber:0,group:"Guitar",label:"Distortion Guitar"},{number:31,subnumber:1,group:"Guitar",label:"Feedback Guitar"},{number:31,subnumber:2,group:"Guitar",label:"Distortion Rtm Guitar"},{number:32,subnumber:0,group:"Guitar",label:"Guitar Harmonics"},{number:32,subnumber:1,group:"Guitar",label:"Guitar Feedback"},{number:33,subnumber:0,group:"Bass",label:"Acoustic Bass"},{number:34,subnumber:0,group:"Bass",label:"Fingered Bass"},{number:34,subnumber:1,group:"Bass",label:"Finger Slap"},{number:35,subnumber:0,group:"Bass",label:"Picked Bass"},{number:36,subnumber:0,group:"Bass",label:"Fretless Bass"},{number:37,subnumber:0,group:"Bass",label:"Slap Bass 1"},{number:38,subnumber:0,group:"Bass",label:"Slap Bass 2"},{number:39,subnumber:0,group:"Bass",label:"Synth Bass 1"},{number:39,subnumber:1,group:"Bass",label:"Synth Bass 101"},{number:39,subnumber:2,group:"Bass",label:"Synth Bass 3"},{number:39,subnumber:3,group:"Bass",label:"Clavi Bass"},{number:39,subnumber:4,group:"Bass",label:"Hammer"},{number:40,subnumber:0,group:"Bass",label:"Synth Bass 2"},{number:40,subnumber:1,group:"Bass",label:"Synth Bass 4"},{number:40,subnumber:2,group:"Bass",label:"Rubber Bass"},{number:40,subnumber:3,group:"Bass",label:"Attack Pulse"},{number:41,subnumber:0,group:"Strings",label:"Violin"},{number:41,subnumber:1,group:"Strings",label:"Slow Violin"},{number:42,subnumber:0,group:"Strings",label:"Viola"},{number:43,subnumber:0,group:"Strings",label:"Cello"},{number:44,subnumber:0,group:"Strings",label:"Contrabass"},{number:45,subnumber:0,group:"Strings",label:"Tremolo Strings"},{number:46,subnumber:0,group:"Strings",label:"Pizzicato Strings"},{number:47,subnumber:0,group:"Strings",label:"Harp"},{number:47,subnumber:1,group:"Strings",label:"Yang Qin"},{number:48,subnumber:0,group:"Strings",label:"Timpani"},{number:49,subnumber:0,group:"Orchestral Ensemble",label:"String Ensemble"},{number:49,subnumber:1,group:"Orchestral Ensemble",label:"Orchestra Strings"},{number:49,subnumber:2,group:"Orchestral Ensemble",label:"60's Strings"},{number:50,subnumber:0,group:"Orchestral Ensemble",label:"Slow String Ensemble"},{number:51,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 1"},{number:51,subnumber:1,group:"Orchestral Ensemble",label:"Synth Strings 3"},{number:52,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 2"},{number:53,subnumber:0,group:"Orchestral Ensemble",label:"Choir Aahs"},{number:53,subnumber:1,group:"Orchestral Ensemble",label:"Choir Aahs 2"},{number:54,subnumber:0,group:"Orchestral Ensemble",label:"Voice Oohs"},{number:54,subnumber:1,group:"Orchestral Ensemble",label:"Humming"},{number:55,subnumber:0,group:"Orchestral Ensemble",label:"Synth Voice"},{number:55,subnumber:1,group:"Orchestral Ensemble",label:"Analog Voice"},{number:56,subnumber:0,group:"Orchestral Ensemble",label:"Orchestra Hit"},{number:56,subnumber:1,group:"Orchestral Ensemble",label:"Bass Hit"},{number:56,subnumber:2,group:"Orchestral Ensemble",label:"6th Hit"},{number:56,subnumber:3,group:"Orchestral Ensemble",label:"Euro Hit"},{number:57,subnumber:0,group:"Brass",label:"Trumpet"},{number:57,subnumber:1,group:"Brass",label:"Dark Trumpet"},{number:58,subnumber:0,group:"Brass",label:"Trombone"},{number:58,subnumber:1,group:"Brass",label:"Trombone 2"},{number:58,subnumber:2,group:"Brass",label:"Bright Trombone"},{number:59,subnumber:0,group:"Brass",label:"Tuba"},{number:60,subnumber:0,group:"Brass",label:"Muted Trumpet"},{number:60,subnumber:1,group:"Brass",label:"Muted Trumpet 2"},{number:61,subnumber:0,group:"Brass",label:"French Horn"},{number:61,subnumber:1,group:"Brass",label:"French Horn 2"},{number:62,subnumber:0,group:"Brass",label:"Brass Section"},{number:62,subnumber:1,group:"Brass",label:"Brass Section"},{number:63,subnumber:0,group:"Brass",label:"Synth Brass 1"},{number:63,subnumber:1,group:"Brass",label:"Synth Brass 3"},{number:63,subnumber:2,group:"Brass",label:"Analog Brass 1"},{number:63,subnumber:3,group:"Brass",label:"Jump Brass"},{number:64,subnumber:0,group:"Brass",label:"Synth Brass 2"},{number:64,subnumber:1,group:"Brass",label:"Synth Brass 4"},{number:64,subnumber:2,group:"Brass",label:"Analog Brass 2"},{number:65,subnumber:0,group:"Reed",label:"Soprano Sax"},{number:66,subnumber:0,group:"Reed",label:"Alto Sax"},{number:67,subnumber:0,group:"Reed",label:"Tenor Sax"},{number:68,subnumber:0,group:"Reed",label:"Baritone Sax"},{number:69,subnumber:0,group:"Reed",label:"Oboe"},{number:70,subnumber:0,group:"Reed",label:"English Horn"},{number:71,subnumber:0,group:"Reed",label:"Bassoon"},{number:72,subnumber:0,group:"Reed",label:"Clarinet"},{number:73,subnumber:0,group:"Wind",label:"Piccolo"},{number:74,subnumber:0,group:"Wind",label:"Flute"},{number:75,subnumber:0,group:"Wind",label:"Recorder"},{number:76,subnumber:0,group:"Wind",label:"Pan Flute"},{number:77,subnumber:0,group:"Wind",label:"Blown Bottle"},{number:78,subnumber:0,group:"Wind",label:"Shakuhachi"},{number:79,subnumber:0,group:"Wind",label:"Whistle"},{number:80,subnumber:0,group:"Wind",label:"Ocarina"},{number:81,subnumber:0,group:"Lead",label:"Square Lead"},{number:81,subnumber:1,group:"Lead",label:"Square Wave"},{number:81,subnumber:2,group:"Lead",label:"Sine Wave"},{number:82,subnumber:0,group:"Lead",label:"Saw Lead"},{number:82,subnumber:1,group:"Lead",label:"Saw Wave"},{number:82,subnumber:2,group:"Lead",label:"Doctor Solo"},{number:82,subnumber:3,group:"Lead",label:"Natural Lead"},{number:82,subnumber:4,group:"Lead",label:"Sequenced Saw"},{number:83,subnumber:0,group:"Lead",label:"Synth Calliope"},{number:84,subnumber:0,group:"Lead",label:"Chiffer Lead"},{number:85,subnumber:0,group:"Lead",label:"Charang"},{number:85,subnumber:1,group:"Lead",label:"Wire Lead"},{number:86,subnumber:0,group:"Lead",label:"Solo Synth Vox"},{number:87,subnumber:0,group:"Lead",label:"5th Saw Wave"},{number:88,subnumber:0,group:"Lead",label:"Bass & Lead"},{number:88,subnumber:1,group:"Lead",label:"Delayed Lead"},{number:89,subnumber:0,group:"Synth Pad",label:"Fantasia Pad"},{number:90,subnumber:0,group:"Synth Pad",label:"Warm Pad"},{number:90,subnumber:1,group:"Synth Pad",label:"Sine Pad"},{number:91,subnumber:0,group:"Synth Pad",label:"Polysynth Pad"},{number:92,subnumber:0,group:"Synth Pad",label:"Space Voice Pad"},{number:92,subnumber:1,group:"Synth Pad",label:"Itopia"},{number:93,subnumber:0,group:"Synth Pad",label:"Bowed Glass Pad"},{number:94,subnumber:0,group:"Synth Pad",label:"Metal Pad"},{number:95,subnumber:0,group:"Synth Pad",label:"Halo Pad"},{number:96,subnumber:0,group:"Synth Pad",label:"Sweep Pad"},{number:97,subnumber:0,group:"Synth Effects",label:"Ice Rain"},{number:98,subnumber:0,group:"Synth Effects",label:"Soundtrack"},{number:99,subnumber:0,group:"Synth Effects",label:"Crystal"},{number:99,subnumber:1,group:"Synth Effects",label:"Synth Mallet"},{number:100,subnumber:0,group:"Synth Effects",label:"Atmosphere"},{number:101,subnumber:0,group:"Synth Effects",label:"Brightness"},{number:102,subnumber:0,group:"Synth Effects",label:"Goblin"},{number:103,subnumber:0,group:"Synth Effects",label:"Echo Drops"},{number:103,subnumber:1,group:"Synth Effects",label:"Echo Bell"},{number:103,subnumber:2,group:"Synth Effects",label:"Echo Pan"},{number:104,subnumber:0,group:"Synth Effects",label:"Star Theme"},{number:105,subnumber:0,group:"Ethnic",label:"Sitar"},{number:105,subnumber:1,group:"Ethnic",label:"Sitar 2"},{number:106,subnumber:0,group:"Ethnic",label:"Banjo"},{number:107,subnumber:0,group:"Ethnic",label:"Shamisen"},{number:108,subnumber:0,group:"Ethnic",label:"Koto"},{number:108,subnumber:1,group:"Ethnic",label:"Taisho Koto"},{number:109,subnumber:0,group:"Ethnic",label:"Kalimba"},{number:110,subnumber:0,group:"Ethnic",label:"Bagpipe"},{number:111,subnumber:0,group:"Ethnic",label:"Fiddle"},{number:112,subnumber:0,group:"Ethnic",label:"Shanai"},{number:113,subnumber:0,group:"Percussive",label:"Tinkle Bell"},{number:114,subnumber:0,group:"Percussive",label:"Agogo"},{number:115,subnumber:0,group:"Percussive",label:"Steel Drums"},{number:116,subnumber:0,group:"Percussive",label:"Woodblock"},{number:116,subnumber:1,group:"Percussive",label:"Castanets"},{number:117,subnumber:0,group:"Percussive",label:"Taiko Drum"},{number:117,subnumber:1,group:"Percussive",label:"Concert Bass Drum"},{number:118,subnumber:0,group:"Percussive",label:"Melodic Tom 1"},{number:118,subnumber:1,group:"Percussive",label:"Melodic Tom 2"},{number:119,subnumber:0,group:"Percussive",label:"Synth Drum"},{number:119,subnumber:1,group:"Percussive",label:"808 Tom"},{number:119,subnumber:2,group:"Percussive",label:"Electric Percussion"},{number:120,subnumber:0,group:"Percussive",label:"Reverse Cymbal"},{number:121,subnumber:0,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,subnumber:1,group:"Sound Effects",label:"Guitar Cut Noise"},{number:121,subnumber:2,group:"Sound Effects",label:"String Slap"},{number:122,subnumber:0,group:"Sound Effects",label:"Breath Noise"},{number:122,subnumber:1,group:"Sound Effects",label:"Flute Key Click"},{number:123,subnumber:0,group:"Sound Effects",label:"Seashore"},{number:123,subnumber:1,group:"Sound Effects",label:"Rain"},{number:123,subnumber:2,group:"Sound Effects",label:"Thunder"},{number:123,subnumber:3,group:"Sound Effects",label:"Wind"},{number:123,subnumber:4,group:"Sound Effects",label:"Stream"},{number:123,subnumber:5,group:"Sound Effects",label:"Bubble"},{number:124,subnumber:0,group:"Sound Effects",label:"Bird Tweet"},{number:124,subnumber:1,group:"Sound Effects",label:"Dog"},{number:124,subnumber:2,group:"Sound Effects",label:"Horse Gallop"},{number:124,subnumber:3,group:"Sound Effects",label:"Bird 2"},{number:125,subnumber:0,group:"Sound Effects",label:"Telephone 1"},{number:125,subnumber:1,group:"Sound Effects",label:"Telephone 2"},{number:125,subnumber:2,group:"Sound Effects",label:"Door Creaking"},{number:125,subnumber:3,group:"Sound Effects",label:"Door Closing"},{number:125,subnumber:4,group:"Sound Effects",label:"Scratch"},{number:125,subnumber:5,group:"Sound Effects",label:"Wind Chimes"},{number:126,subnumber:0,group:"Sound Effects",label:"Helicopter"},{number:126,subnumber:1,group:"Sound Effects",label:"Car Engine"},{number:126,subnumber:2,group:"Sound Effects",label:"Car Stop"},{number:126,subnumber:3,group:"Sound Effects",label:"Car Pass"},{number:126,subnumber:4,group:"Sound Effects",label:"Car Crash"},{number:126,subnumber:5,group:"Sound Effects",label:"Siren"},{number:126,subnumber:6,group:"Sound Effects",label:"Train"},{number:126,subnumber:7,group:"Sound Effects",label:"Jetplane"},{number:126,subnumber:8,group:"Sound Effects",label:"Starship"},{number:126,subnumber:9,group:"Sound Effects",label:"Burst Noise"},{number:127,subnumber:0,group:"Sound Effects",label:"Applause"},{number:127,subnumber:1,group:"Sound Effects",label:"Laughing"},{number:127,subnumber:2,group:"Sound Effects",label:"Screaming"},{number:127,subnumber:3,group:"Sound Effects",label:"Punch"},{number:127,subnumber:4,group:"Sound Effects",label:"Heart Beat"},{number:127,subnumber:5,group:"Sound Effects",label:"Footsteps"},{number:128,subnumber:0,group:"Sound Effects",label:"Gun Shot"},{number:128,subnumber:1,group:"Sound Effects",label:"Machine Gun"},{number:128,subnumber:2,group:"Sound Effects",label:"Lasergun"},{number:128,subnumber:3,group:"Sound Effects",label:"Explosion"}];for(const e of pa)nw.set(e.pitch,e),rw.set(e.label,e);for(const e of V$)q$.set(e.number,e);for(const e of Y$){const t=`${e.number}-${e.subnumber}`;H$.set(t,e)}var W$={value:()=>{}};function ow(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Bs(n)}function Bs(e){this._=e}function X$(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Bs.prototype=ow.prototype={constructor:Bs,on:function(e,t){var n=this._,r=X$(e+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(e=r[o]).type)&&(i=j$(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(i=(e=r[o]).type)n[i]=u0(n[i],e.name,t);else if(t==null)for(i in n)n[i]=u0(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Bs(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function j$(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function u0(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=W$,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Lf="http://www.w3.org/1999/xhtml";const c0={svg:"http://www.w3.org/2000/svg",xhtml:Lf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Nu(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),c0.hasOwnProperty(t)?{space:c0[t],local:e}:e}function K$(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Lf&&t.documentElement.namespaceURI===Lf?t.createElement(e):t.createElementNS(n,e)}}function Z$(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function aw(e){var t=Nu(e);return(t.local?Z$:K$)(t)}function Q$(){}function pd(e){return e==null?Q$:function(){return this.querySelector(e)}}function J$(e){typeof e!="function"&&(e=pd(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=e.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new ln(r,this._parents)}function sw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function eT(){return[]}function lw(e){return e==null?eT:function(){return this.querySelectorAll(e)}}function tT(e){return function(){var t=e.apply(this,arguments);return t==null?[]:sw(t)}}function nT(e){typeof e=="function"?e=tT(e):e=lw(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(r.push(e.call(l,l.__data__,u,a)),i.push(l));return new ln(r,i)}function uw(e){return function(){return this.matches(e)}}function cw(e){return function(t){return t.matches(e)}}var rT=Array.prototype.find;function iT(e){return function(){return rT.call(this.children,e)}}function oT(){return this.firstElementChild}function aT(e){return this.select(e==null?oT:iT(typeof e=="function"?e:cw(e)))}var sT=Array.prototype.filter;function lT(){return this.children}function uT(e){return function(){return sT.call(this.children,e)}}function cT(e){return this.selectAll(e==null?lT:uT(typeof e=="function"?e:cw(e)))}function fT(e){typeof e!="function"&&(e=uw(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new ln(r,this._parents)}function fw(e){return new Array(e.length)}function hT(){return new ln(this._enter||this._groups.map(fw),this._parents)}function Cl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Cl.prototype={constructor:Cl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function dT(e){return function(){return e}}function mT(e,t,n,r,i,o){for(var a=0,s,l=t.length,u=o.length;a<u;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new Cl(e,o[a]);for(;a<l;++a)(s=t[a])&&(i[a]=s)}function pT(e,t,n,r,i,o,a){var s,l,u=new Map,c=t.length,h=o.length,f=new Array(c),d;for(s=0;s<c;++s)(l=t[s])&&(f[s]=d=a.call(l,l.__data__,s,t)+"",u.has(d)?i[s]=l:u.set(d,l));for(s=0;s<h;++s)d=a.call(e,o[s],s,o)+"",(l=u.get(d))?(r[s]=l,l.__data__=o[s],u.delete(d)):n[s]=new Cl(e,o[s]);for(s=0;s<c;++s)(l=t[s])&&u.get(f[s])===l&&(i[s]=l)}function bT(e){return e.__data__}function gT(e,t){if(!arguments.length)return Array.from(this,bT);var n=t?pT:mT,r=this._parents,i=this._groups;typeof e!="function"&&(e=dT(e));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],h=i[u],f=h.length,d=sw(e.call(c,c&&c.__data__,u,r)),m=d.length,b=s[u]=new Array(m),g=a[u]=new Array(m),E=l[u]=new Array(f);n(c,h,b,g,E,d,t);for(var _=0,y=0,v,x;_<m;++_)if(v=b[_]){for(_>=y&&(y=_+1);!(x=g[y])&&++y<m;);v._next=x||null}}return a=new ln(a,r),a._enter=s,a._exit=l,a}function yT(){return new ln(this._exit||this._groups.map(fw),this._parents)}function _T(e,t,n){var r=this.enter(),i=this,o=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(i=t(i)),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function vT(e){if(!(e instanceof ln))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=t[s],u=n[s],c=l.length,h=a[s]=new Array(c),f,d=0;d<c;++d)(f=l[d]||u[d])&&(h[d]=f);for(;s<r;++s)a[s]=t[s];return new ln(a,this._parents)}function wT(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function MT(e){e||(e=ET);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,l=i[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(t)}return new ln(i,this._parents).order()}function ET(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ST(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function xT(){return Array.from(this)}function AT(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function CT(){let e=0;for(const t of this)++e;return e}function PT(){return!this.node()}function NT(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&e.call(s,s.__data__,o,i);return this}function $T(e){return function(){this.removeAttribute(e)}}function TT(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kT(e,t){return function(){this.setAttribute(e,t)}}function IT(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function DT(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function FT(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function RT(e,t){var n=Nu(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?TT:$T:typeof t=="function"?n.local?FT:DT:n.local?IT:kT)(n,t))}function hw(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function BT(e){return function(){this.style.removeProperty(e)}}function OT(e,t,n){return function(){this.style.setProperty(e,t,n)}}function LT(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function GT(e,t,n){return arguments.length>1?this.each((t==null?BT:typeof t=="function"?LT:OT)(e,t,n??"")):Qi(this.node(),e)}function Qi(e,t){return e.style.getPropertyValue(t)||hw(e).getComputedStyle(e,null).getPropertyValue(t)}function UT(e){return function(){delete this[e]}}function qT(e,t){return function(){this[e]=t}}function HT(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function zT(e,t){return arguments.length>1?this.each((t==null?UT:typeof t=="function"?HT:qT)(e,t)):this.node()[e]}function dw(e){return e.trim().split(/^|\s+/)}function bd(e){return e.classList||new mw(e)}function mw(e){this._node=e,this._names=dw(e.getAttribute("class")||"")}mw.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function pw(e,t){for(var n=bd(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function bw(e,t){for(var n=bd(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function VT(e){return function(){pw(this,e)}}function YT(e){return function(){bw(this,e)}}function WT(e,t){return function(){(t.apply(this,arguments)?pw:bw)(this,e)}}function XT(e,t){var n=dw(e+"");if(arguments.length<2){for(var r=bd(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?WT:t?VT:YT)(n,t))}function jT(){this.textContent=""}function KT(e){return function(){this.textContent=e}}function ZT(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function QT(e){return arguments.length?this.each(e==null?jT:(typeof e=="function"?ZT:KT)(e)):this.node().textContent}function JT(){this.innerHTML=""}function ek(e){return function(){this.innerHTML=e}}function tk(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function nk(e){return arguments.length?this.each(e==null?JT:(typeof e=="function"?tk:ek)(e)):this.node().innerHTML}function rk(){this.nextSibling&&this.parentNode.appendChild(this)}function ik(){return this.each(rk)}function ok(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ak(){return this.each(ok)}function sk(e){var t=typeof e=="function"?e:aw(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function lk(){return null}function uk(e,t){var n=typeof e=="function"?e:aw(e),r=t==null?lk:typeof t=="function"?t:pd(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ck(){var e=this.parentNode;e&&e.removeChild(this)}function fk(){return this.each(ck)}function hk(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function dk(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function mk(e){return this.select(e?dk:hk)}function pk(e){return arguments.length?this.property("__data__",e):this.node().__data__}function bk(e){return function(t){e.call(this,t,this.__data__)}}function gk(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function yk(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function _k(e,t,n){return function(){var r=this.__on,i,o=bk(t);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function vk(e,t,n){var r=gk(e+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=t?_k:yk,i=0;i<o;++i)this.each(s(r[i],t,n));return this}function gw(e,t,n){var r=hw(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function wk(e,t){return function(){return gw(this,e,t)}}function Mk(e,t){return function(){return gw(this,e,t.apply(this,arguments))}}function Ek(e,t){return this.each((typeof t=="function"?Mk:wk)(e,t))}function*Sk(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var xk=[null];function ln(e,t){this._groups=e,this._parents=t}function ts(){return new ln([[document.documentElement]],xk)}function Ak(){return this}ln.prototype=ts.prototype={constructor:ln,select:J$,selectAll:nT,selectChild:aT,selectChildren:cT,filter:fT,data:gT,enter:hT,exit:yT,join:_T,merge:vT,selection:Ak,order:wT,sort:MT,call:ST,nodes:xT,node:AT,size:CT,empty:PT,each:NT,attr:RT,style:GT,property:zT,classed:XT,text:QT,html:nk,raise:ik,lower:ak,append:sk,insert:uk,remove:fk,clone:mk,datum:pk,on:vk,dispatch:Ek,[Symbol.iterator]:Sk};function gd(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function yw(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ns(){}var ba=.7,Pl=1/ba,ki="\\s*([+-]?\\d+)\\s*",ga="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ck=/^#([0-9a-f]{3,8})$/,Pk=new RegExp("^rgb\\("+[ki,ki,ki]+"\\)$"),Nk=new RegExp("^rgb\\("+[Rn,Rn,Rn]+"\\)$"),$k=new RegExp("^rgba\\("+[ki,ki,ki,ga]+"\\)$"),Tk=new RegExp("^rgba\\("+[Rn,Rn,Rn,ga]+"\\)$"),kk=new RegExp("^hsl\\("+[ga,Rn,Rn]+"\\)$"),Ik=new RegExp("^hsla\\("+[ga,Rn,Rn,ga]+"\\)$"),f0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gd(ns,Ji,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:h0,formatHex:h0,formatHsl:Dk,formatRgb:d0,toString:d0});function h0(){return this.rgb().formatHex()}function Dk(){return _w(this).formatHsl()}function d0(){return this.rgb().formatRgb()}function Ji(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ck.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?m0(t):n===3?new zt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?xs(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?xs(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Pk.exec(e))?new zt(t[1],t[2],t[3],1):(t=Nk.exec(e))?new zt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$k.exec(e))?xs(t[1],t[2],t[3],t[4]):(t=Tk.exec(e))?xs(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=kk.exec(e))?g0(t[1],t[2]/100,t[3]/100,1):(t=Ik.exec(e))?g0(t[1],t[2]/100,t[3]/100,t[4]):f0.hasOwnProperty(e)?m0(f0[e]):e==="transparent"?new zt(NaN,NaN,NaN,0):null}function m0(e){return new zt(e>>16&255,e>>8&255,e&255,1)}function xs(e,t,n,r){return r<=0&&(e=t=n=NaN),new zt(e,t,n,r)}function Fk(e){return e instanceof ns||(e=Ji(e)),e?(e=e.rgb(),new zt(e.r,e.g,e.b,e.opacity)):new zt}function Gf(e,t,n,r){return arguments.length===1?Fk(e):new zt(e,t,n,r??1)}function zt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}gd(zt,Gf,yw(ns,{brighter:function(e){return e=e==null?Pl:Math.pow(Pl,e),new zt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?ba:Math.pow(ba,e),new zt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:p0,formatHex:p0,formatRgb:b0,toString:b0}));function p0(){return"#"+Sc(this.r)+Sc(this.g)+Sc(this.b)}function b0(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Sc(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function g0(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new kn(e,t,n,r)}function _w(e){if(e instanceof kn)return new kn(e.h,e.s,e.l,e.opacity);if(e instanceof ns||(e=Ji(e)),!e)return new kn;if(e instanceof kn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,s=o-i,l=(o+i)/2;return s?(t===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-t)/s+2:a=(t-n)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new kn(a,s,l,e.opacity)}function vw(e,t,n,r){return arguments.length===1?_w(e):new kn(e,t,n,r??1)}function kn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}gd(kn,vw,yw(ns,{brighter:function(e){return e=e==null?Pl:Math.pow(Pl,e),new kn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?ba:Math.pow(ba,e),new kn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new zt(xc(e>=240?e-240:e+120,i,r),xc(e,i,r),xc(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function xc(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ww=e=>()=>e;function Rk(e,t){return function(n){return e+n*t}}function Bk(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ok(e){return(e=+e)==1?Mw:function(t,n){return n-t?Bk(t,n,e):ww(isNaN(t)?n:t)}}function Mw(e,t){var n=t-e;return n?Rk(e,n):ww(isNaN(e)?t:e)}const Uf=function e(t){var n=Ok(t);function r(i,o){var a=n((i=Gf(i)).r,(o=Gf(o)).r),s=n(i.g,o.g),l=n(i.b,o.b),u=Mw(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=e,r}(1);function br(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var qf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ac=new RegExp(qf.source,"g");function Lk(e){return function(){return e}}function Gk(e){return function(t){return e(t)+""}}function Uk(e,t){var n=qf.lastIndex=Ac.lastIndex=0,r,i,o,a=-1,s=[],l=[];for(e=e+"",t=t+"";(r=qf.exec(e))&&(i=Ac.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:br(r,i)})),n=Ac.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?Gk(l[0].x):Lk(t):(t=l.length,function(u){for(var c=0,h;c<t;++c)s[(h=l[c]).i]=h.x(u);return s.join("")})}var y0=180/Math.PI,Hf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ew(e,t,n,r,i,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*y0,skewX:Math.atan(l)*y0,scaleX:a,scaleY:s}}var As;function qk(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Hf:Ew(t.a,t.b,t.c,t.d,t.e,t.f)}function Hk(e){return e==null||(As||(As=document.createElementNS("http://www.w3.org/2000/svg","g")),As.setAttribute("transform",e),!(e=As.transform.baseVal.consolidate()))?Hf:(e=e.matrix,Ew(e.a,e.b,e.c,e.d,e.e,e.f))}function Sw(e,t,n,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,h,f,d,m){if(u!==h||c!==f){var b=d.push("translate(",null,t,null,n);m.push({i:b-4,x:br(u,h)},{i:b-2,x:br(c,f)})}else(h||f)&&d.push("translate("+h+t+f+n)}function a(u,c,h,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:br(u,c)})):c&&h.push(i(h)+"rotate("+c+r)}function s(u,c,h,f){u!==c?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:br(u,c)}):c&&h.push(i(h)+"skewX("+c+r)}function l(u,c,h,f,d,m){if(u!==h||c!==f){var b=d.push(i(d)+"scale(",null,",",null,")");m.push({i:b-4,x:br(u,h)},{i:b-2,x:br(c,f)})}else(h!==1||f!==1)&&d.push(i(d)+"scale("+h+","+f+")")}return function(u,c){var h=[],f=[];return u=e(u),c=e(c),o(u.translateX,u.translateY,c.translateX,c.translateY,h,f),a(u.rotate,c.rotate,h,f),s(u.skewX,c.skewX,h,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,h,f),u=c=null,function(d){for(var m=-1,b=f.length,g;++m<b;)h[(g=f[m]).i]=g.x(d);return h.join("")}}}var zk=Sw(qk,"px, ","px)","deg)"),Vk=Sw(Hk,", ",")",")"),eo=0,Fo=0,xo=0,xw=1e3,Nl,Ro,$l=0,oi=0,$u=0,ya=typeof performance=="object"&&performance.now?performance:Date,Aw=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function yd(){return oi||(Aw(Yk),oi=ya.now()+$u)}function Yk(){oi=0}function Tl(){this._call=this._time=this._next=null}Tl.prototype=Cw.prototype={constructor:Tl,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?yd():+n)+(t==null?0:+t),!this._next&&Ro!==this&&(Ro?Ro._next=this:Nl=this,Ro=this),this._call=e,this._time=n,zf()},stop:function(){this._call&&(this._call=null,this._time=1/0,zf())}};function Cw(e,t,n){var r=new Tl;return r.restart(e,t,n),r}function Wk(){yd(),++eo;for(var e=Nl,t;e;)(t=oi-e._time)>=0&&e._call.call(null,t),e=e._next;--eo}function _0(){oi=($l=ya.now())+$u,eo=Fo=0;try{Wk()}finally{eo=0,jk(),oi=0}}function Xk(){var e=ya.now(),t=e-$l;t>xw&&($u-=t,$l=e)}function jk(){for(var e,t=Nl,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Nl=n);Ro=e,zf(r)}function zf(e){if(!eo){Fo&&(Fo=clearTimeout(Fo));var t=e-oi;t>24?(e<1/0&&(Fo=setTimeout(_0,e-ya.now()-$u)),xo&&(xo=clearInterval(xo))):(xo||($l=ya.now(),xo=setInterval(Xk,xw)),eo=1,Aw(_0))}}function v0(e,t,n){var r=new Tl;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Kk=ow("start","end","cancel","interrupt"),Zk=[],Pw=0,w0=1,Vf=2,Os=3,M0=4,Yf=5,Ls=6;function Tu(e,t,n,r,i,o){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;Qk(e,n,{name:t,index:r,group:i,on:Kk,tween:Zk,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Pw})}function _d(e,t){var n=Cn(e,t);if(n.state>Pw)throw new Error("too late; already scheduled");return n}function qn(e,t){var n=Cn(e,t);if(n.state>Os)throw new Error("too late; already running");return n}function Cn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Qk(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Cw(o,0,n.time);function o(u){n.state=w0,n.timer.restart(a,n.delay,n.time),n.delay<=u&&a(u-n.delay)}function a(u){var c,h,f,d;if(n.state!==w0)return l();for(c in r)if(d=r[c],d.name===n.name){if(d.state===Os)return v0(a);d.state===M0?(d.state=Ls,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[c]):+c<t&&(d.state=Ls,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[c])}if(v0(function(){n.state===Os&&(n.state=M0,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=Vf,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Vf){for(n.state=Os,i=new Array(f=n.tween.length),c=0,h=-1;c<f;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=Yf,1),h=-1,f=i.length;++h<f;)i[h].call(e,c);n.state===Yf&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Ls,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Jk(e,t){var n=e.__transition,r,i,o=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){o=!1;continue}i=r.state>Vf&&r.state<Yf,r.state=Ls,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}o&&delete e.__transition}}function eI(e){return this.each(function(){Jk(this,e)})}function tI(e,t){var n,r;return function(){var i=qn(this,e),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function nI(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=qn(this,e),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:t,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===t){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function rI(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Cn(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?tI:nI)(n,e,t))}function vd(e,t,n){var r=e._id;return e.each(function(){var i=qn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Cn(i,r).value[t]}}function Nw(e,t){var n;return(typeof t=="number"?br:t instanceof Ji?Uf:(n=Ji(t))?(t=n,Uf):Uk)(e,t)}function iI(e){return function(){this.removeAttribute(e)}}function oI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function aI(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttribute(e);return a===i?null:a===r?o:o=t(r=a,n)}}function sI(e,t,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?o:o=t(r=a,n)}}function lI(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function uI(e,t,n){var r,i,o;return function(){var a,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s)))}}function cI(e,t){var n=Nu(e),r=n==="transform"?Vk:Nw;return this.attrTween(e,typeof t=="function"?(n.local?uI:lI)(n,r,vd(this,"attr."+e,t)):t==null?(n.local?oI:iI)(n):(n.local?sI:aI)(n,r,t))}function fI(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function hI(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function dI(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&hI(e,o)),n}return i._value=t,i}function mI(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&fI(e,o)),n}return i._value=t,i}function pI(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Nu(e);return this.tween(n,(r.local?dI:mI)(r,t))}function bI(e,t){return function(){_d(this,e).delay=+t.apply(this,arguments)}}function gI(e,t){return t=+t,function(){_d(this,e).delay=t}}function yI(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?bI:gI)(t,e)):Cn(this.node(),t).delay}function _I(e,t){return function(){qn(this,e).duration=+t.apply(this,arguments)}}function vI(e,t){return t=+t,function(){qn(this,e).duration=t}}function wI(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?_I:vI)(t,e)):Cn(this.node(),t).duration}function MI(e,t){if(typeof t!="function")throw new Error;return function(){qn(this,e).ease=t}}function EI(e){var t=this._id;return arguments.length?this.each(MI(t,e)):Cn(this.node(),t).ease}function SI(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;qn(this,e).ease=n}}function xI(e){if(typeof e!="function")throw new Error;return this.each(SI(this._id,e))}function AI(e){typeof e!="function"&&(e=uw(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&e.call(l,l.__data__,u,o)&&s.push(l);return new ur(r,this._parents,this._name,this._id)}function CI(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=t[s],u=n[s],c=l.length,h=a[s]=new Array(c),f,d=0;d<c;++d)(f=l[d]||u[d])&&(h[d]=f);for(;s<r;++s)a[s]=t[s];return new ur(a,this._parents,this._name,this._id)}function PI(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function NI(e,t,n){var r,i,o=PI(t)?_d:qn;return function(){var a=o(this,e),s=a.on;s!==r&&(i=(r=s).copy()).on(t,n),a.on=i}}function $I(e,t){var n=this._id;return arguments.length<2?Cn(this.node(),n).on.on(e):this.each(NI(n,e,t))}function TI(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function kI(){return this.on("end.remove",TI(this._id))}function II(e){var t=this._name,n=this._id;typeof e!="function"&&(e=pd(e));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],l=s.length,u=o[a]=new Array(l),c,h,f=0;f<l;++f)(c=s[f])&&(h=e.call(c,c.__data__,f,s))&&("__data__"in c&&(h.__data__=c.__data__),u[f]=h,Tu(u[f],t,n,f,u,Cn(c,n)));return new ur(o,this._parents,t,n)}function DI(e){var t=this._name,n=this._id;typeof e!="function"&&(e=lw(e));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,h=0;h<u;++h)if(c=l[h]){for(var f=e.call(c,c.__data__,h,l),d,m=Cn(c,n),b=0,g=f.length;b<g;++b)(d=f[b])&&Tu(d,t,n,b,f,m);o.push(f),a.push(c)}return new ur(o,a,t,n)}var FI=ts.prototype.constructor;function RI(){return new FI(this._groups,this._parents)}function BI(e,t){var n,r,i;return function(){var o=Qi(this,e),a=(this.style.removeProperty(e),Qi(this,e));return o===a?null:o===n&&a===r?i:i=t(n=o,r=a)}}function $w(e){return function(){this.style.removeProperty(e)}}function OI(e,t,n){var r,i=n+"",o;return function(){var a=Qi(this,e);return a===i?null:a===r?o:o=t(r=a,n)}}function LI(e,t,n){var r,i,o;return function(){var a=Qi(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),Qi(this,e))),a===l?null:a===r&&l===i?o:(i=l,o=t(r=a,s))}}function GI(e,t){var n,r,i,o="style."+t,a="end."+o,s;return function(){var l=qn(this,e),u=l.on,c=l.value[o]==null?s||(s=$w(t)):void 0;(u!==n||i!==c)&&(r=(n=u).copy()).on(a,i=c),l.on=r}}function UI(e,t,n){var r=(e+="")=="transform"?zk:Nw;return t==null?this.styleTween(e,BI(e,r)).on("end.style."+e,$w(e)):typeof t=="function"?this.styleTween(e,LI(e,r,vd(this,"style."+e,t))).each(GI(this._id,e)):this.styleTween(e,OI(e,r,t),n).on("end.style."+e,null)}function qI(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function HI(e,t,n){var r,i;function o(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&qI(e,a,n)),r}return o._value=t,o}function zI(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,HI(e,t,n??""))}function VI(e){return function(){this.textContent=e}}function YI(e){return function(){var t=e(this);this.textContent=t??""}}function WI(e){return this.tween("text",typeof e=="function"?YI(vd(this,"text",e)):VI(e==null?"":e+""))}function XI(e){return function(t){this.textContent=e.call(this,t)}}function jI(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&XI(i)),t}return r._value=e,r}function KI(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,jI(e))}function ZI(){for(var e=this._name,t=this._id,n=Tw(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=Cn(l,t);Tu(l,e,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ur(r,this._parents,e,n)}function QI(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--i===0&&o()}};n.each(function(){var u=qn(this,r),c=u.on;c!==e&&(t=(e=c).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),u.on=t}),i===0&&o()})}var JI=0;function ur(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Tw(){return++JI}var Or=ts.prototype;ur.prototype={constructor:ur,select:II,selectAll:DI,filter:AI,merge:CI,selection:RI,transition:ZI,call:Or.call,nodes:Or.nodes,node:Or.node,size:Or.size,empty:Or.empty,each:Or.each,on:$I,attr:cI,attrTween:pI,style:UI,styleTween:zI,text:WI,textTween:KI,remove:kI,tween:rI,delay:yI,duration:wI,ease:EI,easeVarying:xI,end:QI,[Symbol.iterator]:Or[Symbol.iterator]};function eD(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var tD={time:null,delay:0,duration:250,ease:eD};function nD(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function rD(e){var t,n;e instanceof ur?(t=e._id,e=e._name):(t=Tw(),(n=tD).time=yd(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&Tu(l,e,t,u,a,n||nD(l,t));return new ur(r,this._parents,e,t)}ts.prototype.interrupt=eI;ts.prototype.transition=rD;function Bo(e,t,n){this.k=e,this.x=t,this.y=n}Bo.prototype={constructor:Bo,scale:function(e){return e===1?this:new Bo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Bo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Bo.prototype;var iD={exports:{}};(function(e){(function(){const t=function(r){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;if(r=r.replace(/^.*?base64,/,""),r=String(r).replace(/[\t\n\f\r ]+/g,""),!o.test(r))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");r+="==".slice(2-(r.length&3));let a,s="",l,u,c=0;for(;c<r.length;)a=i.indexOf(r.charAt(c++))<<18|i.indexOf(r.charAt(c++))<<12|(l=i.indexOf(r.charAt(c++)))<<6|(u=i.indexOf(r.charAt(c++))),s+=l===64?String.fromCharCode(a>>16&255):u===64?String.fromCharCode(a>>16&255,a>>8&255):String.fromCharCode(a>>16&255,a>>8&255,a&255);return s},n={debug:!1,parse:function(r,i){if(r instanceof Uint8Array)return n.Uint8(r);if(typeof r=="string")return n.Base64(r);if(r instanceof HTMLElement&&r.type==="file")return n.addListener(r,i);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(r,i){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(r===void 0||!(r instanceof HTMLElement)||r.tagName!=="INPUT"||r.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;i=i||function(){},r.addEventListener("change",function(o){if(!o.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let a=new FileReader;a.readAsArrayBuffer(o.target.files[0]),a.onload=function(s){i(n.Uint8(new Uint8Array(s.target.result)))}})},Base64:function(r){r=String(r);let i=t(r),o=i.length,a=new Uint8Array(new ArrayBuffer(o));for(let s=0;s<o;s++)a[s]=i.charCodeAt(s);return n.Uint8(a)},Uint8:function(r){let i={data:null,pointer:0,movePointer:function(l){return this.pointer+=l,this.pointer},readInt:function(l){if(l=Math.min(l,this.data.byteLength-this.pointer),l<1)return-1;let u=0;if(l>1)for(let c=1;c<=l-1;c++)u+=this.data.getUint8(this.pointer)*Math.pow(256,l-c),this.pointer++;return u+=this.data.getUint8(this.pointer),this.pointer++,u},readStr:function(l){let u="";for(let c=1;c<=l;c++)u+=String.fromCharCode(this.readInt(1));return u},readIntVLV:function(){let l=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)l=this.readInt(1);else{let u=[];for(;this.data.getUint8(this.pointer)>=128;)u.push(this.readInt(1)-128);let c=this.readInt(1);for(let h=1;h<=u.length;h++)l+=u[u.length-h]*Math.pow(128,h);l+=c}return l}};if(i.data=new DataView(r.buffer,r.byteOffset,r.byteLength),i.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;i.readInt(4);let o={};o.formatType=i.readInt(2),o.tracks=i.readInt(2),o.track=[];let a=i.readInt(1),s=i.readInt(1);a>=128?(o.timeDivision=[],o.timeDivision[0]=a-128,o.timeDivision[1]=s):o.timeDivision=a*256+s;for(let l=1;l<=o.tracks;l++){o.track[l-1]={event:[]};let u=i.readInt(4);if(u===-1)break;if(u!==1297379947)return!1;i.readInt(4);let c=0,h=!1,f,d;for(;!h&&(c++,o.track[l-1].event[c-1]={},o.track[l-1].event[c-1].deltaTime=i.readIntVLV(),f=i.readInt(1),f!==-1);)if(f>=128?d=f:(f=d,i.movePointer(-1)),f===255){o.track[l-1].event[c-1].type=255,o.track[l-1].event[c-1].metaType=i.readInt(1);let m=i.readIntVLV();switch(o.track[l-1].event[c-1].metaType){case 47:case-1:h=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:o.track[l-1].event[c-1].data=i.readStr(m);break;case 33:case 89:case 81:o.track[l-1].event[c-1].data=i.readInt(m);break;case 84:o.track[l-1].event[c-1].data=[],o.track[l-1].event[c-1].data[0]=i.readInt(1),o.track[l-1].event[c-1].data[1]=i.readInt(1),o.track[l-1].event[c-1].data[2]=i.readInt(1),o.track[l-1].event[c-1].data[3]=i.readInt(1),o.track[l-1].event[c-1].data[4]=i.readInt(1);break;case 88:o.track[l-1].event[c-1].data=[],o.track[l-1].event[c-1].data[0]=i.readInt(1),o.track[l-1].event[c-1].data[1]=i.readInt(1),o.track[l-1].event[c-1].data[2]=i.readInt(1),o.track[l-1].event[c-1].data[3]=i.readInt(1);break;default:this.customInterpreter!==null&&(o.track[l-1].event[c-1].data=this.customInterpreter(o.track[l-1].event[c-1].metaType,i,m)),(this.customInterpreter===null||o.track[l-1].event[c-1].data===!1)&&(i.readInt(m),o.track[l-1].event[c-1].data=i.readInt(m),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch(f=f.toString(16).split(""),f[1]||f.unshift("0"),o.track[l-1].event[c-1].type=parseInt(f[0],16),o.track[l-1].event[c-1].channel=parseInt(f[1],16),o.track[l-1].event[c-1].type){case 15:{if(this.customInterpreter!==null&&(o.track[l-1].event[c-1].data=this.customInterpreter(o.track[l-1].event[c-1].type,i,!1)),this.customInterpreter===null||o.track[l-1].event[c-1].data===!1){let m=i.readIntVLV();o.track[l-1].event[c-1].data=i.readInt(m),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer")}break}case 10:case 11:case 14:case 8:case 9:o.track[l-1].event[c-1].data=[],o.track[l-1].event[c-1].data[0]=i.readInt(1),o.track[l-1].event[c-1].data[1]=i.readInt(1);break;case 12:case 13:o.track[l-1].event[c-1].data=i.readInt(1);break;case-1:h=!0;break;default:if(this.customInterpreter!==null&&(o.track[l-1].event[c-1].data=this.customInterpreter(o.track[l-1].event[c-1].metaType,i,!1)),this.customInterpreter===null||o.track[l-1].event[c-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return o},customInterpreter:null};e.exports=n})()})(iD);function kt(e){return 1/(e/60)}const kw=[],oD=[2,1,1/2,1/4,1/8,1/16,1/32,1/64];for(const e of oD)for(let t=0;t<4;t++){let n=e,r=e;for(let i=0;i<t;i++)r/=2,n+=r;kw.push({type:e,dots:t,duration:n})}kw.sort((e,t)=>e.duration-t.duration);function aD(e,t,n,r){e.beginPath(),e.arc(t,n,r,0,2*Math.PI),e.stroke()}class ge{constructor(t,n){this.name=t,this.notes=n,this.short=n.join(" "),this.pitches=n.map(r=>iw(r).pitch),this.stringCount=n.length}}const sD=new Map([["Guitar",new Map([[6,[new ge("E stand.",["E2","A2","D3","G3","B3","E4"]),new ge("Drop D",["D2","A2","D3","G3","B3","E4"]),new ge("Drop C",["C2","G2","C3","F3","A3","D4"]),new ge("1/2 down",["D#2","G#2","C#3","F#3","A#3","D#4"]),new ge("1 down",["D2","G2","C3","F3","A3","D4"]),new ge("1 1/2 down",["C#2","F#2","B2","E3","G#3","C#4"]),new ge("2 down",["C2","F2","A#2","D#3","G3","C4"]),new ge("DADGAG",["D2","A2","D3","G3","A3","D4"])]],[7,[new ge("B stand.",["B1","E2","A2","D3","G3","B3","E4"]),new ge("Drop A",["A1","E2","A2","D3","G3","B3","E4"]),new ge("1/2 down",["A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new ge("1 down",["A1","D2","G2","C3","F3","A3","D4"]),new ge("1 1/2 down",["G#1","C#2","F#2","B2","E3","G#3","C#4"]),new ge("2 down",["G1","C2","F2","A#2","D#3","G3","C4"])]],[8,[new ge("F# stand.",["F#1","B1","E2","A2","D3","G3","B3","E4"]),new ge("Drop E",["E1","B1","E2","A2","D3","G3","B3","E4"]),new ge("1/2 down",["F1","A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new ge("1 down",["E1","A1","D2","G2","C3","F3","A3","D4"]),new ge("1 1/2 down",["D#1","G#1","C#2","F#2","B2","E3","G#3","C#4"]),new ge("2 down",["D1","G1","C2","F2","A#2","D#3","G3","C4"])]]])],["Bass",new Map([[4,[new ge("E stand.",["E1","A1","D2","G2"]),new ge("Drop D",["D1","A1","D2","G2"]),new ge("1/2 down",["D#1","G#1","C#2","F#2"]),new ge("1 down",["D1","G1","C2","F2"]),new ge("1 1/2 down",["C#1","F#1","B1","E2"]),new ge("2 down",["C1","F1","A#1","D#2"])]],[5,[new ge("B stand.",["B0","E1","A1","D2","G2"]),new ge("Drop A",["A0","D1","A1","D2","G2"]),new ge("1/2 down",["A#0","D#1","G#1","C#2","F#2"]),new ge("1 down",["A0","D1","G1","C2","F2"]),new ge("1 1/2 down",["G#0","C#1","F#1","B1","E2"]),new ge("2 down",["G0","C1","F1","A#1","D#2"])]],[6,[new ge("F# stand.",["F#0","B0","E1","A1","D2","G2"]),new ge("Drop E",["E0","A0","D1","A1","D2","G2"]),new ge("1/2 down",["F0","A#0","D#1","G#1","C#2","F#2"]),new ge("1 down",["E1","A0","D1","G1","C2","F2"]),new ge("1 1/2 down",["D#0","G#0","C#1","F#1","B1","E2"]),new ge("2 down",["D0","G0","C1","F1","A#1","D#2"])]]])],["Ukulele",new Map([[4,[new ge("Hawaii",["G4","C4","E4","A4"]),new ge("Low G",["G3","C4","E4","A4"]),new ge("D-tuning",["A4","D4","F#4","B4"]),new ge("Canadian",["A3","D4","F#4","B4"]),new ge("Bariton",["D3","G3","B3","E4"])]]])]]);class mr{constructor(t,n){this.name=t,this.notes=n,this.short=n.join(" "),this.pitches=n.map(r=>iw(r).pitch),this.pitchesSorted=[...this.pitches].sort((r,i)=>r-i),this.keyCount=n.length}getNumbers(){const t=this.pitchesSorted,n=new Map;for(const[r,i]of t.entries()){let o=r+1,a="",s=i-12;for(;s>0&&n.has(s);)o=n.get(s).number,a+="°",s-=12;n.set(i,{number:o,numberString:`${o}${a}`})}return[...n.values()].map(r=>r.numberString)}getLetters(){const t=this.pitchesSorted,n=new Map;for(const[r,i]of t.entries()){let o=r+1,a="",s=i-12;for(;s>0&&n.has(s);)o=n.get(s).number,a+="°",s-=12;const l=z$(i).name;n.set(i,{number:o,letterString:`${l}${a}`})}return[...n.values()].map(r=>r.letterString)}}new mr("9 A Major",["A5","C#6","C#5","A5","A4","F#5","E5","E6","B5"]),new mr("9 A Minor",["A5","C6","C5","A5","A4","F5","E5","E6","B5"]),new mr("9 A Minor 7",["A5","C6","C5","A5","A4","F#5","E5","E6","B5"]),new mr("9 A Ake Bono",["A5","D6","D5","A5","A4","F5","E5","E6","A#5"]),new mr("9 A Hijaz",["G5","D6","D5","A5","A4","F#5","D#5","D#6","A#5"]),new mr("9 A Pygmy",["G5","C6","C5","G5","G4","D#5","D5","D#6","A#5"]),new mr("17 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","C4","E4","G4","B4","D5","F5","A5","C6","E6"]),new mr("21 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","B3","G3","F3","A3","C4","E4","G4","B4","D5","F5","A5","C6","E6"]);function lD(e){const{r:t,g:n,b:r}=Ji(e).rgb();return(t+t+t+r+n+n+n+n>>3)/2.55}function uD(e,t=1){const n=vw(e);return n.s=t,n.toString()}const cD=["#ff0000","#ff4e00","#db7b00","#ffcc00","#e4ed00","#81d700","#00ffb4","#00ffea","#00baff","#3c00ff","#a800ff","#ff00fd"].map(e=>uD(e,.5)),fD=["#6699ff","#66ffff","#000000","#647878","#993366","#ff0000","#ffcc99","#ffff01","#ff9900","#009900","#66ff99","#0000cc"],hD=["#9aebff","#add5ff","#d6d6ff","#ebd5ff","#ffc2eb","#ffcbcc","#ffd5c2","#ffebc2","#ebffc2","#c2d599","#99ebbe","#adebeb"],dD=["#FA0B0C","#FA0B0C","#F88010","#F88010","#F5F43C","#149033","#149033","#FA0B0C","#FA0B0C","#7F087C","#7F087C","#908791"],mD=["#1C0D82","#F5F5F5","#149033","#709226","#F5F43C","#F5D23B","#F88010","#FA0B0C","#A00C09","#D71386","#4B0E7D","#7F087C"],pD=["#1C0D82","#1C0D82","#7F087C","#7F087C","#FA0B0C","#F88010","#F88010","#F5F43C","#F5F43C","#709226","#709226","#149033"],bD=["#FA0B0C","#F44712","#F88010","#F5D23B","#F5F43C","#149033","#1B9081","#1C0D82","#4B0E7D","#7F087C","#A61586","#D71386"],gD=["#6A1C1C","#FA0B0C","#F88010","#F5D23B","#F5F43C","#709226","#1B9081","#1C0D82","#7F087C","#D71386","#6A1C1C","#070707"],yD=["#FA0B0C","#A00C09","#F44712","#F88010","#F5F43C","#709226","#149033","#27A481","#1B9081","#7F087C","#1C0D82","#D71386"],_D=["#FA0B0C","#A00C09","#F88010","#F6D111","#F5F43C","#BCE039","#149033","#27A481","#7F087C","#D71386","#D91951","#FA0B0C"],vD=["#F5F43C","#149033","#1B9081","#1C5BA0","#7F087C","#D71386","#9D0E55","#FA0B0C","#D32C0A","#D32C0A","#F62E0D","#F17A0F"],wD=["#FA0B0C","#D71386","#F5F43C","#5A5685","#1C5BA0","#A00C09","#1C0D82","#F88010","#7F087C","#149033","#5A5685","#1C5BA0"],MD=["#C40A09","#FA0B0C","#F44712","#F88010","#F5F43C","#BCE039","#149033","#1B9081","#1C0D82","#781887","#D71386","#9D0E55"],ED=["#FA0B0C","#FA0B0C","#F88010","#F88010","#F5F43C","#F5F43C","#149033","#1B9081","#1B9081","#1C5BA0","#4B0E7D","#7F087C"],SD=["#FA0B0C","#F44712","#F88010","#F6D111","#F5F43C","#BCE039","#149033","#1B9081","#1C0D82","#A61586","#D71386","#AD0E48"],xD=["#BCE039","#149033","#1B9081","#1C0D82","#7F087C","#D71386","#6F0D45","#A00C09","#FA0B0C","#F88010","#EDF087","#F5F43C"],AD=Uf("black","steelblue");Array.from({length:12}).map((e,t)=>AD(t/11));function CD(e,t,n){const r=e.slice();return r[17]=t[n],r}function PD(e){let t;return{c(){t=A("option"),t.textContent=`${e[17]}`,t.__value=e[17],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function ND(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x=Pe(["velocity","piano","channel","none"]),w=[];for(let M=0;M<4;M+=1)w[M]=PD(CD(e,x,M));return{c(){t=A("main"),n=A("h2"),n.textContent="Guitar Tab",r=R(),i=A("p"),i.textContent=`The guitar tab below shows incoming MIDI notes as rectangles with their
        string (y position) and start and end times (x left and right side of
        the rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,o=R(),a=A("div"),s=A("label"),l=z(`color
            `),u=A("select");for(let M=0;M<4;M+=1)w[M].c();c=R(),h=A("label"),f=z(`time
            `),d=A("input"),m=R(),b=A("div"),g=R(),E=A("div"),_=A("button"),_.textContent="reset",P(i,"class","explanation"),e[2]===void 0&&_t(()=>e[5].call(u)),P(d,"type","number"),P(d,"min","10"),P(d,"max","300"),P(d,"step","10"),P(h,"title","time in seconds for past notes to be shown"),P(a,"class","control"),P(b,"class","visualization"),P(_,"title","Clear all played notes"),P(E,"class","control"),P(t,"class","demo")},m(M,C){le(M,t,C),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u);for(let S=0;S<4;S+=1)w[S]&&w[S].m(u,null);Le(u,e[2],!0),p(a,c),p(a,h),p(h,f),p(h,d),me(d,e[1]),p(t,m),p(t,b),e[7](b),p(t,g),p(t,E),p(E,_),y||(v=[Q(u,"change",e[5]),Q(d,"input",e[6]),Q(_,"click",e[8])],y=!0)},p(M,[C]){C&4&&Le(u,M[2]),C&2&&xe(d.value)!==M[1]&&me(d,M[1])},i:pe,o:pe,d(M){M&&se(t),Ze(w,M),e[7](null),y=!1,qe(v)}}}let $D=1e3,TD=500,kD=6;function ID(e,t,n){let r=[64,59,55,50,45,40],i,o=30,a="velocity",s=0,l=[];const u=new Map;let c=null;const h=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((y,v)=>{console.log(`MIDI device ${v}: ${y.name}`),y.addListener("noteon",f),y.addListener("noteoff",d)}),[...O.inputs])},f=y=>{const v=(y.timestamp-s)/1e3,x=y.message.channel-1,w={number:y.note.number,velocity:y.rawVelocity,time:v,channel:y.message.channel,string:x,fret:y.note.number-r[x]};if(u.has(y.note.number)){const M=u.get(y.note.number);M.end===void 0&&(M.end=v)}l.push(w),u.set(y.note.number,w)},d=y=>{if(u.has(y.note.number)){const v=u.get(y.note.number),x=(y.timestamp-s)/1e3;v.end=x}},m=()=>{const y=(performance.now()-s)/1e3,v=y-o,x=l.filter($=>$.end>v||$.end===void 0),w=Ft(x,$=>$.number),M=r.map(wn.fromMidiSharps);let C,S;a==="velocity"?(C={label:"Note velocity",scheme:"blues",domain:[0,127]},S="velocity"):a==="piano"?(C={label:"Piano key color",domain:["black","white"],range:["black","white"]},S=$=>Wo($.number)?"black":"white"):a==="channel"?(C={type:"categorical",label:"MIDI channel",scheme:"tableau10"},S=$=>$.channel):a==="none"&&(S="#ddd");const N=rt({insetRight:10,width:$D,height:TD,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[v,y]},y:{label:"String",grid:!0,domain:be(0,kD),tickFormat:$=>M[$]},color:{...C,legend:a!=="none",marginLeft:100,width:300},marks:[Et(be(Math.ceil((w[0]-1)/12)*12,w[1]+2,12)),Pt([y],{stroke:"#888"}),es(x,{clip:!0,x1:"time",x2:$=>$.end===void 0?y:Math.max($.end,$.time+.025),y:"string",fill:S,stroke:"#ccc",rx:5}),$r(x,{clip:!0,x:"time",y:"string",fill:"black",stroke:"white",text:"fret",textAnchor:"start",dx:2})]});n(0,i.textContent="",i),i.appendChild(N),c=requestAnimationFrame(m)};at(()=>{O.enable().then(h).catch(y=>alert(y)),n(3,s=performance.now()),c=requestAnimationFrame(m)}),ot(()=>{for(const y of O.inputs)y.removeListener();cancelAnimationFrame(c)});function b(){a=Rt(this),n(2,a)}function g(){o=xe(this.value),n(1,o)}function E(y){Ue[y?"unshift":"push"](()=>{i=y,n(0,i)})}return[i,o,a,s,l,b,g,E,()=>{confirm("Reset played notes?")&&(n(4,l=[]),n(3,s=performance.now()))}]}class DD extends Ve{constructor(t){super(),ze(this,t,ID,ND,He,{})}}function FD(e){let t,n,r,i,o,a,s,l,u,c,h,f,d=e[2]?"☑":"☐",m,b,g,E,_=e[3]?"☑":"☐",y,v,x,w,M,C,S,N,$=e[0]>=6?"guitar":"bass guitar",T,L,D=e[1]===0?"in standard tuning":`${Math.abs(e[1])} ${e[1]<0?"steps down":"steps up"}`,I,V,W=e[2]?"and dropped":"",U,Y,k,B,G,X,Z,ie,ee,j;return{c(){t=A("main"),n=A("h2"),n.textContent="Guitar Tunings",r=R(),i=A("label"),o=z(`strings
        `),a=A("input"),s=R(),l=A("label"),u=z(`tune up/down (semitones)
        `),c=A("input"),h=R(),f=A("button"),m=z(d),b=z(" dropped"),g=R(),E=A("button"),y=z(_),v=z(" octave shown"),x=R(),w=A("div"),M=A("p"),C=z("You selected a "),S=z(e[0]),N=z(" string "),T=z($),L=z(", tuned "),I=z(D),V=R(),U=z(W),Y=R(),k=A("p"),B=z("Resulting tuning, low to high:"),G=A("br"),X=R(),Z=A("b"),ie=z(e[4]),P(a,"type","number"),P(a,"min","4"),P(a,"max","8"),P(a,"step","1"),P(c,"type","number"),P(c,"min","-12"),P(c,"max","12"),P(c,"step","1")},m(J,F){le(J,t,F),p(t,n),p(t,r),p(t,i),p(i,o),p(i,a),me(a,e[0]),p(t,s),p(t,l),p(l,u),p(l,c),me(c,e[1]),p(t,h),p(t,f),p(f,m),p(f,b),p(t,g),p(t,E),p(E,y),p(E,v),p(t,x),p(t,w),p(w,M),p(M,C),p(M,S),p(M,N),p(M,T),p(M,L),p(M,I),p(M,V),p(M,U),p(w,Y),p(w,k),p(k,B),p(k,G),p(k,X),p(k,Z),p(Z,ie),ee||(j=[Q(a,"input",e[5]),Q(c,"input",e[6]),Q(f,"click",e[7]),Q(E,"click",e[8])],ee=!0)},p(J,[F]){F&1&&xe(a.value)!==J[0]&&me(a,J[0]),F&2&&xe(c.value)!==J[1]&&me(c,J[1]),F&4&&d!==(d=J[2]?"☑":"☐")&&_e(m,d),F&8&&_!==(_=J[3]?"☑":"☐")&&_e(y,_),F&1&&_e(S,J[0]),F&1&&$!==($=J[0]>=6?"guitar":"bass guitar")&&_e(T,$),F&2&&D!==(D=J[1]===0?"in standard tuning":`${Math.abs(J[1])} ${J[1]<0?"steps down":"steps up"}`)&&_e(I,D),F&4&&W!==(W=J[2]?"and dropped":"")&&_e(U,W),F&16&&_e(ie,J[4])},i:pe,o:pe,d(J){J&&se(t),ee=!1,qe(j)}}}function RD(e,t,n){let r,i=6,o=0,a=!1,s=!0;const l=(d,m,b,g)=>{let _=sD.get(d>5?"Guitar":"Bass").get(d)[0].pitches.map(y=>y+m);return b&&(_[0]-=2),g?_=_.map(y=>pa[y].label):_=_.map(y=>pa[y].name),_.join(" ")};function u(){i=xe(this.value),n(0,i)}function c(){o=xe(this.value),n(1,o)}const h=()=>{n(2,a=!a)},f=()=>{n(3,s=!s)};return e.$$.update=()=>{e.$$.dirty&15&&n(4,r=l(i,o,a,s))},[i,o,a,s,r,u,c,h,f]}class BD extends Ve{constructor(t){super(),ze(this,t,RD,FD,He,{})}}function E0(e,t,n){const r=e.slice();return r[5]=t[n],r}function S0(e){let t,n,r=e[5].timestamp.toFixed(1)+"",i,o,a,s=e[5].port.manufacturer+"",l,u,c,h=e[5].port.name+"",f,d,m,b=e[5].message.channel+"",g,E,_,y=e[5].message.command+"",v,x,w=e[5].message.type+"",M,C,S,N=e[5].message.dataBytes+"",$,T,L,D=(["noteon","noteoff"].includes(e[5].message.type)?wn.fromMidiSharps(e[5].message.dataBytes[0]):"")+"",I,V,W,U=(["noteon","noteoff"].includes(e[5].message.type)?e[5].message.dataBytes[1]:"")+"",Y,k;return{c(){t=A("tr"),n=A("td"),i=z(r),o=R(),a=A("td"),l=z(s),u=R(),c=A("td"),f=z(h),d=R(),m=A("td"),g=z(b),E=R(),_=A("td"),v=z(y),x=R(),M=z(w),C=R(),S=A("td"),$=z(N),T=R(),L=A("td"),I=z(D),V=R(),W=A("td"),Y=z(U),k=R(),P(n,"class","svelte-1x83ix2"),P(a,"class","svelte-1x83ix2"),P(c,"class","svelte-1x83ix2"),P(m,"class","svelte-1x83ix2"),P(_,"class","svelte-1x83ix2"),P(S,"class","svelte-1x83ix2"),P(L,"class","svelte-1x83ix2"),P(W,"class","svelte-1x83ix2"),P(t,"class","svelte-1x83ix2")},m(B,G){le(B,t,G),p(t,n),p(n,i),p(t,o),p(t,a),p(a,l),p(t,u),p(t,c),p(c,f),p(t,d),p(t,m),p(m,g),p(t,E),p(t,_),p(_,v),p(_,x),p(_,M),p(t,C),p(t,S),p(S,$),p(t,T),p(t,L),p(L,I),p(t,V),p(t,W),p(W,Y),p(t,k)},p(B,G){G&1&&r!==(r=B[5].timestamp.toFixed(1)+"")&&_e(i,r),G&1&&s!==(s=B[5].port.manufacturer+"")&&_e(l,s),G&1&&h!==(h=B[5].port.name+"")&&_e(f,h),G&1&&b!==(b=B[5].message.channel+"")&&_e(g,b),G&1&&y!==(y=B[5].message.command+"")&&_e(v,y),G&1&&w!==(w=B[5].message.type+"")&&_e(M,w),G&1&&N!==(N=B[5].message.dataBytes+"")&&_e($,N),G&1&&D!==(D=(["noteon","noteoff"].includes(B[5].message.type)?wn.fromMidiSharps(B[5].message.dataBytes[0]):"")+"")&&_e(I,D),G&1&&U!==(U=(["noteon","noteoff"].includes(B[5].message.type)?B[5].message.dataBytes[1]:"")+"")&&_e(Y,U)},d(B){B&&se(t)}}}function OD(e){let t,n,r,i,o,a,s,l,u,c,h=e[0].length+"",f,d,m,b,g,E,_,y,v,x=Pe(e[0].slice(0,100)),w=[];for(let M=0;M<x.length;M+=1)w[M]=S0(E0(e,x,M));return{c(){t=A("main"),n=A("h2"),n.textContent="MIDI Logger",r=R(),i=A("p"),i.textContent="Input anything on a MIDI device to see the incoming messages below.",o=R(),a=A("div"),s=A("button"),s.textContent="reset",l=R(),u=A("div"),c=A("p"),f=z(h),d=z(" messages received"),m=R(),b=A("table"),g=A("thead"),g.innerHTML="<th>timestamp</th> <th>manufacturer</th> <th>name</th> <th>channel</th> <th>command</th> <th>data</th> <th>note</th> <th>velocity</th>",E=R(),_=A("tbody");for(let M=0;M<w.length;M+=1)w[M].c();P(i,"class","explanation"),P(s,"title","Clear all messages"),P(a,"class","control"),P(b,"class","svelte-1x83ix2"),P(u,"class","visualization"),P(t,"class","demo")},m(M,C){le(M,t,C),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(t,l),p(t,u),p(u,c),p(c,f),p(c,d),p(u,m),p(u,b),p(b,g),p(b,E),p(b,_);for(let S=0;S<w.length;S+=1)w[S]&&w[S].m(_,null);y||(v=Q(s,"click",e[1]),y=!0)},p(M,[C]){if(C&1&&h!==(h=M[0].length+"")&&_e(f,h),C&1){x=Pe(M[0].slice(0,100));let S;for(S=0;S<x.length;S+=1){const N=E0(M,x,S);w[S]?w[S].p(N,C):(w[S]=S0(N),w[S].c(),w[S].m(_,null))}for(;S<w.length;S+=1)w[S].d(1);w.length=x.length}},i:pe,o:pe,d(M){M&&se(t),Ze(w,M),y=!1,v()}}}function LD(e,t,n){let r=[];const i=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((a,s)=>{console.log(`MIDI device ${s}: ${a.name}`),a.addListener("midimessage",l=>{n(0,r=[l,...r]),console.log(l)})}),[...O.inputs])};return at(()=>{O.enable().then(i).catch(a=>alert(a)),performance.now()}),ot(()=>{for(const a of O.inputs)a.removeListener()}),[r,()=>{n(0,r=[])}]}class GD extends Ve{constructor(t){super(),ze(this,t,LD,OD,He,{})}}const Gs={noteColormap:cD,noteColormapAccessible:fD,noteColormapAccessible2:hD,newton:dD,castel:mD,field:pD,jameson:bD,seemann:gD,rimington:yD,bishop:_D,helmholtz:vD,scriabin:wD,klein:MD,aeppli:ED,belmont:SD,zieverink:xD};function x0(e,t,n){const r=e.slice();return r[1]=t[n],r}function A0(e,t,n){const r=e.slice();return r[4]=t[n],r[6]=n,r}function UD(e,t,n){const r=e.slice();return r[7]=t[n],r}function qD(e){let t;return{c(){t=A("th"),t.textContent=`${e[7]}`},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function C0(e){let t,n=e[4]+"",r;return{c(){t=A("td"),r=z(n),P(t,"title",dd[e[6]]),Jt(t,"background-color",e[4]),Jt(t,"color",lD(e[4])>50?"black":"white"),Jt(t,"font-size","12px"),P(t,"class","svelte-1xnq8ek")},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function P0(e){let t,n,r,i,o=Pe(e[1].colors),a=[];for(let s=0;s<o.length;s+=1)a[s]=C0(A0(e,o,s));return{c(){t=A("tr"),n=A("td"),n.textContent=`${e[1].name}`,r=R();for(let s=0;s<a.length;s+=1)a[s].c();i=R(),P(n,"class","svelte-1xnq8ek"),P(t,"class","svelte-1xnq8ek")},m(s,l){le(s,t,l),p(t,n),p(t,r);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(t,null);p(t,i)},p(s,l){if(l&1){o=Pe(s[1].colors);let u;for(u=0;u<o.length;u+=1){const c=A0(s,o,u);a[u]?a[u].p(c,l):(a[u]=C0(c),a[u].c(),a[u].m(t,i))}for(;u<a.length;u+=1)a[u].d(1);a.length=o.length}},d(s){s&&se(t),Ze(a,s)}}}function HD(e){let t,n,r,i,o,a,s,l,u,c,h,f,d=Pe(dd),m=[];for(let E=0;E<d.length;E+=1)m[E]=qD(UD(e,d,E));let b=Pe(e[0]),g=[];for(let E=0;E<b.length;E+=1)g[E]=P0(x0(e,b,E));return{c(){t=A("main"),n=A("h2"),n.textContent="Note Colors",r=R(),i=A("p"),i.innerHTML=`See <a href="https://github.com/fheyen/musicvis-lib/blob/905edbdc8280e8ca76a329ffc83a160f3cda674a/src/utils/NoteColorUtils.js" target="_blank">here</a>
        for literature references and color string arrays. Most schemes are found
        in:
        <i>Schmidt, Kathryn L. (2019) Meaningful Music Visualizations. Purdue
            University Graduate School. <a href="https://doi.org/10.25394/PGS.7498700.v1" target="_blank">DOI</a>
            (page 13)</i>`,o=R(),a=A("div"),s=A("table"),l=A("thead"),u=A("th"),u.textContent="name",c=R();for(let E=0;E<m.length;E+=1)m[E].c();h=R(),f=A("tbody");for(let E=0;E<g.length;E+=1)g[E].c();P(i,"class","explanation"),P(s,"class","svelte-1xnq8ek"),P(a,"class","visualization"),P(t,"class","demo")},m(E,_){le(E,t,_),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(l,u),p(l,c);for(let y=0;y<m.length;y+=1)m[y]&&m[y].m(l,null);p(s,h),p(s,f);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(f,null)},p(E,[_]){if(_&1){b=Pe(E[0]);let y;for(y=0;y<b.length;y+=1){const v=x0(E,b,y);g[y]?g[y].p(v,_):(g[y]=P0(v),g[y].c(),g[y].m(f,null))}for(;y<g.length;y+=1)g[y].d(1);g.length=b.length}},i:pe,o:pe,d(E){E&&se(t),Ze(m,E),Ze(g,E)}}}function zD(e){const t=[];for(const n in Gs)Gs.hasOwnProperty(n)&&t.push({name:n,colors:Gs[n].map(r=>Er(r).formatHex())});return[t]}class VD extends Ve{constructor(t){super(),ze(this,t,zD,HD,He,{})}}function YD(e,t,n){const r=e.slice();return r[16]=t[n],r}function WD(e){let t;return{c(){t=A("option"),t.textContent=`${e[16]}`,t.__value=e[16],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function XD(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x=Pe(["velocity","piano","channel","none"]),w=[];for(let M=0;M<4;M+=1)w[M]=WD(YD(e,x,M));return{c(){t=A("main"),n=A("h2"),n.textContent="Fretboard Heatmap",r=R(),i=A("p"),i.textContent=`The piano roll below shows incoming MIDI notes as rectangles with their
        pitch (y position) and start and end times (x left and right side of the
        rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,o=R(),a=A("div"),s=A("label"),l=z(`color
            `),u=A("select");for(let M=0;M<4;M+=1)w[M].c();c=R(),h=A("label"),f=z(`time
            `),d=A("input"),m=R(),b=A("div"),g=R(),E=A("div"),_=A("button"),_.textContent="reset",P(i,"class","explanation"),e[2]===void 0&&_t(()=>e[5].call(u)),P(d,"type","number"),P(d,"min","10"),P(d,"max","300"),P(d,"step","10"),P(h,"title","time in seconds for past notes to be shown"),P(a,"class","control"),P(b,"class","visualization"),P(_,"title","Clear all played notes"),P(E,"class","control"),P(t,"class","demo")},m(M,C){le(M,t,C),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u);for(let S=0;S<4;S+=1)w[S]&&w[S].m(u,null);Le(u,e[2],!0),p(a,c),p(a,h),p(h,f),p(h,d),me(d,e[1]),p(t,m),p(t,b),e[7](b),p(t,g),p(t,E),p(E,_),y||(v=[Q(u,"change",e[5]),Q(d,"input",e[6]),Q(_,"click",e[8])],y=!0)},p(M,[C]){C&4&&Le(u,M[2]),C&2&&xe(d.value)!==M[1]&&me(d,M[1])},i:pe,o:pe,d(M){M&&se(t),Ze(w,M),e[7](null),y=!1,qe(v)}}}let jD=1e3,KD=500;function ZD(e,t,n){let r,i=30,o="velocity",a=0,s=[];const l=new Map;let u=null;const c=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((_,y)=>{console.log(`MIDI device ${y}: ${_.name}`),_.addListener("noteon",h),_.addListener("noteoff",f)}),[...O.inputs])},h=_=>{const y=(_.timestamp-a)/1e3,v={number:_.note.number,velocity:_.rawVelocity,time:y,channel:_.message.channel};if(l.has(_.note.number)){const x=l.get(_.note.number);x.end===void 0&&(x.end=y)}s.push(v),l.set(_.note.number,v)},f=_=>{if(l.has(_.note.number)){const y=l.get(_.note.number),v=(_.timestamp-a)/1e3;y.end=v}},d=()=>{const _=(performance.now()-a)/1e3,y=_-i,v=s.filter(S=>S.end>y||S.end===void 0),x=Ft(v,S=>S.number);let w,M;o==="velocity"?(w={label:"Note velocity",scheme:"blues",domain:[0,127]},M="velocity"):o==="piano"?(w={label:"Piano key color",domain:["black","white"],range:["black","white"]},M=S=>Wo(S.number)?"black":"white"):o==="channel"?(w={type:"categorical",label:"MIDI channel",scheme:"tableau10"},M=S=>S.channel):o==="none"&&(M="#ddd");const C=rt({insetRight:10,width:jD,height:KD,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[y,_]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,domain:be(x[0]-1,x[1]+2),tickFormat:S=>pa[S].label},color:{...w,legend:o!=="none",marginLeft:100,width:300},marks:[Et(cy(x[0]-1,x[1]+2)),Pt([_],{stroke:"#888"}),es(v,{clip:!0,x1:"time",x2:S=>S.end===void 0?_:Math.max(S.end,S.time+.025),y:"number",fill:M,stroke:"#ccc",rx:5})]});n(0,r.textContent="",r),r.appendChild(C),u=requestAnimationFrame(d)};at(()=>{O.enable().then(c).catch(_=>alert(_)),n(3,a=performance.now()),u=requestAnimationFrame(d)}),ot(()=>{for(const _ of O.inputs)_.removeListener();cancelAnimationFrame(u)});function m(){o=Rt(this),n(2,o)}function b(){i=xe(this.value),n(1,i)}function g(_){Ue[_?"unshift":"push"](()=>{r=_,n(0,r)})}return[r,i,o,a,s,m,b,g,()=>{confirm("Reset played notes?")&&(n(4,s=[]),n(3,a=performance.now()))}]}class QD extends Ve{constructor(t){super(),ze(this,t,ZD,XD,He,{})}}function N0(e,t,n){const r=e.slice();return r[3]=t[n],r}function JD(e){let t,n,r;var i=e[0].component;function o(a,s){return{}}return i&&(n=Hs(i,o())),{c(){t=A("div"),n&&Te(n.$$.fragment)},m(a,s){le(a,t,s),n&&Ne(n,t,null),r=!0},p(a,s){if(s&1&&i!==(i=a[0].component)){if(n){Aa();const l=n;Se(l.$$.fragment,1,0,()=>{$e(l,1)}),Ca()}i?(n=Hs(i,o()),Te(n.$$.fragment),we(n.$$.fragment,1),Ne(n,t,null)):n=null}},i(a){r||(n&&we(n.$$.fragment,a),r=!0)},o(a){n&&Se(n.$$.fragment,a),r=!1},d(a){a&&se(t),n&&$e(n)}}}function eF(e){let t,n,r,i=Pe(e[1]),o=[];for(let a=0;a<i.length;a+=1)o[a]=$0(N0(e,i,a));return{c(){t=A("p"),t.textContent="This page contains a collection of simple but useful tools.",n=R(),r=A("div");for(let a=0;a<o.length;a+=1)o[a].c();P(t,"class","explanation"),P(r,"class","grid")},m(a,s){le(a,t,s),le(a,n,s),le(a,r,s);for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(r,null)},p(a,s){if(s&3){i=Pe(a[1]);let l;for(l=0;l<i.length;l+=1){const u=N0(a,i,l);o[l]?o[l].p(u,s):(o[l]=$0(u),o[l].c(),o[l].m(r,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=i.length}},i:pe,o:pe,d(a){a&&(se(t),se(n),se(r)),Ze(o,a)}}}function $0(e){let t,n,r,i,o,a,s;function l(){return e[2](e[3])}return{c(){t=A("div"),n=A("h2"),n.textContent=`${e[3].title}`,r=R(),i=A("div"),i.textContent=`${e[3].description}`,o=R(),P(i,"class","description"),P(t,"class","card")},m(u,c){le(u,t,c),p(t,n),p(t,r),p(t,i),p(t,o),a||(s=Q(t,"click",l),a=!0)},p(u,c){e=u},d(u){u&&se(t),a=!1,s()}}}function tF(e){let t,n,r,i;const o=[eF,JD],a=[];function s(l,u){return l[0]?1:0}return n=s(e),r=a[n]=o[n](e),{c(){t=A("main"),r.c()},m(l,u){le(l,t,u),a[n].m(t,null),i=!0},p(l,[u]){let c=n;n=s(l),n===c?a[n].p(l,u):(Aa(),Se(a[c],1,1,()=>{a[c]=null}),Ca(),r=a[n],r?r.p(l,u):(r=a[n]=o[n](l),r.c()),we(r,1),r.m(t,null))},i(l){i||(we(r),i=!0)},o(l){Se(r),i=!1},d(l){l&&se(t),a[n].d()}}}function nF(e,t,n){let r=[{id:"midi-logger",title:"MIDI Logger",description:"Logs all incoming MIDI messages. Useful for getting to know a device or debugging MIDI issues.",component:GD},{id:"piano-roll",title:"Piano Roll",description:"Shows MIDI input as a piano roll.",component:QD},{id:"guitar-tab",title:"Guitar Tab",description:"Shows MIDI input as guitar tab.",component:DD},{id:"guitar-tunings",title:"Guitar Tunings",description:"Small tool that computes the notes for a guitar tuning based on parameters. Open tunings are not included.",component:BD},{id:"chord-detection",title:"Chord Detection",description:"Play a chord and see what it's named.",component:Hx},{id:"note-colors",title:"Note Colors",description:"Different note coor schemes.",component:VD}],i;return[i,r,a=>{n(0,i=a)}]}class rF extends Ve{constructor(t){super(),ze(this,t,nF,tF,He,{})}}function T0(e,t){return e==null?t:typeof e=="function"?e:n=>n[e]}function iF(e,t,n,r,i,o){const a=new Float64Array(o),s=(o-1)/(i-r);for(let l=0;l<e.length;++l){const u=e[l],c=t(u,l,e),h=n(u,l,e);if(!(Number.isFinite(c)&&Number.isFinite(h)))continue;const f=(c-r)*s,d=Math.floor(f),m=d+1;0<=d&&m<o?(a[d]+=(m-f)*h,a[m]+=(f-d)*h):d===-1?a[m]+=(f-d)*h:m===o&&(a[d]+=(m-f)*h)}return a}function k0(e,t=!1){const n=new Float64Array(5),r=new Float64Array(4);oF(n,r,e);const i=Float64Array.of(0,r[1]-n[1]*r[0],r[2]-n[2]*r[0],r[3]-n[3]*r[0],-n[4]*r[0]),o=1+n[1]+n[2]+n[3]+n[4],a=(r[0]+r[1]+r[2]+r[3])/o,s=(i[1]+i[2]+i[3]+i[4])/o;return{sigma:e,negative:t,a:n,b_causal:r,b_anticausal:i,sum_causal:a,sum_anticausal:s}}function oF(e,t,n){const i=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),o=Math.exp(-1.783/n),a=Math.exp(-1.723/n),s=.6318/n,l=1.997/n,u=Float64Array.of(-o*Math.cos(s),o*Math.sin(s),-o*Math.cos(-s),o*Math.sin(-s),-a*Math.cos(l),a*Math.sin(l),-a*Math.cos(-l),a*Math.sin(-l)),c=n*2.5066282746310007,h=Float64Array.of(i[0],i[1],0,0,0,0,0,0),f=Float64Array.of(1,0,u[0],u[1],0,0,0,0,0,0);let d,m;for(m=2;m<8;m+=2){for(h[m]=u[m]*h[m-2]-u[m+1]*h[m-1],h[m+1]=u[m]*h[m-1]+u[m+1]*h[m-2],d=m-2;d>0;d-=2)h[d]+=u[m]*h[d-2]-u[m+1]*h[d-1],h[d+1]+=u[m]*h[d-1]+u[m+1]*h[d-2];for(d=0;d<=m;d+=2)h[d]+=i[m]*f[d]-i[m+1]*f[d+1],h[d+1]+=i[m]*f[d+1]+i[m+1]*f[d];for(f[m+2]=u[m]*f[m]-u[m+1]*f[m+1],f[m+3]=u[m]*f[m+1]+u[m+1]*f[m],d=m;d>0;d-=2)f[d]+=u[m]*f[d-2]-u[m+1]*f[d-1],f[d+1]+=u[m]*f[d-1]+u[m+1]*f[d-2]}for(m=0;m<4;++m)d=m<<1,t[m]=h[d]/c,e[m+1]=f[d+2]}function aF(e,t,n,r=1,i=new Float64Array(n),o=new Float64Array(n),a=new Float64Array(5),s=i,l=sF){const u=r*2,c=r*3,h=r*4,f=r*n;let d,m;for(l(i,t,n,r,e.b_causal,3,e.a,4,e.sum_causal,a,e.sigma),m=4,d=h;m<n;++m,d+=r)i[m]=e.b_causal[0]*t[d]+e.b_causal[1]*t[d-r]+e.b_causal[2]*t[d-u]+e.b_causal[3]*t[d-c]-e.a[1]*i[m-1]-e.a[2]*i[m-2]-e.a[3]*i[m-3]-e.a[4]*i[m-4];for(l(o,t,n,-r,e.b_anticausal,4,e.a,4,e.sum_anticausal,a,e.sigma),m=4,d=f-r*5;m<n;++m,d-=r)o[m]=e.b_anticausal[1]*t[d+r]+e.b_anticausal[2]*t[d+u]+e.b_anticausal[3]*t[d+c]+e.b_anticausal[4]*t[d+h]-e.a[1]*o[m-1]-e.a[2]*o[m-2]-e.a[3]*o[m-3]-e.a[4]*o[m-4];if(e.negative)for(m=0,d=0;m<n;++m,d+=r)s[d]=i[m]+o[n-m-1];else for(m=0,d=0;m<n;++m,d+=r)s[d]=Math.max(0,i[m]+o[n-m-1]);return s}function sF(e,t,n,r,i,o,a,s,l,u,c,h=.5){const f=Math.abs(r)*n,d=r<0?f+r:0;let m,b,g;for(b=0;b<s;++b)for(u[b]=b<=o?i[b]:0,g=1;g<=s&&g<=b;++g)u[b]-=a[g]*u[b-g];for(g=0;g<s;++g)for(e[g]=0,b=1;b<=g;++b)m=d+r*b,m>=0&&m<f&&(e[g]+=u[g-b]*t[m]);const E=t[d],_=Math.ceil(c*10);for(b=0;b<_;++b){for(g=0;g<s;++g)e[g]+=u[g]*E;if(l-=Math.abs(u[0]),l<=h)break;for(u[s]=b+s<=o?i[b+s]:0,g=1;g<=s;++g)u[s]-=a[g]*u[s-g];for(g=0;g<s;++g)u[g]=u[g+1]}}function lF(e,t,n=0){const r=e.length;let i,o;for(let a=0;a<r;++a){const s=t(e[a],a,e);s!=null&&(i===void 0?s>=s&&(i=o=s):(s<i&&(i=s),s>o&&(o=s)))}return[i-n,o+n]}function uF(e,t){const n=e.map(t).filter(u=>u!=null&&u>=u);n.sort((u,c)=>u-c);const r=cF(n),i=I0(n,.25),o=I0(n,.75),a=n.length,s=(o-i)/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i)||1)*Math.pow(a,-.2)}function cF(e){const t=e.length;let n=0,r,i=0,o=0;for(let a=0;a<t;++a){const s=e[a];r=s-i,i+=r/++n,o+=r*(s-i)}return n>1?Math.sqrt(o/(n-1)):NaN}function I0(e,t){const n=e.length;if(!n)return NaN;if((t=+t)<=0||n<2)return e[0];if(t>=1)return e[n-1];const r=(n-1)*t,i=Math.floor(r),o=e[i];return o+(e[i+1]-o)*(r-i)}function fF(e,t={}){const{adjust:n=1,pad:r=3,bins:i=512}=t,o=T0(t.x,E=>E),a=T0(t.weight,()=>1/e.length);let s=t.bandwidth??n*uF(e,o);const[l,u]=t.extent??lF(e,o,r*s),c=iF(e,o,a,l,u,i),h=(u-l)/(i-1),f=c.some(E=>E<0);let d=k0(s/h,f),m;function*b(E="x",_="y"){const y=g.grid(),v=1/h;for(let x=0;x<i;++x)yield{[E]:l+x*h,[_]:y[x]*v}}const g={[Symbol.iterator]:b,points:b,grid:()=>m||(m=aF(d,c,i)),extent:()=>[l,u],bandwidth(E){return arguments.length?(E!==s&&(s=E,m=null,d=k0(s/h,f)),g):s}};return g}function hF(e){let t,n,r,i,o;return{c(){t=A("button"),t.textContent="import",n=R(),r=A("input"),P(t,"title","Import all data and settings"),P(r,"type","file"),P(r,"id","file-input"),Jt(r,"display","none")},m(a,s){le(a,t,s),le(a,n,s),le(a,r,s),e[3](r),i||(o=[Q(t,"click",e[2]),Q(r,"input",function(){xa(e[0])&&e[0].apply(this,arguments)})],i=!0)},p(a,[s]){e=a},i:pe,o:pe,d(a){a&&(se(t),se(n),se(r)),e[3](null),i=!1,qe(o)}}}function dF(e,t,n){let{importFunction:r}=t,i;const o=()=>i.click();function a(s){Ue[s?"unshift":"push"](()=>{i=s,n(1,i)})}return e.$$set=s=>{"importFunction"in s&&n(0,r=s.importFunction)},[r,i,o,a]}class Hn extends Ve{constructor(t){super(),ze(this,t,dF,hF,He,{importFunction:0})}}function mF(e){let t,n,r;return{c(){t=A("button"),t.textContent="export",P(t,"title","Export all data and settings")},m(i,o){le(i,t,o),n||(r=Q(t,"click",function(){xa(e[0])&&e[0].apply(this,arguments)}),n=!0)},p(i,[o]){e=i},i:pe,o:pe,d(i){i&&se(t),n=!1,r()}}}function pF(e,t,n){let{exportFunction:r}=t;return e.$$set=i=>{"exportFunction"in i&&n(0,r=i.exportFunction)},[r]}class zn extends Ve{constructor(t){super(),ze(this,t,pF,mF,He,{exportFunction:0})}}var Fl,Rl,Bl,Ii,Ma,zr,Ea,Di,Sa,dn,Nn,Fi;class wd{constructor(){Ht(this,Fl,.03);Ht(this,Rl,.25);Ht(this,Bl,100);Ht(this,Ii,!1);Ht(this,Ma,null);Ht(this,zr,null);Ht(this,Ea,4);Ht(this,Di,1/0);Ht(this,Sa,void 0);Ht(this,dn,null);Ht(this,Nn,new AudioContext);Ht(this,Fi,null);ss(this,"_scheduler",()=>{const t=Re(this,Ea),n=60/Re(this,zr);let r=Re(this,Sa)+Re(this,dn)*n;for(;r<Re(this,Nn).currentTime+Re(this,Rl);)if(Re(this,dn)<Re(this,Di)-1){r+=n;const i=Re(this,dn)%t===t-1||Re(this,dn)===-1,o=r-Re(this,Nn).currentTime,a=performance.now()+o*1e3;this._playSound(r,a,i),Gd(this,dn)._++}Re(this,dn)<Re(this,Di)-1?fn(this,Ma,setTimeout(this._scheduler,Re(this,Bl))):this.stop()})}get bpm(){return Re(this,zr)}get beatCount(){return Re(this,dn)}onClick(t){fn(this,Fi,t)}start(t,n=4,r=1/0){if(!t||Number.isNaN(+t)){console.error(`[Metronome] Invalid bpm ${t}`);return}if(!n||Number.isNaN(+n)){console.error(`[Metronome] Invalid accent ${n}`);return}if(!r||Number.isNaN(+r)){console.error(`[Metronome] Invalid maxBeeps ${r}`);return}Re(this,Nn).state==="suspended"&&Re(this,Nn).resume(),fn(this,zr,+t),fn(this,Ea,+n),fn(this,Di,+r),fn(this,Ii,!0),console.log(`Metronome @ ${t}bpm, accent every ${n}. beat, limited to ${r}`),fn(this,dn,-1),fn(this,Sa,Re(this,Nn).currentTime),this._scheduler()}stop(){console.log("[Metronome] stopped"),clearTimeout(Re(this,Ma)),fn(this,Ii,!1)}toggle(t,n=4){Re(this,Ii)?this.stop():(t===void 0&&(t=Re(this,zr)),this.start(t,n))}_playSound(t,n,r){Re(this,Fi)&&Re(this,Fi).call(this,t,n,r);const i=Re(this,Nn).createOscillator();i.connect(Re(this,Nn).destination);const o=r?300:200;i.frequency.value=o,i.start(t),i.stop(t+Re(this,Fl))}}Fl=new WeakMap,Rl=new WeakMap,Bl=new WeakMap,Ii=new WeakMap,Ma=new WeakMap,zr=new WeakMap,Ea=new WeakMap,Di=new WeakMap,Sa=new WeakMap,dn=new WeakMap,Nn=new WeakMap,Fi=new WeakMap;function bF(e){let t,n,r;return{c(){t=A("button"),t.textContent="metronome",P(t,"title","Toggle metronome (click)")},m(i,o){le(i,t,o),n||(r=Q(t,"click",e[3]),n=!0)},p:pe,i:pe,o:pe,d(i){i&&se(t),n=!1,r()}}}function gF(e,t,n){let{tempo:r=120}=t,{accent:i=4}=t;const o=new wd;ot(()=>{o.stop()});const a=()=>{o.toggle(r,i)};return e.$$set=s=>{"tempo"in s&&n(0,r=s.tempo),"accent"in s&&n(1,i=s.accent)},[r,i,o,a]}class Md extends Ve{constructor(t){super(),ze(this,t,gF,bF,He,{tempo:0,accent:1})}}function yF(e){let t,n,r,i,o,a;return{c(){t=A("label"),n=z(e[2]),r=R(),i=A("input"),P(i,"type","number"),P(i,"step","5"),P(i,"min","10"),P(i,"max","400"),Jt(i,"width","55px"),P(t,"title",e[3])},m(s,l){le(s,t,l),p(t,n),p(t,r),p(t,i),me(i,e[0]),o||(a=[Q(i,"input",e[4]),Q(i,"change",function(){xa(e[1])&&e[1].apply(this,arguments)})],o=!0)},p(s,[l]){e=s,l&4&&_e(n,e[2]),l&1&&xe(i.value)!==e[0]&&me(i,e[0]),l&8&&P(t,"title",e[3])},i:pe,o:pe,d(s){s&&se(t),o=!1,qe(a)}}}function _F(e,t,n){let{tempo:r}=t,{callback:i=()=>{}}=t,{label:o="tempo"}=t,{title:a="The tempo in beats per minute (bpm)"}=t;function s(){r=xe(this.value),n(0,r)}return e.$$set=l=>{"tempo"in l&&n(0,r=l.tempo),"callback"in l&&n(1,i=l.callback),"label"in l&&n(2,o=l.label),"title"in l&&n(3,a=l.title)},[r,i,o,a,s]}class ai extends Ve{constructor(t){super(),ze(this,t,_F,yF,He,{tempo:0,callback:1,label:2,title:3})}}function vF(e,t){return t instanceof Map?{dataType:"Map",value:Array.from(t.entries())}:t}function wF(e,t){return typeof t=="object"&&t!==null&&t.dataType==="Map"?new Map(t.value):t}async function Vn(e){const n=await e.target.files[0].text();return JSON.parse(n,wF)}function Yn(e,t){t._demoId=e,t._date=new Date().toISOString();const n=JSON.stringify(t,vF,2),r=new Blob([n],{type:"text/plain;charset=utf-8"});dy(r,`${e}.json`)}function MF(e,t,n){const r=e.slice();return r[25]=t[n],r}function D0(e,t,n){const r=e.slice();return r[25]=t[n],r}function F0(e){let t,n=e[25]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[25],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function EF(e){let t;return{c(){t=A("option"),t.textContent=`1/${e[25]} note`,t.__value=e[25],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function SF(e){let t,n,r,i,o,a=e[1].length+"",s,l,u,c,h,f,d,m,b,g,E,_,y,v,x,w,M,C,S,N,$,T,L,D,I,V,W=e[7]?"area":"bars",U,Y,k,B,G,X,Z,ie,ee,j,J,F,ne,re,q,ce;function H(fe){e[13](fe)}let ue={callback:e[10]};e[2]!==void 0&&(ue.tempo=e[2]),d=new ai({props:ue}),Ue.push(()=>jr(d,"tempo",H));let ae=Pe(e[9]),he=[];for(let fe=0;fe<ae.length;fe+=1)he[fe]=F0(D0(e,ae,fe));let de=Pe([16,32,64,128]),ke=[];for(let fe=0;fe<4;fe+=1)ke[fe]=EF(MF(e,de,fe));return ee=new zn({props:{exportFunction:e[11]}}),J=new Hn({props:{importFunction:e[12]}}),ne=new Md({props:{tempo:e[2],accent:+e[3].split(":")[0]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Live-Subdivision",r=R(),i=A("p"),o=z("Connect a MIDI instrument (currently "),s=z(a),l=z(` connected), choose
        your tempo and subdivision, and start playing. The bar chart will show you
        how often you hit each time bin and the last `),u=z(e[6]),c=z(` notes will be
        shown as ticks that fade out one new notes come in (from red for new to blue
        for old). You can play freely, use the integrated metronome, or play a song
        in the background (in another tab). All notes will be timed relative to the
        first one, but you can adjust all notes to make them earlier or later in
        case you messed up the first one.`),h=R(),f=A("div"),Te(d.$$.fragment),b=R(),g=A("label"),E=z(`grid
            `),_=A("select");for(let fe=0;fe<he.length;fe+=1)he[fe].c();y=R(),v=A("label"),x=z(`binning
            `),w=A("select");for(let fe=0;fe<4;fe+=1)ke[fe].c();M=R(),C=A("label"),S=z(`adjust
            `),N=A("input"),$=R(),T=A("label"),L=z(`note ticks
            `),D=A("input"),I=R(),V=A("button"),U=z(W),Y=R(),k=A("div"),B=A("canvas"),G=R(),X=A("div"),Z=A("button"),Z.textContent="reset",ie=R(),Te(ee.$$.fragment),j=R(),Te(J.$$.fragment),F=R(),Te(ne.$$.fragment),P(i,"class","explanation"),e[3]===void 0&&_t(()=>e[14].call(_)),P(g,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[4]===void 0&&_t(()=>e[15].call(w)),P(v,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),P(N,"type","number"),P(N,"step","0.01"),P(N,"min","-2"),P(N,"max","2"),Jt(N,"width","55px"),P(C,"title","Shift all notes by an amount in seconds"),P(D,"type","number"),P(D,"step","1"),P(D,"min","0"),P(D,"max","100"),Jt(D,"width","55px"),P(T,"title","The number of most recent notes that are shown as ticks."),P(V,"title","Toggle between bars and area"),P(f,"class","control"),Jt(B,"width",Oo+"px"),Jt(B,"height",Wf+"px"),P(k,"class","visualization"),P(Z,"title","Clear all played notes"),P(X,"class","control"),P(t,"class","demo")},m(fe,We){le(fe,t,We),p(t,n),p(t,r),p(t,i),p(i,o),p(i,s),p(i,l),p(i,u),p(i,c),p(t,h),p(t,f),Ne(d,f,null),p(f,b),p(f,g),p(g,E),p(g,_);for(let Ie=0;Ie<he.length;Ie+=1)he[Ie]&&he[Ie].m(_,null);Le(_,e[3],!0),p(f,y),p(f,v),p(v,x),p(v,w);for(let Ie=0;Ie<4;Ie+=1)ke[Ie]&&ke[Ie].m(w,null);Le(w,e[4],!0),p(f,M),p(f,C),p(C,S),p(C,N),me(N,e[5]),p(f,$),p(f,T),p(T,L),p(T,D),me(D,e[6]),p(f,I),p(f,V),p(V,U),p(t,Y),p(t,k),p(k,B),e[19](B),p(t,G),p(t,X),p(X,Z),p(X,ie),Ne(ee,X,null),p(X,j),Ne(J,X,null),p(X,F),Ne(ne,X,null),re=!0,q||(ce=[Q(_,"change",e[14]),Q(_,"change",e[10]),Q(w,"change",e[15]),Q(w,"change",e[10]),Q(N,"input",e[16]),Q(N,"change",e[10]),Q(D,"input",e[17]),Q(D,"change",e[10]),Q(V,"click",e[18]),Q(Z,"click",e[20])],q=!0)},p(fe,[We]){(!re||We&2)&&a!==(a=fe[1].length+"")&&_e(s,a),(!re||We&64)&&_e(u,fe[6]);const Ie={};if(!m&&We&4&&(m=!0,Ie.tempo=fe[2],Xr(()=>m=!1)),d.$set(Ie),We&512){ae=Pe(fe[9]);let Oe;for(Oe=0;Oe<ae.length;Oe+=1){const Xe=D0(fe,ae,Oe);he[Oe]?he[Oe].p(Xe,We):(he[Oe]=F0(Xe),he[Oe].c(),he[Oe].m(_,null))}for(;Oe<he.length;Oe+=1)he[Oe].d(1);he.length=ae.length}We&520&&Le(_,fe[3]),We&16&&Le(w,fe[4]),We&32&&xe(N.value)!==fe[5]&&me(N,fe[5]),We&64&&xe(D.value)!==fe[6]&&me(D,fe[6]),(!re||We&128)&&W!==(W=fe[7]?"area":"bars")&&_e(U,W);const qt={};We&4&&(qt.tempo=fe[2]),We&8&&(qt.accent=+fe[3].split(":")[0]),ne.$set(qt)},i(fe){re||(we(d.$$.fragment,fe),we(ee.$$.fragment,fe),we(J.$$.fragment,fe),we(ne.$$.fragment,fe),re=!0)},o(fe){Se(d.$$.fragment,fe),Se(ee.$$.fragment,fe),Se(J.$$.fragment,fe),Se(ne.$$.fragment,fe),re=!1},d(fe){fe&&se(t),$e(d),Ze(he,fe),Ze(ke,fe),e[19](null),$e(ee),$e(J),$e(ne),q=!1,qe(ce)}}}let Oo=1e3,Wf=1e3;function xF(e,t,n){const r=["4:2","4:3","4:4","4:5","3:2","3:3","3:4","3:5"],i=Math.PI*2;let o,a=[],s=120,l=r[0],u=64,c=0,h=1,f=!1,d=0,m=[];const b=()=>{n(1,a=[]),O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((T,L)=>{console.log(`MIDI device ${L}: ${T.name}`),T.addListener("noteon",g)}),n(1,a=[...O.inputs]))},g=T=>{m.length===0&&(d=T.timestamp);const L=(T.timestamp-d)/1e3;m.push(L),E()},E=()=>{const T=Oo/2,L=Wf/2,D=Oo*.4,I=D*.8,V=D*.9,W=D*1.1,U=D*.95,Y=Math.PI/2,k=o.getContext("2d"),B=window.devicePixelRatio,G=o.getBoundingClientRect();n(0,o.width=G.width*B,o),n(0,o.height=G.height*B,o),k.scale(B,B),n(0,o.style.width=`${G.width}px`,o),n(0,o.style.height=`${G.height}px`,o),k.clearRect(0,0,Oo,Wf);const[X,Z]=l.split(":").map(q=>+q),ie=kt(s)*X,ee=m.map(q=>q+c),J=ee.map(q=>q%ie).map(q=>q/ie*i),F=Oo*.08;if(!f){k.fillStyle="#f8f8f8",k.strokeStyle="#aaa";const q=u*X/4,H=s5().domain([0,i]).thresholds(be(q).map(ae=>ae/q*i))(J),ue=tt(H,ae=>ae.length);for(const ae of H){if(ae.length===0)continue;const he=ae.length/ue*F,de=D+he,ke=ae.x0-Y,fe=Math.cos(ke),We=Math.sin(ke),Ie=ae.x1-Y,qt=Math.cos(Ie),Oe=Math.sin(Ie);k.beginPath(),k.moveTo(T+fe*D,L+We*D),k.lineTo(T+fe*de,L+We*de),k.arc(T,L,de,ke,Ie),k.lineTo(T+qt*D,L+Oe*D),k.closePath(),k.fill(),k.stroke()}}if(f&&J.length>0){let q=4/u;const ae=fF(J,{bandwidth:q,pad:.1,bins:360}).bandwidth(q),he=tt([...ae],ke=>ke.y);console.log([...ae]),k.beginPath();let de=0;for(const ke of ae){console.log(de++,ke);const fe=ke.x-Y,We=D+ke.y/he*F,Ie=Math.cos(fe),qt=Math.sin(fe);k.lineTo(T+Ie*We,L+qt*We)}k.closePath(),k.fillStyle="#e4f0fa",k.fill(),k.strokeStyle="#aaa",k.stroke()}if(h>0){k.lineWidth=3;const q=H=>aa(1-H),ce=ee.slice(-h);for(const[H,ue]of ce.entries()){const ae=ue/ie*i-Y,he=Math.cos(ae),de=Math.sin(ae);k.strokeStyle=q(H/ce.length),k.beginPath(),k.moveTo(T+he*D,L+de*D),k.lineTo(T+he*W,L+de*W),k.stroke()}}k.strokeStyle="#aaa",k.fillStyle="white",aD(k,T,L,D),k.lineWidth=2,k.fill(),k.stroke();const ne=be(X).map(q=>i/X*q-Y),re=be(X*Z).map(q=>i/(X*Z)*q-Y);k.beginPath(),k.lineWidth=2;for(const q of ne){const ce=Math.cos(q),H=Math.sin(q);k.moveTo(T+ce*I,L+H*I),k.lineTo(T+ce*U,L+H*U)}k.stroke(),k.lineWidth=1,k.beginPath();for(const q of re){const ce=Math.cos(q),H=Math.sin(q);k.moveTo(T+ce*V,L+H*V),k.lineTo(T+ce*U,L+H*U)}k.stroke()},_=()=>{Yn("sub-division",{tempo:s,grid:l,binNote:u,adjustTime:c,noteTickLimit:h,showKde:f,noteOnTimes:m})},y=async T=>{if(m.length===0||confirm("Import data and overwrite currently unsaved data?")){const L=await Vn(T);n(2,s=L.tempo),n(3,l=L.grid),n(4,u=L.binNote),n(5,c=L.adjustTime),n(6,h=L.noteTickLimit),n(8,m=L.noteOnTimes),n(7,f=L.showKde??!1),E()}};at(()=>{O.enable().then(b).catch(T=>alert(T)),E()}),ot(()=>{for(const T of O.inputs)T.removeListener()});function v(T){s=T,n(2,s)}function x(){l=Rt(this),n(3,l),n(9,r)}function w(){u=Rt(this),n(4,u)}function M(){c=xe(this.value),n(5,c)}function C(){h=xe(this.value),n(6,h)}const S=()=>{n(7,f=!f),E()};function N(T){Ue[T?"unshift":"push"](()=>{o=T,n(0,o)})}return[o,a,s,l,u,c,h,f,m,r,E,_,y,v,x,w,M,C,S,N,()=>{confirm("Reset played notes?")&&(n(8,m=[]),E())}]}class AF extends Ve{constructor(t){super(),ze(this,t,xF,SF,He,{})}}function CF(e,t,n){const r=e.slice();return r[21]=t[n],r}function PF(e,t,n){const r=e.slice();return r[21]=t[n],r}function NF(e){let t;return{c(){t=A("option"),t.textContent=`1/${e[21]} note`,t.__value=e[21],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function $F(e){let t;return{c(){t=A("option"),t.textContent=`1/${e[21]} note`,t.__value=e[21],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function R0(e){let t,n,r=e[7].toFixed(1)+"",i,o;return{c(){t=A("div"),n=z("estimated: "),i=z(r),o=z(" bpm"),P(t,"class","svelte-1ruiyqw")},m(a,s){le(a,t,s),p(t,n),p(t,i),p(t,o)},p(a,s){s&128&&r!==(r=a[7].toFixed(1)+"")&&_e(i,r)},d(a){a&&se(t)}}}function TF(e){let t,n,r,i,o,a=e[1].length+"",s,l,u,c,h,f,d,m,b,g,E,_,y,v,x,w,M,C,S,N,$,T,L,D,I,V,W,U,Y,k,B,G,X,Z,ie,ee,j,J,F=Pe([16,32,64,128]),ne=[];for(let H=0;H<4;H+=1)ne[H]=NF(PF(e,F,H));let re=Pe([16,32,64,128]),q=[];for(let H=0;H<4;H+=1)q[H]=$F(CF(e,re,H));let ce=e[7]&&R0(e);return X=new zn({props:{exportFunction:e[9]}}),ie=new Hn({props:{importFunction:e[10]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Tempo Drift",r=R(),i=A("p"),o=z("Connect a MIDI instrument (currently "),s=z(a),l=z(` connected), choose
        your tempo, and start playing. The time between two note onsets will be shown
        as a bar, so you can see how well you still hit, for example, quarter notes
        after playing for some time. Bar heights are either exact or rounded to the
        closest, for example, 64th note (binning dropdown). You can filter very short
        inter-note times, which happen whan playing two notes at roughly the same
        time as in a chord.`),u=R(),c=A("p"),c.textContent=`One possible exercise is trying to play at a given tempo without any
        count in. You can use the randomize tempo button (⚂) to get challenged.`,h=R(),f=A("div"),d=A("label"),m=z(`tempo
            `),b=A("input"),g=R(),E=A("button"),E.textContent="⚂",_=R(),y=A("label"),v=z(`binning
            `),x=A("select"),w=A("option"),w.textContent="off";for(let H=0;H<4;H+=1)ne[H].c();M=R(),C=A("label"),S=z(`filtering
            `),N=A("select"),$=A("option"),$.textContent="off";for(let H=0;H<4;H+=1)q[H].c();T=R(),L=A("label"),D=z(`bars
            `),I=A("input"),V=R(),W=A("div"),U=R(),ce&&ce.c(),Y=R(),k=A("div"),B=A("button"),B.textContent="reset",G=R(),Te(X.$$.fragment),Z=R(),Te(ie.$$.fragment),P(i,"class","explanation"),P(c,"class","explanation"),P(b,"type","number"),P(b,"step","1"),P(b,"min","10"),P(b,"max","400"),Jt(b,"width","55px"),P(d,"title","The tempo in beats per minute (bpm)"),P(E,"title","randomize tempo"),w.__value=0,me(w,w.__value),e[3]===void 0&&_t(()=>e[13].call(x)),P(y,"title","You can change between seeing exact bar heights and binned (rounded) heights."),$.__value=0,me($,$.__value),e[4]===void 0&&_t(()=>e[14].call(N)),P(C,"title","You can filter out bars that are shorter than a given note duration."),P(I,"type","number"),P(I,"step","25"),P(I,"min","25"),P(I,"max","1000"),Jt(I,"width","55px"),P(L,"title","The number of most recent notes that are shown as bars."),P(f,"class","control svelte-1ruiyqw"),P(W,"class","visualization svelte-1ruiyqw"),P(B,"title","Clear all played notes"),P(k,"class","control svelte-1ruiyqw"),P(t,"class","demo")},m(H,ue){le(H,t,ue),p(t,n),p(t,r),p(t,i),p(i,o),p(i,s),p(i,l),p(t,u),p(t,c),p(t,h),p(t,f),p(f,d),p(d,m),p(d,b),me(b,e[2]),p(f,g),p(f,E),p(f,_),p(f,y),p(y,v),p(y,x),p(x,w);for(let ae=0;ae<4;ae+=1)ne[ae]&&ne[ae].m(x,null);Le(x,e[3],!0),p(f,M),p(f,C),p(C,S),p(C,N),p(N,$);for(let ae=0;ae<4;ae+=1)q[ae]&&q[ae].m(N,null);Le(N,e[4],!0),p(f,T),p(f,L),p(L,D),p(L,I),me(I,e[5]),p(t,V),p(t,W),e[16](W),p(t,U),ce&&ce.m(t,null),p(t,Y),p(t,k),p(k,B),p(k,G),Ne(X,k,null),p(k,Z),Ne(ie,k,null),ee=!0,j||(J=[Q(b,"input",e[11]),Q(b,"change",e[8]),Q(E,"click",e[12]),Q(x,"change",e[13]),Q(x,"change",e[8]),Q(N,"change",e[14]),Q(N,"change",e[8]),Q(I,"input",e[15]),Q(I,"change",e[8]),Q(B,"click",e[17])],j=!0)},p(H,[ue]){(!ee||ue&2)&&a!==(a=H[1].length+"")&&_e(s,a),ue&4&&xe(b.value)!==H[2]&&me(b,H[2]),ue&8&&Le(x,H[3]),ue&16&&Le(N,H[4]),ue&32&&xe(I.value)!==H[5]&&me(I,H[5]),H[7]?ce?ce.p(H,ue):(ce=R0(H),ce.c(),ce.m(t,Y)):ce&&(ce.d(1),ce=null)},i(H){ee||(we(X.$$.fragment,H),we(ie.$$.fragment,H),ee=!0)},o(H){Se(X.$$.fragment,H),Se(ie.$$.fragment,H),ee=!1},d(H){H&&se(t),Ze(ne,H),Ze(q,H),e[16](null),ce&&ce.d(),$e(X),$e(ie),j=!1,qe(J)}}}let kF=1e3,IF=750;function DF(e,t,n){let r,i=[],o=120,a=64,s=0,l=50,u=0,c=[],h=0;const f=()=>{n(1,i=[]),O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((C,S)=>{console.log(`MIDI device ${S}: ${C.name}`),C.addListener("noteon",d)}),n(1,i=[...O.inputs]))},d=C=>{c.length===0&&(u=C.timestamp);const S=(C.timestamp-u)/1e3;c.push(S),m()},m=()=>{const C=kt(o),S=C/4,N=C/2,$=C*2,T=C*4,D=[0,C/3,S,N,N*1.5,C,C*1.5,$,$*1.5],I=["0","𝅘𝅥𝅘𝅥𝅘𝅥","𝅘𝅥𝅯","𝅘𝅥𝅮","𝅘𝅥𝅮.","𝅘𝅥","𝅘𝅥.","𝅗𝅥","𝅗𝅥."];let V=c.map((k,B)=>B===0?0:k-c[B-1]);if(s!==0){const k=T/s;V=V.filter(B=>B>=k)}let W=V;if(a!==0){const k=T/a;W=V.map(B=>Math.round(B/k)*k)}const U=rt({width:kF,height:IF,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:D,tickFormat:k=>{const B=D.indexOf(k);return I[B]},domain:[0,$*1.1],tickSize:0},marks:[ma(W.slice(-l),{x:(k,B)=>B,y:k=>k,fill:"#ddd",inset:0,dx:.5}),Et(D,{stroke:"#aaa"})]});n(0,r.textContent="",r),r.appendChild(U);const Y=V.filter(k=>k>.8*S&&k<1.25*C).slice(-24).map(k=>k<.6*C?k*2:k>1.5*C?k/2:k);n(7,h=bE(F1(Y)))},b=()=>{Yn("tempo-drift",{tempo:o,binNote:a,filterNote:s,barLimit:l,noteOnTimes:c})},g=async C=>{if(c.length===0||confirm("Import data and overwrite currently unsaved data?")){const S=await Vn(C);n(2,o=S.tempo),n(3,a=S.binNote),n(4,s=S.filterNote),n(5,l=S.barLimit),n(6,c=S.noteOnTimes),m()}};at(()=>{O.enable().then(f).catch(C=>alert(C)),m()}),ot(()=>{for(const C of O.inputs)C.removeListener()});function E(){o=xe(this.value),n(2,o)}const _=()=>{let C=o;for(;C===o;)C=Math.round(Math.random()*24+12)*5;n(2,o=C)};function y(){a=Rt(this),n(3,a)}function v(){s=Rt(this),n(4,s)}function x(){l=xe(this.value),n(5,l)}function w(C){Ue[C?"unshift":"push"](()=>{r=C,n(0,r)})}return[r,i,o,a,s,l,c,h,m,b,g,E,_,y,v,x,w,()=>{confirm("Reset played notes?")&&(n(6,c=[]),m())}]}class FF extends Ve{constructor(t){super(),ze(this,t,DF,TF,He,{})}}const ft="🔵",ht="⚪";function RF(e){let t,n,r,i,o,a=e[1].length+"",s,l,u,c,h,f,d,m,b=(e[2]?ft:ht)+"",g,E,_,y,v,x,w,M,C,S,N,$,T,L,D,I,V;return $=new zn({props:{exportFunction:e[6]}}),L=new Hn({props:{importFunction:e[7]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Dynamics",r=R(),i=A("p"),o=z("Connect a MIDI instrument (currently "),s=z(a),l=z(` connected) and
        start playing. The loudness of each note will be shown as a bar. Bar heights
        are either exact or rounded to the
        `),u=A("a"),u.textContent="closest rough dynamics",c=z(", for example a forte."),h=R(),f=A("div"),d=A("button"),m=z("binning "),g=z(b),E=R(),_=A("label"),y=z(`bars
            `),v=A("input"),x=R(),w=A("div"),M=R(),C=A("div"),S=A("button"),S.textContent="reset",N=R(),Te($.$$.fragment),T=R(),Te(L.$$.fragment),P(u,"href","https://en.wikipedia.org/wiki/Dynamics_(music)"),P(i,"class","explanation"),P(d,"title","You can change between seeing exact bar heights and binned (rounded) heights."),P(v,"type","number"),P(v,"step","25"),P(v,"min","25"),P(v,"max","1000"),Jt(v,"width","55px"),P(_,"title","The number of most recent notes that are shown as bars."),P(f,"class","control svelte-1p166uy"),P(w,"class","visualization svelte-1p166uy"),P(S,"title","Clear all played notes"),P(C,"class","control svelte-1p166uy"),P(t,"class","demo")},m(W,U){le(W,t,U),p(t,n),p(t,r),p(t,i),p(i,o),p(i,s),p(i,l),p(i,u),p(i,c),p(t,h),p(t,f),p(f,d),p(d,m),p(d,g),p(f,E),p(f,_),p(_,y),p(_,v),me(v,e[3]),p(t,x),p(t,w),e[10](w),p(t,M),p(t,C),p(C,S),p(C,N),Ne($,C,null),p(C,T),Ne(L,C,null),D=!0,I||(V=[Q(d,"click",e[8]),Q(v,"input",e[9]),Q(v,"change",e[5]),Q(S,"click",e[11])],I=!0)},p(W,[U]){(!D||U&2)&&a!==(a=W[1].length+"")&&_e(s,a),(!D||U&4)&&b!==(b=(W[2]?ft:ht)+"")&&_e(g,b),U&8&&xe(v.value)!==W[3]&&me(v,W[3])},i(W){D||(we($.$$.fragment,W),we(L.$$.fragment,W),D=!0)},o(W){Se($.$$.fragment,W),Se(L.$$.fragment,W),D=!1},d(W){W&&se(t),e[10](null),$e($),$e(L),I=!1,qe(V)}}}let BF=1e3,OF=600;function LF(e,t,n){let r,i=[];const a=new Map([[0,"silent"],[16,"ppp"],[32,"pp"],[48,"p"],[64,"mp"],[80,"mf"],[96,"f"],[112,"ff"],[127,"fff"]]);let s=!0,l=50,u=[];const c=()=>{console.log("MIDI enabled"),n(1,i=[]),O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((y,v)=>{console.log(`MIDI device ${v}: ${y.name}`),y.addListener("noteon",h)}),n(1,i=[...O.inputs]))},h=y=>{u.push(y.rawVelocity),f()},f=()=>{console.log("draw");let y=u;s&&(y=u.map(w=>{for(const M of a.keys())if(w<=M)return M}));const v=[...a.keys()],x=rt({width:BF,height:OF,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:v,tickFormat:w=>a.get(w),domain:[0,128],tickSize:0},marks:[ma(y.slice(-l),{x:(w,M)=>M,y:w=>w,fill:"#ddd",inset:0,dx:.5}),Et(v,{stroke:"#888"})]});n(0,r.textContent="",r),r.appendChild(x)},d=()=>{Yn("tempo-drift",{isBinning:s,barLimit:l,noteVelocities:u})},m=async y=>{if(u.length===0||confirm("Import data and overwrite currently unsaved data?")){const v=await Vn(y);n(2,s=v.isBinning),n(3,l=v.barLimit),n(4,u=v.noteVelocities),f()}};at(()=>{O.enable().then(c).catch(y=>alert(y)),f()}),ot(()=>{for(const y of O.inputs)y.removeListener()});const b=()=>{n(2,s=!s),f()};function g(){l=xe(this.value),n(3,l)}function E(y){Ue[y?"unshift":"push"](()=>{r=y,n(0,r)})}return[r,i,s,l,u,f,d,m,b,g,E,()=>{confirm("Reset played notes?")&&(n(4,u=[]),f())}]}class GF extends Ve{constructor(t){super(),ze(this,t,LF,RF,He,{})}}function UF(e){let t,n,r,i,o,a=e[1].length+"",s,l,u,c,h,f,d=(e[2]?ht:ft)+"",m,b,g,E,_=(e[3]?ft:ht)+"",y,v,x,w,M=(e[4]?ft:ht)+"",C,S,N,$,T,L,D,I,V,W,U,Y,k;return I=new zn({props:{exportFunction:e[7]}}),W=new Hn({props:{importFunction:e[8]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Improvisation Intervals",r=R(),i=A("p"),o=z("Connect a MIDI instrument (currently "),s=z(a),l=z(` connected) and
        start playing. The bar chart below shows how often you played each interval:
        when you go up in pitch, the bar of the played interval in the top half will
        increase. If you go down, it will show up in the bottom half. Colors denote
        the type of interval, so you can quickly see if you play, for example, more
        major or minor intervals.`),u=R(),c=A("div"),h=A("button"),f=z("unison "),m=z(d),b=R(),g=A("button"),E=z("colors "),y=z(_),v=R(),x=A("button"),w=z("semitones "),C=z(M),S=R(),N=A("div"),$=R(),T=A("div"),L=A("button"),D=z(`reset
            `),Te(I.$$.fragment),V=R(),Te(W.$$.fragment),P(i,"class","explanation"),P(h,"title","Toggle filtering unison intervals"),P(g,"title","Use colors for interval types"),P(x,"title","Show number of semitones instead of musical names for intervals on the y axis"),P(c,"class","control svelte-13613lz"),P(N,"class","visualization svelte-13613lz"),P(L,"title","Clear all played notes"),P(T,"class","control svelte-13613lz"),P(t,"class","demo")},m(B,G){le(B,t,G),p(t,n),p(t,r),p(t,i),p(i,o),p(i,s),p(i,l),p(t,u),p(t,c),p(c,h),p(h,f),p(h,m),p(c,b),p(c,g),p(g,E),p(g,y),p(c,v),p(c,x),p(x,w),p(x,C),p(t,S),p(t,N),e[12](N),p(t,$),p(t,T),p(T,L),p(L,D),Ne(I,L,null),p(L,V),Ne(W,L,null),U=!0,Y||(k=[Q(h,"click",e[9]),Q(g,"click",e[10]),Q(x,"click",e[11]),Q(L,"click",e[13])],Y=!0)},p(B,[G]){(!U||G&2)&&a!==(a=B[1].length+"")&&_e(s,a),(!U||G&4)&&d!==(d=(B[2]?ht:ft)+"")&&_e(m,d),(!U||G&8)&&_!==(_=(B[3]?ft:ht)+"")&&_e(y,_),(!U||G&16)&&M!==(M=(B[4]?ft:ht)+"")&&_e(C,M)},i(B){U||(we(I.$$.fragment,B),we(W.$$.fragment,B),U=!0)},o(B){Se(I.$$.fragment,B),Se(W.$$.fragment,B),U=!1},d(B){B&&se(t),e[12](null),$e(I),$e(W),Y=!1,qe(k)}}}let qF=1e3,HF=650;function zF(e,t,n){let r,i=[],o=!0,a=!1,s=!1,l=[];const u=[{semitones:0,name:"Unison",short:"P1",type:"perfect"},{semitones:1,name:"Minor 2nd",short:"m2",type:"minor"},{semitones:2,name:"Major 2nd",short:"M2",type:"major"},{semitones:3,name:"Minor 3rd",short:"m3",type:"minor"},{semitones:4,name:"Major 3rd",short:"M3",type:"major"},{semitones:5,name:"Perfect 4th",short:"P4",type:"perfect"},{semitones:6,name:"Augmented 4th",short:"A4",type:"tritone"},{semitones:7,name:"Perfect 5th",short:"P5",type:"perfect"},{semitones:8,name:"Minor 6th",short:"m6",type:"minor"},{semitones:9,name:"Major 6th",short:"M6",type:"major"},{semitones:10,name:"Minor 7th",short:"m7",type:"minor"},{semitones:11,name:"Major 7th",short:"M7",type:"major"},{semitones:12,name:"Perfect 8ve",short:"P8",type:"perfect"}],c=()=>{n(1,i=[]),O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((v,x)=>{console.log(`MIDI device ${x}: ${v.name}`),v.addListener("noteon",h)}),n(1,i=[...O.inputs]))},h=v=>{const x={number:v.note.number,velocity:v.rawVelocity,time:v.timestamp};l.push(x),f()},f=()=>{let v=l.map((M,C)=>C===0?0:M.number-l[C-1].number);o&&(v=v.filter(M=>M!==0)),v=v.map(M=>{if(Math.abs(M)<=12)return M;{const C=M>0?12:-12;for(;Math.abs(M)>12;)M-=C;return M}});const x=Ko(v,M=>M).map(([M,C])=>({interval:M,count:C.length})),w=rt({width:qF,height:HF,marginLeft:120,marginRight:10,color:{legend:a,domain:["minor","major","perfect","tritone"],range:["#7da2e8","#ed796a","gold","#ccc"]},x:{},y:{tickFormat:s?M=>M:M=>M>=0?u[M].name:u[-M].name,domain:be(-12,13,1),label:`🡸 going down ${" ".repeat(75)} going up 🡺     `,reverse:!0},marks:[Et([-12,0,12],{stroke:"#888",strokeWidth:1.5}),es(x,{x:"count",y:"interval",fill:a?M=>u[Math.abs(M.interval)].type:"#ddd",dx:.5,rx:4})]});n(0,r.textContent="",r),r.appendChild(w)},d=()=>{Yn("improvisation-intervals",{filterUnison:o,useColors:a,useSemitones:s,notes:l})},m=async v=>{if(l.length===0||confirm("Import data and overwrite currently unsaved data?")){const x=await Vn(v);n(2,o=x.filterUnison),n(3,a=x.useColors),n(4,s=x.useSemitones),n(5,l=x.notes),f()}};at(()=>{O.enable().then(c).catch(v=>alert(v)),f()}),ot(()=>{for(const v of O.inputs)v.removeListener()});const b=()=>{n(2,o=!o),f()},g=()=>{n(3,a=!a),f()},E=()=>{n(4,s=!s),f()};function _(v){Ue[v?"unshift":"push"](()=>{r=v,n(0,r)})}return[r,i,o,a,s,l,f,d,m,b,g,E,_,()=>{confirm("Reset played notes?")&&(n(5,l=[]),f())}]}class VF extends Ve{constructor(t){super(),ze(this,t,zF,UF,He,{})}}function B0(e,t,n){const r=e.slice();return r[20]=t[n],r}function O0(e,t,n){const r=e.slice();return r[23]=t[n],r}function L0(e){let t,n=e[23]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[23],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function G0(e){let t,n=e[20]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[20],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function YF(e){let t,n,r,i,o,a=e[1].length+"",s,l,u,c,h,f,d,m,b,g,E,_,y,v=(e[4]?ft:ht)+"",x,w,M,C,S=(e[5]?ft:ht)+"",N,$,T,L,D,I,V,W,U,Y,k,B,G,X=Pe(e[7]),Z=[];for(let j=0;j<X.length;j+=1)Z[j]=L0(O0(e,X,j));let ie=Pe(e[8]),ee=[];for(let j=0;j<ie.length;j+=1)ee[j]=G0(B0(e,ie,j));return W=new zn({props:{exportFunction:e[10]}}),Y=new Hn({props:{importFunction:e[11]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Improvisation Scale Degrees",r=R(),i=A("p"),o=z("Connect a MIDI instrument (currently "),s=z(a),l=z(` connected) and
        start playing. The bar chart below shows how often you played each scale
        degree.`),u=R(),c=A("div"),h=A("label"),f=z(`scale
            `),d=A("select");for(let j=0;j<Z.length;j+=1)Z[j].c();m=R(),b=A("select");for(let j=0;j<ee.length;j+=1)ee[j].c();g=R(),E=A("div"),_=A("button"),y=z("colors "),x=z(v),w=R(),M=A("button"),C=z("non-scale notes "),N=z(S),$=R(),T=A("div"),L=R(),D=A("div"),I=A("button"),I.textContent="reset",V=R(),Te(W.$$.fragment),U=R(),Te(Y.$$.fragment),P(i,"class","explanation"),e[2]===void 0&&_t(()=>e[12].call(d)),e[3]===void 0&&_t(()=>e[13].call(b)),P(c,"class","control svelte-13613lz"),P(_,"title","Use colors for root, in-scale, outside-scale"),P(M,"title","Show notes outside the scale"),P(E,"class","control svelte-13613lz"),P(T,"class","visualization svelte-13613lz"),P(I,"title","Clear all played notes"),P(D,"class","control svelte-13613lz"),P(t,"class","demo")},m(j,J){le(j,t,J),p(t,n),p(t,r),p(t,i),p(i,o),p(i,s),p(i,l),p(t,u),p(t,c),p(c,h),p(h,f),p(h,d);for(let F=0;F<Z.length;F+=1)Z[F]&&Z[F].m(d,null);Le(d,e[2],!0),p(h,m),p(h,b);for(let F=0;F<ee.length;F+=1)ee[F]&&ee[F].m(b,null);Le(b,e[3],!0),p(t,g),p(t,E),p(E,_),p(_,y),p(_,x),p(E,w),p(E,M),p(M,C),p(M,N),p(t,$),p(t,T),e[16](T),p(t,L),p(t,D),p(D,I),p(D,V),Ne(W,D,null),p(D,U),Ne(Y,D,null),k=!0,B||(G=[Q(d,"change",e[12]),Q(d,"change",e[9]),Q(b,"change",e[13]),Q(b,"change",e[9]),Q(_,"click",e[14]),Q(M,"click",e[15]),Q(I,"click",e[17])],B=!0)},p(j,[J]){if((!k||J&2)&&a!==(a=j[1].length+"")&&_e(s,a),J&128){X=Pe(j[7]);let F;for(F=0;F<X.length;F+=1){const ne=O0(j,X,F);Z[F]?Z[F].p(ne,J):(Z[F]=L0(ne),Z[F].c(),Z[F].m(d,null))}for(;F<Z.length;F+=1)Z[F].d(1);Z.length=X.length}if(J&132&&Le(d,j[2]),J&256){ie=Pe(j[8]);let F;for(F=0;F<ie.length;F+=1){const ne=B0(j,ie,F);ee[F]?ee[F].p(ne,J):(ee[F]=G0(ne),ee[F].c(),ee[F].m(b,null))}for(;F<ee.length;F+=1)ee[F].d(1);ee.length=ie.length}J&264&&Le(b,j[3]),(!k||J&16)&&v!==(v=(j[4]?ft:ht)+"")&&_e(x,v),(!k||J&32)&&S!==(S=(j[5]?ft:ht)+"")&&_e(N,S)},i(j){k||(we(W.$$.fragment,j),we(Y.$$.fragment,j),k=!0)},o(j){Se(W.$$.fragment,j),Se(Y.$$.fragment,j),k=!1},d(j){j&&se(t),Ze(Z,j),Ze(ee,j),e[16](null),$e(W),$e(Y),B=!1,qe(G)}}}let WF=1e3,XF=650;function jF(e,t,n){let r,i=[],o="A",a="minor pentatonic",s=!0,l=!0,u=[];const c=md,h=la.names(),f=()=>{n(1,i=[]),O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((M,C)=>{console.log(`MIDI device ${C}: ${M.name}`),M.addListener("noteon",d)}),n(1,i=[...O.inputs]))},d=M=>{const C={number:M.note.number,velocity:M.rawVelocity,time:M.timestamp};u.push(C),m()},m=()=>{if(u.length===0)return;const M=c.indexOf(o),C=la.get(`${o} ${a}`),S=C.notes.map((I,V)=>{const W=c.indexOf(I);let U=W-M;return U=U>=0?U:U+12,{name:I,chroma:W,interval:C.intervals[V],degree:V,offset:U}}),N=new Set(S.map(I=>I.offset)),T=u.map(I=>I.number%12).map(I=>{const V=I-M;return V>=0?V:V+12}),L=Ko(T,I=>I).map(([I,V])=>({value:I,count:V.length})),D=rt({width:WF,height:XF,marginLeft:70,marginRight:10,color:{legend:s,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:I=>c[(I+M)%12],domain:l?be(0,12,1):[...N],reverse:!0,label:"notes, increasing semitones from root 🡺"},marks:[es(L,{x:"count",y:"value",fill:I=>s?I.value===0?"#666":N.has(I.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});n(0,r.textContent="",r),r.appendChild(D)},b=()=>{Yn("improvisation-scale-degrees",{root:o,scale:a,useColors:s,showOutsideScale:l,notes:u})},g=async M=>{if(u.length===0||confirm("Import data and overwrite currently unsaved data?")){const C=await Vn(M);n(2,o=C.root),n(3,a=C.scale),n(4,s=C.useColors),n(5,l=C.showOutsideScale),n(6,u=C.notes),m()}};at(()=>{O.enable().then(f).catch(M=>alert(M)),m()}),ot(()=>{for(const M of O.inputs)M.removeListener()});function E(){o=Rt(this),n(2,o),n(7,c)}function _(){a=Rt(this),n(3,a),n(8,h)}const y=()=>{n(4,s=!s),m()},v=()=>{n(5,l=!l),m()};function x(M){Ue[M?"unshift":"push"](()=>{r=M,n(0,r)})}return[r,i,o,a,s,l,u,c,h,m,b,g,E,_,y,v,x,()=>{confirm("Reset played notes?")&&(n(6,u=[]),m())}]}class KF extends Ve{constructor(t){super(),ze(this,t,jF,YF,He,{})}}function ZF(e){let t,n,r,i,o,a,s,l,u,c,h,f,d;return{c(){t=A("main"),n=A("h2"),n.textContent="Fretboard Heatmap",r=R(),i=A("p"),i.textContent=`Connect a MIDI guitar and start playing. The heatmap below shows how
        often you played each fretboard position.`,o=R(),a=A("div"),a.innerHTML="",s=R(),l=A("div"),u=R(),c=A("div"),h=A("button"),h.textContent="reset",P(i,"class","explanation"),P(a,"class","control"),P(l,"class","visualization"),P(h,"title","Clear all played notes"),P(c,"class","control"),P(t,"class","demo")},m(m,b){le(m,t,b),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(t,s),p(t,l),e[3](l),p(t,u),p(t,c),p(c,h),f||(d=Q(h,"click",e[4]),f=!0)},p:pe,i:pe,o:pe,d(m){m&&se(t),e[3](null),f=!1,d()}}}let U0=1e3,QF=280,q0=6,Cc=24;function JF(e,t,n){let r=[64,59,55,50,45,40],i,o=[];const a=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((h,f)=>{console.log(`MIDI device ${f}: ${h.name}`),h.addListener("noteon",s)}),[...O.inputs])},s=h=>{const f=h.message.channel-1,d={number:h.note.number,velocity:h.rawVelocity,time:h.timestamp,channel:h.message.channel,string:f,fret:h.note.number-r[f]};o.push(d),l()},l=()=>{const h=r.map(wn.fromMidiSharps),f=o.map(b=>{const g=b.channel-1;return{...b,string:g,fret:b.number-r[g]}}),d=(U0-100)/25,m=rt({width:U0,height:QF,marginLeft:60,marginBottom:50,padding:0,x:{domain:be(0,Cc+1),ticks:be(0,Cc+1),tickSize:0},y:{domain:be(0,q0),tickFormat:b=>h[b],tickSize:0},color:{legend:!0,marginLeft:100,width:400,scheme:"blues"},marks:[Pt(be(0,Cc+1),{stroke:"#ddd",dx:d/2}),Et(be(0,q0),{stroke:"#ddd",strokeWidth:b=>Math.sqrt(b+1)}),on([3,5,7,9,15,17,19,21],{x:b=>b,y:2,dy:d/2,fill:"#ddd",r:8}),on([12,12,24,24],{x:b=>b,y:(b,g)=>g%2===0?1:3,dy:d/2,fill:"#ddd",r:8}),Of(f,$A({fill:"count"},{x:"fret",y:"string",fill:"count",inset:5,rx:"50%",tip:!0}))]});n(0,i.textContent="",i),i.appendChild(m)};at(()=>{O.enable().then(a).catch(h=>alert(h)),l()}),ot(()=>{for(const h of O.inputs)h.removeListener()});function u(h){Ue[h?"unshift":"push"](()=>{i=h,n(0,i)})}return[i,o,l,u,()=>{confirm("Reset played notes?")&&(n(1,o=[]),l())}]}class eR extends Ve{constructor(t){super(),ze(this,t,JF,ZF,He,{})}}function tR(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v;return{c(){t=A("main"),n=A("h2"),n.textContent="Chord and Arpeggio Timing",r=R(),i=A("p"),i.innerHTML="",o=R(),a=A("div"),s=A("label"),l=z(`max. note distance
            `),u=A("input"),c=R(),h=A("label"),f=z(`time
            `),d=A("input"),m=R(),b=A("div"),g=R(),E=A("div"),_=A("button"),_.textContent="reset",P(i,"class","explanation"),P(u,"type","number"),P(u,"min","0.05"),P(u,"max","5"),P(u,"step","0.05"),P(s,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),P(d,"type","number"),P(d,"min","10"),P(d,"max","300"),P(d,"step","10"),P(h,"title","time in seconds for past notes to be shown"),P(a,"class","control"),P(b,"class","visualization"),P(_,"title","Clear all played notes"),P(E,"class","control"),P(t,"class","demo")},m(x,w){le(x,t,w),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u),me(u,e[2]),p(a,c),p(a,h),p(h,f),p(h,d),me(d,e[1]),p(t,m),p(t,b),e[8](b),p(t,g),p(t,E),p(E,_),y||(v=[Q(u,"input",e[6]),Q(u,"change",e[5]),Q(d,"input",e[7]),Q(d,"change",e[5]),Q(_,"click",e[9])],y=!0)},p(x,[w]){w&4&&xe(u.value)!==x[2]&&me(u,x[2]),w&2&&xe(d.value)!==x[1]&&me(d,x[1])},i:pe,o:pe,d(x){x&&se(t),e[8](null),y=!1,qe(v)}}}let Pc=1e3,nR=400;function rR(e,t,n){let r,i=10,o=.2,a=0,s=[];const l=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((b,g)=>{console.log(`MIDI device ${g}: ${b.name}`),b.addListener("noteon",u)}),[...O.inputs])},u=b=>{const g=(b.timestamp-a)/1e3,E={number:b.note.number,velocity:b.rawVelocity,time:g,channel:b.message.channel};s.push(E),c()},c=()=>{const b=tt(s,S=>S.time)+.5,g=b-i,E=s.filter(S=>S.end>g||S.end===void 0),_=[];let y=[];for(const S of E)y.length===0||S.time-y.at(-1).time<o?y.push(S):(_.push(y),y=[S]);_.push(y);const v=_.map(S=>Ft(S,N=>N.time)),x=v.slice(1).map((S,N)=>[v[N][0],S[0]]),w=rt({insetRight:10,width:Pc,height:nR,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[g,b]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,tickFormat:S=>pa[S].label},marks:[l0(E,{clip:!0,x:"time",y:"number",fill:"#ddd",stroke:"#ccc"})]}),M=rt({insetRight:10,width:Pc,height:100,marginLeft:60,marginTop:0,marginBottom:0,padding:0,x:{label:null,domain:[g,b],axis:!1},y:{ticks:[],label:"durations (s)"},marks:[a0(v,{clip:!0,x1:S=>S[0],x2:S=>S[1],y:0}),$r(v,{clip:!0,x:S=>S[0],y:0,text:(S,N)=>(S[1]-S[0]).toFixed(2),dy:10,textAnchor:"start"})]}),C=rt({insetRight:10,width:Pc,height:100,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[g,b]},y:{ticks:[],label:"gaps (s)"},marks:[a0(x,{clip:!0,x1:S=>S[0],x2:S=>S[1],y:0}),l0(x,{clip:!0,x:S=>S[0]}),$r(x,{clip:!0,x:S=>S[0],y:0,text:(S,N)=>(S[1]-S[0]).toFixed(2),dx:2,dy:10,textAnchor:"start"})]});n(0,r.textContent="",r),r.appendChild(w),r.appendChild(M),r.appendChild(C)};at(()=>{O.enable().then(l).catch(b=>alert(b)),n(3,a=performance.now()),c()}),ot(()=>{for(const b of O.inputs)b.removeListener()});function h(){o=xe(this.value),n(2,o)}function f(){i=xe(this.value),n(1,i)}function d(b){Ue[b?"unshift":"push"](()=>{r=b,n(0,r)})}return[r,i,o,a,s,c,h,f,d,()=>{confirm("Reset played notes?")&&(n(4,s=[]),n(3,a=performance.now()))}]}class iR extends Ve{constructor(t){super(),ze(this,t,rR,tR,He,{})}}function oR(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x;return g=new zn({props:{exportFunction:e[4]}}),_=new Hn({props:{importFunction:e[5]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Keyboard Histogram",r=R(),i=A("p"),i.textContent=`Connect a MIDI keyboard and start playing. The heatmap below shows how
        often you played each keyboard key.`,o=R(),a=A("div"),s=A("label"),l=z(`number of notes
            `),u=A("input"),c=R(),h=A("div"),f=R(),d=A("div"),m=A("button"),m.textContent="reset",b=R(),Te(g.$$.fragment),E=R(),Te(_.$$.fragment),P(i,"class","explanation"),P(u,"type","number"),P(u,"min","0"),P(u,"max","250"),P(u,"step","1"),P(a,"class","control"),P(h,"class","visualization"),P(m,"title","Clear all played notes"),P(d,"class","control"),P(t,"class","demo")},m(w,M){le(w,t,M),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u),me(u,e[1]),p(t,c),p(t,h),e[7](h),p(t,f),p(t,d),p(d,m),p(d,b),Ne(g,d,null),p(d,E),Ne(_,d,null),y=!0,v||(x=[Q(u,"input",e[6]),Q(m,"click",e[8])],v=!0)},p(w,[M]){M&2&&xe(u.value)!==w[1]&&me(u,w[1])},i(w){y||(we(g.$$.fragment,w),we(_.$$.fragment,w),y=!0)},o(w){Se(g.$$.fragment,w),Se(_.$$.fragment,w),y=!1},d(w){w&&se(t),e[7](null),$e(g),$e(_),v=!1,qe(x)}}}let aR=1200,sR=280;const Nc=21,$c=108;function lR(e,t,n){let r,i=500,o=[];const a=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((b,g)=>{console.log(`MIDI device ${g}: ${b.name}`),b.addListener("noteon",s),b.addListener("controlchange",l)}),[...O.inputs])},s=b=>{const g={number:b.note.number,velocity:b.rawVelocity,time:b.timestamp,channel:b.message.channel};o.push(g),u()},l=b=>{const g=gE(b.rawValue*2,20,250);n(1,i=g),u()},u=()=>{const b=o.slice(-i),g=Ko(b,y=>y.number);console.log(g);const E=tt(g,y=>y[1].length);console.log(E);const _=rt({width:aR,height:sR,marginLeft:80,marginBottom:50,padding:0,x:{domain:be(Nc,$c),tickFormat:y=>Wo(y)?"":y%12===0?`
`+wn.fromMidiSharps(y):wn.fromMidiSharps(y).slice(0,-1)},y:{},marks:[Pt(cy(Nc,$c),{stroke:"#ddd"}),Et([0],{stroke:"#ddd"}),ma(be(Nc,$c).filter(y=>Wo(y)),{x:y=>y,y:()=>E,fill:"#f8f8f8",inset:.5}),ma(b,NA({y:"count"},{x:"number",fill:y=>Wo(y.number)?"#444":"#ccc",inset:.5,rx:4,tip:!0}))]});n(0,r.textContent="",r),r.appendChild(_)},c=()=>{Yn("keyboard-histogram",{notes:o,pastNoteCount:i})},h=async b=>{if(o.length===0||confirm("Import data and overwrite currently unsaved data?")){const g=await Vn(b);n(2,o=g.notes),n(1,i=g.pastNoteCount),u()}};at(()=>{O.enable().then(a).catch(b=>alert(b)),u()}),ot(()=>{for(const b of O.inputs)b.removeListener()});function f(){i=xe(this.value),n(1,i)}function d(b){Ue[b?"unshift":"push"](()=>{r=b,n(0,r)})}return[r,i,o,u,c,h,f,d,()=>{confirm("Reset played notes?")&&(n(2,o=[]),u())}]}class uR extends Ve{constructor(t){super(),ze(this,t,lR,oR,He,{})}}function H0(e,t,n){const r=e.slice();return r[16]=t[n],r}function z0(e,t,n){const r=e.slice();return r[19]=t[n],r}function V0(e){let t,n=e[19]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[19],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function Y0(e){let t,n=e[16]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[16],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function cR(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y=Pe(e[4]),v=[];for(let M=0;M<y.length;M+=1)v[M]=V0(z0(e,y,M));let x=Pe(e[5]),w=[];for(let M=0;M<x.length;M+=1)w[M]=Y0(H0(e,x,M));return{c(){t=A("main"),n=A("h2"),n.textContent="Fretboard Improvisation Intervals",r=R(),i=A("p"),o=R(),a=A("div"),s=A("label"),l=z(`scale
            `),u=A("select");for(let M=0;M<v.length;M+=1)v[M].c();c=R(),h=A("select");for(let M=0;M<w.length;M+=1)w[M].c();f=R(),d=A("div"),m=R(),b=A("div"),g=A("button"),g.textContent="reset",P(i,"class","explanation"),e[1]===void 0&&_t(()=>e[7].call(u)),e[2]===void 0&&_t(()=>e[8].call(h)),P(a,"class","control"),P(d,"class","visualization"),P(g,"title","Clear all played notes"),P(b,"class","control"),P(t,"class","demo")},m(M,C){le(M,t,C),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u);for(let S=0;S<v.length;S+=1)v[S]&&v[S].m(u,null);Le(u,e[1],!0),p(s,c),p(s,h);for(let S=0;S<w.length;S+=1)w[S]&&w[S].m(h,null);Le(h,e[2],!0),p(t,f),p(t,d),e[9](d),p(t,m),p(t,b),p(b,g),E||(_=[Q(u,"change",e[7]),Q(u,"change",e[6]),Q(h,"change",e[8]),Q(h,"change",e[6]),Q(g,"click",e[10])],E=!0)},p(M,[C]){if(C&16){y=Pe(M[4]);let S;for(S=0;S<y.length;S+=1){const N=z0(M,y,S);v[S]?v[S].p(N,C):(v[S]=V0(N),v[S].c(),v[S].m(u,null))}for(;S<v.length;S+=1)v[S].d(1);v.length=y.length}if(C&18&&Le(u,M[1]),C&32){x=Pe(M[5]);let S;for(S=0;S<x.length;S+=1){const N=H0(M,x,S);w[S]?w[S].p(N,C):(w[S]=Y0(N),w[S].c(),w[S].m(h,null))}for(;S<w.length;S+=1)w[S].d(1);w.length=x.length}C&36&&Le(h,M[2])},i:pe,o:pe,d(M){M&&se(t),Ze(v,M),Ze(w,M),e[9](null),E=!1,qe(_)}}}let W0=1e3,fR=280,Tc=6,kc=24;function hR(e,t,n){let r,i="A",o="minor pentatonic",a=[],s=[64,59,55,50,45,40];const l=s.map(wn.fromMidiSharps),u=md,c=la.names(),h=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((_,y)=>{console.log(`MIDI device ${y}: ${_.name}`),_.addListener("noteon",f)}),[...O.inputs])},f=_=>{const y=_.message.channel-1,v={number:_.note.number,velocity:_.rawVelocity,time:_.timestamp,channel:_.message.channel,string:y,fret:_.note.number-s[y]};a.push(v),d()},d=()=>{const _=a.at(-1),y=[];if(_)for(let w=0;w<Tc;w++)for(let M=0;M<kc+1;M++){let S=(s[w]+M-_.number)%12;S<0&&(S+=12),y.push({string:w,fret:M,step:S})}const v=(W0-100)/25,x=rt({width:W0,height:fR,marginLeft:60,marginBottom:50,padding:0,x:{domain:be(0,kc+1),tickSize:0},y:{domain:be(0,Tc),tickFormat:w=>l[w]+" "+w,tickSize:0},color:{legend:!0,marginLeft:100,width:400,type:"categorical"},marks:[Pt(be(0,kc+1),{stroke:"#ddd",dx:v/2}),Et(be(0,Tc),{stroke:"#ddd",strokeWidth:w=>Math.sqrt(w+1)}),on([3,5,7,9,15,17,19,21],{x:w=>w,y:2,dy:v/2,fill:"#ddd",r:8}),on([12,12,24,24],{x:w=>w,y:(w,M)=>M%2===0?1:3,dy:v/2,fill:"#ddd",r:8}),_?Of([_],{x:"fret",y:"string",fill:"black",tip:!0,inset:5,rx:5}):null,Of(y,{x:"fret",y:"string",fill:"step",inset:10,rx:"50%",tip:!0})]});n(0,r.textContent="",r),r.appendChild(x)};at(()=>{O.enable().then(h).catch(_=>alert(_)),d()}),ot(()=>{for(const _ of O.inputs)_.removeListener()});function m(){i=Rt(this),n(1,i),n(4,u)}function b(){o=Rt(this),n(2,o),n(5,c)}function g(_){Ue[_?"unshift":"push"](()=>{r=_,n(0,r)})}return[r,i,o,a,u,c,d,m,b,g,()=>{confirm("Reset played notes?")&&(n(3,a=[]),d())}]}class dR extends Ve{constructor(t){super(),ze(this,t,hR,cR,He,{})}}function mR(e,t,n){const r=e.slice();return r[32]=t[n],r}function pR(e,t,n){const r=e.slice();return r[32]=t[n],r}function bR(e){let t;return{c(){t=A("option"),t.textContent=`${e[32]}`,t.__value=e[32],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function gR(e){let t;return{c(){t=A("option"),t.textContent=`${e[32]}`,t.__value=e[32],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function yR(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x,w,M,C,S,N,$,T,L,D,I,V,W,U,Y,k,B,G,X,Z,ie,ee,j,J,F,ne,re,q,ce,H,ue,ae,he,de,ke,fe,We,Ie,qt,Oe,Xe,Br,ho;function Du(te){e[18](te)}let mo={label:"initial tempo",title:"Set a tempo at which you are able to input the exercise precisely (in BPM)",callback:e[14]};e[1]!==void 0&&(mo.tempo=e[1]),s=new ai({props:mo}),Ue.push(()=>jr(s,"tempo",Du));function Fu(te){e[19](te)}let po={label:"target tempo",title:"Set the tempo you want to be able to play the exercise at (in BPM)",callback:e[14]};e[2]!==void 0&&(po.tempo=e[2]),c=new ai({props:po}),Ue.push(()=>jr(c,"tempo",Fu));let Ru=Pe(["off","32nd","16th","8th"]),un=[];for(let te=0;te<4;te+=1)un[te]=bR(pR(e,Ru,te));let Bu=Pe(["quarter","eighth","quarter-triplets","swing"]),cn=[];for(let te=0;te<4;te+=1)cn[te]=gR(mR(e,Bu,te));return Ie=new zn({props:{exportFunction:e[16]}}),Oe=new Hn({props:{importFunction:e[17]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Speed-Up",r=R(),i=A("p"),i.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo.`,o=R(),a=A("div"),Te(s.$$.fragment),u=R(),Te(c.$$.fragment),f=R(),d=A("label"),m=z(`tempo increase
            `),b=A("input"),g=R(),E=A("label"),_=z(`quantize exercise
            `),y=A("select");for(let te=0;te<4;te+=1)un[te].c();v=R(),x=A("div"),w=A("label"),M=z(`pre-defined exercise
            `),C=A("select");for(let te=0;te<4;te+=1)cn[te].c();S=R(),N=A("button"),$=z("input exercise"),L=R(),D=A("button"),I=z("save exercise"),W=R(),U=A("button"),Y=z("start practice"),B=R(),G=A("button"),X=z("stop practice"),ie=R(),ee=A("div"),j=z("current step: "),J=A("b"),F=z(e[5]),ne=z(" current tempo: "),re=A("b"),q=z(e[6]),ce=z(" BPM"),H=R(),ue=A("div"),ae=R(),he=A("div"),de=A("button"),ke=z("reset practice"),We=R(),Te(Ie.$$.fragment),qt=R(),Te(Oe.$$.fragment),P(i,"class","explanation"),P(b,"type","number"),P(b,"min","1"),P(b,"max","20"),P(b,"step","1"),P(d,"title","Set the tempo increase between practice runs (in BPM)"),e[4]===void 0&&_t(()=>e[21].call(y)),P(a,"class","control"),P(N,"title","Start recording the exercise."),N.disabled=T=e[5]==="input exercise"||e[5]==="practice",P(D,"title","Stop recording the exercise."),D.disabled=V=e[5]!=="input exercise",P(U,"title","Start recording the practice with speed-up."),U.disabled=k=e[8].length===0,P(G,"title","Stop recording the practice with speed-up."),G.disabled=Z=e[5]!=="practice",P(x,"class","control"),P(ue,"class","visualization"),P(de,"title","Clear practice but not exercise"),de.disabled=fe=e[5]!=="",P(he,"class","control"),P(t,"class","demo")},m(te,Ge){le(te,t,Ge),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),Ne(s,a,null),p(a,u),Ne(c,a,null),p(a,f),p(a,d),p(d,m),p(d,b),me(b,e[3]),p(a,g),p(a,E),p(E,_),p(E,y);for(let je=0;je<4;je+=1)un[je]&&un[je].m(y,null);Le(y,e[4],!0),p(t,v),p(t,x),p(x,w),p(w,M),p(w,C);for(let je=0;je<4;je+=1)cn[je]&&cn[je].m(C,null);p(x,S),p(x,N),p(N,$),p(x,L),p(x,D),p(D,I),p(x,W),p(x,U),p(U,Y),p(x,B),p(x,G),p(G,X),p(t,ie),p(t,ee),p(ee,j),p(ee,J),p(J,F),p(ee,ne),p(ee,re),p(re,q),p(ee,ce),p(t,H),p(t,ue),e[22](ue),p(t,ae),p(t,he),p(he,de),p(de,ke),p(he,We),Ne(Ie,he,null),p(he,qt),Ne(Oe,he,null),Xe=!0,Br||(ho=[Q(b,"input",e[20]),Q(y,"change",e[21]),Q(y,"change",e[14]),Q(C,"change",e[15]),Q(N,"click",e[10]),Q(D,"click",e[11]),Q(U,"click",e[12]),Q(G,"click",e[13]),Q(de,"click",e[23])],Br=!0)},p(te,Ge){const je={};!l&&Ge[0]&2&&(l=!0,je.tempo=te[1],Xr(()=>l=!1)),s.$set(je);const bo={};!h&&Ge[0]&4&&(h=!0,bo.tempo=te[2],Xr(()=>h=!1)),c.$set(bo),Ge[0]&8&&xe(b.value)!==te[3]&&me(b,te[3]),Ge[0]&16&&Le(y,te[4]),(!Xe||Ge[0]&32&&T!==(T=te[5]==="input exercise"||te[5]==="practice"))&&(N.disabled=T),(!Xe||Ge[0]&32&&V!==(V=te[5]!=="input exercise"))&&(D.disabled=V),(!Xe||Ge[0]&256&&k!==(k=te[8].length===0))&&(U.disabled=k),(!Xe||Ge[0]&32&&Z!==(Z=te[5]!=="practice"))&&(G.disabled=Z),(!Xe||Ge[0]&32)&&_e(F,te[5]),(!Xe||Ge[0]&64)&&_e(q,te[6]),(!Xe||Ge[0]&32&&fe!==(fe=te[5]!==""))&&(de.disabled=fe)},i(te){Xe||(we(s.$$.fragment,te),we(c.$$.fragment,te),we(Ie.$$.fragment,te),we(Oe.$$.fragment,te),Xe=!0)},o(te){Se(s.$$.fragment,te),Se(c.$$.fragment,te),Se(Ie.$$.fragment,te),Se(Oe.$$.fragment,te),Xe=!1},d(te){te&&se(t),$e(s),$e(c),Ze(un,te),Ze(cn,te),e[22](null),$e(Ie),$e(Oe),Br=!1,qe(ho)}}}let X0=1e3,_R=60;function vR(e,t,n){const r=e[0];return e.map(o=>{let a=o-r;if(t!=="off"){let s;t==="8th"&&(s=n/2),t==="16th"&&(s=n/4),t==="32nd"&&(s=n/8),a=Math.round(a/s)*s}return a/n})}function wR(e,t,n){let r,i=new wd,o=60,a=120,s=10,l="off",u="",c=a,h=0,f=[],d,m=new Map,b=!0,g;const E=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((U,Y)=>{console.log(`MIDI device ${Y}: ${U.name}`),U.addListener("noteon",_)}),[...O.inputs])},_=async U=>{const k=(U.timestamp-h)/1e3;if(u==="input exercise")n(8,f=[...f,k]);else if(u==="practice"){m.has(c)||m.set(c,[]);const B=m.get(c);b&&B.push(k)}C()},y=async()=>{const U=m.get(c);if(!U||!U.length)return;const Y=Nt(U),B=(performance.now()-h)/1e3-Y;let G=kt(c);B/G>=d&&(console.log("increasing bpm"),i.stop(),c<=a?(n(6,c+=s),b=!1,await fy(1),i.start(c,4),m.has(c)&&m.set(c,[]),b=!0):M())},v=()=>{n(5,u="input exercise"),n(8,f=[]),n(9,m=new Map),i.start(o,4),C()},x=()=>{if(n(5,u=""),i.stop(),f.length>0){const U=tt(f)-Nt(f);let Y=kt(o);d=Math.ceil(U/Y)}},w=async()=>{if(f.length===0){alert("You need to input an exercise first");return}n(5,u="practice"),n(6,c=o),n(9,m=new Map),i.start(c,4),g=setInterval(y,100)},M=()=>{console.log("stop practice"),n(5,u=""),n(6,c=a),clearInterval(g),i.stop()},C=()=>{if(n(0,r.textContent="",r),f.length===0)return;let U=kt(o);const Y=vR(f,l,U);let k=Math.ceil(tt(Y)/4*4)+.5;console.log(Y,k);const B=rt({width:X0,height:_R,marginLeft:40,x:{label:"time in beats",domain:[0,k]},y:{},marks:[Pt(be(0,k,1),{stroke:"#ddd"}),Pt(be(0,k,4)),on(Y,{symbol:"times",stroke:"#333",x:G=>G,r:5})]});r.appendChild(B);for(const[G,X]of m){const Z=X[0];U=kt(G);const ie=X.map(j=>(j-Z)/U),ee=rt({width:X0,height:70,marginLeft:40,x:{label:"time in beats",domain:[0,k]},y:{label:`${G} BPM`,ticks:[]},marks:[Pt(be(0,k,1),{stroke:"#ddd"}),Pt(be(0,k,4)),on(ie,{symbol:"times",stroke:"#333",x:j=>j,y:0,r:5})]});r.appendChild(ee)}};at(()=>{O.enable().then(E).catch(U=>alert(U)),n(7,h=performance.now()),C()}),ot(()=>{for(const U of O.inputs)U.removeListener();clearInterval(g),i.stop()});const S=U=>{const Y=U.target.value,k=new Map([["quarter",be(0,8,1)],["eighth",be(0,8,.5)],["quarter-triplets",be(0,8,1/3)],["swing",be(0,8,.5).map((X,Z)=>Z%2===0?Z:Z+.2)]]),B=kt(o);n(4,l="off");const G=k.get(Y);n(8,f=G.map(X=>X*B)),d=Math.ceil(tt(G)+1),console.log(Y,f),C()},N=()=>{Yn("speed-up",{initialTempo:o,targetTempo:a,tempoIncrease:s,quantize:l,currentStep:u,currentTempo:c,firstTimeStamp:h,exerciseNotes:f,exerciseBeatCount:d,practiceRecordings:m})},$=async U=>{if(f.length===0||confirm("Import data and overwrite currently unsaved data?")){const Y=await Vn(U);n(1,o=Y.initialTempo),n(2,a=Y.targetTempo),n(3,s=Y.tempoIncrease),n(4,l=Y.quantize),n(5,u=Y.currentStep),n(6,c=Y.currentTempo),n(7,h=Y.firstTimeStamp),n(8,f=Y.exerciseNotes),d=Y.exerciseBeatCount,n(9,m=Y.practiceRecordings),C()}};function T(U){o=U,n(1,o)}function L(U){a=U,n(2,a)}function D(){s=xe(this.value),n(3,s)}function I(){l=Rt(this),n(4,l)}function V(U){Ue[U?"unshift":"push"](()=>{r=U,n(0,r)})}return[r,o,a,s,l,u,c,h,f,m,v,x,w,M,C,S,N,$,T,L,D,I,V,()=>{confirm("Reset practice?")&&(n(9,m=new Map),n(7,h=performance.now()),C())}]}class MR extends Ve{constructor(t){super(),ze(this,t,wR,yR,He,{},null,[-1,-1])}}function ER(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g=(e[3]?ft:ht)+"",E,_,y,v,x,w,M,C,S,N,$;function T(D){e[7](D)}let L={callback:e[6]};return e[1]!==void 0&&(L.tempo=e[1]),s=new ai({props:L}),Ue.push(()=>jr(s,"tempo",T)),C=new Md({props:{tempo:e[1],accent:4}}),{c(){t=A("main"),n=A("h2"),n.textContent="Rhythm Sheet Music",r=R(),i=A("p"),i.textContent=`Set a tempo and start playing. The time between the notes you play will
        be displayed as note symbols, so you can see whether you play, for
        example, correct quarter notes.`,o=R(),a=A("div"),Te(s.$$.fragment),u=R(),c=A("label"),h=z(`note count
            `),f=A("input"),d=R(),m=A("button"),b=z("dotted notes "),E=z(g),_=R(),y=A("div"),v=R(),x=A("div"),w=A("button"),w.textContent="reset",M=R(),Te(C.$$.fragment),P(i,"class","explanation"),P(f,"type","number"),P(f,"min","5"),P(f,"max","100"),P(f,"step","5"),P(c,"title","Number of shown notes"),P(m,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),P(a,"class","control"),P(y,"class","visualization"),P(w,"title","Clear played notes"),P(x,"class","control"),P(t,"class","demo")},m(D,I){le(D,t,I),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),Ne(s,a,null),p(a,u),p(a,c),p(c,h),p(c,f),me(f,e[2]),p(a,d),p(a,m),p(m,b),p(m,E),p(t,_),p(t,y),e[10](y),p(t,v),p(t,x),p(x,w),p(x,M),Ne(C,x,null),S=!0,N||($=[Q(f,"input",e[8]),Q(f,"change",e[6]),Q(m,"click",e[9]),Q(w,"click",e[11])],N=!0)},p(D,[I]){const V={};!l&&I&2&&(l=!0,V.tempo=D[1],Xr(()=>l=!1)),s.$set(V),I&4&&xe(f.value)!==D[2]&&me(f,D[2]),(!S||I&8)&&g!==(g=(D[3]?ft:ht)+"")&&_e(E,g);const W={};I&2&&(W.tempo=D[1]),C.$set(W)},i(D){S||(we(s.$$.fragment,D),we(C.$$.fragment,D),S=!0)},o(D){Se(s.$$.fragment,D),Se(C.$$.fragment,D),S=!1},d(D){D&&se(t),$e(s),e[10](null),$e(C),N=!1,qe($)}}}let j0=1e3;function SR(e,t,n){let r,i=120,o=10,a=!0,s=0,l=[];const u=[{name:"double-whole",beats:8,symbol:"𝅝_𝅝"},{name:"dotted-whole",beats:6,symbol:"𝅝.",dotted:!0},{name:"whole",beats:4,symbol:"𝅝"},{name:"dotted-half",beats:3,symbol:"𝅗𝅥.",dotted:!0},{name:"half",beats:2,symbol:"𝅗𝅥"},{name:"dotted-quarter",beats:1.5,symbol:"𝅘𝅥.",dotted:!0},{name:"quarter",beats:1,symbol:"𝅘𝅥"},{name:"dotted-eighth",beats:.75,symbol:"𝅘𝅥𝅮.",dotted:!0},{name:"eighth",beats:.5,symbol:"𝅘𝅥𝅮"},{name:"dotted-sixteenth",beats:.375,symbol:"𝅘𝅥𝅯.",dotted:!0},{name:"sixteenth",beats:.25,symbol:"𝅘𝅥𝅯"},{name:"thirtysecond",beats:.125,symbol:"𝅘𝅥𝅰"},{name:"sixtyfourth",beats:.0625,symbol:"𝅘𝅥𝅱"}],c=u.filter(y=>!y.dotted),h=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((y,v)=>{console.log(`MIDI device ${v}: ${y.name}`),y.addListener("noteon",f)}),[...O.inputs])},f=async y=>{const x=(y.timestamp-s)/1e3;l.push(x),d()},d=()=>{if(n(0,r.textContent="",r),l.length===0)return;let y=kt(i);const v=l.slice(-(o+1)),w=v.map(($,T)=>T===0?0:$-v[T-1]).map($=>$/y),M=a?u:c,C=w.map($=>{const T=k1(M,D=>Math.abs($-D.beats)),L=M[T];return{...L,beats:$,offsetPercent:($/L.beats*100).toFixed()}}),S=rt({width:j0,height:100,marginLeft:80,x:{label:"",domain:be(1,o),ticks:[]},y:{domain:[1,0],ticks:be(3),tickFormat:$=>["note","beats"][$]},marks:[$r(C,{text:"symbol",x:($,T)=>T,y:0,fontSize:40}),$r(C,{text:"beats",x:($,T)=>T,y:1,fontSize:20})]});r.appendChild(S);const N=rt({width:j0,height:100,marginLeft:80,x:{label:"Note",domain:be(1,o),tickSize:0,ticks:[]},y:{domain:[0,150],ticks:[0,50,100,150]},marks:[ma(C,{x:($,T)=>T,y:"offsetPercent",fill:"#ddd"}),Et([50,150],{stroke:"#aaa"}),Et([100])]});r.appendChild(N)};at(()=>{O.enable().then(h).catch(y=>alert(y)),n(4,s=performance.now()),d()}),ot(()=>{for(const y of O.inputs)y.removeListener()});function m(y){i=y,n(1,i)}function b(){o=xe(this.value),n(2,o)}const g=()=>n(3,a=!a);function E(y){Ue[y?"unshift":"push"](()=>{r=y,n(0,r)})}return[r,i,o,a,s,l,d,m,b,g,E,()=>{confirm("Clear notes?")&&(n(4,s=performance.now()),n(5,l=[]),d())}]}class xR extends Ve{constructor(t){super(),ze(this,t,SR,ER,He,{})}}function AR(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x,w,M,C;return{c(){t=A("main"),n=A("h2"),n.textContent="Chord Diagrams",r=R(),i=A("p"),i.textContent="Play chords on a guitar and see the chord names and diagrams.",o=R(),a=A("div"),s=A("label"),l=z(`max. note distance
            `),u=A("input"),c=R(),h=A("label"),f=z(`max. fret span
            `),d=A("input"),m=R(),b=A("label"),g=z(`chord count
            `),E=A("input"),_=R(),y=A("div"),v=R(),x=A("div"),w=A("button"),w.textContent="reset",P(i,"class","explanation"),P(u,"type","number"),P(u,"min","0.05"),P(u,"max","5"),P(u,"step","0.05"),P(s,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),P(d,"type","number"),P(d,"min","5"),P(d,"max","25"),P(d,"step","1"),P(h,"title","maximum distance between the lowest and highest fret"),P(E,"type","number"),P(E,"min","10"),P(E,"max","300"),P(E,"step","10"),P(b,"title","The number of played chords that is displayed"),P(a,"class","control"),P(y,"class","visualization"),P(w,"title","Clear all played notes"),P(x,"class","control"),P(t,"class","demo")},m(S,N){le(S,t,N),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u),me(u,e[3]),p(a,c),p(a,h),p(h,f),p(h,d),me(d,e[2]),p(a,m),p(a,b),p(b,g),p(b,E),me(E,e[1]),p(t,_),p(t,y),e[10](y),p(t,v),p(t,x),p(x,w),M||(C=[Q(u,"input",e[7]),Q(u,"change",e[6]),Q(d,"input",e[8]),Q(d,"change",e[6]),Q(E,"input",e[9]),Q(E,"change",e[6]),Q(w,"click",e[11])],M=!0)},p(S,[N]){N&8&&xe(u.value)!==S[3]&&me(u,S[3]),N&4&&xe(d.value)!==S[2]&&me(d,S[2]),N&2&&xe(E.value)!==S[1]&&me(E,S[1])},i:pe,o:pe,d(S){S&&se(t),e[10](null),M=!1,qe(C)}}}let K0=200,Z0=6,CR=24;function PR(e,t,n){let r,i=5,o=5,a=.1,s=[64,59,55,50,45,40];const l=s.map(wn.fromMidiSharps);let u=0,c=[];const h=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((y,v)=>{console.log(`MIDI device ${v}: ${y.name}`),y.addListener("noteon",f)}),[...O.inputs])},f=y=>{const v=(y.timestamp-u)/1e3,x=y.message.channel-1,w={number:y.note.number,velocity:y.rawVelocity,time:v,channel:y.message.channel,string:x,fret:y.note.number-s[x]};c.push(w),d()},d=()=>{let y=[],v=[];for(const C of c)v.length===0||C.time-v.at(-1).time<a?v.push(C):(y.push(v),v=[C]);y.push(v),y=y.map(C=>{const S=C.filter(T=>T.fret>0);let N;S.length===0?N=0:N=Nt(S,T=>T.fret);const $=N+o;return C.filter(T=>T.fret<=$)}),y=y.filter(C=>C.length>2).slice(-i);for(const[C,S]of y.entries())for(const N of S)N.chordId=C;const x=y.map(C=>{let S=C.sort((N,$)=>N.number-$.number).map(N=>wn.fromMidiSharps(N.number));return S=[...new Set(S)],Oy.detect(S)}),w=(K0-35)/3*(o+1)+50,M=(w-100)/(o+2);n(0,r.textContent="",r);for(const[C,S]of y.entries()){const N=S.filter(D=>D.fret>0);let $=0;N.length>0&&($=Nt(N,D=>D.fret));const T=$+o,L=rt({width:w,height:K0,marginLeft:40,marginRight:10,marginBottom:25,padding:0,figure:!0,subtitle:x[C].join(", "),style:{textAlign:"center"},x:{domain:be($===0?0:$-1,T+2),label:"",tickSize:0,tickPadding:15},y:{domain:be(0,Z0),tickFormat:D=>l[D],label:"",tickSize:0,tickPadding:15},color:{domain:be(12),range:Gs.noteColormap,legend:C===0,marginLeft:100,width:600,type:"categorical",tickFormat:D=>dd[D]},r:{domain:[0,100],range:[5,10]},marks:[Pt(be(0,CR+1),{stroke:"#ddd",dx:M/2}),Et(be(0,Z0),{stroke:"#ddd",strokeWidth:D=>Math.sqrt(D+1)}),on([3,5,7,9,15,17,19,21],{x:D=>D,y:2,dy:M/2,fill:"#ddd",r:8}),on([12,12,24,24],{x:D=>D,y:(D,I)=>I%2===0?1:3,dy:M/2,fill:"#ddd",r:8}),on(S.filter(D=>D.fret>0),{x:"fret",y:"string",r:"velocity",fill:D=>D.number%12,tip:!0}),on(S.filter(D=>D.fret===0),{x:$===0?0:$-1,y:"string",r:"velocity",stroke:D=>D.number%12,tip:!0})]});r.appendChild(L)}};at(()=>{O.enable().then(h).catch(y=>alert(y)),n(4,u=performance.now()),d()}),ot(()=>{for(const y of O.inputs)y.removeListener()});function m(){a=xe(this.value),n(3,a)}function b(){o=xe(this.value),n(2,o)}function g(){i=xe(this.value),n(1,i)}function E(y){Ue[y?"unshift":"push"](()=>{r=y,n(0,r)})}return[r,i,o,a,u,c,d,m,b,g,E,()=>{confirm("Reset played notes?")&&(n(5,c=[]),n(4,u=performance.now()))}]}class NR extends Ve{constructor(t){super(),ze(this,t,PR,AR,He,{})}}var Iw="1.13.6",Q0=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},ku=Array.prototype,Ed=Object.prototype,J0=typeof Symbol<"u"?Symbol.prototype:null,$R=ku.push,rs=ku.slice,_a=Ed.toString,TR=Ed.hasOwnProperty,Dw=typeof ArrayBuffer<"u",kR=typeof DataView<"u",IR=Array.isArray,e1=Object.keys,t1=Object.create,n1=Dw&&ArrayBuffer.isView,DR=isNaN,FR=isFinite,Fw=!{toString:null}.propertyIsEnumerable("toString"),r1=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],RR=Math.pow(2,53)-1;function Ot(e,t){return t=t==null?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=r,e.apply(this,o)}}function mi(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function BR(e){return e===null}function Rw(e){return e===void 0}function Bw(e){return e===!0||e===!1||_a.call(e)==="[object Boolean]"}function OR(e){return!!(e&&e.nodeType===1)}function St(e){var t="[object "+e+"]";return function(n){return _a.call(n)===t}}const Sd=St("String"),Ow=St("Number"),LR=St("Date"),GR=St("RegExp"),UR=St("Error"),Lw=St("Symbol"),Gw=St("ArrayBuffer");var Uw=St("Function"),qR=Q0.document&&Q0.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof qR!="function"&&(Uw=function(e){return typeof e=="function"||!1});const $t=Uw,qw=St("Object");var Hw=kR&&qw(new DataView(new ArrayBuffer(8))),xd=typeof Map<"u"&&qw(new Map),HR=St("DataView");function zR(e){return e!=null&&$t(e.getInt8)&&Gw(e.buffer)}const kl=Hw?zR:HR,pi=IR||St("Array");function Rr(e,t){return e!=null&&TR.call(e,t)}var Xf=St("Arguments");(function(){Xf(arguments)||(Xf=function(e){return Rr(e,"callee")})})();const Ad=Xf;function VR(e){return!Lw(e)&&FR(e)&&!isNaN(parseFloat(e))}function zw(e){return Ow(e)&&DR(e)}function Vw(e){return function(){return e}}function Yw(e){return function(t){var n=e(t);return typeof n=="number"&&n>=0&&n<=RR}}function Ww(e){return function(t){return t==null?void 0:t[e]}}const Il=Ww("byteLength"),YR=Yw(Il);var WR=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function XR(e){return n1?n1(e)&&!kl(e):YR(e)&&WR.test(_a.call(e))}const Xw=Dw?XR:Vw(!1),Lt=Ww("length");function jR(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return{contains:function(i){return t[i]===!0},push:function(i){return t[i]=!0,e.push(i)}}}function jw(e,t){t=jR(t);var n=r1.length,r=e.constructor,i=$t(r)&&r.prototype||Ed,o="constructor";for(Rr(e,o)&&!t.contains(o)&&t.push(o);n--;)o=r1[n],o in e&&e[o]!==i[o]&&!t.contains(o)&&t.push(o)}function bt(e){if(!mi(e))return[];if(e1)return e1(e);var t=[];for(var n in e)Rr(e,n)&&t.push(n);return Fw&&jw(e,t),t}function KR(e){if(e==null)return!0;var t=Lt(e);return typeof t=="number"&&(pi(e)||Sd(e)||Ad(e))?t===0:Lt(bt(e))===0}function Kw(e,t){var n=bt(t),r=n.length;if(e==null)return!r;for(var i=Object(e),o=0;o<r;o++){var a=n[o];if(t[a]!==i[a]||!(a in i))return!1}return!0}function Fe(e){if(e instanceof Fe)return e;if(!(this instanceof Fe))return new Fe(e);this._wrapped=e}Fe.VERSION=Iw;Fe.prototype.value=function(){return this._wrapped};Fe.prototype.valueOf=Fe.prototype.toJSON=Fe.prototype.value;Fe.prototype.toString=function(){return String(this._wrapped)};function i1(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Il(e))}var o1="[object DataView]";function jf(e,t,n,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!=="function"&&i!=="object"&&typeof t!="object"?!1:Zw(e,t,n,r)}function Zw(e,t,n,r){e instanceof Fe&&(e=e._wrapped),t instanceof Fe&&(t=t._wrapped);var i=_a.call(e);if(i!==_a.call(t))return!1;if(Hw&&i=="[object Object]"&&kl(e)){if(!kl(t))return!1;i=o1}switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return J0.valueOf.call(e)===J0.valueOf.call(t);case"[object ArrayBuffer]":case o1:return Zw(i1(e),i1(t),n,r)}var o=i==="[object Array]";if(!o&&Xw(e)){var a=Il(e);if(a!==Il(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;o=!0}if(!o){if(typeof e!="object"||typeof t!="object")return!1;var s=e.constructor,l=t.constructor;if(s!==l&&!($t(s)&&s instanceof s&&$t(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===e)return r[u]===t;if(n.push(e),r.push(t),o){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!jf(e[u],t[u],n,r))return!1}else{var c=bt(e),h;if(u=c.length,bt(t).length!==u)return!1;for(;u--;)if(h=c[u],!(Rr(t,h)&&jf(e[h],t[h],n,r)))return!1}return n.pop(),r.pop(),!0}function ZR(e,t){return jf(e,t)}function is(e){if(!mi(e))return[];var t=[];for(var n in e)t.push(n);return Fw&&jw(e,t),t}function Cd(e){var t=Lt(e);return function(n){if(n==null)return!1;var r=is(n);if(Lt(r))return!1;for(var i=0;i<t;i++)if(!$t(n[e[i]]))return!1;return e!==e3||!$t(n[Pd])}}var Pd="forEach",Qw="has",Nd=["clear","delete"],Jw=["get",Qw,"set"],QR=Nd.concat(Pd,Jw),e3=Nd.concat(Jw),JR=["add"].concat(Nd,Pd,Qw);const eB=xd?Cd(QR):St("Map"),tB=xd?Cd(e3):St("WeakMap"),nB=xd?Cd(JR):St("Set"),rB=St("WeakSet");function co(e){for(var t=bt(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r}function iB(e){for(var t=bt(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r}function t3(e){for(var t={},n=bt(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t}function Kf(e){var t=[];for(var n in e)$t(e[n])&&t.push(n);return t.sort()}function $d(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),r<2||n==null)return n;for(var i=1;i<r;i++)for(var o=arguments[i],a=e(o),s=a.length,l=0;l<s;l++){var u=a[l];(!t||n[u]===void 0)&&(n[u]=o[u])}return n}}const n3=$d(is),Dl=$d(bt),r3=$d(is,!0);function oB(){return function(){}}function i3(e){if(!mi(e))return{};if(t1)return t1(e);var t=oB();t.prototype=e;var n=new t;return t.prototype=null,n}function aB(e,t){var n=i3(e);return t&&Dl(n,t),n}function sB(e){return mi(e)?pi(e)?e.slice():n3({},e):e}function lB(e,t){return t(e),e}function o3(e){return pi(e)?e:[e]}Fe.toPath=o3;function os(e){return Fe.toPath(e)}function Td(e,t){for(var n=t.length,r=0;r<n;r++){if(e==null)return;e=e[t[r]]}return n?e:void 0}function a3(e,t,n){var r=Td(e,os(t));return Rw(r)?n:r}function uB(e,t){t=os(t);for(var n=t.length,r=0;r<n;r++){var i=t[r];if(!Rr(e,i))return!1;e=e[i]}return!!n}function kd(e){return e}function va(e){return e=Dl({},e),function(t){return Kw(t,e)}}function Id(e){return e=os(e),function(t){return Td(t,e)}}function as(e,t,n){if(t===void 0)return e;switch(n??3){case 1:return function(r){return e.call(t,r)};case 3:return function(r,i,o){return e.call(t,r,i,o)};case 4:return function(r,i,o,a){return e.call(t,r,i,o,a)}}return function(){return e.apply(t,arguments)}}function s3(e,t,n){return e==null?kd:$t(e)?as(e,t,n):mi(e)&&!pi(e)?va(e):Id(e)}function Dd(e,t){return s3(e,t,1/0)}Fe.iteratee=Dd;function Ut(e,t,n){return Fe.iteratee!==Dd?Fe.iteratee(e,t):s3(e,t,n)}function cB(e,t,n){t=Ut(t,n);for(var r=bt(e),i=r.length,o={},a=0;a<i;a++){var s=r[a];o[s]=t(e[s],s,e)}return o}function l3(){}function fB(e){return e==null?l3:function(t){return a3(e,t)}}function hB(e,t,n){var r=Array(Math.max(0,e));t=as(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r}function Zf(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const wa=Date.now||function(){return new Date().getTime()};function u3(e){var t=function(o){return e[o]},n="(?:"+bt(e).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(o){return o=o==null?"":""+o,r.test(o)?o.replace(i,t):o}}const c3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},dB=u3(c3),mB=t3(c3),pB=u3(mB),bB=Fe.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Ic=/(.)^/,gB={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},yB=/\\|'|\r|\n|\u2028|\u2029/g;function _B(e){return"\\"+gB[e]}var vB=/^\s*(\w|\$)+\s*$/;function wB(e,t,n){!t&&n&&(t=n),t=r3({},t,Fe.templateSettings);var r=RegExp([(t.escape||Ic).source,(t.interpolate||Ic).source,(t.evaluate||Ic).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(r,function(u,c,h,f,d){return o+=e.slice(i,d).replace(yB,_B),i=d+u.length,c?o+=`'+
((__t=(`+c+`))==null?'':_.escape(__t))+
'`:h?o+=`'+
((__t=(`+h+`))==null?'':__t)+
'`:f&&(o+=`';
`+f+`
__p+='`),u}),o+=`';
`;var a=t.variable;if(a){if(!vB.test(a))throw new Error("variable is not a bare identifier: "+a)}else o=`with(obj||{}){
`+o+`}
`,a="obj";o=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+o+`return __p;
`;var s;try{s=new Function(a,"_",o)}catch(u){throw u.source=o,u}var l=function(u){return s.call(this,u,Fe)};return l.source="function("+a+`){
`+o+"}",l}function MB(e,t,n){t=os(t);var r=t.length;if(!r)return $t(n)?n.call(e):n;for(var i=0;i<r;i++){var o=e==null?void 0:e[t[i]];o===void 0&&(o=n,i=r),e=$t(o)?o.call(e):o}return e}var EB=0;function SB(e){var t=++EB+"";return e?e+t:t}function xB(e){var t=Fe(e);return t._chain=!0,t}function f3(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var o=i3(e.prototype),a=e.apply(o,i);return mi(a)?a:o}var fo=Ot(function(e,t){var n=fo.placeholder,r=function(){for(var i=0,o=t.length,a=Array(o),s=0;s<o;s++)a[s]=t[s]===n?arguments[i++]:t[s];for(;i<arguments.length;)a.push(arguments[i++]);return f3(e,r,this,this,a)};return r});fo.placeholder=Fe;const h3=Ot(function(e,t,n){if(!$t(e))throw new TypeError("Bind must be called on a function");var r=Ot(function(i){return f3(e,r,t,this,n.concat(i))});return r}),jt=Yw(Lt);function bi(e,t,n,r){if(r=r||[],!t&&t!==0)t=1/0;else if(t<=0)return r.concat(e);for(var i=r.length,o=0,a=Lt(e);o<a;o++){var s=e[o];if(jt(s)&&(pi(s)||Ad(s)))if(t>1)bi(s,t-1,n,r),i=r.length;else for(var l=0,u=s.length;l<u;)r[i++]=s[l++];else n||(r[i++]=s)}return r}const AB=Ot(function(e,t){t=bi(t,!1,!1);var n=t.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=h3(e[r],e)}return e});function CB(e,t){var n=function(r){var i=n.cache,o=""+(t?t.apply(this,arguments):r);return Rr(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return n.cache={},n}const d3=Ot(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),PB=fo(d3,Fe,1);function m3(e,t,n){var r,i,o,a,s=0;n||(n={});var l=function(){s=n.leading===!1?0:wa(),r=null,a=e.apply(i,o),r||(i=o=null)},u=function(){var c=wa();!s&&n.leading===!1&&(s=c);var h=t-(c-s);return i=this,o=arguments,h<=0||h>t?(r&&(clearTimeout(r),r=null),s=c,a=e.apply(i,o),r||(i=o=null)):!r&&n.trailing!==!1&&(r=setTimeout(l,h)),a};return u.cancel=function(){clearTimeout(r),s=0,r=i=o=null},u}function NB(e,t,n){var r,i,o,a,s,l=function(){var c=wa()-i;t>c?r=setTimeout(l,t-c):(r=null,n||(a=e.apply(s,o)),r||(o=s=null))},u=Ot(function(c){return s=this,o=c,i=wa(),r||(r=setTimeout(l,t),n&&(a=e.apply(s,o))),a});return u.cancel=function(){clearTimeout(r),r=o=s=null},u}function $B(e,t){return fo(t,e)}function Fd(e){return function(){return!e.apply(this,arguments)}}function TB(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}}function kB(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function p3(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}const IB=fo(p3,2);function b3(e,t,n){t=Ut(t,n);for(var r=bt(e),i,o=0,a=r.length;o<a;o++)if(i=r[o],t(e[i],i,e))return i}function g3(e){return function(t,n,r){n=Ut(n,r);for(var i=Lt(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(n(t[o],o,t))return o;return-1}}const Rd=g3(1),y3=g3(-1);function _3(e,t,n,r){n=Ut(n,r,1);for(var i=n(t),o=0,a=Lt(e);o<a;){var s=Math.floor((o+a)/2);n(e[s])<i?o=s+1:a=s}return o}function v3(e,t,n){return function(r,i,o){var a=0,s=Lt(r);if(typeof o=="number")e>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(r,i),r[o]===i?o:-1;if(i!==i)return o=t(rs.call(r,a,s),zw),o>=0?o+a:-1;for(o=e>0?a:s-1;o>=0&&o<s;o+=e)if(r[o]===i)return o;return-1}}const w3=v3(1,Rd,_3),DB=v3(-1,y3);function Qf(e,t,n){var r=jt(e)?Rd:b3,i=r(e,t,n);if(i!==void 0&&i!==-1)return e[i]}function FB(e,t){return Qf(e,va(t))}function cr(e,t,n){t=as(t,n);var r,i;if(jt(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=bt(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e}function si(e,t,n){t=Ut(t,n);for(var r=!jt(e)&&bt(e),i=(r||e).length,o=Array(i),a=0;a<i;a++){var s=r?r[a]:a;o[a]=t(e[s],s,e)}return o}function M3(e){var t=function(n,r,i,o){var a=!jt(n)&&bt(n),s=(a||n).length,l=e>0?0:s-1;for(o||(i=n[a?a[l]:l],l+=e);l>=0&&l<s;l+=e){var u=a?a[l]:l;i=r(i,n[u],u,n)}return i};return function(n,r,i,o){var a=arguments.length>=3;return t(n,as(r,o,4),i,a)}}const Dc=M3(1),a1=M3(-1);function to(e,t,n){var r=[];return t=Ut(t,n),cr(e,function(i,o,a){t(i,o,a)&&r.push(i)}),r}function RB(e,t,n){return to(e,Fd(Ut(t)),n)}function s1(e,t,n){t=Ut(t,n);for(var r=!jt(e)&&bt(e),i=(r||e).length,o=0;o<i;o++){var a=r?r[o]:o;if(!t(e[a],a,e))return!1}return!0}function l1(e,t,n){t=Ut(t,n);for(var r=!jt(e)&&bt(e),i=(r||e).length,o=0;o<i;o++){var a=r?r[o]:o;if(t(e[a],a,e))return!0}return!1}function rr(e,t,n,r){return jt(e)||(e=co(e)),(typeof n!="number"||r)&&(n=0),w3(e,t,n)>=0}const BB=Ot(function(e,t,n){var r,i;return $t(t)?i=t:(t=os(t),r=t.slice(0,-1),t=t[t.length-1]),si(e,function(o){var a=i;if(!a){if(r&&r.length&&(o=Td(o,r)),o==null)return;a=o[t]}return a==null?a:a.apply(o,n)})});function Bd(e,t){return si(e,Id(t))}function OB(e,t){return to(e,va(t))}function E3(e,t,n){var r=-1/0,i=-1/0,o,a;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=jt(e)?e:co(e);for(var s=0,l=e.length;s<l;s++)o=e[s],o!=null&&o>r&&(r=o)}else t=Ut(t,n),cr(e,function(u,c,h){a=t(u,c,h),(a>i||a===-1/0&&r===-1/0)&&(r=u,i=a)});return r}function LB(e,t,n){var r=1/0,i=1/0,o,a;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=jt(e)?e:co(e);for(var s=0,l=e.length;s<l;s++)o=e[s],o!=null&&o<r&&(r=o)}else t=Ut(t,n),cr(e,function(u,c,h){a=t(u,c,h),(a<i||a===1/0&&r===1/0)&&(r=u,i=a)});return r}var GB=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function S3(e){return e?pi(e)?rs.call(e):Sd(e)?e.match(GB):jt(e)?si(e,kd):co(e):[]}function x3(e,t,n){if(t==null||n)return jt(e)||(e=co(e)),e[Zf(e.length-1)];var r=S3(e),i=Lt(r);t=Math.max(Math.min(t,i),0);for(var o=i-1,a=0;a<t;a++){var s=Zf(a,o),l=r[a];r[a]=r[s],r[s]=l}return r.slice(0,t)}function UB(e){return x3(e,1/0)}function qB(e,t,n){var r=0;return t=Ut(t,n),Bd(si(e,function(i,o,a){return{value:i,index:r++,criteria:t(i,o,a)}}).sort(function(i,o){var a=i.criteria,s=o.criteria;if(a!==s){if(a>s||a===void 0)return 1;if(a<s||s===void 0)return-1}return i.index-o.index}),"value")}function Iu(e,t){return function(n,r,i){var o=t?[[],[]]:{};return r=Ut(r,i),cr(n,function(a,s){var l=r(a,s,n);e(o,a,l)}),o}}const HB=Iu(function(e,t,n){Rr(e,n)?e[n].push(t):e[n]=[t]}),zB=Iu(function(e,t,n){e[n]=t}),VB=Iu(function(e,t,n){Rr(e,n)?e[n]++:e[n]=1}),YB=Iu(function(e,t,n){e[n?0:1].push(t)},!0);function WB(e){return e==null?0:jt(e)?e.length:bt(e).length}function XB(e,t,n){return t in n}const A3=Ot(function(e,t){var n={},r=t[0];if(e==null)return n;$t(r)?(t.length>1&&(r=as(r,t[1])),t=is(e)):(r=XB,t=bi(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var a=t[i],s=e[a];r(s,a,e)&&(n[a]=s)}return n}),jB=Ot(function(e,t){var n=t[0],r;return $t(n)?(n=Fd(n),t.length>1&&(r=t[1])):(t=si(bi(t,!1,!1),String),n=function(i,o){return!rr(t,o)}),A3(e,n,r)});function C3(e,t,n){return rs.call(e,0,Math.max(0,e.length-(t==null||n?1:t)))}function Fc(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[0]:C3(e,e.length-t)}function Us(e,t,n){return rs.call(e,t==null||n?1:t)}function KB(e,t,n){return e==null||e.length<1?t==null||n?void 0:[]:t==null||n?e[e.length-1]:Us(e,Math.max(0,e.length-t))}function ZB(e){return to(e,Boolean)}function QB(e,t){return bi(e,t,!1)}const P3=Ot(function(e,t){return t=bi(t,!0,!0),to(e,function(n){return!rr(t,n)})}),JB=Ot(function(e,t){return P3(e,t)});function Jf(e,t,n,r){Bw(t)||(r=n,n=t,t=!1),n!=null&&(n=Ut(n,r));for(var i=[],o=[],a=0,s=Lt(e);a<s;a++){var l=e[a],u=n?n(l,a,e):l;t&&!n?((!a||o!==u)&&i.push(l),o=u):n?rr(o,u)||(o.push(u),i.push(l)):rr(i,l)||i.push(l)}return i}const eO=Ot(function(e){return Jf(bi(e,!0,!0))});function tO(e){for(var t=[],n=arguments.length,r=0,i=Lt(e);r<i;r++){var o=e[r];if(!rr(t,o)){var a;for(a=1;a<n&&rr(arguments[a],o);a++);a===n&&t.push(o)}}return t}function eh(e){for(var t=e&&E3(e,Lt).length||0,n=Array(t),r=0;r<t;r++)n[r]=Bd(e,r);return n}const nO=Ot(eh);function rO(e,t){for(var n={},r=0,i=Lt(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n}function iO(e,t,n){t==null&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;o<r;o++,e+=n)i[o]=e;return i}function oO(e,t){if(t==null||t<1)return[];for(var n=[],r=0,i=e.length;r<i;)n.push(rs.call(e,r,r+=t));return n}function Od(e,t){return e._chain?Fe(t).chain():t}function N3(e){return cr(Kf(e),function(t){var n=Fe[t]=e[t];Fe.prototype[t]=function(){var r=[this._wrapped];return $R.apply(r,arguments),Od(this,n.apply(Fe,r))}}),Fe}cr(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=ku[e];Fe.prototype[e]=function(){var n=this._wrapped;return n!=null&&(t.apply(n,arguments),(e==="shift"||e==="splice")&&n.length===0&&delete n[0]),Od(this,n)}});cr(["concat","join","slice"],function(e){var t=ku[e];Fe.prototype[e]=function(){var n=this._wrapped;return n!=null&&(n=t.apply(n,arguments)),Od(this,n)}});const aO=Object.freeze(Object.defineProperty({__proto__:null,VERSION:Iw,after:kB,all:s1,allKeys:is,any:l1,assign:Dl,before:p3,bind:h3,bindAll:AB,chain:xB,chunk:oO,clone:sB,collect:si,compact:ZB,compose:TB,constant:Vw,contains:rr,countBy:VB,create:aB,debounce:NB,default:Fe,defaults:r3,defer:PB,delay:d3,detect:Qf,difference:P3,drop:Us,each:cr,escape:dB,every:s1,extend:n3,extendOwn:Dl,filter:to,find:Qf,findIndex:Rd,findKey:b3,findLastIndex:y3,findWhere:FB,first:Fc,flatten:QB,foldl:Dc,foldr:a1,forEach:cr,functions:Kf,get:a3,groupBy:HB,has:uB,head:Fc,identity:kd,include:rr,includes:rr,indexBy:zB,indexOf:w3,initial:C3,inject:Dc,intersection:tO,invert:t3,invoke:BB,isArguments:Ad,isArray:pi,isArrayBuffer:Gw,isBoolean:Bw,isDataView:kl,isDate:LR,isElement:OR,isEmpty:KR,isEqual:ZR,isError:UR,isFinite:VR,isFunction:$t,isMap:eB,isMatch:Kw,isNaN:zw,isNull:BR,isNumber:Ow,isObject:mi,isRegExp:GR,isSet:nB,isString:Sd,isSymbol:Lw,isTypedArray:Xw,isUndefined:Rw,isWeakMap:tB,isWeakSet:rB,iteratee:Dd,keys:bt,last:KB,lastIndexOf:DB,map:si,mapObject:cB,matcher:va,matches:va,max:E3,memoize:CB,methods:Kf,min:LB,mixin:N3,negate:Fd,noop:l3,now:wa,object:rO,omit:jB,once:IB,pairs:iB,partial:fo,partition:YB,pick:A3,pluck:Bd,property:Id,propertyOf:fB,random:Zf,range:iO,reduce:Dc,reduceRight:a1,reject:RB,rest:Us,restArguments:Ot,result:MB,sample:x3,select:to,shuffle:UB,size:WB,some:l1,sortBy:qB,sortedIndex:_3,tail:Us,take:Fc,tap:lB,template:wB,templateSettings:bB,throttle:m3,times:hB,toArray:S3,toPath:o3,transpose:eh,unescape:pB,union:eO,uniq:Jf,unique:Jf,uniqueId:SB,unzip:eh,values:co,where:OB,without:JB,wrap:$B,zip:nO},Symbol.toStringTag,{value:"Module"}));var u1=N3(aO);u1._=u1;function sO(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x;return g=new zn({props:{exportFunction:e[4]}}),_=new Hn({props:{importFunction:e[5]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Pitch Bend",r=R(),i=A("p"),i.textContent=`Connect a MIDI device and play pitch bends or vibratos. The line chart
        below shows how far you bend up and down over time`,o=R(),a=A("div"),s=A("label"),l=z(`past seconds
            `),u=A("input"),c=R(),h=A("div"),f=R(),d=A("div"),m=A("button"),m.textContent="reset",b=R(),Te(g.$$.fragment),E=R(),Te(_.$$.fragment),P(i,"class","explanation"),P(u,"type","number"),P(u,"min","5"),P(u,"max","60"),P(u,"step","5"),P(a,"class","control"),P(h,"class","visualization"),P(m,"title","Clear all played notes"),P(d,"class","control"),P(t,"class","demo")},m(w,M){le(w,t,M),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(a,s),p(s,l),p(s,u),me(u,e[1]),p(t,c),p(t,h),e[7](h),p(t,f),p(t,d),p(d,m),p(d,b),Ne(g,d,null),p(d,E),Ne(_,d,null),y=!0,v||(x=[Q(u,"input",e[6]),Q(m,"click",e[8])],v=!0)},p(w,[M]){M&2&&xe(u.value)!==w[1]&&me(u,w[1])},i(w){y||(we(g.$$.fragment,w),we(_.$$.fragment,w),y=!0)},o(w){Se(g.$$.fragment,w),Se(_.$$.fragment,w),y=!1},d(w){w&&se(t),e[7](null),$e(g),$e(_),v=!1,qe(x)}}}let lO=1200,uO=700;function cO(e,t,n){let r,i=10,o=0,a=[];const s=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((g,E)=>{console.log(`MIDI device ${E}: ${g.name}`),g.addListener("pitchbend",l)}),[...O.inputs])},l=g=>{const E=(g.timestamp-o)/1e3,_={value:g.value,time:E};a.push(_),c()},u=()=>{const g=(performance.now()-o)/1e3,E=g-i,_=a.filter(v=>v.time>E),y=rt({width:lO,height:uO,marginLeft:80,marginBottom:50,padding:0,x:{domain:[E,g],label:"time in seconds"},y:{domain:[-1,1],label:"bend value"},marks:[Et([-1,-.5,0,.5,1],{stroke:"#ddd"}),Et([0]),O$(_,{x:"time",y:"value"})]});n(0,r.textContent="",r),r.appendChild(y)},c=m3(u,33),h=()=>{Yn("pitch-bend",{pastTime:i,firstTimeStamp:o,bendValues:a})},f=async g=>{if(a.length===0||confirm("Import data and overwrite currently unsaved data?")){const E=await Vn(g);n(1,i=E.pastTime),o=E.firstTimeStamp,n(2,a=E.bendValues),u()}};at(()=>{O.enable().then(s).catch(g=>alert(g)),o=performance.now(),u()}),ot(()=>{for(const g of O.inputs)g.removeListener()});function d(){i=xe(this.value),n(1,i)}function m(g){Ue[g?"unshift":"push"](()=>{r=g,n(0,r)})}return[r,i,a,u,h,f,d,m,()=>{confirm("Reset played notes?")&&(n(2,a=[]),u())}]}class fO extends Ve{constructor(t){super(),ze(this,t,cO,sO,He,{})}}function hO(e,t,n){const r=e.slice();return r[34]=t[n],r}function dO(e,t,n){const r=e.slice();return r[34]=t[n],r}function mO(e){let t;return{c(){t=A("option"),t.textContent=`${e[34]}`,t.__value=e[34],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function pO(e){let t;return{c(){t=A("option"),t.textContent=`${e[34]}`,t.__value=e[34],me(t,t.__value)},m(n,r){le(n,t,r)},p:pe,d(n){n&&se(t)}}}function bO(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v,x,w,M,C,S,N,$,T,L,D,I,V,W,U,Y,k,B,G,X,Z,ie,ee,j,J,F,ne,re,q,ce,H,ue,ae,he,de,ke,fe,We,Ie,qt,Oe,Xe,Br,ho;function Du(te){e[18](te)}let mo={label:"initial tempo",title:"Set a tempo at which you are able to input the exercise precisely (in BPM)",callback:e[14]};e[1]!==void 0&&(mo.tempo=e[1]),s=new ai({props:mo}),Ue.push(()=>jr(s,"tempo",Du));function Fu(te){e[19](te)}let po={label:"target tempo",title:"Set the tempo you want to be able to play the exercise at (in BPM)",callback:e[14]};e[2]!==void 0&&(po.tempo=e[2]),c=new ai({props:po}),Ue.push(()=>jr(c,"tempo",Fu));let Ru=Pe(["off","32nd","16th","8th"]),un=[];for(let te=0;te<4;te+=1)un[te]=mO(dO(e,Ru,te));let Bu=Pe(["quarter","eighth","quarter-triplets","swing"]),cn=[];for(let te=0;te<4;te+=1)cn[te]=pO(hO(e,Bu,te));return Ie=new zn({props:{exportFunction:e[16]}}),Oe=new Hn({props:{importFunction:e[17]}}),{c(){t=A("main"),n=A("h2"),n.textContent="Speed-Up Tab",r=R(),i=A("p"),i.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo. The notes you play are displayed in a guitar-tab-like
        visualization with crosses, numbers above notes indicate the fret. The
        darkness (white to black) encodes the notes' velocities, so eventual
        noise (unintended notes) is less distracting.`,o=R(),a=A("div"),Te(s.$$.fragment),u=R(),Te(c.$$.fragment),f=R(),d=A("label"),m=z(`tempo increase
            `),b=A("input"),g=R(),E=A("label"),_=z(`quantize exercise
            `),y=A("select");for(let te=0;te<4;te+=1)un[te].c();v=R(),x=A("div"),w=A("label"),M=z(`pre-defined exercise
            `),C=A("select");for(let te=0;te<4;te+=1)cn[te].c();S=R(),N=A("button"),$=z("input exercise"),L=R(),D=A("button"),I=z("save exercise"),W=R(),U=A("button"),Y=z("start practice"),B=R(),G=A("button"),X=z("stop practice"),ie=R(),ee=A("div"),j=z("current step: "),J=A("b"),F=z(e[5]),ne=z(" current tempo: "),re=A("b"),q=z(e[6]),ce=z(" BPM"),H=R(),ue=A("div"),ae=R(),he=A("div"),de=A("button"),ke=z("reset practice"),We=R(),Te(Ie.$$.fragment),qt=R(),Te(Oe.$$.fragment),P(i,"class","explanation"),P(b,"type","number"),P(b,"min","1"),P(b,"max","20"),P(b,"step","1"),P(d,"title","Set the tempo increase between practice runs (in BPM)"),e[4]===void 0&&_t(()=>e[21].call(y)),P(a,"class","control"),P(N,"title","Start recording the exercise."),N.disabled=T=e[5]==="input exercise"||e[5]==="practice",P(D,"title","Stop recording the exercise."),D.disabled=V=e[5]!=="input exercise",P(U,"title","Start recording the practice with speed-up."),U.disabled=k=e[8].length===0,P(G,"title","Stop recording the practice with speed-up."),G.disabled=Z=e[5]!=="practice",P(x,"class","control"),P(ue,"class","visualization"),P(de,"title","Clear practice but not exercise"),de.disabled=fe=e[5]!=="",P(he,"class","control"),P(t,"class","demo")},m(te,Ge){le(te,t,Ge),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),Ne(s,a,null),p(a,u),Ne(c,a,null),p(a,f),p(a,d),p(d,m),p(d,b),me(b,e[3]),p(a,g),p(a,E),p(E,_),p(E,y);for(let je=0;je<4;je+=1)un[je]&&un[je].m(y,null);Le(y,e[4],!0),p(t,v),p(t,x),p(x,w),p(w,M),p(w,C);for(let je=0;je<4;je+=1)cn[je]&&cn[je].m(C,null);p(x,S),p(x,N),p(N,$),p(x,L),p(x,D),p(D,I),p(x,W),p(x,U),p(U,Y),p(x,B),p(x,G),p(G,X),p(t,ie),p(t,ee),p(ee,j),p(ee,J),p(J,F),p(ee,ne),p(ee,re),p(re,q),p(ee,ce),p(t,H),p(t,ue),e[22](ue),p(t,ae),p(t,he),p(he,de),p(de,ke),p(he,We),Ne(Ie,he,null),p(he,qt),Ne(Oe,he,null),Xe=!0,Br||(ho=[Q(b,"input",e[20]),Q(y,"change",e[21]),Q(y,"change",e[14]),Q(C,"change",e[15]),Q(N,"click",e[10]),Q(D,"click",e[11]),Q(U,"click",e[12]),Q(G,"click",e[13]),Q(de,"click",e[23])],Br=!0)},p(te,Ge){const je={};!l&&Ge[0]&2&&(l=!0,je.tempo=te[1],Xr(()=>l=!1)),s.$set(je);const bo={};!h&&Ge[0]&4&&(h=!0,bo.tempo=te[2],Xr(()=>h=!1)),c.$set(bo),Ge[0]&8&&xe(b.value)!==te[3]&&me(b,te[3]),Ge[0]&16&&Le(y,te[4]),(!Xe||Ge[0]&32&&T!==(T=te[5]==="input exercise"||te[5]==="practice"))&&(N.disabled=T),(!Xe||Ge[0]&32&&V!==(V=te[5]!=="input exercise"))&&(D.disabled=V),(!Xe||Ge[0]&256&&k!==(k=te[8].length===0))&&(U.disabled=k),(!Xe||Ge[0]&32&&Z!==(Z=te[5]!=="practice"))&&(G.disabled=Z),(!Xe||Ge[0]&32)&&_e(F,te[5]),(!Xe||Ge[0]&64)&&_e(q,te[6]),(!Xe||Ge[0]&32&&fe!==(fe=te[5]!==""))&&(de.disabled=fe)},i(te){Xe||(we(s.$$.fragment,te),we(c.$$.fragment,te),we(Ie.$$.fragment,te),we(Oe.$$.fragment,te),Xe=!0)},o(te){Se(s.$$.fragment,te),Se(c.$$.fragment,te),Se(Ie.$$.fragment,te),Se(Oe.$$.fragment,te),Xe=!1},d(te){te&&se(t),$e(s),$e(c),Ze(un,te),Ze(cn,te),e[22](null),$e(Ie),$e(Oe),Br=!1,qe(ho)}}}let c1=1e3,f1=150,Cs=6;function gO(e,t,n){const r=e[0].time;return e.map(o=>{let a=o.time-r;if(t!=="off"){let l;t==="8th"&&(l=n/2),t==="16th"&&(l=n/4),t==="32nd"&&(l=n/8),a=Math.round(a/l)*l}const s=a/n;return{...o,time:s}})}function yO(e,t,n){let r,i=new wd,o=!0,a,s=60,l=120,u=10,c="off",h="",f=l,d=0,m=[],b,g=new Map,E=[64,59,55,50,45,40];const _=E.map(wn.fromMidiSharps),y=()=>{O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((k,B)=>{console.log(`MIDI device ${B}: ${k.name}`),k.addListener("noteon",v)}),[...O.inputs])},v=async k=>{const B=(k.timestamp-d)/1e3,G=k.message.channel-1,X={time:B,string:G,fret:k.note.number-E[G],velocity:k.velocity};if(h==="input exercise")n(8,m=[...m,X]);else if(h==="practice"){g.has(f)||g.set(f,[]);const Z=g.get(f);o&&Z.push(X)}N()},x=async()=>{const k=g.get(f);if(!k||!k.length)return;const B=Nt(k,ee=>ee.time),X=(performance.now()-d)/1e3-B;let Z=kt(f);X/Z>=b&&(console.log("increasing bpm"),i.stop(),f<=l?(n(6,f+=u),o=!1,await fy(1),i.start(f,4),g.has(f)&&g.set(f,[]),o=!0):S())},w=()=>{n(5,h="input exercise"),n(8,m=[]),n(9,g=new Map),i.start(s,4),N()},M=()=>{if(n(5,h=""),i.stop(),m.length>0){const k=tt(m,G=>G.time)-Nt(m,G=>G.time);let B=kt(s);b=Math.ceil(k/B)}},C=async()=>{if(m.length===0){alert("You need to input an exercise first");return}n(5,h="practice"),n(6,f=s),n(9,g=new Map),i.start(f,4),a=setInterval(x,100)},S=()=>{n(5,h=""),n(6,f=l),clearInterval(a),i.stop()},N=()=>{if(n(0,r.textContent="",r),m.length===0)return;let k=kt(s);const B=gO(m,c,k);let G=Math.ceil(tt(B,Z=>Z.time)/4*4)+.5;const X=rt({width:c1,height:f1,marginLeft:40,x:{label:"time in beats",domain:[0,G]},y:{domain:be(0,Cs),tickFormat:Z=>_[Z],tickSize:0},marks:[Pt(be(0,G,1),{stroke:"#ddd"}),Et(be(0,Cs),{stroke:"#ddd"}),Pt(be(0,G,4)),on(B,{symbol:"times",stroke:"#333",x:Z=>Z.time,y:Z=>Z.string,r:5})]});r.appendChild(X);for(const[Z,ie]of g){if(ie.length===0)continue;const ee=ie[0].time;k=kt(Z);const j=ie.map(F=>({...F,time:(F.time-ee)/k})),J=rt({width:c1,height:f1,marginLeft:40,x:{label:"time in beats",domain:[0,G]},y:{label:`${Z} BPM`,domain:be(0,Cs),tickFormat:F=>_[F],tickSize:0},color:{domain:[0,1],scheme:"Greys"},marks:[Pt(be(0,G,1),{stroke:"#ddd"}),Pt(be(0,G,4)),Et(be(0,Cs),{stroke:"#ddd"}),on(j,{symbol:"times",stroke:"velocity",x:F=>F.time,y:F=>F.string,r:4}),$r(j,{text:"fret",fill:"velocity",x:F=>F.time,y:F=>F.string,textAnchor:"middle",dy:-10})]});r.appendChild(J)}};at(()=>{O.enable().then(y).catch(k=>alert(k)),n(7,d=performance.now()),N()}),ot(()=>{for(const k of O.inputs)k.removeListener();clearInterval(a),i.stop()});const $=k=>{const B=k.target.value,G=new Map([["quarter",be(0,8,1)],["eighth",be(0,8,.5)],["quarter-triplets",be(0,8,1/3)],["swing",be(0,8,.5).map((ie,ee)=>ee%2===0?ee:ee+.2)]]),X=kt(s);n(4,c="off");const Z=G.get(B);n(8,m=Z.map(ie=>ie*X)),b=Math.ceil(tt(Z)+1),n(8,m=m.map(ie=>({time:ie,string:5,fret:5}))),N()},T=()=>{Yn("speed-up-tab",{initialTempo:s,targetTempo:l,tempoIncrease:u,quantize:c,currentStep:h,currentTempo:f,firstTimeStamp:d,exerciseNotes:m,exerciseBeatCount:b,practiceRecordings:g})},L=async k=>{if(m.length===0||confirm("Import data and overwrite currently unsaved data?")){const B=await Vn(k);n(1,s=B.initialTempo),n(2,l=B.targetTempo),n(3,u=B.tempoIncrease),n(4,c=B.quantize),n(5,h=B.currentStep),n(6,f=B.currentTempo),n(7,d=B.firstTimeStamp),n(8,m=B.exerciseNotes),b=B.exerciseBeatCount,n(9,g=B.practiceRecordings),N()}};function D(k){s=k,n(1,s)}function I(k){l=k,n(2,l)}function V(){u=xe(this.value),n(3,u)}function W(){c=Rt(this),n(4,c)}function U(k){Ue[k?"unshift":"push"](()=>{r=k,n(0,r)})}return[r,s,l,u,c,h,f,d,m,g,w,M,C,S,N,$,T,L,D,I,V,W,U,()=>{confirm("Reset practice?")&&(n(9,g=new Map),n(7,d=performance.now()),N())}]}class _O extends Ve{constructor(t){super(),ze(this,t,yO,bO,He,{},null,[-1,-1])}}function h1(e,t,n){const r=e.slice();return r[22]=t[n],r}function d1(e,t,n){const r=e.slice();return r[25]=t[n],r}function m1(e){let t,n=e[25]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[25],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function p1(e){let t,n=e[22]+"",r;return{c(){t=A("option"),r=z(n),t.__value=e[22],me(t,t.__value)},m(i,o){le(i,t,o),p(t,r)},p:pe,d(i){i&&se(t)}}}function vO(e){let t,n,r,i,o,a=e[1].length+"",s,l,u,c,h,f,d,m,b,g,E,_,y,v,x,w,M=(e[4]?ft:ht)+"",C,S,N,$,T=(e[5]?ft:ht)+"",L,D,I,V,W,U,Y,k,B,G,X,Z,ie,ee,j,J=Pe(e[8]),F=[];for(let H=0;H<J.length;H+=1)F[H]=m1(d1(e,J,H));let ne=Pe(e[9]),re=[];for(let H=0;H<ne.length;H+=1)re[H]=p1(h1(e,ne,H));function q(H){e[15](H)}let ce={callback:e[10]};return e[6]!==void 0&&(ce.tempo=e[6]),_=new ai({props:ce}),Ue.push(()=>jr(_,"tempo",q)),k=new zn({props:{exportFunction:e[11]}}),G=new Hn({props:{importFunction:e[12]}}),Z=new Md({props:{tempo:e[6],accent:4}}),{c(){t=A("main"),n=A("h2"),n.textContent="Improvisation Scale Degrees",r=R(),i=A("p"),o=z("Connect a MIDI instrument (currently "),s=z(a),l=z(` connected) and
        start playing. The bar chart below shows how often you played each scale
        degree.`),u=R(),c=A("div"),h=A("label"),f=z(`scale
            `),d=A("select");for(let H=0;H<F.length;H+=1)F[H].c();m=R(),b=A("select");for(let H=0;H<re.length;H+=1)re[H].c();g=R(),E=A("div"),Te(_.$$.fragment),v=R(),x=A("button"),w=z("colors "),C=z(M),S=R(),N=A("button"),$=z("non-scale notes "),L=z(T),D=R(),I=A("div"),V=R(),W=A("div"),U=A("button"),U.textContent="reset",Y=R(),Te(k.$$.fragment),B=R(),Te(G.$$.fragment),X=R(),Te(Z.$$.fragment),P(i,"class","explanation"),e[2]===void 0&&_t(()=>e[13].call(d)),e[3]===void 0&&_t(()=>e[14].call(b)),P(c,"class","control svelte-13613lz"),P(x,"title","Use colors for root, in-scale, outside-scale"),P(N,"title","Show notes outside the scale"),P(E,"class","control svelte-13613lz"),P(I,"class","visualization svelte-13613lz"),P(U,"title","Clear all played notes"),P(W,"class","control svelte-13613lz"),P(t,"class","demo")},m(H,ue){le(H,t,ue),p(t,n),p(t,r),p(t,i),p(i,o),p(i,s),p(i,l),p(t,u),p(t,c),p(c,h),p(h,f),p(h,d);for(let ae=0;ae<F.length;ae+=1)F[ae]&&F[ae].m(d,null);Le(d,e[2],!0),p(h,m),p(h,b);for(let ae=0;ae<re.length;ae+=1)re[ae]&&re[ae].m(b,null);Le(b,e[3],!0),p(t,g),p(t,E),Ne(_,E,null),p(E,v),p(E,x),p(x,w),p(x,C),p(E,S),p(E,N),p(N,$),p(N,L),p(t,D),p(t,I),e[18](I),p(t,V),p(t,W),p(W,U),p(W,Y),Ne(k,W,null),p(W,B),Ne(G,W,null),p(W,X),Ne(Z,W,null),ie=!0,ee||(j=[Q(d,"change",e[13]),Q(d,"change",e[10]),Q(b,"change",e[14]),Q(b,"change",e[10]),Q(x,"click",e[16]),Q(N,"click",e[17]),Q(U,"click",e[19])],ee=!0)},p(H,[ue]){if((!ie||ue&2)&&a!==(a=H[1].length+"")&&_e(s,a),ue&256){J=Pe(H[8]);let de;for(de=0;de<J.length;de+=1){const ke=d1(H,J,de);F[de]?F[de].p(ke,ue):(F[de]=m1(ke),F[de].c(),F[de].m(d,null))}for(;de<F.length;de+=1)F[de].d(1);F.length=J.length}if(ue&260&&Le(d,H[2]),ue&512){ne=Pe(H[9]);let de;for(de=0;de<ne.length;de+=1){const ke=h1(H,ne,de);re[de]?re[de].p(ke,ue):(re[de]=p1(ke),re[de].c(),re[de].m(b,null))}for(;de<re.length;de+=1)re[de].d(1);re.length=ne.length}ue&520&&Le(b,H[3]);const ae={};!y&&ue&64&&(y=!0,ae.tempo=H[6],Xr(()=>y=!1)),_.$set(ae),(!ie||ue&16)&&M!==(M=(H[4]?ft:ht)+"")&&_e(C,M),(!ie||ue&32)&&T!==(T=(H[5]?ft:ht)+"")&&_e(L,T);const he={};ue&64&&(he.tempo=H[6]),Z.$set(he)},i(H){ie||(we(_.$$.fragment,H),we(k.$$.fragment,H),we(G.$$.fragment,H),we(Z.$$.fragment,H),ie=!0)},o(H){Se(_.$$.fragment,H),Se(k.$$.fragment,H),Se(G.$$.fragment,H),Se(Z.$$.fragment,H),ie=!1},d(H){H&&se(t),Ze(F,H),Ze(re,H),$e(_),e[18](null),$e(k),$e(G),$e(Z),ee=!1,qe(j)}}}let wO=1e3,MO=650;function EO(e,t,n){let r,i=[],o="A",a="minor pentatonic",s=!0,l=!0,u=120,c=[];const h=md,f=la.names(),d=()=>{n(1,i=[]),O.inputs.length<1?console.warn("No MIDI device detected"):(O.inputs.forEach((S,N)=>{console.log(`MIDI device ${N}: ${S.name}`),S.addListener("noteon",m)}),n(1,i=[...O.inputs]))},m=S=>{let N=0;c.length>0&&(N=S.timestamp/1e3-c[0].time);const $={number:S.note.number,velocity:S.rawVelocity,time:N};c.push($),b()},b=()=>{if(c.length===0)return;const S=h.indexOf(o),N=la.get(`${o} ${a}`),$=N.notes.map((Y,k)=>{const B=h.indexOf(Y);let G=B-S;return G=G>=0?G:G+12,{name:Y,chroma:B,interval:N.intervals[k],degree:k,offset:G}}),T=new Set($.map(Y=>Y.offset)),L=kt(u)*4,D=Ko(c,Y=>Math.floor(Y.time/L));let I=[];for(const[Y,k]of D){const B=k.map(X=>{const ie=X.number%12-S;return ie>=0?ie:ie+12}),G=Ko(B,X=>X).map(([X,Z])=>({value:X,count:Z.length,barId:Y}));I=I.concat(G)}console.log(I);const W=Math.floor(c.at(-1).time/L)-9;console.log({minBar:W}),I=I.filter(Y=>Y.barId>=W);const U=rt({width:wO,height:MO,marginLeft:70,marginRight:10,color:{legend:s,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:Y=>h[(Y+S)%12],domain:l?be(0,12,1):[...T],reverse:!0,label:"notes, increasing semitones from root 🡺"},marks:[es(I,{x:"count",y:"value",fx:"barId",fill:Y=>s?Y.value===0?"#666":T.has(Y.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});n(0,r.textContent="",r),r.appendChild(U)},g=()=>{Yn("improvisation-scale-degrees-bar",{root:o,scale:a,useColors:s,showOutsideScale:l,notes:c,tempo:u})},E=async S=>{if(c.length===0||confirm("Import data and overwrite currently unsaved data?")){const N=await Vn(S);n(2,o=N.root),n(3,a=N.scale),n(4,s=N.useColors),n(5,l=N.showOutsideScale),n(7,c=N.notes),n(6,u=N.tempo),b()}};at(()=>{O.enable().then(d).catch(S=>alert(S)),b()}),ot(()=>{for(const S of O.inputs)S.removeListener()});function _(){o=Rt(this),n(2,o),n(8,h)}function y(){a=Rt(this),n(3,a),n(9,f)}function v(S){u=S,n(6,u)}const x=()=>{n(4,s=!s),b()},w=()=>{n(5,l=!l),b()};function M(S){Ue[S?"unshift":"push"](()=>{r=S,n(0,r)})}return[r,i,o,a,s,l,u,c,h,f,b,g,E,_,y,v,x,w,M,()=>{confirm("Reset played notes?")&&(n(7,c=[]),b())}]}class SO extends Ve{constructor(t){super(),ze(this,t,EO,vO,He,{})}}function b1(e,t,n){const r=e.slice();return r[19]=t[n],r}function g1(e,t,n){const r=e.slice();return r[22]=t[n],r}function y1(e,t,n){const r=e.slice();return r[22]=t[n],r}function xO(e){let t,n,r,i,o,a,s,l;const u=[NO,PO],c=[];function h(f,d){return f[0]==="tools"?0:1}return r=h(e),i=c[r]=u[r](e),{c(){t=A("button"),t.textContent="< back",n=R(),i.c(),o=th()},m(f,d){le(f,t,d),le(f,n,d),c[r].m(f,d),le(f,o,d),a=!0,s||(l=Q(t,"click",e[17]),s=!0)},p(f,d){let m=r;r=h(f),r===m?c[r].p(f,d):(Aa(),Se(c[m],1,1,()=>{c[m]=null}),Ca(),i=c[r],i?i.p(f,d):(i=c[r]=u[r](f),i.c()),we(i,1),i.m(o.parentNode,o))},i(f){a||(we(i),a=!0)},o(f){Se(i),a=!1},d(f){f&&(se(t),se(n),se(o)),c[r].d(f),s=!1,l()}}}function AO(e){let t,n,r,i,o,a,s,l,u,c,h,f,d,m,b,g,E,_,y,v=Pe(e[5].values()),x=[];for(let N=0;N<v.length;N+=1)x[N]=_1(y1(e,v,N));let w=Pe(e[6].values()),M=[];for(let N=0;N<w.length;N+=1)M[N]=v1(g1(e,w,N));let C=Pe(e[4]),S=[];for(let N=0;N<C.length;N+=1)S[N]=M1(b1(e,C,N));return{c(){t=A("p"),t.textContent=`This page contains a collection of small tools (demos) that are each
      tailored to a specific musical skill and sometimes also specific kind of
      musical data. You can filter demos with the bottuns below. Click a button
      to toggle it, double click it to turn it on and all others of the same
      kind off. A demo will only be shown if it supports at least one of the
      active attributes.`,n=R(),r=A("div"),i=z(`task
      `),o=A("button"),o.textContent="all",a=R();for(let N=0;N<x.length;N+=1)x[N].c();s=R(),l=A("div"),u=z(`instrument
      `),c=A("button"),c.textContent="all",h=R();for(let N=0;N<M.length;N+=1)M[N].c();f=R(),d=A("div");for(let N=0;N<S.length;N+=1)S[N].c();m=R(),b=A("button"),b.textContent="tools",g=R(),E=A("button"),E.textContent="export usage",P(t,"class","explanation"),P(d,"class","grid")},m(N,$){le(N,t,$),le(N,n,$),le(N,r,$),p(r,i),p(r,o),p(r,a);for(let T=0;T<x.length;T+=1)x[T]&&x[T].m(r,null);le(N,s,$),le(N,l,$),p(l,u),p(l,c),p(l,h);for(let T=0;T<M.length;T+=1)M[T]&&M[T].m(l,null);le(N,f,$),le(N,d,$);for(let T=0;T<S.length;T+=1)S[T]&&S[T].m(d,null);le(N,m,$),le(N,b,$),le(N,g,$),le(N,E,$),_||(y=[Q(o,"click",e[8]),Q(c,"click",e[11]),Q(b,"click",e[15]),Q(E,"click",e[16])],_=!0)},p(N,$){if($&40){v=Pe(N[5].values());let T;for(T=0;T<v.length;T+=1){const L=y1(N,v,T);x[T]?x[T].p(L,$):(x[T]=_1(L),x[T].c(),x[T].m(r,null))}for(;T<x.length;T+=1)x[T].d(1);x.length=v.length}if($&68){w=Pe(N[6].values());let T;for(T=0;T<w.length;T+=1){const L=g1(N,w,T);M[T]?M[T].p(L,$):(M[T]=v1(L),M[T].c(),M[T].m(l,null))}for(;T<M.length;T+=1)M[T].d(1);M.length=w.length}if($&29){C=Pe(N[4]);let T;for(T=0;T<C.length;T+=1){const L=b1(N,C,T);S[T]?S[T].p(L,$):(S[T]=M1(L),S[T].c(),S[T].m(d,null))}for(;T<S.length;T+=1)S[T].d(1);S.length=C.length}},i:pe,o:pe,d(N){N&&(se(t),se(n),se(r),se(s),se(l),se(f),se(d),se(m),se(b),se(g),se(E)),Ze(x,N),Ze(M,N),Ze(S,N),_=!1,qe(y)}}}function CO(e){let t,n,r;return{c(){t=A("input"),P(t,"type","password"),P(t,"placeholder","password")},m(i,o){le(i,t,o),me(t,e[1]),n||(r=Q(t,"input",e[7]),n=!0)},p(i,o){o&2&&t.value!==i[1]&&me(t,i[1])},i:pe,o:pe,d(i){i&&se(t),n=!1,r()}}}function PO(e){let t,n,r;var i=e[0].component;function o(a,s){return{}}return i&&(t=Hs(i,o())),{c(){t&&Te(t.$$.fragment),n=th()},m(a,s){t&&Ne(t,a,s),le(a,n,s),r=!0},p(a,s){if(s&1&&i!==(i=a[0].component)){if(t){Aa();const l=t;Se(l.$$.fragment,1,0,()=>{$e(l,1)}),Ca()}i?(t=Hs(i,o()),Te(t.$$.fragment),we(t.$$.fragment,1),Ne(t,n.parentNode,n)):t=null}},i(a){r||(t&&we(t.$$.fragment,a),r=!0)},o(a){t&&Se(t.$$.fragment,a),r=!1},d(a){a&&se(n),t&&$e(t,a)}}}function NO(e){let t,n;return t=new rF({}),{c(){Te(t.$$.fragment)},m(r,i){Ne(t,r,i),n=!0},p:pe,i(r){n||(we(t.$$.fragment,r),n=!0)},o(r){Se(t.$$.fragment,r),n=!1},d(r){$e(t,r)}}}function _1(e){let t,n=e[22]+"",r,i,o,a,s;function l(){return e[9](e[22])}function u(){return e[10](e[22])}return{c(){t=A("button"),r=z(n),i=R(),P(t,"class",o=qs(e[3].has(e[22])?"active":"hidden")+" svelte-1auehli")},m(c,h){le(c,t,h),p(t,r),p(t,i),a||(s=[Q(t,"click",l),Q(t,"dblclick",u)],a=!0)},p(c,h){e=c,h&8&&o!==(o=qs(e[3].has(e[22])?"active":"hidden")+" svelte-1auehli")&&P(t,"class",o)},d(c){c&&se(t),a=!1,qe(s)}}}function v1(e){let t,n=e[22]+"",r,i,o,a,s;function l(){return e[12](e[22])}function u(){return e[13](e[22])}return{c(){t=A("button"),r=z(n),i=R(),P(t,"class",o=qs(e[2].has(e[22])?"active":"hidden")+" svelte-1auehli")},m(c,h){le(c,t,h),p(t,r),p(t,i),a||(s=[Q(t,"click",l),Q(t,"dblclick",u)],a=!0)},p(c,h){e=c,h&4&&o!==(o=qs(e[2].has(e[22])?"active":"hidden")+" svelte-1auehli")&&P(t,"class",o)},d(c){c&&se(t),a=!1,qe(s)}}}function w1(e){let t,n,r,i,o,a,s,l,u,c,h;function f(){return e[14](e[19])}return{c(){t=A("div"),n=A("h2"),n.textContent=`${e[19].title}`,r=R(),i=A("div"),i.textContent=`${e[19].description}`,o=R(),a=A("div"),a.textContent=`instrument:
              ${e[19].instruments.includes("guitar/bass")?"🎸":""} ${e[19].instruments.includes("drum")?"🥁":""} ${e[19].instruments.includes("keyboard")?"🎹":""} ${e[19].instruments.includes("wind")?"🪈":""} ${e[19].instruments.includes("singing")?"🎤":""} ${e[19].instruments.includes("strings")?"🎻":""}`,s=R(),l=A("div"),l.textContent=`task:
              ${e[19].task==="dynamics"?"🔊":""} ${e[19].task==="timing"?"🕐":""} ${e[19].task==="pitch"?"🎶":""} ${e[19].task==="chords"?"⋮":""}`,u=R(),P(i,"class","description"),P(a,"class","tags svelte-1auehli"),P(l,"class","tags svelte-1auehli"),P(t,"class","card svelte-1auehli")},m(d,m){le(d,t,m),p(t,n),p(t,r),p(t,i),p(t,o),p(t,a),p(t,s),p(t,l),p(t,u),c||(h=Q(t,"click",f),c=!0)},p(d,m){e=d},d(d){d&&se(t),c=!1,h()}}}function M1(e){let t=e[3].has(e[19].task)&&ep(e[2],e[19].instruments),n,r=t&&w1(e);return{c(){r&&r.c(),n=th()},m(i,o){r&&r.m(i,o),le(i,n,o)},p(i,o){o&12&&(t=i[3].has(i[19].task)&&ep(i[2],i[19].instruments)),t?r?r.p(i,o):(r=w1(i),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(i){i&&se(n),r&&r.d(i)}}}function $O(e){let t,n,r,i,o,a;const s=[CO,AO,xO],l=[];function u(c,h){return c[1]!==TO?0:c[0]?2:1}return i=u(e),o=l[i]=s[i](e),{c(){t=A("main"),n=A("h1"),n.textContent="Data-Driven Music Education Demos",r=R(),o.c()},m(c,h){le(c,t,h),p(t,n),p(t,r),l[i].m(t,null),a=!0},p(c,[h]){let f=i;i=u(c),i===f?l[i].p(c,h):(Aa(),Se(l[f],1,1,()=>{l[f]=null}),Ca(),o=l[i],o?o.p(c,h):(o=l[i]=s[i](c),o.c()),we(o,1),o.m(t,null))},i(c){a||(we(o),a=!0)},o(c){Se(o),a=!1},d(c){c&&se(t),l[i].d()}}}let TO="rhyvis";function kO(e,t,n){const r=[{id:"sub-division",title:"Sub-Division",description:"Learn rhythmic playing in different sub-divisions.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:AF},{id:"tempo-drift",title:"Tempo Drift",description:"Keep your tempo constant over a longer stretch of playing.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:FF},{id:"dynamics",title:"Dynamics",description:"Check how well you control the loudness of notes.",tags:["task:dynamics","input:MIDI","encoding:bars"],task:"dynamics",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:GF},{id:"improvisation-intervals",title:"Improvisation Intervals",description:"See how often you use different intervals in improvisation.",task:"pitch",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:VF},{id:"improvisation-scale-degrees",title:"Improvisation Scale Degrees",description:"See how often you use different scale degrees in improvisation.",task:"pitch",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:KF},{id:"improvisation-scale-degrees-bar",title:"[new] Improvisation Scale Degrees (per Bar)",description:"See how often you use different scale degrees in improvisation. This version shows the distribution of notes for each played bar.",task:"pitch",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:SO},{id:"keyboard-histogram",title:"Keyboard Histogram",description:"See how often you play different keyboard keys.",task:"pitch",input:"MIDI",instruments:["keyboard"],component:uR},{id:"fretboard-heatmap",title:"Fretboard Heatmap",description:"See how often you play different fretboard positions.",task:"pitch",input:"MIDI",instruments:["guitar/bass"],component:eR},{id:"fretboard-improvisation-intervals",title:"Fretboard Improvisation Intervals",description:"Once you play a note, see where on the fretboard you can reach different intervals to the last played note.",task:"pitch",input:"MIDI",instruments:["guitar/bass"],component:dR},{id:"chord-arpeggio-timing",title:"Chord and Arpeggio Timing",description:"See how spaced out the notes in a chord or arpeggio are, and how much time lies between these.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:iR},{id:"speed-up",title:"Speed-Up",description:"Record a short exercise at a slow tempo, then practice it with steadily increasing tempo.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:MR},{id:"speed-up-tab",title:" [new] Speed-Up Tab",description:"Record a short guitar exercise at a slow tempo, then practice it with steadily increasing tempo.",task:"timing",input:"MIDI",instruments:["guitar/bass"],component:_O},{id:"rhythm-sheet-music",title:"Rhythm Sheet Music",description:"This demo displays the notes you play as staff notation (𝅝, 𝅗𝅥, 𝅘𝅥, 𝅘𝅥𝅮, 𝅘𝅥𝅯) and offset in percent.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:xR},{id:"chord-diagrams",title:"[changed] Chord Diagrams",description:"See what chords you play on a guitar/bass as chord diagrams.",task:"chords",input:"MIDI",instruments:["guitar/bass"],component:NR},{id:"pitch-bend",title:"[new] Pitch Bend",description:"Practice different kinds of pitch bends.",task:"pitch",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:fO}];let i=null;const o=G3(window,"d");o&&o!==""&&(i=r.filter(w=>w.id===o)[0]);let a=localStorage.getItem("pwd")??"";window.onpopstate=w=>{i!==null&&n(0,i=null)};const s=new Set(r.flatMap(w=>w.task).sort()),l=new Set(r.flatMap(w=>w.instruments).sort());let u=new Set(s),c=new Set(l);function h(){a=this.value,n(1,a)}const f=()=>{n(3,u=new Set(s))},d=w=>n(3,u=Jm(u,w)),m=w=>n(3,u=new Set([w])),b=()=>{n(2,c=new Set(l))},g=w=>n(2,c=Jm(c,w)),E=w=>n(2,c=new Set([w])),_=w=>{n(0,i=w),Lu(window,"d",w.id)},y=()=>{n(0,i="tools"),Lu(window,"d","tools")},v=()=>{const w=localStorage.getItem("usage"),M=new Blob([w],{type:"text/plain;charset=utf-8"});dy(M,"usage.json")},x=()=>{n(0,i=null),Lu(window,"d","")};return e.$$.update=()=>{if(e.$$.dirty&2&&localStorage.setItem("pwd",a),e.$$.dirty&1&&i&&i!=="tools"){let w;localStorage.getItem("usage")!==null?(w=localStorage.getItem("usage"),w=JSON.parse(w)):w={demoClicks:{}};const M=w.demoClicks,C=M[i.id]??[];C.push(new Date().toUTCString()),M[i.id]=C,localStorage.setItem("usage",JSON.stringify(w))}e.$$.dirty&4&&console.log(c)},[i,a,c,u,r,s,l,h,f,d,m,b,g,E,_,y,v,x]}class IO extends Ve{constructor(t){super(),ze(this,t,kO,$O,He,{})}}new IO({target:document.getElementById("app")});
