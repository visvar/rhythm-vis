var I_=Object.defineProperty;var D_=(e,t,n)=>t in e?I_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var mo=(e,t,n)=>(D_(e,typeof t!="symbol"?t+"":t,n),n),ch=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var Ne=(e,t,n)=>(ch(e,t,"read from private field"),n?n.call(e):t.get(e)),yt=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Gt=(e,t,n,r)=>(ch(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);var uh=(e,t,n,r)=>({set _(i){Gt(e,t,i,n)},get _(){return Ne(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function se(){}function P1(e){return e()}function fh(){return Object.create(null)}function Fe(e){e.forEach(P1)}function N1(e){return typeof e=="function"}function Ue(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function R_(e){return Object.keys(e).length===0}function Yo(e){return e??""}function b(e,t){e.appendChild(t)}function oe(e,t,n){e.insertBefore(t,n||null)}function ae(e){e.parentNode&&e.parentNode.removeChild(e)}function tt(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function P(e){return document.createElement(e)}function K(e){return document.createTextNode(e)}function L(){return K(" ")}function Gu(){return K("")}function X(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function N(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function _e(e){return e===""?null:+e}function L_(e){return Array.from(e.childNodes)}function Se(e,t){t=""+t,e.data!==t&&(e.data=t)}function ce(e,t){e.value=t??""}function _t(e,t,n,r){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function Le(e,t,n){for(let r=0;r<e.options.length;r+=1){const i=e.options[r];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Yt(e){const t=e.querySelector(":checked");return t&&t.__value}function Wo(e,t){return new e(t)}let ca;function ea(e){ca=e}function C1(){if(!ca)throw new Error("Function called outside component initialization");return ca}function st(e){C1().$$.on_mount.push(e)}function lt(e){C1().$$.on_destroy.push(e)}const Hr=[],ot=[];let Xr=[];const hh=[],B_=Promise.resolve();let Cc=!1;function O_(){Cc||(Cc=!0,B_.then(T1))}function bt(e){Xr.push(e)}const Dl=new Set;let Fr=0;function T1(){if(Fr!==0)return;const e=ca;do{try{for(;Fr<Hr.length;){const t=Hr[Fr];Fr++,ea(t),F_(t.$$)}}catch(t){throw Hr.length=0,Fr=0,t}for(ea(null),Hr.length=0,Fr=0;ot.length;)ot.pop()();for(let t=0;t<Xr.length;t+=1){const n=Xr[t];Dl.has(n)||(Dl.add(n),n())}Xr.length=0}while(Hr.length);for(;hh.length;)hh.pop()();Cc=!1,Dl.clear(),ea(e)}function F_(e){if(e.fragment!==null){e.update(),Fe(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(bt)}}function G_(e){const t=[],n=[];Xr.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Xr=t}const Ro=new Set;let mr;function Ba(){mr={r:0,c:[],p:mr}}function Oa(){mr.r||Fe(mr.c),mr=mr.p}function It(e,t){e&&e.i&&(Ro.delete(e),e.i(t))}function Wt(e,t,n,r){if(e&&e.o){if(Ro.has(e))return;Ro.add(e),mr.c.push(()=>{Ro.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Te(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function ua(e){e&&e.c()}function ii(e,t,n){const{fragment:r,after_update:i}=e.$$;r&&r.m(t,n),bt(()=>{const a=e.$$.on_mount.map(P1).filter(N1);e.$$.on_destroy?e.$$.on_destroy.push(...a):Fe(a),e.$$.on_mount=[]}),i.forEach(bt)}function ai(e,t){const n=e.$$;n.fragment!==null&&(G_(n.after_update),Fe(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function U_(e,t){e.$$.dirty[0]===-1&&(Hr.push(e),O_(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function qe(e,t,n,r,i,a,o=null,s=[-1]){const l=ca;ea(e);const c=e.$$={fragment:null,ctx:[],props:a,update:se,not_equal:i,bound:fh(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:fh(),dirty:s,skip_bound:!1,root:t.target||l.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(e,t.props||{},(d,f,...h)=>{const m=h.length?h[0]:f;return c.ctx&&i(c.ctx[d],c.ctx[d]=m)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](m),u&&U_(e,d)),f}):[],c.update(),u=!0,Fe(c.before_update),c.fragment=r?r(c.ctx):!1,t.target){if(t.hydrate){const d=L_(t.target);c.fragment&&c.fragment.l(d),d.forEach(ae)}else c.fragment&&c.fragment.c();t.intro&&It(e.$$.fragment),ii(e,t.target,t.anchor),T1()}ea(l)}class He{constructor(){mo(this,"$$");mo(this,"$$set")}$destroy(){ai(this,1),this.$destroy=se}$on(t,n){if(!N1(n))return se;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!R_(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const q_="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(q_);function Rl(e,t,n){const r=new URLSearchParams(e.location.search);r.set(t,n);const i=`${e.location.protocol}//${e.location.host}${e.location.pathname}?${r.toString()}`;e.history.pushState({path:i},"",i)}function H_(e,t){return new URLSearchParams(e.location.search).get(t)}function pt(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Fa(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Us(e){let t,n,r;e.length!==2?(t=pt,n=(s,l)=>pt(e(s),l),r=(s,l)=>e(s)-l):(t=e===pt||e===Fa?e:z_,n=e,r=e);function i(s,l,c=0,u=s.length){if(c<u){if(t(l,l)!==0)return u;do{const d=c+u>>>1;n(s[d],l)<0?c=d+1:u=d}while(c<u)}return c}function a(s,l,c=0,u=s.length){if(c<u){if(t(l,l)!==0)return u;do{const d=c+u>>>1;n(s[d],l)<=0?c=d+1:u=d}while(c<u)}return c}function o(s,l,c=0,u=s.length){const d=i(s,l,c,u-1);return d>c&&r(s[d-1],l)>-r(s[d],l)?d-1:d}return{left:i,center:o,right:a}}function z_(){return 0}function $1(e){return e===null?NaN:+e}function*V_(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const j_=Us(pt),qs=j_.right;Us($1).center;function Y_(e,t){let n=0;for(let r of e)r!=null&&(r=+r)>=r&&++n;return n}function W_(e){return e.length|0}function X_(e){return!(e>0)}function K_(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function Z_(e){return t=>e(...t)}function J_(...e){const t=typeof e[e.length-1]=="function"&&Z_(e.pop());e=e.map(K_);const n=e.map(W_),r=e.length-1,i=new Array(r+1).fill(0),a=[];if(r<0||n.some(X_))return a;for(;;){a.push(i.map((s,l)=>e[l][s]));let o=r;for(;++i[o]===n[o];){if(o===0)return t?a.map(t):a;i[o--]=0}}}function Q_(e,t){var n=0;return Float64Array.from(e,r=>n+=+r||0)}function k1(e,t){let n=0,r,i=0,a=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,a+=r*(s-i))}if(n>1)return a/(n-1)}function ew(e,t){const n=k1(e,t);return n&&Math.sqrt(n)}function ht(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(n===void 0?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}class vr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=t+a,s=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);s&&(n[r++]=s),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}class Mr extends Map{constructor(t,n=R1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Tc(this,t))}has(t){return super.has(Tc(this,t))}set(t,n){return super.set(I1(this,t),n)}delete(t){return super.delete(D1(this,t))}}class Hs extends Set{constructor(t,n=R1){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Tc(this,t))}add(t){return super.add(I1(this,t))}delete(t){return super.delete(D1(this,t))}}function Tc({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function I1({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function D1({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function R1(e){return e!==null&&typeof e=="object"?e.valueOf():e}function fa(e){return e}function Uu(e,...t){return zs(e,fa,fa,t)}function qu(e,...t){return zs(e,Array.from,fa,t)}function Kr(e,t,...n){return zs(e,fa,t,n)}function tw(e,t,...n){return zs(e,Array.from,t,n)}function zs(e,t,n,r){return function i(a,o){if(o>=r.length)return n(a);const s=new Mr,l=r[o++];let c=-1;for(const u of a){const d=l(u,++c,a),f=s.get(d);f?f.push(u):s.set(d,[u])}for(const[u,d]of s)s.set(u,i(d,o));return t(s)}(e,0)}function nw(e,t){return Array.from(t,n=>e[n])}function Xo(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,a)=>a);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,a)=>{for(const o of t){const s=Ko(o[i],o[a]);if(s)return s}})):(n=e.map(n),r.sort((i,a)=>Ko(n[i],n[a]))),nw(e,r)}return e.sort(L1(n))}function L1(e=pt){if(e===pt)return Ko;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function Ko(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Hu(e,t,n){return(t.length!==2?Xo(Kr(e,t,n),([r,i],[a,o])=>pt(i,o)||pt(r,a)):Xo(Uu(e,n),([r,i],[a,o])=>t(i,o)||pt(r,a))).map(([r])=>r)}var rw=Array.prototype,iw=rw.slice;function Ll(e){return()=>e}const aw=Math.sqrt(50),ow=Math.sqrt(10),sw=Math.sqrt(2);function Zo(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=aw?10:a>=ow?5:a>=sw?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?Zo(e,t,n*2):[s,l,c]}function ha(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,a,o]=r?Zo(t,e,n):Zo(e,t,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let c=0;c<s;++c)l[c]=(a-c)/-o;else for(let c=0;c<s;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(i+c)/-o;else for(let c=0;c<s;++c)l[c]=(i+c)*o;return l}function oi(e,t,n){return t=+t,e=+e,n=+n,Zo(e,t,n)[2]}function $c(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?oi(t,e,n):oi(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function lw(e,t,n){let r;for(;;){const i=oi(e,t,n);if(i===r||i===0||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function cw(e){return Math.max(1,Math.ceil(Math.log(Y_(e))/Math.LN2)+1)}function uw(){var e=fa,t=ht,n=cw;function r(i){Array.isArray(i)||(i=Array.from(i));var a,o=i.length,s,l,c=new Array(o);for(a=0;a<o;++a)c[a]=e(i[a],a,i);var u=t(c),d=u[0],f=u[1],h=n(c,d,f);if(!Array.isArray(h)){const E=f,v=+h;if(t===ht&&([d,f]=lw(d,f,v)),h=ha(d,f,v),h[0]<=d&&(l=oi(d,f,v)),h[h.length-1]>=f)if(E>=f&&t===ht){const x=oi(d,f,v);isFinite(x)&&(x>0?f=(Math.floor(f/x)+1)*x:x<0&&(f=(Math.ceil(f*-x)+1)/-x))}else h.pop()}for(var m=h.length,p=0,_=m;h[p]<=d;)++p;for(;h[_-1]>f;)--_;(p||_<m)&&(h=h.slice(p,_),m=_-p);var w=new Array(m+1),g;for(a=0;a<=m;++a)g=w[a]=[],g.x0=a>0?h[a-1]:d,g.x1=a<m?h[a]:f;if(isFinite(l)){if(l>0)for(a=0;a<o;++a)(s=c[a])!=null&&d<=s&&s<=f&&w[Math.min(m,Math.floor((s-d)/l))].push(i[a]);else if(l<0){for(a=0;a<o;++a)if((s=c[a])!=null&&d<=s&&s<=f){const E=Math.floor((d-s)*l);w[Math.min(m,E+(h[E]<=s))].push(i[a])}}}else for(a=0;a<o;++a)(s=c[a])!=null&&d<=s&&s<=f&&w[qs(h,s,0,m)].push(i[a]);return w}return r.value=function(i){return arguments.length?(e=typeof i=="function"?i:Ll(i),r):e},r.domain=function(i){return arguments.length?(t=typeof i=="function"?i:Ll([i[0],i[1]]),r):t},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:Ll(Array.isArray(i)?iw.call(i):i),r):n},r}function Ge(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function fw(e,t){let n,r=-1,i=-1;if(t===void 0)for(const a of e)++i,a!=null&&(n<a||n===void 0&&a>=a)&&(n=a,r=i);else for(let a of e)(a=t(a,++i,e))!=null&&(n<a||n===void 0&&a>=a)&&(n=a,r=i);return r}function Xt(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function B1(e,t){let n,r=-1,i=-1;if(t===void 0)for(const a of e)++i,a!=null&&(n>a||n===void 0&&a>=a)&&(n=a,r=i);else for(let a of e)(a=t(a,++i,e))!=null&&(n>a||n===void 0&&a>=a)&&(n=a,r=i);return r}function O1(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?Ko:L1(i);r>n;){if(r-n>600){const l=r-n+1,c=t-n+1,u=Math.log(l),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),h=Math.max(n,Math.floor(t-c*d/l+f)),m=Math.min(r,Math.floor(t+(l-c)*d/l+f));O1(e,t,h,m,i)}const a=e[t];let o=n,s=r;for(ki(e,n,t),i(e[r],a)>0&&ki(e,n,r);o<s;){for(ki(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?ki(e,n,s):(++s,ki(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function ki(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function F1(e,t=pt){let n,r=!1;if(t.length===1){let i;for(const a of e){const o=t(a);(r?pt(o,i)>0:pt(o,o)===0)&&(n=a,i=o,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function Jo(e,t,n){if(e=Float64Array.from(V_(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return Xt(e);if(t>=1)return Ge(e);var r,i=(r-1)*t,a=Math.floor(i),o=Ge(O1(e,a).subarray(0,a+1)),s=Xt(e.subarray(a+1));return o+(s-o)*(i-a)}}function hw(e,t,n=$1){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function G1(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function kc(e,t){return Jo(e,.5,t)}function*dw(e){for(const t of e)yield*t}function U1(e){return Array.from(dw(e))}function mw(e,t){const n=new Mr;if(t===void 0)for(let a of e)a!=null&&a>=a&&n.set(a,(n.get(a)||0)+1);else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&o>=o&&n.set(o,(n.get(o)||0)+1)}let r,i=0;for(const[a,o]of n)o>i&&(i=o,r=a);return r}function pw(e,t=bw){const n=[];let r,i=!1;for(const a of e)i&&n.push(t(r,a)),r=a,i=!0;return n}function bw(e,t){return[e,t]}function we(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function Qn(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Qo(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function gw(e){return e}var yw=3,dh=1e-6;function _w(e){return"translate("+e+",0)"}function ww(e){return t=>+e(t)}function vw(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function Mw(){return!this.__axis}function xw(e,t){var n=[],r=null,i=null,a=6,o=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=1,u="y",d=_w;function f(h){var m=r??(t.ticks?t.ticks.apply(t,n):t.domain()),p=i??(t.tickFormat?t.tickFormat.apply(t,n):gw),_=Math.max(a,0)+s,w=t.range(),g=+w[0]+l,E=+w[w.length-1]+l,v=(t.bandwidth?vw:ww)(t.copy(),l),x=h.selection?h.selection():h,y=x.selectAll(".domain").data([null]),M=x.selectAll(".tick").data(m,t).order(),A=M.exit(),S=M.enter().append("g").attr("class","tick"),$=M.select("line"),C=M.select("text");y=y.merge(y.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(S),$=$.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",c*a)),C=C.merge(S.append("text").attr("fill","currentColor").attr(u,c*_).attr("dy","0.71em")),h!==x&&(y=y.transition(h),M=M.transition(h),$=$.transition(h),C=C.transition(h),A=A.transition(h).attr("opacity",dh).attr("transform",function(k){return isFinite(k=v(k))?d(k+l):this.getAttribute("transform")}),S.attr("opacity",dh).attr("transform",function(k){var B=this.parentNode.__axis;return d((B&&isFinite(B=B(k))?B:v(k))+l)})),A.remove(),y.attr("d",o?"M"+g+","+c*o+"V"+l+"H"+E+"V"+c*o:"M"+g+","+l+"H"+E),M.attr("opacity",1).attr("transform",function(k){return d(v(k)+l)}),$.attr(u+"2",c*a),C.attr(u,c*_).text(p),x.filter(Mw).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),x.each(function(){this.__axis=v})}return f.scale=function(h){return arguments.length?(t=h,f):t},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(a=o=+h,f):a},f.tickSizeInner=function(h){return arguments.length?(a=+h,f):a},f.tickSizeOuter=function(h){return arguments.length?(o=+h,f):o},f.tickPadding=function(h){return arguments.length?(s=+h,f):s},f.offset=function(h){return arguments.length?(l=+h,f):l},f}function Ew(e){return xw(yw,e)}var Sw={value:()=>{}};function q1(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Lo(n)}function Lo(e){this._=e}function Aw(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Lo.prototype=q1.prototype={constructor:Lo,on:function(e,t){var n=this._,r=Aw(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=Pw(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=mh(n[i],e.name,t);else if(t==null)for(i in n)n[i]=mh(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Lo(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Pw(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function mh(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Sw,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ic="http://www.w3.org/1999/xhtml";const si={svg:"http://www.w3.org/2000/svg",xhtml:Ic,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vs(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),si.hasOwnProperty(t)?{space:si[t],local:e}:e}function Nw(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ic&&t.documentElement.namespaceURI===Ic?t.createElement(e):t.createElementNS(n,e)}}function Cw(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function js(e){var t=Vs(e);return(t.local?Cw:Nw)(t)}function Tw(){}function zu(e){return e==null?Tw:function(){return this.querySelector(e)}}function $w(e){typeof e!="function"&&(e=zu(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),l,c,u=0;u<o;++u)(l=a[u])&&(c=e.call(l,l.__data__,u,a))&&("__data__"in l&&(c.__data__=l.__data__),s[u]=c);return new vt(r,this._parents)}function kw(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Iw(){return[]}function H1(e){return e==null?Iw:function(){return this.querySelectorAll(e)}}function Dw(e){return function(){return kw(e.apply(this,arguments))}}function Rw(e){typeof e=="function"?e=Dw(e):e=H1(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,l,c=0;c<s;++c)(l=o[c])&&(r.push(e.call(l,l.__data__,c,o)),i.push(l));return new vt(r,i)}function z1(e){return function(){return this.matches(e)}}function V1(e){return function(t){return t.matches(e)}}var Lw=Array.prototype.find;function Bw(e){return function(){return Lw.call(this.children,e)}}function Ow(){return this.firstElementChild}function Fw(e){return this.select(e==null?Ow:Bw(typeof e=="function"?e:V1(e)))}var Gw=Array.prototype.filter;function Uw(){return Array.from(this.children)}function qw(e){return function(){return Gw.call(this.children,e)}}function Hw(e){return this.selectAll(e==null?Uw:qw(typeof e=="function"?e:V1(e)))}function zw(e){typeof e!="function"&&(e=z1(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],l,c=0;c<o;++c)(l=a[c])&&e.call(l,l.__data__,c,a)&&s.push(l);return new vt(r,this._parents)}function j1(e){return new Array(e.length)}function Vw(){return new vt(this._enter||this._groups.map(j1),this._parents)}function es(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}es.prototype={constructor:es,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function jw(e){return function(){return e}}function Yw(e,t,n,r,i,a){for(var o=0,s,l=t.length,c=a.length;o<c;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new es(e,a[o]);for(;o<l;++o)(s=t[o])&&(i[o]=s)}function Ww(e,t,n,r,i,a,o){var s,l,c=new Map,u=t.length,d=a.length,f=new Array(u),h;for(s=0;s<u;++s)(l=t[s])&&(f[s]=h=o.call(l,l.__data__,s,t)+"",c.has(h)?i[s]=l:c.set(h,l));for(s=0;s<d;++s)h=o.call(e,a[s],s,a)+"",(l=c.get(h))?(r[s]=l,l.__data__=a[s],c.delete(h)):n[s]=new es(e,a[s]);for(s=0;s<u;++s)(l=t[s])&&c.get(f[s])===l&&(i[s]=l)}function Xw(e){return e.__data__}function Kw(e,t){if(!arguments.length)return Array.from(this,Xw);var n=t?Ww:Yw,r=this._parents,i=this._groups;typeof e!="function"&&(e=jw(e));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),c=0;c<a;++c){var u=r[c],d=i[c],f=d.length,h=Zw(e.call(u,u&&u.__data__,c,r)),m=h.length,p=s[c]=new Array(m),_=o[c]=new Array(m),w=l[c]=new Array(f);n(u,d,p,_,w,h,t);for(var g=0,E=0,v,x;g<m;++g)if(v=p[g]){for(g>=E&&(E=g+1);!(x=_[E])&&++E<m;);v._next=x||null}}return o=new vt(o,r),o._enter=s,o._exit=l,o}function Zw(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Jw(){return new vt(this._exit||this._groups.map(j1),this._parents)}function Qw(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function ev(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var c=n[l],u=r[l],d=c.length,f=s[l]=new Array(d),h,m=0;m<d;++m)(h=c[m]||u[m])&&(f[m]=h);for(;l<i;++l)s[l]=n[l];return new vt(s,this._parents)}function tv(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function nv(e){e||(e=rv);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,l=i[a]=new Array(s),c,u=0;u<s;++u)(c=o[u])&&(l[u]=c);l.sort(t)}return new vt(i,this._parents).order()}function rv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function iv(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function av(){return Array.from(this)}function ov(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function sv(){let e=0;for(const t of this)++e;return e}function lv(){return!this.node()}function cv(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function uv(e){return function(){this.removeAttribute(e)}}function fv(e){return function(){this.removeAttributeNS(e.space,e.local)}}function hv(e,t){return function(){this.setAttribute(e,t)}}function dv(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function mv(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function pv(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function bv(e,t){var n=Vs(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?fv:uv:typeof t=="function"?n.local?pv:mv:n.local?dv:hv)(n,t))}function Y1(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function gv(e){return function(){this.style.removeProperty(e)}}function yv(e,t,n){return function(){this.style.setProperty(e,t,n)}}function _v(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function wv(e,t,n){return arguments.length>1?this.each((t==null?gv:typeof t=="function"?_v:yv)(e,t,n??"")):li(this.node(),e)}function li(e,t){return e.style.getPropertyValue(t)||Y1(e).getComputedStyle(e,null).getPropertyValue(t)}function vv(e){return function(){delete this[e]}}function Mv(e,t){return function(){this[e]=t}}function xv(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Ev(e,t){return arguments.length>1?this.each((t==null?vv:typeof t=="function"?xv:Mv)(e,t)):this.node()[e]}function W1(e){return e.trim().split(/^|\s+/)}function Vu(e){return e.classList||new X1(e)}function X1(e){this._node=e,this._names=W1(e.getAttribute("class")||"")}X1.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function K1(e,t){for(var n=Vu(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Z1(e,t){for(var n=Vu(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Sv(e){return function(){K1(this,e)}}function Av(e){return function(){Z1(this,e)}}function Pv(e,t){return function(){(t.apply(this,arguments)?K1:Z1)(this,e)}}function Nv(e,t){var n=W1(e+"");if(arguments.length<2){for(var r=Vu(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Pv:t?Sv:Av)(n,t))}function Cv(){this.textContent=""}function Tv(e){return function(){this.textContent=e}}function $v(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function kv(e){return arguments.length?this.each(e==null?Cv:(typeof e=="function"?$v:Tv)(e)):this.node().textContent}function Iv(){this.innerHTML=""}function Dv(e){return function(){this.innerHTML=e}}function Rv(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Lv(e){return arguments.length?this.each(e==null?Iv:(typeof e=="function"?Rv:Dv)(e)):this.node().innerHTML}function Bv(){this.nextSibling&&this.parentNode.appendChild(this)}function Ov(){return this.each(Bv)}function Fv(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Gv(){return this.each(Fv)}function Uv(e){var t=typeof e=="function"?e:js(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function qv(){return null}function Hv(e,t){var n=typeof e=="function"?e:js(e),r=t==null?qv:typeof t=="function"?t:zu(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function zv(){var e=this.parentNode;e&&e.removeChild(this)}function Vv(){return this.each(zv)}function jv(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Yv(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Wv(e){return this.select(e?Yv:jv)}function Xv(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Kv(e){return function(t){e.call(this,t,this.__data__)}}function Zv(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Jv(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function Qv(e,t,n){return function(){var r=this.__on,i,a=Kv(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function e3(e,t,n){var r=Zv(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,c=s.length,u;l<c;++l)for(i=0,u=s[l];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(s=t?Qv:Jv,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function J1(e,t,n){var r=Y1(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function t3(e,t){return function(){return J1(this,e,t)}}function n3(e,t){return function(){return J1(this,e,t.apply(this,arguments))}}function r3(e,t){return this.each((typeof t=="function"?n3:t3)(e,t))}function*i3(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var Q1=[null];function vt(e,t){this._groups=e,this._parents=t}function Ga(){return new vt([[document.documentElement]],Q1)}function a3(){return this}vt.prototype=Ga.prototype={constructor:vt,select:$w,selectAll:Rw,selectChild:Fw,selectChildren:Hw,filter:zw,data:Kw,enter:Vw,exit:Jw,join:Qw,merge:ev,selection:a3,order:tv,sort:nv,call:iv,nodes:av,node:ov,size:sv,empty:lv,each:cv,attr:bv,style:wv,property:Ev,classed:Nv,text:kv,html:Lv,raise:Ov,lower:Gv,append:Uv,insert:Hv,remove:Vv,clone:Wv,datum:Xv,on:e3,dispatch:r3,[Symbol.iterator]:i3};function ta(e){return typeof e=="string"?new vt([[document.querySelector(e)]],[document.documentElement]):new vt([[e]],Q1)}function o3(e){let t;for(;t=e.sourceEvent;)e=t;return e}function s3(e,t){if(e=o3(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}function Ei(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ua(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ar(){}var xr=.7,ci=1/xr,Zr="\\s*([+-]?\\d+)\\s*",da="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",hn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",l3=/^#([0-9a-f]{3,8})$/,c3=new RegExp(`^rgb\\(${Zr},${Zr},${Zr}\\)$`),u3=new RegExp(`^rgb\\(${hn},${hn},${hn}\\)$`),f3=new RegExp(`^rgba\\(${Zr},${Zr},${Zr},${da}\\)$`),h3=new RegExp(`^rgba\\(${hn},${hn},${hn},${da}\\)$`),d3=new RegExp(`^hsl\\(${da},${hn},${hn}\\)$`),m3=new RegExp(`^hsla\\(${da},${hn},${hn},${da}\\)$`),ph={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ei(ar,Er,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:bh,formatHex:bh,formatHex8:p3,formatHsl:b3,formatRgb:gh,toString:gh});function bh(){return this.rgb().formatHex()}function p3(){return this.rgb().formatHex8()}function b3(){return e0(this).formatHsl()}function gh(){return this.rgb().formatRgb()}function Er(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=l3.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?yh(t):n===3?new Xe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?po(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?po(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=c3.exec(e))?new Xe(t[1],t[2],t[3],1):(t=u3.exec(e))?new Xe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=f3.exec(e))?po(t[1],t[2],t[3],t[4]):(t=h3.exec(e))?po(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=d3.exec(e))?vh(t[1],t[2]/100,t[3]/100,1):(t=m3.exec(e))?vh(t[1],t[2]/100,t[3]/100,t[4]):ph.hasOwnProperty(e)?yh(ph[e]):e==="transparent"?new Xe(NaN,NaN,NaN,0):null}function yh(e){return new Xe(e>>16&255,e>>8&255,e&255,1)}function po(e,t,n,r){return r<=0&&(e=t=n=NaN),new Xe(e,t,n,r)}function ju(e){return e instanceof ar||(e=Er(e)),e?(e=e.rgb(),new Xe(e.r,e.g,e.b,e.opacity)):new Xe}function er(e,t,n,r){return arguments.length===1?ju(e):new Xe(e,t,n,r??1)}function Xe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ei(Xe,er,Ua(ar,{brighter(e){return e=e==null?ci:Math.pow(ci,e),new Xe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?xr:Math.pow(xr,e),new Xe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Xe(gr(this.r),gr(this.g),gr(this.b),ts(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_h,formatHex:_h,formatHex8:g3,formatRgb:wh,toString:wh}));function _h(){return`#${pr(this.r)}${pr(this.g)}${pr(this.b)}`}function g3(){return`#${pr(this.r)}${pr(this.g)}${pr(this.b)}${pr((isNaN(this.opacity)?1:this.opacity)*255)}`}function wh(){const e=ts(this.opacity);return`${e===1?"rgb(":"rgba("}${gr(this.r)}, ${gr(this.g)}, ${gr(this.b)}${e===1?")":`, ${e})`}`}function ts(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function gr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pr(e){return e=gr(e),(e<16?"0":"")+e.toString(16)}function vh(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ht(e,t,n,r)}function e0(e){if(e instanceof Ht)return new Ht(e.h,e.s,e.l,e.opacity);if(e instanceof ar||(e=Er(e)),!e)return new Ht;if(e instanceof Ht)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Ht(o,s,l,e.opacity)}function Dc(e,t,n,r){return arguments.length===1?e0(e):new Ht(e,t,n,r??1)}function Ht(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ei(Ht,Dc,Ua(ar,{brighter(e){return e=e==null?ci:Math.pow(ci,e),new Ht(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?xr:Math.pow(xr,e),new Ht(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Xe(Bl(e>=240?e-240:e+120,i,r),Bl(e,i,r),Bl(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Ht(Mh(this.h),bo(this.s),bo(this.l),ts(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ts(this.opacity);return`${e===1?"hsl(":"hsla("}${Mh(this.h)}, ${bo(this.s)*100}%, ${bo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Mh(e){return e=(e||0)%360,e<0?e+360:e}function bo(e){return Math.max(0,Math.min(1,e||0))}function Bl(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const t0=Math.PI/180,n0=180/Math.PI,ns=18,r0=.96422,i0=1,a0=.82521,o0=4/29,Jr=6/29,s0=3*Jr*Jr,y3=Jr*Jr*Jr;function l0(e){if(e instanceof dn)return new dn(e.l,e.a,e.b,e.opacity);if(e instanceof In)return c0(e);e instanceof Xe||(e=ju(e));var t=Ul(e.r),n=Ul(e.g),r=Ul(e.b),i=Ol((.2225045*t+.7168786*n+.0606169*r)/i0),a,o;return t===n&&n===r?a=o=i:(a=Ol((.4360747*t+.3850649*n+.1430804*r)/r0),o=Ol((.0139322*t+.0971045*n+.7141733*r)/a0)),new dn(116*i-16,500*(a-i),200*(i-o),e.opacity)}function Rc(e,t,n,r){return arguments.length===1?l0(e):new dn(e,t,n,r??1)}function dn(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Ei(dn,Rc,Ua(ar,{brighter(e){return new dn(this.l+ns*(e??1),this.a,this.b,this.opacity)},darker(e){return new dn(this.l-ns*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=r0*Fl(t),e=i0*Fl(e),n=a0*Fl(n),new Xe(Gl(3.1338561*t-1.6168667*e-.4906146*n),Gl(-.9787684*t+1.9161415*e+.033454*n),Gl(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Ol(e){return e>y3?Math.pow(e,1/3):e/s0+o0}function Fl(e){return e>Jr?e*e*e:s0*(e-o0)}function Gl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ul(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function _3(e){if(e instanceof In)return new In(e.h,e.c,e.l,e.opacity);if(e instanceof dn||(e=l0(e)),e.a===0&&e.b===0)return new In(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*n0;return new In(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Lc(e,t,n,r){return arguments.length===1?_3(e):new In(e,t,n,r??1)}function In(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function c0(e){if(isNaN(e.h))return new dn(e.l,0,0,e.opacity);var t=e.h*t0;return new dn(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ei(In,Lc,Ua(ar,{brighter(e){return new In(this.h,this.c,this.l+ns*(e??1),this.opacity)},darker(e){return new In(this.h,this.c,this.l-ns*(e??1),this.opacity)},rgb(){return c0(this).rgb()}}));var u0=-.14861,Yu=1.78277,Wu=-.29227,Ys=-.90649,ma=1.97294,xh=ma*Ys,Eh=ma*Yu,Sh=Yu*Wu-Ys*u0;function w3(e){if(e instanceof yr)return new yr(e.h,e.s,e.l,e.opacity);e instanceof Xe||(e=ju(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Sh*r+xh*t-Eh*n)/(Sh+xh-Eh),a=r-i,o=(ma*(n-i)-Wu*a)/Ys,s=Math.sqrt(o*o+a*a)/(ma*i*(1-i)),l=s?Math.atan2(o,a)*n0-120:NaN;return new yr(l<0?l+360:l,s,i,e.opacity)}function pn(e,t,n,r){return arguments.length===1?w3(e):new yr(e,t,n,r??1)}function yr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ei(yr,pn,Ua(ar,{brighter(e){return e=e==null?ci:Math.pow(ci,e),new yr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?xr:Math.pow(xr,e),new yr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*t0,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Xe(255*(t+n*(u0*r+Yu*i)),255*(t+n*(Wu*r+Ys*i)),255*(t+n*(ma*r)),this.opacity)}}));function v3(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function M3(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return v3((n-r/t)*t,o,i,a,s)}}const Ws=e=>()=>e;function f0(e,t){return function(n){return e+n*t}}function x3(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Xu(e,t){var n=t-e;return n?f0(e,n>180||n<-180?n-360*Math.round(n/360):n):Ws(isNaN(e)?t:e)}function E3(e){return(e=+e)==1?at:function(t,n){return n-t?x3(t,n,e):Ws(isNaN(t)?n:t)}}function at(e,t){var n=t-e;return n?f0(e,n):Ws(isNaN(e)?t:e)}const Sr=function e(t){var n=E3(t);function r(i,a){var o=n((i=er(i)).r,(a=er(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),c=at(i.opacity,a.opacity);return function(u){return i.r=o(u),i.g=s(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=e,r}(1);function S3(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,s;for(o=0;o<n;++o)s=er(t[o]),r[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return r=e(r),i=e(i),a=e(a),s.opacity=1,function(l){return s.r=r(l),s.g=i(l),s.b=a(l),s+""}}}var A3=S3(M3);function P3(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function N3(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function C3(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=qa(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function T3(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function rt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function $3(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=qa(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var Bc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ql=new RegExp(Bc.source,"g");function k3(e){return function(){return e}}function I3(e){return function(t){return e(t)+""}}function h0(e,t){var n=Bc.lastIndex=ql.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(r=Bc.exec(e))&&(i=ql.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:rt(r,i)})),n=ql.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?I3(l[0].x):k3(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)s[(d=l[u]).i]=d.x(c);return s.join("")})}function qa(e,t){var n=typeof t,r;return t==null||n==="boolean"?Ws(t):(n==="number"?rt:n==="string"?(r=Er(t))?(t=r,Sr):h0:t instanceof Er?Sr:t instanceof Date?T3:N3(t)?P3:Array.isArray(t)?C3:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$3:rt)(e,t)}function Ku(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Ah=180/Math.PI,Oc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function d0(e,t,n,r,i,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Ah,skewX:Math.atan(l)*Ah,scaleX:o,scaleY:s}}var go;function D3(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Oc:d0(t.a,t.b,t.c,t.d,t.e,t.f)}function R3(e){return e==null||(go||(go=document.createElementNS("http://www.w3.org/2000/svg","g")),go.setAttribute("transform",e),!(e=go.transform.baseVal.consolidate()))?Oc:(e=e.matrix,d0(e.a,e.b,e.c,e.d,e.e,e.f))}function m0(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function a(c,u,d,f,h,m){if(c!==d||u!==f){var p=h.push("translate(",null,t,null,n);m.push({i:p-4,x:rt(c,d)},{i:p-2,x:rt(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function o(c,u,d,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:rt(c,u)})):u&&d.push(i(d)+"rotate("+u+r)}function s(c,u,d,f){c!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:rt(c,u)}):u&&d.push(i(d)+"skewX("+u+r)}function l(c,u,d,f,h,m){if(c!==d||u!==f){var p=h.push(i(h)+"scale(",null,",",null,")");m.push({i:p-4,x:rt(c,d)},{i:p-2,x:rt(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(c,u){var d=[],f=[];return c=e(c),u=e(u),a(c.translateX,c.translateY,u.translateX,u.translateY,d,f),o(c.rotate,u.rotate,d,f),s(c.skewX,u.skewX,d,f),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,f),c=u=null,function(h){for(var m=-1,p=f.length,_;++m<p;)d[(_=f[m]).i]=_.x(h);return d.join("")}}}var L3=m0(D3,"px, ","px)","deg)"),B3=m0(R3,", ",")",")");function O3(e){return function(t,n){var r=e((t=Dc(t)).h,(n=Dc(n)).h),i=at(t.s,n.s),a=at(t.l,n.l),o=at(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=a(s),t.opacity=o(s),t+""}}}const F3=O3(Xu);function G3(e,t){var n=at((e=Rc(e)).l,(t=Rc(t)).l),r=at(e.a,t.a),i=at(e.b,t.b),a=at(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=a(o),e+""}}function U3(e){return function(t,n){var r=e((t=Lc(t)).h,(n=Lc(n)).h),i=at(t.c,n.c),a=at(t.l,n.l),o=at(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=a(s),t.opacity=o(s),t+""}}}const q3=U3(Xu);function p0(e){return function t(n){n=+n;function r(i,a){var o=e((i=pn(i)).h,(a=pn(a)).h),s=at(i.s,a.s),l=at(i.l,a.l),c=at(i.opacity,a.opacity);return function(u){return i.h=o(u),i.s=s(u),i.l=l(Math.pow(u,n)),i.opacity=c(u),i+""}}return r.gamma=t,r}(1)}p0(Xu);var Zu=p0(at);function Xs(e,t){t===void 0&&(t=e,e=qa);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function Kt(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var ui=0,Ui=0,Ii=0,b0=1e3,rs,qi,is=0,Ar=0,Ks=0,pa=typeof performance=="object"&&performance.now?performance:Date,g0=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ju(){return Ar||(g0(H3),Ar=pa.now()+Ks)}function H3(){Ar=0}function as(){this._call=this._time=this._next=null}as.prototype=y0.prototype={constructor:as,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Ju():+n)+(t==null?0:+t),!this._next&&qi!==this&&(qi?qi._next=this:rs=this,qi=this),this._call=e,this._time=n,Fc()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fc())}};function y0(e,t,n){var r=new as;return r.restart(e,t,n),r}function z3(){Ju(),++ui;for(var e=rs,t;e;)(t=Ar-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ui}function Ph(){Ar=(is=pa.now())+Ks,ui=Ui=0;try{z3()}finally{ui=0,j3(),Ar=0}}function V3(){var e=pa.now(),t=e-is;t>b0&&(Ks-=t,is=e)}function j3(){for(var e,t=rs,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:rs=n);qi=e,Fc(r)}function Fc(e){if(!ui){Ui&&(Ui=clearTimeout(Ui));var t=e-Ar;t>24?(e<1/0&&(Ui=setTimeout(Ph,e-pa.now()-Ks)),Ii&&(Ii=clearInterval(Ii))):(Ii||(is=pa.now(),Ii=setInterval(V3,b0)),ui=1,g0(Ph))}}function Nh(e,t,n){var r=new as;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Y3=q1("start","end","cancel","interrupt"),W3=[],_0=0,Ch=1,Gc=2,Bo=3,Th=4,Uc=5,Oo=6;function Zs(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;X3(e,n,{name:t,index:r,group:i,on:Y3,tween:W3,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:_0})}function Qu(e,t){var n=tn(e,t);if(n.state>_0)throw new Error("too late; already scheduled");return n}function _n(e,t){var n=tn(e,t);if(n.state>Bo)throw new Error("too late; already running");return n}function tn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function X3(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=y0(a,0,n.time);function a(c){n.state=Ch,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var u,d,f,h;if(n.state!==Ch)return l();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Bo)return Nh(o);h.state===Th?(h.state=Oo,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Oo,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(Nh(function(){n.state===Bo&&(n.state=Th,n.timer.restart(s,n.delay,n.time),s(c))}),n.state=Gc,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Gc){for(n.state=Bo,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function s(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Uc,1),d=-1,f=i.length;++d<f;)i[d].call(e,u);n.state===Uc&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Oo,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function K3(e,t){var n=e.__transition,r,i,a=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>Gc&&r.state<Uc,r.state=Oo,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function Z3(e){return this.each(function(){K3(this,e)})}function J3(e,t){var n,r;return function(){var i=_n(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Q3(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=_n(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=s;break}l===c&&i.push(s)}a.tween=i}}function e5(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=tn(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?J3:Q3)(n,e,t))}function ef(e,t,n){var r=e._id;return e.each(function(){var i=_n(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return tn(i,r).value[t]}}function w0(e,t){var n;return(typeof t=="number"?rt:t instanceof Er?Sr:(n=Er(t))?(t=n,Sr):h0)(e,t)}function t5(e){return function(){this.removeAttribute(e)}}function n5(e){return function(){this.removeAttributeNS(e.space,e.local)}}function r5(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function i5(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function a5(e,t,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s)))}}function o5(e,t,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s)))}}function s5(e,t){var n=Vs(e),r=n==="transform"?B3:w0;return this.attrTween(e,typeof t=="function"?(n.local?o5:a5)(n,r,ef(this,"attr."+e,t)):t==null?(n.local?n5:t5)(n):(n.local?i5:r5)(n,r,t))}function l5(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function c5(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function u5(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&c5(e,a)),n}return i._value=t,i}function f5(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&l5(e,a)),n}return i._value=t,i}function h5(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Vs(e);return this.tween(n,(r.local?u5:f5)(r,t))}function d5(e,t){return function(){Qu(this,e).delay=+t.apply(this,arguments)}}function m5(e,t){return t=+t,function(){Qu(this,e).delay=t}}function p5(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?d5:m5)(t,e)):tn(this.node(),t).delay}function b5(e,t){return function(){_n(this,e).duration=+t.apply(this,arguments)}}function g5(e,t){return t=+t,function(){_n(this,e).duration=t}}function y5(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?b5:g5)(t,e)):tn(this.node(),t).duration}function _5(e,t){if(typeof t!="function")throw new Error;return function(){_n(this,e).ease=t}}function w5(e){var t=this._id;return arguments.length?this.each(_5(t,e)):tn(this.node(),t).ease}function v5(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;_n(this,e).ease=n}}function M5(e){if(typeof e!="function")throw new Error;return this.each(v5(this._id,e))}function x5(e){typeof e!="function"&&(e=z1(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],l,c=0;c<o;++c)(l=a[c])&&e.call(l,l.__data__,c,a)&&s.push(l);return new Bn(r,this._parents,this._name,this._id)}function E5(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l=t[s],c=n[s],u=l.length,d=o[s]=new Array(u),f,h=0;h<u;++h)(f=l[h]||c[h])&&(d[h]=f);for(;s<r;++s)o[s]=t[s];return new Bn(o,this._parents,this._name,this._id)}function S5(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function A5(e,t,n){var r,i,a=S5(t)?Qu:_n;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function P5(e,t){var n=this._id;return arguments.length<2?tn(this.node(),n).on.on(e):this.each(A5(n,e,t))}function N5(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function C5(){return this.on("end.remove",N5(this._id))}function T5(e){var t=this._name,n=this._id;typeof e!="function"&&(e=zu(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s=r[o],l=s.length,c=a[o]=new Array(l),u,d,f=0;f<l;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),c[f]=d,Zs(c[f],t,n,f,c,tn(u,n)));return new Bn(a,this._parents,t,n)}function $5(e){var t=this._name,n=this._id;typeof e!="function"&&(e=H1(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l=r[s],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var f=e.call(u,u.__data__,d,l),h,m=tn(u,n),p=0,_=f.length;p<_;++p)(h=f[p])&&Zs(h,t,n,p,f,m);a.push(f),o.push(u)}return new Bn(a,o,t,n)}var k5=Ga.prototype.constructor;function I5(){return new k5(this._groups,this._parents)}function D5(e,t){var n,r,i;return function(){var a=li(this,e),o=(this.style.removeProperty(e),li(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function v0(e){return function(){this.style.removeProperty(e)}}function R5(e,t,n){var r,i=n+"",a;return function(){var o=li(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function L5(e,t,n){var r,i,a;return function(){var o=li(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),li(this,e))),o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s))}}function B5(e,t){var n,r,i,a="style."+t,o="end."+a,s;return function(){var l=_n(this,e),c=l.on,u=l.value[a]==null?s||(s=v0(t)):void 0;(c!==n||i!==u)&&(r=(n=c).copy()).on(o,i=u),l.on=r}}function O5(e,t,n){var r=(e+="")=="transform"?L3:w0;return t==null?this.styleTween(e,D5(e,r)).on("end.style."+e,v0(e)):typeof t=="function"?this.styleTween(e,L5(e,r,ef(this,"style."+e,t))).each(B5(this._id,e)):this.styleTween(e,R5(e,r,t),n).on("end.style."+e,null)}function F5(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function G5(e,t,n){var r,i;function a(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&F5(e,o,n)),r}return a._value=t,a}function U5(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,G5(e,t,n??""))}function q5(e){return function(){this.textContent=e}}function H5(e){return function(){var t=e(this);this.textContent=t??""}}function z5(e){return this.tween("text",typeof e=="function"?H5(ef(this,"text",e)):q5(e==null?"":e+""))}function V5(e){return function(t){this.textContent=e.call(this,t)}}function j5(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&V5(i)),t}return r._value=e,r}function Y5(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,j5(e))}function W5(){for(var e=this._name,t=this._id,n=M0(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,c=0;c<s;++c)if(l=o[c]){var u=tn(l,t);Zs(l,e,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Bn(r,this._parents,e,n)}function X5(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},l={value:function(){--i===0&&a()}};n.each(function(){var c=_n(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),c.on=t}),i===0&&a()})}var K5=0;function Bn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function M0(){return++K5}var An=Ga.prototype;Bn.prototype={constructor:Bn,select:T5,selectAll:$5,selectChild:An.selectChild,selectChildren:An.selectChildren,filter:x5,merge:E5,selection:I5,transition:W5,call:An.call,nodes:An.nodes,node:An.node,size:An.size,empty:An.empty,each:An.each,on:P5,attr:s5,attrTween:h5,style:O5,styleTween:U5,text:z5,textTween:Y5,remove:C5,tween:e5,delay:p5,duration:y5,ease:w5,easeVarying:M5,end:X5,[Symbol.iterator]:An[Symbol.iterator]};function Z5(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var J5={time:null,delay:0,duration:250,ease:Z5};function Q5(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function e7(e){var t,n;e instanceof Bn?(t=e._id,e=e._name):(t=M0(),(n=J5).time=Ju(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,c=0;c<s;++c)(l=o[c])&&Zs(l,e,t,c,o,n||Q5(l,t));return new Bn(r,this._parents,e,t)}Ga.prototype.interrupt=Z3;Ga.prototype.transition=e7;const qc=Math.PI,Hc=2*qc,hr=1e-6,t7=Hc-hr;function x0(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function n7(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return x0;const n=10**t;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class r7{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?x0:n7(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,a,o){this._append`C${+t},${+n},${+r},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(t,n,r,i,a){if(t=+t,n=+n,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,l=r-t,c=i-n,u=o-t,d=s-n,f=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>hr)if(!(Math.abs(d*l-c*u)>hr)||!a)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-o,m=i-s,p=l*l+c*c,_=h*h+m*m,w=Math.sqrt(p),g=Math.sqrt(f),E=a*Math.tan((qc-Math.acos((p+f-_)/(2*w*g)))/2),v=E/g,x=E/w;Math.abs(v-1)>hr&&this._append`L${t+v*u},${n+v*d}`,this._append`A${a},${a},0,0,${+(d*h>u*m)},${this._x1=t+x*l},${this._y1=n+x*c}`}}arc(t,n,r,i,a,o){if(t=+t,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),l=r*Math.sin(i),c=t+s,u=n+l,d=1^o,f=o?i-a:a-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>hr||Math.abs(this._y1-u)>hr)&&this._append`L${c},${u}`,r&&(f<0&&(f=f%Hc+Hc),f>t7?this._append`A${r},${r},0,1,${d},${t-s},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:f>hr&&this._append`A${r},${r},0,${+(f>=qc)},${d},${this._x1=t+r*Math.cos(a)},${this._y1=n+r*Math.sin(a)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Kn(e=3){return new r7(+e)}function i7(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function os(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function fi(e){return e=os(Math.abs(e)),e?e[1]:NaN}function a7(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(n.substring(i-=s,i+s)),!((l+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function o7(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var s7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ba(e){if(!(t=s7.exec(e)))throw new Error("invalid format: "+e);var t;return new tf({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ba.prototype=tf.prototype;function tf(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}tf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function l7(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var E0;function c7(e,t){var n=os(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(E0=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+os(e,Math.max(0,t+a-1))[0]}function $h(e,t){var n=os(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const kh={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:i7,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$h(e*100,t),r:$h,s:c7,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Ih(e){return e}var Dh=Array.prototype.map,Rh=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function u7(e){var t=e.grouping===void 0||e.thousands===void 0?Ih:a7(Dh.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?Ih:o7(Dh.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(d){d=ba(d);var f=d.fill,h=d.align,m=d.sign,p=d.symbol,_=d.zero,w=d.width,g=d.comma,E=d.precision,v=d.trim,x=d.type;x==="n"?(g=!0,x="g"):kh[x]||(E===void 0&&(E=12),v=!0,x="g"),(_||f==="0"&&h==="=")&&(_=!0,f="0",h="=");var y=p==="$"?n:p==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",M=p==="$"?r:/[%p]/.test(x)?o:"",A=kh[x],S=/[defgprs%]/.test(x);E=E===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function $(C){var k=y,B=M,G,T,I;if(x==="c")B=A(C)+B,C="";else{C=+C;var O=C<0||1/C<0;if(C=isNaN(C)?l:A(Math.abs(C),E),v&&(C=l7(C)),O&&+C==0&&m!=="+"&&(O=!1),k=(O?m==="("?m:s:m==="-"||m==="("?"":m)+k,B=(x==="s"?Rh[8+E0/3]:"")+B+(O&&m==="("?")":""),S){for(G=-1,T=C.length;++G<T;)if(I=C.charCodeAt(G),48>I||I>57){B=(I===46?i+C.slice(G+1):C.slice(G))+B,C=C.slice(0,G);break}}}g&&!_&&(C=t(C,1/0));var q=k.length+C.length+B.length,z=q<w?new Array(w-q+1).join(f):"";switch(g&&_&&(C=t(z+C,z.length?w-B.length:1/0),z=""),h){case"<":C=k+C+B+z;break;case"=":C=k+z+C+B;break;case"^":C=z.slice(0,q=z.length>>1)+k+C+B+z.slice(q);break;default:C=z+k+C+B;break}return a(C)}return $.toString=function(){return d+""},$}function u(d,f){var h=c((d=ba(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(fi(f)/3)))*3,p=Math.pow(10,-m),_=Rh[8+m/3];return function(w){return h(p*w)+_}}return{format:c,formatPrefix:u}}var yo,Si,S0;f7({thousands:",",grouping:[3],currency:["$",""]});function f7(e){return yo=u7(e),Si=yo.format,S0=yo.formatPrefix,yo}function h7(e){return Math.max(0,-fi(Math.abs(e)))}function d7(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(fi(t)/3)))*3-fi(Math.abs(e)))}function m7(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,fi(t)-fi(e))+1}var ge=1e-6,A0=1e-12,Me=Math.PI,Re=Me/2,Lh=Me/4,Mt=Me*2,ct=180/Me,De=Me/180,Ce=Math.abs,Ai=Math.atan,On=Math.atan2,ve=Math.cos,P0=Math.exp,ss=Math.log,Hl=Math.pow,pe=Math.sin,Ct=Math.sign||function(e){return e>0?1:e<0?-1:0},gt=Math.sqrt,nf=Math.tan;function N0(e){return e>1?0:e<-1?Me:Math.acos(e)}function Dt(e){return e>1?Re:e<-1?-Re:Math.asin(e)}function Tt(){}function ls(e,t){e&&Oh.hasOwnProperty(e.type)&&Oh[e.type](e,t)}var Bh={Feature:function(e,t){ls(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)ls(n[r].geometry,t)}},Oh={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){zc(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)zc(n[r],t,0)},Polygon:function(e,t){Fh(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Fh(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)ls(n[r],t)}};function zc(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Fh(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)zc(e[n],t,1);t.polygonEnd()}function dr(e,t){e&&Bh.hasOwnProperty(e.type)?Bh[e.type](e,t):ls(e,t)}function Vc(e){return[On(e[1],e[0]),Dt(e[2])]}function hi(e){var t=e[0],n=e[1],r=ve(n);return[r*ve(t),r*pe(t),pe(n)]}function _o(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function cs(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function zl(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function wo(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function jc(e){var t=gt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Yc(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function Wc(e,t){return Ce(e)>Me&&(e-=Math.round(e/Mt)*Mt),[e,t]}Wc.invert=Wc;function C0(e,t,n){return(e%=Mt)?t||n?Yc(Uh(e),qh(t,n)):Uh(e):t||n?qh(t,n):Wc}function Gh(e){return function(t,n){return t+=e,Ce(t)>Me&&(t-=Math.round(t/Mt)*Mt),[t,n]}}function Uh(e){var t=Gh(e);return t.invert=Gh(-e),t}function qh(e,t){var n=ve(e),r=pe(e),i=ve(t),a=pe(t);function o(s,l){var c=ve(l),u=ve(s)*c,d=pe(s)*c,f=pe(l),h=f*n+u*r;return[On(d*i-h*a,u*n-f*r),Dt(h*i+d*a)]}return o.invert=function(s,l){var c=ve(l),u=ve(s)*c,d=pe(s)*c,f=pe(l),h=f*i-d*a;return[On(d*i+f*a,u*n+h*r),Dt(h*n-u*r)]},o}function p7(e){e=C0(e[0]*De,e[1]*De,e.length>2?e[2]*De:0);function t(n){return n=e(n[0]*De,n[1]*De),n[0]*=ct,n[1]*=ct,n}return t.invert=function(n){return n=e.invert(n[0]*De,n[1]*De),n[0]*=ct,n[1]*=ct,n},t}function b7(e,t,n,r,i,a){if(n){var o=ve(t),s=pe(t),l=r*n;i==null?(i=t+r*Mt,a=t-l/2):(i=Hh(o,i),a=Hh(o,a),(r>0?i<a:i>a)&&(i+=r*Mt));for(var c,u=i;r>0?u>a:u<a;u-=l)c=Vc([o,-s*ve(u),-s*pe(u)]),e.point(c[0],c[1])}}function Hh(e,t){t=hi(t),t[0]-=e,jc(t);var n=N0(-t[1]);return((-t[2]<0?-n:n)+Mt-ge)%Mt}function T0(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Tt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Fo(e,t){return Ce(e[0]-t[0])<ge&&Ce(e[1]-t[1])<ge}function vo(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function $0(e,t,n,r,i){var a=[],o=[],s,l;if(e.forEach(function(m){if(!((p=m.length-1)<=0)){var p,_=m[0],w=m[p],g;if(Fo(_,w)){if(!_[2]&&!w[2]){for(i.lineStart(),s=0;s<p;++s)i.point((_=m[s])[0],_[1]);i.lineEnd();return}w[0]+=2*ge}a.push(g=new vo(_,m,null,!0)),o.push(g.o=new vo(_,null,g,!1)),a.push(g=new vo(w,m,null,!1)),o.push(g.o=new vo(w,null,g,!0))}}),!!a.length){for(o.sort(t),zh(a),zh(o),s=0,l=o.length;s<l;++s)o[s].e=n=!n;for(var c=a[0],u,d;;){for(var f=c,h=!0;f.v;)if((f=f.n)===c)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(h)for(s=0,l=u.length;s<l;++s)i.point((d=u[s])[0],d[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(h)for(u=f.p.z,s=u.length-1;s>=0;--s)i.point((d=u[s])[0],d[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,u=f.z,h=!h}while(!f.v);i.lineEnd()}}}function zh(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Vl(e){return Ce(e[0])<=Me?e[0]:Ct(e[0])*((Ce(e[0])+Me)%Mt-Me)}function g7(e,t){var n=Vl(t),r=t[1],i=pe(r),a=[pe(n),-ve(n),0],o=0,s=0,l=new vr;i===1?r=Re+ge:i===-1&&(r=-Re-ge);for(var c=0,u=e.length;c<u;++c)if(f=(d=e[c]).length)for(var d,f,h=d[f-1],m=Vl(h),p=h[1]/2+Lh,_=pe(p),w=ve(p),g=0;g<f;++g,m=v,_=y,w=M,h=E){var E=d[g],v=Vl(E),x=E[1]/2+Lh,y=pe(x),M=ve(x),A=v-m,S=A>=0?1:-1,$=S*A,C=$>Me,k=_*y;if(l.add(On(k*S*pe($),w*M+k*ve($))),o+=C?A+S*Mt:A,C^m>=n^v>=n){var B=cs(hi(h),hi(E));jc(B);var G=cs(a,B);jc(G);var T=(C^A>=0?-1:1)*Dt(G[2]);(r>T||r===T&&(B[0]||B[1]))&&(s+=C^A>=0?1:-1)}}return(o<-ge||o<ge&&l<-A0)^s&1}function k0(e,t,n,r){return function(i){var a=t(i),o=T0(),s=t(o),l=!1,c,u,d,f={point:h,lineStart:p,lineEnd:_,polygonStart:function(){f.point=w,f.lineStart=g,f.lineEnd=E,u=[],c=[]},polygonEnd:function(){f.point=h,f.lineStart=p,f.lineEnd=_,u=U1(u);var v=g7(c,r);u.length?(l||(i.polygonStart(),l=!0),$0(u,_7,v,n,i)):v&&(l||(i.polygonStart(),l=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),u=c=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(v,x){e(v,x)&&i.point(v,x)}function m(v,x){a.point(v,x)}function p(){f.point=m,a.lineStart()}function _(){f.point=h,a.lineEnd()}function w(v,x){d.push([v,x]),s.point(v,x)}function g(){s.lineStart(),d=[]}function E(){w(d[0][0],d[0][1]),s.lineEnd();var v=s.clean(),x=o.result(),y,M=x.length,A,S,$;if(d.pop(),c.push(d),d=null,!!M){if(v&1){if(S=x[0],(A=S.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),y=0;y<A;++y)i.point(($=S[y])[0],$[1]);i.lineEnd()}return}M>1&&v&2&&x.push(x.pop().concat(x.shift())),u.push(x.filter(y7))}}return f}}function y7(e){return e.length>1}function _7(e,t){return((e=e.x)[0]<0?e[1]-Re-ge:Re-e[1])-((t=t.x)[0]<0?t[1]-Re-ge:Re-t[1])}const Vh=k0(function(){return!0},w7,M7,[-Me,-Re]);function w7(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,o){var s=a>0?Me:-Me,l=Ce(a-t);Ce(l-Me)<ge?(e.point(t,n=(n+o)/2>0?Re:-Re),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),i=0):r!==s&&l>=Me&&(Ce(t-r)<ge&&(t-=r*ge),Ce(a-s)<ge&&(a-=s*ge),n=v7(t,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=a,n=o),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function v7(e,t,n,r){var i,a,o=pe(e-n);return Ce(o)>ge?Ai((pe(t)*(a=ve(r))*pe(n)-pe(r)*(i=ve(t))*pe(e))/(i*a*o)):(t+r)/2}function M7(e,t,n,r){var i;if(e==null)i=n*Re,r.point(-Me,i),r.point(0,i),r.point(Me,i),r.point(Me,0),r.point(Me,-i),r.point(0,-i),r.point(-Me,-i),r.point(-Me,0),r.point(-Me,i);else if(Ce(e[0]-t[0])>ge){var a=e[0]<t[0]?Me:-Me;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function x7(e){var t=ve(e),n=2*De,r=t>0,i=Ce(t)>ge;function a(u,d,f,h){b7(h,e,n,f,u,d)}function o(u,d){return ve(u)*ve(d)>t}function s(u){var d,f,h,m,p;return{lineStart:function(){m=h=!1,p=1},point:function(_,w){var g=[_,w],E,v=o(_,w),x=r?v?0:c(_,w):v?c(_+(_<0?Me:-Me),w):0;if(!d&&(m=h=v)&&u.lineStart(),v!==h&&(E=l(d,g),(!E||Fo(d,E)||Fo(g,E))&&(g[2]=1)),v!==h)p=0,v?(u.lineStart(),E=l(g,d),u.point(E[0],E[1])):(E=l(d,g),u.point(E[0],E[1],2),u.lineEnd()),d=E;else if(i&&d&&r^v){var y;!(x&f)&&(y=l(g,d,!0))&&(p=0,r?(u.lineStart(),u.point(y[0][0],y[0][1]),u.point(y[1][0],y[1][1]),u.lineEnd()):(u.point(y[1][0],y[1][1]),u.lineEnd(),u.lineStart(),u.point(y[0][0],y[0][1],3)))}v&&(!d||!Fo(d,g))&&u.point(g[0],g[1]),d=g,h=v,f=x},lineEnd:function(){h&&u.lineEnd(),d=null},clean:function(){return p|(m&&h)<<1}}}function l(u,d,f){var h=hi(u),m=hi(d),p=[1,0,0],_=cs(h,m),w=_o(_,_),g=_[0],E=w-g*g;if(!E)return!f&&u;var v=t*w/E,x=-t*g/E,y=cs(p,_),M=wo(p,v),A=wo(_,x);zl(M,A);var S=y,$=_o(M,S),C=_o(S,S),k=$*$-C*(_o(M,M)-1);if(!(k<0)){var B=gt(k),G=wo(S,(-$-B)/C);if(zl(G,M),G=Vc(G),!f)return G;var T=u[0],I=d[0],O=u[1],q=d[1],z;I<T&&(z=T,T=I,I=z);var H=I-T,J=Ce(H-Me)<ge,Z=J||H<ge;if(!J&&q<O&&(z=O,O=q,q=z),Z?J?O+q>0^G[1]<(Ce(G[0]-T)<ge?O:q):O<=G[1]&&G[1]<=q:H>Me^(T<=G[0]&&G[0]<=I)){var F=wo(S,(-$+B)/C);return zl(F,M),[G,Vc(F)]}}}function c(u,d){var f=r?e:Me-e,h=0;return u<-f?h|=1:u>f&&(h|=2),d<-f?h|=4:d>f&&(h|=8),h}return k0(o,s,a,r?[0,-e]:[-Me,e-Me])}function E7(e,t,n,r,i,a){var o=e[0],s=e[1],l=t[0],c=t[1],u=0,d=1,f=l-o,h=c-s,m;if(m=n-o,!(!f&&m>0)){if(m/=f,f<0){if(m<u)return;m<d&&(d=m)}else if(f>0){if(m>d)return;m>u&&(u=m)}if(m=i-o,!(!f&&m<0)){if(m/=f,f<0){if(m>d)return;m>u&&(u=m)}else if(f>0){if(m<u)return;m<d&&(d=m)}if(m=r-s,!(!h&&m>0)){if(m/=h,h<0){if(m<u)return;m<d&&(d=m)}else if(h>0){if(m>d)return;m>u&&(u=m)}if(m=a-s,!(!h&&m<0)){if(m/=h,h<0){if(m>d)return;m>u&&(u=m)}else if(h>0){if(m<u)return;m<d&&(d=m)}return u>0&&(e[0]=o+u*f,e[1]=s+u*h),d<1&&(t[0]=o+d*f,t[1]=s+d*h),!0}}}}}var Hi=1e9,Mo=-Hi;function I0(e,t,n,r){function i(c,u){return e<=c&&c<=n&&t<=u&&u<=r}function a(c,u,d,f){var h=0,m=0;if(c==null||(h=o(c,d))!==(m=o(u,d))||l(c,u)<0^d>0)do f.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+d+4)%4)!==m);else f.point(u[0],u[1])}function o(c,u){return Ce(c[0]-e)<ge?u>0?0:3:Ce(c[0]-n)<ge?u>0?2:1:Ce(c[1]-t)<ge?u>0?1:0:u>0?3:2}function s(c,u){return l(c.x,u.x)}function l(c,u){var d=o(c,1),f=o(u,1);return d!==f?d-f:d===0?u[1]-c[1]:d===1?c[0]-u[0]:d===2?c[1]-u[1]:u[0]-c[0]}return function(c){var u=c,d=T0(),f,h,m,p,_,w,g,E,v,x,y,M={point:A,lineStart:k,lineEnd:B,polygonStart:$,polygonEnd:C};function A(T,I){i(T,I)&&u.point(T,I)}function S(){for(var T=0,I=0,O=h.length;I<O;++I)for(var q=h[I],z=1,H=q.length,J=q[0],Z,F,te=J[0],ne=J[1];z<H;++z)Z=te,F=ne,J=q[z],te=J[0],ne=J[1],F<=r?ne>r&&(te-Z)*(r-F)>(ne-F)*(e-Z)&&++T:ne<=r&&(te-Z)*(r-F)<(ne-F)*(e-Z)&&--T;return T}function $(){u=d,f=[],h=[],y=!0}function C(){var T=S(),I=y&&T,O=(f=U1(f)).length;(I||O)&&(c.polygonStart(),I&&(c.lineStart(),a(null,null,1,c),c.lineEnd()),O&&$0(f,s,T,a,c),c.polygonEnd()),u=c,f=h=m=null}function k(){M.point=G,h&&h.push(m=[]),x=!0,v=!1,g=E=NaN}function B(){f&&(G(p,_),w&&v&&d.rejoin(),f.push(d.result())),M.point=A,v&&u.lineEnd()}function G(T,I){var O=i(T,I);if(h&&m.push([T,I]),x)p=T,_=I,w=O,x=!1,O&&(u.lineStart(),u.point(T,I));else if(O&&v)u.point(T,I);else{var q=[g=Math.max(Mo,Math.min(Hi,g)),E=Math.max(Mo,Math.min(Hi,E))],z=[T=Math.max(Mo,Math.min(Hi,T)),I=Math.max(Mo,Math.min(Hi,I))];E7(q,z,e,t,n,r)?(v||(u.lineStart(),u.point(q[0],q[1])),u.point(z[0],z[1]),O||u.lineEnd(),y=!1):O&&(u.lineStart(),u.point(T,I),y=!1)}g=T,E=I,v=O}return M}}const Xc=e=>e;var jl=new vr,Kc=new vr,D0,R0,Zc,Jc,kn={point:Tt,lineStart:Tt,lineEnd:Tt,polygonStart:function(){kn.lineStart=S7,kn.lineEnd=P7},polygonEnd:function(){kn.lineStart=kn.lineEnd=kn.point=Tt,jl.add(Ce(Kc)),Kc=new vr},result:function(){var e=jl/2;return jl=new vr,e}};function S7(){kn.point=A7}function A7(e,t){kn.point=L0,D0=Zc=e,R0=Jc=t}function L0(e,t){Kc.add(Jc*e-Zc*t),Zc=e,Jc=t}function P7(){L0(D0,R0)}var di=1/0,us=di,ga=-di,fs=ga,hs={point:N7,lineStart:Tt,lineEnd:Tt,polygonStart:Tt,polygonEnd:Tt,result:function(){var e=[[di,us],[ga,fs]];return ga=fs=-(us=di=1/0),e}};function N7(e,t){e<di&&(di=e),e>ga&&(ga=e),t<us&&(us=t),t>fs&&(fs=t)}var Qc=0,eu=0,zi=0,ds=0,ms=0,Vr=0,tu=0,nu=0,Vi=0,B0,O0,ln,cn,Nt={point:Pr,lineStart:jh,lineEnd:Yh,polygonStart:function(){Nt.lineStart=$7,Nt.lineEnd=k7},polygonEnd:function(){Nt.point=Pr,Nt.lineStart=jh,Nt.lineEnd=Yh},result:function(){var e=Vi?[tu/Vi,nu/Vi]:Vr?[ds/Vr,ms/Vr]:zi?[Qc/zi,eu/zi]:[NaN,NaN];return Qc=eu=zi=ds=ms=Vr=tu=nu=Vi=0,e}};function Pr(e,t){Qc+=e,eu+=t,++zi}function jh(){Nt.point=C7}function C7(e,t){Nt.point=T7,Pr(ln=e,cn=t)}function T7(e,t){var n=e-ln,r=t-cn,i=gt(n*n+r*r);ds+=i*(ln+e)/2,ms+=i*(cn+t)/2,Vr+=i,Pr(ln=e,cn=t)}function Yh(){Nt.point=Pr}function $7(){Nt.point=I7}function k7(){F0(B0,O0)}function I7(e,t){Nt.point=F0,Pr(B0=ln=e,O0=cn=t)}function F0(e,t){var n=e-ln,r=t-cn,i=gt(n*n+r*r);ds+=i*(ln+e)/2,ms+=i*(cn+t)/2,Vr+=i,i=cn*e-ln*t,tu+=i*(ln+e),nu+=i*(cn+t),Vi+=i*3,Pr(ln=e,cn=t)}function G0(e){this._context=e}G0.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Mt);break}}},result:Tt};var ru=new vr,Yl,U0,q0,ji,Yi,ya={point:Tt,lineStart:function(){ya.point=D7},lineEnd:function(){Yl&&H0(U0,q0),ya.point=Tt},polygonStart:function(){Yl=!0},polygonEnd:function(){Yl=null},result:function(){var e=+ru;return ru=new vr,e}};function D7(e,t){ya.point=H0,U0=ji=e,q0=Yi=t}function H0(e,t){ji-=e,Yi-=t,ru.add(gt(ji*ji+Yi*Yi)),ji=e,Yi=t}let Wh,ps,Xh,Kh;class Zh{constructor(t){this._append=t==null?z0:R7(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==Xh||this._append!==ps){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Xh=r,ps=this._append,Kh=this._,this._=i}this._+=Kh;break}}}result(){const t=this._;return this._="",t.length?t:null}}function z0(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function R7(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return z0;if(t!==Wh){const n=10**t;Wh=t,ps=function(i){let a=1;this._+=i[0];for(const o=i.length;a<o;++a)this._+=Math.round(arguments[a]*n)/n+i[a]}}return ps}function rf(e,t){let n=3,r=4.5,i,a;function o(s){return s&&(typeof r=="function"&&a.pointRadius(+r.apply(this,arguments)),dr(s,i(a))),a.result()}return o.area=function(s){return dr(s,i(kn)),kn.result()},o.measure=function(s){return dr(s,i(ya)),ya.result()},o.bounds=function(s){return dr(s,i(hs)),hs.result()},o.centroid=function(s){return dr(s,i(Nt)),Nt.result()},o.projection=function(s){return arguments.length?(i=s==null?(e=null,Xc):(e=s).stream,o):e},o.context=function(s){return arguments.length?(a=s==null?(t=null,new Zh(n)):new G0(t=s),typeof r!="function"&&a.pointRadius(r),o):t},o.pointRadius=function(s){return arguments.length?(r=typeof s=="function"?s:(a.pointRadius(+s),+s),o):r},o.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);n=l}return t===null&&(a=new Zh(n)),o},o.projection(e).digits(n).context(t)}function iu(e){return{stream:Js(e)}}function Js(e){return function(t){var n=new au;for(var r in e)n[r]=e[r];return n.stream=t,n}}function au(){}au.prototype={constructor:au,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function af(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),dr(n,e.stream(hs)),t(hs.result()),r!=null&&e.clipExtent(r),e}function of(e,t,n){return af(e,function(r){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,l=+t[0][1]+(a-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,l])},n)}function V0(e,t,n){return of(e,[[0,0],t],n)}function j0(e,t,n){return af(e,function(r){var i=+t,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([o,s])},n)}function Y0(e,t,n){return af(e,function(r){var i=+t,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],s=(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,s])},n)}var Jh=16,L7=ve(30*De);function Qh(e,t){return+t?O7(e,t):B7(e)}function B7(e){return Js({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function O7(e,t){function n(r,i,a,o,s,l,c,u,d,f,h,m,p,_){var w=c-r,g=u-i,E=w*w+g*g;if(E>4*t&&p--){var v=o+f,x=s+h,y=l+m,M=gt(v*v+x*x+y*y),A=Dt(y/=M),S=Ce(Ce(y)-1)<ge||Ce(a-d)<ge?(a+d)/2:On(x,v),$=e(S,A),C=$[0],k=$[1],B=C-r,G=k-i,T=g*B-w*G;(T*T/E>t||Ce((w*B+g*G)/E-.5)>.3||o*f+s*h+l*m<L7)&&(n(r,i,a,o,s,l,C,k,S,v/=M,x/=M,y,p,_),_.point(C,k),n(C,k,S,v,x,y,c,u,d,f,h,m,p,_))}}return function(r){var i,a,o,s,l,c,u,d,f,h,m,p,_={point:w,lineStart:g,lineEnd:v,polygonStart:function(){r.polygonStart(),_.lineStart=x},polygonEnd:function(){r.polygonEnd(),_.lineStart=g}};function w(A,S){A=e(A,S),r.point(A[0],A[1])}function g(){d=NaN,_.point=E,r.lineStart()}function E(A,S){var $=hi([A,S]),C=e(A,S);n(d,f,u,h,m,p,d=C[0],f=C[1],u=A,h=$[0],m=$[1],p=$[2],Jh,r),r.point(d,f)}function v(){_.point=w,r.lineEnd()}function x(){g(),_.point=y,_.lineEnd=M}function y(A,S){E(i=A,S),a=d,o=f,s=h,l=m,c=p,_.point=E}function M(){n(d,f,u,h,m,p,a,o,i,s,l,c,Jh,r),_.lineEnd=v,v()}return _}}var F7=Js({point:function(e,t){this.stream.point(e*De,t*De)}});function G7(e){return Js({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function U7(e,t,n,r,i){function a(o,s){return o*=r,s*=i,[t+e*o,n-e*s]}return a.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},a}function ed(e,t,n,r,i,a){if(!a)return U7(e,t,n,r,i);var o=ve(a),s=pe(a),l=o*e,c=s*e,u=o/e,d=s/e,f=(s*n-o*t)/e,h=(s*t+o*n)/e;function m(p,_){return p*=r,_*=i,[l*p-c*_+t,n-c*p-l*_]}return m.invert=function(p,_){return[r*(u*p-d*_+f),i*(h-d*p-u*_)]},m}function or(e){return W0(function(){return e})()}function W0(e){var t,n=150,r=480,i=250,a=0,o=0,s=0,l=0,c=0,u,d=0,f=1,h=1,m=null,p=Vh,_=null,w,g,E,v=Xc,x=.5,y,M,A,S,$;function C(T){return A(T[0]*De,T[1]*De)}function k(T){return T=A.invert(T[0],T[1]),T&&[T[0]*ct,T[1]*ct]}C.stream=function(T){return S&&$===T?S:S=F7(G7(u)(p(y(v($=T)))))},C.preclip=function(T){return arguments.length?(p=T,m=void 0,G()):p},C.postclip=function(T){return arguments.length?(v=T,_=w=g=E=null,G()):v},C.clipAngle=function(T){return arguments.length?(p=+T?x7(m=T*De):(m=null,Vh),G()):m*ct},C.clipExtent=function(T){return arguments.length?(v=T==null?(_=w=g=E=null,Xc):I0(_=+T[0][0],w=+T[0][1],g=+T[1][0],E=+T[1][1]),G()):_==null?null:[[_,w],[g,E]]},C.scale=function(T){return arguments.length?(n=+T,B()):n},C.translate=function(T){return arguments.length?(r=+T[0],i=+T[1],B()):[r,i]},C.center=function(T){return arguments.length?(a=T[0]%360*De,o=T[1]%360*De,B()):[a*ct,o*ct]},C.rotate=function(T){return arguments.length?(s=T[0]%360*De,l=T[1]%360*De,c=T.length>2?T[2]%360*De:0,B()):[s*ct,l*ct,c*ct]},C.angle=function(T){return arguments.length?(d=T%360*De,B()):d*ct},C.reflectX=function(T){return arguments.length?(f=T?-1:1,B()):f<0},C.reflectY=function(T){return arguments.length?(h=T?-1:1,B()):h<0},C.precision=function(T){return arguments.length?(y=Qh(M,x=T*T),G()):gt(x)},C.fitExtent=function(T,I){return of(C,T,I)},C.fitSize=function(T,I){return V0(C,T,I)},C.fitWidth=function(T,I){return j0(C,T,I)},C.fitHeight=function(T,I){return Y0(C,T,I)};function B(){var T=ed(n,0,0,f,h,d).apply(null,t(a,o)),I=ed(n,r-T[0],i-T[1],f,h,d);return u=C0(s,l,c),M=Yc(t,I),A=Yc(u,M),y=Qh(M,x),G()}function G(){return S=$=null,C}return function(){return t=e.apply(this,arguments),C.invert=t.invert&&k,B()}}function sf(e){var t=0,n=Me/3,r=W0(e),i=r(t,n);return i.parallels=function(a){return arguments.length?r(t=a[0]*De,n=a[1]*De):[t*ct,n*ct]},i}function q7(e){var t=ve(e);function n(r,i){return[r*t,pe(i)/t]}return n.invert=function(r,i){return[r/t,Dt(i*t)]},n}function H7(e,t){var n=pe(e),r=(n+pe(t))/2;if(Ce(r)<ge)return q7(e);var i=1+n*(2*r-n),a=gt(i)/r;function o(s,l){var c=gt(i-2*r*pe(l))/r;return[c*pe(s*=r),a-c*ve(s)]}return o.invert=function(s,l){var c=a-l,u=On(s,Ce(c))*Ct(c);return c*r<0&&(u-=Me*Ct(s)*Ct(c)),[u/r,Dt((i-(s*s+c*c)*r*r)/(2*r))]},o}function bs(){return sf(H7).scale(155.424).center([0,33.6442])}function X0(){return bs().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function z7(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function V7(){var e,t,n=X0(),r,i=bs().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=bs().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,l,c={point:function(f,h){l=[f,h]}};function u(f){var h=f[0],m=f[1];return l=null,r.point(h,m),l||(a.point(h,m),l)||(s.point(h,m),l)}u.invert=function(f){var h=n.scale(),m=n.translate(),p=(f[0]-m[0])/h,_=(f[1]-m[1])/h;return(_>=.12&&_<.234&&p>=-.425&&p<-.214?i:_>=.166&&_<.234&&p>=-.214&&p<-.115?o:n).invert(f)},u.stream=function(f){return e&&t===f?e:e=z7([n.stream(t=f),i.stream(f),o.stream(f)])},u.precision=function(f){return arguments.length?(n.precision(f),i.precision(f),o.precision(f),d()):n.precision()},u.scale=function(f){return arguments.length?(n.scale(f),i.scale(f*.35),o.scale(f),u.translate(n.translate())):n.scale()},u.translate=function(f){if(!arguments.length)return n.translate();var h=n.scale(),m=+f[0],p=+f[1];return r=n.translate(f).clipExtent([[m-.455*h,p-.238*h],[m+.455*h,p+.238*h]]).stream(c),a=i.translate([m-.307*h,p+.201*h]).clipExtent([[m-.425*h+ge,p+.12*h+ge],[m-.214*h-ge,p+.234*h-ge]]).stream(c),s=o.translate([m-.205*h,p+.212*h]).clipExtent([[m-.214*h+ge,p+.166*h+ge],[m-.115*h-ge,p+.234*h-ge]]).stream(c),d()},u.fitExtent=function(f,h){return of(u,f,h)},u.fitSize=function(f,h){return V0(u,f,h)},u.fitWidth=function(f,h){return j0(u,f,h)},u.fitHeight=function(f,h){return Y0(u,f,h)};function d(){return e=t=null,u}return u.scale(1070)}function K0(e){return function(t,n){var r=ve(t),i=ve(n),a=e(r*i);return a===1/0?[2,0]:[a*i*pe(t),a*pe(n)]}}function Ha(e){return function(t,n){var r=gt(t*t+n*n),i=e(r),a=pe(i),o=ve(i);return[On(t*a,r*o),Dt(r&&n*a/r)]}}var Z0=K0(function(e){return gt(2/(1+e))});Z0.invert=Ha(function(e){return 2*Dt(e/2)});function j7(){return or(Z0).scale(124.75).clipAngle(180-.001)}var J0=K0(function(e){return(e=N0(e))&&e/pe(e)});J0.invert=Ha(function(e){return e});function Y7(){return or(J0).scale(79.4188).clipAngle(180-.001)}function Qs(e,t){return[e,ss(nf((Re+t)/2))]}Qs.invert=function(e,t){return[e,2*Ai(P0(t))-Re]};function W7(){return Q0(Qs).scale(961/Mt)}function Q0(e){var t=or(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,s,l,c;t.scale=function(d){return arguments.length?(r(d),u()):r()},t.translate=function(d){return arguments.length?(i(d),u()):i()},t.center=function(d){return arguments.length?(n(d),u()):n()},t.clipExtent=function(d){return arguments.length?(d==null?o=s=l=c=null:(o=+d[0][0],s=+d[0][1],l=+d[1][0],c=+d[1][1]),u()):o==null?null:[[o,s],[l,c]]};function u(){var d=Me*r(),f=t(p7(t.rotate()).invert([0,0]));return a(o==null?[[f[0]-d,f[1]-d],[f[0]+d,f[1]+d]]:e===Qs?[[Math.max(f[0]-d,o),s],[Math.min(f[0]+d,l),c]]:[[o,Math.max(f[1]-d,s)],[l,Math.min(f[1]+d,c)]])}return u()}function xo(e){return nf((Re+e)/2)}function X7(e,t){var n=ve(e),r=e===t?pe(e):ss(n/ve(t))/ss(xo(t)/xo(e)),i=n*Hl(xo(e),r)/r;if(!r)return Qs;function a(o,s){i>0?s<-Re+ge&&(s=-Re+ge):s>Re-ge&&(s=Re-ge);var l=i/Hl(xo(s),r);return[l*pe(r*o),i-l*ve(r*o)]}return a.invert=function(o,s){var l=i-s,c=Ct(r)*gt(o*o+l*l),u=On(o,Ce(l))*Ct(l);return l*r<0&&(u-=Me*Ct(o)*Ct(l)),[u/r,2*Ai(Hl(i/c,1/r))-Re]},a}function K7(){return sf(X7).scale(109.5).parallels([30,30])}function gs(e,t){return[e,t]}gs.invert=gs;function Z7(){return or(gs).scale(152.63)}function J7(e,t){var n=ve(e),r=e===t?pe(e):(n-ve(t))/(t-e),i=n/r+e;if(Ce(r)<ge)return gs;function a(o,s){var l=i-s,c=r*o;return[l*pe(c),i-l*ve(c)]}return a.invert=function(o,s){var l=i-s,c=On(o,Ce(l))*Ct(l);return l*r<0&&(c-=Me*Ct(o)*Ct(l)),[c/r,i-Ct(r)*gt(o*o+l*l)]},a}function Q7(){return sf(J7).scale(131.154).center([0,13.9389])}var na=1.340264,ra=-.081106,ia=893e-6,aa=.003796,ys=gt(3)/2,e6=12;function ep(e,t){var n=Dt(ys*pe(t)),r=n*n,i=r*r*r;return[e*ve(n)/(ys*(na+3*ra*r+i*(7*ia+9*aa*r))),n*(na+ra*r+i*(ia+aa*r))]}ep.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,a=0,o,s,l;a<e6&&(s=n*(na+ra*r+i*(ia+aa*r))-t,l=na+3*ra*r+i*(7*ia+9*aa*r),n-=o=s/l,r=n*n,i=r*r*r,!(Ce(o)<A0));++a);return[ys*e*(na+3*ra*r+i*(7*ia+9*aa*r))/ve(n),Dt(pe(n)/ys)]};function t6(){return or(ep).scale(177.158)}function tp(e,t){var n=ve(t),r=ve(e)*n;return[n*pe(e)/r,pe(t)/r]}tp.invert=Ha(Ai);function n6(){return or(tp).scale(144.049).clipAngle(60)}function np(e,t){return[ve(t)*pe(e),pe(t)]}np.invert=Ha(Dt);function r6(){return or(np).scale(249.5).clipAngle(90+ge)}function rp(e,t){var n=ve(t),r=1+ve(e)*n;return[n*pe(e)/r,pe(t)/r]}rp.invert=Ha(function(e){return 2*Ai(e)});function i6(){return or(rp).scale(250).clipAngle(142)}function ip(e,t){return[ss(nf((Re+t)/2)),-e]}ip.invert=function(e,t){return[-t,2*Ai(P0(e))-Re]};function a6(){var e=Q0(ip),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function wn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function el(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const ou=Symbol("implicit");function lf(){var e=new Mr,t=[],n=[],r=ou;function i(a){let o=e.get(a);if(o===void 0){if(r!==ou)return r;e.set(a,o=t.push(a)-1)}return n[o%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Mr;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return lf(t,n).unknown(r)},wn.apply(i,arguments),i}function tl(){var e=lf().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,a,o,s=!1,l=0,c=0,u=.5;delete e.unknown;function d(){var f=t().length,h=i<r,m=h?i:r,p=h?r:i;a=(p-m)/Math.max(1,f-l+c*2),s&&(a=Math.floor(a)),m+=(p-m-a*(f-l))*u,o=a*(1-l),s&&(m=Math.round(m),o=Math.round(o));var _=we(f).map(function(w){return m+a*w});return n(h?_.reverse():_)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},e.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,s=!0,d()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(f){return arguments.length?(s=!!f,d()):s},e.padding=function(f){return arguments.length?(l=Math.min(1,c=+f),d()):l},e.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),d()):l},e.paddingOuter=function(f){return arguments.length?(c=+f,d()):c},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},e.copy=function(){return tl(t(),[r,i]).round(s).paddingInner(l).paddingOuter(c).align(u)},wn.apply(d(),arguments)}function ap(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ap(t())},e}function o6(){return ap(tl.apply(null,arguments).paddingInner(1))}function s6(e){return function(){return e}}function su(e){return+e}var td=[0,1];function $t(e){return e}function lu(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:s6(isNaN(t)?NaN:.5)}function l6(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function c6(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=lu(i,r),a=n(o,a)):(r=lu(r,i),a=n(a,o)),function(s){return a(r(s))}}function u6(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=lu(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(s){var l=qs(e,s,1,r)-1;return a[l](i[l](s))}}function za(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function nl(){var e=td,t=td,n=qa,r,i,a,o=$t,s,l,c;function u(){var f=Math.min(e.length,t.length);return o!==$t&&(o=l6(e[0],e[f-1])),s=f>2?u6:c6,l=c=null,d}function d(f){return f==null||isNaN(f=+f)?a:(l||(l=s(e.map(r),t,n)))(r(o(f)))}return d.invert=function(f){return o(i((c||(c=s(t,e.map(r),rt)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,su),u()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=Ku,u()},d.clamp=function(f){return arguments.length?(o=f?!0:$t,u()):o!==$t},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(a=f,d):a},function(f,h){return r=f,i=h,u()}}function op(){return nl()($t,$t)}function f6(e,t,n,r){var i=$c(e,t,n),a;switch(r=ba(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=d7(i,o))&&(r.precision=a),S0(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=m7(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=h7(i))&&(r.precision=a-(r.type==="%")*2);break}}return Si(r)}function Va(e){var t=e.domain;return e.ticks=function(n){var r=t();return ha(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return f6(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],l,c,u=10;for(s<o&&(c=o,o=s,s=c,c=i,i=a,a=c);u-- >0;){if(c=oi(o,s,n),c===l)return r[i]=o,r[a]=s,t(r);if(c>0)o=Math.floor(o/c)*c,s=Math.ceil(s/c)*c;else if(c<0)o=Math.ceil(o*c)/c,s=Math.floor(s*c)/c;else break;l=c}return e},e}function cf(){var e=op();return e.copy=function(){return za(e,cf())},wn.apply(e,arguments),Va(e)}function sp(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,su),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return sp(e).unknown(t)},e=arguments.length?Array.from(e,su):[0,1],Va(n)}function lp(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function nd(e){return Math.log(e)}function rd(e){return Math.exp(e)}function h6(e){return-Math.log(-e)}function d6(e){return-Math.exp(-e)}function m6(e){return isFinite(e)?+("1e"+e):e<0?0:e}function p6(e){return e===10?m6:e===Math.E?Math.exp:t=>Math.pow(e,t)}function b6(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function id(e){return(t,n)=>-e(-t,n)}function cp(e){const t=e(nd,rd),n=t.domain;let r=10,i,a;function o(){return i=b6(r),a=p6(r),n()[0]<0?(i=id(i),a=id(a),e(h6,d6)):e(nd,rd),t}return t.base=function(s){return arguments.length?(r=+s,o()):r},t.domain=function(s){return arguments.length?(n(s),o()):n()},t.ticks=s=>{const l=n();let c=l[0],u=l[l.length-1];const d=u<c;d&&([c,u]=[u,c]);let f=i(c),h=i(u),m,p;const _=s==null?10:+s;let w=[];if(!(r%1)&&h-f<_){if(f=Math.floor(f),h=Math.ceil(h),c>0){for(;f<=h;++f)for(m=1;m<r;++m)if(p=f<0?m/a(-f):m*a(f),!(p<c)){if(p>u)break;w.push(p)}}else for(;f<=h;++f)for(m=r-1;m>=1;--m)if(p=f>0?m/a(-f):m*a(f),!(p<c)){if(p>u)break;w.push(p)}w.length*2<_&&(w=ha(c,u,_))}else w=ha(f,h,Math.min(h-f,_)).map(a);return d?w.reverse():w},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=ba(l)).precision==null&&(l.trim=!0),l=Si(l)),s===1/0)return l;const c=Math.max(1,r*s/t.ticks().length);return u=>{let d=u/a(Math.round(i(u)));return d*r<r-.5&&(d*=r),d<=c?l(u):""}},t.nice=()=>n(lp(n(),{floor:s=>a(Math.floor(i(s))),ceil:s=>a(Math.ceil(i(s)))})),t}function up(){const e=cp(nl()).domain([1,10]);return e.copy=()=>za(e,up()).base(e.base()),wn.apply(e,arguments),e}function ad(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function od(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function fp(e){var t=1,n=e(ad(t),od(t));return n.constant=function(r){return arguments.length?e(ad(t=+r),od(t)):t},Va(n)}function hp(){var e=fp(nl());return e.copy=function(){return za(e,hp()).constant(e.constant())},wn.apply(e,arguments)}function sd(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function g6(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function y6(e){return e<0?-e*e:e*e}function dp(e){var t=e($t,$t),n=1;function r(){return n===1?e($t,$t):n===.5?e(g6,y6):e(sd(n),sd(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Va(t)}function mp(){var e=dp(nl());return e.copy=function(){return za(e,mp()).exponent(e.exponent())},wn.apply(e,arguments),e}function pp(){var e=[],t=[],n=[],r;function i(){var o=0,s=Math.max(1,t.length);for(n=new Array(s-1);++o<s;)n[o-1]=hw(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:t[qs(n,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(pt),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return pp().domain(e).range(t).unknown(r)},wn.apply(a,arguments)}function bp(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[qs(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return bp().domain(e).range(t).unknown(n)},wn.apply(i,arguments)}const Wl=new Date,Xl=new Date;function ze(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,s)=>{const l=[];if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return l;let c;do l.push(c=new Date(+a)),t(a,s),e(a);while(c<a&&a<o);return l},i.filter=a=>ze(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););}),n&&(i.count=(a,o)=>(Wl.setTime(+a),Xl.setTime(+o),e(Wl),e(Xl),Math.floor(n(Wl,Xl))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?o=>r(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const _s=ze(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);_s.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ze(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):_s);_s.range;const Dn=1e3,kt=Dn*60,Rn=kt*60,Fn=Rn*24,uf=Fn*7,ld=Fn*30,Kl=Fn*365,zt=ze(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Dn)},(e,t)=>(t-e)/Dn,e=>e.getUTCSeconds());zt.range;const ja=ze(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Dn)},(e,t)=>{e.setTime(+e+t*kt)},(e,t)=>(t-e)/kt,e=>e.getMinutes());ja.range;const Ya=ze(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*kt)},(e,t)=>(t-e)/kt,e=>e.getUTCMinutes());Ya.range;const Wa=ze(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Dn-e.getMinutes()*kt)},(e,t)=>{e.setTime(+e+t*Rn)},(e,t)=>(t-e)/Rn,e=>e.getHours());Wa.range;const Xa=ze(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Rn)},(e,t)=>(t-e)/Rn,e=>e.getUTCHours());Xa.range;const Ir=ze(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*kt)/Fn,e=>e.getDate()-1);Ir.range;const rl=ze(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fn,e=>e.getUTCDate()-1);rl.range;const il=ze(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fn,e=>Math.floor(e/Fn));il.range;function Dr(e){return ze(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*kt)/uf)}const mi=Dr(0),_a=Dr(1),gp=Dr(2),yp=Dr(3),Nr=Dr(4),_p=Dr(5),wp=Dr(6);mi.range;_a.range;gp.range;yp.range;Nr.range;_p.range;wp.range;function Rr(e){return ze(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/uf)}const pi=Rr(0),wa=Rr(1),vp=Rr(2),Mp=Rr(3),Cr=Rr(4),xp=Rr(5),Ep=Rr(6);pi.range;wa.range;vp.range;Mp.range;Cr.range;xp.range;Ep.range;const Ka=ze(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ka.range;const Za=ze(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Za.range;const Zt=ze(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Zt.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ze(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Zt.range;const Jt=ze(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Jt.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ze(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Jt.range;function Sp(e,t,n,r,i,a){const o=[[zt,1,Dn],[zt,5,5*Dn],[zt,15,15*Dn],[zt,30,30*Dn],[a,1,kt],[a,5,5*kt],[a,15,15*kt],[a,30,30*kt],[i,1,Rn],[i,3,3*Rn],[i,6,6*Rn],[i,12,12*Rn],[r,1,Fn],[r,2,2*Fn],[n,1,uf],[t,1,ld],[t,3,3*ld],[e,1,Kl]];function s(c,u,d){const f=u<c;f&&([c,u]=[u,c]);const h=d&&typeof d.range=="function"?d:l(c,u,d),m=h?h.range(c,+u+1):[];return f?m.reverse():m}function l(c,u,d){const f=Math.abs(u-c)/d,h=Us(([,,_])=>_).right(o,f);if(h===o.length)return e.every($c(c/Kl,u/Kl,d));if(h===0)return _s.every(Math.max($c(c,u,d),1));const[m,p]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return m.every(p)}return[s,l]}const[_6,w6]=Sp(Jt,Za,pi,il,Xa,Ya),[v6,M6]=Sp(Zt,Ka,mi,Ir,Wa,ja);function Zl(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Jl(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Di(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function x6(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=Ri(i),u=Li(i),d=Ri(a),f=Li(a),h=Ri(o),m=Li(o),p=Ri(s),_=Li(s),w=Ri(l),g=Li(l),E={a:O,A:q,b:z,B:H,c:null,d:md,e:md,f:j6,g:n4,G:i4,H:H6,I:z6,j:V6,L:Ap,m:Y6,M:W6,p:J,q:Z,Q:gd,s:yd,S:X6,u:K6,U:Z6,V:J6,w:Q6,W:e4,x:null,X:null,y:t4,Y:r4,Z:a4,"%":bd},v={a:F,A:te,b:ne,B:re,c:null,d:pd,e:pd,f:c4,g:_4,G:v4,H:o4,I:s4,j:l4,L:Np,m:u4,M:f4,p:Q,q:Y,Q:gd,s:yd,S:h4,u:d4,U:m4,V:p4,w:b4,W:g4,x:null,X:null,y:y4,Y:w4,Z:M4,"%":bd},x={a:$,A:C,b:k,B,c:G,d:hd,e:hd,f:F6,g:fd,G:ud,H:dd,I:dd,j:R6,L:O6,m:D6,M:L6,p:S,q:I6,Q:U6,s:q6,S:B6,u:N6,U:C6,V:T6,w:P6,W:$6,x:T,X:I,y:fd,Y:ud,Z:k6,"%":G6};E.x=y(n,E),E.X=y(r,E),E.c=y(t,E),v.x=y(n,v),v.X=y(r,v),v.c=y(t,v);function y(R,V){return function(W){var U=[],fe=-1,ue=0,ie=R.length,he,le,je;for(W instanceof Date||(W=new Date(+W));++fe<ie;)R.charCodeAt(fe)===37&&(U.push(R.slice(ue,fe)),(le=cd[he=R.charAt(++fe)])!=null?he=R.charAt(++fe):le=he==="e"?" ":"0",(je=V[he])&&(he=je(W,le)),U.push(he),ue=fe+1);return U.push(R.slice(ue,fe)),U.join("")}}function M(R,V){return function(W){var U=Di(1900,void 0,1),fe=A(U,R,W+="",0),ue,ie;if(fe!=W.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(V&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(ue=Jl(Di(U.y,0,1)),ie=ue.getUTCDay(),ue=ie>4||ie===0?wa.ceil(ue):wa(ue),ue=rl.offset(ue,(U.V-1)*7),U.y=ue.getUTCFullYear(),U.m=ue.getUTCMonth(),U.d=ue.getUTCDate()+(U.w+6)%7):(ue=Zl(Di(U.y,0,1)),ie=ue.getDay(),ue=ie>4||ie===0?_a.ceil(ue):_a(ue),ue=Ir.offset(ue,(U.V-1)*7),U.y=ue.getFullYear(),U.m=ue.getMonth(),U.d=ue.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),ie="Z"in U?Jl(Di(U.y,0,1)).getUTCDay():Zl(Di(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(ie+5)%7:U.w+U.U*7-(ie+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,Jl(U)):Zl(U)}}function A(R,V,W,U){for(var fe=0,ue=V.length,ie=W.length,he,le;fe<ue;){if(U>=ie)return-1;if(he=V.charCodeAt(fe++),he===37){if(he=V.charAt(fe++),le=x[he in cd?V.charAt(fe++):he],!le||(U=le(R,W,U))<0)return-1}else if(he!=W.charCodeAt(U++))return-1}return U}function S(R,V,W){var U=c.exec(V.slice(W));return U?(R.p=u.get(U[0].toLowerCase()),W+U[0].length):-1}function $(R,V,W){var U=h.exec(V.slice(W));return U?(R.w=m.get(U[0].toLowerCase()),W+U[0].length):-1}function C(R,V,W){var U=d.exec(V.slice(W));return U?(R.w=f.get(U[0].toLowerCase()),W+U[0].length):-1}function k(R,V,W){var U=w.exec(V.slice(W));return U?(R.m=g.get(U[0].toLowerCase()),W+U[0].length):-1}function B(R,V,W){var U=p.exec(V.slice(W));return U?(R.m=_.get(U[0].toLowerCase()),W+U[0].length):-1}function G(R,V,W){return A(R,t,V,W)}function T(R,V,W){return A(R,n,V,W)}function I(R,V,W){return A(R,r,V,W)}function O(R){return o[R.getDay()]}function q(R){return a[R.getDay()]}function z(R){return l[R.getMonth()]}function H(R){return s[R.getMonth()]}function J(R){return i[+(R.getHours()>=12)]}function Z(R){return 1+~~(R.getMonth()/3)}function F(R){return o[R.getUTCDay()]}function te(R){return a[R.getUTCDay()]}function ne(R){return l[R.getUTCMonth()]}function re(R){return s[R.getUTCMonth()]}function Q(R){return i[+(R.getUTCHours()>=12)]}function Y(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var V=y(R+="",E);return V.toString=function(){return R},V},parse:function(R){var V=M(R+="",!1);return V.toString=function(){return R},V},utcFormat:function(R){var V=y(R+="",v);return V.toString=function(){return R},V},utcParse:function(R){var V=M(R+="",!0);return V.toString=function(){return R},V}}}var cd={"-":"",_:" ",0:"0"},Je=/^\s*\d+/,E6=/^%/,S6=/[\\^$*+?|[\]().{}]/g;function Pe(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function A6(e){return e.replace(S6,"\\$&")}function Ri(e){return new RegExp("^(?:"+e.map(A6).join("|")+")","i")}function Li(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function P6(e,t,n){var r=Je.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function N6(e,t,n){var r=Je.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function C6(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function T6(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function $6(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function ud(e,t,n){var r=Je.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function fd(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function k6(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function I6(e,t,n){var r=Je.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function D6(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function hd(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function R6(e,t,n){var r=Je.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function dd(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function L6(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function B6(e,t,n){var r=Je.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function O6(e,t,n){var r=Je.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function F6(e,t,n){var r=Je.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function G6(e,t,n){var r=E6.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function U6(e,t,n){var r=Je.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function q6(e,t,n){var r=Je.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function md(e,t){return Pe(e.getDate(),t,2)}function H6(e,t){return Pe(e.getHours(),t,2)}function z6(e,t){return Pe(e.getHours()%12||12,t,2)}function V6(e,t){return Pe(1+Ir.count(Zt(e),e),t,3)}function Ap(e,t){return Pe(e.getMilliseconds(),t,3)}function j6(e,t){return Ap(e,t)+"000"}function Y6(e,t){return Pe(e.getMonth()+1,t,2)}function W6(e,t){return Pe(e.getMinutes(),t,2)}function X6(e,t){return Pe(e.getSeconds(),t,2)}function K6(e){var t=e.getDay();return t===0?7:t}function Z6(e,t){return Pe(mi.count(Zt(e)-1,e),t,2)}function Pp(e){var t=e.getDay();return t>=4||t===0?Nr(e):Nr.ceil(e)}function J6(e,t){return e=Pp(e),Pe(Nr.count(Zt(e),e)+(Zt(e).getDay()===4),t,2)}function Q6(e){return e.getDay()}function e4(e,t){return Pe(_a.count(Zt(e)-1,e),t,2)}function t4(e,t){return Pe(e.getFullYear()%100,t,2)}function n4(e,t){return e=Pp(e),Pe(e.getFullYear()%100,t,2)}function r4(e,t){return Pe(e.getFullYear()%1e4,t,4)}function i4(e,t){var n=e.getDay();return e=n>=4||n===0?Nr(e):Nr.ceil(e),Pe(e.getFullYear()%1e4,t,4)}function a4(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pe(t/60|0,"0",2)+Pe(t%60,"0",2)}function pd(e,t){return Pe(e.getUTCDate(),t,2)}function o4(e,t){return Pe(e.getUTCHours(),t,2)}function s4(e,t){return Pe(e.getUTCHours()%12||12,t,2)}function l4(e,t){return Pe(1+rl.count(Jt(e),e),t,3)}function Np(e,t){return Pe(e.getUTCMilliseconds(),t,3)}function c4(e,t){return Np(e,t)+"000"}function u4(e,t){return Pe(e.getUTCMonth()+1,t,2)}function f4(e,t){return Pe(e.getUTCMinutes(),t,2)}function h4(e,t){return Pe(e.getUTCSeconds(),t,2)}function d4(e){var t=e.getUTCDay();return t===0?7:t}function m4(e,t){return Pe(pi.count(Jt(e)-1,e),t,2)}function Cp(e){var t=e.getUTCDay();return t>=4||t===0?Cr(e):Cr.ceil(e)}function p4(e,t){return e=Cp(e),Pe(Cr.count(Jt(e),e)+(Jt(e).getUTCDay()===4),t,2)}function b4(e){return e.getUTCDay()}function g4(e,t){return Pe(wa.count(Jt(e)-1,e),t,2)}function y4(e,t){return Pe(e.getUTCFullYear()%100,t,2)}function _4(e,t){return e=Cp(e),Pe(e.getUTCFullYear()%100,t,2)}function w4(e,t){return Pe(e.getUTCFullYear()%1e4,t,4)}function v4(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Cr(e):Cr.ceil(e),Pe(e.getUTCFullYear()%1e4,t,4)}function M4(){return"+0000"}function bd(){return"%"}function gd(e){return+e}function yd(e){return Math.floor(+e/1e3)}var Gr,ff,Ja;x4({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function x4(e){return Gr=x6(e),ff=Gr.format,Gr.parse,Ja=Gr.utcFormat,Gr.utcParse,Gr}function E4(e){return new Date(e)}function S4(e){return e instanceof Date?+e:+new Date(+e)}function hf(e,t,n,r,i,a,o,s,l,c){var u=op(),d=u.invert,f=u.domain,h=c(".%L"),m=c(":%S"),p=c("%I:%M"),_=c("%I %p"),w=c("%a %d"),g=c("%b %d"),E=c("%B"),v=c("%Y");function x(y){return(l(y)<y?h:s(y)<y?m:o(y)<y?p:a(y)<y?_:r(y)<y?i(y)<y?w:g:n(y)<y?E:v)(y)}return u.invert=function(y){return new Date(d(y))},u.domain=function(y){return arguments.length?f(Array.from(y,S4)):f().map(E4)},u.ticks=function(y){var M=f();return e(M[0],M[M.length-1],y??10)},u.tickFormat=function(y,M){return M==null?x:c(M)},u.nice=function(y){var M=f();return(!y||typeof y.range!="function")&&(y=t(M[0],M[M.length-1],y??10)),y?f(lp(M,y)):u},u.copy=function(){return za(u,hf(e,t,n,r,i,a,o,s,l,c))},u}function A4(){return wn.apply(hf(v6,M6,Zt,Ka,mi,Ir,Wa,ja,zt,ff).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function P4(){return wn.apply(hf(_6,w6,Jt,Za,pi,rl,Xa,Ya,zt,Ja).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function al(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ol(){var e=0,t=.5,n=1,r=1,i,a,o,s,l,c=$t,u,d=!1,f;function h(p){return isNaN(p=+p)?f:(p=.5+((p=+u(p))-a)*(r*p<r*a?s:l),c(d?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,i=u(e=+e),a=u(t=+t),o=u(n=+n),s=i===a?0:.5/(a-i),l=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(d=!!p,h):d},h.interpolator=function(p){return arguments.length?(c=p,h):c};function m(p){return function(_){var w,g,E;return arguments.length?([w,g,E]=_,c=Xs(p,[w,g,E]),h):[c(0),c(.5),c(1)]}}return h.range=m(qa),h.rangeRound=m(Ku),h.unknown=function(p){return arguments.length?(f=p,h):f},function(p){return u=p,i=p(e),a=p(t),o=p(n),s=i===a?0:.5/(a-i),l=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function Tp(){var e=Va(ol()($t));return e.copy=function(){return al(e,Tp())},el.apply(e,arguments)}function $p(){var e=cp(ol()).domain([.1,1,10]);return e.copy=function(){return al(e,$p()).base(e.base())},el.apply(e,arguments)}function kp(){var e=fp(ol());return e.copy=function(){return al(e,kp()).constant(e.constant())},el.apply(e,arguments)}function Ip(){var e=dp(ol());return e.copy=function(){return al(e,Ip()).exponent(e.exponent())},el.apply(e,arguments)}function be(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const N4=be("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),C4=be("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),T4=be("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),$4=be("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),k4=be("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),I4=be("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),D4=be("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),R4=be("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),L4=be("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),B4=be("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),O4=be("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),$e=e=>A3(e[e.length-1]);var Dp=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(be);const Rp=$e(Dp);var Lp=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(be);const Bp=$e(Lp);var Op=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(be);const Fp=$e(Op);var Gp=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(be);const Up=$e(Gp);var cu=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(be);const ws=$e(cu);var qp=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(be);const Hp=$e(qp);var uu=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(be);const va=$e(uu);var zp=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(be);const Vp=$e(zp);var jp=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(be);const Yp=$e(jp);var Wp=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(be);const Xp=$e(Wp);var Kp=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(be);const Zp=$e(Kp);var Jp=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(be);const Qp=$e(Jp);var eb=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(be);const tb=$e(eb);var nb=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(be);const rb=$e(nb);var ib=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(be);const ab=$e(ib);var ob=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(be);const sb=$e(ob);var lb=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(be);const cb=$e(lb);var ub=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(be);const fb=$e(ub);var hb=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(be);const db=$e(hb);var mb=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(be);const pb=$e(mb);var bb=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(be);const gb=$e(bb);var yb=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(be);const _b=$e(yb);var wb=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(be);const vb=$e(wb);var Mb=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(be);const xb=$e(Mb);var Eb=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(be);const Sb=$e(Eb);var Ab=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(be);const Pb=$e(Ab);var Nb=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(be);const Cb=$e(Nb);function Tb(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const $b=Zu(pn(300,.5,0),pn(-240,.5,1));var kb=Zu(pn(-100,.75,.35),pn(80,1.5,.8)),Ib=Zu(pn(260,.75,.35),pn(80,1.5,.8)),Eo=pn();function Db(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Eo.h=360*e-100,Eo.s=1.5-1.5*t,Eo.l=.8-.9*t,Eo+""}var So=er(),F4=Math.PI/3,G4=Math.PI*2/3;function Rb(e){var t;return e=(.5-e)*Math.PI,So.r=255*(t=Math.sin(e))*t,So.g=255*(t=Math.sin(e+F4))*t,So.b=255*(t=Math.sin(e+G4))*t,So+""}function Lb(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function sl(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const Bb=sl(be("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var Ob=sl(be("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Fb=sl(be("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Gb=sl(be("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const Ub=Math.cos,df=Math.min,vs=Math.sin,Ve=Math.sqrt,_d=1e-12,Ms=Math.PI,ll=2*Ms;function qb(e){this._context=e}qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function mf(e){return new qb(e)}class Hb{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function U4(e){return new Hb(e,!0)}function q4(e){return new Hb(e,!1)}const H4=Ve(3),zb={draw(e,t){const n=Ve(t+df(t/28,.75))*.59436,r=n/2,i=r*H4;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},Ma={draw(e,t){const n=Ve(t/Ms);e.moveTo(n,0),e.arc(0,0,n,0,ll)}},Vb={draw(e,t){const n=Ve(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},jb=Ve(1/3),z4=jb*2,Yb={draw(e,t){const n=Ve(t/z4),r=n*jb;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},Wb={draw(e,t){const n=Ve(t)*.62625;e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},Xb={draw(e,t){const n=Ve(t-df(t/7,2))*.87559;e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},Kb={draw(e,t){const n=Ve(t),r=-n/2;e.rect(r,r,n,n)}},Zb={draw(e,t){const n=Ve(t)*.4431;e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},V4=.8908130915292852,Jb=vs(Ms/10)/vs(7*Ms/10),j4=vs(ll/10)*Jb,Y4=-Ub(ll/10)*Jb,Qb={draw(e,t){const n=Ve(t*V4),r=j4*n,i=Y4*n;e.moveTo(0,-n),e.lineTo(r,i);for(let a=1;a<5;++a){const o=ll*a/5,s=Ub(o),l=vs(o);e.lineTo(l*n,-s*n),e.lineTo(s*r-l*i,l*r+s*i)}e.closePath()}},Ql=Ve(3),eg={draw(e,t){const n=-Ve(t/(Ql*3));e.moveTo(0,n*2),e.lineTo(-Ql*n,-n),e.lineTo(Ql*n,-n),e.closePath()}},W4=Ve(3),tg={draw(e,t){const n=Ve(t)*.6824,r=n/2,i=n*W4/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},At=-.5,Pt=Ve(3)/2,fu=1/Ve(12),X4=(fu/2+1)*3,ng={draw(e,t){const n=Ve(t/X4),r=n/2,i=n*fu,a=r,o=n*fu+n,s=-a,l=o;e.moveTo(r,i),e.lineTo(a,o),e.lineTo(s,l),e.lineTo(At*r-Pt*i,Pt*r+At*i),e.lineTo(At*a-Pt*o,Pt*a+At*o),e.lineTo(At*s-Pt*l,Pt*s+At*l),e.lineTo(At*r+Pt*i,At*i-Pt*r),e.lineTo(At*a+Pt*o,At*o-Pt*a),e.lineTo(At*s+Pt*l,At*l-Pt*s),e.closePath()}},rg={draw(e,t){const n=Ve(t-df(t/6,1.7))*.6189;e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},K4=[Ma,Vb,Yb,Kb,Qb,eg,ng],Z4=[Ma,Xb,rg,tg,zb,Zb,Wb];function tr(){}function xs(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function cl(e){this._context=e}cl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:xs(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:xs(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function J4(e){return new cl(e)}function ig(e){this._context=e}ig.prototype={areaStart:tr,areaEnd:tr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:xs(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Q4(e){return new ig(e)}function ag(e){this._context=e}ag.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:xs(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eM(e){return new ag(e)}function og(e,t){this._basis=new cl(e),this._beta=t}og.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,s=-1,l;++s<=n;)l=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+l*a),this._beta*t[s]+(1-this._beta)*(i+l*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const tM=function e(t){function n(r){return t===1?new cl(r):new og(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Es(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function pf(e,t){this._context=e,this._k=(1-t)/6}pf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Es(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Es(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const nM=function e(t){function n(r){return new pf(r,t)}return n.tension=function(r){return e(+r)},n}(0);function bf(e,t){this._context=e,this._k=(1-t)/6}bf.prototype={areaStart:tr,areaEnd:tr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Es(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const rM=function e(t){function n(r){return new bf(r,t)}return n.tension=function(r){return e(+r)},n}(0);function gf(e,t){this._context=e,this._k=(1-t)/6}gf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Es(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const iM=function e(t){function n(r){return new gf(r,t)}return n.tension=function(r){return e(+r)},n}(0);function yf(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>_d){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>_d){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*c+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function sg(e,t){this._context=e,this._alpha=t}sg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:yf(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const aM=function e(t){function n(r){return t?new sg(r,t):new pf(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function lg(e,t){this._context=e,this._alpha=t}lg.prototype={areaStart:tr,areaEnd:tr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:yf(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const oM=function e(t){function n(r){return t?new lg(r,t):new bf(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function cg(e,t){this._context=e,this._alpha=t}cg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:yf(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const sM=function e(t){function n(r){return t?new cg(r,t):new gf(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function ug(e){this._context=e}ug.prototype={areaStart:tr,areaEnd:tr,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function lM(e){return new ug(e)}function wd(e){return e<0?-1:1}function vd(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(wd(a)+wd(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Md(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function ec(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function Ss(e){this._context=e}Ss.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ec(this,this._t0,Md(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ec(this,Md(this,n=vd(this,e,t)),n);break;default:ec(this,this._t0,n=vd(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function fg(e){this._context=new hg(e)}(fg.prototype=Object.create(Ss.prototype)).point=function(e,t){Ss.prototype.point.call(this,t,e)};function hg(e){this._context=e}hg.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function cM(e){return new Ss(e)}function uM(e){return new fg(e)}function dg(e){this._context=e}dg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=xd(e),i=xd(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function xd(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function fM(e){return new dg(e)}function ul(e,t){this._context=e,this._t=t}ul.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function hM(e){return new ul(e,.5)}function dM(e){return new ul(e,0)}function mM(e){return new ul(e,1)}function Wi(e,t,n){this.k=e,this.x=t,this.y=n}Wi.prototype={constructor:Wi,scale:function(e){return e===1?this:new Wi(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Wi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Wi.prototype;function pM(e){return 60*1/e}function mg(e,t){return we(Math.ceil(e/12)*12,t+1,12)}function bM(e,t,n){return e<t?t:e>n?n:e}function gM(e){return new Promise(t=>{setTimeout(t,e*1e3)})}function Ed(e,t){return e.has(t)?e.delete(t):e.add(t),new Set(e)}function Sd(e,t){for(const n of t)if(e.has(n))return!0;return!1}var Bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yM(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pg={exports:{}};(function(e,t){(function(n,r){r()})(Bi,function(){function n(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,u,d){var f=new XMLHttpRequest;f.open("GET",c),f.responseType="blob",f.onload=function(){l(f.response,u,d)},f.onerror=function(){console.error("could not download file")},f.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function a(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Bi=="object"&&Bi.global===Bi?Bi:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(c,u,d){var f=o.URL||o.webkitURL,h=document.createElement("a");u=u||c.name||"download",h.download=u,h.rel="noopener",typeof c=="string"?(h.href=c,h.origin===location.origin?a(h):i(h.href)?r(c,u,d):a(h,h.target="_blank")):(h.href=f.createObjectURL(c),setTimeout(function(){f.revokeObjectURL(h.href)},4e4),setTimeout(function(){a(h)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,d){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(n(c,d),u);else if(i(c))r(c,u,d);else{var f=document.createElement("a");f.href=c,f.target="_blank",setTimeout(function(){a(f)})}}:function(c,u,d,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof c=="string")return r(c,u,d);var h=c.type==="application/octet-stream",m=/constructor/i.test(o.HTMLElement)||o.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||h&&m||s)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var E=_.result;E=p?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=E:location=E,f=null},_.readAsDataURL(c)}else{var w=o.URL||o.webkitURL,g=w.createObjectURL(c);f?f.location=g:location.href=g,f=null,setTimeout(function(){w.revokeObjectURL(g)},4e4)}});o.saveAs=l.saveAs=l,e.exports=l})})(pg);var _M=pg.exports;const Pi=yM(_M);class Vt{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,n,r={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==Vt.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof n!="function")throw new TypeError("The callback must be a function.");const i=new Ad(t,this,n,r);return this.eventMap[t]||(this.eventMap[t]=[]),r.prepend?this.eventMap[t].unshift(i):this.eventMap[t].push(i),i}addOneTimeListener(t,n,r={}){r.remaining=1,this.addListener(t,n,r)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,n){return t===void 0?this.eventMap[Vt.ANY_EVENT]&&this.eventMap[Vt.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,r])=>r.length>0):this.eventMap[t]&&this.eventMap[t].length>0?n instanceof Ad?this.eventMap[t].filter(i=>i===n).length>0:typeof n=="function"?this.eventMap[t].filter(i=>i.callback===n).length>0:n==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(n=>{n.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(n=>{n.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...n){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let r=[],i=this.eventMap[Vt.ANY_EVENT]||[];return this.eventMap[t]&&(i=i.concat(this.eventMap[t])),i.forEach(a=>{if(a.suspended)return;let o=[...n];Array.isArray(a.arguments)&&(o=o.concat(a.arguments)),a.remaining>0&&(r.push(a.callback.apply(a.context,o)),a.count++),--a.remaining<1&&a.remove()}),r}removeListener(t,n,r={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let i=this.eventMap[t].filter(a=>n&&a.callback!==n||r.remaining&&r.remaining!==a.remaining||r.context&&r.context!==a.context);i.length?this.eventMap[t]=i:delete this.eventMap[t]}async waitFor(t,n={}){return n.duration=parseInt(n.duration),(isNaN(n.duration)||n.duration<=0)&&(n.duration=1/0),new Promise((r,i)=>{let a,o=this.addListener(t,()=>{clearTimeout(a),r()},{remaining:1});n.duration!==1/0&&(a=setTimeout(()=>{o.remove(),i("The duration expired before the event was emitted.")},n.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class Ad{constructor(t,n,r,i={}){if(typeof t!="string"&&!(t instanceof String)&&t!==Vt.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!n)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof r!="function")throw new TypeError("The 'callback' must be a function.");i.arguments!==void 0&&!Array.isArray(i.arguments)&&(i.arguments=[i.arguments]),i=Object.assign({context:n,remaining:1/0,arguments:void 0,duration:1/0},i),i.duration!==1/0&&setTimeout(()=>this.remove(),i.duration),this.arguments=i.arguments,this.callback=r,this.context=i.context,this.count=0,this.event=t,this.remaining=parseInt(i.remaining)>=1?parseInt(i.remaining):1/0,this.suspended=!1,this.target=n}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class j{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),j.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),j.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),j.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),j.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class jr{constructor(t,n={}){this.duration=D.defaults.note.duration,this.attack=D.defaults.note.attack,this.release=D.defaults.note.release,n.duration!=null&&(this.duration=n.duration),n.attack!=null&&(this.attack=n.attack),n.rawAttack!=null&&(this.attack=ee.from7bitToFloat(n.rawAttack)),n.release!=null&&(this.release=n.release),n.rawRelease!=null&&(this.release=ee.from7bitToFloat(n.rawRelease)),Number.isInteger(t)?this.identifier=ee.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const n=ee.getNoteDetails(t);if(D.validation&&!t)throw new Error("Invalid note identifier");this._name=n.name,this._accidental=n.accidental,this._octave=n.octave}get name(){return this._name}set name(t){if(D.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(D.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(D.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(D.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(D.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(D.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return ee.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=ee.from7bitToFloat(t)}get rawRelease(){return ee.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=ee.from7bitToFloat(t)}get number(){return ee.toNoteNumber(this.identifier)}getOffsetNumber(t=0,n=0){return D.validation&&(t=parseInt(t)||0,n=parseInt(n)||0),Math.min(Math.max(this.number+t*12+n,0),127)}}/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class ee{static toNoteNumber(t,n=0){if(n=n==null?0:parseInt(n),isNaN(n))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const r=this.getNoteDetails(t);if(!r)throw new TypeError("Invalid note identifier");const i={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let a=(r.octave+1+n)*12;if(a+=i[r.name],r.accidental&&(r.accidental.startsWith("b")?a-=r.accidental.length:a+=r.accidental.length),a<0||a>127)throw new RangeError("Invalid octaveOffset value");return a}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const n=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!n)throw new TypeError("Invalid note identifier");const r=n[1].toUpperCase(),i=parseInt(n[3]);let a=n[2].toLowerCase();return a=a===""?void 0:a,{accidental:a,identifier:r+(a||"")+i,name:r,octave:i}}static sanitizeChannels(t){let n;if(D.validation){if(t==="all")n=["all"];else if(t==="none")return[]}return Array.isArray(t)?n=t:n=[t],n.indexOf("all")>-1&&(n=j.MIDI_CHANNEL_NUMBERS),n.map(function(r){return parseInt(r)}).filter(function(r){return r>=1&&r<=16})}static toTimestamp(t){let n=!1;const r=parseFloat(t);return isNaN(r)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?r>=0&&(n=D.time+r):r>=0&&(n=r),n)}static guessNoteNumber(t,n){n=parseInt(n)||0;let r=!1;if(Number.isInteger(t)&&t>=0&&t<=127)r=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)r=parseInt(t);else if(typeof t=="string"||t instanceof String)try{r=this.toNoteNumber(t.trim(),n)}catch{return!1}return r}static toNoteIdentifier(t,n){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(n=n==null?0:parseInt(n),isNaN(n))throw new RangeError("Invalid octaveOffset value");const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],i=Math.floor(t/12-1)+n;return r[t%12]+i.toString()}static buildNote(t,n={}){if(n.octaveOffset=parseInt(n.octaveOffset)||0,t instanceof jr)return t;let r=this.guessNoteNumber(t,n.octaveOffset);if(r===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return n.octaveOffset=void 0,new jr(r,n)}static buildNoteArray(t,n={}){let r=[];return Array.isArray(t)||(t=[t]),t.forEach(i=>{r.push(this.buildNote(i,n))}),r}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,n=0){D.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),n=Math.min(Math.max(parseInt(n)||0,0),127));const r=((t<<7)+n)/16383;return Math.min(Math.max(r,0),1)}static fromFloatToMsbLsb(t){D.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const n=Math.round(t*16383);return{msb:n>>7,lsb:n&127}}static offsetNumber(t,n=0,r=0){if(D.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");n=parseInt(n)||0,r=parseInt(r)||0}return Math.min(Math.max(t+n*12+r,0),127)}static getPropertyByValue(t,n){return Object.keys(t).find(r=>t[r]===n)}static getCcNameByNumber(t){if(!(D.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return j.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let n=j.CONTROL_CHANGE_MESSAGES.find(r=>r.name===t);return n?n.number:j.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let n in j.CHANNEL_MODE_MESSAGES)if(j.CHANNEL_MODE_MESSAGES.hasOwnProperty(n)&&t===j.CHANNEL_MODE_MESSAGES[n])return n;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class wM extends Vt{constructor(t,n){super(),this._output=t,this._number=n,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,n={time:0}){return this.output.send(t,n),this}sendKeyAftertouch(t,n,r={}){if(D.validation){if(r.useRawValue&&(r.rawValue=r.useRawValue),isNaN(parseFloat(n)))throw new RangeError("Invalid key aftertouch value.");if(r.rawValue){if(!(n>=0&&n<=127&&Number.isInteger(n)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(n>=0&&n<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}r.rawValue||(n=ee.fromFloatTo7Bit(n));const i=D.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),ee.buildNoteArray(t).forEach(a=>{this.send([(j.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),a.getOffsetNumber(i),n],{time:ee.toTimestamp(r.time)})}),this}sendControlChange(t,n,r={}){if(typeof t=="string"&&(t=ee.getCcNumberByName(t)),Array.isArray(n)||(n=[n]),D.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(n=n.map(i=>{const a=Math.min(Math.max(parseInt(i),0),127);if(isNaN(a))throw new TypeError("Values must be integers between 0 and 127");return a}),n.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return n.forEach((i,a)=>{this.send([(j.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+a*32,n[a]],{time:ee.toTimestamp(r.time)})}),this}_selectNonRegisteredParameter(t,n={}){return this.sendControlChange(99,t[0],n),this.sendControlChange(98,t[1],n),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,n={}){return this.sendControlChange(101,t[0],n),this.sendControlChange(100,t[1],n),this}_setCurrentParameter(t,n={}){return t=[].concat(t),this.sendControlChange(6,t[0],n),t.length<2?this:(this.sendControlChange(38,t[1],n),this)}sendRpnDecrement(t,n={}){if(Array.isArray(t)||(t=j.REGISTERED_PARAMETERS[t]),D.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(j.REGISTERED_PARAMETERS).forEach(i=>{j.REGISTERED_PARAMETERS[i][0]===t[0]&&j.REGISTERED_PARAMETERS[i][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,n),this.sendControlChange(97,0,n),this._deselectRegisteredParameter(n),this}sendRpnIncrement(t,n={}){if(Array.isArray(t)||(t=j.REGISTERED_PARAMETERS[t]),D.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(j.REGISTERED_PARAMETERS).forEach(i=>{j.REGISTERED_PARAMETERS[i][0]===t[0]&&j.REGISTERED_PARAMETERS[i][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,n),this.sendControlChange(96,0,n),this._deselectRegisteredParameter(n),this}playNote(t,n={}){this.sendNoteOn(t,n);const r=Array.isArray(t)?t:[t];for(let i of r)if(parseInt(i.duration)>0){const a={time:(ee.toTimestamp(n.time)||D.time)+parseInt(i.duration),release:i.release,rawRelease:i.rawRelease};this.sendNoteOff(i,a)}else if(parseInt(n.duration)>0){const a={time:(ee.toTimestamp(n.time)||D.time)+parseInt(n.duration),release:n.release,rawRelease:n.rawRelease};this.sendNoteOff(i,a)}return this}sendNoteOff(t,n={}){if(D.validation){if(n.rawRelease!=null&&!(n.rawRelease>=0&&n.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(n.release!=null&&!(n.release>=0&&n.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");n.rawVelocity&&(n.rawRelease=n.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),n.velocity&&(n.release=n.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;n.rawRelease!=null?r=n.rawRelease:isNaN(n.release)||(r=Math.round(n.release*127));const i=D.octaveOffset+this.output.octaveOffset+this.octaveOffset;return ee.buildNoteArray(t,{rawRelease:parseInt(r)}).forEach(a=>{this.send([(j.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),a.getOffsetNumber(i),a.rawRelease],{time:ee.toTimestamp(n.time)})}),this}stopNote(t,n={}){return this.sendNoteOff(t,n)}sendNoteOn(t,n={}){if(D.validation){if(n.rawAttack!=null&&!(n.rawAttack>=0&&n.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(n.attack!=null&&!(n.attack>=0&&n.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");n.rawVelocity&&(n.rawAttack=n.velocity,n.rawRelease=n.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),n.velocity&&(n.attack=n.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;n.rawAttack!=null?r=n.rawAttack:isNaN(n.attack)||(r=Math.round(n.attack*127));const i=D.octaveOffset+this.output.octaveOffset+this.octaveOffset;return ee.buildNoteArray(t,{rawAttack:r}).forEach(a=>{this.send([(j.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),a.getOffsetNumber(i),a.rawAttack],{time:ee.toTimestamp(n.time)})}),this}sendChannelMode(t,n=0,r={}){if(typeof t=="string"&&(t=j.CHANNEL_MODE_MESSAGES[t]),D.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(n))||n<0||n>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(j.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,n],{time:ee.toTimestamp(r.time)}),this}sendOmniMode(t,n={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,n):this.sendChannelMode("omnimodeoff",0,n),this}sendChannelAftertouch(t,n={}){if(D.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(n.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return n.rawValue||(t=ee.fromFloatTo7Bit(t)),this.send([(j.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:ee.toTimestamp(n.time)}),this}sendMasterTuning(t,n={}){if(t=parseFloat(t)||0,D.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let r=Math.floor(t)+64,i=t-Math.floor(t);i=Math.round((i+1)/2*16383);let a=i>>7&127,o=i&127;return this.sendRpnValue("channelcoarsetuning",r,n),this.sendRpnValue("channelfinetuning",[a,o],n),this}sendModulationRange(t,n,r={}){if(D.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(n!=null&&(!Number.isInteger(n)||!(n>=0&&n<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return n>=0&&n<=127||(n=0),this.sendRpnValue("modulationrange",[t,n],r),this}sendNrpnValue(t,n,r={}){if(n=[].concat(n),D.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");n.forEach(i=>{if(!(i>=0&&i<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,r),this._setCurrentParameter(n,r),this._deselectNonRegisteredParameter(r),this}sendPitchBend(t,n={}){if(D.validation)if(n.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(n.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let r=0,i=0;if(n.rawValue&&Array.isArray(t))r=t[0],i=t[1];else if(n.rawValue&&!Array.isArray(t))r=t;else{const a=ee.fromFloatToMsbLsb((t+1)/2);r=a.msb,i=a.lsb}return this.send([(j.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),i,r],{time:ee.toTimestamp(n.time)}),this}sendPitchBendRange(t,n,r={}){if(D.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(n)||!(n>=0&&n<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,n],r),this}sendProgramChange(t,n={}){if(t=parseInt(t)||0,D.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(j.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:ee.toTimestamp(n.time)}),this}sendRpnValue(t,n,r={}){if(Array.isArray(t)||(t=j.REGISTERED_PARAMETERS[t]),D.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(n).forEach(i=>{if(!(i>=0&&i<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,r),this._setCurrentParameter(n,r),this._deselectRegisteredParameter(r),this}sendTuningBank(t,n={}){if(D.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,n),this}sendTuningProgram(t,n={}){if(D.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,n),this}sendLocalControl(t,n={}){return t?this.sendChannelMode("localcontrol",127,n):this.sendChannelMode("localcontrol",0,n)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,n={}){return t==="mono"?this.sendChannelMode("monomodeon",0,n):this.sendChannelMode("polymodeon",0,n)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class hu extends Vt{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let n=1;n<=16;n++)this.channels[n]=new wM(this,n);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let n={timestamp:D.time};t.port.connection==="open"?(n.type="opened",n.target=this,n.port=n.target,this.emit("opened",n)):t.port.connection==="closed"&&t.port.state==="connected"?(n.type="closed",n.target=this,n.port=n.target,this.emit("closed",n)):t.port.connection==="closed"&&t.port.state==="disconnected"?(n.type="disconnected",n.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",n)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,n={time:0},r=0){if(t instanceof bg&&(t=ee.isNode?t.data:t.rawData),t instanceof Uint8Array&&ee.isNode&&(t=Array.from(t)),D.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(n)&&(t=t.concat(n)),n=isNaN(r)?{time:0}:{time:r}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(i=>{if(i=parseInt(i),!(i>=0&&i<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),n||(n={time:0})}return this._midiOutput.send(t,ee.toTimestamp(n.time)),this}sendSysex(t,n=[],r={}){if(t=[].concat(t),n instanceof Uint8Array){const i=new Uint8Array(1+t.length+n.length+1);i[0]=j.SYSTEM_MESSAGES.sysex,i.set(Uint8Array.from(t),1),i.set(n,1+t.length),i[i.length-1]=j.SYSTEM_MESSAGES.sysexend,this.send(i,{time:r.time})}else{const i=t.concat(n,j.SYSTEM_MESSAGES.sysexend);this.send([j.SYSTEM_MESSAGES.sysex].concat(i),{time:r.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():D.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,n={}){if(D.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([j.SYSTEM_MESSAGES.timecode,t],{time:n.time}),this}sendSongPosition(t=0,n={}){t=Math.floor(t)||0;var r=t>>7&127,i=t&127;return this.send([j.SYSTEM_MESSAGES.songposition,r,i],{time:n.time}),this}sendSongSelect(t=0,n={}){if(D.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([j.SYSTEM_MESSAGES.songselect,t],{time:n.time}),this}sendTuneRequest(t={}){return this.send([j.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([j.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([j.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([j.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([j.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([j.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([j.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return D.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,n,r={}){return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendKeyAftertouch(t,n,r)}),this}sendControlChange(t,n,r={},i={}){if(D.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const a=r;r=i,r.channels=a,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(a=>{this.channels[a].sendControlChange(t,n,r)}),this}sendPitchBendRange(t=0,n=0,r={}){return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendPitchBendRange(t,n,r)}),this}setPitchBendRange(t=0,n=0,r="all",i={}){return D.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),i.channels=r,i.channels==="all"&&(i.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,n,i)}sendRpnValue(t,n,r={}){return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendRpnValue(t,n,r)}),this}setRegisteredParameter(t,n=[],r="all",i={}){return D.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),i.channels=r,i.channels==="all"&&(i.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,n,i)}sendChannelAftertouch(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendChannelAftertouch(t,n)}),this}sendPitchBend(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendPitchBend(t,n)}),this}sendProgramChange(t=0,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendProgramChange(t,n)}),this}sendModulationRange(t,n,r={}){return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendModulationRange(t,n,r)}),this}setModulationRange(t=0,n=0,r="all",i={}){return D.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),i.channels=r,i.channels==="all"&&(i.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,n,i)}sendMasterTuning(t,n={}){return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendMasterTuning(t,n)}),this}setMasterTuning(t,n={},r={}){return D.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),r.channels=n,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,r)}sendTuningProgram(t,n={}){return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendTuningProgram(t,n)}),this}setTuningProgram(t,n="all",r={}){return D.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),r.channels=n,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,r)}sendTuningBank(t=0,n={}){return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendTuningBank(t,n)}),this}setTuningBank(t,n="all",r={}){return D.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),r.channels=n,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,r)}sendChannelMode(t,n=0,r={},i={}){if(D.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const a=r;r=i,r.channels=a,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(a=>{this.channels[a].sendChannelMode(t,n,r)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(t.channels).forEach(n=>{this.channels[n].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},n={}){if(D.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=n,t.channels=r,t.channels==="all"&&(t.channels=j.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendPolyphonicMode(t,n)}),this}sendLocalControl(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendLocalControl(t,n)}),this}sendOmniMode(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendOmniMode(t,n)}),this}sendNrpnValue(t,n,r={}){return r.channels==null&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].sendNrpnValue(t,n,r)}),this}setNonRegisteredParameter(t,n=[],r="all",i={}){return D.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),i.channels=r,i.channels==="all"&&(i.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,n,i)}sendRpnIncrement(t,n={}){return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnIncrement(t,n)}),this}incrementRegisteredParameter(t,n="all",r={}){return D.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),r.channels=n,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,r)}sendRpnDecrement(t,n={}){return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(r=>{this.channels[r].sendRpnDecrement(t,n)}),this}decrementRegisteredParameter(t,n="all",r={}){return D.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),r.channels=n,r.channels==="all"&&(r.channels=j.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,r)}sendNoteOff(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendNoteOff(t,n)}),this}stopNote(t,n){return this.sendNoteOff(t,n)}playNote(t,n={},r={}){if(D.validation&&(n.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),n.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].playNote(t,n)}),this}sendNoteOn(t,n={},r={}){if(D.validation&&(Array.isArray(n)||Number.isInteger(n)||n==="all")){const i=n;n=r,n.channels=i,n.channels==="all"&&(n.channels=j.MIDI_CHANNEL_NUMBERS)}return n.channels==null&&(n.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(n.channels).forEach(i=>{this.channels[i].sendNoteOn(t,n)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Pd{constructor(t=[],n={}){this.destinations=[],this.types=[...Object.keys(j.SYSTEM_MESSAGES),...Object.keys(j.CHANNEL_MESSAGES)],this.channels=j.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),n.types&&!Array.isArray(n.types)&&(n.types=[n.types]),n.channels&&!Array.isArray(n.channels)&&(n.channels=[n.channels]),D.validation&&(t.forEach(r=>{if(!(r instanceof hu))throw new TypeError("Destinations must be of type 'Output'.")}),n.types!==void 0&&n.types.forEach(r=>{if(!j.SYSTEM_MESSAGES.hasOwnProperty(r)&&!j.CHANNEL_MESSAGES.hasOwnProperty(r))throw new TypeError("Type must be a valid message type.")}),n.channels!==void 0&&n.channels.forEach(r=>{if(!j.MIDI_CHANNEL_NUMBERS.includes(r))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,n.types&&(this.types=n.types),n.channels&&(this.channels=n.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(n=>{D.validation&&!(n instanceof hu)||n.send(t)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class vM extends Vt{constructor(t,n){super(),this._input=t,this._number=n,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const n=Object.assign({},t);n.port=this.input,n.target=this,n.type="midimessage",this.emit(n.type,n),this._parseEventForStandardMessages(n)}_parseEventForStandardMessages(t){const n=Object.assign({},t);n.type=n.message.type||"unknownmessage";const r=t.message.dataBytes[0],i=t.message.dataBytes[1];if(n.type==="noteoff"||n.type==="noteon"&&i===0)this.notesState[r]=!1,n.type="noteoff",n.note=new jr(ee.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+D.octaveOffset),{rawAttack:0,rawRelease:i}),n.value=ee.from7bitToFloat(i),n.rawValue=i,n.velocity=n.note.release,n.rawVelocity=n.note.rawRelease;else if(n.type==="noteon")this.notesState[r]=!0,n.note=new jr(ee.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+D.octaveOffset),{rawAttack:i}),n.value=ee.from7bitToFloat(i),n.rawValue=i,n.velocity=n.note.attack,n.rawVelocity=n.note.rawAttack;else if(n.type==="keyaftertouch")n.note=new jr(ee.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+D.octaveOffset)),n.value=ee.from7bitToFloat(i),n.rawValue=i,n.identifier=n.note.identifier,n.key=n.note.number,n.rawKey=r;else if(n.type==="controlchange"){n.controller={number:r,name:j.CONTROL_CHANGE_MESSAGES[r].name,description:j.CONTROL_CHANGE_MESSAGES[r].description,position:j.CONTROL_CHANGE_MESSAGES[r].position},n.subtype=n.controller.name||"controller"+r,n.value=ee.from7bitToFloat(i),n.rawValue=i;const a=Object.assign({},n);a.type=`${n.type}-controller${r}`,delete a.subtype,this.emit(a.type,a);const o=Object.assign({},n);o.type=`${n.type}-`+j.CONTROL_CHANGE_MESSAGES[r].name,delete o.subtype,o.type.indexOf("controller")!==0&&this.emit(o.type,o),n.message.dataBytes[0]>=120&&this._parseChannelModeMessage(n),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(n.message.dataBytes[0])&&this._parseEventForParameterNumber(n)}else n.type==="programchange"?(n.value=r,n.rawValue=n.value):n.type==="channelaftertouch"?(n.value=ee.from7bitToFloat(r),n.rawValue=r):n.type==="pitchbend"?(n.value=((i<<7)+r-8192)/8192,n.rawValue=(i<<7)+r):n.type="unknownmessage";this.emit(n.type,n)}_parseChannelModeMessage(t){const n=Object.assign({},t);n.type=n.controller.name,n.type==="localcontrol"&&(n.value=n.message.data[2]===127,n.rawValue=n.message.data[2]),n.type==="omnimodeon"?(n.type="omnimode",n.value=!0,n.rawValue=n.message.data[2]):n.type==="omnimodeoff"&&(n.type="omnimode",n.value=!1,n.rawValue=n.message.data[2]),n.type==="monomodeon"?(n.type="monomode",n.value=!0,n.rawValue=n.message.data[2]):n.type==="polymodeon"&&(n.type="monomode",n.value=!1,n.rawValue=n.message.data[2]),this.emit(n.type,n)}_parseEventForParameterNumber(t){const n=t.message.dataBytes[0],r=t.message.dataBytes[1];n===99||n===101?(this._nrpnBuffer=[],this._rpnBuffer=[],n===99?this._nrpnBuffer=[t.message]:r!==127&&(this._rpnBuffer=[t.message])):n===98||n===100?n===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&r!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(n===6||n===38||n===96||n===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,n,r,i){t=t==="nrpn"?"nrpn":"rpn";const a={target:i.target,timestamp:i.timestamp,message:i.message,parameterMsb:n,parameterLsb:r,value:ee.from7bitToFloat(i.message.dataBytes[1]),rawValue:i.message.dataBytes[1]};t==="rpn"?a.parameter=Object.keys(j.REGISTERED_PARAMETERS).find(l=>j.REGISTERED_PARAMETERS[l][0]===n&&j.REGISTERED_PARAMETERS[l][1]===r):a.parameter=(n<<7)+r;const o=j.CONTROL_CHANGE_MESSAGES[i.message.dataBytes[0]].name;a.type=`${t}-${o}`,this.emit(a.type,a);const s=Object.assign({},a);s.type==="nrpn-dataincrement"?s.type="nrpn-databuttonincrement":s.type==="nrpn-datadecrement"?s.type="nrpn-databuttondecrement":s.type==="rpn-dataincrement"?s.type="rpn-databuttonincrement":s.type==="rpn-datadecrement"&&(s.type="rpn-databuttondecrement"),this.emit(s.type,s),a.type=t,a.subtype=o,this.emit(a.type,a)}getChannelModeByNumber(t){return D.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),ee.getChannelModeByNumber(t)}getCcNameByNumber(t){if(D.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return ee.getCcNameByNumber(t)}getNoteState(t){t instanceof jr&&(t=t.identifier);const n=ee.guessNoteNumber(t,D.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[n]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class bg{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=ee.getPropertyByValue(j.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=ee.getPropertyByValue(j.SYSTEM_MESSAGES,this.command)),this.statusByte===j.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class MM extends Vt{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let n=1;n<=16;n++)this.channels[n]=new vM(this,n);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let n={timestamp:D.time,target:this,port:this};t.port.connection==="open"?(n.type="opened",this.emit("opened",n)):t.port.connection==="closed"&&t.port.state==="connected"?(n.type="closed",this.emit("closed",n)):t.port.connection==="closed"&&t.port.state==="disconnected"?(n.type="disconnected",n.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",n)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const n=new bg(t.data),r={port:this,target:this,message:n,timestamp:t.timeStamp,type:"midimessage",data:n.data,rawData:n.data,statusByte:n.data[0],dataBytes:n.dataBytes};this.emit("midimessage",r),n.isSystemMessage?this._parseEvent(r):n.isChannelMessage&&this.channels[n.channel]._processMidiMessageEvent(r),this._forwarders.forEach(i=>i.forward(n))}_parseEvent(t){const n=Object.assign({},t);n.type=n.message.type||"unknownmidimessage",n.type==="songselect"&&(n.song=t.data[1]+1,n.value=t.data[1],n.rawValue=n.value),this.emit(n.type,n)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){D.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,n,r={}){if(D.validation&&typeof r=="function"){let i=n!=null?[].concat(n):void 0;n=r,r={channels:i}}if(j.CHANNEL_EVENTS.includes(t)){r.channels===void 0&&(r.channels=j.MIDI_CHANNEL_NUMBERS);let i=[];return ee.sanitizeChannels(r.channels).forEach(a=>{i.push(this.channels[a].addListener(t,n,r))}),i}else return super.addListener(t,n,r)}addOneTimeListener(t,n,r={}){return r.remaining=1,this.addListener(t,n,r)}on(t,n,r,i){return this.addListener(t,n,r,i)}hasListener(t,n,r={}){if(D.validation&&typeof r=="function"){let i=[].concat(n);n=r,r={channels:i}}return j.CHANNEL_EVENTS.includes(t)?(r.channels===void 0&&(r.channels=j.MIDI_CHANNEL_NUMBERS),ee.sanitizeChannels(r.channels).every(i=>this.channels[i].hasListener(t,n))):super.hasListener(t,n)}removeListener(t,n,r={}){if(D.validation&&typeof r=="function"){let i=[].concat(n);n=r,r={channels:i}}if(r.channels===void 0&&(r.channels=j.MIDI_CHANNEL_NUMBERS),t==null)return ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i]&&this.channels[i].removeListener()}),super.removeListener();j.CHANNEL_EVENTS.includes(t)?ee.sanitizeChannels(r.channels).forEach(i=>{this.channels[i].removeListener(t,n,r)}):super.removeListener(t,n,r)}addForwarder(t,n={}){let r;return t instanceof Pd?r=t:r=new Pd(t,n),this._forwarders.push(r),r}removeForwarder(t){this._forwarders=this._forwarders.filter(n=>n!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return D.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class xM extends Vt{constructor(){super(),this.defaults={note:{attack:ee.from7bitToFloat(64),release:ee.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},n=!1){if(ee.isNode){try{window.navigator}catch{let s=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,s)}try{}catch{global.performance=await Object.getPrototypeOf(async function(){}).constructor(`
        let perf_hooks = await import("perf_hooks");
        return perf_hooks.performance;
        `)()}}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:n}),n&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const r={timestamp:this.time,target:this,type:"error",error:void 0},i={timestamp:this.time,target:this,type:"midiaccessgranted"},a={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(o){return r.error=o,this.emit("error",r),typeof t.callback=="function"&&t.callback(o),Promise.reject(o)}this.emit("midiaccessgranted",i),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(o){return r.error=o,this.emit("error",r),typeof t.callback=="function"&&t.callback(o),Promise.reject(o)}return this.emit("enabled",a),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(n.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(this._disconnectedInputs[r].id===t.toString())return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(this.inputs[r].id===t.toString())return this.inputs[r]}getInputByName(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(n.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(~this._disconnectedInputs[r].name.indexOf(t))return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(~this.inputs[r].name.indexOf(t))return this.inputs[r]}getOutputByName(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(n.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(~this._disconnectedOutputs[r].name.indexOf(t))return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(~this.outputs[r].name.indexOf(t))return this.outputs[r]}getOutputById(t,n={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(n.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(this._disconnectedOutputs[r].id===t.toString())return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(this.outputs[r].id===t.toString())return this.outputs[r]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),ee.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?ee.getNoteDetails(ee.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),ee.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),ee.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),ee.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,n={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),ee.buildNoteArray(t,n)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),ee.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(n=>t.push(n.destroy())),this.outputs.forEach(n=>t.push(n.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let n={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?n.port=this.getOutputById(t.port.id):t.port.type==="input"&&(n.port=this.getInputById(t.port.id)),this.emit(t.port.state,n);const r=Object.assign({},n);r.type="portschanged",this.emit(r.type,r)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?n.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(n.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,n);const r=Object.assign({},n);r.type="portschanged",this.emit(r.type,r)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let n=this._inputs.length-1;n>=0;n--){const r=this._inputs[n];Array.from(this.interface.inputs.values()).find(a=>a===r._midiInput)||(this._disconnectedInputs.push(r),this._inputs.splice(n,1))}let t=[];return this.interface.inputs.forEach(n=>{if(!this._inputs.find(r=>r._midiInput===n)){let r=this._disconnectedInputs.find(i=>i._midiInput===n);r||(r=new MM(n)),this._inputs.push(r),t.push(r.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let n=this._outputs.length-1;n>=0;n--){const r=this._outputs[n];Array.from(this.interface.outputs.values()).find(a=>a===r._midiOutput)||(this._disconnectedOutputs.push(r),this._outputs.splice(n,1))}let t=[];return this.interface.outputs.forEach(n=>{if(!this._outputs.find(r=>r._midiOutput===n)){let r=this._disconnectedOutputs.find(i=>i._midiOutput===n);r||(r=new hu(n)),this._outputs.push(r),t.push(r.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),ee.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),ee.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.9"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),j.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),j.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),j.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),j.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),j.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const D=new xM;D.constructor=null;function gg(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function yg(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var _g=[0,2,4,-1,1,3,5],wg=_g.map(e=>Math.floor(e*7/12));function vg(e){const{step:t,alt:n,oct:r,dir:i=1}=e,a=_g[t]+7*n;if(r===void 0)return[i*a];const o=r-wg[t]-4*n;return[i*a,i*o]}var EM=[3,0,4,1,5,2,6];function SM(e){const[t,n,r]=e,i=EM[AM(t)],a=Math.floor((t+1)/7);if(n===void 0)return{step:i,alt:a,dir:r};const o=n+4*a+wg[i];return{step:i,alt:a,oct:o,dir:r}}function AM(e){const t=(e+1)%7;return t<0?7+t:t}var Nd=(e,t)=>Array(Math.abs(t)+1).join(e),du=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),PM="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",NM="(AA|A|P|M|m|d|dd)([-+]?\\d+)",CM=new RegExp("^"+PM+"|"+NM+"$");function TM(e){const t=CM.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var Cd={};function As(e){return typeof e=="string"?Cd[e]||(Cd[e]=$M(e)):yg(e)?As(IM(e)):gg(e)?As(e.name):du}var Td=[0,2,4,5,7,9,11],Mg="PMMPPMM";function $M(e){const t=TM(e);if(t[0]==="")return du;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,a=Mg[i];if(a==="M"&&r==="P")return du;const o=a==="M"?"majorable":"perfectable",s=""+n+r,l=n<0?-1:1,c=n===8||n===-8?n:l*(i+1),u=kM(o,r),d=Math.floor((Math.abs(n)-1)/7),f=l*(Td[i]+u+12*d),h=(l*(Td[i]+u)%12+12)%12,m=vg({step:i,alt:u,oct:d,dir:l});return{empty:!1,name:s,num:n,q:r,step:i,alt:u,dir:l,type:o,simple:c,semitones:f,chroma:h,coord:m,oct:d}}function kM(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function IM(e){const{step:t,alt:n,oct:r=0,dir:i}=e;if(!i)return"";const a=t+1+7*r,o=a===0?t+1:a,s=i<0?"-":"",l=Mg[t]==="M"?"majorable":"perfectable";return s+o+DM(l,n)}function DM(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?Nd("A",t):Nd("d",e==="perfectable"?t:t+1)}var $d=(e,t)=>Array(Math.abs(t)+1).join(e),xg=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),kd=new Map,RM=e=>"CDEFGAB".charAt(e),LM=e=>e<0?$d("b",-e):$d("#",e),BM=e=>e[0]==="b"?-e.length:e.length;function Oe(e){const t=JSON.stringify(e),n=kd.get(t);if(n)return n;const r=typeof e=="string"?qM(e):yg(e)?Oe(HM(e)):gg(e)?Oe(e.name):xg;return kd.set(t,r),r}var OM=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function FM(e){const t=OM.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function GM(e){return Oe(SM(e))}var UM=(e,t)=>(e%t+t)%t,tc=[0,2,4,5,7,9,11];function qM(e){const t=FM(e);if(t[0]===""||t[3]!=="")return xg;const n=t[0],r=t[1],i=t[2],a=(n.charCodeAt(0)+3)%7,o=BM(r),s=i.length?+i:void 0,l=vg({step:a,alt:o,oct:s}),c=n+r+i,u=n+r,d=(tc[a]+o+120)%12,f=s===void 0?UM(tc[a]+o,12)-12*99:tc[a]+o+12*(s+1),h=f>=0&&f<=127?f:null,m=s===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:o,chroma:d,coord:l,freq:m,height:f,letter:n,midi:h,name:c,oct:s,pc:u,step:a}}function HM(e){const{step:t,alt:n,oct:r}=e,i=RM(t);if(!i)return"";const a=i+LM(n);return r||r===0?a+r:a}function bi(e,t){const n=Oe(e),r=Array.isArray(t)?t:As(t).coord;if(n.empty||!r||r.length<2)return"";const i=n.coord,a=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return GM(a).name}function Eg(e,t){const n=e.length;return r=>{if(!t)return"";const i=r<0?(n- -r%n)%n:r%n,a=Math.floor(r/n),o=bi(t,[0,a]);return bi(o,e[i])}}function zM(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}function VM(e,t){const n=[];for(;t--;n[t]=t+e);return n}function jM(e,t){const n=[];for(;t--;n[t]=e-t);return n}function YM(e,t){return e<t?VM(e,t-e+1):jM(e,e-t+1)}function Qa(e,t){const n=t.length,r=(e%n+n)%n;return t.slice(r,n).concat(t.slice(0,r))}function WM(e){return e.filter(t=>t===0||t)}var nr={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Sg=e=>Number(e).toString(2).padStart(12,"0"),Id=e=>parseInt(e,2),XM=/^[01]{12}$/;function _f(e){return XM.test(e)}var KM=e=>typeof e=="number"&&e>=0&&e<=4095,ZM=e=>e&&_f(e.chroma),Dd={[nr.chroma]:nr};function Gn(e){const t=_f(e)?e:KM(e)?Sg(e):Array.isArray(e)?r8(e):ZM(e)?e.chroma:nr.chroma;return Dd[t]=Dd[t]||n8(t)}var JM=e=>Gn(e).chroma,QM=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function e8(e){const t=[];for(let n=0;n<12;n++)e.charAt(n)==="1"&&t.push(QM[n]);return t}function Ag(e,t=!0){const r=Gn(e).chroma.split("");return WM(r.map((i,a)=>{const o=Qa(a,r);return t&&o[0]==="0"?null:o.join("")}))}function wf(e){const t=Gn(e).setNum;return n=>{const r=Gn(n).setNum;return t&&t!==r&&(r&t)===r}}function vf(e){const t=Gn(e).setNum;return n=>{const r=Gn(n).setNum;return t&&t!==r&&(r|t)===r}}function t8(e){const t=e.split("");return t.map((n,r)=>Qa(r,t).join(""))}function n8(e){const t=Id(e),n=t8(e).map(Id).filter(a=>a>=2048).sort()[0],r=Sg(n),i=e8(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:r,intervals:i}}function r8(e){if(e.length===0)return nr.chroma;let t;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<e.length;r++)t=Oe(e[r]),t.empty&&(t=As(e[r])),t.empty||(n[t.chroma]=1);return n.join("")}var i8=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],a8=i8;({...nr});var Mf=[],Go={};function Pg(){return Mf.slice()}function o8(e,t,n){const r=l8(e),i={...Gn(e),name:n||"",quality:r,intervals:e,aliases:t};Mf.push(i),i.name&&(Go[i.name]=i),Go[i.setNum]=i,Go[i.chroma]=i,i.aliases.forEach(a=>s8(i,a))}function s8(e,t){Go[t]=e}function l8(e){const t=n=>e.indexOf(n)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}a8.forEach(([e,t,n])=>o8(e.split(" "),n.split(" "),t));Mf.sort((e,t)=>e.setNum-t.setNum);var c8=e=>{const t=e.reduce((n,r)=>{const i=Oe(r).chroma;return i!==void 0&&(n[i]=n[i]||Oe(r).name),n},{});return n=>t[n]};function u8(e,t={}){const n=e.map(i=>Oe(i).pc).filter(i=>i);return Oe.length===0?[]:g8(n,1,t).filter(i=>i.weight).sort((i,a)=>a.weight-i.weight).map(i=>i.name)}var fl={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},hl=e=>t=>!!(t&e),f8=hl(fl.anyThirds),h8=hl(fl.perfectFifth),d8=hl(fl.anySeventh),m8=hl(fl.nonPerfectFifths);function p8(e){const t=parseInt(e.chroma,2);return f8(t)&&h8(t)&&d8(t)}function b8(e){const t=parseInt(e,2);return m8(t)?e:(t|16).toString(2)}function g8(e,t,n){const r=e[0],i=Oe(r).chroma,a=c8(e),o=Ag(e,!1),s=[];return o.forEach((l,c)=>{const u=n.assumePerfectFifth&&b8(l);Pg().filter(f=>n.assumePerfectFifth&&p8(f)?f.chroma===u:f.chroma===l).forEach(f=>{const h=f.aliases[0],m=a(c);c!==i?s.push({weight:.5*t,name:`${m}${h}/${r}`}):s.push({weight:1*t,name:`${m}${h}`})})}),s}function Ng(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function Cg(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var Tg=[0,2,4,-1,1,3,5],$g=Tg.map(e=>Math.floor(e*7/12));function kg(e){const{step:t,alt:n,oct:r,dir:i=1}=e,a=Tg[t]+7*n;if(r===void 0)return[i*a];const o=r-$g[t]-4*n;return[i*a,i*o]}var y8=[3,0,4,1,5,2,6];function Ig(e){const[t,n,r]=e,i=y8[_8(t)],a=Math.floor((t+1)/7);if(n===void 0)return{step:i,alt:a,dir:r};const o=n+4*a+$g[i];return{step:i,alt:a,oct:o,dir:r}}function _8(e){const t=(e+1)%7;return t<0?7+t:t}var Rd=(e,t)=>Array(Math.abs(t)+1).join(e),mu={empty:!0,name:"",acc:""},w8="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",v8="(AA|A|P|M|m|d|dd)([-+]?\\d+)",M8=new RegExp("^"+w8+"|"+v8+"$");function x8(e){const t=M8.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var Ld={};function Ps(e){return typeof e=="string"?Ld[e]||(Ld[e]=E8(e)):Cg(e)?Ps(P8(e)):Ng(e)?Ps(e.name):mu}var Bd=[0,2,4,5,7,9,11],Dg="PMMPPMM";function E8(e){const t=x8(e);if(t[0]==="")return mu;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,a=Dg[i];if(a==="M"&&r==="P")return mu;const o=a==="M"?"majorable":"perfectable",s=""+n+r,l=n<0?-1:1,c=n===8||n===-8?n:l*(i+1),u=A8(o,r),d=Math.floor((Math.abs(n)-1)/7),f=l*(Bd[i]+u+12*d),h=(l*(Bd[i]+u)%12+12)%12,m=kg({step:i,alt:u,oct:d,dir:l});return{empty:!1,name:s,num:n,q:r,step:i,alt:u,dir:l,type:o,simple:c,semitones:f,chroma:h,coord:m,oct:d}}function S8(e,t){const[n,r=0]=e,i=n*7+r*12<0,a=t||i?[-n,-r,-1]:[n,r,1];return Ps(Ig(a))}function A8(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function P8(e){const{step:t,alt:n,oct:r=0,dir:i}=e;if(!i)return"";const a=t+1+7*r,o=a===0?t+1:a,s=i<0?"-":"",l=Dg[t]==="M"?"majorable":"perfectable";return s+o+N8(l,n)}function N8(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?Rd("A",t):Rd("d",e==="perfectable"?t:t+1)}var Od=(e,t)=>Array(Math.abs(t)+1).join(e),Rg={empty:!0,name:"",pc:"",acc:""},Fd=new Map,C8=e=>"CDEFGAB".charAt(e),T8=e=>e<0?Od("b",-e):Od("#",e),$8=e=>e[0]==="b"?-e.length:e.length;function rr(e){const t=JSON.stringify(e),n=Fd.get(t);if(n)return n;const r=typeof e=="string"?R8(e):Cg(e)?rr(L8(e)):Ng(e)?rr(e.name):Rg;return Fd.set(t,r),r}var k8=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Lg(e){const t=k8.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function I8(e){return rr(Ig(e))}var D8=(e,t)=>(e%t+t)%t,nc=[0,2,4,5,7,9,11];function R8(e){const t=Lg(e);if(t[0]===""||t[3]!=="")return Rg;const n=t[0],r=t[1],i=t[2],a=(n.charCodeAt(0)+3)%7,o=$8(r),s=i.length?+i:void 0,l=kg({step:a,alt:o,oct:s}),c=n+r+i,u=n+r,d=(nc[a]+o+120)%12,f=s===void 0?D8(nc[a]+o,12)-12*99:nc[a]+o+12*(s+1),h=f>=0&&f<=127?f:null,m=s===void 0?null:Math.pow(2,(f-69)/12)*440;return{empty:!1,acc:r,alt:o,chroma:d,coord:l,freq:m,height:f,letter:n,midi:h,name:c,oct:s,pc:u,step:a}}function L8(e){const{step:t,alt:n,oct:r}=e,i=C8(t);if(!i)return"";const a=i+T8(n);return r||r===0?a+r:a}function Ns(e,t){const n=rr(e),r=Array.isArray(t)?t:Ps(t).coord;if(n.empty||!r||r.length<2)return"";const i=n.coord,a=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return I8(a).name}function Bg(e,t){const n=e.length;return r=>{if(!t)return"";const i=r<0?(n- -r%n)%n:r%n,a=Math.floor(r/n),o=Ns(t,[0,a]);return Ns(o,e[i])}}function B8(e,t){const n=rr(e),r=rr(t);if(n.empty||r.empty)return"";const i=n.coord,a=r.coord,o=a[0]-i[0],s=i.length===2&&a.length===2?a[1]-i[1]:-Math.floor(o*7/12),l=r.height===n.height&&r.midi!==null&&n.midi!==null&&n.step>r.step;return S8([o,s],l).name}function O8(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}var F8=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],G8=F8,U8={...nr,name:"",quality:"Unknown",intervals:[],aliases:[]},xf=[],oa={};function q8(e){return oa[e]||U8}function Og(){return xf.slice()}function H8(e,t,n){const r=V8(e),i={...Gn(e),name:n||"",quality:r,intervals:e,aliases:t};xf.push(i),i.name&&(oa[i.name]=i),oa[i.setNum]=i,oa[i.chroma]=i,i.aliases.forEach(a=>z8(i,a))}function z8(e,t){oa[t]=e}function V8(e){const t=n=>e.indexOf(n)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}G8.forEach(([e,t,n])=>H8(e.split(" "),n.split(" "),t));xf.sort((e,t)=>e.setNum-t.setNum);var j8=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],Y8=j8,W8={...nr,intervals:[],aliases:[]},Ef=[],sa={};function X8(){return Ef.map(e=>e.name)}function Fg(e){return sa[e]||W8}function dl(){return Ef.slice()}function K8(e,t,n=[]){const r={...Gn(e),name:t,intervals:e,aliases:n};return Ef.push(r),sa[r.name]=r,sa[r.setNum]=r,sa[r.chroma]=r,r.aliases.forEach(i=>Z8(r,i)),r}function Z8(e,t){sa[t]=e}Y8.forEach(([e,t,...n])=>K8(e.split(" "),t,n));var pu={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Sf(e){const[t,n,r,i]=Lg(e);return t===""?["",e]:t==="A"&&i==="ug"?["","aug"]:[t+n,r+i]}function Lr(e){if(e==="")return pu;if(Array.isArray(e)&&e.length===2)return Uo(e[1],e[0]);{const[t,n]=Sf(e),r=Uo(n,t);return r.empty?Uo(e):r}}function Uo(e,t,n){const r=q8(e),i=rr(t||""),a=rr(n||"");if(r.empty||t&&i.empty||n&&a.empty)return pu;const o=B8(i.pc,a.pc),s=r.intervals.indexOf(o)+1;if(!a.empty&&!s)return pu;const l=Array.from(r.intervals);for(let f=1;f<s;f++){const h=l[0][0],m=l[0][1],p=parseInt(h,10)+7;l.push(`${p}${m}`),l.shift()}const c=i.empty?[]:l.map(f=>Ns(i,f));e=r.aliases.indexOf(e)!==-1?e:r.aliases[0];const u=`${i.empty?"":i.pc}${e}${a.empty||s<=1?"":"/"+a.pc}`,d=`${t?i.pc+" ":""}${r.name}${s>1&&n?" over "+a.pc:""}`;return{...r,name:d,symbol:u,type:r.name,root:a.name,intervals:l,rootDegree:s,tonic:i.name,notes:c}}var J8=O8("Chord.chord","Chord.get",Lr);function Q8(e,t){const[n,r]=Sf(e);return n?Ns(n,t)+r:e}function e9(e){const t=Lr(e),n=vf(t.chroma);return dl().filter(r=>n(r.chroma)).map(r=>r.name)}function t9(e){const t=Lr(e),n=vf(t.chroma);return Og().filter(r=>n(r.chroma)).map(r=>t.tonic+r.aliases[0])}function n9(e){const t=Lr(e),n=wf(t.chroma);return Og().filter(r=>n(r.chroma)).map(r=>t.tonic+r.aliases[0])}function r9(e){const{intervals:t,tonic:n}=Lr(e),r=Bg(t,n);return i=>i?r(i>0?i-1:i):""}function i9(e){const{intervals:t,tonic:n}=Lr(e);return Bg(t,n)}var Gg={getChord:Uo,get:Lr,detect:u8,chordScales:e9,extended:t9,reduced:n9,tokenize:Sf,transpose:Q8,degrees:r9,steps:i9,chord:J8},a9=Math.log(2),o9=Math.log(440);function Ug(e){const t=12*(Math.log(e)-o9)/a9+69;return Math.round(t*100)/100}var s9="C C# D D# E F F# G G# A A# B".split(" "),l9="C Db D Eb E F Gb G Ab A Bb B".split(" ");function Ni(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const r=(t.sharps===!0?s9:l9)[e%12];if(t.pitchClass)return r;const i=Math.floor(e/12)-1;return r+i}var c9=["C","D","E","F","G","A","B"],qg=e=>e.name,Hg=e=>e.map(Oe).filter(t=>!t.empty);function u9(e){return e===void 0?c9.slice():Array.isArray(e)?Hg(e).map(qg):[]}var Qt=Oe,f9=e=>Qt(e).name,h9=e=>Qt(e).pc,d9=e=>Qt(e).acc,m9=e=>Qt(e).oct,p9=e=>Qt(e).midi,b9=e=>Qt(e).freq,g9=e=>Qt(e).chroma;function zg(e){return Ni(e)}function y9(e){return Ni(Ug(e))}function _9(e){return Ni(Ug(e),{sharps:!0})}function w9(e){return Ni(e,{sharps:!0})}var eo=bi,v9=bi,Vg=e=>t=>eo(t,e),M9=Vg,jg=e=>t=>eo(e,t),x9=jg;function Yg(e,t){return eo(e,[t,0])}var E9=Yg;function S9(e,t){return eo(e,[0,t])}var Af=(e,t)=>e.height-t.height,A9=(e,t)=>t.height-e.height;function Wg(e,t){return t=t||Af,Hg(e).sort(t).map(qg)}function Xg(e){return Wg(e,Af).filter((t,n,r)=>n===0||t!==r[n-1])}var P9=e=>{const t=Qt(e);return t.empty?"":Ni(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function Kg(e,t){const n=Qt(e);if(n.empty)return"";const r=Qt(t||Ni(n.midi||n.chroma,{sharps:n.alt<0,pitchClass:!0}));if(r.empty||r.chroma!==n.chroma)return"";if(n.oct===void 0)return r.pc;const i=n.chroma-n.alt,a=r.chroma-r.alt,o=i>11||a<0?-1:i<0||a>11?1:0,s=n.oct+o;return r.pc+s}var bn={names:u9,get:Qt,name:f9,pitchClass:h9,accidentals:d9,octave:m9,midi:p9,ascending:Af,descending:A9,sortedNames:Wg,sortedUniqNames:Xg,fromMidi:zg,fromMidiSharps:w9,freq:b9,fromFreq:y9,fromFreqSharps:_9,chroma:g9,transpose:eo,tr:v9,transposeBy:Vg,trBy:M9,transposeFrom:jg,trFrom:x9,transposeFifths:Yg,transposeOctaves:S9,trFifths:E9,simplify:P9,enharmonic:Kg},Pf=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],Gd={...nr,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},N9=Pf.map(C9),bu={};N9.forEach(e=>{bu[e.name]=e,e.aliases.forEach(t=>{bu[t]=e})});function Zg(e){return typeof e=="string"?bu[e.toLowerCase()]||Gd:e&&e.name?Zg(e.name):Gd}function C9(e){const[t,n,r,i,a,o,s]=e,l=s?[s]:[],c=Number(n).toString(2);return{empty:!1,intervals:Fg(i).intervals,modeNum:t,chroma:c,normalized:c,name:i,setNum:n,alt:r,triad:a,seventh:o,aliases:l}}function Jg(e){return(t,n)=>{const r=Zg(t);if(r.empty)return[];const i=Qa(r.modeNum,e),a=r.intervals.map(o=>bi(n,o));return i.map((o,s)=>a[s]+o)}}Jg(Pf.map(e=>e[4]));Jg(Pf.map(e=>e[5]));var T9={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Qg(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),n=Oe(e.substring(0,t));if(n.empty){const i=Oe(e);return i.empty?["",e]:[i.name,""]}const r=e.substring(n.name.length+1).toLowerCase();return[n.name,r.length?r:""]}var $9=X8;function gn(e){const t=Array.isArray(e)?e:Qg(e),n=Oe(t[0]).name,r=Fg(t[1]);if(r.empty)return T9;const i=r.name,a=n?r.intervals.map(s=>bi(n,s)):[],o=n?n+" "+i:i;return{...r,name:o,type:i,tonic:n,notes:a}}var k9=zM("Scale.scale","Scale.get",gn);function I9(e,t={}){const n=JM(e),r=Oe(t.tonic??e[0]??""),i=r.chroma;if(i===void 0)return[];const a=n.split("");a[i]="1";const o=Qa(i,a).join(""),s=dl().find(c=>c.chroma===o),l=[];return s&&l.push(r.name+" "+s.name),t.match==="exact"||e2(o).forEach(c=>{l.push(r.name+" "+c)}),l}function D9(e){const t=gn(e),n=wf(t.chroma);return Pg().filter(r=>n(r.chroma)).map(r=>r.aliases[0])}function e2(e){const t=_f(e)?e:gn(e).chroma,n=vf(t);return dl().filter(r=>n(r.chroma)).map(r=>r.name)}function R9(e){const t=wf(gn(e).chroma);return dl().filter(n=>t(n.chroma)).map(n=>n.name)}function t2(e){const t=e.map(i=>Oe(i).pc).filter(i=>i),n=t[0],r=Xg(t);return Qa(r.indexOf(n),r)}function L9(e){const t=gn(e);if(t.empty)return[];const n=t.tonic?t.notes:t.intervals;return Ag(t.chroma).map((r,i)=>{const a=gn(r).name;return a?[n[i],a]:["",""]}).filter(r=>r[0])}function B9(e){const t=Array.isArray(e)?t2(e):gn(e).notes,n=t.map(r=>Oe(r).chroma);return r=>{const i=Oe(typeof r=="number"?zg(r):r),a=i.height;if(a===void 0)return;const o=a%12,s=n.indexOf(o);if(s!==-1)return Kg(i.name,t[s])}}function O9(e){const t=B9(e);return(n,r)=>{const i=Oe(n).height,a=Oe(r).height;return i===void 0||a===void 0?[]:YM(i,a).map(t).filter(o=>o)}}function F9(e){const{intervals:t,tonic:n}=gn(e),r=Eg(t,n);return i=>i?r(i>0?i-1:i):""}function G9(e){const{intervals:t,tonic:n}=gn(e);return Eg(t,n)}var gu={degrees:F9,detect:I9,extended:e2,get:gn,modeNames:L9,names:$9,rangeOf:O9,reduced:R9,scaleChords:D9,scaleNotes:t2,steps:G9,tokenize:Qg,scale:k9};function U9(e){let t,n,r,i,a,o,s,l,c=e[0].join(", ")+"",u,d,f,h,m=e[1].join(" or ")+"",p;return{c(){t=P("main"),n=P("h2"),n.textContent="Chord Detection",r=L(),i=P("p"),i.textContent=`Play a chord on a MIDI instrument. The notes you played and the detected
        chord will be shown below.`,a=L(),o=P("div"),s=K("Notes: "),l=P("b"),u=K(c),d=P("br"),f=K(`
        Detected chord: `),h=P("b"),p=K(m),N(i,"class","explanation"),N(o,"class","visualization"),N(t,"class","demo")},m(_,w){oe(_,t,w),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(o,l),b(l,u),b(o,d),b(o,f),b(o,h),b(h,p)},p(_,[w]){w&1&&c!==(c=_[0].join(", ")+"")&&Se(u,c),w&2&&m!==(m=_[1].join(" or ")+"")&&Se(p,m)},i:se,o:se,d(_){_&&ae(t)}}}function q9(e,t,n){let r=0,i=[],a=[],o=[];const s=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((u,d)=>{console.log(`MIDI device ${d}: ${u.name}`),u.addListener("noteon",l)}),[...D.inputs])},l=u=>{const d=(u.timestamp-r)/1e3,f={number:u.note.number,velocity:u.rawVelocity,time:d,channel:u.message.channel};i.push(f),c()},c=()=>{const u=Ge(i,d=>d.time);n(0,a=i.filter(d=>d.time>u-1).sort((d,f)=>d.number-f.number).map(d=>bn.fromMidiSharps(d.number))),n(0,a=[...new Set(a)]),n(1,o=Gg.detect(a))};return st(()=>{D.enable().then(s).catch(u=>alert(u)),r=performance.now(),c()}),lt(()=>{for(const u of D.inputs)u.removeListener()}),[a,o]}class H9 extends He{constructor(t){super(),qe(this,t,q9,U9,Ue,{})}}function Tr(e){return e!=null&&!Number.isNaN(e)}function en(e,t){return+Tr(t)-+Tr(e)||pt(e,t)}function Cs(e,t){return+Tr(t)-+Tr(e)||Fa(e,t)}function n2(e){return e!=null&&`${e}`!=""}function r2(e){return isFinite(e)?e:NaN}function ml(e){return e>0&&isFinite(e)?e:NaN}function Nf(e){return e<0&&isFinite(e)?e:NaN}function z9(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),a=e.getUTCMilliseconds();return`${V9(e.getUTCFullYear())}-${$n(e.getUTCMonth()+1,2)}-${$n(e.getUTCDate(),2)}${n||r||i||a?`T${$n(n,2)}:${$n(r,2)}${i||a?`:${$n(i,2)}${a?`.${$n(a,3)}`:""}`:""}Z`:""}`}function V9(e){return e<0?`-${$n(-e,6)}`:e>9999?`+${$n(e,6)}`:$n(e,4)}function $n(e,t){return`${e}`.padStart(t,"0")}const j9=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function i2(e,t){return j9.test(e+="")?new Date(e):typeof t=="function"?t(e):t}function gi(e){if(e==null)return;const t=e[0],n=e[e.length-1];return Fa(t,n)}const Yr=1e3,Zn=Yr*60,Jn=Zn*60,yn=Jn*24,on=yn*7,_r=yn*30,Yn=yn*365,rc=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",Yr],["5 seconds",5*Yr],["15 seconds",15*Yr],["30 seconds",30*Yr],["minute",Zn],["5 minutes",5*Zn],["15 minutes",15*Zn],["30 minutes",30*Zn],["hour",Jn],["3 hours",3*Jn],["6 hours",6*Jn],["12 hours",12*Jn],["day",yn],["2 days",2*yn],["week",on],["2 weeks",2*on],["month",_r],["3 months",3*_r],["6 months",6*_r],["year",Yn],["2 years",2*Yn],["5 years",5*Yn],["10 years",10*Yn],["20 years",20*Yn],["50 years",50*Yn],["100 years",100*Yn]],Cf=new Map([["second",Yr],["minute",Zn],["hour",Jn],["day",yn],["monday",on],["tuesday",on],["wednesday",on],["thursday",on],["friday",on],["saturday",on],["sunday",on],["week",on],["month",_r],["year",Yn]]),a2=new Map([["second",zt],["minute",ja],["hour",Wa],["day",Ir],["monday",_a],["tuesday",gp],["wednesday",yp],["thursday",Nr],["friday",_p],["saturday",wp],["sunday",mi],["week",mi],["month",Ka],["year",Zt]]),Tf=new Map([["second",zt],["minute",Ya],["hour",Xa],["day",il],["monday",wa],["tuesday",vp],["wednesday",Mp],["thursday",Cr],["friday",xp],["saturday",Ep],["sunday",pi],["week",pi],["month",Za],["year",Jt]]),to=Symbol("intervalDuration"),pl=Symbol("intervalType");for(const[e,t]of a2)t[to]=Cf.get(e),t[pl]="time";for(const[e,t]of Tf)t[to]=Cf.get(e),t[pl]="utc";const Xi=[["year",Jt,"utc"],["month",Za,"utc"],["day",il,"utc",6*_r],["hour",Xa,"utc",3*yn],["minute",Ya,"utc",6*Jn],["second",zt,"utc",30*Zn]],qo=[["year",Zt,"time"],["month",Ka,"time"],["day",Ir,"time",6*_r],["hour",Wa,"time",3*yn],["minute",ja,"time",6*Jn],["second",zt,"time",30*Zn]],Y9=[Xi[0],qo[0],Xi[1],qo[1],Xi[2],qo[2],...Xi.slice(3)];function o2(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),n=+r[1]),t){case"quarter":t="month",n*=3;break;case"half":t="month",n*=6;break}let i=Tf.get(t);if(!i)throw new Error(`unknown interval: ${e}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${t}`);return[t,n]}function s2(e){return c2(o2(e),"time")}function l2(e){return c2(o2(e),"utc")}function c2([e,t],n){let r=(n==="time"?a2:Tf).get(e);return t>1&&(r=r.every(t),r[to]=Cf.get(e)*t,r[pl]=n),r}function Ud(e,t){if(!(t>1))return;const n=e[to];if(!rc.some(([,i])=>i===n)||n%yn===0&&yn<n&&n<_r)return;const[r]=rc[Us(([,i])=>Math.log(i)).center(rc,Math.log(n*t))];return(e[pl]==="time"?s2:l2)(r)}function qd(e,t,n){const r=t==="time"?ff:Ja;if(n==null)return r(e==="year"?"%Y":e==="month"?"%Y-%m":e==="day"?"%Y-%m-%d":e==="hour"||e==="minute"?"%Y-%m-%dT%H:%M":e==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=W9(n);switch(e){case"millisecond":return Ur(r(".%L"),r(":%M:%S"),i);case"second":return Ur(r(":%S"),r("%-I:%M"),i);case"minute":return Ur(r("%-I:%M"),r("%p"),i);case"hour":return Ur(r("%-I %p"),r("%b %-d"),i);case"day":return Ur(r("%-d"),r("%b"),i);case"month":return Ur(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function W9(e){return e==="left"||e==="right"?(t,n)=>`
${t}
${n}`:e==="top"?(t,n)=>`${n}
${t}`:(t,n)=>`${t}
${n}`}function X9(e){return e==="time"?qo:e==="utc"?Xi:Y9}function K9(e,t,n){const r=Ge(pw(t,(i,a)=>Math.abs(a-i)));if(r<1e3)return qd("millisecond","utc",n);for(const[i,a,o,s]of X9(e)){if(r>s||i==="hour"&&!r)break;if(t.every(l=>a.floor(l)>=l))return qd(i,o,n)}}function Ur(e,t,n){return(r,i,a)=>{const o=e(r,i),s=t(r,i),l=i-gi(a);return i!==l&&a[l]!==void 0&&s===t(a[l],l)?o:n(o,s)}}const xa=Object.getPrototypeOf(Uint8Array),Z9=Object.prototype.toString,u2=Symbol("reindex");function We(e,t,n){const r=typeof t;return r==="string"?Hd(e,f2(t),n):r==="function"?Hd(e,t,n):r==="number"||t instanceof Date||r==="boolean"?Ze(e,no(t),n):typeof(t==null?void 0:t.transform)=="function"?zd(t.transform(e),n):J9(zd(t,n),e==null?void 0:e[u2])}function J9(e,t){return t?If(e,t):e}function Hd(e,t,n){return Ze(e,(n==null?void 0:n.prototype)instanceof xa?Q9(t):t,n)}function zd(e,t){return t===void 0?xt(e):e instanceof t?e:t.prototype instanceof xa&&!(e instanceof xa)?t.from(e,kf):t.from(e)}function Q9(e){return(t,n)=>kf(e(t,n))}const Ho=[null],f2=e=>t=>t[e],$f={transform:Hn},nt={transform:e=>e},ex=()=>1,tx=()=>!0,ut=e=>e==null?e:`${e}`,Ie=e=>e==null?e:+e,h2=e=>e?e[0]:void 0,yu=e=>e?e[1]:void 0,no=e=>()=>e;function nx(e){const t=+`${e}`.slice(1)/100;return(n,r)=>Jo(n,t,r)}function Wr(e){return e instanceof xa?e:Ze(e,kf,Float64Array)}function kf(e){return e==null?NaN:Number(e)}function rx(e){return Ze(e,ix)}function ix(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?i2(e):e==null||isNaN(e=+e)?void 0:new Date(e)}function Un(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:yl(e)?[void 0,e]:[e,void 0]}function ft(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function d2(e,t,n){if(e!=null)return nn(e,t,n)}function nn(e,t,n){const r=`${e}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${t}: ${e}`);return r}function xt(e){return e==null||e instanceof Array||e instanceof xa?e:Array.from(e)}function Ze(e,t,n=Array){return e==null?e:e instanceof n?e.map(t):n.from(e,t)}function Ea(e,t=Array){return e instanceof t?e.slice():t.from(e)}function m2({x:e,x1:t,x2:n}){return e!==void 0||t!==void 0||n!==void 0}function p2({y:e,y1:t,y2:n}){return e!==void 0||t!==void 0||n!==void 0}function b2(e){return m2(e)||p2(e)||e.interval!==void 0}function sr(e){return(e==null?void 0:e.toString)===Z9}function _u(e){return sr(e)&&(e.type!==void 0||e.domain!==void 0)}function bl(e){return sr(e)&&typeof e.transform!="function"}function yi(e){return bl(e)&&e.value===void 0&&e.channel===void 0}function g2(e,t,n,r=nt){return t===void 0&&n===void 0?(t=0,n=e===void 0?r:e):t===void 0?t=e===void 0?0:e:n===void 0&&(n=e===void 0?0:e),[t,n]}function ro(e,t){return e===void 0&&t===void 0?[h2,yu]:[e,t]}function ax({z:e,fill:t,stroke:n}={}){return e===void 0&&([e]=Un(t)),e===void 0&&([e]=Un(n)),e}function Hn(e){const t=e.length,n=new Uint32Array(t);for(let r=0;r<t;++r)n[r]=r;return n}function If(e,t){return Ze(t,n=>e[n],e.constructor)}function ox(e,t,n){return e.subarray?e.subarray(t,n):e.slice(t,n)}function Ao(e){return e!==null&&typeof e=="object"?e.valueOf():e}function sx(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function Ts(e){let t;return[{transform:()=>t,label:Ci(e)},n=>t=n]}function zr(e){return e==null?[e]:Ts(e)}function Ci(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function y2(e,t){return{transform(n){const r=e.transform(n),i=t.transform(n);return Rt(r)||Rt(i)?Ze(r,(a,o)=>new Date((+r[o]+ +i[o])/2)):Ze(r,(a,o)=>(+r[o]+ +i[o])/2,Float64Array)},label:e.label}}function wu(e,t){const n=_2(t==null?void 0:t.interval,t==null?void 0:t.type);return n?Ze(e,n):e}function _2(e,t){const n=Df(e,t);return n&&(r=>Tr(r)?n.floor(r):r)}function Df(e,t){if(e!=null){if(typeof e=="number"){0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const n=Math.abs(e);return e<0?{floor:r=>Math.floor(r*n)/n,offset:r=>(r*n+1)/n,range:(r,i)=>we(Math.ceil(r*n),i*n).map(a=>a/n)}:{floor:r=>Math.floor(r/n)*n,offset:r=>r+n,range:(r,i)=>we(Math.ceil(r/n),i/n).map(a=>a*n)}}if(typeof e=="string")return(t==="time"?s2:l2)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function io(e,t){if(e=Df(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function lx(e,t){if(e=io(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function cx(e){return typeof(e==null?void 0:e.range)=="function"}function gl(e){return e===void 0||bl(e)?e:{value:e}}function ux(e){return e==null?null:{transform:t=>We(t,e,Float64Array),label:Ci(e)}}function Br(e){return e&&typeof e[Symbol.iterator]=="function"}function w2(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function Vd(e){for(const t of e){if(t==null)continue;const n=typeof t;return n==="string"||n==="boolean"}}function Rt(e){for(const t of e)if(t!=null)return t instanceof Date}function fx(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&i2(t)}function hx(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function dx(e){for(const t of e)if(t!=null)return typeof t=="number"}function ic(e,t){let n;for(const r of e)if(r!=null){if(!t(r))return!1;n=!0}return n}const mx=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function yl(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||mx.has(e))}function px(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function dt(e){return e==null||Sa(e)}function Sa(e){return/^\s*none\s*$/i.test(e)}function bx(e){return/^\s*round\s*$/i.test(e)}function vu(e,t){return d2(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function _l(e="middle"){return vu(e,"frameAnchor")}function gx(e={},...t){let n=e;for(const r of t)for(const i in r)if(n[i]===void 0){const a=r[i];n===e?n={...n,[i]:a}:n[i]=a}return n}function yx(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(t.has(i))throw new Error(`duplicate name: ${i}`);return t.add(i),[r,n]}))}function v2(e){return Br(e)?yx(e):e}function M2(e){return e===!0?e="frame":e===!1?e=null:e!=null&&(e=nn(e,"clip",["frame","sphere"])),e}const fn=Symbol("position"),zn=Symbol("color"),ao=Symbol("radius"),oo=Symbol("length"),so=Symbol("opacity"),wl=Symbol("symbol"),x2=Symbol("projection"),Be=new Map([["x",fn],["y",fn],["fx",fn],["fy",fn],["r",ao],["color",zn],["opacity",so],["symbol",wl],["length",oo],["projection",x2]]);function _x(e){return e===fn||e===x2}function wx(e){return e===fn||e===ao||e===oo||e===so}const vx=Math.sqrt(3),Mx=2/vx,xx={draw(e,t){const n=Math.sqrt(t/Math.PI),r=n*Mx,i=r/2;e.moveTo(0,r),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(0,-r),e.lineTo(-n,-i),e.lineTo(-n,i),e.closePath()}},Rf=new Map([["asterisk",zb],["circle",Ma],["cross",Vb],["diamond",Yb],["diamond2",Wb],["hexagon",xx],["plus",Xb],["square",Kb],["square2",Zb],["star",Qb],["times",rg],["triangle",eg],["triangle2",tg],["wye",ng]]);function Lf(e){return e&&typeof e.draw=="function"}function Ex(e){return Lf(e)?!0:typeof e!="string"?!1:Rf.has(e.toLowerCase())}function Bf(e){if(e==null||Lf(e))return e;const t=Rf.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function Sx(e){if(e==null||Lf(e))return[void 0,e];if(typeof e=="string"){const t=Rf.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function vl({filter:e,sort:t,reverse:n,transform:r,initializer:i,...a}={},o){if(r===void 0&&(e!=null&&(r=E2(e)),t!=null&&!yi(t)&&(r=ac(r,Of(t))),n&&(r=ac(r,S2))),o!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...a,...(t===null||yi(t))&&{sort:t},transform:ac(r,o)}}function _i({filter:e,sort:t,reverse:n,initializer:r,...i}={},a){return r===void 0&&(e!=null&&(r=E2(e)),t!=null&&!yi(t)&&(r=oc(r,Of(t))),n&&(r=oc(r,S2))),{...i,...(t===null||yi(t))&&{sort:t},initializer:oc(r,a)}}function ac(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i){return{data:n,facets:r}=e.call(this,n,r,i),t.call(this,xt(n),r,i)}}function oc(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i,...a){let o,s,l,c,u,d;return{data:s=n,facets:l=r,channels:o}=e.call(this,n,r,i,...a),{data:u=s,facets:d=l,channels:c}=t.call(this,s,l,{...i,...o},...a),{data:u,facets:d,channels:{...o,...c}}}}function Ax(e,t){return(e.initializer!=null?_i:vl)(e,t)}function E2(e){return(t,n)=>{const r=We(t,e);return{data:t,facets:n.map(i=>i.filter(a=>r[a]))}}}function S2(e,t){return{data:e,facets:t.map(n=>n.slice().reverse())}}function Px(e,{sort:t,...n}={}){return{...(bl(e)&&e.channel!==void 0?_i:Ax)(n,Of(e)),sort:yi(t)?t:null}}function Of(e){return(typeof e=="function"&&e.length!==1?Nx:Cx)(e)}function Nx(e){return(t,n)=>{const r=(i,a)=>e(t[i],t[a]);return{data:t,facets:n.map(i=>i.slice().sort(r))}}}function Cx(e){let t,n;({channel:t,value:e,order:n}={...gl(e)});const r=t==null?void 0:t.startsWith("-");if(r&&(t=t.slice(1)),n===void 0&&(n=r?Cs:en),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=en;break;case"descending":n=Cs;break;default:throw new Error(`invalid order: ${n}`)}return(i,a,o)=>{let s;if(t===void 0)s=We(i,e);else{if(o===void 0)throw new Error("channel sort requires an initializer");if(s=o[t],!s)return{};s=s.value}const l=(c,u)=>n(s[c],s[u]);return{data:i,facets:a.map(c=>c.slice().sort(l))}}}function Tx(e={y:"count"},t={}){const{x:n=nt}=t;if(n==null)throw new Error("missing channel: x");return A2(n,null,e,t)}function $x(e={fill:"count"},t={}){let{x:n,y:r}=t;if([n,r]=ro(n,r),n==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return A2(n,r,e,t)}function A2(e,t,{data:n=k2,filter:r,sort:i,reverse:a,...o}={},s={}){o=Rx(o,s),n=$2(n,nt),i=i==null?void 0:C2("sort",i,s),r=r==null?void 0:T2("filter",r,s);const[l,c]=zr(e),[u,d]=zr(t),{z:f,fill:h,stroke:m,x1:p,x2:_,y1:w,y2:g,...E}=s,[v,x]=zr(f),[y]=Un(h),[M]=Un(m),[A,S]=zr(y),[$,C]=zr(M);return{..."z"in s&&{z:v||f},..."fill"in s&&{fill:A||h},..."stroke"in s&&{stroke:$||m},...vl(E,(k,B,G)=>{const T=wu(We(k,e),G==null?void 0:G.x),I=wu(We(k,t),G==null?void 0:G.y),O=We(k,f),q=We(k,y),z=We(k,M),H=Bx(o,{z:O,fill:q,stroke:z}),J=[],Z=[],F=T&&c([]),te=I&&d([]),ne=O&&x([]),re=q&&S([]),Q=z&&C([]);let Y=0;for(const R of o)R.initialize(k);i&&i.initialize(k),r&&r.initialize(k);for(const R of B){const V=[];for(const W of o)W.scope("facet",R);i&&i.scope("facet",R),r&&r.scope("facet",R);for(const[W,U]of sc(R,H))for(const[fe,ue]of sc(U,I))for(const[ie,he]of sc(ue,T)){const le={data:k};if(T&&(le.x=ie),I&&(le.y=fe),H&&(le.z=W),!(r&&!r.reduce(he,le))){V.push(Y++),Z.push(n.reduceIndex(he,k,le)),T&&F.push(ie),I&&te.push(fe),O&&ne.push(H===O?W:O[he[0]]),q&&re.push(H===q?W:q[he[0]]),z&&Q.push(H===z?W:z[he[0]]);for(const je of o)je.reduce(he,le);i&&i.reduce(he,le)}}J.push(V)}return Ox(J,i,a),{data:Z,facets:J}}),...!jd(o,"x")&&(l?{x:l}:{x1:p,x2:_}),...!jd(o,"y")&&(u?{y:u}:{y1:w,y2:g}),...Object.fromEntries(o.map(({name:k,output:B})=>[k,B]))}}function jd(e,...t){for(const{name:n}of e)if(t.includes(n))return!0;return!1}function kx(e,t,n=P2){const r=Object.entries(e);return t.title!=null&&e.title===void 0&&r.push(["title",Ux]),t.href!=null&&e.href===void 0&&r.push(["href",I2]),r.filter(([,i])=>i!==void 0).map(([i,a])=>a===null?Ix(i):n(i,a,t))}function P2(e,t,n,r=N2){let i;sr(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);const a=r(e,t,n),[o,s]=Ts(a.label);let l;return{name:e,output:i===void 0?o:{value:o,scale:i},initialize(c){a.initialize(c),l=s([])},scope(c,u){a.scope(c,u)},reduce(c,u){l.push(a.reduce(c,u))}}}function Ix(e){return{name:e,initialize(){},scope(){},reduce(){}}}function N2(e,t,n,r=Ff){const i=sx(e,n),a=r(t,i);let o,s;return{label:Ci(a===Mu?null:i,a.label),initialize(l){o=i===void 0?l:We(l,i),a.scope==="data"&&(s=a.reduceIndex(Hn(l),o))},scope(l,c){a.scope===l&&(s=a.reduceIndex(c,o))},reduce(l,c){return a.scope==null?a.reduceIndex(l,o,c):a.reduceIndex(l,o,s,c)}}}function sc(e,t){return t?Uu(e,n=>t[n]):[[,e]]}function Ff(e,t,n=Dx){if(e==null)return n(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&sr(e))return Fx(e);if(typeof e=="function")return Gx(e);if(/^p\d{2}$/i.test(e))return Tn(nx(e));switch(`${e}`.toLowerCase()){case"first":return I2;case"last":return qx;case"identity":return k2;case"count":return Mu;case"distinct":return Hx;case"sum":return t==null?Mu:zx;case"proportion":return Wd(t,"data");case"proportion-facet":return Wd(t,"facet");case"deviation":return Tn(ew);case"min":return Tn(Xt);case"min-index":return Tn(B1);case"max":return Tn(Ge);case"max-index":return Tn(fw);case"mean":return Yd(G1);case"median":return Yd(kc);case"variance":return Tn(k1);case"mode":return Tn(mw)}return n(e)}function Dx(e){throw new Error(`invalid reduce: ${e}`)}function Rx(e,t){return kx(e,t,C2)}function C2(e,t,n){return P2(e,t,n,T2)}function T2(e,t,n){return N2(e,t,n,$2)}function $2(e,t){return Ff(e,t,Lx)}function Lx(e){switch(`${e}`.toLowerCase()){case"x":return Vx;case"y":return jx;case"z":return Yx}throw new Error(`invalid group reduce: ${e}`)}function Bx(e,t){for(const n in t){const r=t[n];if(r!==void 0&&!e.some(i=>i.name===n))return r}}function Ox(e,t,n){if(t){const r=t.output.transform(),i=(a,o)=>en(r[a],r[o]);e.forEach(a=>a.sort(i))}n&&e.forEach(r=>r.reverse())}function Fx(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function Gx(e){return{reduceIndex(t,n,r){return e(If(n,t),r)}}}function Tn(e){return{reduceIndex(t,n){return e(t,r=>n[r])}}}function Yd(e){return{reduceIndex(t,n){const r=e(t,i=>n[i]);return Rt(n)?new Date(r):r}}}const k2={reduceIndex(e,t){return If(t,e)}},I2={reduceIndex(e,t){return t[e[0]]}},Ux={reduceIndex(e,t){const r=Xo(Kr(e,a=>a.length,a=>t[a]),yu),i=r.slice(-5).reverse();if(i.length<r.length){const a=r.slice(0,-4);i[4]=[` ${a.length.toLocaleString("en-US")} more`,Qn(a,yu)]}return i.map(([a,o])=>`${a} (${o.toLocaleString("en-US")})`).join(`
`)}},qx={reduceIndex(e,t){return t[e[e.length-1]]}},Mu={label:"Frequency",reduceIndex(e){return e.length}},Hx={label:"Distinct",reduceIndex(e,t){const n=new Hs;for(const r of e)n.add(t[r]);return n.size}},zx=Tn(Qn);function Wd(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:t,reduceIndex:(n,r,i=1)=>Qn(n,a=>r[a])/i}}const Vx={reduceIndex(e,t,{x:n}){return n}},jx={reduceIndex(e,t,{y:n}){return n}},Yx={reduceIndex(e,t,{z:n}){return n}};function Aa(e,{scale:t,type:n,value:r,filter:i,hint:a,label:o=Ci(r)},s){return a===void 0&&typeof(r==null?void 0:r.transform)=="function"&&(a=r.hint),D2(s,{scale:t,type:n,value:We(e,r),label:o,filter:i,hint:a})}function Wx(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,Aa(t,r,n)]))}function Xx(e,t){const n=Object.fromEntries(Object.entries(e).map(([r,{scale:i,value:a}])=>{const o=i==null?null:t[i];return[r,o==null?a:Ze(a,o)]}));return n.channels=e,n}function D2(e,t){const{scale:n,value:r}=t;if(n===!0||n==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=n!==!0&&ic(r,yl)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=n!==!0&&ic(r,px)?null:"opacity";break;case"symbol":n!==!0&&ic(r,Ex)?(t.scale=null,t.value=Ze(r,Bf)):t.scale="symbol";break;default:t.scale=Be.has(e)?e:null;break}else if(n===!1)t.scale=null;else if(n!=null&&!Be.has(n))throw new Error(`unknown scale: ${n}`);return t}function Kx(e,t,n,r,i){const{order:a,reverse:o,reduce:s=!0,limit:l}=i;for(const c in i){if(!Be.has(c))continue;let{value:u,order:d=a,reverse:f=o,reduce:h=s,limit:m=l}=gl(i[c]);const p=u==null?void 0:u.startsWith("-");if(p&&(u=u.slice(1)),d=d===void 0?p!==(u==="width"||u==="height")?L2:R2:Qx(d),h==null||h===!1)continue;const _=c==="fx"||c==="fy"?Jx(t,r[c]):Zx(n,c);if(!_)throw new Error(`missing channel for scale: ${c}`);const w=_.value,[g=0,E=1/0]=Br(m)?m:m<0?[m]:[0,m];if(u==null)_.domain=()=>{let v=Array.from(new Hs(w));return f&&(v=v.reverse()),(g!==0||E!==1/0)&&(v=v.slice(g,E)),v};else{const v=u==="data"?e:u==="height"?Xd(n,"y1","y2"):u==="width"?Xd(n,"x1","x2"):xu(n,u,u==="y"?"y2":u==="x"?"x2":void 0),x=Ff(h===!0?"max":h,v);_.domain=()=>{let y=tw(Hn(w),M=>x.reduceIndex(M,v),M=>w[M]);return d&&y.sort(d),f&&y.reverse(),(g!==0||E!==1/0)&&(y=y.slice(g,E)),y.map(h2)}}}}function Zx(e,t){for(const n in e){const r=e[n];if(r.scale===t)return r}}function Jx(e,t){const n=e.original;if(n===e)return t;const r=t.value,i=t.value=[];for(let a=0;a<n.length;++a){const o=r[n[a][0]];for(const s of e[a])i[s]=o}return t}function Xd(e,t,n){const r=xu(e,t),i=xu(e,n);return Ze(i,(a,o)=>Math.abs(a-r[o]),Float64Array)}function xu(e,t,n){let r=e[t];if(!r&&n!==void 0&&(r=e[n]),r)return r.value;throw new Error(`missing channel: ${t}`)}function Qx(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return R2;case"descending":return L2}throw new Error(`invalid order: ${e}`)}function R2([e,t],[n,r]){return en(t,r)||en(e,n)}function L2([e,t],[n,r]){return Cs(t,r)||en(e,n)}function Kd(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}function Gf(e={}){const{document:t=typeof window<"u"?window.document:void 0,clip:n}=e;return{document:t,clip:M2(n)}}function Qe(e,{document:t}){return ta(js(e).call(t.documentElement))}let Eu=0,Su;function eE(){const e=Eu;return Eu=0,Su=void 0,e}function wr(e){e!==Su&&(Su=e,console.warn(e),++Eu)}const B2=Math.PI,Pn=2*B2,Zd=.618;function tE({projection:e,inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:a=t}={},o){if(e==null)return;if(typeof e.stream=="function")return e;let s,l,c="frame";if(sr(e)){let x;if({type:e,domain:l,inset:x,insetTop:n=x!==void 0?x:n,insetRight:r=x!==void 0?x:r,insetBottom:i=x!==void 0?x:i,insetLeft:a=x!==void 0?x:a,clip:c=c,...s}=e,e==null)return}typeof e!="function"&&({type:e}=O2(e));const{width:u,height:d,marginLeft:f,marginRight:h,marginTop:m,marginBottom:p}=o,_=u-f-h-a-r,w=d-m-p-n-i;if(e=e==null?void 0:e({width:_,height:w,clip:c,...s}),e==null)return;c=nE(c,f,m,u-h,d-p);let g=f+a,E=m+n,v;if(l!=null){const[[x,y],[M,A]]=rf(e).bounds(l),S=Math.min(_/(M-x),w/(A-y));S>0?(g-=(S*(x+M)-_)/2,E-=(S*(y+A)-w)/2,v=iu({point($,C){this.stream.point($*S+g,C*S+E)}})):wr("Warning: the projection could not be fit to the specified domain; using the default scale.")}return v??(v=g===0&&E===0?F2():iu({point(x,y){this.stream.point(x+g,y+E)}})),{stream:x=>e.stream(v.stream(c(x)))}}function O2(e){switch(`${e}`.toLowerCase()){case"albers-usa":return Ut(V7,.7463,.4673);case"albers":return Po(X0,.7463,.4673);case"azimuthal-equal-area":return Ut(j7,4,4);case"azimuthal-equidistant":return Ut(Y7,Pn,Pn);case"conic-conformal":return Po(K7,Pn,Pn);case"conic-equal-area":return Po(bs,6.1702,2.9781);case"conic-equidistant":return Po(Q7,7.312,3.6282);case"equal-earth":return Ut(t6,5.4133,2.6347);case"equirectangular":return Ut(Z7,Pn,B2);case"gnomonic":return Ut(n6,3.4641,3.4641);case"identity":return{type:F2};case"reflect-y":return{type:rE};case"mercator":return Ut(W7,Pn,Pn);case"orthographic":return Ut(r6,2,2);case"stereographic":return Ut(i6,2,2);case"transverse-mercator":return Ut(a6,Pn,Pn);default:throw new Error(`unknown projection type: ${e}`)}}function nE(e,t,n,r,i){if(e===!1||e==null||typeof e=="number")return a=>a;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return I0(t,n,r,i);default:throw new Error(`unknown projection clip type: ${e}`)}}function Ut(e,t,n){return{type:({width:r,height:i,rotate:a,precision:o=.15,clip:s})=>{var c,u,d;const l=e();return o!=null&&((c=l.precision)==null||c.call(l,o)),a!=null&&((u=l.rotate)==null||u.call(l,a)),typeof s=="number"&&((d=l.clipAngle)==null||d.call(l,s)),l.scale(Math.min(r/t,i/n)),l.translate([r/2,i/2]),l},aspectRatio:n/t}}function Po(e,t,n){const{type:r,aspectRatio:i}=Ut(e,t,n);return{type:a=>{const{parallels:o,domain:s,width:l,height:c}=a,u=r(a);return o!=null&&(u.parallels(o),s===void 0&&u.fitSize([l,c],{type:"Sphere"})),u},aspectRatio:i}}const F2=no({stream:e=>e}),rE=no(iu({point(e,t){this.stream.point(e,-t)}}));function iE(e,t,n,r){const i=n[e],a=n[t],o=i.length,s=n[e]=new Float64Array(o).fill(NaN),l=n[t]=new Float64Array(o).fill(NaN);let c;const u=r.stream({point(d,f){s[c]=d,l[c]=f}});for(c=0;c<o;++c)u.point(i[c],a[c])}function aE({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(sr(e)&&(e=e.type),e!=null)}function oE(e){if(typeof(e==null?void 0:e.stream)=="function")return Zd;if(sr(e)&&(e=e.type),e!=null){if(typeof e!="function"){const{aspectRatio:t}=O2(e);if(t)return t}return Zd}}function sE(e){const t=[],n=[],r={scale:"x",value:t},i={scale:"y",value:n},a={point(o,s){t.push(o),n.push(s)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const o of e.value)dr(o,a);return[r,i]}const G2=new Map([["accent",C4],["category10",N4],["dark2",T4],["observable10",$4],["paired",k4],["pastel1",I4],["pastel2",D4],["set1",R4],["set2",L4],["set3",B4],["tableau10",O4]]);function lE(e){return e!=null&&G2.has(`${e}`.toLowerCase())}const Jd=new Map([...G2,["brbg",Nn(Dp,Rp)],["prgn",Nn(Lp,Bp)],["piyg",Nn(Op,Fp)],["puor",Nn(Gp,Up)],["rdbu",Nn(cu,ws)],["rdgy",Nn(qp,Hp)],["rdylbu",Nn(uu,va)],["rdylgn",Nn(zp,Vp)],["spectral",Nn(jp,Yp)],["burd",Qd(cu,ws)],["buylrd",Qd(uu,va)],["blues",Ye(yb,_b)],["greens",Ye(wb,vb)],["greys",Ye(Mb,xb)],["oranges",Ye(Nb,Cb)],["purples",Ye(Eb,Sb)],["reds",Ye(Ab,Pb)],["turbo",Cn(Lb)],["viridis",Cn(Bb)],["magma",Cn(Ob)],["inferno",Cn(Fb)],["plasma",Cn(Gb)],["cividis",Cn(Tb)],["cubehelix",Cn($b)],["warm",Cn(kb)],["cool",Cn(Ib)],["bugn",Ye(Wp,Xp)],["bupu",Ye(Kp,Zp)],["gnbu",Ye(Jp,Qp)],["orrd",Ye(eb,tb)],["pubu",Ye(ib,ab)],["pubugn",Ye(nb,rb)],["purd",Ye(ob,sb)],["rdpu",Ye(lb,cb)],["ylgn",Ye(hb,db)],["ylgnbu",Ye(ub,fb)],["ylorbr",Ye(mb,pb)],["ylorrd",Ye(bb,gb)],["rainbow",em(Db)],["sinebow",em(Rb)]]);function Ye(e,t){return({length:n})=>n===1?[e[3][1]]:n===2?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?Kt(t,n):e[n])}function Nn(e,t){return({length:n})=>n===2?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?Kt(t,n):e[n])}function Qd(e,t){return({length:n})=>n===2?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?Kt(r=>t(1-r),n):e[n].slice().reverse())}function Cn(e){return({length:t})=>Kt(e,Math.max(2,Math.floor(t)))}function em(e){return({length:t})=>Kt(e,Math.floor(t)+1).slice(0,-1)}function U2(e){const t=`${e}`.toLowerCase();if(!Jd.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return Jd.get(t)}function Ml(e,t){const n=U2(e),r=typeof n=="function"?n({length:t}):n;return r.length!==t?r.slice(0,t):r}function cE(e,t="greys"){const n=new Set,[r,i]=Ml(t,2);for(const a of e)if(a!=null)if(a===!0)n.add(i);else if(a===!1)n.add(r);else return;return[...n]}const tm=new Map([["brbg",Rp],["prgn",Bp],["piyg",Fp],["puor",Up],["rdbu",ws],["rdgy",Hp],["rdylbu",va],["rdylgn",Vp],["spectral",Yp],["burd",e=>ws(1-e)],["buylrd",e=>va(1-e)],["blues",_b],["greens",vb],["greys",xb],["purples",Sb],["reds",Pb],["oranges",Cb],["turbo",Lb],["viridis",Bb],["magma",Ob],["inferno",Fb],["plasma",Gb],["cividis",Tb],["cubehelix",$b],["warm",kb],["cool",Ib],["bugn",Xp],["bupu",Zp],["gnbu",Qp],["orrd",tb],["pubugn",rb],["pubu",ab],["purd",sb],["rdpu",cb],["ylgnbu",fb],["ylgn",db],["ylorbr",pb],["ylorrd",gb],["rainbow",Db],["sinebow",Rb]]);function Uf(e){const t=`${e}`.toLowerCase();if(!tm.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return tm.get(t)}const uE=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function fE(e){return e!=null&&uE.has(`${e}`.toLowerCase())}const q2=e=>t=>e(1-t),lc=[0,1],nm=new Map([["number",rt],["rgb",Sr],["hsl",F3],["hcl",q3],["lab",G3]]);function H2(e){const t=`${e}`.toLowerCase();if(!nm.has(t))throw new Error(`unknown interpolator: ${t}`);return nm.get(t)}function lo(e,t,n,{type:r,nice:i,clamp:a,zero:o,domain:s=V2(e,n),unknown:l,round:c,scheme:u,interval:d,range:f=Be.get(e)===ao?ME(n,s):Be.get(e)===oo?xE(n,s):Be.get(e)===so?lc:void 0,interpolate:h=Be.get(e)===zn?u==null&&f!==void 0?Sr:Uf(u!==void 0?u:r==="cyclical"?"rainbow":"turbo"):c?Ku:rt,reverse:m}){if(d=io(d,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof h!="function"&&(h=H2(h)),m=!!m,f!==void 0){const p=(s=xt(s)).length,_=(f=xt(f)).length;if(p!==_){if(h.length===1)throw new Error("invalid piecewise interpolator");h=Xs(h,f),f=void 0}}if(h.length===1?(m&&(h=q2(h),m=!1),f===void 0&&(f=Float64Array.from(s,(p,_)=>_/(s.length-1)),f.length===2&&(f=lc)),t.interpolate((f===lc?no:Hf)(h))):t.interpolate(h),o){const[p,_]=ht(s);(p>0||_<0)&&(s=Ea(s),gi(s)!==Math.sign(p)?s[s.length-1]=0:s[0]=0)}return m&&(s=Qo(s)),t.domain(s).unknown(l),i&&(t.nice(hE(i,r)),s=t.domain()),f!==void 0&&t.range(f),a&&t.clamp(a),{type:r,domain:s,range:f,scale:t,interpolate:h,interval:d}}function hE(e,t){return e===!0?void 0:typeof e=="number"?e:lx(e,t)}function dE(e,t,n){return lo(e,cf(),t,n)}function mE(e,t,n){return z2(e,t,{...n,exponent:.5})}function z2(e,t,{exponent:n=1,...r}){return lo(e,mp().exponent(n),t,{...r,type:"pow"})}function pE(e,t,{base:n=10,domain:r=EE(t),...i}){return lo(e,up().base(n),t,{...i,domain:r})}function bE(e,t,{constant:n=1,...r}){return lo(e,hp().constant(n),t,r)}function gE(e,t,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:a="rdylbu",domain:o=SE(t),unknown:s,interpolate:l,reverse:c}){return n===void 0&&(n=l!==void 0?Kt(l,i):Be.get(e)===zn?Ml(a,i):void 0),o.length>0&&(o=pp(o,n===void 0?{length:i}:n).quantiles()),qf(e,t,{domain:o,range:n,reverse:c,unknown:s})}function yE(e,t,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:a=V2(e,t),unknown:o,interpolate:s,reverse:l}){const[c,u]=ht(a);let d;return n===void 0?(d=ha(c,u,r),d[0]<=c&&d.splice(0,1),d[d.length-1]>=u&&d.pop(),r=d.length+1,n=s!==void 0?Kt(s,r):Be.get(e)===zn?Ml(i,r):void 0):(d=Kt(rt(c,u),r+1).slice(1,-1),c instanceof Date&&(d=d.map(f=>new Date(f)))),gi(xt(a))<0&&d.reverse(),qf(e,t,{domain:d,range:n,reverse:l,unknown:o})}function qf(e,t,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:a,range:o=a!==void 0?Kt(a,n.length+1):Be.get(e)===zn?Ml(i,n.length+1):void 0,reverse:s}){n=xt(n);const l=gi(n);if(!isNaN(l)&&!_E(n,l))throw new Error(`the ${e} scale has a non-monotonic domain`);return s&&(o=Qo(o)),{type:"threshold",scale:bp(l<0?Qo(n):n,o===void 0?[]:o).unknown(r),domain:n,range:o}}function _E(e,t){for(let n=1,r=e.length,i=e[0];n<r;++n){const a=Fa(i,i=e[n]);if(a!==0&&a!==t)return!1}return!0}function wE(e){return{type:"identity",scale:wx(Be.get(e))?sp():t=>t}}function Pa(e,t=r2){return e.length?[Xt(e,({value:n})=>n===void 0?n:Xt(n,t)),Ge(e,({value:n})=>n===void 0?n:Ge(n,t))]:[0,1]}function V2(e,t){const n=Be.get(e);return(n===ao||n===so||n===oo?vE:Pa)(t)}function vE(e){return[0,e.length?Ge(e,({value:t})=>t===void 0?t:Ge(t,r2)):1]}function ME(e,t){const n=e.find(({radius:o})=>o!==void 0);if(n!==void 0)return[0,n.radius];const r=Jo(e,.5,({value:o})=>o===void 0?NaN:Jo(o,.25,ml)),i=t.map(o=>3*Math.sqrt(o/r)),a=30/Ge(i);return a<1?i.map(o=>o*a):i}function xE(e,t){const n=kc(e,({value:a})=>a===void 0?NaN:kc(a,Math.abs)),r=t.map(a=>12*a/n),i=60/Ge(r);return i<1?r.map(a=>a*i):r}function EE(e){for(const{value:t}of e)if(t!==void 0)for(let n of t){if(n>0)return Pa(e,ml);if(n<0)return Pa(e,Nf)}return[1,10]}function SE(e){const t=[];for(const{value:n}of e)if(n!==void 0)for(const r of n)t.push(r);return t}function Hf(e){return(t,n)=>r=>e(t+r*(n-t))}function xl(e,t,n,r,{type:i,nice:a,clamp:o,domain:s=Pa(r),unknown:l,pivot:c=0,scheme:u,range:d,symmetric:f=!0,interpolate:h=Be.get(e)===zn?u==null&&d!==void 0?Sr:Uf(u!==void 0?u:"rdbu"):rt,reverse:m}){c=+c,s=xt(s);let[p,_]=s;if(s.length>2&&wr(`Warning: the diverging ${e} scale domain contains extra elements.`),Fa(p,_)<0&&([p,_]=[_,p],m=!m),p=Math.min(p,c),_=Math.max(_,c),typeof h!="function"&&(h=H2(h)),d!==void 0&&(h=h.length===1?Hf(h)(...d):Xs(h,d)),m&&(h=q2(h)),f){const w=n.apply(c),g=w-n.apply(p),E=n.apply(_)-w;g<E?p=n.invert(w-E):g>E&&(_=n.invert(w+g))}return t.domain([p,c,_]).unknown(l).interpolator(h),o&&t.clamp(o),a&&t.nice(a),{type:i,domain:[p,_],pivot:c,interpolate:h,scale:t}}function AE(e,t,n){return xl(e,Tp(),TE,t,n)}function PE(e,t,n){return j2(e,t,{...n,exponent:.5})}function j2(e,t,{exponent:n=1,...r}){return xl(e,Ip().exponent(n=+n),IE(n),t,{...r,type:"diverging-pow"})}function NE(e,t,{base:n=10,pivot:r=1,domain:i=Pa(t,r<0?Nf:ml),...a}){return xl(e,$p().base(n=+n),$E,t,{domain:i,pivot:r,...a})}function CE(e,t,{constant:n=1,...r}){return xl(e,kp().constant(n=+n),DE(n),t,r)}const TE={apply(e){return e},invert(e){return e}},$E={apply:Math.log,invert:Math.exp},kE={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function IE(e){return e===.5?kE:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function DE(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function Y2(e,t,n,r){return lo(e,t,n,r)}function RE(e,t,n){return Y2(e,A4(),t,n)}function LE(e,t,n){return Y2(e,P4(),t,n)}const co=Symbol("ordinal");function W2(e,t,n,{type:r,interval:i,domain:a,range:o,reverse:s,hint:l}){return i=io(i,r),a===void 0&&(a=K2(n,i,e)),(r==="categorical"||r===co)&&(r="ordinal"),s&&(a=Qo(a)),a=t.domain(a).domain(),o!==void 0&&(typeof o=="function"&&(o=o(a)),t.range(o)),{type:r,domain:a,range:o,scale:t,hint:l,interval:i}}function BE(e,t,{type:n,interval:r,domain:i,range:a,scheme:o,unknown:s,...l}){r=io(r,n),i===void 0&&(i=K2(t,r,e));let c;if(Be.get(e)===wl)c=GE(t),a=a===void 0?UE(c):Ze(a,Bf);else if(Be.get(e)===zn&&(a===void 0&&(n==="ordinal"||n===co)&&(a=cE(i,o),a!==void 0&&(o=void 0)),o===void 0&&a===void 0&&(o=n==="ordinal"?"turbo":"observable10"),o!==void 0))if(a!==void 0){const u=Uf(o),d=a[0],f=a[1]-a[0];a=({length:h})=>Kt(m=>u(d+f*m),h)}else a=U2(o);if(s===ou)throw new Error(`implicit unknown on ${e} scale is not supported`);return W2(e,lf().unknown(s),t,{...l,type:n,domain:i,range:a,hint:c})}function OE(e,t,{align:n=.5,padding:r=.5,...i}){return X2(o6().align(n).padding(r),t,i,e)}function FE(e,t,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:a=e==="fx"||e==="fy"?0:r,...o}){return X2(tl().align(n).paddingInner(i).paddingOuter(a),t,o,e)}function X2(e,t,n,r){let{round:i}=n;return i!==void 0&&e.round(i=!!i),e=W2(r,e,t,n),e.round=i,e}function K2(e,t,n){const r=new Hs;for(const{value:i,domain:a}of e){if(a!==void 0)return a();if(i!==void 0)for(const o of i)r.add(o)}if(t!==void 0){const[i,a]=ht(r).map(t.floor,t);return t.range(i,t.offset(a))}if(r.size>1e4&&Be.get(n)===fn)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return Xo(r,en)}function rm(e,t){let n;for(const{hint:r}of e){const i=r==null?void 0:r[t];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function GE(e){return{fill:rm(e,"fill"),stroke:rm(e,"stroke")}}function UE(e){return dt(e.fill)?Z4:K4}function Au(e,{label:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:a=n,insetLeft:o=n,round:s,nice:l,clamp:c,zero:u,align:d,padding:f,projection:h,facet:{label:m=t}={},...p}={}){const _={};for(const[w,g]of e){const E=p[w],v=jE(w,g,{round:Be.get(w)===fn?s:void 0,nice:l,clamp:c,zero:u,align:d,padding:f,projection:h,...E});if(v){let{label:x=w==="fx"||w==="fy"?m:t,percent:y,transform:M,inset:A,insetTop:S=A!==void 0?A:w==="y"?r:0,insetRight:$=A!==void 0?A:w==="x"?i:0,insetBottom:C=A!==void 0?A:w==="y"?a:0,insetLeft:k=A!==void 0?A:w==="x"?o:0}=E||{};if(M==null)M=void 0;else if(typeof M!="function")throw new Error("invalid scale transform; not a function");v.percent=!!y,v.label=x===void 0?HE(g,v):x,v.transform=M,w==="x"||w==="fx"?(v.insetLeft=+k,v.insetRight=+$):(w==="y"||w==="fy")&&(v.insetTop=+S,v.insetBottom=+C),_[w]=v}}return _}function im(e){const t={},n={scales:t};for(const[r,i]of Object.entries(e)){const{scale:a,type:o,interval:s,label:l}=i;t[r]=ZE(i),n[r]=a,a.type=o,s!=null&&(a.interval=s),l!=null&&(a.label=l)}return n}function qE(e,t){const{x:n,y:r,fx:i,fy:a}=e,o=i||a?zf(t):t;i&&am(i,o),a&&om(a,o);const s=i||a?Z2(e,t):t;n&&am(n,s),r&&om(r,s)}function HE(e=[],t){let n;for(const{label:r}of e)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!Or(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function zE(e){return Math.sign(gi(e.domain()))*Math.sign(gi(e.range()))}function zf(e){const{marginTop:t,marginRight:n,marginBottom:r,marginLeft:i,width:a,height:o,facet:{marginTop:s,marginRight:l,marginBottom:c,marginLeft:u}}=e;return{marginTop:Math.max(t,s),marginRight:Math.max(n,l),marginBottom:Math.max(r,c),marginLeft:Math.max(i,u),width:a,height:o}}function Z2({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:a,marginLeft:o,width:s,height:l}=zf(n);return{marginTop:r,marginRight:i,marginBottom:a,marginLeft:o,width:e?e.scale.bandwidth()+o+i:s,height:t?t.scale.bandwidth()+r+a:l,facet:{width:s,height:l}}}function am(e,t){if(e.range===void 0){const{insetLeft:n,insetRight:r}=e,{width:i,marginLeft:a=0,marginRight:o=0}=t,s=a+n,l=i-o-r;e.range=[s,Math.max(s,l)],Or(e)||(e.range=Q2(e)),e.scale.range(e.range)}J2(e)}function om(e,t){if(e.range===void 0){const{insetTop:n,insetBottom:r}=e,{height:i,marginTop:a=0,marginBottom:o=0}=t,s=a+n,l=i-o-r;e.range=[Math.max(s,l),s],Or(e)?e.range.reverse():e.range=Q2(e),e.scale.range(e.range)}J2(e)}function J2(e){e.round===void 0&&WE(e)&&VE(e)<=30&&e.scale.round(!0)}function VE({scale:e}){const t=e.domain().length,[n,r]=e.range(),i=e.paddingInner?e.paddingInner():1,a=e.paddingOuter?e.paddingOuter():e.padding(),o=t-i,s=Math.abs(r-n)/Math.max(1,o+a*2);return(s-Math.floor(s))*o}function Q2(e){const t=e.scale.domain().length+ey(e);if(!(t>2))return e.range;const[n,r]=e.range;return Array.from({length:t},(i,a)=>n+a/(t-1)*(r-n))}function jE(e,t=[],n={}){const r=YE(e,t,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&e!=="fx"&&e!=="fy"&&Or({type:r})){const i=t.map(({value:a})=>a).filter(a=>a!==void 0);i.some(Rt)?wr(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${qr(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${qr(r)}".`):i.some(fx)?wr(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${qr(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${qr(r)}".`):i.some(hx)&&wr(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${qr(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${qr(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=No(t,n,Wr);break;case"identity":switch(Be.get(e)){case fn:n=No(t,n,Wr);break;case wl:n=No(t,n,XE);break}break;case"utc":case"time":n=No(t,n,rx);break}switch(r){case"diverging":return AE(e,t,n);case"diverging-sqrt":return PE(e,t,n);case"diverging-pow":return j2(e,t,n);case"diverging-log":return NE(e,t,n);case"diverging-symlog":return CE(e,t,n);case"categorical":case"ordinal":case co:return BE(e,t,n);case"cyclical":case"sequential":case"linear":return dE(e,t,n);case"sqrt":return mE(e,t,n);case"threshold":return qf(e,t,n);case"quantile":return gE(e,t,n);case"quantize":return yE(e,t,n);case"pow":return z2(e,t,n);case"log":return pE(e,t,n);case"symlog":return bE(e,t,n);case"utc":return LE(e,t,n);case"time":return RE(e,t,n);case"point":return OE(e,t,n);case"band":return FE(e,t,n);case"identity":return wE(e);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function qr(e){return typeof e=="symbol"?e.description:e}function sm(e){return typeof e=="string"?`${e}`.toLowerCase():e}const lm={toString:()=>"projection"};function YE(e,t,{type:n,domain:r,range:i,scheme:a,pivot:o,projection:s}){if(n=sm(n),e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&s!=null&&(n=lm);for(const c of t){const u=sm(c.type);if(u!==void 0){if(n===void 0)n=u;else if(n!==u)throw new Error(`scale incompatible with channel: ${n} !== ${u}`)}}if(n===lm)return;if(n!==void 0)return n;if(r===void 0&&!t.some(({value:c})=>c!==void 0))return;const l=Be.get(e);if(l===ao)return"sqrt";if(l===so||l===oo)return"linear";if(l===wl)return"ordinal";if((r||i||[]).length>2)return cc(l);if(r!==void 0){if(Vd(r))return cc(l);if(Rt(r))return"utc"}else{const c=t.map(({value:u})=>u).filter(u=>u!==void 0);if(c.some(Vd))return cc(l);if(c.some(Rt))return"utc"}if(l===zn){if(o!=null||fE(a))return"diverging";if(lE(a))return"categorical"}return"linear"}function cc(e){switch(e){case fn:return"point";case zn:return co;default:return"ordinal"}}function Or({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===co}function ey({type:e}){return e==="threshold"}function WE({type:e}){return e==="point"||e==="band"}function ir(e){if(e===void 0)return!0;const t=e.domain(),n=e(t[0]);for(let r=1,i=t.length;r<i;++r)if(e(t[r])-n)return!1;return!0}function No(e,{domain:t,...n},r){var i;for(const a of e)a.value!==void 0&&(t===void 0&&(t=(i=a.value)==null?void 0:i.domain),a.value=r(a.value));return{domain:t===void 0?t:r(t),...n}}function XE(e){return Ze(e,Bf)}function KE(e){return t=>{if(!Be.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return e[t]}}function ZE({scale:e,type:t,domain:n,range:r,interpolate:i,interval:a,transform:o,percent:s,pivot:l}){if(t==="identity")return{type:"identity",apply:u=>u,invert:u=>u};const c=e.unknown?e.unknown():void 0;return{type:t,domain:Ea(n),...r!==void 0&&{range:Ea(r)},...o!==void 0&&{transform:o},...s&&{percent:s},...c!==void 0&&{unknown:c},...a!==void 0&&{interval:a},...i!==void 0&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...l!==void 0&&{pivot:l,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:u=>e(u),...e.invert&&{invert:u=>e.invert(u)}}}function JE(e){let t,n;return(...r)=>(((n==null?void 0:n.length)!==r.length||n.some((i,a)=>i!==r[a]))&&(n=r,t=e(...r)),t)}const QE=JE(e=>new Intl.NumberFormat(e));function eS(e="en-US"){const t=QE(e);return n=>n!=null&&!isNaN(n)?t.format(n):void 0}function tS(e){return z9(e,"Invalid Date")}function nS(e="en-US"){const t=eS(e);return n=>(n instanceof Date?tS:typeof n=="number"?t:ut)(n)}const wi=nS(),mt=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let rS=0;function cm(){return`plot-clip-${++rS}`}function iS(e,{title:t,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:a,target:o,fill:s,fillOpacity:l,stroke:c,strokeWidth:u,strokeOpacity:d,strokeLinejoin:f,strokeLinecap:h,strokeMiterlimit:m,strokeDasharray:p,strokeDashoffset:_,opacity:w,mixBlendMode:g,imageFilter:E,paintOrder:v,pointerEvents:x,shapeRendering:y,channels:M},{ariaLabel:A,fill:S="currentColor",fillOpacity:$,stroke:C="none",strokeOpacity:k,strokeWidth:B,strokeLinecap:G,strokeLinejoin:T,strokeMiterlimit:I,paintOrder:O}){S===null&&(s=null,l=null),C===null&&(c=null,d=null),dt(S)?!dt(C)&&(!dt(s)||M!=null&&M.fill)&&(C="none"):dt(C)&&(!dt(c)||M!=null&&M.stroke)&&(S="none");const[q,z]=Un(s,S),[H,J]=ft(l,$),[Z,F]=Un(c,C),[te,ne]=ft(d,k),[re,Q]=ft(w);Sa(F)||(u===void 0&&(u=B),h===void 0&&(h=G),f===void 0&&(f=T),m===void 0&&!bx(f)&&(m=I),!Sa(z)&&v===void 0&&(v=O));const[Y,R]=ft(u);return S!==null&&(e.fill=et(z,"currentColor"),e.fillOpacity=Oi(J,1)),C!==null&&(e.stroke=et(F,"none"),e.strokeWidth=Oi(R,1),e.strokeOpacity=Oi(ne,1),e.strokeLinejoin=et(f,"miter"),e.strokeLinecap=et(h,"butt"),e.strokeMiterlimit=Oi(m,4),e.strokeDasharray=et(p,"none"),e.strokeDashoffset=et(_,"0")),e.target=ut(o),e.ariaLabel=ut(A),e.ariaDescription=ut(i),e.ariaHidden=ut(a),e.opacity=Oi(Q,1),e.mixBlendMode=et(g,"normal"),e.imageFilter=et(E,"none"),e.paintOrder=et(v,"normal"),e.pointerEvents=et(x,"auto"),e.shapeRendering=et(y,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:q,scale:"auto",optional:!0},fillOpacity:{value:H,scale:"auto",optional:!0},stroke:{value:Z,scale:"auto",optional:!0},strokeOpacity:{value:te,scale:"auto",optional:!0},strokeWidth:{value:Y,optional:!0},opacity:{value:re,scale:"auto",optional:!0}}}function aS(e,t){t&&e.filter(n=>n2(t[n])).append("title").call(oS,t)}function oS(e,t){t&&e.text(n=>wi(t[n]))}function Vn(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:a,fillOpacity:o,stroke:s,strokeOpacity:l,strokeWidth:c,opacity:u,href:d}){r&&Ee(e,"aria-label",f=>r[f]),a&&Ee(e,"fill",f=>a[f]),o&&Ee(e,"fill-opacity",f=>o[f]),s&&Ee(e,"stroke",f=>s[f]),l&&Ee(e,"stroke-opacity",f=>l[f]),c&&Ee(e,"stroke-width",f=>c[f]),u&&Ee(e,"opacity",f=>u[f]),d&&lS(e,f=>d[f],t),n||aS(e,i)}function sS(e,t,n,r){let i;const{clip:a=r.clip}=t;switch(a){case"frame":{const{width:o,height:s,marginLeft:l,marginRight:c,marginTop:u,marginBottom:d}=n,f=cm();i=`url(#${f})`,e=Qe("svg:g",r).call(h=>h.append("svg:clipPath").attr("id",f).append("rect").attr("x",l).attr("y",u).attr("width",o-c-l).attr("height",s-u-d)).each(function(){this.appendChild(e.node()),e.node=()=>this});break}case"sphere":{const{projection:o}=r;if(!o)throw new Error('the "sphere" clip option requires a projection');const s=cm();i=`url(#${s})`,e.append("clipPath").attr("id",s).append("path").attr("d",rf(o)({type:"Sphere"}));break}}Ee(e,"aria-label",t.ariaLabel),Ee(e,"aria-description",t.ariaDescription),Ee(e,"aria-hidden",t.ariaHidden),Ee(e,"clip-path",i)}function vn(e,t,n,r){sS(e,t,n,r),Ee(e,"fill",t.fill),Ee(e,"fill-opacity",t.fillOpacity),Ee(e,"stroke",t.stroke),Ee(e,"stroke-width",t.strokeWidth),Ee(e,"stroke-opacity",t.strokeOpacity),Ee(e,"stroke-linejoin",t.strokeLinejoin),Ee(e,"stroke-linecap",t.strokeLinecap),Ee(e,"stroke-miterlimit",t.strokeMiterlimit),Ee(e,"stroke-dasharray",t.strokeDasharray),Ee(e,"stroke-dashoffset",t.strokeDashoffset),Ee(e,"shape-rendering",t.shapeRendering),Ee(e,"filter",t.imageFilter),Ee(e,"paint-order",t.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=t;Ee(e,"pointer-events",i)}function Mn(e,t){cS(e,"mix-blend-mode",t.mixBlendMode),Ee(e,"opacity",t.opacity)}function lS(e,t,n){e.each(function(r){const i=t(r);if(i!=null){const a=this.ownerDocument.createElementNS(si.svg,"a");a.setAttribute("fill","inherit"),a.setAttributeNS(si.xlink,"href",i),n!=null&&a.setAttribute("target",n),this.parentNode.insertBefore(a,this).appendChild(this)}})}function Ee(e,t,n){n!=null&&e.attr(t,n)}function cS(e,t,n){n!=null&&e.style(t,n)}function Ot(e,t,{x:n,y:r},i=mt,a=mt){i+=t.dx,a+=t.dy,n!=null&&n.bandwidth&&(i+=n.bandwidth()/2),r!=null&&r.bandwidth&&(a+=r.bandwidth()/2),(i||a)&&e.attr("transform",`translate(${i},${a})`)}function et(e,t){if((e=ut(e))!==t)return e}function Oi(e,t){if((e=Ie(e))!==t)return e}const uS=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Vf(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!uS.test(e))throw new Error(`invalid class name: ${e}`);return e}function jf(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const n of e)Object.assign(n.style,t)}function uo({frameAnchor:e},{width:t,height:n,marginTop:r,marginRight:i,marginBottom:a,marginLeft:o}){return[/left$/.test(e)?o:/right$/.test(e)?t-i:(o+t-i)/2,/^top/.test(e)?r:/^bottom/.test(e)?n-a:(r+n-a)/2]}function fS(e,t,n={}){let r=.5-mt,i=.5+mt,a=.5+mt,o=.5-mt;for(const{marginTop:p,marginRight:_,marginBottom:w,marginLeft:g}of t)p>r&&(r=p),_>i&&(i=_),w>a&&(a=w),g>o&&(o=g);let{margin:s,marginTop:l=s!==void 0?s:r,marginRight:c=s!==void 0?s:i,marginBottom:u=s!==void 0?s:a,marginLeft:d=s!==void 0?s:o}=n;l=+l,c=+c,u=+u,d=+d;let{width:f=640,height:h=hS(e,n,{width:f,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:a,marginLeftDefault:o})+Math.max(0,l-r+u-a)}=n;f=+f,h=+h;const m={width:f,height:h,marginTop:l,marginRight:c,marginBottom:u,marginLeft:d};if(e.fx||e.fy){let{margin:p,marginTop:_=p!==void 0?p:l,marginRight:w=p!==void 0?p:c,marginBottom:g=p!==void 0?p:u,marginLeft:E=p!==void 0?p:d}=n.facet??{};_=+_,w=+w,g=+g,E=+E,m.facet={marginTop:_,marginRight:w,marginBottom:g,marginLeft:E}}return m}function hS({x:e,y:t,fy:n,fx:r},{projection:i,aspectRatio:a},{width:o,marginTopDefault:s,marginRightDefault:l,marginBottomDefault:c,marginLeftDefault:u}){const d=n?n.scale.domain().length:1,f=oE(i);if(f){const m=r?r.scale.domain().length:1,p=(1.1*d-.1)/(1.1*m-.1)*f,_=Math.max(.1,Math.min(10,p));return Math.round((o-u-l)*_+s+c)}const h=t?Or(t)?t.scale.domain().length:Math.max(7,17/d):1;if(a!=null){if(a=+a,!(isFinite(a)&&a>0))throw new Error(`invalid aspectRatio: ${a}`);const m=um("y",t)/(um("x",e)*a),p=r?r.scale.bandwidth():1,_=n?n.scale.bandwidth():1,w=p*(o-u-l)-e.insetLeft-e.insetRight;return(m*w+t.insetTop+t.insetBottom)/_+s+c}return!!(t||n)*Math.max(1,Math.min(60,h*d))*20+!!r*30+60}function um(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:n,domain:r}=t;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const s=t.scale.exponent();i=l=>Math.pow(l,s);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${n}`)}const[a,o]=ht(r);return Math.abs(i(o)-i(a))}function dS(e,t){const{fx:n,fy:r}=Au(e,t),i=n==null?void 0:n.scale.domain(),a=r==null?void 0:r.scale.domain();return i&&a?J_(i,a).map(([o,s],l)=>({x:o,y:s,i:l})):i?i.map((o,s)=>({x:o,i:s})):a?a.map((o,s)=>({y:o,i:s})):void 0}function mS(e,{x:t,y:n}){return t&&(t=Pu(t)),n&&(n=Pu(n)),e.filter(t&&n?r=>t.has(r.x)&&n.has(r.y):t?r=>t.has(r.x):r=>n.has(r.y)).sort(t&&n?(r,i)=>t.get(r.x)-t.get(i.x)||n.get(r.y)-n.get(i.y):t?(r,i)=>t.get(r.x)-t.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function Yf(e,{fx:t,fy:n}){const r=Hn(e),i=t==null?void 0:t.value,a=n==null?void 0:n.value;return t&&n?Kr(r,o=>(o.fx=i[o[0]],o.fy=a[o[0]],o),o=>i[o],o=>a[o]):t?Kr(r,o=>(o.fx=i[o[0]],o),o=>i[o]):Kr(r,o=>(o.fy=a[o[0]],o),o=>a[o])}function pS(e,t,{marginTop:n,marginLeft:r}){return e&&t?({x:i,y:a})=>`translate(${e(i)-r},${t(a)-n})`:e?({x:i})=>`translate(${e(i)-r},0)`:({y:i})=>`translate(0,${t(i)-n})`}function bS(e){const t=[],n=new Uint32Array(Qn(e,r=>r.length));for(const r of e){let i=0;for(const a of e)r!==a&&(n.set(a,i),i+=a.length);t.push(n.slice(0,i))}return t}const gS=new Map([["top",uc],["right",dc],["bottom",fc],["left",hc],["top-left",Co(uc,hc)],["top-right",Co(uc,dc)],["bottom-left",Co(fc,hc)],["bottom-right",Co(fc,dc)],["top-empty",wS],["right-empty",xS],["bottom-empty",vS],["left-empty",MS],["empty",ES]]);function yS(e){if(e==null)return null;const t=gS.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const fm=new WeakMap;function Pu(e){let t=fm.get(e);return t||fm.set(e,t=new Mr(Ze(e,(n,r)=>[n,r]))),t}function lr(e,t){return Pu(e).get(t)}function _S(e,t,n){return t=Ao(t),n=Ao(n),e.find(r=>Object.is(Ao(r.x),t)&&Object.is(Ao(r.y),n))}function El(e,t,n){var r;return(r=_S(e,t,n))==null?void 0:r.empty}function uc(e,{y:t},{y:n}){return t?lr(t,n)===0:!0}function fc(e,{y:t},{y:n}){return t?lr(t,n)===t.length-1:!0}function hc(e,{x:t},{x:n}){return t?lr(t,n)===0:!0}function dc(e,{x:t},{x:n}){return t?lr(t,n)===t.length-1:!0}function wS(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const a=lr(t,r);if(a>0)return El(e,n,t[a-1])}function vS(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const a=lr(t,r);if(a<t.length-1)return El(e,n,t[a+1])}function MS(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const a=lr(t,n);if(a>0)return El(e,t[a-1],r)}function xS(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const a=lr(t,n);if(a<t.length-1)return El(e,t[a+1],r)}function ES(e,t,{empty:n}){return n}function Co(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function mc(e,{channels:{fx:t,fy:n},groups:r}){return t&&n?e.map(({x:i,y:a})=>{var o;return((o=r.get(i))==null?void 0:o.get(a))??[]}):t?e.map(({x:i})=>r.get(i)??[]):e.map(({y:i})=>r.get(i)??[])}class Et{constructor(t,n={},r={},i){const{facet:a="auto",facetAnchor:o,fx:s,fy:l,sort:c,dx:u=0,dy:d=0,margin:f=0,marginTop:h=f,marginRight:m=f,marginBottom:p=f,marginLeft:_=f,clip:w=i==null?void 0:i.clip,channels:g,tip:E,render:v}=r;if(this.data=t,this.sort=yi(c)?c:null,this.initializer=_i(r).initializer,this.transform=this.initializer?r.transform:vl(r).transform,a===null||a===!1?this.facet=null:(this.facet=nn(a===!0?"include":a,"facet",["auto","include","exclude","super"]),this.fx=t===Ho&&typeof s=="string"?[s]:s,this.fy=t===Ho&&typeof l=="string"?[l]:l),this.facetAnchor=yS(o),n=v2(n),g!==void 0&&(n={...SS(g),...n}),i!==void 0&&(n={...iS(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([x,y])=>{if(bl(y.value)){const{value:M,label:A=y.label,scale:S=y.scale}=y.value;y={...y,label:A,scale:S,value:M}}if(t===Ho&&typeof y.value=="string"){const{value:M}=y;y={...y,value:[M]}}return[x,y]}).filter(([x,{value:y,optional:M}])=>{if(y!=null)return!0;if(M)return!1;throw new Error(`missing channel value: ${x}`)})),this.dx=+u,this.dy=+d,this.marginTop=+h,this.marginRight=+m,this.marginBottom=+p,this.marginLeft=+_,this.clip=M2(w),this.tip=AS(E),this.facet==="super"){if(s||l)throw new Error("super-faceting cannot use fx or fy");for(const x in this.channels){const{scale:y}=n[x];if(!(y!=="x"&&y!=="y"))throw new Error("super-faceting cannot use x or y")}}v!=null&&(this.render=ny(v,this.render))}initialize(t,n,r){let i=xt(this.data);t===void 0&&i!=null&&(t=[Hn(i)]);const a=t;this.transform!=null&&({facets:t,data:i}=this.transform(i,t,r),i=xt(i)),t!==void 0&&(t.original=a);const o=Wx(this.channels,i);return this.sort!=null&&Kx(i,t,o,n,this.sort),{data:i,facets:t,channels:o}}filter(t,n,r){for(const i in n){const{filter:a=Tr}=n[i];if(a!==null){const o=r[i];t=t.filter(s=>a(o[s]))}}return t}project(t,n,r){for(const i in t)if(t[i].scale==="x"&&/^x|x$/.test(i)){const a=i.replace(/^x|x$/,"y");a in t&&t[a].scale==="y"&&iE(i,a,n,r.projection)}}scale(t,n,r){const i=Xx(t,n);return r.projection&&this.project(t,i,r),i}}function ty(...e){return e.plot=Et.prototype.plot,e}function ny(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(n,r,i,a,o,s){return e.call(this,n,r,i,a,o,(l,c,u,d,f)=>t.call(this,l,c,u,d,f,s))}}function SS(e){return Object.fromEntries(Object.entries(v2(e)).map(([t,n])=>(n=typeof n=="string"?{value:n,label:t}:gl(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[t,n])))}function AS(e){return e===!0?"xy":e===!1||e==null?null:typeof e=="string"?nn(e,"tip",["x","y","xy"]):e}function Sl(e,t){return(e==null?void 0:e.tip)===!0?{...e,tip:t}:sr(e==null?void 0:e.tip)&&e.tip.pointer===void 0?{...e,tip:{...e.tip,pointer:t}}:e}const hm=new WeakMap;function Wf(e,t,{x:n,y:r,px:i,py:a,maxRadius:o=40,channels:s,render:l,...c}={}){return o=+o,i!=null&&(n??(n=null),s={...s,px:{value:i,scale:"x"}}),a!=null&&(r??(r=null),s={...s,py:{value:a,scale:"y"}}),{x:n,y:r,channels:s,...c,render:ny(function(u,d,f,h,m,p){m={...m,pointerSticky:!1};const _=m.ownerSVGElement,{data:w}=m.getMarkState(this);let g=hm.get(_);g||hm.set(_,g={sticky:!1,roots:[],renders:[]});let E=g.renders.push(F)-1;const{x:v,y:x,fx:y,fy:M}=d;let A=y?y(u.fx)-h.marginLeft:0,S=M?M(u.fy)-h.marginTop:0;v!=null&&v.bandwidth&&(A+=v.bandwidth()/2),x!=null&&x.bandwidth&&(S+=x.bandwidth()/2);const $=u.fi!=null;let C;if($){let Q=g.facetStates;Q||(g.facetStates=Q=new Map),C=Q.get(this),C||Q.set(this,C=new Map)}const[k,B]=uo(this,h),{px:G,py:T}=f,I=G?Q=>G[Q]:ry(f,k),O=T?Q=>T[Q]:iy(f,B);let q,z,H,J;function Z(Q,Y){if($)if(J&&(J=cancelAnimationFrame(J)),Q==null)C.delete(u.fi);else{C.set(u.fi,Y),J=requestAnimationFrame(()=>{J=null;for(const[R,V]of C)if(V<Y||V===Y&&R<u.fi){Q=null;break}F(Q)});return}F(Q)}function F(Q){if(q===Q&&H===g.sticky)return;q=Q,H=m.pointerSticky=g.sticky;const Y=q==null?[]:[q];$&&(Y.fx=u.fx,Y.fy=u.fy,Y.fi=u.fi);const R=p(Y,d,f,h,m);if(z){if($){const V=z.parentNode,W=z.getAttribute("transform"),U=R.getAttribute("transform");W?R.setAttribute("transform",W):R.removeAttribute("transform"),U?V.setAttribute("transform",U):V.removeAttribute("transform"),R.removeAttribute("aria-label"),R.removeAttribute("aria-description"),R.removeAttribute("aria-hidden")}z.replaceWith(R)}return g.roots[E]=z=R,q==null&&(C==null?void 0:C.size)>1||m.dispatchValue(q==null?null:w[q]),R}function te(Q){if(g.sticky||Q.pointerType==="mouse"&&Q.buttons===1)return;let[Y,R]=s3(Q);Y-=A,R-=S;const V=Y<h.marginLeft||Y>h.width-h.marginRight?1:e,W=R<h.marginTop||R>h.height-h.marginBottom?1:t;let U=null,fe=o*o;for(const ue of u){const ie=V*(I(ue)-Y),he=W*(O(ue)-R),le=ie*ie+he*he;le<=fe&&(U=ue,fe=le)}if(U!=null&&(e!==1||t!==1)){const ue=I(U)-Y,ie=O(U)-R;fe=ue*ue+ie*ie}Z(U,fe)}function ne(Q){Q.pointerType==="mouse"&&q!=null&&(g.sticky&&g.roots.some(Y=>Y==null?void 0:Y.contains(Q.target))||(g.sticky?(g.sticky=!1,g.renders.forEach(Y=>Y(null))):(g.sticky=!0,F(q)),Q.stopImmediatePropagation()))}function re(Q){Q.pointerType==="mouse"&&(g.sticky||Z(null))}return _.addEventListener("pointerenter",te),_.addEventListener("pointermove",te),_.addEventListener("pointerdown",ne),_.addEventListener("pointerleave",re),F(null)},l)}}function PS(e){return Wf(1,1,e)}function NS(e){return Wf(1,.01,e)}function dm(e){return Wf(.01,1,e)}function ry({x1:e,x2:t,x:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function iy({y1:e,y2:t,y:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function ay(e){return Or(e)&&e.interval===void 0?void 0:"tabular-nums"}function CS(e,t){let{label:n=e.label,tickSize:r=6,width:i=240,height:a=44+r,marginTop:o=18,marginRight:s=0,marginBottom:l=16+r,marginLeft:c=0,style:u,ticks:d=(i-c-s)/64,tickFormat:f,fontVariant:h=ay(e),round:m=!0,opacity:p,className:_}=t;const w=Gf(t);_=Vf(_),p=ft(p)[1],f===null&&(f=()=>null);const g=Qe("svg",w).attr("class",`${_}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call(k=>k.append("style").text(`:where(.${_}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${_}-ramp text) {
  white-space: pre;
}`)).call(jf,u);let E=k=>k.selectAll(".tick line").attr("y1",o+l-a),v;const x=m?(k,B)=>k.rangeRound(B):(k,B)=>k.range(B),{type:y,domain:M,range:A,interpolate:S,scale:$,pivot:C}=e;if(S){const k=A===void 0?S:Xs(S.length===1?Hf(S):S,A);v=x($.copy(),Kt(rt(c,i-s),Math.min(M.length+(C!==void 0),A===void 0?1/0:A.length)));const B=256,G=w.document.createElement("canvas");G.width=B,G.height=1;const T=G.getContext("2d");for(let I=0,O=B-1;I<B;++I)T.fillStyle=k(I/O),T.fillRect(I,0,1,1);g.append("image").attr("opacity",p).attr("x",c).attr("y",o).attr("width",i-c-s).attr("height",a-o-l).attr("preserveAspectRatio","none").attr("xlink:href",G.toDataURL())}else if(y==="threshold"){const k=M,B=f===void 0?G=>G:typeof f=="string"?Si(f):f;v=x(cf().domain([-1,A.length-1]),[c,i-s]),g.append("g").attr("fill-opacity",p).selectAll().data(A).enter().append("rect").attr("x",(G,T)=>v(T-1)).attr("y",o).attr("width",(G,T)=>v(T)-v(T-1)).attr("height",a-o-l).attr("fill",G=>G),d=Ze(k,(G,T)=>T),f=G=>B(k[G],G)}else v=x(tl().domain(M),[c,i-s]),g.append("g").attr("fill-opacity",p).selectAll().data(M).enter().append("rect").attr("x",v).attr("y",o).attr("width",Math.max(0,v.bandwidth()-1)).attr("height",a-o-l).attr("fill",$),E=()=>{};return g.append("g").attr("transform",`translate(0,${a-l})`).call(Ew(v).ticks(Array.isArray(d)?null:d,typeof f=="string"?f:void 0).tickFormat(typeof f=="function"?f:void 0).tickSize(r).tickValues(Array.isArray(d)?d:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",et(h,"normal")).call(E).call(k=>k.select(".domain").remove()),n!==void 0&&g.append("text").attr("x",c).attr("y",o-6).attr("fill","currentColor").attr("font-weight","bold").text(n),g.node()}const oy=Math.PI/180;function Al(e,{marker:t,markerStart:n=t,markerMid:r=t,markerEnd:i=t}={}){e.markerStart=pc(n),e.markerMid=pc(r),e.markerEnd=pc(i)}function pc(e){if(e==null||e===!1)return null;if(e===!0)return pm;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return mm("auto");case"arrow-reverse":return mm("auto-start-reverse");case"dot":return TS;case"circle":case"circle-fill":return pm;case"circle-stroke":return $S;case"tick":return bc("auto");case"tick-x":return bc(90);case"tick-y":return bc(0)}throw new Error(`invalid marker: ${e}`)}function mm(e){return(t,n)=>Qe("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function TS(e,t){return Qe("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function pm(e,t){return Qe("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function $S(e,t){return Qe("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function bc(e){return(t,n)=>Qe("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let kS=0;function Pl(e,t,{stroke:n},r){return IS(e,t,n&&(i=>n[i]),r)}function IS(e,{markerStart:t,markerMid:n,markerEnd:r,stroke:i},a=()=>i,o){const s=new Map;function l(c){return function(u){const d=a(u);let f=s.get(c);f||s.set(c,f=new Map);let h=f.get(d);if(!h){const m=this.parentNode.insertBefore(c(d,o),this),p=`plot-marker-${++kS}`;m.setAttribute("id",p),f.set(d,h=`url(#${p})`)}return h}}t&&e.attr("marker-start",l(t)),n&&e.attr("marker-mid",l(n)),r&&e.attr("marker-end",l(r))}function sy({inset:e,insetLeft:t,insetRight:n,...r}={}){return[t,n]=cy(e,t,n),{inset:e,insetLeft:t,insetRight:n,...r}}function ly({inset:e,insetTop:t,insetBottom:n,...r}={}){return[t,n]=cy(e,t,n),{inset:e,insetTop:t,insetBottom:n,...r}}function cy(e,t,n){return e===void 0&&t===void 0&&n===void 0?mt?[1,0]:[.5,.5]:[t,n]}function uy(e,{interval:t}){return e={...gl(e)},e.interval=Df(e.interval===void 0?t:e.interval),e}function fy(e,t,n,r){const{[e]:i,[`${e}1`]:a,[`${e}2`]:o}=n,{value:s,interval:l}=uy(i,n);if(s==null||l==null&&!r)return n;const c=Ci(i);if(l==null){let h;const m={transform:p=>h||(h=We(p,s)),label:c};return{...n,[e]:void 0,[`${e}1`]:a===void 0?m:a,[`${e}2`]:o===void 0&&!(a===o&&r)?m:o}}let u,d;function f(h){return d!==void 0&&h===u?d:d=Ze(We(u=h,s),m=>l.floor(m))}return t({...n,[e]:void 0,[`${e}1`]:a===void 0?{transform:f,label:c}:a,[`${e}2`]:o===void 0?{transform:h=>f(h).map(m=>l.offset(m)),label:c}:o})}function hy(e,t,n){const{[e]:r}=n,{value:i,interval:a}=uy(r,n);return i==null||a==null?n:t({...n,[e]:{label:Ci(r),transform:o=>{const s=Ze(We(o,i),c=>a.floor(c)),l=s.map(c=>a.offset(c));return s.map(Rt(s)?(c,u)=>c==null||isNaN(c=+c)||(u=l[u],u==null)||isNaN(u=+u)?void 0:new Date((c+u)/2):(c,u)=>c==null||(u=l[u],u==null)?NaN:(+c+ +u)/2)}}})}function dy(e={}){return fy("x",sy,e)}function my(e={}){return fy("y",ly,e)}function DS(e={}){return hy("x",sy,e)}function RS(e={}){return hy("y",ly,e)}const py={ariaLabel:"rule",fill:null,stroke:"currentColor"};class LS extends Et{constructor(t,n={}){const{x:r,y1:i,y2:a,inset:o=0,insetTop:s=o,insetBottom:l=o}=n;super(t,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:a,scale:"y",optional:!0}},Sl(n,"x"),py),this.insetTop=Ie(s),this.insetBottom=Ie(l),Al(this,n)}render(t,n,r,i,a){const{x:o,y:s}=n,{x:l,y1:c,y2:u}=r,{width:d,height:f,marginTop:h,marginRight:m,marginLeft:p,marginBottom:_}=i,{insetTop:w,insetBottom:g}=this;return Qe("svg:g",a).call(vn,this,i,a).call(Ot,this,{x:l&&o},mt,0).call(E=>E.selectAll().data(t).enter().append("line").call(Mn,this).attr("x1",l?v=>l[v]:(p+d-m)/2).attr("x2",l?v=>l[v]:(p+d-m)/2).attr("y1",c&&!ir(s)?v=>c[v]+w:h+w).attr("y2",u&&!ir(s)?s.bandwidth?v=>u[v]+s.bandwidth()-g:v=>u[v]-g:f-_-g).call(Vn,this,r).call(Pl,this,r,a)).node()}}class BS extends Et{constructor(t,n={}){const{x1:r,x2:i,y:a,inset:o=0,insetRight:s=o,insetLeft:l=o}=n;super(t,{y:{value:a,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},Sl(n,"y"),py),this.insetRight=Ie(s),this.insetLeft=Ie(l),Al(this,n)}render(t,n,r,i,a){const{x:o,y:s}=n,{y:l,x1:c,x2:u}=r,{width:d,height:f,marginTop:h,marginRight:m,marginLeft:p,marginBottom:_}=i,{insetLeft:w,insetRight:g}=this;return Qe("svg:g",a).call(vn,this,i,a).call(Ot,this,{y:l&&s},0,mt).call(E=>E.selectAll().data(t).enter().append("line").call(Mn,this).attr("x1",c&&!ir(o)?v=>c[v]+w:p+w).attr("x2",u&&!ir(o)?o.bandwidth?v=>u[v]+o.bandwidth()-g:v=>u[v]-g:d-m-g).attr("y1",l?v=>l[v]:(h+f-_)/2).attr("y2",l?v=>l[v]:(h+f-_)/2).call(Vn,this,r).call(Pl,this,r,a)).node()}}function jt(e,t){let{x:n=nt,y:r,y1:i,y2:a,...o}=my(t);return[i,a]=by(r,i,a),new LS(e,{...o,x:n,y1:i,y2:a})}function Lt(e,t){let{y:n=nt,x:r,x1:i,x2:a,...o}=dy(t);return[i,a]=by(r,i,a),new BS(e,{...o,y:n,x1:i,x2:a})}function by(e,t,n){if(e==null){if(t===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,t]}else{if(t===void 0)return n===void 0?[0,e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}function Xf(e,...t){let n=t.length;for(let r=0,i=!0;r<n;++r)typeof t[r]!="function"&&(i&&(e=e.slice(),i=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--n);return r=>{let i=e[0];for(let a=0;a<n;++a)i+=t[a](r)+e[a+1];return i}}const OS={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},gy="";class Kf extends Et{constructor(t,n={}){const{x:r,y:i,text:a=Br(t)&&w2(t)?nt:$f,frameAnchor:o,textAnchor:s=/right$/i.test(o)?"end":/left$/i.test(o)?"start":"middle",lineAnchor:l=/^top/i.test(o)?"top":/^bottom/i.test(o)?"bottom":"middle",lineHeight:c=1,lineWidth:u=1/0,textOverflow:d,monospace:f,fontFamily:h=f?"ui-monospace, monospace":void 0,fontSize:m,fontStyle:p,fontVariant:_,fontWeight:w,rotate:g}=n,[E,v]=ft(g,0),[x,y]=zS(m);if(super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:x,optional:!0},rotate:{value:ux(E),optional:!0},text:{value:a,filter:n2,optional:!0}},n,OS),this.rotate=v,this.textAnchor=et(s,"middle"),this.lineAnchor=nn(l,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=yy(d),this.monospace=!!f,this.fontFamily=ut(h),this.fontSize=y,this.fontStyle=ut(p),this.fontVariant=ut(_),this.fontWeight=ut(w),this.frameAnchor=_l(o),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=wy(this),this.clipLine=vy(this)}render(t,n,r,i,a){const{x:o,y:s}=n,{x:l,y:c,rotate:u,text:d,title:f,fontSize:h}=r,{rotate:m}=this,[p,_]=uo(this,i);return Qe("svg:g",a).call(vn,this,i,a).call(_y,this,d,i).call(Ot,this,{x:l&&o,y:c&&s}).call(w=>w.selectAll().data(t).enter().append("text").call(Mn,this).call(FS,this,d,f).attr("transform",Xf`translate(${l?g=>l[g]:p},${c?g=>c[g]:_})${u?g=>` rotate(${u[g]})`:m?` rotate(${m})`:""}`).call(Ee,"font-size",h&&(g=>h[g])).call(Vn,this,r)).node()}}function yy(e){return e==null?null:nn(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function FS(e,t,n,r){if(!n)return;const{lineAnchor:i,lineHeight:a,textOverflow:o,splitLines:s,clipLine:l}=t;e.each(function(c){const u=s(wi(n[c])??"").map(l),d=u.length,f=i==="top"?.71:i==="bottom"?1-d:(164-d*100)/200;if(d>1){let h=0;for(let m=0;m<d;++m){if(++h,!u[m])continue;const p=this.ownerDocument.createElementNS(si.svg,"tspan");p.setAttribute("x",0),m===h-1?p.setAttribute("y",`${(f+m)*a}em`):p.setAttribute("dy",`${h*a}em`),p.textContent=u[m],this.appendChild(p),h=0}}else f&&this.setAttribute("y",`${f*a}em`),this.textContent=u[0];if(o&&!r&&u[0]!==n[c]){const h=this.ownerDocument.createElementNS(si.svg,"title");h.textContent=n[c],this.appendChild(h)}})}function $r(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=ro(t,n)),new Kf(e,{...r,x:t,y:n})}function GS(e,{x:t=nt,...n}={}){return new Kf(e,RS({...n,x:t}))}function US(e,{y:t=nt,...n}={}){return new Kf(e,DS({...n,y:t}))}function _y(e,t,n){Ee(e,"text-anchor",t.textAnchor),Ee(e,"font-family",t.fontFamily),Ee(e,"font-size",t.fontSize),Ee(e,"font-style",t.fontStyle),Ee(e,"font-variant",t.fontVariant===void 0?qS(n):t.fontVariant),Ee(e,"font-weight",t.fontWeight)}function qS(e){return e&&(dx(e)||Rt(e))?"tabular-nums":void 0}const HS=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function zS(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),HS.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function VS(e,t,n){const r=[];let i,a=0;for(const[o,s,l]of jS(e)){if(i===void 0&&(i=o),a>i&&n(e,i,s)>t&&(r.push(e.slice(i,a)+(e[a-1]===gy?"-":"")),i=o),l){r.push(e.slice(i,s)),i=void 0;continue}a=s}return r}function*jS(e){let t=0,n=0;const r=e.length;for(;n<r;){let i=1;switch(e[n]){case gy:case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];e[++n]===" ";);t=n;break;case"\r":e[n+1]===`
`&&++i;case`
`:yield[t,n,!0],n+=i,t=n;break;default:++n;break}}yield[t,n,!0]}const bm={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"":31,"":31,"":47,"":47,"":82};function Zf(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=Ti(e,i))r+=bm[e[i]]??(xy(e,i)?120:bm.e);return r}function Jf(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=Ti(e,i))r+=xy(e,i)?126:63;return r}function wy({monospace:e,lineWidth:t,textOverflow:n}){if(n!=null||t==1/0)return a=>a.split(/\r\n?|\n/g);const r=e?Jf:Zf,i=t*100;return a=>VS(a,i,r)}function vy({monospace:e,lineWidth:t,textOverflow:n}){if(n==null||t==1/0)return a=>a;const r=e?Jf:Zf,i=t*100;switch(n){case"clip-start":return a=>ym(a,i,r,"");case"clip-end":return a=>gm(a,i,r,"");case"ellipsis-start":return a=>ym(a,i,r,Qr);case"ellipsis-middle":return a=>YS(a,i,r,Qr);case"ellipsis-end":return a=>gm(a,i,r,Qr)}}const Qr="";function vi(e,t,n,r){const i=[];let a=0;for(let o=0,s=0,l=e.length;o<l;o=s){s=Ti(e,o);const c=n(e,o,s);if(a+c>t){for(a+=r;a>t&&o>0;)s=o,o=i.pop(),a-=n(e,o,s);return[o,t-a]}a+=c,i.push(o)}return[-1,0]}function gm(e,t,n,r){e=e.trim();const i=n(r),[a]=vi(e,t,n,i);return a<0?e:e.slice(0,a).trimEnd()+r}function YS(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const a=n(r)/2,[o,s]=vi(e,t/2,n,a),[l]=vi(e,i-t/2-s+a,n,-a);return l<0?r:e.slice(0,o).trimEnd()+r+e.slice(Ti(e,l)).trimStart()}function ym(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const a=n(r),[o]=vi(e,i-t+a,n,-a);return o<0?r:r+e.slice(Ti(e,o)).trimStart()}const Nu=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,_m=new RegExp("\\p{Extended_Pictographic}","uy");function Ti(e,t){return t+=WS(e,t)?2:1,KS(e,t)&&(t=Nu.lastIndex),XS(e,t)?Ti(e,t+1):t}function My(e,t){return e.charCodeAt(t)<128}function WS(e,t){const n=e.charCodeAt(t);if(n>=55296&&n<56320){const r=e.charCodeAt(t+1);return r>=56320&&r<57344}return!1}function XS(e,t){return e.charCodeAt(t)===8205}function KS(e,t){return My(e,t)?!1:(Nu.lastIndex=t,Nu.test(e))}function xy(e,t){return My(e,t)?!1:(_m.lastIndex=t,_m.test(e))}const ZS={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Ey=3.5,JS=Ey*5,Sy={draw(e,t,n){const r=t*n/JS;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},QS={draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}},eA=new Map([["arrow",Sy],["spike",QS]]);function tA(e){return e&&typeof e.draw=="function"}function nA(e){if(tA(e))return e;const t=eA.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class Ay extends Et{constructor(t,n={}){const{x:r,y:i,r:a=Ey,length:o,rotate:s,shape:l=Sy,anchor:c="middle",frameAnchor:u}=n,[d,f]=ft(o,12),[h,m]=ft(s,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:d,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,ZS),this.r=+a,this.length=f,this.rotate=m,this.shape=nA(l),this.anchor=nn(c,"anchor",["start","middle","end"]),this.frameAnchor=_l(u)}render(t,n,r,i,a){const{x:o,y:s}=n,{x:l,y:c,length:u,rotate:d}=r,{length:f,rotate:h,anchor:m,shape:p,r:_}=this,[w,g]=uo(this,i);return Qe("svg:g",a).call(vn,this,i,a).call(Ot,this,{x:l&&o,y:c&&s}).call(E=>E.selectAll().data(t).enter().append("path").call(Mn,this).attr("transform",Xf`translate(${l?v=>l[v]:w},${c?v=>c[v]:g})${d?v=>` rotate(${d[v]})`:h?` rotate(${h})`:""}${m==="start"?"":m==="end"?u?v=>` translate(0,${u[v]})`:` translate(0,${f})`:u?v=>` translate(0,${u[v]/2})`:` translate(0,${f/2})`}`).attr("d",u?v=>{const x=Kn();return p.draw(x,u[v],_),x}:(()=>{const v=Kn();return p.draw(v,f,_),v})()).call(Vn,this,r)).node()}}function rA(e,t={}){const{x:n=nt,...r}=t;return new Ay(e,{...r,x:n})}function iA(e,t={}){const{y:n=nt,...r}=t;return new Ay(e,{...r,y:n})}function cr(e,t){return arguments.length<2&&!Br(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function Nl({anchor:e}={},t){return e===void 0?t[0]:nn(e,"anchor",t)}function Py(e){return Nl(e,["left","right"])}function Ny(e){return Nl(e,["right","left"])}function Cy(e){return Nl(e,["bottom","top"])}function Ty(e){return Nl(e,["top","bottom"])}function $y(){const[e,t]=cr(...arguments);return Iy("y",Py(t),e,t)}function aA(){const[e,t]=cr(...arguments);return Iy("fy",Ny(t),e,t)}function ky(){const[e,t]=cr(...arguments);return Dy("x",Cy(t),e,t)}function oA(){const[e,t]=cr(...arguments);return Dy("fx",Ty(t),e,t)}function Iy(e,t,n,{color:r="currentColor",opacity:i=1,stroke:a=r,strokeOpacity:o=i,strokeWidth:s=1,fill:l=r,fillOpacity:c=i,textAnchor:u,textStroke:d,textStrokeOpacity:f,textStrokeWidth:h,tickSize:m=e==="y"?6:0,tickPadding:p,tickRotate:_,x:w,margin:g,marginTop:E=g===void 0?20:g,marginRight:v=g===void 0?t==="right"?40:0:g,marginBottom:x=g===void 0?20:g,marginLeft:y=g===void 0?t==="left"?40:0:g,label:M,labelAnchor:A,labelArrow:S,labelOffset:$,...C}){return m=Ie(m),p=Ie(p),_=Ie(_),A!==void 0&&(A=nn(A,"labelAnchor",["center","top","bottom"])),S=qy(S),ty(m&&!dt(a)?sA(e,t,n,{stroke:a,strokeOpacity:o,strokeWidth:s,tickSize:m,tickPadding:p,tickRotate:_,x:w,...C}):null,dt(l)?null:cA(e,t,n,{fill:l,fillOpacity:c,stroke:d,strokeOpacity:f,strokeWidth:h,textAnchor:u,tickSize:m,tickPadding:p,tickRotate:_,x:w,marginTop:E,marginRight:v,marginBottom:x,marginLeft:y,...C}),!dt(l)&&M!==null?$r([],Oy({fill:l,fillOpacity:c,...C},function(k,B,G,T,I){const O=T[e],{marginTop:q,marginRight:z,marginBottom:H,marginLeft:J}=e==="y"&&I.inset||I,Z=A??(O.bandwidth?"center":"top"),F=$??(t==="right"?z:J)-3;return Z==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=Z,this.frameAnchor=`${Z}-${t}`,this.rotate=0),this.dy=Z==="top"?3-q:Z==="bottom"?H-3:0,this.dx=t==="right"?F:-F,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[Uy(e,O,{anchor:t,label:M,labelAnchor:Z,labelArrow:S})]}}}})):null)}function Dy(e,t,n,{color:r="currentColor",opacity:i=1,stroke:a=r,strokeOpacity:o=i,strokeWidth:s=1,fill:l=r,fillOpacity:c=i,textAnchor:u,textStroke:d,textStrokeOpacity:f,textStrokeWidth:h,tickSize:m=e==="x"?6:0,tickPadding:p,tickRotate:_,y:w,margin:g,marginTop:E=g===void 0?t==="top"?30:0:g,marginRight:v=g===void 0?20:g,marginBottom:x=g===void 0?t==="bottom"?30:0:g,marginLeft:y=g===void 0?20:g,label:M,labelAnchor:A,labelArrow:S,labelOffset:$,...C}){return m=Ie(m),p=Ie(p),_=Ie(_),A!==void 0&&(A=nn(A,"labelAnchor",["center","left","right"])),S=qy(S),ty(m&&!dt(a)?lA(e,t,n,{stroke:a,strokeOpacity:o,strokeWidth:s,tickSize:m,tickPadding:p,tickRotate:_,y:w,...C}):null,dt(l)?null:uA(e,t,n,{fill:l,fillOpacity:c,stroke:d,strokeOpacity:f,strokeWidth:h,textAnchor:u,tickSize:m,tickPadding:p,tickRotate:_,y:w,marginTop:E,marginRight:v,marginBottom:x,marginLeft:y,...C}),!dt(l)&&M!==null?$r([],Oy({fill:l,fillOpacity:c,...C},function(k,B,G,T,I){const O=T[e],{marginTop:q,marginRight:z,marginBottom:H,marginLeft:J}=e==="x"&&I.inset||I,Z=A??(O.bandwidth?"center":"right"),F=$??(t==="top"?q:H)-3;return Z==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${Z}`,this.textAnchor=Z==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-F:F,this.dx=Z==="right"?z-3:Z==="left"?3-J:0,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[Uy(e,O,{anchor:t,label:M,labelAnchor:Z,labelArrow:S})]}}}})):null)}function sA(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:a=null,facetAnchor:o=t+(e==="y"?"-empty":""),frameAnchor:s=t,tickSize:l,inset:c=0,insetLeft:u=c,insetRight:d=c,dx:f=0,y:h=e==="y"?void 0:null,...m}){return $i(iA,e,n,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:a,facetAnchor:o,frameAnchor:s,y:h,...m,dx:t==="left"?+f-mt+ +u:+f+mt-d,anchor:"start",length:l,shape:t==="left"?yA:_A})}function lA(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:a=null,facetAnchor:o=t+(e==="x"?"-empty":""),frameAnchor:s=t,tickSize:l,inset:c=0,insetTop:u=c,insetBottom:d=c,dy:f=0,x:h=e==="x"?void 0:null,...m}){return $i(rA,e,n,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:a,strokeLinecap:i,facetAnchor:o,frameAnchor:s,x:h,...m,dy:t==="bottom"?+f-mt-d:+f+mt+ +u,anchor:"start",length:l,shape:t==="bottom"?bA:gA})}function cA(e,t,n,{facetAnchor:r=t+(e==="y"?"-empty":""),frameAnchor:i=t,tickSize:a,tickRotate:o=0,tickPadding:s=Math.max(3,9-a)+(Math.abs(o)>60?4*Math.cos(o*oy):0),text:l,textAnchor:c=Math.abs(o)>60?"middle":t==="left"?"end":"start",lineAnchor:u=o>60?"top":o<-60?"bottom":"middle",fontVariant:d,inset:f=0,insetLeft:h=f,insetRight:m=f,dx:p=0,y:_=e==="y"?void 0:null,...w}){return $i(US,e,n,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:l,textAnchor:c,lineAnchor:u,fontVariant:d,rotate:o,y:_,...w,dx:t==="left"?+p-a-s+ +h:+p+ +a+ +s-m},function(g,E,v,x,y){d===void 0&&(this.fontVariant=Gy(g)),l===void 0&&(y.text=Fy(g,E,v,x,t))})}function uA(e,t,n,{facetAnchor:r=t+(e==="x"?"-empty":""),frameAnchor:i=t,tickSize:a,tickRotate:o=0,tickPadding:s=Math.max(3,9-a)+(Math.abs(o)>=10?4*Math.cos(o*oy):0),text:l,textAnchor:c=Math.abs(o)>=10?o<0^t==="bottom"?"start":"end":"middle",lineAnchor:u=Math.abs(o)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:d,inset:f=0,insetTop:h=f,insetBottom:m=f,dy:p=0,x:_=e==="x"?void 0:null,...w}){return $i(GS,e,n,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:i,text:l===void 0?null:l,textAnchor:c,lineAnchor:u,fontVariant:d,rotate:o,x:_,...w,dy:t==="bottom"?+p+ +a+ +s-m:+p-a-s+ +h},function(g,E,v,x,y){d===void 0&&(this.fontVariant=Gy(g)),l===void 0&&(y.text=Fy(g,E,v,x,t))})}function fA(){const[e,t]=cr(...arguments);return Ry("y",Py(t),e,t)}function hA(){const[e,t]=cr(...arguments);return Ry("fy",Ny(t),e,t)}function dA(){const[e,t]=cr(...arguments);return Ly("x",Cy(t),e,t)}function mA(){const[e,t]=cr(...arguments);return Ly("fx",Ty(t),e,t)}function Ry(e,t,n,{y:r=e==="y"?void 0:null,x:i=null,x1:a=t==="left"?i:null,x2:o=t==="right"?i:null,...s}){return $i(Lt,e,n,{ariaLabel:`${e}-grid`,ariaHidden:!0},{y:r,x1:a,x2:o,...By(s)})}function Ly(e,t,n,{x:r=e==="x"?void 0:null,y:i=null,y1:a=t==="top"?i:null,y2:o=t==="bottom"?i:null,...s}){return $i(jt,e,n,{ariaLabel:`${e}-grid`,ariaHidden:!0},{x:r,y1:a,y2:o,...By(s)})}function By({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:r=t,strokeWidth:i=1,...a}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...a}}function Oy({fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:a,fontWeight:o,monospace:s,pointerEvents:l,shapeRendering:c,clip:u=!1},d){return[,e]=Un(e),[,t]=ft(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:a,fontWeight:o,monospace:s,pointerEvents:l,shapeRendering:c,clip:u,initializer:d}}function $i(e,t,n,r,i,a){let o;function s(u,d,f,h,m,p){const _=u==null&&(t==="fx"||t==="fy"),{[t]:w}=h;if(!w)throw new Error(`missing scale: ${t}`);const g=w.domain();let{interval:E,ticks:v,tickFormat:x,tickSpacing:y=t==="x"?80:35}=i;if(typeof v=="string"&&Hy(w)&&(E=v,v=void 0),v===void 0&&(v=io(E,w.type)??pA(w,y)),u==null){if(Br(v))u=xt(v);else if(cx(v))u=gc(v,...ht(g));else if(w.interval){let A=w.interval;if(w.ticks){const[S,$]=ht(g),C=($-S)/A[to];A=Ud(A,C/v)??A,u=gc(A,S,$)}else{u=g;const S=u.length;A=Ud(A,S/v)??A,A!==w.interval&&(u=gc(A,...ht(u)))}if(A===w.interval){const S=Math.round(u.length/v);S>1&&(u=u.filter(($,C)=>C%S===0))}}else w.ticks?u=w.ticks(v):u=g;if(!w.ticks&&u.length&&u!==g){const A=new Hs(g);u=u.filter(S=>A.has(S)),u.length||wr(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}t==="y"||t==="x"?d=[Hn(u)]:o[t]={scale:t,value:nt}}a==null||a.call(this,w,u,v,x,o);const M=Object.fromEntries(Object.entries(o).map(([A,S])=>[A,{...S,value:We(u,S.value)}]));return _&&(d=p.filterFacets(u,M)),{data:u,facets:d,channels:M}}const l=_i(i).initializer,c=e(n,_i({...i,initializer:s},l));return n==null?(o=c.channels,c.channels={}):o={},r!==void 0&&Object.assign(c,r),c.clip===void 0&&(c.clip=!1),c}function pA(e,t){const[n,r]=ht(e.range());return(r-n)/t}function Fy(e,t,n,r,i){return{value:Qf(e,t,n,r,i)}}function Qf(e,t,n,r,i){return typeof r=="function"?r:r===void 0&&t&&Rt(t)?K9(e.type,t,i)??wi:e.tickFormat?e.tickFormat(typeof n=="number"?n:null,r):r===void 0?wi:typeof r=="string"?(Rt(e.domain())?Ja:Si)(r):no(r)}function gc(e,t,n){return e.range(t,e.offset(e.floor(n)))}const bA={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},gA={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},yA={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},_A={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function Gy(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function Uy(e,t,{anchor:n,label:r=t.label,labelAnchor:i,labelArrow:a}={}){if(!(r==null||r.inferred&&Hy(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),a==="auto"&&(a=(!t.bandwidth||t.interval)&&!/[]/.test(r)),!a)return r;if(a===!0){const o=zE(t);o&&(a=/x$/.test(e)||i==="center"?/x$/.test(e)===o<0?"left":"right":o<0?"up":"down")}switch(a){case"left":return` ${r}`;case"right":return`${r} `;case"up":return n==="right"?`${r} `:` ${r}`;case"down":return n==="right"?`${r} `:` ${r}`}return r}}function qy(e="auto"){return dt(e)?!1:typeof e=="boolean"?e:nn(e,"labelArrow",["auto","up","right","down","left"])}function Hy(e){return Rt(e.domain())}function wm(e,t){if(t==null)return t;const n=e(t);if(!n)throw new Error(`scale not found: ${t}`);return n}function wA(e,{opacity:t,...n}={}){if(!Or(e)&&!ey(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return zy(e,n,(r,i,a,o)=>r.append("svg").attr("width",a).attr("height",o).attr("fill",i.scale).attr("fill-opacity",ft(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function vA(e,{fill:t=(c=>(c=e.hint)==null?void 0:c.fill)()!==void 0?e.hint.fill:"none",fillOpacity:n=1,stroke:r=(u=>(u=e.hint)==null?void 0:u.stroke)()!==void 0?e.hint.stroke:dt(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:a=1.5,r:o=4.5,...s}={},l){const[d,f]=Un(t),[h,m]=Un(r),p=wm(l,d),_=wm(l,h),w=o*o*Math.PI;return n=ft(n)[1],i=ft(i)[1],a=ft(a)[1],zy(e,s,(g,E,v,x)=>g.append("svg").attr("viewBox","-8 -8 16 16").attr("width",v).attr("height",x).attr("fill",d==="color"?y=>p.scale(y):f).attr("fill-opacity",n).attr("stroke",h==="color"?y=>_.scale(y):m).attr("stroke-opacity",i).attr("stroke-width",a).append("path").attr("d",y=>{const M=Kn();return e.scale(y).draw(M,w),M}))}function zy(e,t={},n){let{columns:r,tickFormat:i,fontVariant:a=ay(e),swatchSize:o=15,swatchWidth:s=o,swatchHeight:l=o,marginLeft:c=0,className:u,style:d,width:f}=t;const h=Gf(t);u=Vf(u),i=Qf(e.scale,e.domain,void 0,i);const m=Qe("div",h).attr("class",`${u}-swatches ${u}-swatches-${r!=null?"columns":"wrap"}`);let p;return r!=null?(p=`:where(.${u}-swatches-columns .${u}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${u}-swatches-columns .${u}-swatch::before) {
  flex-shrink: 0;
}
:where(.${u}-swatches-columns .${u}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,m.style("columns",r).selectAll().data(e.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,e,s,l).call(_=>_.append("div").attr("class",`${u}-swatch-label`).attr("title",i).text(i))):(p=`:where(.${u}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${u}-swatches-wrap .${u}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,m.selectAll().data(e.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,e,s,l).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),m.call(_=>_.insert("style","*").text(`:where(.${u}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${u}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${p}`)).style("margin-left",c?`${+c}px`:null).style("width",f===void 0?null:`${+f}px`).style("font-variant",et(a,"normal")).call(jf,d).node()}const Cu=new Map([["symbol",vA],["color",jy],["opacity",xA]]);function MA(e,t,n={}){return(r,i)=>{if(!Cu.has(r))throw new Error(`unknown legend type: ${r}`);if(r in e)return Cu.get(r)(e[r],Vy(t,n[r],i),a=>e[a])}}function Vy({className:e,...t},{label:n,ticks:r,tickFormat:i}={},a){return gx(a,{className:e,...t},{label:n,ticks:r,tickFormat:i})}function jy(e,{legend:t=!0,...n}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return wA(e,n);case"ramp":return CS(e,n);default:throw new Error(`unknown legend type: ${t}`)}}function xA({type:e,interpolate:t,...n},{legend:r=!0,color:i=er(0,0,0),...a}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return jy({type:e,...n,interpolate:EA(i)},{legend:r,...a})}function EA(e){const{r:t,g:n,b:r}=er(e)||er(0,0,0);return i=>`rgba(${t},${n},${r},${i})`}function SA(e,t,n){const r=[];for(const[i,a]of Cu){const o=n[i];if(o!=null&&o.legend&&i in e){const s=a(e[i],Vy(t,e[i],o),l=>e[l]);s!=null&&r.push(s)}}return r}const AA={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},PA={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class NA extends Et{constructor(t={}){const{anchor:n=null,inset:r=0,insetTop:i=r,insetRight:a=r,insetBottom:o=r,insetLeft:s=r,rx:l,ry:c}=t;super(Ho,void 0,t,n==null?AA:PA),this.anchor=d2(n,"anchor",["top","right","bottom","left"]),this.insetTop=Ie(i),this.insetRight=Ie(a),this.insetBottom=Ie(o),this.insetLeft=Ie(s),this.rx=Ie(l),this.ry=Ie(c)}render(t,n,r,i,a){const{marginTop:o,marginRight:s,marginBottom:l,marginLeft:c,width:u,height:d}=i,{anchor:f,insetTop:h,insetRight:m,insetBottom:p,insetLeft:_,rx:w,ry:g}=this,E=c+_,v=u-s-m,x=o+h,y=d-l-p;return Qe(f?"svg:line":"svg:rect",a).datum(0).call(vn,this,i,a).call(Mn,this).call(Vn,this,r).call(Ot,this,{}).call(f==="left"?M=>M.attr("x1",E).attr("x2",E).attr("y1",x).attr("y2",y):f==="right"?M=>M.attr("x1",v).attr("x2",v).attr("y1",x).attr("y2",y):f==="top"?M=>M.attr("x1",E).attr("x2",v).attr("y1",x).attr("y2",x):f==="bottom"?M=>M.attr("x1",E).attr("x2",v).attr("y1",y).attr("y2",y):M=>M.attr("x",E).attr("y",x).attr("width",v-E).attr("height",y-x).attr("rx",w).attr("ry",g)).node()}}function CA(e){return new NA(e)}const yc={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},TA=new Set(["geometry","href","src","ariaLabel","scales"]);class $A extends Et{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&Br(t)&&w2(t)&&(n={...n,title:nt});const{x:r,y:i,x1:a,x2:o,y1:s,y2:l,anchor:c,preferredAnchor:u="bottom",monospace:d,fontFamily:f=d?"ui-monospace, monospace":void 0,fontSize:h,fontStyle:m,fontVariant:p,fontWeight:_,lineHeight:w=1,lineWidth:g=20,frameAnchor:E,format:v,textAnchor:x="start",textOverflow:y,textPadding:M=8,title:A,pointerSize:S=12,pathFilter:$="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:a!=null&&o!=null?null:r,scale:"x",optional:!0},y:{value:s!=null&&l!=null?null:i,scale:"y",optional:!0},x1:{value:a,scale:"x",optional:o==null},y1:{value:s,scale:"y",optional:l==null},x2:{value:o,scale:"x",optional:a==null},y2:{value:l,scale:"y",optional:s==null},title:{value:A,optional:!0}},n,yc),this.anchor=vu(c,"anchor"),this.preferredAnchor=vu(u,"preferredAnchor"),this.frameAnchor=_l(E),this.textAnchor=et(x,"middle"),this.textPadding=+M,this.pointerSize=+S,this.pathFilter=ut($),this.lineHeight=+w,this.lineWidth=+g,this.textOverflow=yy(y),this.monospace=!!d,this.fontFamily=ut(f),this.fontSize=Ie(h),this.fontStyle=ut(m),this.fontVariant=ut(p),this.fontWeight=ut(_);for(const C in yc)C in this.channels&&(this[C]=yc[C]);this.splitLines=wy(this),this.clipLine=vy(this),this.format={...v}}render(t,n,r,i,a){const o=this,{x:s,y:l,fx:c,fy:u}=n,{ownerSVGElement:d,document:f}=a,{anchor:h,monospace:m,lineHeight:p,lineWidth:_}=this,{textPadding:w,pointerSize:g,pathFilter:E}=this,{marginTop:v,marginLeft:x}=i,{x1:y,y1:M,x2:A,y2:S,x:$=y??A,y:C=M??S}=r,k=c?c(t.fx)-x:0,B=u?u(t.fy)-v:0,[G,T]=uo(this,i),I=ry(r,G),O=iy(r,T),q=m?Jf:Zf,z=q(Qr);let H,J;"title"in r?(H=r.channels,J=BA):(H=LA.call(this,r,n),J=OA);const Z=Qe("svg:g",a).call(vn,this,i,a).call(_y,this).call(Ot,this,{x:$&&s,y:C&&l}).call(ne=>ne.selectAll().data(t).enter().append("g").attr("transform",re=>`translate(${Math.round(I(re))},${Math.round(O(re))})`).call(Mn,this).call(re=>re.append("path").attr("filter",E)).call(re=>re.append("text").each(function(Q){const Y=ta(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const R=J.call(o,Q,t,H,n,r);if(typeof R=="string")for(const V of o.splitLines(R))F(Y,{value:o.clipLine(V)});else{const V=new Set;for(const W of R){const{label:U=""}=W;U&&V.has(U)||(V.add(U),F(Y,W))}}})));function F(ne,{label:re,value:Q,color:Y,opacity:R}){re??(re=""),Q??(Q="");const V=Y!=null||R!=null;let W,U=_*100;const[fe]=vi(re,U,q,z);if(fe>=0)re=re.slice(0,fe).trimEnd()+Qr,W=Q.trim(),Q="";else{(re||!Q&&!V)&&(Q=" "+Q);const[ie]=vi(Q,U-q(re),q,z);ie>=0&&(W=Q.trim(),Q=Q.slice(0,ie).trimEnd()+Qr)}const ue=ne.append("tspan").attr("x",0).attr("dy",`${p}em`).text("");re&&ue.append("tspan").attr("font-weight","bold").text(re),Q&&ue.append(()=>f.createTextNode(Q)),V&&ue.append("tspan").text(" ").attr("fill",Y).attr("fill-opacity",R).style("user-select","none"),W&&ue.append("title").text(W)}function te(){const{width:ne,height:re}=i.facet??i;Z.selectChildren().each(function(Q){let{x:Y,width:R,height:V}=this.getBBox();R=Math.round(R),V=Math.round(V);let W=h;if(W===void 0){const ue=I(Q)+k,ie=O(Q)+B,he=ue+R+g+w*2<ne,le=ue-R-g-w*2>0,je=ie+V+g+w*2<re,Ae=ie-V-g-w*2>0;W=he&&le?je&&Ae?o.preferredAnchor:Ae?"bottom":"top":je&&Ae?he?"left":"right":(he||le)&&(je||Ae)?`${Ae?"bottom":"top"}-${he?"left":"right"}`:o.preferredAnchor}const U=this.firstChild,fe=this.lastChild;if(U.setAttribute("d",RA(W,g,w,R,V)),Y)for(const ue of fe.childNodes)ue.setAttribute("x",-Y);fe.setAttribute("y",`${+IA(W,fe.childNodes.length,p).toFixed(6)}em`),fe.setAttribute("transform",`translate(${DA(W,g,w,R,V)})`)}),Z.attr("visibility",null)}return t.length&&(Z.attr("visibility","hidden"),d.isConnected?Promise.resolve().then(te):typeof requestAnimationFrame<"u"&&requestAnimationFrame(te)),Z.node()}}function kA(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=ro(t,n)),new $A(e,{...r,x:t,y:n})}function IA(e,t,n){return/^top(?:-|$)/.test(e)?.94-n:-.29-t*n}function DA(e,t,n,r,i){switch(e){case"middle":return[-r/2,i/2];case"top-left":return[n,t+n];case"top":return[-r/2,t/2+n];case"top-right":return[-r-n,t+n];case"right":return[-t/2-r-n,i/2];case"bottom-left":return[n,-t-n];case"bottom":return[-r/2,-t/2-n];case"bottom-right":return[-r-n,-t-n];case"left":return[n+t/2,i/2]}}function RA(e,t,n,r,i){const a=r+n*2,o=i+n*2;switch(e){case"middle":return`M${-a/2},${-o/2}h${a}v${o}h${-a}z`;case"top-left":return`M0,0l${t},${t}h${a-t}v${o}h${-a}z`;case"top":return`M0,0l${t/2},${t/2}h${(a-t)/2}v${o}h${-a}v${-o}h${(a-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-a}v${o}h${a}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-o/2}h${-a}v${o}h${a}v${t/2-o/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${a-t}v${-o}h${-a}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(a-t)/2}v${-o}h${-a}v${o}h${(a-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-a}v${-o}h${a}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-o/2}h${a}v${o}h${-a}v${t/2-o/2}z`}}function LA({channels:e},t){var i,a;const n={};let r=this.format;r=vm(r,e,"x"),r=vm(r,e,"y"),this.format=r;for(const o in r){const s=r[o];if(!(s===null||s===!1))if(o==="fx"||o==="fy")n[o]=!0;else{const l=Kd(e,o);l&&(n[o]=l)}}for(const o in e){if(o in n||o in r||TA.has(o))continue;const s=Kd(e,o);s&&(n[o]=s)}this.facet&&(t.fx&&!("fx"in r)&&(n.fx=!0),t.fy&&!("fy"in r)&&(n.fy=!0));for(const o in n){const s=this.format[o];if(typeof s=="string"){const l=((i=n[o])==null?void 0:i.value)??((a=t[o])==null?void 0:a.domain())??[];this.format[o]=(Rt(l)?Ja:Si)(s)}else if(s===void 0||s===!0){const l=t[o];this.format[o]=l!=null&&l.bandwidth?Qf(l,l.domain()):wi}}return n}function vm(e,t,n){if(!(n in e))return e;const r=`${n}1`,i=`${n}2`;if((r in e||!(r in t))&&(i in e||!(i in t)))return e;const a=Object.entries(e),o=e[n];return a.splice(a.findIndex(([s])=>s===n)+1,0,[r,o],[i,o]),Object.fromEntries(a)}function BA(e,t,{title:n}){return wi(n.value[e],e)}function*OA(e,t,n,r,i){for(const a in n){if(a==="fx"||a==="fy"){yield{label:$s(r,n,a),value:this.format[a](t[a],e)};continue}if(a==="x1"&&"x2"in n||a==="y1"&&"y2"in n)continue;const o=n[a];if(a==="x2"&&"x1"in n)yield{label:xm(r,n,"x"),value:Mm(this.format.x2,n.x1,o,e)};else if(a==="y2"&&"y1"in n)yield{label:xm(r,n,"y"),value:Mm(this.format.y2,n.y1,o,e)};else{const s=o.value[e],l=o.scale;if(!Tr(s)&&l==null)continue;yield{label:$s(r,n,a),value:this.format[a](s,e),color:l==="color"?i[a][e]:null,opacity:l==="opacity"?i[a][e]:null}}}}function Mm(e,t,n,r){var i;return(i=n.hint)!=null&&i.length?`${e(n.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}${e(n.value[r],r)}`}function xm(e,t,n){const r=$s(e,t,`${n}1`,n),i=$s(e,t,`${n}2`,n);return r===i?r:`${r}${i}`}function $s(e,t,n,r=n){const i=t[n],a=e[(i==null?void 0:i.scale)??n];return String((a==null?void 0:a.label)??(i==null?void 0:i.label)??r)}function Ke(e={}){var z;const{facet:t,style:n,title:r,subtitle:i,caption:a,ariaLabel:o,ariaDescription:s}=e,l=Vf(e.className),c=e.marks===void 0?[]:Sm(e.marks);c.push(...jA(c));const u=zA(t,e),d=new Map;for(const H of c){const J=Am(H,u,e);J&&d.set(H,J)}const f=new Map;u&&Fi(f,[u],e),Fi(f,d,e);const h=Sm(YA(c,f,e));for(const H of h){const J=Am(H,u,e);J&&d.set(H,J)}c.unshift(...h);let m=dS(f,e);if(m!==void 0){const H=u?mc(m,u):void 0;for(const Z of c){if(Z.facet===null||Z.facet==="super")continue;const F=d.get(Z);F!==void 0&&(F.facetsIndex=Z.fx!=null||Z.fy!=null?mc(m,F):H)}const J=new Set;for(const{facetsIndex:Z}of d.values())Z==null||Z.forEach((F,te)=>{(F==null?void 0:F.length)>0&&J.add(te)});m.forEach(0<J.size&&J.size<m.length?(Z,F)=>Z.empty=!J.has(F):Z=>Z.empty=!1);for(const Z of c)if(Z.facet==="exclude"){const F=d.get(Z);F!==void 0&&(F.facetsIndex=bS(F.facetsIndex))}}for(const H of Be.keys())_u(e[H])&&H!=="fx"&&H!=="fy"&&f.set(H,[]);const p=new Map;for(const H of c){if(p.has(H))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:J,channels:Z}=d.get(H)??{},{data:F,facets:te,channels:ne}=H.initialize(J,Z,e);eh(ne,e),p.set(H,{data:F,facets:te,channels:ne})}const _=Au(Fi(f,p,e),e),w=fS(_,c,e);qE(_,w);const g=im(_),{fx:E,fy:v}=g,x=E||v?Z2(_,w):w,y=E||v?eP(g,w):w,M=Gf(e),A=M.document,S=js("svg").call(A.documentElement);let $=S;M.ownerSVGElement=S,M.className=l,M.projection=tE(e,x),M.filterFacets=(H,J)=>mc(m,{channels:J,groups:Yf(H,J)}),M.getMarkState=H=>{const J=p.get(H),Z=d.get(H);return{...J,channels:{...J.channels,...Z==null?void 0:Z.channels}}},M.dispatchValue=H=>{$.value!==H&&($.value=H,$.dispatchEvent(new Event("input",{bubbles:!0})))};const C=new Set;for(const[H,J]of p)if(H.initializer!=null){const Z=H.facet==="super"?y:x,F=H.initializer(J.data,J.facets,J.channels,g,Z,M);if(F.data!==void 0&&(J.data=F.data),F.facets!==void 0&&(J.facets=F.facets),F.channels!==void 0){const{fx:te,fy:ne,...re}=F.channels;HA(re),Object.assign(J.channels,re);for(const Q of Object.values(re)){const{scale:Y}=Q;Y!=null&&!_x(Be.get(Y))&&(Yy(Q,e),C.add(Y))}(te!=null||ne!=null)&&d.set(H,!0)}}if(C.size){const H=new Map;Fi(H,p,e,te=>C.has(te)),Fi(f,p,e,te=>C.has(te));const J=QA(Au(H,e),_),{scales:Z,...F}=im(J);Object.assign(_,J),Object.assign(g,F),Object.assign(g.scales,Z)}let k,B;m!==void 0&&(k={x:E==null?void 0:E.domain(),y:v==null?void 0:v.domain()},m=mS(m,k),B=pS(E,v,w));for(const[H,J]of p)J.values=H.scale(J.channels,g,M);const{width:G,height:T}=w;ta(S).attr("class",l).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",G).attr("height",T).attr("viewBox",`0 0 ${G} ${T}`).attr("aria-label",o).attr("aria-description",s).call(H=>H.append("style").text(`:where(.${l}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${l} text),
:where(.${l} tspan) {
  white-space: pre;
}`)).call(jf,n);for(const H of c){const{channels:J,values:Z,facets:F}=p.get(H);if(m===void 0||H.facet==="super"){let te=null;if(F&&(te=F[0],te=H.filter(te,J,Z),te.length===0))continue;const ne=H.render(te,g,Z,y,M);if(ne==null)continue;S.appendChild(ne)}else{let te;for(const ne of m){if(!(((z=H.facetAnchor)==null?void 0:z.call(H,m,k,ne))??!ne.empty))continue;let re=null;if(F){const Y=d.has(H);if(re=F[Y?ne.i:0],re=H.filter(re,J,Z),re.length===0)continue;!Y&&re===F[0]&&(re=ox(re)),re.fx=ne.x,re.fy=ne.y,re.fi=ne.i}const Q=H.render(re,g,Z,x,M);if(Q!=null){(te??(te=ta(S).append("g"))).append(()=>Q).datum(ne);for(const Y of["aria-label","aria-description","aria-hidden","transform"])Q.hasAttribute(Y)&&(te.attr(Y,Q.getAttribute(Y)),Q.removeAttribute(Y))}}te==null||te.selectChildren().attr("transform",B)}}const I=SA(_,M,e),{figure:O=r!=null||i!=null||a!=null||I.length>0}=e;O&&($=A.createElement("figure"),$.className=`${l}-figure`,$.style.maxWidth="initial",r!=null&&$.append(Em(A,r,"h2")),i!=null&&$.append(Em(A,i,"h3")),$.append(...I,S),a!=null&&$.append(FA(A,a))),$.scale=KE(g.scales),$.legend=MA(_,M,e);const q=eE();return q>0&&ta(S).append("text").attr("x",G).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("").append("title").text(`${q.toLocaleString("en-US")} warning${q===1?"":"s"}. Please check the console.`),$}function Em(e,t,n){if(t.ownerDocument)return t;const r=e.createElement(n);return r.append(t),r}function FA(e,t){const n=e.createElement("figcaption");return n.append(t),n}function GA({marks:e=[],...t}={}){return Ke({...t,marks:[...e,this]})}Et.prototype.plot=GA;function Sm(e){return e.flat(1/0).filter(t=>t!=null).map(UA)}function UA(e){return typeof e.render=="function"?e:new qA(e)}class qA extends Et{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function eh(e,t){for(const n in e)Yy(e[n],t);return e}function Yy(e,t){const{scale:n,transform:r=!0}=e;if(n==null||!r)return;const{type:i,percent:a,interval:o,transform:s=a?l=>l*100:_2(o,i)}=t[n]??{};s!=null&&(e.value=Ze(e.value,s),e.transform=!1)}function HA(e){for(const t in e)D2(t,e[t])}function Fi(e,t,n,r=tx){var i,a;for(const{channels:o}of t.values())for(const s in o){const l=o[s],{scale:c}=l;if(c!=null&&r(c))if(c==="projection"){if(!aE(n)){const u=((i=n.x)==null?void 0:i.domain)===void 0,d=((a=n.y)==null?void 0:a.domain)===void 0;if(u||d){const[f,h]=sE(l);u&&_c(e,"x",f),d&&_c(e,"y",h)}}}else _c(e,c,l)}return e}function _c(e,t,n){const r=e.get(t);r!==void 0?r.push(n):e.set(t,[n])}function zA(e,t){if(e==null)return;const{x:n,y:r}=e;if(n==null&&r==null)return;const i=xt(e.data);if(i==null)throw new Error("missing facet data");const a={};n!=null&&(a.fx=Aa(i,{value:n,scale:"fx"})),r!=null&&(a.fy=Aa(i,{value:r,scale:"fy"})),eh(a,t);const o=Yf(i,a);return{channels:a,groups:o,data:e.data}}function Am(e,t,n){var l;if(e.facet===null||e.facet==="super")return;const{fx:r,fy:i}=e;if(r!=null||i!=null){const c=xt(e.data??r??i);if(c===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(c===null)return;const u={};return r!=null&&(u.fx=Aa(c,{value:r,scale:"fx"})),i!=null&&(u.fy=Aa(c,{value:i,scale:"fy"})),eh(u,n),{channels:u,groups:Yf(c,u)}}if(t===void 0)return;const{channels:a,groups:o,data:s}=t;if(e.facet!=="auto"||e.data===s)return{channels:a,groups:o};s.length>0&&(o.size>1||o.size===1&&a.fx&&a.fy&&[...o][0][1].size>1)&&((l=xt(e.data))==null?void 0:l.length)===s.length&&wr(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isnt faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function VA(e,t={}){return _i({...t,x:null,y:null},(n,r,i,a,o,s)=>s.getMarkState(e))}function jA(e){const t=[];for(const n of e){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:a}=r;i=/^x$/i.test(i)?NS:/^y$/i.test(i)?dm:PS,r=i(VA(n,r)),r.title=null,a===void 0&&(r.preferredAnchor=i===dm?"left":"bottom");const o=kA(n.data,r);o.facet=n.facet,o.facetAnchor=n.facetAnchor,t.push(o)}}return t}function YA(e,t,n){let{projection:r,x:i={},y:a={},fx:o={},fy:s={},axis:l,grid:c,facet:u={},facet:{axis:d=l,grid:f}=u,x:{axis:h=l,grid:m=h===null?null:c}=i,y:{axis:p=l,grid:_=p===null?null:c}=a,fx:{axis:w=d,grid:g=w===null?null:f}=o,fy:{axis:E=d,grid:v=E===null?null:f}=s}=n;(r||!_u(i)&&!Pm("x",e))&&(h=m=null),(r||!_u(a)&&!Pm("y",e))&&(p=_=null),t.has("fx")||(w=g=null),t.has("fy")||(E=v=null),h===void 0&&(h=!ko(e,"x")),p===void 0&&(p=!ko(e,"y")),w===void 0&&(w=!ko(e,"fx")),E===void 0&&(E=!ko(e,"fy")),h===!0&&(h="bottom"),p===!0&&(p="left"),w===!0&&(w=h==="top"||h===null?"bottom":"top"),E===!0&&(E=p==="right"||p===null?"left":"right");const x=[];return $o(x,v,hA,s),To(x,E,aA,"right","left",u,s),$o(x,g,mA,o),To(x,w,oA,"top","bottom",u,o),$o(x,_,fA,a),To(x,p,$y,"left","right",n,a),$o(x,m,dA,i),To(x,h,ky,"bottom","top",n,i),x}function To(e,t,n,r,i,a,o){if(!t)return;const s=WA(t);o=XA(s?r:t,a,o);const{line:l}=o;(n===$y||n===ky)&&l&&!Sa(l)&&e.push(CA(KA(o))),e.push(n(o)),s&&e.push(n({...o,anchor:i,label:null}))}function $o(e,t,n,r){!t||Sa(t)||e.push(n(ZA(t,r)))}function WA(e){return/^\s*both\s*$/i.test(e)}function XA(e,t,{line:n=t.line,ticks:r,tickSize:i,tickSpacing:a,tickPadding:o,tickFormat:s,tickRotate:l,fontVariant:c,ariaLabel:u,ariaDescription:d,label:f=t.label,labelAnchor:h,labelArrow:m=t.labelArrow,labelOffset:p}){return{anchor:e,line:n,ticks:r,tickSize:i,tickSpacing:a,tickPadding:o,tickFormat:s,tickRotate:l,fontVariant:c,ariaLabel:u,ariaDescription:d,label:f,labelAnchor:h,labelArrow:m,labelOffset:p}}function KA(e){const{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:n===!0?void 0:n}}function ZA(e,{stroke:t=yl(e)?e:void 0,ticks:n=JA(e)?e:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:a}){return{stroke:t,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:a}}function JA(e){switch(typeof e){case"number":return!0;case"string":return!yl(e)}return Br(e)||typeof(e==null?void 0:e.range)=="function"}function ko(e,t){const n=`${t}-axis `;return e.some(r=>{var i;return(i=r.ariaLabel)==null?void 0:i.startsWith(n)})}function Pm(e,t){for(const n of t)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===e||i==="projection")return!0}return!1}function QA(e,t){for(const n in e){const r=e[n],i=t[n];r.label===void 0&&i&&(r.label=i.label)}return e}function eP({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:a,marginLeft:o,width:s,height:l}=zf(n),c=e&&Nm(e),u=t&&Nm(t);return{marginTop:t?u[0]:r,marginRight:e?s-c[1]:i,marginBottom:t?l-u[1]:a,marginLeft:e?c[0]:o,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:s,height:l}}function Nm(e){const t=e.domain();let n=e(t[0]),r=e(t[t.length-1]);return r<n&&([n,r]=[r,n]),[n,r+e.bandwidth()]}const tP=new Map([["basis",J4],["basis-closed",Q4],["basis-open",eM],["bundle",tM],["bump-x",U4],["bump-y",q4],["cardinal",nM],["cardinal-closed",rM],["cardinal-open",iM],["catmull-rom",aM],["catmull-rom-closed",oM],["catmull-rom-open",sM],["linear",mf],["linear-closed",lM],["monotone-x",cM],["monotone-y",uM],["natural",fM],["step",hM],["step-after",mM],["step-before",dM]]);function nP(e=mf,t){if(typeof e=="function")return e;const n=tP.get(`${e}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}function rP(e=ks,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?ks:nP(e,t)}function ks(e){return mf(e)}function iP(e={}){return m2(e)?e:{...e,x:nt}}function aP(e={}){return p2(e)?e:{...e,y:nt}}function oP(e,t){if(t.length===1)return{data:e,facets:t};const n=e.length,r=new Uint8Array(n);let i=0;for(const s of t)for(const l of s)r[l]&&++i,r[l]=1;if(i===0)return{data:e,facets:t};e=Ea(e);const a=e[u2]=new Uint32Array(n+i);t=t.map(s=>Ea(s,Uint32Array));let o=n;r.fill(0);for(const s of t)for(let l=0,c=s.length;l<c;++l){const u=s[l];r[u]?(s[l]=o,e[o]=e[u],a[o]=u,++o):a[u]=u,r[u]=1}return{data:e,facets:t}}function sP(e={},t={}){arguments.length===1&&([e,t]=Wy(e));const{y1:n,y:r=n,x:i,...a}=t,[o,s,l,c]=Xy(r,i,"y","x",e,a);return{...o,y1:n,y:s,x1:l,x2:c,x:y2(l,c)}}function lP(e={},t={}){arguments.length===1&&([e,t]=Wy(e));const{x1:n,x:r=n,y:i,...a}=t,[o,s,l,c]=Xy(r,i,"x","y",e,a);return{...o,x1:n,x:s,y1:l,y2:c,y:y2(l,c)}}function cP({x:e,x1:t,x2:n,...r}={}){return r=Sl(r,"y"),t===void 0&&n===void 0?sP({x:e,...r}):([t,n]=g2(e,t,n),{...r,x1:t,x2:n})}function uP({y:e,y1:t,y2:n,...r}={}){return r=Sl(r,"x"),t===void 0&&n===void 0?lP({y:e,...r}):([t,n]=g2(e,t,n),{...r,y1:t,y2:n})}function Wy(e){const{offset:t,order:n,reverse:r,...i}=e;return[{offset:t,order:n,reverse:r},i]}const fP={length:!0};function Xy(e,t=ex,n,r,{offset:i,order:a,reverse:o},s){if(t===null)throw new Error(`stack requires ${r}`);const l=ax(s),[c,u]=zr(e),[d,f]=Ts(t),[h,m]=Ts(t);return d.hint=h.hint=fP,i=hP(i),a=pP(a,i,r),[vl(s,(p,_,w)=>{({data:p,facets:_}=oP(p,_));const g=e==null?void 0:u(wu(We(p,e),w==null?void 0:w[n])),E=We(p,t,Float64Array),v=We(p,l),x=a&&a(p,g,E,v),y=p.length,M=f(new Float64Array(y)),A=m(new Float64Array(y)),S=[];for(const $ of _){const C=g?Array.from(Uu($,k=>g[k]).values()):[$];if(x)for(const k of C)k.sort(x);for(const k of C){let B=0,G=0;o&&k.reverse();for(const T of k){const I=E[T];I<0?B=A[T]=(M[T]=B)+I:I>0?G=A[T]=(M[T]=G)+I:A[T]=M[T]=G}}S.push(C)}return i&&i(S,M,A,v),{data:p,facets:_}}),c,d,h]}function hP(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return dP;case"center":case"silhouette":return mP;case"wiggle":return Zy}throw new Error(`unknown offset: ${e}`)}}function Ky(e,t){let n=0,r=0;for(const i of e){const a=t[i];a<n&&(n=a),a>r&&(r=a)}return[n,r]}function dP(e,t,n){for(const r of e)for(const i of r){const[a,o]=Ky(i,n);for(const s of i){const l=1/(o-a||1);t[s]=l*(t[s]-a),n[s]=l*(n[s]-a)}}}function mP(e,t,n){for(const r of e){for(const i of r){const[a,o]=Ky(i,n);for(const s of i){const l=(o+a)/2;t[s]-=l,n[s]-=l}}Jy(r,t,n)}Qy(e,t,n)}function Zy(e,t,n,r){for(const i of e){const a=new Mr;let o=0;for(const s of i){let l=-1;const c=s.map(h=>Math.abs(n[h]-t[h])),u=s.map(h=>{l=r?r[h]:++l;const m=n[h]-t[h],p=a.has(l)?m-a.get(l):0;return a.set(l,m),p}),d=[0,...Q_(u)];for(const h of s)t[h]+=o,n[h]+=o;const f=Qn(c);f&&(o-=Qn(c,(h,m)=>(u[m]/2+d[m])*h)/f)}Jy(i,t,n)}Qy(e,t,n)}function Jy(e,t,n){const r=Xt(e,i=>Xt(i,a=>t[a]));for(const i of e)for(const a of i)t[a]-=r,n[a]-=r}function Qy(e,t,n){const r=e.length;if(r===1)return;const i=e.map(s=>s.flat()),a=i.map(s=>(Xt(s,l=>t[l])+Ge(s,l=>n[l]))/2),o=Xt(a);for(let s=0;s<r;s++){const l=o-a[s];for(const c of i[s])t[c]+=l,n[c]+=l}}function pP(e,t,n){if(e===void 0&&t===Zy)return Cm(en);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),i=r?Cs:en;switch((r?e.slice(1):e).toLowerCase()){case"value":case n:return bP(i);case"z":return gP(i);case"sum":return yP(i);case"appearance":return _P(i);case"inside-out":return Cm(i)}return Tm(f2(e))}if(typeof e=="function")return(e.length===1?Tm:wP)(e);if(Array.isArray(e))return vP(e);throw new Error(`invalid order: ${e}`)}}function bP(e){return(t,n,r)=>(i,a)=>e(r[i],r[a])}function gP(e){return(t,n,r,i)=>(a,o)=>e(i[a],i[o])}function yP(e){return Cl(e,(t,n,r,i)=>Hu(Hn(t),a=>Qn(a,o=>r[o]),a=>i[a]))}function _P(e){return Cl(e,(t,n,r,i)=>Hu(Hn(t),a=>n[F1(a,o=>r[o])],a=>i[a]))}function Cm(e){return Cl(e,(t,n,r,i)=>{const a=Hn(t),o=Hu(a,d=>n[F1(d,f=>r[f])],d=>i[d]),s=Kr(a,d=>Qn(d,f=>r[f]),d=>i[d]),l=[],c=[];let u=0;for(const d of o)u<0?(u+=s.get(d),l.push(d)):(u-=s.get(d),c.push(d));return c.reverse().concat(l)})}function Tm(e){return t=>{const n=We(t,e);return(r,i)=>en(n[r],n[i])}}function wP(e){return t=>(n,r)=>e(t[n],t[r])}function vP(e){return Cl(en,()=>e)}function Cl(e,t){return(n,r,i,a)=>{if(!a)throw new Error("missing channel: z");const o=new Mr(t(n,r,i,a).map((s,l)=>[s,l]));return(s,l)=>e(o.get(a[s]),o.get(a[l]))}}const MP={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class xP extends Et{constructor(t,n={}){const{x1:r,y1:i,x2:a,y2:o,curve:s,tension:l}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:a,scale:"x",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,MP),this.curve=rP(s,l),Al(this,n)}project(t,n,r){this.curve!==ks&&super.project(t,n,r)}render(t,n,r,i,a){const{x1:o,y1:s,x2:l=o,y2:c=s}=r,{curve:u}=this;return Qe("svg:g",a).call(vn,this,i,a).call(Ot,this,n).call(d=>d.selectAll().data(t).enter().append("path").call(Mn,this).attr("d",u===ks&&a.projection?EP(a.projection,o,s,l,c):f=>{const h=Kn(),m=u(h);return m.lineStart(),m.point(o[f],s[f]),m.point(l[f],c[f]),m.lineEnd(),h}).call(Vn,this,r).call(Pl,this,r,a)).node()}}function EP(e,t,n,r,i){const a=rf(e);return t=Wr(t),n=Wr(n),r=Wr(r),i=Wr(i),o=>a({type:"LineString",coordinates:[[t[o],n[o]],[r[o],i[o]]]})}function $m(e,{x:t,x1:n,x2:r,y:i,y1:a,y2:o,...s}={}){return[n,r]=km(t,n,r),[a,o]=km(i,a,o),new xP(e,{...s,x1:n,x2:r,y1:a,y2:o})}function km(e,t,n){if(e===void 0){if(t===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[t]}else{if(t===void 0)return n===void 0?[e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}class th extends Et{constructor(t,n,r={},i){super(t,n,r,i);const{inset:a=0,insetTop:o=a,insetRight:s=a,insetBottom:l=a,insetLeft:c=a,rx:u,ry:d}=r;this.insetTop=Ie(o),this.insetRight=Ie(s),this.insetBottom=Ie(l),this.insetLeft=Ie(c),this.rx=et(u,"auto"),this.ry=et(d,"auto")}render(t,n,r,i,a){const{rx:o,ry:s}=this;return Qe("svg:g",a).call(vn,this,i,a).call(this._transform,this,n).call(l=>l.selectAll().data(t).enter().append("rect").call(Mn,this).attr("x",this._x(n,r,i)).attr("width",this._width(n,r,i)).attr("y",this._y(n,r,i)).attr("height",this._height(n,r,i)).call(Ee,"rx",o).call(Ee,"ry",s).call(Vn,this,r)).node()}_x(t,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?a=>n[a]+i:r+i}_y(t,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?a=>n[a]+i:r+i}_width({x:t},{x:n},{marginRight:r,marginLeft:i,width:a}){const{insetLeft:o,insetRight:s}=this,l=n&&t?t.bandwidth():a-r-i;return Math.max(0,l-o-s)}_height({y:t},{y:n},{marginTop:r,marginBottom:i,height:a}){const{insetTop:o,insetBottom:s}=this,l=n&&t?t.bandwidth():a-r-i;return Math.max(0,l-o-s)}}const e_={ariaLabel:"bar"};class SP extends th{constructor(t,n={}){const{x1:r,x2:i,y:a}=n;super(t,{x1:{value:r,scale:"x"},x2:{value:i,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},n,e_)}_transform(t,n,{x:r}){t.call(Ot,n,{x:r},0,0)}_x({x:t},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:a}=this;return ir(t)?i+a:o=>Math.min(n[o],r[o])+a}_width({x:t},{x1:n,x2:r},{marginRight:i,marginLeft:a,width:o}){const{insetLeft:s,insetRight:l}=this;return ir(t)?o-i-a-s-l:c=>Math.max(0,Math.abs(r[c]-n[c])-s-l)}}class AP extends th{constructor(t,n={}){const{x:r,y1:i,y2:a}=n;super(t,{y1:{value:i,scale:"y"},y2:{value:a,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},n,e_)}_transform(t,n,{y:r}){t.call(Ot,n,{y:r},0,0)}_y({y:t},{y1:n,y2:r},{marginTop:i}){const{insetTop:a}=this;return ir(t)?i+a:o=>Math.min(n[o],r[o])+a}_height({y:t},{y1:n,y2:r},{marginTop:i,marginBottom:a,height:o}){const{insetTop:s,insetBottom:l}=this;return ir(t)?o-i-a-s-l:c=>Math.max(0,Math.abs(r[c]-n[c])-s-l)}}function Tl(e,t={}){return b2(t)||(t={...t,y:$f,x2:nt}),new SP(e,cP(dy(iP(t))))}function Na(e,t={}){return b2(t)||(t={...t,x:$f,y2:nt}),new AP(e,uP(my(aP(t))))}const PP={ariaLabel:"cell"};class NP extends th{constructor(t,{x:n,y:r,...i}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},i,PP)}_transform(t,n){t.call(Ot,n,{},0,0)}}function Tu(e,{x:t,y:n,...r}={}){return[t,n]=ro(t,n),new NP(e,{...r,x:t,y:n})}const CP={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function TP(e){return e.sort===void 0&&e.reverse===void 0?Px({channel:"-r"},e):e}class $P extends Et{constructor(t,n={}){const{x:r,y:i,r:a,rotate:o,symbol:s=Ma,frameAnchor:l}=n,[c,u]=ft(o,0),[d,f]=Sx(s),[h,m]=ft(a,d==null?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:h,scale:"r",filter:ml,optional:!0},rotate:{value:c,optional:!0},symbol:{value:d,scale:"auto",optional:!0}},TP(n),CP),this.r=m,this.rotate=u,this.symbol=f,this.frameAnchor=_l(l);const{channels:p}=this,{symbol:_}=p;if(_){const{fill:w,stroke:g}=p;_.hint={fill:w?w.value===_.value?"color":"currentColor":this.fill??"currentColor",stroke:g?g.value===_.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,i,a){const{x:o,y:s}=n,{x:l,y:c,r:u,rotate:d,symbol:f}=r,{r:h,rotate:m,symbol:p}=this,[_,w]=uo(this,i),g=p===Ma,E=u?void 0:h*h*Math.PI;return Nf(h)&&(t=[]),Qe("svg:g",a).call(vn,this,i,a).call(Ot,this,{x:l&&o,y:c&&s}).call(v=>v.selectAll().data(t).enter().append(g?"circle":"path").call(Mn,this).call(g?x=>{x.attr("cx",l?y=>l[y]:_).attr("cy",c?y=>c[y]:w).attr("r",u?y=>u[y]:h)}:x=>{x.attr("transform",Xf`translate(${l?y=>l[y]:_},${c?y=>c[y]:w})${d?y=>` rotate(${d[y]})`:m?` rotate(${m})`:""}`).attr("d",u&&f?y=>{const M=Kn();return f[y].draw(M,u[y]*u[y]*Math.PI),M}:u?y=>{const M=Kn();return p.draw(M,u[y]*u[y]*Math.PI),M}:f?y=>{const M=Kn();return f[y].draw(M,E),M}:(()=>{const y=Kn();return p.draw(y,E),y})())}).call(Vn,this,r)).node()}}function Ln(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=ro(t,n)),new $P(e,{...r,x:t,y:n})}const kP={ariaLabel:"tick",fill:null,stroke:"currentColor"};class IP extends Et{constructor(t,n,r){super(t,n,r,kP),Al(this,r)}render(t,n,r,i,a){return Qe("svg:g",a).call(vn,this,i,a).call(this._transform,this,n).call(o=>o.selectAll().data(t).enter().append("line").call(Mn,this).attr("x1",this._x1(n,r,i)).attr("x2",this._x2(n,r,i)).attr("y1",this._y1(n,r,i)).attr("y2",this._y2(n,r,i)).call(Vn,this,r).call(Pl,this,r,a)).node()}}class DP extends IP{constructor(t,n={}){const{x:r,y:i,inset:a=0,insetTop:o=a,insetBottom:s=a}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y",type:"band",optional:!0}},n),this.insetTop=Ie(o),this.insetBottom=Ie(s)}_transform(t,n,{x:r}){t.call(Ot,n,{x:r},mt,0)}_x1(t,{x:n}){return r=>n[r]}_x2(t,{x:n}){return r=>n[r]}_y1({y:t},{y:n},{marginTop:r}){const{insetTop:i}=this;return n&&t?a=>n[a]+i:r+i}_y2({y:t},{y:n},{height:r,marginBottom:i}){const{insetBottom:a}=this;return n&&t?o=>n[o]+t.bandwidth()-a:r-i-a}}function Im(e,{x:t=nt,...n}={}){return new DP(e,{...n,x:t})}const t_=new Map,n_=new Map,RP=new Map,LP=new Map;function BP(e){return t_.get(e)}function r_(e){return n_.get(e)}function la(e){const t=e%12;return t===1||t===3||t===6||t===8||t===10}const OP=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],i_=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],Ca=[{pitch:0,name:"C",octave:-1,label:"C-1",frequency:8.176},{pitch:1,name:"C#",octave:-1,label:"C#-1",frequency:8.662},{pitch:2,name:"D",octave:-1,label:"D-1",frequency:9.177},{pitch:3,name:"D#",octave:-1,label:"D#-1",frequency:9.723},{pitch:4,name:"E",octave:-1,label:"E-1",frequency:10.301},{pitch:5,name:"F",octave:-1,label:"F-1",frequency:10.913},{pitch:6,name:"F#",octave:-1,label:"F#-1",frequency:11.562},{pitch:7,name:"G",octave:-1,label:"G-1",frequency:12.25},{pitch:8,name:"G#",octave:-1,label:"G#-1",frequency:12.978},{pitch:9,name:"A",octave:-1,label:"A-1",frequency:13.75},{pitch:10,name:"A#",octave:-1,label:"A#-1",frequency:14.568},{pitch:11,name:"B",octave:-1,label:"B-1",frequency:15.434},{pitch:12,name:"C",octave:0,label:"C0",frequency:16.352},{pitch:13,name:"C#",octave:0,label:"C#0",frequency:17.324},{pitch:14,name:"D",octave:0,label:"D0",frequency:18.354},{pitch:15,name:"D#",octave:0,label:"D#0",frequency:19.445},{pitch:16,name:"E",octave:0,label:"E0",frequency:20.602},{pitch:17,name:"F",octave:0,label:"F0",frequency:21.827},{pitch:18,name:"F#",octave:0,label:"F#0",frequency:23.125},{pitch:19,name:"G",octave:0,label:"G0",frequency:24.5},{pitch:20,name:"G#",octave:0,label:"G#0",frequency:25.957},{pitch:21,name:"A",octave:0,label:"A0",frequency:27.5},{pitch:22,name:"A#",octave:0,label:"A#0",frequency:29.135},{pitch:23,name:"B",octave:0,label:"B0",frequency:30.868},{pitch:24,name:"C",octave:1,label:"C1",frequency:32.703},{pitch:25,name:"C#",octave:1,label:"C#1",frequency:34.648},{pitch:26,name:"D",octave:1,label:"D1",frequency:36.708},{pitch:27,name:"D#",octave:1,label:"D#1",frequency:38.891},{pitch:28,name:"E",octave:1,label:"E1",frequency:41.203},{pitch:29,name:"F",octave:1,label:"F1",frequency:43.654},{pitch:30,name:"F#",octave:1,label:"F#1",frequency:46.249},{pitch:31,name:"G",octave:1,label:"G1",frequency:48.999},{pitch:32,name:"G#",octave:1,label:"G#1",frequency:51.913},{pitch:33,name:"A",octave:1,label:"A1",frequency:55},{pitch:34,name:"A#",octave:1,label:"A#1",frequency:58.27},{pitch:35,name:"B",octave:1,label:"B1",frequency:61.735},{pitch:36,name:"C",octave:2,label:"C2",frequency:65.406},{pitch:37,name:"C#",octave:2,label:"C#2",frequency:69.296},{pitch:38,name:"D",octave:2,label:"D2",frequency:73.416},{pitch:39,name:"D#",octave:2,label:"D#2",frequency:77.782},{pitch:40,name:"E",octave:2,label:"E2",frequency:82.407},{pitch:41,name:"F",octave:2,label:"F2",frequency:87.307},{pitch:42,name:"F#",octave:2,label:"F#2",frequency:92.499},{pitch:43,name:"G",octave:2,label:"G2",frequency:97.999},{pitch:44,name:"G#",octave:2,label:"G#2",frequency:103.826},{pitch:45,name:"A",octave:2,label:"A2",frequency:110},{pitch:46,name:"A#",octave:2,label:"A#2",frequency:116.541},{pitch:47,name:"B",octave:2,label:"B2",frequency:123.471},{pitch:48,name:"C",octave:3,label:"C3",frequency:130.813},{pitch:49,name:"C#",octave:3,label:"C#3",frequency:138.591},{pitch:50,name:"D",octave:3,label:"D3",frequency:146.832},{pitch:51,name:"D#",octave:3,label:"D#3",frequency:155.563},{pitch:52,name:"E",octave:3,label:"E3",frequency:164.814},{pitch:53,name:"F",octave:3,label:"F3",frequency:174.614},{pitch:54,name:"F#",octave:3,label:"F#3",frequency:184.997},{pitch:55,name:"G",octave:3,label:"G3",frequency:195.998},{pitch:56,name:"G#",octave:3,label:"G#3",frequency:207.652},{pitch:57,name:"A",octave:3,label:"A3",frequency:220},{pitch:58,name:"A#",octave:3,label:"A#3",frequency:233.082},{pitch:59,name:"B",octave:3,label:"B3",frequency:246.942},{pitch:60,name:"C",octave:4,label:"C4",frequency:261.626},{pitch:61,name:"C#",octave:4,label:"C#4",frequency:277.183},{pitch:62,name:"D",octave:4,label:"D4",frequency:293.665},{pitch:63,name:"D#",octave:4,label:"D#4",frequency:311.127},{pitch:64,name:"E",octave:4,label:"E4",frequency:329.628},{pitch:65,name:"F",octave:4,label:"F4",frequency:349.228},{pitch:66,name:"F#",octave:4,label:"F#4",frequency:369.994},{pitch:67,name:"G",octave:4,label:"G4",frequency:391.995},{pitch:68,name:"G#",octave:4,label:"G#4",frequency:415.305},{pitch:69,name:"A",octave:4,label:"A4",frequency:440},{pitch:70,name:"A#",octave:4,label:"A#4",frequency:466.164},{pitch:71,name:"B",octave:4,label:"B4",frequency:493.883},{pitch:72,name:"C",octave:5,label:"C5",frequency:523.251},{pitch:73,name:"C#",octave:5,label:"C#5",frequency:554.365},{pitch:74,name:"D",octave:5,label:"D5",frequency:587.33},{pitch:75,name:"D#",octave:5,label:"D#5",frequency:622.254},{pitch:76,name:"E",octave:5,label:"E5",frequency:659.255},{pitch:77,name:"F",octave:5,label:"F5",frequency:698.456},{pitch:78,name:"F#",octave:5,label:"F#5",frequency:739.989},{pitch:79,name:"G",octave:5,label:"G5",frequency:783.991},{pitch:80,name:"G#",octave:5,label:"G#5",frequency:830.609},{pitch:81,name:"A",octave:5,label:"A5",frequency:880},{pitch:82,name:"A#",octave:5,label:"A#5",frequency:932.328},{pitch:83,name:"B",octave:5,label:"B5",frequency:987.767},{pitch:84,name:"C",octave:6,label:"C6",frequency:1046.502},{pitch:85,name:"C#",octave:6,label:"C#6",frequency:1108.731},{pitch:86,name:"D",octave:6,label:"D6",frequency:1174.659},{pitch:87,name:"D#",octave:6,label:"D#6",frequency:1244.508},{pitch:88,name:"E",octave:6,label:"E6",frequency:1318.51},{pitch:89,name:"F",octave:6,label:"F6",frequency:1396.913},{pitch:90,name:"F#",octave:6,label:"F#6",frequency:1479.978},{pitch:91,name:"G",octave:6,label:"G6",frequency:1567.982},{pitch:92,name:"G#",octave:6,label:"G#6",frequency:1661.219},{pitch:93,name:"A",octave:6,label:"A6",frequency:1760},{pitch:94,name:"A#",octave:6,label:"A#6",frequency:1864.655},{pitch:95,name:"B",octave:6,label:"B6",frequency:1975.533},{pitch:96,name:"C",octave:7,label:"C7",frequency:2093.005},{pitch:97,name:"C#",octave:7,label:"C#7",frequency:2217.461},{pitch:98,name:"D",octave:7,label:"D7",frequency:2349.318},{pitch:99,name:"D#",octave:7,label:"D#7",frequency:2489.016},{pitch:100,name:"E",octave:7,label:"E7",frequency:2637.02},{pitch:101,name:"F",octave:7,label:"F7",frequency:2793.826},{pitch:102,name:"F#",octave:7,label:"F#7",frequency:2959.955},{pitch:103,name:"G",octave:7,label:"G7",frequency:3135.963},{pitch:104,name:"G#",octave:7,label:"G#7",frequency:3322.438},{pitch:105,name:"A",octave:7,label:"A7",frequency:3520},{pitch:106,name:"A#",octave:7,label:"A#7",frequency:3729.31},{pitch:107,name:"B",octave:7,label:"B7",frequency:3951.066},{pitch:108,name:"C",octave:8,label:"C8",frequency:4186.009},{pitch:109,name:"C#",octave:8,label:"C#8",frequency:4434.922},{pitch:110,name:"D",octave:8,label:"D8",frequency:4698.636},{pitch:111,name:"D#",octave:8,label:"D#8",frequency:4978.032},{pitch:112,name:"E",octave:8,label:"E8",frequency:5274.041},{pitch:113,name:"F",octave:8,label:"F8",frequency:5587.652},{pitch:114,name:"F#",octave:8,label:"F#8",frequency:5919.911},{pitch:115,name:"G",octave:8,label:"G8",frequency:6271.927},{pitch:116,name:"G#",octave:8,label:"G#8",frequency:6644.875},{pitch:117,name:"A",octave:8,label:"A8",frequency:7040},{pitch:118,name:"A#",octave:8,label:"A#8",frequency:7458.62},{pitch:119,name:"B",octave:8,label:"B8",frequency:7902.133},{pitch:120,name:"C",octave:9,label:"C9",frequency:8372.018},{pitch:121,name:"C#",octave:9,label:"C#9",frequency:8869.844},{pitch:122,name:"D",octave:9,label:"D9",frequency:9397.273},{pitch:123,name:"D#",octave:9,label:"D#9",frequency:9956.063},{pitch:124,name:"E",octave:9,label:"E9",frequency:10548.08},{pitch:125,name:"F",octave:9,label:"F9",frequency:11175.3},{pitch:126,name:"F#",octave:9,label:"F#9",frequency:11839.82},{pitch:127,name:"G",octave:9,label:"G9",frequency:12543.85}],FP=[{number:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,group:"Piano",label:"Bright Acoustic Piano"},{number:2,group:"Piano",label:"Electric Grand Piano"},{number:3,group:"Piano",label:"Honky-tonk Piano"},{number:4,group:"Piano",label:"Electric Piano 1"},{number:5,group:"Piano",label:"Electric Piano 2"},{number:6,group:"Piano",label:"Harpsichord"},{number:7,group:"Piano",label:"Clavinet"},{number:8,group:"Chromatic Percussion",label:"Celesta"},{number:9,group:"Chromatic Percussion",label:"Glockenspiel"},{number:10,group:"Chromatic Percussion",label:"Music Box"},{number:11,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,group:"Chromatic Percussion",label:"Marimba"},{number:13,group:"Chromatic Percussion",label:"Xylophone"},{number:14,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,group:"Chromatic Percussion",label:"Dulcimer"},{number:16,group:"Organ",label:"Drawbar Organ"},{number:17,group:"Organ",label:"Percussive Organ"},{number:18,group:"Organ",label:"Rock Organ"},{number:19,group:"Organ",label:"Church Organ"},{number:20,group:"Organ",label:"Reed Organ"},{number:21,group:"Organ",label:"Accordion"},{number:22,group:"Organ",label:"Harmonica"},{number:23,group:"Organ",label:"Tango Accordion"},{number:24,group:"Guitar",label:"Acoustic Guitar(nylon)"},{number:25,group:"Guitar",label:"Acoustic Guitar(steel)"},{number:26,group:"Guitar",label:"Electric Guitar(jazz)"},{number:27,group:"Guitar",label:"Electric Guitar(clean)"},{number:28,group:"Guitar",label:"Electric Guitar(muted)"},{number:29,group:"Guitar",label:"Overdriven Guitar"},{number:30,group:"Guitar",label:"Distortion Guitar"},{number:31,group:"Guitar",label:"Guitar harmonics"},{number:32,group:"Bass",label:"Acoustic Bass"},{number:33,group:"Bass",label:"Electric Bass(finger)"},{number:34,group:"Bass",label:"Electric Bass(pick)"},{number:35,group:"Bass",label:"Fretless Bass"},{number:36,group:"Bass",label:"Slap Bass 1"},{number:37,group:"Bass",label:"Slap Bass 2"},{number:38,group:"Bass",label:"Synth Bass 1"},{number:39,group:"Bass",label:"Synth Bass 2"},{number:40,group:"Strings",label:"Violin"},{number:41,group:"Strings",label:"Viola"},{number:42,group:"Strings",label:"Cello"},{number:43,group:"Strings",label:"Contrabass"},{number:44,group:"Strings",label:"Tremolo Strings"},{number:45,group:"Strings",label:"Pizzicato Strings"},{number:46,group:"Strings",label:"Orchestral Harp"},{number:47,group:"Strings",label:"Timpani"},{number:48,group:"Strings (continued)",label:"String Ensemble 1"},{number:49,group:"Strings (continued)",label:"String Ensemble 2"},{number:50,group:"Strings (continued)",label:"Synth Strings 1"},{number:51,group:"Strings (continued)",label:"Synth Strings 2"},{number:52,group:"Strings (continued)",label:"Choir Aahs"},{number:53,group:"Strings (continued)",label:"Voice Oohs"},{number:54,group:"Strings (continued)",label:"Synth Voice"},{number:55,group:"Strings (continued)",label:"Orchestra Hit"},{number:56,group:"Brass",label:"Trumpet"},{number:57,group:"Brass",label:"Trombone"},{number:58,group:"Brass",label:"Tuba"},{number:59,group:"Brass",label:"Muted Trumpet"},{number:60,group:"Brass",label:"French Horn"},{number:61,group:"Brass",label:"Brass Section"},{number:62,group:"Brass",label:"Synth Brass 1"},{number:63,group:"Brass",label:"Synth Brass 2"},{number:64,group:"Reed",label:"Soprano Sax"},{number:65,group:"Reed",label:"Alto Sax"},{number:66,group:"Reed",label:"Tenor Sax"},{number:67,group:"Reed",label:"Baritone Sax"},{number:68,group:"Reed",label:"Oboe"},{number:69,group:"Reed",label:"English Horn"},{number:70,group:"Reed",label:"Bassoon"},{number:71,group:"Reed",label:"Clarinet"},{number:72,group:"Pipe",label:"Piccolo"},{number:73,group:"Pipe",label:"Flute"},{number:74,group:"Pipe",label:"Recorder"},{number:75,group:"Pipe",label:"Pan Flute"},{number:76,group:"Pipe",label:"Blown Bottle"},{number:77,group:"Pipe",label:"Shakuhachi"},{number:78,group:"Pipe",label:"Whistle"},{number:79,group:"Pipe",label:"Ocarina"},{number:80,group:"Synth Lead",label:"Lead 1(square)"},{number:81,group:"Synth Lead",label:"Lead 2(sawtooth)"},{number:82,group:"Synth Lead",label:"Lead 3(calliope)"},{number:83,group:"Synth Lead",label:"Lead 4(chiff)"},{number:84,group:"Synth Lead",label:"Lead 5(charang)"},{number:85,group:"Synth Lead",label:"Lead 6(voice)"},{number:86,group:"Synth Lead",label:"Lead 7(fifths)"},{number:87,group:"Synth Lead",label:"Lead 8(bass + lead)"},{number:88,group:"Synth Pad",label:"Pad 1(new age)"},{number:89,group:"Synth Pad",label:"Pad 2(warm)"},{number:90,group:"Synth Pad",label:"Pad 3(polysynth)"},{number:91,group:"Synth Pad",label:"Pad 4(choir)"},{number:92,group:"Synth Pad",label:"Pad 5(bowed)"},{number:93,group:"Synth Pad",label:"Pad 6(metallic)"},{number:94,group:"Synth Pad",label:"Pad 7(halo)"},{number:95,group:"Synth Pad",label:"Pad 8(sweep)"},{number:96,group:"Synth Effects",label:"FX 1(rain)"},{number:97,group:"Synth Effects",label:"FX 2(soundtrack)"},{number:98,group:"Synth Effects",label:"FX 3(crystal)"},{number:99,group:"Synth Effects",label:"FX 4(atmosphere)"},{number:100,group:"Synth Effects",label:"FX 5(brightness)"},{number:101,group:"Synth Effects",label:"FX 6(goblins)"},{number:102,group:"Synth Effects",label:"FX 7(echoes)"},{number:103,group:"Synth Effects",label:"FX 8(sci-fi)"},{number:104,group:"Ethnic",label:"Sitar"},{number:105,group:"Ethnic",label:"Banjo"},{number:106,group:"Ethnic",label:"Shamisen"},{number:107,group:"Ethnic",label:"Koto"},{number:108,group:"Ethnic",label:"Kalimba"},{number:109,group:"Ethnic",label:"Bag pipe"},{number:110,group:"Ethnic",label:"Fiddle"},{number:111,group:"Ethnic",label:"Shanai"},{number:112,group:"Percussive",label:"Tinkle Bell"},{number:113,group:"Percussive",label:"Agogo"},{number:114,group:"Percussive",label:"Steel Drums"},{number:115,group:"Percussive",label:"Woodblock"},{number:116,group:"Percussive",label:"Taiko Drum"},{number:117,group:"Percussive",label:"Melodic Tom"},{number:118,group:"Percussive",label:"Synth Drum"},{number:119,group:"Sound Effects",label:"Reverse Cymbal"},{number:120,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,group:"Sound Effects",label:"Breath Noise"},{number:122,group:"Sound Effects",label:"Seashore"},{number:123,group:"Sound Effects",label:"Bird Tweet"},{number:124,group:"Sound Effects",label:"Telephone Ring"},{number:125,group:"Sound Effects",label:"Helicopter"},{number:126,group:"Sound Effects",label:"Applause"},{number:127,group:"Sound Effects",label:"Gunshot"}],GP=[{number:1,subnumber:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,subnumber:1,group:"Piano",label:"Wide Acoustic Grand"},{number:1,subnumber:2,group:"Piano",label:"Dark Acoustic Grand"},{number:2,subnumber:0,group:"Piano",label:"Bright Acoustic Piano"},{number:2,subnumber:1,group:"Piano",label:"Wide Bright Acoustic"},{number:3,subnumber:0,group:"Piano",label:"Electric Grand Piano"},{number:3,subnumber:1,group:"Piano",label:"Wide Electric Grand"},{number:4,subnumber:0,group:"Piano",label:"Honky-tonk Piano"},{number:4,subnumber:1,group:"Piano",label:"Wide Honky-tonk"},{number:5,subnumber:0,group:"Piano",label:"Rhodes Piano"},{number:5,subnumber:1,group:"Piano",label:"Detuned Electric Piano 1"},{number:5,subnumber:2,group:"Piano",label:"Electric Piano 1 Variation"},{number:5,subnumber:3,group:"Piano",label:"60's Electric Piano"},{number:6,subnumber:0,group:"Piano",label:"Chorused Electric Piano"},{number:6,subnumber:1,group:"Piano",label:"Detuned Electric Piano 2"},{number:6,subnumber:2,group:"Piano",label:"Electric Piano 2 Variation"},{number:6,subnumber:3,group:"Piano",label:"Electric Piano Legend"},{number:6,subnumber:4,group:"Piano",label:"Electric Piano Phase"},{number:7,subnumber:0,group:"Piano",label:"Harpsichord"},{number:7,subnumber:1,group:"Piano",label:"Coupled Harpsichord"},{number:7,subnumber:2,group:"Piano",label:"Wide Harpsichord"},{number:7,subnumber:3,group:"Piano",label:"Open Harpsichord"},{number:8,subnumber:0,group:"Piano",label:"Clavinet"},{number:8,subnumber:1,group:"Piano",label:"Pulse Clavinet"},{number:9,subnumber:0,group:"Chromatic Percussion",label:"Celesta"},{number:10,subnumber:0,group:"Chromatic Percussion",label:"Glockenspiel"},{number:11,subnumber:0,group:"Chromatic Percussion",label:"Music Box"},{number:12,subnumber:0,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,subnumber:1,group:"Chromatic Percussion",label:"Wet Vibraphone"},{number:13,subnumber:0,group:"Chromatic Percussion",label:"Marimba"},{number:13,subnumber:1,group:"Chromatic Percussion",label:"Wide Marimba"},{number:14,subnumber:0,group:"Chromatic Percussion",label:"Xylophone"},{number:15,subnumber:0,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,subnumber:1,group:"Chromatic Percussion",label:"Church Bells"},{number:15,subnumber:2,group:"Chromatic Percussion",label:"Carillon"},{number:16,subnumber:0,group:"Chromatic Percussion",label:"Dulcimer / Santur"},{number:17,subnumber:0,group:"Organ",label:"Hammond Organ"},{number:17,subnumber:1,group:"Organ",label:"Detuned Organ 1"},{number:17,subnumber:2,group:"Organ",label:"60's Organ 1"},{number:17,subnumber:3,group:"Organ",label:"Organ 4"},{number:18,subnumber:0,group:"Organ",label:"Percussive Organ"},{number:18,subnumber:1,group:"Organ",label:"Detuned Organ 2"},{number:18,subnumber:2,group:"Organ",label:"Organ 5"},{number:19,subnumber:0,group:"Organ",label:"Rock Organ"},{number:20,subnumber:0,group:"Organ",label:"Church Organ 1"},{number:20,subnumber:1,group:"Organ",label:"Church Organ 2"},{number:20,subnumber:2,group:"Organ",label:"Church Organ 3"},{number:21,subnumber:0,group:"Organ",label:"Reed Organ"},{number:21,subnumber:1,group:"Organ",label:"Puff Organ"},{number:22,subnumber:0,group:"Organ",label:"French Accordion"},{number:22,subnumber:1,group:"Organ",label:"Italian Accordion"},{number:23,subnumber:0,group:"Organ",label:"Harmonica"},{number:24,subnumber:0,group:"Organ",label:"Bandoneon"},{number:25,subnumber:0,group:"Guitar",label:"Nylon-String Guitar"},{number:25,subnumber:1,group:"Guitar",label:"Ukelele"},{number:25,subnumber:2,group:"Guitar",label:"Open Nylon Guitar"},{number:25,subnumber:3,group:"Guitar",label:"Nylon Guitar 2"},{number:26,subnumber:0,group:"Guitar",label:"Steel-String Guitar"},{number:26,subnumber:1,group:"Guitar",label:"12-String Guitar"},{number:26,subnumber:2,group:"Guitar",label:"Mandolin"},{number:26,subnumber:3,group:"Guitar",label:"Steel + Body"},{number:27,subnumber:0,group:"Guitar",label:"Jazz Guitar"},{number:27,subnumber:1,group:"Guitar",label:"Hawaiian Guitar"},{number:28,subnumber:0,group:"Guitar",label:"Clean Electric Guitar"},{number:28,subnumber:1,group:"Guitar",label:"Chorus Guitar"},{number:28,subnumber:2,group:"Guitar",label:"Mid Tone Guitar"},{number:29,subnumber:0,group:"Guitar",label:"Muted Electric Guitar"},{number:29,subnumber:1,group:"Guitar",label:"Funk Guitar"},{number:29,subnumber:2,group:"Guitar",label:"Funk Guitar 2"},{number:29,subnumber:3,group:"Guitar",label:"Jazz Man"},{number:30,subnumber:0,group:"Guitar",label:"Overdriven Guitar"},{number:30,subnumber:1,group:"Guitar",label:"Guitar Pinch"},{number:31,subnumber:0,group:"Guitar",label:"Distortion Guitar"},{number:31,subnumber:1,group:"Guitar",label:"Feedback Guitar"},{number:31,subnumber:2,group:"Guitar",label:"Distortion Rtm Guitar"},{number:32,subnumber:0,group:"Guitar",label:"Guitar Harmonics"},{number:32,subnumber:1,group:"Guitar",label:"Guitar Feedback"},{number:33,subnumber:0,group:"Bass",label:"Acoustic Bass"},{number:34,subnumber:0,group:"Bass",label:"Fingered Bass"},{number:34,subnumber:1,group:"Bass",label:"Finger Slap"},{number:35,subnumber:0,group:"Bass",label:"Picked Bass"},{number:36,subnumber:0,group:"Bass",label:"Fretless Bass"},{number:37,subnumber:0,group:"Bass",label:"Slap Bass 1"},{number:38,subnumber:0,group:"Bass",label:"Slap Bass 2"},{number:39,subnumber:0,group:"Bass",label:"Synth Bass 1"},{number:39,subnumber:1,group:"Bass",label:"Synth Bass 101"},{number:39,subnumber:2,group:"Bass",label:"Synth Bass 3"},{number:39,subnumber:3,group:"Bass",label:"Clavi Bass"},{number:39,subnumber:4,group:"Bass",label:"Hammer"},{number:40,subnumber:0,group:"Bass",label:"Synth Bass 2"},{number:40,subnumber:1,group:"Bass",label:"Synth Bass 4"},{number:40,subnumber:2,group:"Bass",label:"Rubber Bass"},{number:40,subnumber:3,group:"Bass",label:"Attack Pulse"},{number:41,subnumber:0,group:"Strings",label:"Violin"},{number:41,subnumber:1,group:"Strings",label:"Slow Violin"},{number:42,subnumber:0,group:"Strings",label:"Viola"},{number:43,subnumber:0,group:"Strings",label:"Cello"},{number:44,subnumber:0,group:"Strings",label:"Contrabass"},{number:45,subnumber:0,group:"Strings",label:"Tremolo Strings"},{number:46,subnumber:0,group:"Strings",label:"Pizzicato Strings"},{number:47,subnumber:0,group:"Strings",label:"Harp"},{number:47,subnumber:1,group:"Strings",label:"Yang Qin"},{number:48,subnumber:0,group:"Strings",label:"Timpani"},{number:49,subnumber:0,group:"Orchestral Ensemble",label:"String Ensemble"},{number:49,subnumber:1,group:"Orchestral Ensemble",label:"Orchestra Strings"},{number:49,subnumber:2,group:"Orchestral Ensemble",label:"60's Strings"},{number:50,subnumber:0,group:"Orchestral Ensemble",label:"Slow String Ensemble"},{number:51,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 1"},{number:51,subnumber:1,group:"Orchestral Ensemble",label:"Synth Strings 3"},{number:52,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 2"},{number:53,subnumber:0,group:"Orchestral Ensemble",label:"Choir Aahs"},{number:53,subnumber:1,group:"Orchestral Ensemble",label:"Choir Aahs 2"},{number:54,subnumber:0,group:"Orchestral Ensemble",label:"Voice Oohs"},{number:54,subnumber:1,group:"Orchestral Ensemble",label:"Humming"},{number:55,subnumber:0,group:"Orchestral Ensemble",label:"Synth Voice"},{number:55,subnumber:1,group:"Orchestral Ensemble",label:"Analog Voice"},{number:56,subnumber:0,group:"Orchestral Ensemble",label:"Orchestra Hit"},{number:56,subnumber:1,group:"Orchestral Ensemble",label:"Bass Hit"},{number:56,subnumber:2,group:"Orchestral Ensemble",label:"6th Hit"},{number:56,subnumber:3,group:"Orchestral Ensemble",label:"Euro Hit"},{number:57,subnumber:0,group:"Brass",label:"Trumpet"},{number:57,subnumber:1,group:"Brass",label:"Dark Trumpet"},{number:58,subnumber:0,group:"Brass",label:"Trombone"},{number:58,subnumber:1,group:"Brass",label:"Trombone 2"},{number:58,subnumber:2,group:"Brass",label:"Bright Trombone"},{number:59,subnumber:0,group:"Brass",label:"Tuba"},{number:60,subnumber:0,group:"Brass",label:"Muted Trumpet"},{number:60,subnumber:1,group:"Brass",label:"Muted Trumpet 2"},{number:61,subnumber:0,group:"Brass",label:"French Horn"},{number:61,subnumber:1,group:"Brass",label:"French Horn 2"},{number:62,subnumber:0,group:"Brass",label:"Brass Section"},{number:62,subnumber:1,group:"Brass",label:"Brass Section"},{number:63,subnumber:0,group:"Brass",label:"Synth Brass 1"},{number:63,subnumber:1,group:"Brass",label:"Synth Brass 3"},{number:63,subnumber:2,group:"Brass",label:"Analog Brass 1"},{number:63,subnumber:3,group:"Brass",label:"Jump Brass"},{number:64,subnumber:0,group:"Brass",label:"Synth Brass 2"},{number:64,subnumber:1,group:"Brass",label:"Synth Brass 4"},{number:64,subnumber:2,group:"Brass",label:"Analog Brass 2"},{number:65,subnumber:0,group:"Reed",label:"Soprano Sax"},{number:66,subnumber:0,group:"Reed",label:"Alto Sax"},{number:67,subnumber:0,group:"Reed",label:"Tenor Sax"},{number:68,subnumber:0,group:"Reed",label:"Baritone Sax"},{number:69,subnumber:0,group:"Reed",label:"Oboe"},{number:70,subnumber:0,group:"Reed",label:"English Horn"},{number:71,subnumber:0,group:"Reed",label:"Bassoon"},{number:72,subnumber:0,group:"Reed",label:"Clarinet"},{number:73,subnumber:0,group:"Wind",label:"Piccolo"},{number:74,subnumber:0,group:"Wind",label:"Flute"},{number:75,subnumber:0,group:"Wind",label:"Recorder"},{number:76,subnumber:0,group:"Wind",label:"Pan Flute"},{number:77,subnumber:0,group:"Wind",label:"Blown Bottle"},{number:78,subnumber:0,group:"Wind",label:"Shakuhachi"},{number:79,subnumber:0,group:"Wind",label:"Whistle"},{number:80,subnumber:0,group:"Wind",label:"Ocarina"},{number:81,subnumber:0,group:"Lead",label:"Square Lead"},{number:81,subnumber:1,group:"Lead",label:"Square Wave"},{number:81,subnumber:2,group:"Lead",label:"Sine Wave"},{number:82,subnumber:0,group:"Lead",label:"Saw Lead"},{number:82,subnumber:1,group:"Lead",label:"Saw Wave"},{number:82,subnumber:2,group:"Lead",label:"Doctor Solo"},{number:82,subnumber:3,group:"Lead",label:"Natural Lead"},{number:82,subnumber:4,group:"Lead",label:"Sequenced Saw"},{number:83,subnumber:0,group:"Lead",label:"Synth Calliope"},{number:84,subnumber:0,group:"Lead",label:"Chiffer Lead"},{number:85,subnumber:0,group:"Lead",label:"Charang"},{number:85,subnumber:1,group:"Lead",label:"Wire Lead"},{number:86,subnumber:0,group:"Lead",label:"Solo Synth Vox"},{number:87,subnumber:0,group:"Lead",label:"5th Saw Wave"},{number:88,subnumber:0,group:"Lead",label:"Bass & Lead"},{number:88,subnumber:1,group:"Lead",label:"Delayed Lead"},{number:89,subnumber:0,group:"Synth Pad",label:"Fantasia Pad"},{number:90,subnumber:0,group:"Synth Pad",label:"Warm Pad"},{number:90,subnumber:1,group:"Synth Pad",label:"Sine Pad"},{number:91,subnumber:0,group:"Synth Pad",label:"Polysynth Pad"},{number:92,subnumber:0,group:"Synth Pad",label:"Space Voice Pad"},{number:92,subnumber:1,group:"Synth Pad",label:"Itopia"},{number:93,subnumber:0,group:"Synth Pad",label:"Bowed Glass Pad"},{number:94,subnumber:0,group:"Synth Pad",label:"Metal Pad"},{number:95,subnumber:0,group:"Synth Pad",label:"Halo Pad"},{number:96,subnumber:0,group:"Synth Pad",label:"Sweep Pad"},{number:97,subnumber:0,group:"Synth Effects",label:"Ice Rain"},{number:98,subnumber:0,group:"Synth Effects",label:"Soundtrack"},{number:99,subnumber:0,group:"Synth Effects",label:"Crystal"},{number:99,subnumber:1,group:"Synth Effects",label:"Synth Mallet"},{number:100,subnumber:0,group:"Synth Effects",label:"Atmosphere"},{number:101,subnumber:0,group:"Synth Effects",label:"Brightness"},{number:102,subnumber:0,group:"Synth Effects",label:"Goblin"},{number:103,subnumber:0,group:"Synth Effects",label:"Echo Drops"},{number:103,subnumber:1,group:"Synth Effects",label:"Echo Bell"},{number:103,subnumber:2,group:"Synth Effects",label:"Echo Pan"},{number:104,subnumber:0,group:"Synth Effects",label:"Star Theme"},{number:105,subnumber:0,group:"Ethnic",label:"Sitar"},{number:105,subnumber:1,group:"Ethnic",label:"Sitar 2"},{number:106,subnumber:0,group:"Ethnic",label:"Banjo"},{number:107,subnumber:0,group:"Ethnic",label:"Shamisen"},{number:108,subnumber:0,group:"Ethnic",label:"Koto"},{number:108,subnumber:1,group:"Ethnic",label:"Taisho Koto"},{number:109,subnumber:0,group:"Ethnic",label:"Kalimba"},{number:110,subnumber:0,group:"Ethnic",label:"Bagpipe"},{number:111,subnumber:0,group:"Ethnic",label:"Fiddle"},{number:112,subnumber:0,group:"Ethnic",label:"Shanai"},{number:113,subnumber:0,group:"Percussive",label:"Tinkle Bell"},{number:114,subnumber:0,group:"Percussive",label:"Agogo"},{number:115,subnumber:0,group:"Percussive",label:"Steel Drums"},{number:116,subnumber:0,group:"Percussive",label:"Woodblock"},{number:116,subnumber:1,group:"Percussive",label:"Castanets"},{number:117,subnumber:0,group:"Percussive",label:"Taiko Drum"},{number:117,subnumber:1,group:"Percussive",label:"Concert Bass Drum"},{number:118,subnumber:0,group:"Percussive",label:"Melodic Tom 1"},{number:118,subnumber:1,group:"Percussive",label:"Melodic Tom 2"},{number:119,subnumber:0,group:"Percussive",label:"Synth Drum"},{number:119,subnumber:1,group:"Percussive",label:"808 Tom"},{number:119,subnumber:2,group:"Percussive",label:"Electric Percussion"},{number:120,subnumber:0,group:"Percussive",label:"Reverse Cymbal"},{number:121,subnumber:0,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,subnumber:1,group:"Sound Effects",label:"Guitar Cut Noise"},{number:121,subnumber:2,group:"Sound Effects",label:"String Slap"},{number:122,subnumber:0,group:"Sound Effects",label:"Breath Noise"},{number:122,subnumber:1,group:"Sound Effects",label:"Flute Key Click"},{number:123,subnumber:0,group:"Sound Effects",label:"Seashore"},{number:123,subnumber:1,group:"Sound Effects",label:"Rain"},{number:123,subnumber:2,group:"Sound Effects",label:"Thunder"},{number:123,subnumber:3,group:"Sound Effects",label:"Wind"},{number:123,subnumber:4,group:"Sound Effects",label:"Stream"},{number:123,subnumber:5,group:"Sound Effects",label:"Bubble"},{number:124,subnumber:0,group:"Sound Effects",label:"Bird Tweet"},{number:124,subnumber:1,group:"Sound Effects",label:"Dog"},{number:124,subnumber:2,group:"Sound Effects",label:"Horse Gallop"},{number:124,subnumber:3,group:"Sound Effects",label:"Bird 2"},{number:125,subnumber:0,group:"Sound Effects",label:"Telephone 1"},{number:125,subnumber:1,group:"Sound Effects",label:"Telephone 2"},{number:125,subnumber:2,group:"Sound Effects",label:"Door Creaking"},{number:125,subnumber:3,group:"Sound Effects",label:"Door Closing"},{number:125,subnumber:4,group:"Sound Effects",label:"Scratch"},{number:125,subnumber:5,group:"Sound Effects",label:"Wind Chimes"},{number:126,subnumber:0,group:"Sound Effects",label:"Helicopter"},{number:126,subnumber:1,group:"Sound Effects",label:"Car Engine"},{number:126,subnumber:2,group:"Sound Effects",label:"Car Stop"},{number:126,subnumber:3,group:"Sound Effects",label:"Car Pass"},{number:126,subnumber:4,group:"Sound Effects",label:"Car Crash"},{number:126,subnumber:5,group:"Sound Effects",label:"Siren"},{number:126,subnumber:6,group:"Sound Effects",label:"Train"},{number:126,subnumber:7,group:"Sound Effects",label:"Jetplane"},{number:126,subnumber:8,group:"Sound Effects",label:"Starship"},{number:126,subnumber:9,group:"Sound Effects",label:"Burst Noise"},{number:127,subnumber:0,group:"Sound Effects",label:"Applause"},{number:127,subnumber:1,group:"Sound Effects",label:"Laughing"},{number:127,subnumber:2,group:"Sound Effects",label:"Screaming"},{number:127,subnumber:3,group:"Sound Effects",label:"Punch"},{number:127,subnumber:4,group:"Sound Effects",label:"Heart Beat"},{number:127,subnumber:5,group:"Sound Effects",label:"Footsteps"},{number:128,subnumber:0,group:"Sound Effects",label:"Gun Shot"},{number:128,subnumber:1,group:"Sound Effects",label:"Machine Gun"},{number:128,subnumber:2,group:"Sound Effects",label:"Lasergun"},{number:128,subnumber:3,group:"Sound Effects",label:"Explosion"}];for(const e of Ca)t_.set(e.pitch,e),n_.set(e.label,e);for(const e of FP)RP.set(e.number,e);for(const e of GP){const t=`${e.number}-${e.subnumber}`;LP.set(t,e)}var UP={value:()=>{}};function a_(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new zo(n)}function zo(e){this._=e}function qP(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}zo.prototype=a_.prototype={constructor:zo,on:function(e,t){var n=this._,r=qP(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=HP(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=Dm(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Dm(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new zo(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function HP(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Dm(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=UP,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var $u="http://www.w3.org/1999/xhtml";const Rm={svg:"http://www.w3.org/2000/svg",xhtml:$u,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $l(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Rm.hasOwnProperty(t)?{space:Rm[t],local:e}:e}function zP(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===$u&&t.documentElement.namespaceURI===$u?t.createElement(e):t.createElementNS(n,e)}}function VP(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function o_(e){var t=$l(e);return(t.local?VP:zP)(t)}function jP(){}function nh(e){return e==null?jP:function(){return this.querySelector(e)}}function YP(e){typeof e!="function"&&(e=nh(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),l,c,u=0;u<o;++u)(l=a[u])&&(c=e.call(l,l.__data__,u,a))&&("__data__"in l&&(c.__data__=l.__data__),s[u]=c);return new Bt(r,this._parents)}function s_(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function WP(){return[]}function l_(e){return e==null?WP:function(){return this.querySelectorAll(e)}}function XP(e){return function(){var t=e.apply(this,arguments);return t==null?[]:s_(t)}}function KP(e){typeof e=="function"?e=XP(e):e=l_(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,l,c=0;c<s;++c)(l=o[c])&&(r.push(e.call(l,l.__data__,c,o)),i.push(l));return new Bt(r,i)}function c_(e){return function(){return this.matches(e)}}function u_(e){return function(t){return t.matches(e)}}var ZP=Array.prototype.find;function JP(e){return function(){return ZP.call(this.children,e)}}function QP(){return this.firstElementChild}function eN(e){return this.select(e==null?QP:JP(typeof e=="function"?e:u_(e)))}var tN=Array.prototype.filter;function nN(){return this.children}function rN(e){return function(){return tN.call(this.children,e)}}function iN(e){return this.selectAll(e==null?nN:rN(typeof e=="function"?e:u_(e)))}function aN(e){typeof e!="function"&&(e=c_(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],l,c=0;c<o;++c)(l=a[c])&&e.call(l,l.__data__,c,a)&&s.push(l);return new Bt(r,this._parents)}function f_(e){return new Array(e.length)}function oN(){return new Bt(this._enter||this._groups.map(f_),this._parents)}function Is(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Is.prototype={constructor:Is,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function sN(e){return function(){return e}}function lN(e,t,n,r,i,a){for(var o=0,s,l=t.length,c=a.length;o<c;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new Is(e,a[o]);for(;o<l;++o)(s=t[o])&&(i[o]=s)}function cN(e,t,n,r,i,a,o){var s,l,c=new Map,u=t.length,d=a.length,f=new Array(u),h;for(s=0;s<u;++s)(l=t[s])&&(f[s]=h=o.call(l,l.__data__,s,t)+"",c.has(h)?i[s]=l:c.set(h,l));for(s=0;s<d;++s)h=o.call(e,a[s],s,a)+"",(l=c.get(h))?(r[s]=l,l.__data__=a[s],c.delete(h)):n[s]=new Is(e,a[s]);for(s=0;s<u;++s)(l=t[s])&&c.get(f[s])===l&&(i[s]=l)}function uN(e){return e.__data__}function fN(e,t){if(!arguments.length)return Array.from(this,uN);var n=t?cN:lN,r=this._parents,i=this._groups;typeof e!="function"&&(e=sN(e));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),c=0;c<a;++c){var u=r[c],d=i[c],f=d.length,h=s_(e.call(u,u&&u.__data__,c,r)),m=h.length,p=s[c]=new Array(m),_=o[c]=new Array(m),w=l[c]=new Array(f);n(u,d,p,_,w,h,t);for(var g=0,E=0,v,x;g<m;++g)if(v=p[g]){for(g>=E&&(E=g+1);!(x=_[E])&&++E<m;);v._next=x||null}}return o=new Bt(o,r),o._enter=s,o._exit=l,o}function hN(){return new Bt(this._exit||this._groups.map(f_),this._parents)}function dN(e,t,n){var r=this.enter(),i=this,a=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(i=t(i)),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function mN(e){if(!(e instanceof Bt))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l=t[s],c=n[s],u=l.length,d=o[s]=new Array(u),f,h=0;h<u;++h)(f=l[h]||c[h])&&(d[h]=f);for(;s<r;++s)o[s]=t[s];return new Bt(o,this._parents)}function pN(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function bN(e){e||(e=gN);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,l=i[a]=new Array(s),c,u=0;u<s;++u)(c=o[u])&&(l[u]=c);l.sort(t)}return new Bt(i,this._parents).order()}function gN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function yN(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function _N(){return Array.from(this)}function wN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function vN(){let e=0;for(const t of this)++e;return e}function MN(){return!this.node()}function xN(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function EN(e){return function(){this.removeAttribute(e)}}function SN(e){return function(){this.removeAttributeNS(e.space,e.local)}}function AN(e,t){return function(){this.setAttribute(e,t)}}function PN(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function NN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function CN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function TN(e,t){var n=$l(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?SN:EN:typeof t=="function"?n.local?CN:NN:n.local?PN:AN)(n,t))}function h_(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $N(e){return function(){this.style.removeProperty(e)}}function kN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function IN(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function DN(e,t,n){return arguments.length>1?this.each((t==null?$N:typeof t=="function"?IN:kN)(e,t,n??"")):Mi(this.node(),e)}function Mi(e,t){return e.style.getPropertyValue(t)||h_(e).getComputedStyle(e,null).getPropertyValue(t)}function RN(e){return function(){delete this[e]}}function LN(e,t){return function(){this[e]=t}}function BN(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ON(e,t){return arguments.length>1?this.each((t==null?RN:typeof t=="function"?BN:LN)(e,t)):this.node()[e]}function d_(e){return e.trim().split(/^|\s+/)}function rh(e){return e.classList||new m_(e)}function m_(e){this._node=e,this._names=d_(e.getAttribute("class")||"")}m_.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function p_(e,t){for(var n=rh(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function b_(e,t){for(var n=rh(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function FN(e){return function(){p_(this,e)}}function GN(e){return function(){b_(this,e)}}function UN(e,t){return function(){(t.apply(this,arguments)?p_:b_)(this,e)}}function qN(e,t){var n=d_(e+"");if(arguments.length<2){for(var r=rh(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?UN:t?FN:GN)(n,t))}function HN(){this.textContent=""}function zN(e){return function(){this.textContent=e}}function VN(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function jN(e){return arguments.length?this.each(e==null?HN:(typeof e=="function"?VN:zN)(e)):this.node().textContent}function YN(){this.innerHTML=""}function WN(e){return function(){this.innerHTML=e}}function XN(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function KN(e){return arguments.length?this.each(e==null?YN:(typeof e=="function"?XN:WN)(e)):this.node().innerHTML}function ZN(){this.nextSibling&&this.parentNode.appendChild(this)}function JN(){return this.each(ZN)}function QN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function eC(){return this.each(QN)}function tC(e){var t=typeof e=="function"?e:o_(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function nC(){return null}function rC(e,t){var n=typeof e=="function"?e:o_(e),r=t==null?nC:typeof t=="function"?t:nh(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function iC(){var e=this.parentNode;e&&e.removeChild(this)}function aC(){return this.each(iC)}function oC(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function sC(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function lC(e){return this.select(e?sC:oC)}function cC(e){return arguments.length?this.property("__data__",e):this.node().__data__}function uC(e){return function(t){e.call(this,t,this.__data__)}}function fC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function hC(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function dC(e,t,n){return function(){var r=this.__on,i,a=uC(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function mC(e,t,n){var r=fC(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,c=s.length,u;l<c;++l)for(i=0,u=s[l];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(s=t?dC:hC,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function g_(e,t,n){var r=h_(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function pC(e,t){return function(){return g_(this,e,t)}}function bC(e,t){return function(){return g_(this,e,t.apply(this,arguments))}}function gC(e,t){return this.each((typeof t=="function"?bC:pC)(e,t))}function*yC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var _C=[null];function Bt(e,t){this._groups=e,this._parents=t}function fo(){return new Bt([[document.documentElement]],_C)}function wC(){return this}Bt.prototype=fo.prototype={constructor:Bt,select:YP,selectAll:KP,selectChild:eN,selectChildren:iN,filter:aN,data:fN,enter:oN,exit:hN,join:dN,merge:mN,selection:wC,order:pN,sort:bN,call:yN,nodes:_N,node:wN,size:vN,empty:MN,each:xN,attr:TN,style:DN,property:ON,classed:qN,text:jN,html:KN,raise:JN,lower:eC,append:tC,insert:rC,remove:aC,clone:lC,datum:cC,on:mC,dispatch:gC,[Symbol.iterator]:yC};function ih(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function y_(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ho(){}var Ta=.7,Ds=1/Ta,ei="\\s*([+-]?\\d+)\\s*",$a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",mn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vC=/^#([0-9a-f]{3,8})$/,MC=new RegExp("^rgb\\("+[ei,ei,ei]+"\\)$"),xC=new RegExp("^rgb\\("+[mn,mn,mn]+"\\)$"),EC=new RegExp("^rgba\\("+[ei,ei,ei,$a]+"\\)$"),SC=new RegExp("^rgba\\("+[mn,mn,mn,$a]+"\\)$"),AC=new RegExp("^hsl\\("+[$a,mn,mn]+"\\)$"),PC=new RegExp("^hsla\\("+[$a,mn,mn,$a]+"\\)$"),Lm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ih(ho,ka,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Bm,formatHex:Bm,formatHsl:NC,formatRgb:Om,toString:Om});function Bm(){return this.rgb().formatHex()}function NC(){return __(this).formatHsl()}function Om(){return this.rgb().formatRgb()}function ka(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=vC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fm(t):n===3?new wt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Io(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Io(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=MC.exec(e))?new wt(t[1],t[2],t[3],1):(t=xC.exec(e))?new wt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=EC.exec(e))?Io(t[1],t[2],t[3],t[4]):(t=SC.exec(e))?Io(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=AC.exec(e))?qm(t[1],t[2]/100,t[3]/100,1):(t=PC.exec(e))?qm(t[1],t[2]/100,t[3]/100,t[4]):Lm.hasOwnProperty(e)?Fm(Lm[e]):e==="transparent"?new wt(NaN,NaN,NaN,0):null}function Fm(e){return new wt(e>>16&255,e>>8&255,e&255,1)}function Io(e,t,n,r){return r<=0&&(e=t=n=NaN),new wt(e,t,n,r)}function CC(e){return e instanceof ho||(e=ka(e)),e?(e=e.rgb(),new wt(e.r,e.g,e.b,e.opacity)):new wt}function ku(e,t,n,r){return arguments.length===1?CC(e):new wt(e,t,n,r??1)}function wt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}ih(wt,ku,y_(ho,{brighter:function(e){return e=e==null?Ds:Math.pow(Ds,e),new wt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ta:Math.pow(Ta,e),new wt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gm,formatHex:Gm,formatRgb:Um,toString:Um}));function Gm(){return"#"+wc(this.r)+wc(this.g)+wc(this.b)}function Um(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function wc(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function qm(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new un(e,t,n,r)}function __(e){if(e instanceof un)return new un(e.h,e.s,e.l,e.opacity);if(e instanceof ho||(e=ka(e)),!e)return new un;if(e instanceof un)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new un(o,s,l,e.opacity)}function w_(e,t,n,r){return arguments.length===1?__(e):new un(e,t,n,r??1)}function un(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}ih(un,w_,y_(ho,{brighter:function(e){return e=e==null?Ds:Math.pow(Ds,e),new un(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ta:Math.pow(Ta,e),new un(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new wt(vc(e>=240?e-240:e+120,i,r),vc(e,i,r),vc(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function vc(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const v_=e=>()=>e;function TC(e,t){return function(n){return e+n*t}}function $C(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function kC(e){return(e=+e)==1?M_:function(t,n){return n-t?$C(t,n,e):v_(isNaN(t)?n:t)}}function M_(e,t){var n=t-e;return n?TC(e,n):v_(isNaN(e)?t:e)}const Iu=function e(t){var n=kC(t);function r(i,a){var o=n((i=ku(i)).r,(a=ku(a)).r),s=n(i.g,a.g),l=n(i.b,a.b),c=M_(i.opacity,a.opacity);return function(u){return i.r=o(u),i.g=s(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=e,r}(1);function Wn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Du=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mc=new RegExp(Du.source,"g");function IC(e){return function(){return e}}function DC(e){return function(t){return e(t)+""}}function RC(e,t){var n=Du.lastIndex=Mc.lastIndex=0,r,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(r=Du.exec(e))&&(i=Mc.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:Wn(r,i)})),n=Mc.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?DC(l[0].x):IC(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)s[(d=l[u]).i]=d.x(c);return s.join("")})}var Hm=180/Math.PI,Ru={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function x_(e,t,n,r,i,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Hm,skewX:Math.atan(l)*Hm,scaleX:o,scaleY:s}}var Do;function LC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ru:x_(t.a,t.b,t.c,t.d,t.e,t.f)}function BC(e){return e==null||(Do||(Do=document.createElementNS("http://www.w3.org/2000/svg","g")),Do.setAttribute("transform",e),!(e=Do.transform.baseVal.consolidate()))?Ru:(e=e.matrix,x_(e.a,e.b,e.c,e.d,e.e,e.f))}function E_(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function a(c,u,d,f,h,m){if(c!==d||u!==f){var p=h.push("translate(",null,t,null,n);m.push({i:p-4,x:Wn(c,d)},{i:p-2,x:Wn(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function o(c,u,d,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Wn(c,u)})):u&&d.push(i(d)+"rotate("+u+r)}function s(c,u,d,f){c!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Wn(c,u)}):u&&d.push(i(d)+"skewX("+u+r)}function l(c,u,d,f,h,m){if(c!==d||u!==f){var p=h.push(i(h)+"scale(",null,",",null,")");m.push({i:p-4,x:Wn(c,d)},{i:p-2,x:Wn(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(c,u){var d=[],f=[];return c=e(c),u=e(u),a(c.translateX,c.translateY,u.translateX,u.translateY,d,f),o(c.rotate,u.rotate,d,f),s(c.skewX,u.skewX,d,f),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,f),c=u=null,function(h){for(var m=-1,p=f.length,_;++m<p;)d[(_=f[m]).i]=_.x(h);return d.join("")}}}var OC=E_(LC,"px, ","px)","deg)"),FC=E_(BC,", ",")",")"),xi=0,Ki=0,Gi=0,S_=1e3,Rs,Zi,Ls=0,kr=0,kl=0,Ia=typeof performance=="object"&&performance.now?performance:Date,A_=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ah(){return kr||(A_(GC),kr=Ia.now()+kl)}function GC(){kr=0}function Bs(){this._call=this._time=this._next=null}Bs.prototype=P_.prototype={constructor:Bs,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ah():+n)+(t==null?0:+t),!this._next&&Zi!==this&&(Zi?Zi._next=this:Rs=this,Zi=this),this._call=e,this._time=n,Lu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lu())}};function P_(e,t,n){var r=new Bs;return r.restart(e,t,n),r}function UC(){ah(),++xi;for(var e=Rs,t;e;)(t=kr-e._time)>=0&&e._call.call(null,t),e=e._next;--xi}function zm(){kr=(Ls=Ia.now())+kl,xi=Ki=0;try{UC()}finally{xi=0,HC(),kr=0}}function qC(){var e=Ia.now(),t=e-Ls;t>S_&&(kl-=t,Ls=e)}function HC(){for(var e,t=Rs,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Rs=n);Zi=e,Lu(r)}function Lu(e){if(!xi){Ki&&(Ki=clearTimeout(Ki));var t=e-kr;t>24?(e<1/0&&(Ki=setTimeout(zm,e-Ia.now()-kl)),Gi&&(Gi=clearInterval(Gi))):(Gi||(Ls=Ia.now(),Gi=setInterval(qC,S_)),xi=1,A_(zm))}}function Vm(e,t,n){var r=new Bs;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var zC=a_("start","end","cancel","interrupt"),VC=[],N_=0,jm=1,Bu=2,Vo=3,Ym=4,Ou=5,jo=6;function Il(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;jC(e,n,{name:t,index:r,group:i,on:zC,tween:VC,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:N_})}function oh(e,t){var n=rn(e,t);if(n.state>N_)throw new Error("too late; already scheduled");return n}function xn(e,t){var n=rn(e,t);if(n.state>Vo)throw new Error("too late; already running");return n}function rn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function jC(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=P_(a,0,n.time);function a(c){n.state=jm,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var u,d,f,h;if(n.state!==jm)return l();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Vo)return Vm(o);h.state===Ym?(h.state=jo,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=jo,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(Vm(function(){n.state===Vo&&(n.state=Ym,n.timer.restart(s,n.delay,n.time),s(c))}),n.state=Bu,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Bu){for(n.state=Vo,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function s(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Ou,1),d=-1,f=i.length;++d<f;)i[d].call(e,u);n.state===Ou&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=jo,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function YC(e,t){var n=e.__transition,r,i,a=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>Bu&&r.state<Ou,r.state=jo,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function WC(e){return this.each(function(){YC(this,e)})}function XC(e,t){var n,r;return function(){var i=xn(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function KC(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var a=xn(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=s;break}l===c&&i.push(s)}a.tween=i}}function ZC(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=rn(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?XC:KC)(n,e,t))}function sh(e,t,n){var r=e._id;return e.each(function(){var i=xn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return rn(i,r).value[t]}}function C_(e,t){var n;return(typeof t=="number"?Wn:t instanceof ka?Iu:(n=ka(t))?(t=n,Iu):RC)(e,t)}function JC(e){return function(){this.removeAttribute(e)}}function QC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eT(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function tT(e,t,n){var r,i=n+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function nT(e,t,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s)))}}function rT(e,t,n){var r,i,a;return function(){var o,s=n(this),l;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),l=s+"",o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s)))}}function iT(e,t){var n=$l(e),r=n==="transform"?FC:C_;return this.attrTween(e,typeof t=="function"?(n.local?rT:nT)(n,r,sh(this,"attr."+e,t)):t==null?(n.local?QC:JC)(n):(n.local?tT:eT)(n,r,t))}function aT(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function oT(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function sT(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&oT(e,a)),n}return i._value=t,i}function lT(e,t){var n,r;function i(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&aT(e,a)),n}return i._value=t,i}function cT(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=$l(e);return this.tween(n,(r.local?sT:lT)(r,t))}function uT(e,t){return function(){oh(this,e).delay=+t.apply(this,arguments)}}function fT(e,t){return t=+t,function(){oh(this,e).delay=t}}function hT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?uT:fT)(t,e)):rn(this.node(),t).delay}function dT(e,t){return function(){xn(this,e).duration=+t.apply(this,arguments)}}function mT(e,t){return t=+t,function(){xn(this,e).duration=t}}function pT(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dT:mT)(t,e)):rn(this.node(),t).duration}function bT(e,t){if(typeof t!="function")throw new Error;return function(){xn(this,e).ease=t}}function gT(e){var t=this._id;return arguments.length?this.each(bT(t,e)):rn(this.node(),t).ease}function yT(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;xn(this,e).ease=n}}function _T(e){if(typeof e!="function")throw new Error;return this.each(yT(this._id,e))}function wT(e){typeof e!="function"&&(e=c_(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],l,c=0;c<o;++c)(l=a[c])&&e.call(l,l.__data__,c,a)&&s.push(l);return new qn(r,this._parents,this._name,this._id)}function vT(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l=t[s],c=n[s],u=l.length,d=o[s]=new Array(u),f,h=0;h<u;++h)(f=l[h]||c[h])&&(d[h]=f);for(;s<r;++s)o[s]=t[s];return new qn(o,this._parents,this._name,this._id)}function MT(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function xT(e,t,n){var r,i,a=MT(t)?oh:xn;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function ET(e,t){var n=this._id;return arguments.length<2?rn(this.node(),n).on.on(e):this.each(xT(n,e,t))}function ST(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function AT(){return this.on("end.remove",ST(this._id))}function PT(e){var t=this._name,n=this._id;typeof e!="function"&&(e=nh(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s=r[o],l=s.length,c=a[o]=new Array(l),u,d,f=0;f<l;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&("__data__"in u&&(d.__data__=u.__data__),c[f]=d,Il(c[f],t,n,f,c,rn(u,n)));return new qn(a,this._parents,t,n)}function NT(e){var t=this._name,n=this._id;typeof e!="function"&&(e=l_(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l=r[s],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var f=e.call(u,u.__data__,d,l),h,m=rn(u,n),p=0,_=f.length;p<_;++p)(h=f[p])&&Il(h,t,n,p,f,m);a.push(f),o.push(u)}return new qn(a,o,t,n)}var CT=fo.prototype.constructor;function TT(){return new CT(this._groups,this._parents)}function $T(e,t){var n,r,i;return function(){var a=Mi(this,e),o=(this.style.removeProperty(e),Mi(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function T_(e){return function(){this.style.removeProperty(e)}}function kT(e,t,n){var r,i=n+"",a;return function(){var o=Mi(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function IT(e,t,n){var r,i,a;return function(){var o=Mi(this,e),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(e),Mi(this,e))),o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s))}}function DT(e,t){var n,r,i,a="style."+t,o="end."+a,s;return function(){var l=xn(this,e),c=l.on,u=l.value[a]==null?s||(s=T_(t)):void 0;(c!==n||i!==u)&&(r=(n=c).copy()).on(o,i=u),l.on=r}}function RT(e,t,n){var r=(e+="")=="transform"?OC:C_;return t==null?this.styleTween(e,$T(e,r)).on("end.style."+e,T_(e)):typeof t=="function"?this.styleTween(e,IT(e,r,sh(this,"style."+e,t))).each(DT(this._id,e)):this.styleTween(e,kT(e,r,t),n).on("end.style."+e,null)}function LT(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function BT(e,t,n){var r,i;function a(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&LT(e,o,n)),r}return a._value=t,a}function OT(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,BT(e,t,n??""))}function FT(e){return function(){this.textContent=e}}function GT(e){return function(){var t=e(this);this.textContent=t??""}}function UT(e){return this.tween("text",typeof e=="function"?GT(sh(this,"text",e)):FT(e==null?"":e+""))}function qT(e){return function(t){this.textContent=e.call(this,t)}}function HT(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&qT(i)),t}return r._value=e,r}function zT(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,HT(e))}function VT(){for(var e=this._name,t=this._id,n=$_(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,c=0;c<s;++c)if(l=o[c]){var u=rn(l,t);Il(l,e,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new qn(r,this._parents,e,n)}function jT(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},l={value:function(){--i===0&&a()}};n.each(function(){var c=xn(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),c.on=t}),i===0&&a()})}var YT=0;function qn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function $_(){return++YT}var fr=fo.prototype;qn.prototype={constructor:qn,select:PT,selectAll:NT,filter:wT,merge:vT,selection:TT,transition:VT,call:fr.call,nodes:fr.nodes,node:fr.node,size:fr.size,empty:fr.empty,each:fr.each,on:ET,attr:iT,attrTween:cT,style:RT,styleTween:OT,text:UT,textTween:zT,remove:AT,tween:ZC,delay:hT,duration:pT,ease:gT,easeVarying:_T,end:jT,[Symbol.iterator]:fr[Symbol.iterator]};function WT(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var XT={time:null,delay:0,duration:250,ease:WT};function KT(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function ZT(e){var t,n;e instanceof qn?(t=e._id,e=e._name):(t=$_(),(n=XT).time=ah(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,l,c=0;c<s;++c)(l=o[c])&&Il(l,e,t,c,o,n||KT(l,t));return new qn(r,this._parents,e,t)}fo.prototype.interrupt=WC;fo.prototype.transition=ZT;function Ji(e,t,n){this.k=e,this.x=t,this.y=n}Ji.prototype={constructor:Ji,scale:function(e){return e===1?this:new Ji(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ji(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ji.prototype;var JT={exports:{}};(function(e){(function(){const t=function(r){let i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;if(r=r.replace(/^.*?base64,/,""),r=String(r).replace(/[\t\n\f\r ]+/g,""),!a.test(r))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");r+="==".slice(2-(r.length&3));let o,s="",l,c,u=0;for(;u<r.length;)o=i.indexOf(r.charAt(u++))<<18|i.indexOf(r.charAt(u++))<<12|(l=i.indexOf(r.charAt(u++)))<<6|(c=i.indexOf(r.charAt(u++))),s+=l===64?String.fromCharCode(o>>16&255):c===64?String.fromCharCode(o>>16&255,o>>8&255):String.fromCharCode(o>>16&255,o>>8&255,o&255);return s},n={debug:!1,parse:function(r,i){if(r instanceof Uint8Array)return n.Uint8(r);if(typeof r=="string")return n.Base64(r);if(r instanceof HTMLElement&&r.type==="file")return n.addListener(r,i);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(r,i){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(r===void 0||!(r instanceof HTMLElement)||r.tagName!=="INPUT"||r.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;i=i||function(){},r.addEventListener("change",function(a){if(!a.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let o=new FileReader;o.readAsArrayBuffer(a.target.files[0]),o.onload=function(s){i(n.Uint8(new Uint8Array(s.target.result)))}})},Base64:function(r){r=String(r);let i=t(r),a=i.length,o=new Uint8Array(new ArrayBuffer(a));for(let s=0;s<a;s++)o[s]=i.charCodeAt(s);return n.Uint8(o)},Uint8:function(r){let i={data:null,pointer:0,movePointer:function(l){return this.pointer+=l,this.pointer},readInt:function(l){if(l=Math.min(l,this.data.byteLength-this.pointer),l<1)return-1;let c=0;if(l>1)for(let u=1;u<=l-1;u++)c+=this.data.getUint8(this.pointer)*Math.pow(256,l-u),this.pointer++;return c+=this.data.getUint8(this.pointer),this.pointer++,c},readStr:function(l){let c="";for(let u=1;u<=l;u++)c+=String.fromCharCode(this.readInt(1));return c},readIntVLV:function(){let l=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)l=this.readInt(1);else{let c=[];for(;this.data.getUint8(this.pointer)>=128;)c.push(this.readInt(1)-128);let u=this.readInt(1);for(let d=1;d<=c.length;d++)l+=c[c.length-d]*Math.pow(128,d);l+=u}return l}};if(i.data=new DataView(r.buffer,r.byteOffset,r.byteLength),i.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;i.readInt(4);let a={};a.formatType=i.readInt(2),a.tracks=i.readInt(2),a.track=[];let o=i.readInt(1),s=i.readInt(1);o>=128?(a.timeDivision=[],a.timeDivision[0]=o-128,a.timeDivision[1]=s):a.timeDivision=o*256+s;for(let l=1;l<=a.tracks;l++){a.track[l-1]={event:[]};let c=i.readInt(4);if(c===-1)break;if(c!==1297379947)return!1;i.readInt(4);let u=0,d=!1,f,h;for(;!d&&(u++,a.track[l-1].event[u-1]={},a.track[l-1].event[u-1].deltaTime=i.readIntVLV(),f=i.readInt(1),f!==-1);)if(f>=128?h=f:(f=h,i.movePointer(-1)),f===255){a.track[l-1].event[u-1].type=255,a.track[l-1].event[u-1].metaType=i.readInt(1);let m=i.readIntVLV();switch(a.track[l-1].event[u-1].metaType){case 47:case-1:d=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:a.track[l-1].event[u-1].data=i.readStr(m);break;case 33:case 89:case 81:a.track[l-1].event[u-1].data=i.readInt(m);break;case 84:a.track[l-1].event[u-1].data=[],a.track[l-1].event[u-1].data[0]=i.readInt(1),a.track[l-1].event[u-1].data[1]=i.readInt(1),a.track[l-1].event[u-1].data[2]=i.readInt(1),a.track[l-1].event[u-1].data[3]=i.readInt(1),a.track[l-1].event[u-1].data[4]=i.readInt(1);break;case 88:a.track[l-1].event[u-1].data=[],a.track[l-1].event[u-1].data[0]=i.readInt(1),a.track[l-1].event[u-1].data[1]=i.readInt(1),a.track[l-1].event[u-1].data[2]=i.readInt(1),a.track[l-1].event[u-1].data[3]=i.readInt(1);break;default:this.customInterpreter!==null&&(a.track[l-1].event[u-1].data=this.customInterpreter(a.track[l-1].event[u-1].metaType,i,m)),(this.customInterpreter===null||a.track[l-1].event[u-1].data===!1)&&(i.readInt(m),a.track[l-1].event[u-1].data=i.readInt(m),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch(f=f.toString(16).split(""),f[1]||f.unshift("0"),a.track[l-1].event[u-1].type=parseInt(f[0],16),a.track[l-1].event[u-1].channel=parseInt(f[1],16),a.track[l-1].event[u-1].type){case 15:{if(this.customInterpreter!==null&&(a.track[l-1].event[u-1].data=this.customInterpreter(a.track[l-1].event[u-1].type,i,!1)),this.customInterpreter===null||a.track[l-1].event[u-1].data===!1){let m=i.readIntVLV();a.track[l-1].event[u-1].data=i.readInt(m),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer")}break}case 10:case 11:case 14:case 8:case 9:a.track[l-1].event[u-1].data=[],a.track[l-1].event[u-1].data[0]=i.readInt(1),a.track[l-1].event[u-1].data[1]=i.readInt(1);break;case 12:case 13:a.track[l-1].event[u-1].data=i.readInt(1);break;case-1:d=!0;break;default:if(this.customInterpreter!==null&&(a.track[l-1].event[u-1].data=this.customInterpreter(a.track[l-1].event[u-1].metaType,i,!1)),this.customInterpreter===null||a.track[l-1].event[u-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return a},customInterpreter:null};e.exports=n})()})(JT);function Xn(e){return 1/(e/60)}const k_=[],QT=[2,1,1/2,1/4,1/8,1/16,1/32,1/64];for(const e of QT)for(let t=0;t<4;t++){let n=e,r=e;for(let i=0;i<t;i++)r/=2,n+=r;k_.push({type:e,dots:t,duration:n})}k_.sort((e,t)=>e.duration-t.duration);function e$(e,t,n,r){e.beginPath(),e.arc(t,n,r,0,2*Math.PI),e.stroke()}class me{constructor(t,n){this.name=t,this.notes=n,this.short=n.join(" "),this.pitches=n.map(r=>r_(r).pitch),this.stringCount=n.length}}const t$=new Map([["Guitar",new Map([[6,[new me("E stand.",["E2","A2","D3","G3","B3","E4"]),new me("Drop D",["D2","A2","D3","G3","B3","E4"]),new me("Drop C",["C2","G2","C3","F3","A3","D4"]),new me("1/2 down",["D#2","G#2","C#3","F#3","A#3","D#4"]),new me("1 down",["D2","G2","C3","F3","A3","D4"]),new me("1 1/2 down",["C#2","F#2","B2","E3","G#3","C#4"]),new me("2 down",["C2","F2","A#2","D#3","G3","C4"]),new me("DADGAG",["D2","A2","D3","G3","A3","D4"])]],[7,[new me("B stand.",["B1","E2","A2","D3","G3","B3","E4"]),new me("Drop A",["A1","E2","A2","D3","G3","B3","E4"]),new me("1/2 down",["A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new me("1 down",["A1","D2","G2","C3","F3","A3","D4"]),new me("1 1/2 down",["G#1","C#2","F#2","B2","E3","G#3","C#4"]),new me("2 down",["G1","C2","F2","A#2","D#3","G3","C4"])]],[8,[new me("F# stand.",["F#1","B1","E2","A2","D3","G3","B3","E4"]),new me("Drop E",["E1","B1","E2","A2","D3","G3","B3","E4"]),new me("1/2 down",["F1","A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new me("1 down",["E1","A1","D2","G2","C3","F3","A3","D4"]),new me("1 1/2 down",["D#1","G#1","C#2","F#2","B2","E3","G#3","C#4"]),new me("2 down",["D1","G1","C2","F2","A#2","D#3","G3","C4"])]]])],["Bass",new Map([[4,[new me("E stand.",["E1","A1","D2","G2"]),new me("Drop D",["D1","A1","D2","G2"]),new me("1/2 down",["D#1","G#1","C#2","F#2"]),new me("1 down",["D1","G1","C2","F2"]),new me("1 1/2 down",["C#1","F#1","B1","E2"]),new me("2 down",["C1","F1","A#1","D#2"])]],[5,[new me("B stand.",["B0","E1","A1","D2","G2"]),new me("Drop A",["A0","D1","A1","D2","G2"]),new me("1/2 down",["A#0","D#1","G#1","C#2","F#2"]),new me("1 down",["A0","D1","G1","C2","F2"]),new me("1 1/2 down",["G#0","C#1","F#1","B1","E2"]),new me("2 down",["G0","C1","F1","A#1","D#2"])]],[6,[new me("F# stand.",["F#0","B0","E1","A1","D2","G2"]),new me("Drop E",["E0","A0","D1","A1","D2","G2"]),new me("1/2 down",["F0","A#0","D#1","G#1","C#2","F#2"]),new me("1 down",["E1","A0","D1","G1","C2","F2"]),new me("1 1/2 down",["D#0","G#0","C#1","F#1","B1","E2"]),new me("2 down",["D0","G0","C1","F1","A#1","D#2"])]]])],["Ukulele",new Map([[4,[new me("Hawaii",["G4","C4","E4","A4"]),new me("Low G",["G3","C4","E4","A4"]),new me("D-tuning",["A4","D4","F#4","B4"]),new me("Canadian",["A3","D4","F#4","B4"]),new me("Bariton",["D3","G3","B3","E4"])]]])]]);class jn{constructor(t,n){this.name=t,this.notes=n,this.short=n.join(" "),this.pitches=n.map(r=>r_(r).pitch),this.pitchesSorted=[...this.pitches].sort((r,i)=>r-i),this.keyCount=n.length}getNumbers(){const t=this.pitchesSorted,n=new Map;for(const[r,i]of t.entries()){let a=r+1,o="",s=i-12;for(;s>0&&n.has(s);)a=n.get(s).number,o+="",s-=12;n.set(i,{number:a,numberString:`${a}${o}`})}return[...n.values()].map(r=>r.numberString)}getLetters(){const t=this.pitchesSorted,n=new Map;for(const[r,i]of t.entries()){let a=r+1,o="",s=i-12;for(;s>0&&n.has(s);)a=n.get(s).number,o+="",s-=12;const l=BP(i).name;n.set(i,{number:a,letterString:`${l}${o}`})}return[...n.values()].map(r=>r.letterString)}}new jn("9 A Major",["A5","C#6","C#5","A5","A4","F#5","E5","E6","B5"]),new jn("9 A Minor",["A5","C6","C5","A5","A4","F5","E5","E6","B5"]),new jn("9 A Minor 7",["A5","C6","C5","A5","A4","F#5","E5","E6","B5"]),new jn("9 A Ake Bono",["A5","D6","D5","A5","A4","F5","E5","E6","A#5"]),new jn("9 A Hijaz",["G5","D6","D5","A5","A4","F#5","D#5","D#6","A#5"]),new jn("9 A Pygmy",["G5","C6","C5","G5","G4","D#5","D5","D#6","A#5"]),new jn("17 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","C4","E4","G4","B4","D5","F5","A5","C6","E6"]),new jn("21 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","B3","G3","F3","A3","C4","E4","G4","B4","D5","F5","A5","C6","E6"]);function n$(e,t=1){const n=w_(e);return n.s=t,n.toString()}["#ff0000","#ff4e00","#db7b00","#ffcc00","#e4ed00","#81d700","#00ffb4","#00ffea","#00baff","#3c00ff","#a800ff","#ff00fd"].map(e=>n$(e,.5));const r$=Iu("black","steelblue");Array.from({length:12}).map((e,t)=>r$(t/11));function i$(e,t,n){const r=e.slice();return r[17]=t[n],r}function a$(e){let t;return{c(){t=P("option"),t.textContent=`${e[17]}`,t.__value=e[17],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function o$(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E,v,x=Te(["velocity","piano","channel","none"]),y=[];for(let M=0;M<4;M+=1)y[M]=a$(i$(e,x,M));return{c(){t=P("main"),n=P("h2"),n.textContent="Guitar Tab",r=L(),i=P("p"),i.textContent=`The guitar tab below shows incoming MIDI notes as rectangles with their
        string (y position) and start and end times (x left and right side of
        the rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,a=L(),o=P("div"),s=P("label"),l=K(`color
            `),c=P("select");for(let M=0;M<4;M+=1)y[M].c();u=L(),d=P("label"),f=K(`time
            `),h=P("input"),m=L(),p=P("div"),_=L(),w=P("div"),g=P("button"),g.textContent="reset",N(i,"class","explanation"),e[2]===void 0&&bt(()=>e[5].call(c)),N(h,"type","number"),N(h,"min","10"),N(h,"max","300"),N(h,"step","10"),N(d,"title","time in seconds for past notes to be shown"),N(o,"class","control"),N(p,"class","visualization"),N(g,"title","Clear all played notes"),N(w,"class","control"),N(t,"class","demo")},m(M,A){oe(M,t,A),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c);for(let S=0;S<4;S+=1)y[S]&&y[S].m(c,null);Le(c,e[2],!0),b(o,u),b(o,d),b(d,f),b(d,h),ce(h,e[1]),b(t,m),b(t,p),e[7](p),b(t,_),b(t,w),b(w,g),E||(v=[X(c,"change",e[5]),X(h,"input",e[6]),X(g,"click",e[8])],E=!0)},p(M,[A]){A&4&&Le(c,M[2]),A&2&&_e(h.value)!==M[1]&&ce(h,M[1])},i:se,o:se,d(M){M&&ae(t),tt(y,M),e[7](null),E=!1,Fe(v)}}}let s$=1e3,l$=500,c$=6;function u$(e,t,n){let r=[64,59,55,50,45,40],i,a=30,o="velocity",s=0,l=[];const c=new Map;let u=null;const d=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((E,v)=>{console.log(`MIDI device ${v}: ${E.name}`),E.addListener("noteon",f),E.addListener("noteoff",h)}),[...D.inputs])},f=E=>{const v=(E.timestamp-s)/1e3,x=E.message.channel-1,y={number:E.note.number,velocity:E.rawVelocity,time:v,channel:E.message.channel,string:x,fret:E.note.number-r[x]};if(c.has(E.note.number)){const M=c.get(E.note.number);M.end===void 0&&(M.end=v)}l.push(y),c.set(E.note.number,y)},h=E=>{if(c.has(E.note.number)){const v=c.get(E.note.number),x=(E.timestamp-s)/1e3;v.end=x}},m=()=>{const E=(performance.now()-s)/1e3,v=E-a,x=l.filter(C=>C.end>v||C.end===void 0),y=ht(x,C=>C.number),M=r.map(bn.fromMidiSharps);let A,S;o==="velocity"?(A={label:"Note velocity",scheme:"blues",domain:[0,127]},S="velocity"):o==="piano"?(A={label:"Piano key color",domain:["black","white"],range:["black","white"]},S=C=>la(C.number)?"black":"white"):o==="channel"?(A={type:"categorical",label:"MIDI channel",scheme:"tableau10"},S=C=>C.channel):o==="none"&&(S="#ddd");const $=Ke({insetRight:10,width:s$,height:l$,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[v,E]},y:{label:"String",grid:!0,domain:we(0,c$),tickFormat:C=>M[C]},color:{...A,legend:o!=="none",marginLeft:100,width:300},marks:[Lt(we(Math.ceil((y[0]-1)/12)*12,y[1]+2,12)),jt([E],{stroke:"#888"}),Tl(x,{clip:!0,x1:"time",x2:C=>C.end===void 0?E:Math.max(C.end,C.time+.025),y:"string",fill:S,stroke:"#ccc",rx:5}),$r(x,{clip:!0,x:"time",y:"string",fill:"black",stroke:"white",text:"fret",textAnchor:"start",dx:2})]});n(0,i.textContent="",i),i.appendChild($),u=requestAnimationFrame(m)};st(()=>{D.enable().then(d).catch(E=>alert(E)),n(3,s=performance.now()),u=requestAnimationFrame(m)}),lt(()=>{for(const E of D.inputs)E.removeListener();cancelAnimationFrame(u)});function p(){o=Yt(this),n(2,o)}function _(){a=_e(this.value),n(1,a)}function w(E){ot[E?"unshift":"push"](()=>{i=E,n(0,i)})}return[i,a,o,s,l,p,_,w,()=>{confirm("Reset played notes?")&&(n(4,l=[]),n(3,s=performance.now()))}]}class f$ extends He{constructor(t){super(),qe(this,t,u$,o$,Ue,{})}}function h$(e){let t,n,r,i,a,o,s,l,c,u,d,f,h=e[2]?"":"",m,p,_,w,g=e[3]?"":"",E,v,x,y,M,A,S,$,C=e[0]>=6?"guitar":"bass guitar",k,B,G=e[1]===0?"in standard tuning":`${Math.abs(e[1])} ${e[1]<0?"steps down":"steps up"}`,T,I,O=e[2]?"and dropped":"",q,z,H,J,Z,F,te,ne,re,Q;return{c(){t=P("main"),n=P("h2"),n.textContent="Guitar Tunings",r=L(),i=P("label"),a=K(`strings
        `),o=P("input"),s=L(),l=P("label"),c=K(`tune up/down (semitones)
        `),u=P("input"),d=L(),f=P("button"),m=K(h),p=K(" dropped"),_=L(),w=P("button"),E=K(g),v=K(" octave shown"),x=L(),y=P("div"),M=P("p"),A=K("You selected a "),S=K(e[0]),$=K(" string "),k=K(C),B=K(", tuned "),T=K(G),I=L(),q=K(O),z=L(),H=P("p"),J=K("Resulting tuning, low to high:"),Z=P("br"),F=L(),te=P("b"),ne=K(e[4]),N(o,"type","number"),N(o,"min","4"),N(o,"max","8"),N(o,"step","1"),N(u,"type","number"),N(u,"min","-12"),N(u,"max","12"),N(u,"step","1")},m(Y,R){oe(Y,t,R),b(t,n),b(t,r),b(t,i),b(i,a),b(i,o),ce(o,e[0]),b(t,s),b(t,l),b(l,c),b(l,u),ce(u,e[1]),b(t,d),b(t,f),b(f,m),b(f,p),b(t,_),b(t,w),b(w,E),b(w,v),b(t,x),b(t,y),b(y,M),b(M,A),b(M,S),b(M,$),b(M,k),b(M,B),b(M,T),b(M,I),b(M,q),b(y,z),b(y,H),b(H,J),b(H,Z),b(H,F),b(H,te),b(te,ne),re||(Q=[X(o,"input",e[5]),X(u,"input",e[6]),X(f,"click",e[7]),X(w,"click",e[8])],re=!0)},p(Y,[R]){R&1&&_e(o.value)!==Y[0]&&ce(o,Y[0]),R&2&&_e(u.value)!==Y[1]&&ce(u,Y[1]),R&4&&h!==(h=Y[2]?"":"")&&Se(m,h),R&8&&g!==(g=Y[3]?"":"")&&Se(E,g),R&1&&Se(S,Y[0]),R&1&&C!==(C=Y[0]>=6?"guitar":"bass guitar")&&Se(k,C),R&2&&G!==(G=Y[1]===0?"in standard tuning":`${Math.abs(Y[1])} ${Y[1]<0?"steps down":"steps up"}`)&&Se(T,G),R&4&&O!==(O=Y[2]?"and dropped":"")&&Se(q,O),R&16&&Se(ne,Y[4])},i:se,o:se,d(Y){Y&&ae(t),re=!1,Fe(Q)}}}function d$(e,t,n){let r,i=6,a=0,o=!1,s=!0;const l=(h,m,p,_)=>{let g=t$.get(h>5?"Guitar":"Bass").get(h)[0].pitches.map(E=>E+m);return p&&(g[0]-=2),_?g=g.map(E=>Ca[E].label):g=g.map(E=>Ca[E].name),g.join(" ")};function c(){i=_e(this.value),n(0,i)}function u(){a=_e(this.value),n(1,a)}const d=()=>{n(2,o=!o)},f=()=>{n(3,s=!s)};return e.$$.update=()=>{e.$$.dirty&15&&n(4,r=l(i,a,o,s))},[i,a,o,s,r,c,u,d,f]}class m$ extends He{constructor(t){super(),qe(this,t,d$,h$,Ue,{})}}function Wm(e,t,n){const r=e.slice();return r[5]=t[n],r}function Xm(e){let t,n,r=e[5].timestamp.toFixed(1)+"",i,a,o,s=e[5].port.manufacturer+"",l,c,u,d=e[5].port.name+"",f,h,m,p=e[5].message.command+"",_,w,g=e[5].message.type+"",E,v,x,y=e[5].message.dataBytes+"",M,A,S,$=(["noteon","noteoff"].includes(e[5].message.type)?bn.fromMidiSharps(e[5].message.dataBytes[0]):"")+"",C,k,B,G=(["noteon","noteoff"].includes(e[5].message.type)?e[5].message.dataBytes[1]:"")+"",T,I;return{c(){t=P("tr"),n=P("td"),i=K(r),a=L(),o=P("td"),l=K(s),c=L(),u=P("td"),f=K(d),h=L(),m=P("td"),_=K(p),w=L(),E=K(g),v=L(),x=P("td"),M=K(y),A=L(),S=P("td"),C=K($),k=L(),B=P("td"),T=K(G),I=L(),N(n,"class","svelte-1x83ix2"),N(o,"class","svelte-1x83ix2"),N(u,"class","svelte-1x83ix2"),N(m,"class","svelte-1x83ix2"),N(x,"class","svelte-1x83ix2"),N(S,"class","svelte-1x83ix2"),N(B,"class","svelte-1x83ix2"),N(t,"class","svelte-1x83ix2")},m(O,q){oe(O,t,q),b(t,n),b(n,i),b(t,a),b(t,o),b(o,l),b(t,c),b(t,u),b(u,f),b(t,h),b(t,m),b(m,_),b(m,w),b(m,E),b(t,v),b(t,x),b(x,M),b(t,A),b(t,S),b(S,C),b(t,k),b(t,B),b(B,T),b(t,I)},p(O,q){q&1&&r!==(r=O[5].timestamp.toFixed(1)+"")&&Se(i,r),q&1&&s!==(s=O[5].port.manufacturer+"")&&Se(l,s),q&1&&d!==(d=O[5].port.name+"")&&Se(f,d),q&1&&p!==(p=O[5].message.command+"")&&Se(_,p),q&1&&g!==(g=O[5].message.type+"")&&Se(E,g),q&1&&y!==(y=O[5].message.dataBytes+"")&&Se(M,y),q&1&&$!==($=(["noteon","noteoff"].includes(O[5].message.type)?bn.fromMidiSharps(O[5].message.dataBytes[0]):"")+"")&&Se(C,$),q&1&&G!==(G=(["noteon","noteoff"].includes(O[5].message.type)?O[5].message.dataBytes[1]:"")+"")&&Se(T,G)},d(O){O&&ae(t)}}}function p$(e){let t,n,r,i,a,o,s,l,c,u,d=e[0].length+"",f,h,m,p,_,w,g,E,v,x=Te(e[0].slice(0,100)),y=[];for(let M=0;M<x.length;M+=1)y[M]=Xm(Wm(e,x,M));return{c(){t=P("main"),n=P("h2"),n.textContent="MIDI Logger",r=L(),i=P("p"),i.textContent="Input anything on a MIDI device to see the incoming messages below.",a=L(),o=P("div"),s=P("button"),s.textContent="reset",l=L(),c=P("div"),u=P("p"),f=K(d),h=K(" messages received"),m=L(),p=P("table"),_=P("thead"),_.innerHTML="<th>timestamp</th> <th>manufacturer</th> <th>name</th> <th>command</th> <th>data</th> <th>note</th> <th>velocity</th>",w=L(),g=P("tbody");for(let M=0;M<y.length;M+=1)y[M].c();N(i,"class","explanation"),N(s,"title","Clear all messages"),N(o,"class","control"),N(p,"class","svelte-1x83ix2"),N(c,"class","visualization"),N(t,"class","demo")},m(M,A){oe(M,t,A),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(t,l),b(t,c),b(c,u),b(u,f),b(u,h),b(c,m),b(c,p),b(p,_),b(p,w),b(p,g);for(let S=0;S<y.length;S+=1)y[S]&&y[S].m(g,null);E||(v=X(s,"click",e[1]),E=!0)},p(M,[A]){if(A&1&&d!==(d=M[0].length+"")&&Se(f,d),A&1){x=Te(M[0].slice(0,100));let S;for(S=0;S<x.length;S+=1){const $=Wm(M,x,S);y[S]?y[S].p($,A):(y[S]=Xm($),y[S].c(),y[S].m(g,null))}for(;S<y.length;S+=1)y[S].d(1);y.length=x.length}},i:se,o:se,d(M){M&&ae(t),tt(y,M),E=!1,v()}}}function b$(e,t,n){let r=[];const i=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((o,s)=>{console.log(`MIDI device ${s}: ${o.name}`),o.addListener("midimessage",l=>{n(0,r=[l,...r]),console.log(l)})}),[...D.inputs])};return st(()=>{D.enable().then(i).catch(o=>alert(o)),performance.now()}),lt(()=>{for(const o of D.inputs)o.removeListener()}),[r,()=>{n(0,r=[])}]}class g$ extends He{constructor(t){super(),qe(this,t,b$,p$,Ue,{})}}function y$(e,t,n){const r=e.slice();return r[16]=t[n],r}function _$(e){let t;return{c(){t=P("option"),t.textContent=`${e[16]}`,t.__value=e[16],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function w$(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E,v,x=Te(["velocity","piano","channel","none"]),y=[];for(let M=0;M<4;M+=1)y[M]=_$(y$(e,x,M));return{c(){t=P("main"),n=P("h2"),n.textContent="Fretboard Heatmap",r=L(),i=P("p"),i.textContent=`The piano roll below shows incoming MIDI notes as rectangles with their
        pitch (y position) and start and end times (x left and right side of the
        rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,a=L(),o=P("div"),s=P("label"),l=K(`color
            `),c=P("select");for(let M=0;M<4;M+=1)y[M].c();u=L(),d=P("label"),f=K(`time
            `),h=P("input"),m=L(),p=P("div"),_=L(),w=P("div"),g=P("button"),g.textContent="reset",N(i,"class","explanation"),e[2]===void 0&&bt(()=>e[5].call(c)),N(h,"type","number"),N(h,"min","10"),N(h,"max","300"),N(h,"step","10"),N(d,"title","time in seconds for past notes to be shown"),N(o,"class","control"),N(p,"class","visualization"),N(g,"title","Clear all played notes"),N(w,"class","control"),N(t,"class","demo")},m(M,A){oe(M,t,A),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c);for(let S=0;S<4;S+=1)y[S]&&y[S].m(c,null);Le(c,e[2],!0),b(o,u),b(o,d),b(d,f),b(d,h),ce(h,e[1]),b(t,m),b(t,p),e[7](p),b(t,_),b(t,w),b(w,g),E||(v=[X(c,"change",e[5]),X(h,"input",e[6]),X(g,"click",e[8])],E=!0)},p(M,[A]){A&4&&Le(c,M[2]),A&2&&_e(h.value)!==M[1]&&ce(h,M[1])},i:se,o:se,d(M){M&&ae(t),tt(y,M),e[7](null),E=!1,Fe(v)}}}let v$=1e3,M$=500;function x$(e,t,n){let r,i=30,a="velocity",o=0,s=[];const l=new Map;let c=null;const u=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((g,E)=>{console.log(`MIDI device ${E}: ${g.name}`),g.addListener("noteon",d),g.addListener("noteoff",f)}),[...D.inputs])},d=g=>{const E=(g.timestamp-o)/1e3,v={number:g.note.number,velocity:g.rawVelocity,time:E,channel:g.message.channel};if(l.has(g.note.number)){const x=l.get(g.note.number);x.end===void 0&&(x.end=E)}s.push(v),l.set(g.note.number,v)},f=g=>{if(l.has(g.note.number)){const E=l.get(g.note.number),v=(g.timestamp-o)/1e3;E.end=v}},h=()=>{const g=(performance.now()-o)/1e3,E=g-i,v=s.filter(S=>S.end>E||S.end===void 0),x=ht(v,S=>S.number);let y,M;a==="velocity"?(y={label:"Note velocity",scheme:"blues",domain:[0,127]},M="velocity"):a==="piano"?(y={label:"Piano key color",domain:["black","white"],range:["black","white"]},M=S=>la(S.number)?"black":"white"):a==="channel"?(y={type:"categorical",label:"MIDI channel",scheme:"tableau10"},M=S=>S.channel):a==="none"&&(M="#ddd");const A=Ke({insetRight:10,width:v$,height:M$,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[E,g]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,domain:we(x[0]-1,x[1]+2),tickFormat:S=>Ca[S].label},color:{...y,legend:a!=="none",marginLeft:100,width:300},marks:[Lt(mg(x[0]-1,x[1]+2)),jt([g],{stroke:"#888"}),Tl(v,{clip:!0,x1:"time",x2:S=>S.end===void 0?g:Math.max(S.end,S.time+.025),y:"number",fill:M,stroke:"#ccc",rx:5})]});n(0,r.textContent="",r),r.appendChild(A),c=requestAnimationFrame(h)};st(()=>{D.enable().then(u).catch(g=>alert(g)),n(3,o=performance.now()),c=requestAnimationFrame(h)}),lt(()=>{for(const g of D.inputs)g.removeListener();cancelAnimationFrame(c)});function m(){a=Yt(this),n(2,a)}function p(){i=_e(this.value),n(1,i)}function _(g){ot[g?"unshift":"push"](()=>{r=g,n(0,r)})}return[r,i,a,o,s,m,p,_,()=>{confirm("Reset played notes?")&&(n(4,s=[]),n(3,o=performance.now()))}]}class E$ extends He{constructor(t){super(),qe(this,t,x$,w$,Ue,{})}}function Km(e,t,n){const r=e.slice();return r[3]=t[n],r}function S$(e){let t,n,r;var i=e[0].component;function a(o,s){return{}}return i&&(n=Wo(i,a())),{c(){t=P("div"),n&&ua(n.$$.fragment)},m(o,s){oe(o,t,s),n&&ii(n,t,null),r=!0},p(o,s){if(s&1&&i!==(i=o[0].component)){if(n){Ba();const l=n;Wt(l.$$.fragment,1,0,()=>{ai(l,1)}),Oa()}i?(n=Wo(i,a()),ua(n.$$.fragment),It(n.$$.fragment,1),ii(n,t,null)):n=null}},i(o){r||(n&&It(n.$$.fragment,o),r=!0)},o(o){n&&Wt(n.$$.fragment,o),r=!1},d(o){o&&ae(t),n&&ai(n)}}}function A$(e){let t,n,r,i=Te(e[1]),a=[];for(let o=0;o<i.length;o+=1)a[o]=Zm(Km(e,i,o));return{c(){t=P("p"),t.textContent="This page contains a collection of simple but useful tools.",n=L(),r=P("div");for(let o=0;o<a.length;o+=1)a[o].c();N(t,"class","explanation"),N(r,"class","grid")},m(o,s){oe(o,t,s),oe(o,n,s),oe(o,r,s);for(let l=0;l<a.length;l+=1)a[l]&&a[l].m(r,null)},p(o,s){if(s&3){i=Te(o[1]);let l;for(l=0;l<i.length;l+=1){const c=Km(o,i,l);a[l]?a[l].p(c,s):(a[l]=Zm(c),a[l].c(),a[l].m(r,null))}for(;l<a.length;l+=1)a[l].d(1);a.length=i.length}},i:se,o:se,d(o){o&&(ae(t),ae(n),ae(r)),tt(a,o)}}}function Zm(e){let t,n,r,i,a,o,s;function l(){return e[2](e[3])}return{c(){t=P("div"),n=P("h2"),n.textContent=`${e[3].title}`,r=L(),i=P("div"),i.textContent=`${e[3].description}`,a=L(),N(i,"class","description"),N(t,"class","card")},m(c,u){oe(c,t,u),b(t,n),b(t,r),b(t,i),b(t,a),o||(s=X(t,"click",l),o=!0)},p(c,u){e=c},d(c){c&&ae(t),o=!1,s()}}}function P$(e){let t,n,r,i;const a=[A$,S$],o=[];function s(l,c){return l[0]?1:0}return n=s(e),r=o[n]=a[n](e),{c(){t=P("main"),r.c()},m(l,c){oe(l,t,c),o[n].m(t,null),i=!0},p(l,[c]){let u=n;n=s(l),n===u?o[n].p(l,c):(Ba(),Wt(o[u],1,1,()=>{o[u]=null}),Oa(),r=o[n],r?r.p(l,c):(r=o[n]=a[n](l),r.c()),It(r,1),r.m(t,null))},i(l){i||(It(r),i=!0)},o(l){Wt(r),i=!1},d(l){l&&ae(t),o[n].d()}}}function N$(e,t,n){let r=[{id:"midi-logger",title:"MIDI Logger",description:"Logs all incoming MIDI messages. Useful for getting to know a device or debugging MIDI issues.",component:g$},{id:"piano-roll",title:"Piano Roll",description:"Shows MIDI input as a piano roll.",component:E$},{id:"guitar-tab",title:"Guitar Tab",description:"Shows MIDI input as guitar tab.",component:f$},{id:"guitar-tunings",title:"Guitar Tunings",description:"Small tool that computes the notes for a guitar tuning based on parameters. Open tunings are not included.",component:m$},{id:"chord-detection",title:"Chord Detection",description:"Play a chord and see what it's named.",component:H9}],i;return[i,r,o=>{n(0,i=o)}]}class C$ extends He{constructor(t){super(),qe(this,t,N$,P$,Ue,{})}}function Jm(e,t){return e==null?t:typeof e=="function"?e:n=>n[e]}function T$(e,t,n,r,i,a){const o=new Float64Array(a),s=(a-1)/(i-r);for(let l=0;l<e.length;++l){const c=e[l],u=t(c,l,e),d=n(c,l,e);if(!(Number.isFinite(u)&&Number.isFinite(d)))continue;const f=(u-r)*s,h=Math.floor(f),m=h+1;0<=h&&m<a?(o[h]+=(m-f)*d,o[m]+=(f-h)*d):h===-1?o[m]+=(f-h)*d:m===a&&(o[h]+=(m-f)*d)}return o}function Qm(e,t=!1){const n=new Float64Array(5),r=new Float64Array(4);$$(n,r,e);const i=Float64Array.of(0,r[1]-n[1]*r[0],r[2]-n[2]*r[0],r[3]-n[3]*r[0],-n[4]*r[0]),a=1+n[1]+n[2]+n[3]+n[4],o=(r[0]+r[1]+r[2]+r[3])/a,s=(i[1]+i[2]+i[3]+i[4])/a;return{sigma:e,negative:t,a:n,b_causal:r,b_anticausal:i,sum_causal:o,sum_anticausal:s}}function $$(e,t,n){const i=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),a=Math.exp(-1.783/n),o=Math.exp(-1.723/n),s=.6318/n,l=1.997/n,c=Float64Array.of(-a*Math.cos(s),a*Math.sin(s),-a*Math.cos(-s),a*Math.sin(-s),-o*Math.cos(l),o*Math.sin(l),-o*Math.cos(-l),o*Math.sin(-l)),u=n*2.5066282746310007,d=Float64Array.of(i[0],i[1],0,0,0,0,0,0),f=Float64Array.of(1,0,c[0],c[1],0,0,0,0,0,0);let h,m;for(m=2;m<8;m+=2){for(d[m]=c[m]*d[m-2]-c[m+1]*d[m-1],d[m+1]=c[m]*d[m-1]+c[m+1]*d[m-2],h=m-2;h>0;h-=2)d[h]+=c[m]*d[h-2]-c[m+1]*d[h-1],d[h+1]+=c[m]*d[h-1]+c[m+1]*d[h-2];for(h=0;h<=m;h+=2)d[h]+=i[m]*f[h]-i[m+1]*f[h+1],d[h+1]+=i[m]*f[h+1]+i[m+1]*f[h];for(f[m+2]=c[m]*f[m]-c[m+1]*f[m+1],f[m+3]=c[m]*f[m+1]+c[m+1]*f[m],h=m;h>0;h-=2)f[h]+=c[m]*f[h-2]-c[m+1]*f[h-1],f[h+1]+=c[m]*f[h-1]+c[m+1]*f[h-2]}for(m=0;m<4;++m)h=m<<1,t[m]=d[h]/u,e[m+1]=f[h+2]}function k$(e,t,n,r=1,i=new Float64Array(n),a=new Float64Array(n),o=new Float64Array(5),s=i,l=I$){const c=r*2,u=r*3,d=r*4,f=r*n;let h,m;for(l(i,t,n,r,e.b_causal,3,e.a,4,e.sum_causal,o,e.sigma),m=4,h=d;m<n;++m,h+=r)i[m]=e.b_causal[0]*t[h]+e.b_causal[1]*t[h-r]+e.b_causal[2]*t[h-c]+e.b_causal[3]*t[h-u]-e.a[1]*i[m-1]-e.a[2]*i[m-2]-e.a[3]*i[m-3]-e.a[4]*i[m-4];for(l(a,t,n,-r,e.b_anticausal,4,e.a,4,e.sum_anticausal,o,e.sigma),m=4,h=f-r*5;m<n;++m,h-=r)a[m]=e.b_anticausal[1]*t[h+r]+e.b_anticausal[2]*t[h+c]+e.b_anticausal[3]*t[h+u]+e.b_anticausal[4]*t[h+d]-e.a[1]*a[m-1]-e.a[2]*a[m-2]-e.a[3]*a[m-3]-e.a[4]*a[m-4];if(e.negative)for(m=0,h=0;m<n;++m,h+=r)s[h]=i[m]+a[n-m-1];else for(m=0,h=0;m<n;++m,h+=r)s[h]=Math.max(0,i[m]+a[n-m-1]);return s}function I$(e,t,n,r,i,a,o,s,l,c,u,d=.5){const f=Math.abs(r)*n,h=r<0?f+r:0;let m,p,_;for(p=0;p<s;++p)for(c[p]=p<=a?i[p]:0,_=1;_<=s&&_<=p;++_)c[p]-=o[_]*c[p-_];for(_=0;_<s;++_)for(e[_]=0,p=1;p<=_;++p)m=h+r*p,m>=0&&m<f&&(e[_]+=c[_-p]*t[m]);const w=t[h],g=Math.ceil(u*10);for(p=0;p<g;++p){for(_=0;_<s;++_)e[_]+=c[_]*w;if(l-=Math.abs(c[0]),l<=d)break;for(c[s]=p+s<=a?i[p+s]:0,_=1;_<=s;++_)c[s]-=o[_]*c[s-_];for(_=0;_<s;++_)c[_]=c[_+1]}}function D$(e,t,n=0){const r=e.length;let i,a;for(let o=0;o<r;++o){const s=t(e[o],o,e);s!=null&&(i===void 0?s>=s&&(i=a=s):(s<i&&(i=s),s>a&&(a=s)))}return[i-n,a+n]}function R$(e,t){const n=e.map(t).filter(c=>c!=null&&c>=c);n.sort((c,u)=>c-u);const r=L$(n),i=e1(n,.25),a=e1(n,.75),o=n.length,s=(a-i)/1.34;return 1.06*(Math.min(r,s)||r||Math.abs(i)||1)*Math.pow(o,-.2)}function L$(e){const t=e.length;let n=0,r,i=0,a=0;for(let o=0;o<t;++o){const s=e[o];r=s-i,i+=r/++n,a+=r*(s-i)}return n>1?Math.sqrt(a/(n-1)):NaN}function e1(e,t){const n=e.length;if(!n)return NaN;if((t=+t)<=0||n<2)return e[0];if(t>=1)return e[n-1];const r=(n-1)*t,i=Math.floor(r),a=e[i];return a+(e[i+1]-a)*(r-i)}function B$(e,t={}){const{adjust:n=1,pad:r=3,bins:i=512}=t,a=Jm(t.x,w=>w),o=Jm(t.weight,()=>1/e.length);let s=t.bandwidth??n*R$(e,a);const[l,c]=t.extent??D$(e,a,r*s),u=T$(e,a,o,l,c,i),d=(c-l)/(i-1),f=u.some(w=>w<0);let h=Qm(s/d,f),m;function*p(w="x",g="y"){const E=_.grid(),v=1/d;for(let x=0;x<i;++x)yield{[w]:l+x*d,[g]:E[x]*v}}const _={[Symbol.iterator]:p,points:p,grid:()=>m||(m=k$(h,u,i)),extent:()=>[l,c],bandwidth(w){return arguments.length?(w!==s&&(s=w,m=null,h=Qm(s/d,f)),_):s}};return _}var Os,Fs,Gs,ti,Da,br,Ra,ni,La,qt,sn,ri;class lh{constructor(){yt(this,Os,.03);yt(this,Fs,.5);yt(this,Gs,200);yt(this,ti,!1);yt(this,Da,null);yt(this,br,null);yt(this,Ra,4);yt(this,ni,1/0);yt(this,La,void 0);yt(this,qt,null);yt(this,sn,new AudioContext);yt(this,ri,null);mo(this,"_scheduler",()=>{const t=Ne(this,Ra),n=60/Ne(this,br);let r=Ne(this,La)+Ne(this,qt)*n;for(;r<Ne(this,sn).currentTime+Ne(this,Fs);)if(Ne(this,qt)<Ne(this,ni)-1){r+=n;const i=Ne(this,qt)%t===t-1||Ne(this,qt)===-1,a=r-Ne(this,sn).currentTime,o=performance.now()+a*1e3;this._playSound(r,o,i),uh(this,qt)._++}Ne(this,qt)<Ne(this,ni)-1?Gt(this,Da,setTimeout(this._scheduler,Ne(this,Gs))):this.stop()})}get bpm(){return Ne(this,br)}get beatCount(){return Ne(this,qt)}onClick(t){Gt(this,ri,t)}start(t,n=4,r=1/0){if(!t||Number.isNaN(+t)){console.error(`[Metronome] Invalid bpm ${t}`);return}if(!n||Number.isNaN(+n)){console.error(`[Metronome] Invalid accent ${n}`);return}if(!r||Number.isNaN(+r)){console.error(`[Metronome] Invalid maxBeeps ${r}`);return}Ne(this,sn).state==="suspended"&&Ne(this,sn).resume(),Gt(this,br,+t),Gt(this,Ra,+n),Gt(this,ni,+r),Gt(this,ti,!0),console.log(`Metronome @ ${t}bpm, accent every ${n}. beat, limited to ${r}`),Gt(this,qt,-1),Gt(this,La,Ne(this,sn).currentTime),this._scheduler()}stop(){console.log("[Metronome] stopped"),clearTimeout(Ne(this,Da)),Gt(this,ti,!1)}toggle(t,n=4){Ne(this,ti)?this.stop():(t===void 0&&(t=Ne(this,br)),this.start(t,n))}_playSound(t,n,r){Ne(this,ri)&&Ne(this,ri).call(this,t,n,r);const i=Ne(this,sn).createOscillator();i.connect(Ne(this,sn).destination);const a=r?300:200;i.frequency.value=a,i.start(t),i.stop(t+Ne(this,Os))}}Os=new WeakMap,Fs=new WeakMap,Gs=new WeakMap,ti=new WeakMap,Da=new WeakMap,br=new WeakMap,Ra=new WeakMap,ni=new WeakMap,La=new WeakMap,qt=new WeakMap,sn=new WeakMap,ri=new WeakMap;function O$(e,t,n){const r=e.slice();return r[28]=t[n],r}function t1(e,t,n){const r=e.slice();return r[28]=t[n],r}function n1(e){let t,n=e[28]+"",r;return{c(){t=P("option"),r=K(n),t.__value=e[28],ce(t,t.__value)},m(i,a){oe(i,t,a),b(t,r)},p:se,d(i){i&&ae(t)}}}function F$(e){let t;return{c(){t=P("option"),t.textContent=`1/${e[28]} note`,t.__value=e[28],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function G$(e){let t,n,r,i,a,o=e[1].length+"",s,l,c,u,d,f,h,m,p,_,w,g,E,v,x,y,M,A,S,$,C,k,B,G,T,I,O,q=e[7]?"area":"bars",z,H,J,Z,F,te,ne,re,Q,Y,R,V,W,U,fe,ue,ie,he=Te(e[9]),le=[];for(let de=0;de<he.length;de+=1)le[de]=n1(t1(e,he,de));let je=Te([16,32,64,128]),Ae=[];for(let de=0;de<4;de+=1)Ae[de]=F$(O$(e,je,de));return{c(){t=P("main"),n=P("h2"),n.textContent="Live-Subdivision",r=L(),i=P("p"),a=K("Connect a MIDI instrument (currently "),s=K(o),l=K(` connected), choose
        your tempo and subdivision, and start playing. The bar chart will show you
        how often you hit each time bin and the last `),c=K(e[6]),u=K(` notes will be
        shown as ticks that fade out one new notes come in (from red for new to blue
        for old). You can play freely, use the integrated metronome, or play a song
        in the background (in another tab). All notes will be timed relative to the
        first one, but you can adjust all notes to make them earlier or later in
        case you messed up the first one.`),d=L(),f=P("div"),h=P("label"),m=K(`tempo
            `),p=P("input"),_=L(),w=P("label"),g=K(`grid
            `),E=P("select");for(let de=0;de<le.length;de+=1)le[de].c();v=L(),x=P("label"),y=K(`binning
            `),M=P("select");for(let de=0;de<4;de+=1)Ae[de].c();A=L(),S=P("label"),$=K(`adjust
            `),C=P("input"),k=L(),B=P("label"),G=K(`note ticks
            `),T=P("input"),I=L(),O=P("button"),z=K(q),H=L(),J=P("div"),Z=P("canvas"),F=L(),te=P("div"),ne=P("button"),ne.textContent="reset",re=L(),Q=P("button"),Q.textContent="export",Y=L(),R=P("button"),R.textContent="import",V=L(),W=P("input"),U=L(),fe=P("button"),fe.textContent="metronome",N(i,"class","explanation"),N(p,"type","number"),N(p,"step","1"),N(p,"min","10"),N(p,"max","400"),_t(p,"width","55px"),N(h,"title","The tempo in beats per minute (bpm)"),e[3]===void 0&&bt(()=>e[15].call(E)),N(w,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[4]===void 0&&bt(()=>e[16].call(M)),N(x,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),N(C,"type","number"),N(C,"step","0.01"),N(C,"min","-2"),N(C,"max","2"),_t(C,"width","55px"),N(S,"title","Shift all notes by an amount in seconds"),N(T,"type","number"),N(T,"step","1"),N(T,"min","0"),N(T,"max","100"),_t(T,"width","55px"),N(B,"title","The number of most recent notes that are shown as ticks."),N(O,"title","Toggle between bars and area"),N(f,"class","control"),_t(Z,"width",Qi+"px"),_t(Z,"height",Fu+"px"),N(J,"class","visualization"),N(ne,"title","Clear all played notes"),N(Q,"title","Export all data and settings"),N(R,"title","Export all data and settings"),N(W,"type","file"),N(W,"id","file-input"),_t(W,"display","none"),N(fe,"title","Toggle metronome (click)"),N(te,"class","control"),N(t,"class","demo")},m(de,ke){oe(de,t,ke),b(t,n),b(t,r),b(t,i),b(i,a),b(i,s),b(i,l),b(i,c),b(i,u),b(t,d),b(t,f),b(f,h),b(h,m),b(h,p),ce(p,e[2]),b(f,_),b(f,w),b(w,g),b(w,E);for(let xe=0;xe<le.length;xe+=1)le[xe]&&le[xe].m(E,null);Le(E,e[3],!0),b(f,v),b(f,x),b(x,y),b(x,M);for(let xe=0;xe<4;xe+=1)Ae[xe]&&Ae[xe].m(M,null);Le(M,e[4],!0),b(f,A),b(f,S),b(S,$),b(S,C),ce(C,e[5]),b(f,k),b(f,B),b(B,G),b(B,T),ce(T,e[6]),b(f,I),b(f,O),b(O,z),b(t,H),b(t,J),b(J,Z),e[20](Z),b(t,F),b(t,te),b(te,ne),b(te,re),b(te,Q),b(te,Y),b(te,R),b(te,V),b(te,W),b(te,U),b(te,fe),ue||(ie=[X(p,"input",e[14]),X(p,"change",e[11]),X(E,"change",e[15]),X(E,"change",e[11]),X(M,"change",e[16]),X(M,"change",e[11]),X(C,"input",e[17]),X(C,"change",e[11]),X(T,"input",e[18]),X(T,"change",e[11]),X(O,"click",e[19]),X(ne,"click",e[21]),X(Q,"click",e[12]),X(R,"click",e[22]),X(W,"input",e[13]),X(fe,"click",e[23])],ue=!0)},p(de,ke){if(ke[0]&2&&o!==(o=de[1].length+"")&&Se(s,o),ke[0]&64&&Se(c,de[6]),ke[0]&4&&_e(p.value)!==de[2]&&ce(p,de[2]),ke[0]&512){he=Te(de[9]);let xe;for(xe=0;xe<he.length;xe+=1){const an=t1(de,he,xe);le[xe]?le[xe].p(an,ke):(le[xe]=n1(an),le[xe].c(),le[xe].m(E,null))}for(;xe<le.length;xe+=1)le[xe].d(1);le.length=he.length}ke[0]&520&&Le(E,de[3]),ke[0]&16&&Le(M,de[4]),ke[0]&32&&_e(C.value)!==de[5]&&ce(C,de[5]),ke[0]&64&&_e(T.value)!==de[6]&&ce(T,de[6]),ke[0]&128&&q!==(q=de[7]?"area":"bars")&&Se(z,q)},i:se,o:se,d(de){de&&ae(t),tt(le,de),tt(Ae,de),e[20](null),ue=!1,Fe(ie)}}}let Qi=1e3,Fu=1e3;function U$(e,t,n){const r=["4:2","4:3","4:4","4:5","3:2","3:3","3:4","3:5"],i=Math.PI*2;let a,o=new lh,s=[],l=120,c=r[0],u=64,d=0,f=1,h=!1,m=0,p=[];const _=()=>{n(1,s=[]),D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((T,I)=>{console.log(`MIDI device ${I}: ${T.name}`),T.addListener("noteon",w)}),n(1,s=[...D.inputs]))},w=T=>{p.length===0&&(m=T.timestamp);const I=(T.timestamp-m)/1e3;p.push(I),g()},g=()=>{const T=Qi/2,I=Fu/2,O=Qi*.4,q=O*.8,z=O*.9,H=O*1.1,J=O*.95,Z=Math.PI/2,F=a.getContext("2d"),te=window.devicePixelRatio,ne=a.getBoundingClientRect();n(0,a.width=ne.width*te,a),n(0,a.height=ne.height*te,a),F.scale(te,te),n(0,a.style.width=`${ne.width}px`,a),n(0,a.style.height=`${ne.height}px`,a),F.clearRect(0,0,Qi,Fu);const[re,Q]=c.split(":").map(ie=>+ie),Y=Xn(l)*re,R=p.map(ie=>ie+d),W=R.map(ie=>ie%Y).map(ie=>ie/Y*i),U=Qi*.08;if(!h){F.fillStyle="#f8f8f8",F.strokeStyle="#aaa";const ie=u*re/4,le=uw().domain([0,i]).thresholds(we(ie).map(Ae=>Ae/ie*i))(W),je=Ge(le,Ae=>Ae.length);for(const Ae of le){if(Ae.length===0)continue;const de=Ae.length/je*U,ke=O+de,xe=Ae.x0-Z,an=Math.cos(xe),Ft=Math.sin(xe),ur=Ae.x1-Z,En=Math.cos(ur),ye=Math.sin(ur);F.beginPath(),F.moveTo(T+an*O,I+Ft*O),F.lineTo(T+an*ke,I+Ft*ke),F.arc(T,I,ke,xe,ur),F.lineTo(T+En*O,I+ye*O),F.closePath(),F.fill(),F.stroke()}}if(h&&W.length>0){let ie=4/u;const Ae=B$(W,{bandwidth:ie,pad:.1,bins:360}).bandwidth(ie),de=Ge([...Ae],xe=>xe.y);console.log([...Ae]),F.beginPath();let ke=0;for(const xe of Ae){console.log(ke++,xe);const an=xe.x-Z,Ft=O+xe.y/de*U,ur=Math.cos(an),En=Math.sin(an);F.lineTo(T+ur*Ft,I+En*Ft)}F.closePath(),F.fillStyle="#e4f0fa",F.fill(),F.strokeStyle="#aaa",F.stroke()}if(f>0){F.lineWidth=3;const ie=le=>va(1-le),he=R.slice(-f);for(const[le,je]of he.entries()){const Ae=je/Y*i-Z,de=Math.cos(Ae),ke=Math.sin(Ae);F.strokeStyle=ie(le/he.length),F.beginPath(),F.moveTo(T+de*O,I+ke*O),F.lineTo(T+de*H,I+ke*H),F.stroke()}}F.strokeStyle="#aaa",F.fillStyle="white",e$(F,T,I,O),F.lineWidth=2,F.fill(),F.stroke();const fe=we(re).map(ie=>i/re*ie-Z),ue=we(re*Q).map(ie=>i/(re*Q)*ie-Z);F.beginPath(),F.lineWidth=2;for(const ie of fe){const he=Math.cos(ie),le=Math.sin(ie);F.moveTo(T+he*q,I+le*q),F.lineTo(T+he*J,I+le*J)}F.stroke(),F.lineWidth=1,F.beginPath();for(const ie of ue){const he=Math.cos(ie),le=Math.sin(ie);F.moveTo(T+he*z,I+le*z),F.lineTo(T+he*J,I+le*J)}F.stroke()},E=()=>{const I=JSON.stringify({tempo:l,grid:c,binNote:u,adjustTime:d,noteTickLimit:f,noteOnTimes:p,showKde:h},void 0,2),O=new Blob([I],{type:"text/plain;charset=utf-8"});Pi(O,"live-subdivision.json")},v=async T=>{const O=await T.target.files[0].text(),q=JSON.parse(O);(p.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(n(2,l=q.tempo),n(3,c=q.grid),n(4,u=q.binNote),n(5,d=q.adjustTime),n(6,f=q.noteTickLimit),n(8,p=q.noteOnTimes),n(7,h=q.showKde??!1),g())};st(()=>{D.enable().then(_).catch(T=>alert(T)),g()}),lt(()=>{o.stop();for(const T of D.inputs)T.removeListener()});function x(){l=_e(this.value),n(2,l)}function y(){c=Yt(this),n(3,c),n(9,r)}function M(){u=Yt(this),n(4,u)}function A(){d=_e(this.value),n(5,d)}function S(){f=_e(this.value),n(6,f)}const $=()=>{n(7,h=!h),g()};function C(T){ot[T?"unshift":"push"](()=>{a=T,n(0,a)})}return[a,s,l,c,u,d,f,h,p,r,o,g,E,v,x,y,M,A,S,$,C,()=>{confirm("Reset played notes?")&&(n(8,p=[]),g())},()=>document.querySelector("#file-input").click(),()=>{o.toggle(l,+c.split(":")[0])}]}class q$ extends He{constructor(t){super(),qe(this,t,U$,G$,Ue,{},null,[-1,-1])}}function H$(e,t,n){const r=e.slice();return r[21]=t[n],r}function z$(e,t,n){const r=e.slice();return r[21]=t[n],r}function V$(e){let t;return{c(){t=P("option"),t.textContent=`1/${e[21]} note`,t.__value=e[21],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function j$(e){let t;return{c(){t=P("option"),t.textContent=`1/${e[21]} note`,t.__value=e[21],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function r1(e){let t,n,r=e[7].toFixed(1)+"",i,a;return{c(){t=P("div"),n=K("estimated: "),i=K(r),a=K(" bpm"),N(t,"class","svelte-1ruiyqw")},m(o,s){oe(o,t,s),b(t,n),b(t,i),b(t,a)},p(o,s){s&128&&r!==(r=o[7].toFixed(1)+"")&&Se(i,r)},d(o){o&&ae(t)}}}function Y$(e){let t,n,r,i,a,o=e[1].length+"",s,l,c,u,d,f,h,m,p,_,w,g,E,v,x,y,M,A,S,$,C,k,B,G,T,I,O,q,z,H,J,Z,F,te,ne,re=Te([16,32,64,128]),Q=[];for(let W=0;W<4;W+=1)Q[W]=V$(z$(e,re,W));let Y=Te([16,32,64,128]),R=[];for(let W=0;W<4;W+=1)R[W]=j$(H$(e,Y,W));let V=e[7]&&r1(e);return{c(){t=P("main"),n=P("h2"),n.textContent="Tempo Drift",r=L(),i=P("p"),a=K("Connect a MIDI instrument (currently "),s=K(o),l=K(` connected), choose
        your tempo, and start playing. The time between two note onsets will be shown
        as a bar, so you can see how well you still hit, for example, quarter notes
        after playing for some time. Bar heights are either exact or rounded to the
        closest, for example, 64th note (binning dropdown). You can filter very short
        inter-note times, which happen whan playing two notes at roughly the same
        time as in a chord.`),c=L(),u=P("div"),d=P("label"),f=K(`tempo
            `),h=P("input"),m=L(),p=P("label"),_=K(`binning
            `),w=P("select"),g=P("option"),g.textContent="off";for(let W=0;W<4;W+=1)Q[W].c();E=L(),v=P("label"),x=K(`filtering
            `),y=P("select"),M=P("option"),M.textContent="off";for(let W=0;W<4;W+=1)R[W].c();A=L(),S=P("label"),$=K(`bars
            `),C=P("input"),k=L(),B=P("div"),G=L(),V&&V.c(),T=L(),I=P("div"),O=P("button"),O.textContent="reset",q=L(),z=P("button"),z.textContent="export",H=L(),J=P("button"),J.textContent="import",Z=L(),F=P("input"),N(i,"class","explanation"),N(h,"type","number"),N(h,"step","1"),N(h,"min","10"),N(h,"max","400"),_t(h,"width","55px"),N(d,"title","The tempo in beats per minute (bpm)"),g.__value=0,ce(g,g.__value),e[3]===void 0&&bt(()=>e[12].call(w)),N(p,"title","You can change between seeing exact bar heights and binned (rounded) heights."),M.__value=0,ce(M,M.__value),e[4]===void 0&&bt(()=>e[13].call(y)),N(v,"title","You can filter out bars that are shorter than a given note duration."),N(C,"type","number"),N(C,"step","25"),N(C,"min","25"),N(C,"max","1000"),_t(C,"width","55px"),N(S,"title","The number of most recent notes that are shown as bars."),N(u,"class","control svelte-1ruiyqw"),N(B,"class","visualization svelte-1ruiyqw"),N(O,"title","Clear all played notes"),N(z,"title","Export all data and settings"),N(J,"title","Export all data and settings"),N(F,"type","file"),N(F,"id","file-input"),_t(F,"display","none"),N(I,"class","control svelte-1ruiyqw"),N(t,"class","demo")},m(W,U){oe(W,t,U),b(t,n),b(t,r),b(t,i),b(i,a),b(i,s),b(i,l),b(t,c),b(t,u),b(u,d),b(d,f),b(d,h),ce(h,e[2]),b(u,m),b(u,p),b(p,_),b(p,w),b(w,g);for(let fe=0;fe<4;fe+=1)Q[fe]&&Q[fe].m(w,null);Le(w,e[3],!0),b(u,E),b(u,v),b(v,x),b(v,y),b(y,M);for(let fe=0;fe<4;fe+=1)R[fe]&&R[fe].m(y,null);Le(y,e[4],!0),b(u,A),b(u,S),b(S,$),b(S,C),ce(C,e[5]),b(t,k),b(t,B),e[15](B),b(t,G),V&&V.m(t,null),b(t,T),b(t,I),b(I,O),b(I,q),b(I,z),b(I,H),b(I,J),b(I,Z),b(I,F),te||(ne=[X(h,"input",e[11]),X(h,"change",e[8]),X(w,"change",e[12]),X(w,"change",e[8]),X(y,"change",e[13]),X(y,"change",e[8]),X(C,"input",e[14]),X(C,"change",e[8]),X(O,"click",e[16]),X(z,"click",e[9]),X(J,"click",e[17]),X(F,"input",e[10])],te=!0)},p(W,[U]){U&2&&o!==(o=W[1].length+"")&&Se(s,o),U&4&&_e(h.value)!==W[2]&&ce(h,W[2]),U&8&&Le(w,W[3]),U&16&&Le(y,W[4]),U&32&&_e(C.value)!==W[5]&&ce(C,W[5]),W[7]?V?V.p(W,U):(V=r1(W),V.c(),V.m(t,T)):V&&(V.d(1),V=null)},i:se,o:se,d(W){W&&ae(t),tt(Q,W),tt(R,W),e[15](null),V&&V.d(),te=!1,Fe(ne)}}}let W$=1e3,X$=600;function K$(e,t,n){let r,i=[],a=120,o=64,s=0,l=50,c=0,u=[],d=0;const f=()=>{n(1,i=[]),D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((A,S)=>{console.log(`MIDI device ${S}: ${A.name}`),A.addListener("noteon",h)}),n(1,i=[...D.inputs]))},h=A=>{u.length===0&&(c=A.timestamp);const S=(A.timestamp-c)/1e3;u.push(S),m()},m=()=>{const A=Xn(a),S=A/4,$=A/2,C=A*2,k=A*4,B=[0,S,$,A,C],G=["0","","","",""];let T=u.map((z,H)=>H===0?0:z-u[H-1]);if(s!==0){const z=k/s;T=T.filter(H=>H>=z)}let I=T;if(o!==0){const z=k/o;I=T.map(H=>Math.round(H/z)*z)}const O=Ke({width:W$,height:X$,marginLeft:35,marginRight:1,x:{axis:!1},y:{ticks:B,tickFormat:z=>{const H=B.indexOf(z);return G[H]},domain:[0,C*1.1],tickSize:0},marks:[Na(I.slice(-l),{x:(z,H)=>H,y:z=>z,fill:"#ddd",inset:0,dx:.5}),Lt(B,{stroke:"#888"})]});n(0,r.textContent="",r),r.appendChild(O);const q=T.filter(z=>z>.8*S&&z<1.25*A).slice(-24).map(z=>z<.6*A?z*2:z>1.5*A?z/2:z);n(7,d=pM(G1(q)))},p=()=>{const S=JSON.stringify({tempo:a,binNote:o,filterNote:s,barLimit:l,noteOnTimes:u},void 0,2),$=new Blob([S],{type:"text/plain;charset=utf-8"});Pi($,"tempo-drift.json")},_=async A=>{const $=await A.target.files[0].text(),C=JSON.parse($);(u.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(n(2,a=C.tempo),n(3,o=C.binNote),n(4,s=C.filterNote),n(5,l=C.barLimit),n(6,u=C.noteOnTimes),m())};st(()=>{D.enable().then(f).catch(A=>alert(A)),m()}),lt(()=>{for(const A of D.inputs)A.removeListener()});function w(){a=_e(this.value),n(2,a)}function g(){o=Yt(this),n(3,o)}function E(){s=Yt(this),n(4,s)}function v(){l=_e(this.value),n(5,l)}function x(A){ot[A?"unshift":"push"](()=>{r=A,n(0,r)})}return[r,i,a,o,s,l,u,d,m,p,_,w,g,E,v,x,()=>{confirm("Reset played notes?")&&(n(6,u=[]),m())},()=>document.querySelector("#file-input").click()]}class Z$ extends He{constructor(t){super(),qe(this,t,K$,Y$,Ue,{})}}function J$(e){let t,n,r,i,a,o=e[1].length+"",s,l,c,u,d,f,h,m,p=e[2]?"on":"off",_,w,g,E,v,x,y,M,A,S,$,C,k,B,G,T,I,O;return{c(){t=P("main"),n=P("h2"),n.textContent="Dynamics",r=L(),i=P("p"),a=K("Connect a MIDI instrument (currently "),s=K(o),l=K(` connected) and
        start playing. The loudness of each note will be shown as a bar. Bar heights
        are either exact or rounded to the
        `),c=P("a"),c.textContent="closest rough dynamics",u=K(", for example a forte."),d=L(),f=P("div"),h=P("button"),m=K("binning is "),_=K(p),w=L(),g=P("label"),E=K(`bars
            `),v=P("input"),x=L(),y=P("div"),M=L(),A=P("div"),S=P("button"),S.textContent="reset",$=L(),C=P("button"),C.textContent="export",k=L(),B=P("button"),B.textContent="import",G=L(),T=P("input"),N(c,"href","https://en.wikipedia.org/wiki/Dynamics_(music)"),N(i,"class","explanation"),N(h,"title","You can change between seeing exact bar heights and binned (rounded) heights."),N(v,"type","number"),N(v,"step","25"),N(v,"min","25"),N(v,"max","1000"),_t(v,"width","55px"),N(g,"title","The number of most recent notes that are shown as bars."),N(f,"class","control svelte-1p166uy"),N(y,"class","visualization svelte-1p166uy"),N(S,"title","Clear all played notes"),N(C,"title","Export all data and settings"),N(B,"title","Export all data and settings"),N(T,"type","file"),N(T,"id","file-input"),_t(T,"display","none"),N(A,"class","control svelte-1p166uy"),N(t,"class","demo")},m(q,z){oe(q,t,z),b(t,n),b(t,r),b(t,i),b(i,a),b(i,s),b(i,l),b(i,c),b(i,u),b(t,d),b(t,f),b(f,h),b(h,m),b(h,_),b(f,w),b(f,g),b(g,E),b(g,v),ce(v,e[3]),b(t,x),b(t,y),e[10](y),b(t,M),b(t,A),b(A,S),b(A,$),b(A,C),b(A,k),b(A,B),b(A,G),b(A,T),I||(O=[X(h,"click",e[8]),X(v,"input",e[9]),X(v,"change",e[5]),X(S,"click",e[11]),X(C,"click",e[6]),X(B,"click",e[12]),X(T,"input",e[7])],I=!0)},p(q,[z]){z&2&&o!==(o=q[1].length+"")&&Se(s,o),z&4&&p!==(p=q[2]?"on":"off")&&Se(_,p),z&8&&_e(v.value)!==q[3]&&ce(v,q[3])},i:se,o:se,d(q){q&&ae(t),e[10](null),I=!1,Fe(O)}}}let Q$=1e3,ek=600;function tk(e,t,n){let r,i=[];const o=new Map([[0,"silent"],[16,"ppp"],[32,"pp"],[48,"p"],[64,"mp"],[80,"mf"],[96,"f"],[112,"ff"],[127,"fff"]]);let s=!0,l=50,c=[];const u=()=>{console.log("MIDI enabled"),n(1,i=[]),D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((v,x)=>{console.log(`MIDI device ${x}: ${v.name}`),v.addListener("noteon",d)}),n(1,i=[...D.inputs]))},d=v=>{c.push(v.rawVelocity),f()},f=()=>{console.log("draw");let v=c;s&&(v=c.map(M=>{for(const A of o.keys())if(M<=A)return A}));const x=[...o.keys()],y=Ke({width:Q$,height:ek,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:x,tickFormat:M=>o.get(M),domain:[0,128],tickSize:0},marks:[Na(v.slice(-l),{x:(M,A)=>A,y:M=>M,fill:"#ddd",inset:0,dx:.5}),Lt(x,{stroke:"#888"})]});n(0,r.textContent="",r),r.appendChild(y)},h=()=>{const x=JSON.stringify({isBinning:s,barLimit:l,noteVelocities:c},void 0,2),y=new Blob([x],{type:"text/plain;charset=utf-8"});Pi(y,"tempo-drift.json")},m=async v=>{const y=await v.target.files[0].text(),M=JSON.parse(y);(c.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(n(2,s=M.isBinning),n(3,l=M.barLimit),n(4,c=M.noteVelocities),f())};st(()=>{D.enable().then(u).catch(v=>alert(v)),f()}),lt(()=>{for(const v of D.inputs)v.removeListener()});const p=()=>{n(2,s=!s),f()};function _(){l=_e(this.value),n(3,l)}function w(v){ot[v?"unshift":"push"](()=>{r=v,n(0,r)})}return[r,i,s,l,c,f,h,m,p,_,w,()=>{confirm("Reset played notes?")&&(n(4,c=[]),f())},()=>document.querySelector("#file-input").click()]}class nk extends He{constructor(t){super(),qe(this,t,tk,J$,Ue,{})}}function rk(e){let t,n,r,i,a,o=e[1].length+"",s,l,c,u,d,f,h=e[2]?"hidden":"shown",m,p,_,w,g=e[3]?"on":"off",E,v,x,y,M=e[4]?"on":"off",A,S,$,C,k,B,G,T,I,O,q,z,H,J;return{c(){t=P("main"),n=P("h2"),n.textContent="Improvisation Intervals",r=L(),i=P("p"),a=K("Connect a MIDI instrument (currently "),s=K(o),l=K(` connected) and
        start playing. The bar chart below shows how often you played each interval:
        when you go up in pitch, the bar of the played interval in the top half will
        increase. If you go down, it will show up in the bottom half. Colors denote
        the type of interval, so you can quickly see if you play, for example, more
        major or minor intervals.`),c=L(),u=P("div"),d=P("button"),f=K("unison "),m=K(h),p=L(),_=P("button"),w=K("colors "),E=K(g),v=L(),x=P("button"),y=K("semitones "),A=K(M),S=L(),$=P("div"),C=L(),k=P("div"),B=P("button"),B.textContent="reset",G=L(),T=P("button"),T.textContent="export",I=L(),O=P("button"),O.textContent="import",q=L(),z=P("input"),N(i,"class","explanation"),N(d,"title","Toggle filtering unison intervals"),N(_,"title","Use colors for interval types"),N(x,"title","Show number of semitones instead of musical names for intervals on the y axis"),N(u,"class","control svelte-13613lz"),N($,"class","visualization svelte-13613lz"),N(B,"title","Clear all played notes"),N(T,"title","Export all data and settings"),N(O,"title","Export all data and settings"),N(z,"type","file"),N(z,"id","file-input"),_t(z,"display","none"),N(k,"class","control svelte-13613lz"),N(t,"class","demo")},m(Z,F){oe(Z,t,F),b(t,n),b(t,r),b(t,i),b(i,a),b(i,s),b(i,l),b(t,c),b(t,u),b(u,d),b(d,f),b(d,m),b(u,p),b(u,_),b(_,w),b(_,E),b(u,v),b(u,x),b(x,y),b(x,A),b(t,S),b(t,$),e[12]($),b(t,C),b(t,k),b(k,B),b(k,G),b(k,T),b(k,I),b(k,O),b(k,q),b(k,z),H||(J=[X(d,"click",e[9]),X(_,"click",e[10]),X(x,"click",e[11]),X(B,"click",e[13]),X(T,"click",e[7]),X(O,"click",e[14]),X(z,"input",e[8])],H=!0)},p(Z,[F]){F&2&&o!==(o=Z[1].length+"")&&Se(s,o),F&4&&h!==(h=Z[2]?"hidden":"shown")&&Se(m,h),F&8&&g!==(g=Z[3]?"on":"off")&&Se(E,g),F&16&&M!==(M=Z[4]?"on":"off")&&Se(A,M)},i:se,o:se,d(Z){Z&&ae(t),e[12](null),H=!1,Fe(J)}}}let ik=1e3,ak=650;function ok(e,t,n){let r,i=[],a=!0,o=!1,s=!1,l=[];const c=[{semitones:0,name:"Unison",short:"P1",type:"perfect"},{semitones:1,name:"Minor 2nd",short:"m2",type:"minor"},{semitones:2,name:"Major 2nd",short:"M2",type:"major"},{semitones:3,name:"Minor 3rd",short:"m3",type:"minor"},{semitones:4,name:"Major 3rd",short:"M3",type:"major"},{semitones:5,name:"Perfect 4th",short:"P4",type:"perfect"},{semitones:6,name:"Augmented 4th",short:"A4",type:"tritone"},{semitones:7,name:"Perfect 5th",short:"P5",type:"perfect"},{semitones:8,name:"Minor 6th",short:"m6",type:"minor"},{semitones:9,name:"Major 6th",short:"M6",type:"major"},{semitones:10,name:"Minor 7th",short:"m7",type:"minor"},{semitones:11,name:"Major 7th",short:"M7",type:"major"},{semitones:12,name:"Perfect 8ve",short:"P8",type:"perfect"}],u=()=>{n(1,i=[]),D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((x,y)=>{console.log(`MIDI device ${y}: ${x.name}`),x.addListener("noteon",d)}),n(1,i=[...D.inputs]))},d=x=>{const y={number:x.note.number,velocity:x.rawVelocity,time:x.timestamp};l.push(y),f()},f=()=>{let x=l.map((A,S)=>S===0?0:A.number-l[S-1].number);a&&(x=x.filter(A=>A!==0)),x=x.map(A=>{if(Math.abs(A)<=12)return A;{const S=A>0?12:-12;for(;Math.abs(A)>12;)A-=S;return A}});const y=qu(x,A=>A).map(([A,S])=>({interval:A,count:S.length})),M=Ke({width:ik,height:ak,marginLeft:120,marginRight:10,color:{legend:o,domain:["minor","major","perfect","tritone"],range:["#7da2e8","#ed796a","gold","#ccc"]},x:{},y:{tickFormat:s?A=>A:A=>A>=0?c[A].name:c[-A].name,domain:we(-12,13,1),label:` going down ${" ".repeat(75)} going up      `,reverse:!0},marks:[Lt([-12,0,12],{stroke:"#888",strokeWidth:1.5}),Tl(y,{x:"count",y:"interval",fill:o?A=>c[Math.abs(A.interval)].type:"#ddd",dx:.5,rx:4})]});n(0,r.textContent="",r),r.appendChild(M)},h=()=>{const y=JSON.stringify({filterUnison:a,useColors:o,useSemitones:s,notes:l},void 0,2),M=new Blob([y],{type:"text/plain;charset=utf-8"});Pi(M,"tempo-drift.json")},m=async x=>{const M=await x.target.files[0].text(),A=JSON.parse(M);(l.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(n(2,a=A.filterUnison),n(3,o=A.useColors),n(4,s=A.useSemitones),n(5,l=A.notes),f())};st(()=>{D.enable().then(u).catch(x=>alert(x)),f()}),lt(()=>{for(const x of D.inputs)x.removeListener()});const p=()=>{n(2,a=!a),f()},_=()=>{n(3,o=!o),f()},w=()=>{n(4,s=!s),f()};function g(x){ot[x?"unshift":"push"](()=>{r=x,n(0,r)})}return[r,i,a,o,s,l,f,h,m,p,_,w,g,()=>{confirm("Reset played notes?")&&(n(5,l=[]),f())},()=>document.querySelector("#file-input").click()]}class sk extends He{constructor(t){super(),qe(this,t,ok,rk,Ue,{})}}function i1(e,t,n){const r=e.slice();return r[21]=t[n],r}function a1(e,t,n){const r=e.slice();return r[24]=t[n],r}function o1(e){let t,n=e[24]+"",r;return{c(){t=P("option"),r=K(n),t.__value=e[24],ce(t,t.__value)},m(i,a){oe(i,t,a),b(t,r)},p:se,d(i){i&&ae(t)}}}function s1(e){let t,n=e[21]+"",r;return{c(){t=P("option"),r=K(n),t.__value=e[21],ce(t,t.__value)},m(i,a){oe(i,t,a),b(t,r)},p:se,d(i){i&&ae(t)}}}function lk(e){let t,n,r,i,a,o=e[1].length+"",s,l,c,u,d,f,h,m,p,_,w,g,E,v=e[4]?"on":"off",x,y,M,A,S=e[5]?"shown":"hidden",$,C,k,B,G,T,I,O,q,z,H,J,Z,F,te=Te(e[7]),ne=[];for(let Y=0;Y<te.length;Y+=1)ne[Y]=o1(a1(e,te,Y));let re=Te(e[8]),Q=[];for(let Y=0;Y<re.length;Y+=1)Q[Y]=s1(i1(e,re,Y));return{c(){t=P("main"),n=P("h2"),n.textContent="Improvisation Intervals",r=L(),i=P("p"),a=K("Connect a MIDI instrument (currently "),s=K(o),l=K(` connected) and
        start playing. The bar chart below shows how often you played each scale
        degree.`),c=L(),u=P("div"),d=P("label"),f=K(`scale
            `),h=P("select");for(let Y=0;Y<ne.length;Y+=1)ne[Y].c();m=L(),p=P("select");for(let Y=0;Y<Q.length;Y+=1)Q[Y].c();_=L(),w=P("div"),g=P("button"),E=K("colors "),x=K(v),y=L(),M=P("button"),A=K("non-scale notes "),$=K(S),C=L(),k=P("div"),B=L(),G=P("div"),T=P("button"),T.textContent="reset",I=L(),O=P("button"),O.textContent="export",q=L(),z=P("button"),z.textContent="import",H=L(),J=P("input"),N(i,"class","explanation"),e[2]===void 0&&bt(()=>e[12].call(h)),e[3]===void 0&&bt(()=>e[13].call(p)),N(u,"class","control svelte-13613lz"),N(g,"title","Use colors for root, in-scale, outside-scale"),N(M,"title","Show notes outside the scale"),N(w,"class","control svelte-13613lz"),N(k,"class","visualization svelte-13613lz"),N(T,"title","Clear all played notes"),N(O,"title","Export all data and settings"),N(z,"title","Export all data and settings"),N(J,"type","file"),N(J,"id","file-input"),_t(J,"display","none"),N(G,"class","control svelte-13613lz"),N(t,"class","demo")},m(Y,R){oe(Y,t,R),b(t,n),b(t,r),b(t,i),b(i,a),b(i,s),b(i,l),b(t,c),b(t,u),b(u,d),b(d,f),b(d,h);for(let V=0;V<ne.length;V+=1)ne[V]&&ne[V].m(h,null);Le(h,e[2],!0),b(d,m),b(d,p);for(let V=0;V<Q.length;V+=1)Q[V]&&Q[V].m(p,null);Le(p,e[3],!0),b(t,_),b(t,w),b(w,g),b(g,E),b(g,x),b(w,y),b(w,M),b(M,A),b(M,$),b(t,C),b(t,k),e[16](k),b(t,B),b(t,G),b(G,T),b(G,I),b(G,O),b(G,q),b(G,z),b(G,H),b(G,J),Z||(F=[X(h,"change",e[12]),X(h,"change",e[9]),X(p,"change",e[13]),X(p,"change",e[9]),X(g,"click",e[14]),X(M,"click",e[15]),X(T,"click",e[17]),X(O,"click",e[10]),X(z,"click",e[18]),X(J,"input",e[11])],Z=!0)},p(Y,[R]){if(R&2&&o!==(o=Y[1].length+"")&&Se(s,o),R&128){te=Te(Y[7]);let V;for(V=0;V<te.length;V+=1){const W=a1(Y,te,V);ne[V]?ne[V].p(W,R):(ne[V]=o1(W),ne[V].c(),ne[V].m(h,null))}for(;V<ne.length;V+=1)ne[V].d(1);ne.length=te.length}if(R&132&&Le(h,Y[2]),R&256){re=Te(Y[8]);let V;for(V=0;V<re.length;V+=1){const W=i1(Y,re,V);Q[V]?Q[V].p(W,R):(Q[V]=s1(W),Q[V].c(),Q[V].m(p,null))}for(;V<Q.length;V+=1)Q[V].d(1);Q.length=re.length}R&264&&Le(p,Y[3]),R&16&&v!==(v=Y[4]?"on":"off")&&Se(x,v),R&32&&S!==(S=Y[5]?"shown":"hidden")&&Se($,S)},i:se,o:se,d(Y){Y&&ae(t),tt(ne,Y),tt(Q,Y),e[16](null),Z=!1,Fe(F)}}}let ck=1e3,uk=650;function fk(e,t,n){let r,i=[],a="A",o="minor pentatonic",s=!0,l=!0,c=[];const u=i_,d=gu.names(),f=()=>{n(1,i=[]),D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((A,S)=>{console.log(`MIDI device ${S}: ${A.name}`),A.addListener("noteon",h)}),n(1,i=[...D.inputs]))},h=A=>{const S={number:A.note.number,velocity:A.rawVelocity,time:A.timestamp};c.push(S),m()},m=()=>{const A=u.indexOf(a),S=gu.get(`${a} ${o}`),$=S.notes.map((I,O)=>{const q=u.indexOf(I);let z=q-A;return z=z>=0?z:z+12,{name:I,chroma:q,interval:S.intervals[O],degree:O,offset:z}}),C=new Set($.map(I=>I.offset)),B=c.map(I=>I.number%12).map(I=>{const O=I-A;return O>=0?O:O+12}),G=qu(B,I=>I).map(([I,O])=>({value:I,count:O.length})),T=Ke({width:ck,height:uk,marginLeft:70,marginRight:10,color:{legend:s,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:I=>u[(I+A)%12],domain:l?we(0,12,1):[...C],reverse:!0,label:"notes, increasing semitones from root "},marks:[Tl(G,{x:"count",y:"value",fill:I=>s?I.value===0?"#666":C.has(I.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});n(0,r.textContent="",r),r.appendChild(T)},p=()=>{const S=JSON.stringify({root:a,scale:o,useColors:s,showOutsideScale:l,notes:c},void 0,2),$=new Blob([S],{type:"text/plain;charset=utf-8"});Pi($,"tempo-drift.json")},_=async A=>{const $=await A.target.files[0].text(),C=JSON.parse($);(c.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(n(2,a=C.root),n(3,o=C.scale),n(4,s=C.useColors),n(5,l=C.showOutsideScale),n(6,c=C.notes),m())};st(()=>{D.enable().then(f).catch(A=>alert(A)),m()}),lt(()=>{for(const A of D.inputs)A.removeListener()});function w(){a=Yt(this),n(2,a),n(7,u)}function g(){o=Yt(this),n(3,o),n(8,d)}const E=()=>{n(4,s=!s),m()},v=()=>{n(5,l=!l),m()};function x(A){ot[A?"unshift":"push"](()=>{r=A,n(0,r)})}return[r,i,a,o,s,l,c,u,d,m,p,_,w,g,E,v,x,()=>{confirm("Reset played notes?")&&(n(6,c=[]),m())},()=>document.querySelector("#file-input").click()]}class hk extends He{constructor(t){super(),qe(this,t,fk,lk,Ue,{})}}function dk(e){let t,n,r,i,a,o,s,l,c,u,d,f,h;return{c(){t=P("main"),n=P("h2"),n.textContent="Fretboard Heatmap",r=L(),i=P("p"),i.textContent=`Connect a MIDI guitar and start playing. The heatmap below shows how
        often you played each fretboard position.`,a=L(),o=P("div"),o.innerHTML="",s=L(),l=P("div"),c=L(),u=P("div"),d=P("button"),d.textContent="reset",N(i,"class","explanation"),N(o,"class","control"),N(l,"class","visualization"),N(d,"title","Clear all played notes"),N(u,"class","control"),N(t,"class","demo")},m(m,p){oe(m,t,p),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(t,s),b(t,l),e[3](l),b(t,c),b(t,u),b(u,d),f||(h=X(d,"click",e[4]),f=!0)},p:se,i:se,o:se,d(m){m&&ae(t),e[3](null),f=!1,h()}}}let l1=1e3,mk=280,c1=6,xc=24;function pk(e,t,n){let r=[64,59,55,50,45,40],i,a=[];const o=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((d,f)=>{console.log(`MIDI device ${f}: ${d.name}`),d.addListener("noteon",s)}),[...D.inputs])},s=d=>{const f=d.message.channel-1,h={number:d.note.number,velocity:d.rawVelocity,time:d.timestamp,channel:d.message.channel,string:f,fret:d.note.number-r[f]};a.push(h),l()},l=()=>{const d=r.map(bn.fromMidiSharps),f=a.map(p=>{const _=p.channel-1;return{...p,string:_,fret:p.number-r[_]}}),h=(l1-100)/25,m=Ke({width:l1,height:mk,marginLeft:60,marginBottom:50,padding:0,x:{domain:we(0,xc+1),ticks:we(0,xc+1),tickSize:0},y:{domain:we(0,c1),tickFormat:p=>d[p],tickSize:0},color:{legend:!0,marginLeft:100,width:400,scheme:"blues"},marks:[jt(we(0,xc+1),{stroke:"#ddd",dx:h/2}),Lt(we(0,c1),{stroke:"#ddd",strokeWidth:p=>Math.sqrt(p+1)}),Ln([3,5,7,9,15,17,19,21],{x:p=>p,y:2,dy:h/2,fill:"#ddd",r:8}),Ln([12,12,24,24],{x:p=>p,y:(p,_)=>_%2===0?1:3,dy:h/2,fill:"#ddd",r:8}),Tu(f,$x({fill:"count"},{x:"fret",y:"string",fill:"count",inset:5,rx:"50%",tip:!0}))]});n(0,i.textContent="",i),i.appendChild(m)};st(()=>{D.enable().then(o).catch(d=>alert(d)),l()}),lt(()=>{for(const d of D.inputs)d.removeListener()});function c(d){ot[d?"unshift":"push"](()=>{i=d,n(0,i)})}return[i,a,l,c,()=>{confirm("Reset played notes?")&&(n(1,a=[]),l())}]}class bk extends He{constructor(t){super(),qe(this,t,pk,dk,Ue,{})}}function gk(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E,v;return{c(){t=P("main"),n=P("h2"),n.textContent="Chord and Arpeggio Timing",r=L(),i=P("p"),i.innerHTML="",a=L(),o=P("div"),s=P("label"),l=K(`max. note distance
            `),c=P("input"),u=L(),d=P("label"),f=K(`time
            `),h=P("input"),m=L(),p=P("div"),_=L(),w=P("div"),g=P("button"),g.textContent="reset",N(i,"class","explanation"),N(c,"type","number"),N(c,"min","0.05"),N(c,"max","5"),N(c,"step","0.05"),N(s,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),N(h,"type","number"),N(h,"min","10"),N(h,"max","300"),N(h,"step","10"),N(d,"title","time in seconds for past notes to be shown"),N(o,"class","control"),N(p,"class","visualization"),N(g,"title","Clear all played notes"),N(w,"class","control"),N(t,"class","demo")},m(x,y){oe(x,t,y),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c),ce(c,e[2]),b(o,u),b(o,d),b(d,f),b(d,h),ce(h,e[1]),b(t,m),b(t,p),e[8](p),b(t,_),b(t,w),b(w,g),E||(v=[X(c,"input",e[6]),X(c,"change",e[5]),X(h,"input",e[7]),X(h,"change",e[5]),X(g,"click",e[9])],E=!0)},p(x,[y]){y&4&&_e(c.value)!==x[2]&&ce(c,x[2]),y&2&&_e(h.value)!==x[1]&&ce(h,x[1])},i:se,o:se,d(x){x&&ae(t),e[8](null),E=!1,Fe(v)}}}let Ec=1e3,yk=400;function _k(e,t,n){let r,i=10,a=.2,o=0,s=[];const l=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((p,_)=>{console.log(`MIDI device ${_}: ${p.name}`),p.addListener("noteon",c)}),[...D.inputs])},c=p=>{const _=(p.timestamp-o)/1e3,w={number:p.note.number,velocity:p.rawVelocity,time:_,channel:p.message.channel};s.push(w),u()},u=()=>{const p=Ge(s,S=>S.time)+.5,_=p-i,w=s.filter(S=>S.end>_||S.end===void 0),g=[];let E=[];for(const S of w)E.length===0||S.time-E.at(-1).time<a?E.push(S):(g.push(E),E=[S]);g.push(E);const v=g.map(S=>ht(S,$=>$.time)),x=v.slice(1).map((S,$)=>[v[$][0],S[0]]),y=Ke({insetRight:10,width:Ec,height:yk,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[_,p]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,tickFormat:S=>Ca[S].label},marks:[Im(w,{clip:!0,x:"time",y:"number",fill:"#ddd",stroke:"#ccc"})]}),M=Ke({insetRight:10,width:Ec,height:100,marginLeft:60,marginTop:0,marginBottom:0,padding:0,x:{label:null,domain:[_,p],axis:!1},y:{ticks:[],label:"durations (s)"},marks:[$m(v,{clip:!0,x1:S=>S[0],x2:S=>S[1],y:0}),$r(v,{clip:!0,x:S=>S[0],y:0,text:(S,$)=>(S[1]-S[0]).toFixed(2),dy:10,textAnchor:"start"})]}),A=Ke({insetRight:10,width:Ec,height:100,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[_,p]},y:{ticks:[],label:"gaps (s)"},marks:[$m(x,{clip:!0,x1:S=>S[0],x2:S=>S[1],y:0}),Im(x,{clip:!0,x:S=>S[0]}),$r(x,{clip:!0,x:S=>S[0],y:0,text:(S,$)=>(S[1]-S[0]).toFixed(2),dx:2,dy:10,textAnchor:"start"})]});n(0,r.textContent="",r),r.appendChild(y),r.appendChild(M),r.appendChild(A)};st(()=>{D.enable().then(l).catch(p=>alert(p)),n(3,o=performance.now()),u()}),lt(()=>{for(const p of D.inputs)p.removeListener()});function d(){a=_e(this.value),n(2,a)}function f(){i=_e(this.value),n(1,i)}function h(p){ot[p?"unshift":"push"](()=>{r=p,n(0,r)})}return[r,i,a,o,s,u,d,f,h,()=>{confirm("Reset played notes?")&&(n(4,s=[]),n(3,o=performance.now()))}]}class wk extends He{constructor(t){super(),qe(this,t,_k,gk,Ue,{})}}function vk(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_;return{c(){t=P("main"),n=P("h2"),n.textContent="Keyboard Histogram",r=L(),i=P("p"),i.textContent=`Connect a MIDI keyboard and start playing. The heatmap below shows how
        often you played each keyboard key.`,a=L(),o=P("div"),s=P("label"),l=K(`number of notes
            `),c=P("input"),u=L(),d=P("div"),f=L(),h=P("div"),m=P("button"),m.textContent="reset",N(i,"class","explanation"),N(c,"type","number"),N(c,"min","0"),N(c,"max","250"),N(c,"step","1"),N(o,"class","control"),N(d,"class","visualization"),N(m,"title","Clear all played notes"),N(h,"class","control"),N(t,"class","demo")},m(w,g){oe(w,t,g),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c),ce(c,e[1]),b(t,u),b(t,d),e[5](d),b(t,f),b(t,h),b(h,m),p||(_=[X(c,"input",e[4]),X(m,"click",e[6])],p=!0)},p(w,[g]){g&2&&_e(c.value)!==w[1]&&ce(c,w[1])},i:se,o:se,d(w){w&&ae(t),e[5](null),p=!1,Fe(_)}}}let Mk=1200,xk=280;const Sc=21,Ac=108;function Ek(e,t,n){let r,i=500,a=[];const o=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((h,m)=>{console.log(`MIDI device ${m}: ${h.name}`),h.addListener("noteon",s),h.addListener("controlchange",l)}),[...D.inputs])},s=h=>{const m={number:h.note.number,velocity:h.rawVelocity,time:h.timestamp,channel:h.message.channel};a.push(m),c()},l=h=>{const m=bM(h.rawValue*2,20,250);n(1,i=m),c()},c=()=>{const h=a.slice(-i),m=qu(h,w=>w.number);console.log(m);const p=Ge(m,w=>w[1].length);console.log(p);const _=Ke({width:Mk,height:xk,marginLeft:80,marginBottom:50,padding:0,x:{domain:we(Sc,Ac),tickFormat:w=>la(w)?"":w%12===0?`
`+bn.fromMidiSharps(w):bn.fromMidiSharps(w).slice(0,-1)},y:{},marks:[jt(mg(Sc,Ac),{stroke:"#ddd"}),Lt([0],{stroke:"#ddd"}),Na(we(Sc,Ac).filter(w=>la(w)),{x:w=>w,y:()=>p,fill:"#f8f8f8",inset:.5}),Na(h,Tx({y:"count"},{x:"number",fill:w=>la(w.number)?"#444":"#ccc",inset:.5,rx:4,tip:!0}))]});n(0,r.textContent="",r),r.appendChild(_)};st(()=>{D.enable().then(o).catch(h=>alert(h)),c()}),lt(()=>{for(const h of D.inputs)h.removeListener()});function u(){i=_e(this.value),n(1,i)}function d(h){ot[h?"unshift":"push"](()=>{r=h,n(0,r)})}return[r,i,a,c,u,d,()=>{confirm("Reset played notes?")&&(n(2,a=[]),c())}]}class Sk extends He{constructor(t){super(),qe(this,t,Ek,vk,Ue,{})}}function u1(e,t,n){const r=e.slice();return r[16]=t[n],r}function f1(e,t,n){const r=e.slice();return r[19]=t[n],r}function h1(e){let t,n=e[19]+"",r;return{c(){t=P("option"),r=K(n),t.__value=e[19],ce(t,t.__value)},m(i,a){oe(i,t,a),b(t,r)},p:se,d(i){i&&ae(t)}}}function d1(e){let t,n=e[16]+"",r;return{c(){t=P("option"),r=K(n),t.__value=e[16],ce(t,t.__value)},m(i,a){oe(i,t,a),b(t,r)},p:se,d(i){i&&ae(t)}}}function Ak(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E=Te(e[4]),v=[];for(let M=0;M<E.length;M+=1)v[M]=h1(f1(e,E,M));let x=Te(e[5]),y=[];for(let M=0;M<x.length;M+=1)y[M]=d1(u1(e,x,M));return{c(){t=P("main"),n=P("h2"),n.textContent="Fretboard Improvisation Intervals",r=L(),i=P("p"),a=L(),o=P("div"),s=P("label"),l=K(`scale
            `),c=P("select");for(let M=0;M<v.length;M+=1)v[M].c();u=L(),d=P("select");for(let M=0;M<y.length;M+=1)y[M].c();f=L(),h=P("div"),m=L(),p=P("div"),_=P("button"),_.textContent="reset",N(i,"class","explanation"),e[1]===void 0&&bt(()=>e[7].call(c)),e[2]===void 0&&bt(()=>e[8].call(d)),N(o,"class","control"),N(h,"class","visualization"),N(_,"title","Clear all played notes"),N(p,"class","control"),N(t,"class","demo")},m(M,A){oe(M,t,A),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c);for(let S=0;S<v.length;S+=1)v[S]&&v[S].m(c,null);Le(c,e[1],!0),b(s,u),b(s,d);for(let S=0;S<y.length;S+=1)y[S]&&y[S].m(d,null);Le(d,e[2],!0),b(t,f),b(t,h),e[9](h),b(t,m),b(t,p),b(p,_),w||(g=[X(c,"change",e[7]),X(c,"change",e[6]),X(d,"change",e[8]),X(d,"change",e[6]),X(_,"click",e[10])],w=!0)},p(M,[A]){if(A&16){E=Te(M[4]);let S;for(S=0;S<E.length;S+=1){const $=f1(M,E,S);v[S]?v[S].p($,A):(v[S]=h1($),v[S].c(),v[S].m(c,null))}for(;S<v.length;S+=1)v[S].d(1);v.length=E.length}if(A&18&&Le(c,M[1]),A&32){x=Te(M[5]);let S;for(S=0;S<x.length;S+=1){const $=u1(M,x,S);y[S]?y[S].p($,A):(y[S]=d1($),y[S].c(),y[S].m(d,null))}for(;S<y.length;S+=1)y[S].d(1);y.length=x.length}A&36&&Le(d,M[2])},i:se,o:se,d(M){M&&ae(t),tt(v,M),tt(y,M),e[9](null),w=!1,Fe(g)}}}let m1=1e3,Pk=280,Pc=6,Nc=24;function Nk(e,t,n){let r,i="A",a="minor pentatonic",o=[],s=[64,59,55,50,45,40];const l=s.map(bn.fromMidiSharps),c=i_,u=gu.names(),d=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((g,E)=>{console.log(`MIDI device ${E}: ${g.name}`),g.addListener("noteon",f)}),[...D.inputs])},f=g=>{const E=g.message.channel-1,v={number:g.note.number,velocity:g.rawVelocity,time:g.timestamp,channel:g.message.channel,string:E,fret:g.note.number-s[E]};o.push(v),h()},h=()=>{const g=o.at(-1),E=[];if(g)for(let y=0;y<Pc;y++)for(let M=0;M<Nc+1;M++){let S=(s[y]+M-g.number)%12;S<0&&(S+=12),E.push({string:y,fret:M,step:S})}const v=(m1-100)/25,x=Ke({width:m1,height:Pk,marginLeft:60,marginBottom:50,padding:0,x:{domain:we(0,Nc+1),tickSize:0},y:{domain:we(0,Pc),tickFormat:y=>l[y]+" "+y,tickSize:0},color:{legend:!0,marginLeft:100,width:400,type:"categorical"},marks:[jt(we(0,Nc+1),{stroke:"#ddd",dx:v/2}),Lt(we(0,Pc),{stroke:"#ddd",strokeWidth:y=>Math.sqrt(y+1)}),Ln([3,5,7,9,15,17,19,21],{x:y=>y,y:2,dy:v/2,fill:"#ddd",r:8}),Ln([12,12,24,24],{x:y=>y,y:(y,M)=>M%2===0?1:3,dy:v/2,fill:"#ddd",r:8}),g?Tu([g],{x:"fret",y:"string",fill:"black",tip:!0,inset:5,rx:5}):null,Tu(E,{x:"fret",y:"string",fill:"step",inset:10,rx:"50%",tip:!0})]});n(0,r.textContent="",r),r.appendChild(x)};st(()=>{D.enable().then(d).catch(g=>alert(g)),h()}),lt(()=>{for(const g of D.inputs)g.removeListener()});function m(){i=Yt(this),n(1,i),n(4,c)}function p(){a=Yt(this),n(2,a),n(5,u)}function _(g){ot[g?"unshift":"push"](()=>{r=g,n(0,r)})}return[r,i,a,o,c,u,h,m,p,_,()=>{confirm("Reset played notes?")&&(n(3,o=[]),h())}]}class Ck extends He{constructor(t){super(),qe(this,t,Nk,Ak,Ue,{})}}function Tk(e,t,n){const r=e.slice();return r[30]=t[n],r}function $k(e,t,n){const r=e.slice();return r[30]=t[n],r}function kk(e){let t;return{c(){t=P("option"),t.textContent=`${e[30]}`,t.__value=e[30],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function Ik(e){let t;return{c(){t=P("option"),t.textContent=`${e[30]}`,t.__value=e[30],ce(t,t.__value)},m(n,r){oe(n,t,r)},p:se,d(n){n&&ae(t)}}}function Dk(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E,v,x,y,M,A,S,$,C,k,B,G,T,I,O,q,z,H,J,Z,F,te,ne,re,Q,Y,R,V,W,U,fe,ue,ie,he,le,je,Ae,de,ke,xe,an=Te(["off","32nd","16th","8th"]),Ft=[];for(let ye=0;ye<4;ye+=1)Ft[ye]=kk($k(e,an,ye));let ur=Te(["quarter","eighth","quarter-triplets","swing"]),En=[];for(let ye=0;ye<4;ye+=1)En[ye]=Ik(Tk(e,ur,ye));return{c(){t=P("main"),n=P("h2"),n.textContent="Speed-Up",r=L(),i=P("p"),i.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo (or higher).`,a=L(),o=P("div"),s=P("label"),l=K(`initial tempo
            `),c=P("input"),u=L(),d=P("label"),f=K(`target tempo
            `),h=P("input"),m=L(),p=P("label"),_=K(`tempo increase
            `),w=P("input"),g=L(),E=P("label"),v=K(`quantize exercise
            `),x=P("select");for(let ye=0;ye<4;ye+=1)Ft[ye].c();y=L(),M=P("div"),A=P("label"),S=K(`pre-defined exercise
            `),$=P("select");for(let ye=0;ye<4;ye+=1)En[ye].c();C=L(),k=P("button"),B=K("input exercise"),T=L(),I=P("button"),O=K("save exercise"),z=L(),H=P("button"),J=K("start practice"),F=L(),te=P("button"),ne=K("stop practice"),Q=L(),Y=P("div"),R=K("current step: "),V=P("b"),W=K(e[5]),U=K(" current tempo: "),fe=P("b"),ue=K(e[6]),ie=K(" BPM"),he=L(),le=P("div"),je=L(),Ae=P("div"),de=P("button"),de.textContent="reset practice",N(i,"class","explanation"),N(c,"type","number"),N(c,"min","30"),N(c,"max","100"),N(c,"step","5"),N(s,"title","Set a tempo at which you are able to input the exercise precisely (in BPM)"),N(h,"type","number"),N(h,"min","60"),N(h,"max","200"),N(h,"step","5"),N(d,"title","Set the tempo you want to be able to play the exercise at (in BPM)"),N(w,"type","number"),N(w,"min","1"),N(w,"max","20"),N(w,"step","1"),N(p,"title","Set the tempo increase between practice runs (in BPM)"),e[4]===void 0&&bt(()=>e[19].call(x)),N(o,"class","control"),N(k,"title","Start recording the exercise."),k.disabled=G=e[5]==="input exercise"||e[5]==="practice",N(I,"title","Stop recording the exercise."),I.disabled=q=e[5]!=="input exercise",N(H,"title","Start recording the practice with speed-up."),H.disabled=Z=e[8].length===0,N(te,"title","Stop recording the practice with speed-up."),te.disabled=re=e[5]!=="practice",N(M,"class","control"),N(le,"class","visualization"),N(de,"title","Clear practice but not exercise"),N(Ae,"class","control"),N(t,"class","demo")},m(ye,St){oe(ye,t,St),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c),ce(c,e[1]),b(o,u),b(o,d),b(d,f),b(d,h),ce(h,e[2]),b(o,m),b(o,p),b(p,_),b(p,w),ce(w,e[3]),b(o,g),b(o,E),b(E,v),b(E,x);for(let Sn=0;Sn<4;Sn+=1)Ft[Sn]&&Ft[Sn].m(x,null);Le(x,e[4],!0),b(t,y),b(t,M),b(M,A),b(A,S),b(A,$);for(let Sn=0;Sn<4;Sn+=1)En[Sn]&&En[Sn].m($,null);b(M,C),b(M,k),b(k,B),b(M,T),b(M,I),b(I,O),b(M,z),b(M,H),b(H,J),b(M,F),b(M,te),b(te,ne),b(t,Q),b(t,Y),b(Y,R),b(Y,V),b(V,W),b(Y,U),b(Y,fe),b(fe,ue),b(Y,ie),b(t,he),b(t,le),e[20](le),b(t,je),b(t,Ae),b(Ae,de),ke||(xe=[X(c,"input",e[16]),X(c,"change",e[14]),X(h,"input",e[17]),X(h,"change",e[14]),X(w,"input",e[18]),X(x,"change",e[19]),X(x,"change",e[14]),X($,"change",e[15]),X(k,"click",e[10]),X(I,"click",e[11]),X(H,"click",e[12]),X(te,"click",e[13]),X(de,"click",e[21])],ke=!0)},p(ye,St){St[0]&2&&_e(c.value)!==ye[1]&&ce(c,ye[1]),St[0]&4&&_e(h.value)!==ye[2]&&ce(h,ye[2]),St[0]&8&&_e(w.value)!==ye[3]&&ce(w,ye[3]),St[0]&16&&Le(x,ye[4]),St[0]&32&&G!==(G=ye[5]==="input exercise"||ye[5]==="practice")&&(k.disabled=G),St[0]&32&&q!==(q=ye[5]!=="input exercise")&&(I.disabled=q),St[0]&256&&Z!==(Z=ye[8].length===0)&&(H.disabled=Z),St[0]&32&&re!==(re=ye[5]!=="practice")&&(te.disabled=re),St[0]&32&&Se(W,ye[5]),St[0]&64&&Se(ue,ye[6])},i:se,o:se,d(ye){ye&&ae(t),tt(Ft,ye),tt(En,ye),e[20](null),ke=!1,Fe(xe)}}}let p1=1e3,b1=60;function Rk(e,t,n){const r=e[0];return e.map(a=>{let o=a-r;if(t!=="off"){let s;t==="8th"&&(s=n/2),t==="16th"&&(s=n/4),t==="32nd"&&(s=n/8),o=Math.round(o/s)*s}return o/n})}function Lk(e,t,n){let r,i=new lh,a=60,o=120,s=10,l="off",c="",u=o,d=0,f=[],h,m=new Map,p=!0,_;const w=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((I,O)=>{console.log(`MIDI device ${O}: ${I.name}`),I.addListener("noteon",g)}),[...D.inputs])},g=async I=>{const q=(I.timestamp-d)/1e3;if(c==="input exercise")n(8,f=[...f,q]);else if(c==="practice"){m.has(u)||m.set(u,[]);const z=m.get(u);p&&z.push(q)}A()},E=async()=>{const I=m.get(u);if(!I)return;const O=Ge(I)-Xt(I);let q=Xn(u);const z=O/q;console.log(`${z} of ${h}`),z>=h&&(console.log("increasing bpm"),i.stop(),u<=o?(n(6,u+=s),p=!1,await gM(2),i.start(u,4),m.has(u)&&m.set(u,[]),p=!0):n(5,c=""))},v=()=>{n(5,c="input exercise"),n(8,f=[]),n(9,m=new Map),i.start(a,4),A()},x=()=>{if(n(5,c=""),i.stop(),f.length>0){const I=Ge(f)-Xt(f);let O=Xn(a);h=Math.ceil(I/O)}},y=async()=>{if(f.length===0){alert("You need to input an exercise first");return}n(5,c="practice"),n(6,u=a),n(9,m=new Map),i.start(u,4),_=setInterval(E,100)},M=()=>{n(5,c=""),n(6,u=o),clearInterval(_),i.stop()},A=()=>{if(n(0,r.textContent="",r),f.length===0)return;let I=Xn(a);const O=Rk(f,l,I);let q=Math.ceil(Ge(O)/4*4)+.5;console.log(O,q);const z=Ke({width:p1,height:b1,marginLeft:40,x:{label:"Time in beats",domain:[0,q]},y:{},marks:[jt(we(0,q,1),{stroke:"#ddd"}),jt(we(0,q,4)),Ln(O,{symbol:"times",stroke:"#333",x:H=>H,r:5})]});r.appendChild(z);for(const[H,J]of m){const Z=J[0];I=Xn(H);const F=J.map(ne=>(ne-Z)/I),te=Ke({width:p1,height:b1,marginLeft:40,x:{label:"Time in beats",domain:[0,q]},y:{label:`practice with ${H} BPM`},marks:[jt(we(0,q,1),{stroke:"#ddd"}),jt(we(0,q,4)),Ln(F,{symbol:"times",stroke:"#333",x:ne=>ne,r:5})]});r.appendChild(te)}};st(()=>{D.enable().then(w).catch(I=>alert(I)),n(7,d=performance.now()),A()}),lt(()=>{for(const I of D.inputs)I.removeListener();i.stop()});const S=I=>{const O=I.target.value,q=new Map([["quarter",we(0,8,1)],["eighth",we(0,8,.5)],["quarter-triplets",we(0,8,.3)],["swing",we(0,8,.5).map((J,Z)=>Z%2===0?Z:Z+.2)]]),z=Xn(a);n(4,l="off");const H=q.get(O);n(8,f=H.map(J=>J*z)),h=Math.ceil(Ge(H)+1),console.log(O,f),A()};function $(){a=_e(this.value),n(1,a)}function C(){o=_e(this.value),n(2,o)}function k(){s=_e(this.value),n(3,s)}function B(){l=Yt(this),n(4,l)}function G(I){ot[I?"unshift":"push"](()=>{r=I,n(0,r)})}return[r,a,o,s,l,c,u,d,f,m,v,x,y,M,A,S,$,C,k,B,G,()=>{confirm("Reset practice?")&&(n(9,m=new Map),n(7,d=performance.now()),A())}]}class Bk extends He{constructor(t){super(),qe(this,t,Lk,Dk,Ue,{},null,[-1,-1])}}function Ok(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w=e[3]?"on":"off",g,E,v,x,y,M,A,S,$,C;return{c(){t=P("main"),n=P("h2"),n.textContent="Rhythm Sheet Music",r=L(),i=P("p"),i.textContent=`Set a tempo and start playing. The time between the notes you play will
        be displayed as note symbols, so you can see whether you play, for
        example, correct quarter notes.`,a=L(),o=P("div"),s=P("label"),l=K(`tempo
            `),c=P("input"),u=L(),d=P("label"),f=K(`note count
            `),h=P("input"),m=L(),p=P("button"),_=K("dotted notes "),g=K(w),E=L(),v=P("div"),x=L(),y=P("div"),M=P("button"),M.textContent="reset",A=L(),S=P("button"),S.textContent="metronome",N(i,"class","explanation"),N(c,"type","number"),N(c,"min","30"),N(c,"max","100"),N(c,"step","5"),N(s,"title","Tempo (in BPM)"),N(h,"type","number"),N(h,"min","5"),N(h,"max","100"),N(h,"step","5"),N(d,"title","Number of shown notes"),N(p,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),N(o,"class","control"),N(v,"class","visualization"),N(M,"title","Clear played notes"),N(S,"title","Toggle metronome (click)"),N(y,"class","control"),N(t,"class","demo")},m(k,B){oe(k,t,B),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c),ce(c,e[1]),b(o,u),b(o,d),b(d,f),b(d,h),ce(h,e[2]),b(o,m),b(o,p),b(p,_),b(p,g),b(t,E),b(t,v),e[11](v),b(t,x),b(t,y),b(y,M),b(y,A),b(y,S),$||(C=[X(c,"input",e[8]),X(c,"change",e[7]),X(h,"input",e[9]),X(h,"change",e[7]),X(p,"click",e[10]),X(M,"click",e[12]),X(S,"click",e[13])],$=!0)},p(k,[B]){B&2&&_e(c.value)!==k[1]&&ce(c,k[1]),B&4&&_e(h.value)!==k[2]&&ce(h,k[2]),B&8&&w!==(w=k[3]?"on":"off")&&Se(g,w)},i:se,o:se,d(k){k&&ae(t),e[11](null),$=!1,Fe(C)}}}let g1=1e3;function Fk(e,t,n){let r,i=new lh,a=120,o=10,s=!0,l=0,c=[];const u=[{name:"double-whole",beats:8,symbol:"_"},{name:"dotted-whole",beats:6,symbol:".",dotted:!0},{name:"whole",beats:4,symbol:""},{name:"dotted-half",beats:3,symbol:".",dotted:!0},{name:"half",beats:2,symbol:""},{name:"dotted-quarter",beats:1.5,symbol:".",dotted:!0},{name:"quarter",beats:1,symbol:""},{name:"dotted-eighth",beats:.75,symbol:".",dotted:!0},{name:"eighth",beats:.5,symbol:""},{name:"dotted-sixteenth",beats:.375,symbol:".",dotted:!0},{name:"sixteenth",beats:.25,symbol:""},{name:"thirtysecond",beats:.125,symbol:""},{name:"sixtyfourth",beats:.0625,symbol:""}],d=u.filter(x=>!x.dotted),f=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((x,y)=>{console.log(`MIDI device ${y}: ${x.name}`),x.addListener("noteon",h)}),[...D.inputs])},h=async x=>{const M=(x.timestamp-l)/1e3;c.push(M),m()},m=()=>{if(n(0,r.textContent="",r),c.length===0)return;let x=Xn(a);const y=c.slice(-(o+1)),A=y.map((B,G)=>G===0?0:B-y[G-1]).map(B=>B/x),S=s?u:d,$=A.map(B=>{const G=B1(S,I=>Math.abs(B-I.beats)),T=S[G];return{...T,beats:B,offsetPercent:(B/T.beats*100).toFixed()}}),C=Ke({width:g1,height:100,marginLeft:80,x:{label:"",domain:we(1,o),ticks:[]},y:{domain:[1,0],ticks:we(3),tickFormat:B=>["note","beats"][B]},marks:[$r($,{text:"symbol",x:(B,G)=>G,y:0,fontSize:40}),$r($,{text:"beats",x:(B,G)=>G,y:1,fontSize:20})]});r.appendChild(C);const k=Ke({width:g1,height:100,marginLeft:80,x:{label:"Note",domain:we(1,o),tickSize:0,ticks:[]},y:{domain:[0,150],ticks:[0,50,100,150]},marks:[Na($,{x:(B,G)=>G,y:"offsetPercent",fill:"#ddd"}),Lt([50,150],{stroke:"#aaa"}),Lt([100])]});r.appendChild(k)};st(()=>{D.enable().then(f).catch(x=>alert(x)),n(4,l=performance.now()),m()}),lt(()=>{for(const x of D.inputs)x.removeListener();i.stop()});function p(){a=_e(this.value),n(1,a)}function _(){o=_e(this.value),n(2,o)}const w=()=>n(3,s=!s);function g(x){ot[x?"unshift":"push"](()=>{r=x,n(0,r)})}return[r,a,o,s,l,c,i,m,p,_,w,g,()=>{confirm("Clear notes?")&&(n(4,l=performance.now()),n(5,c=[]),m())},()=>{i.toggle(a,4)}]}class Gk extends He{constructor(t){super(),qe(this,t,Fk,Ok,Ue,{})}}function Uk(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E,v;return{c(){t=P("main"),n=P("h2"),n.textContent="Chord and Arpeggio Timing",r=L(),i=P("p"),i.innerHTML="",a=L(),o=P("div"),s=P("label"),l=K(`max. note distance
            `),c=P("input"),u=L(),d=P("label"),f=K(`chord count
            `),h=P("input"),m=L(),p=P("div"),_=L(),w=P("div"),g=P("button"),g.textContent="reset",N(i,"class","explanation"),N(c,"type","number"),N(c,"min","0.05"),N(c,"max","5"),N(c,"step","0.05"),N(s,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),N(h,"type","number"),N(h,"min","10"),N(h,"max","300"),N(h,"step","10"),N(d,"title","The number of played chords that is displayed"),N(o,"class","control"),N(p,"class","visualization"),N(g,"title","Clear all played notes"),N(w,"class","control"),N(t,"class","demo")},m(x,y){oe(x,t,y),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(o,s),b(s,l),b(s,c),ce(c,e[2]),b(o,u),b(o,d),b(d,f),b(d,h),ce(h,e[1]),b(t,m),b(t,p),e[8](p),b(t,_),b(t,w),b(w,g),E||(v=[X(c,"input",e[6]),X(c,"change",e[5]),X(h,"input",e[7]),X(h,"change",e[5]),X(g,"click",e[9])],E=!0)},p(x,[y]){y&4&&_e(c.value)!==x[2]&&ce(c,x[2]),y&2&&_e(h.value)!==x[1]&&ce(h,x[1])},i:se,o:se,d(x){x&&ae(t),e[8](null),E=!1,Fe(v)}}}let y1=1e3,qk=200,_1=6,Hk=24;function zk(e,t,n){let r,i=5,a=.2,o=[64,59,55,50,45,40];const s=o.map(bn.fromMidiSharps);let l=0,c=[];const u=()=>{D.inputs.length<1?console.warn("No MIDI device detected"):(D.inputs.forEach((w,g)=>{console.log(`MIDI device ${g}: ${w.name}`),w.addListener("noteon",d)}),[...D.inputs])},d=w=>{const g=(w.timestamp-l)/1e3,E=w.message.channel-1,v={number:w.note.number,velocity:w.rawVelocity,time:g,channel:w.message.channel,string:E,fret:w.note.number-o[E]};c.push(v),f()},f=()=>{let w=[],g=[];for(const v of c)g.length===0||v.time-g.at(-1).time<a?g.push(v):(w.push(g),g=[v]);w.push(g),w=w.filter(v=>v.length>1).slice(-i);for(const[v,x]of w.entries())for(const y of x)y.chordId=v;w.map(v=>{let x=v.sort((y,M)=>y.number-M.number).map(y=>bn.fromMidiSharps(y.number));return x=[...new Set(x)],Gg.detect(x)}),console.log(w);const E=(y1-100)/25;n(0,r.textContent="",r);for(const v of w){const x=ht(v,M=>M.fret),y=Ke({width:y1,height:qk,marginLeft:60,marginBottom:50,padding:0,x:{domain:we(x[0]-1,Math.max(x[0]+6,x[1]+2),1),tickSize:0},y:{domain:we(0,_1),tickFormat:M=>s[M],tickSize:0},color:{domain:we(12),legend:!0,marginLeft:100,width:400,type:"categorical",tickFormat:M=>OP[M]},r:{legend:!0,domain:[0,100],range:[5,10]},marks:[jt(we(0,Hk+1),{stroke:"#ddd",dx:E/2}),Lt(we(0,_1),{stroke:"#ddd",strokeWidth:M=>Math.sqrt(M+1)}),Ln([3,5,7,9,15,17,19,21],{x:M=>M,y:2,dy:E/2,fill:"#ddd",r:8}),Ln([12,12,24,24],{x:M=>M,y:(M,A)=>A%2===0?1:3,dy:E/2,fill:"#ddd",r:8}),Ln(v,{x:"fret",y:"string",r:"velocity",fill:M=>M.number%12,tip:!0})]});r.appendChild(y)}};st(()=>{D.enable().then(u).catch(w=>alert(w)),n(3,l=performance.now()),f()}),lt(()=>{for(const w of D.inputs)w.removeListener()});function h(){a=_e(this.value),n(2,a)}function m(){i=_e(this.value),n(1,i)}function p(w){ot[w?"unshift":"push"](()=>{r=w,n(0,r)})}return[r,i,a,l,c,f,h,m,p,()=>{confirm("Reset played notes?")&&(n(4,c=[]),n(3,l=performance.now()))}]}class Vk extends He{constructor(t){super(),qe(this,t,zk,Uk,Ue,{})}}function w1(e,t,n){const r=e.slice();return r[19]=t[n],r}function v1(e,t,n){const r=e.slice();return r[22]=t[n],r}function M1(e,t,n){const r=e.slice();return r[22]=t[n],r}function jk(e){let t,n,r,i,a,o,s,l;const c=[Kk,Xk],u=[];function d(f,h){return f[0]==="tools"?0:1}return r=d(e),i=u[r]=c[r](e),{c(){t=P("button"),t.textContent="< back",n=L(),i.c(),a=Gu()},m(f,h){oe(f,t,h),oe(f,n,h),u[r].m(f,h),oe(f,a,h),o=!0,s||(l=X(t,"click",e[17]),s=!0)},p(f,h){let m=r;r=d(f),r===m?u[r].p(f,h):(Ba(),Wt(u[m],1,1,()=>{u[m]=null}),Oa(),i=u[r],i?i.p(f,h):(i=u[r]=c[r](f),i.c()),It(i,1),i.m(a.parentNode,a))},i(f){o||(It(i),o=!0)},o(f){Wt(i),o=!1},d(f){f&&(ae(t),ae(n),ae(a)),u[r].d(f),s=!1,l()}}}function Yk(e){let t,n,r,i,a,o,s,l,c,u,d,f,h,m,p,_,w,g,E,v=Te(e[5].values()),x=[];for(let $=0;$<v.length;$+=1)x[$]=x1(M1(e,v,$));let y=Te(e[6].values()),M=[];for(let $=0;$<y.length;$+=1)M[$]=E1(v1(e,y,$));let A=Te(e[4]),S=[];for(let $=0;$<A.length;$+=1)S[$]=A1(w1(e,A,$));return{c(){t=P("p"),t.textContent=`This page contains a collection of small tools (demos) that are each
      tailored to a specific musical skill and sometimes also specific kind of
      musical data. You can filter demos with the bottuns below. Click a button
      to toggle it, double click it to turn it on and all others of the same
      kind off. A demo will only be shown if it supports at least one of the
      active attributes.`,n=L(),r=P("div"),i=K(`task
      `),a=P("button"),a.textContent="all",o=L();for(let $=0;$<x.length;$+=1)x[$].c();s=L(),l=P("div"),c=K(`instrument
      `),u=P("button"),u.textContent="all",d=L();for(let $=0;$<M.length;$+=1)M[$].c();f=L(),h=P("div");for(let $=0;$<S.length;$+=1)S[$].c();m=L(),p=P("button"),p.textContent="tools",_=L(),w=P("button"),w.textContent="export usage",N(t,"class","explanation"),N(h,"class","grid")},m($,C){oe($,t,C),oe($,n,C),oe($,r,C),b(r,i),b(r,a),b(r,o);for(let k=0;k<x.length;k+=1)x[k]&&x[k].m(r,null);oe($,s,C),oe($,l,C),b(l,c),b(l,u),b(l,d);for(let k=0;k<M.length;k+=1)M[k]&&M[k].m(l,null);oe($,f,C),oe($,h,C);for(let k=0;k<S.length;k+=1)S[k]&&S[k].m(h,null);oe($,m,C),oe($,p,C),oe($,_,C),oe($,w,C),g||(E=[X(a,"click",e[8]),X(u,"click",e[11]),X(p,"click",e[15]),X(w,"click",e[16])],g=!0)},p($,C){if(C&40){v=Te($[5].values());let k;for(k=0;k<v.length;k+=1){const B=M1($,v,k);x[k]?x[k].p(B,C):(x[k]=x1(B),x[k].c(),x[k].m(r,null))}for(;k<x.length;k+=1)x[k].d(1);x.length=v.length}if(C&68){y=Te($[6].values());let k;for(k=0;k<y.length;k+=1){const B=v1($,y,k);M[k]?M[k].p(B,C):(M[k]=E1(B),M[k].c(),M[k].m(l,null))}for(;k<M.length;k+=1)M[k].d(1);M.length=y.length}if(C&29){A=Te($[4]);let k;for(k=0;k<A.length;k+=1){const B=w1($,A,k);S[k]?S[k].p(B,C):(S[k]=A1(B),S[k].c(),S[k].m(h,null))}for(;k<S.length;k+=1)S[k].d(1);S.length=A.length}},i:se,o:se,d($){$&&(ae(t),ae(n),ae(r),ae(s),ae(l),ae(f),ae(h),ae(m),ae(p),ae(_),ae(w)),tt(x,$),tt(M,$),tt(S,$),g=!1,Fe(E)}}}function Wk(e){let t,n,r;return{c(){t=P("input"),N(t,"type","password"),N(t,"placeholder","password")},m(i,a){oe(i,t,a),ce(t,e[1]),n||(r=X(t,"input",e[7]),n=!0)},p(i,a){a&2&&t.value!==i[1]&&ce(t,i[1])},i:se,o:se,d(i){i&&ae(t),n=!1,r()}}}function Xk(e){let t,n,r;var i=e[0].component;function a(o,s){return{}}return i&&(t=Wo(i,a())),{c(){t&&ua(t.$$.fragment),n=Gu()},m(o,s){t&&ii(t,o,s),oe(o,n,s),r=!0},p(o,s){if(s&1&&i!==(i=o[0].component)){if(t){Ba();const l=t;Wt(l.$$.fragment,1,0,()=>{ai(l,1)}),Oa()}i?(t=Wo(i,a()),ua(t.$$.fragment),It(t.$$.fragment,1),ii(t,n.parentNode,n)):t=null}},i(o){r||(t&&It(t.$$.fragment,o),r=!0)},o(o){t&&Wt(t.$$.fragment,o),r=!1},d(o){o&&ae(n),t&&ai(t,o)}}}function Kk(e){let t,n;return t=new C$({}),{c(){ua(t.$$.fragment)},m(r,i){ii(t,r,i),n=!0},p:se,i(r){n||(It(t.$$.fragment,r),n=!0)},o(r){Wt(t.$$.fragment,r),n=!1},d(r){ai(t,r)}}}function x1(e){let t,n=e[22]+"",r,i,a,o,s;function l(){return e[9](e[22])}function c(){return e[10](e[22])}return{c(){t=P("button"),r=K(n),i=L(),N(t,"class",a=Yo(e[3].has(e[22])?"active":"hidden")+" svelte-1ohkj5g")},m(u,d){oe(u,t,d),b(t,r),b(t,i),o||(s=[X(t,"click",l),X(t,"dblclick",c)],o=!0)},p(u,d){e=u,d&8&&a!==(a=Yo(e[3].has(e[22])?"active":"hidden")+" svelte-1ohkj5g")&&N(t,"class",a)},d(u){u&&ae(t),o=!1,Fe(s)}}}function E1(e){let t,n=e[22]+"",r,i,a,o,s;function l(){return e[12](e[22])}function c(){return e[13](e[22])}return{c(){t=P("button"),r=K(n),i=L(),N(t,"class",a=Yo(e[2].has(e[22])?"active":"hidden")+" svelte-1ohkj5g")},m(u,d){oe(u,t,d),b(t,r),b(t,i),o||(s=[X(t,"click",l),X(t,"dblclick",c)],o=!0)},p(u,d){e=u,d&4&&a!==(a=Yo(e[2].has(e[22])?"active":"hidden")+" svelte-1ohkj5g")&&N(t,"class",a)},d(u){u&&ae(t),o=!1,Fe(s)}}}function S1(e){let t,n,r,i,a,o,s,l,c,u,d;function f(){return e[14](e[19])}return{c(){t=P("div"),n=P("h2"),n.textContent=`${e[19].title}`,r=L(),i=P("div"),i.textContent=`${e[19].description}`,a=L(),o=P("div"),o.textContent=`instrument:
              ${e[19].instruments.includes("guitar/bass")?"":""} ${e[19].instruments.includes("drum")?"":""} ${e[19].instruments.includes("keyboard")?"":""}`,s=L(),l=P("div"),l.textContent=`task:
              ${e[19].task==="dynamics"?"":""} ${e[19].task==="timing"?"":""} ${e[19].task==="pitch"?"":""}`,c=L(),N(i,"class","description"),N(o,"class","tags svelte-1ohkj5g"),N(l,"class","tags svelte-1ohkj5g"),N(t,"class","card svelte-1ohkj5g")},m(h,m){oe(h,t,m),b(t,n),b(t,r),b(t,i),b(t,a),b(t,o),b(t,s),b(t,l),b(t,c),u||(d=X(t,"click",f),u=!0)},p(h,m){e=h},d(h){h&&ae(t),u=!1,d()}}}function A1(e){let t=e[3].has(e[19].task)&&Sd(e[2],e[19].instruments),n,r=t&&S1(e);return{c(){r&&r.c(),n=Gu()},m(i,a){r&&r.m(i,a),oe(i,n,a)},p(i,a){a&12&&(t=i[3].has(i[19].task)&&Sd(i[2],i[19].instruments)),t?r?r.p(i,a):(r=S1(i),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},d(i){i&&ae(n),r&&r.d(i)}}}function Zk(e){let t,n,r,i,a,o;const s=[Wk,Yk,jk],l=[];function c(u,d){return u[1]!==Jk?0:u[0]?2:1}return i=c(e),a=l[i]=s[i](e),{c(){t=P("main"),n=P("h1"),n.textContent="Data-Driven Music Education Demos",r=L(),a.c()},m(u,d){oe(u,t,d),b(t,n),b(t,r),l[i].m(t,null),o=!0},p(u,[d]){let f=i;i=c(u),i===f?l[i].p(u,d):(Ba(),Wt(l[f],1,1,()=>{l[f]=null}),Oa(),a=l[i],a?a.p(u,d):(a=l[i]=s[i](u),a.c()),It(a,1),a.m(t,null))},i(u){o||(It(a),o=!0)},o(u){Wt(a),o=!1},d(u){u&&ae(t),l[i].d()}}}let Jk="rhyvis";function Qk(e,t,n){const r=[{id:"sub-division",title:"Sub-Division",description:"Learn rhythmic playing in different sub-divisions.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:q$},{id:"tempo-drift",title:"Tempo Drift",description:"Keep your tempo constant over a longer stretch of playing.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:Z$},{id:"dynamics",title:"Dynamics",description:"Check how well you control the loudness of notes.",tags:["task:dynamics","input:MIDI","encoding:bars"],task:"dynamics",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:nk},{id:"improvisation-intervals",title:"Improvisation Intervals",description:"See how often you use different intervals in improvisation.",task:"pitch",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:sk},{id:"improvisation-scale-degrees",title:"Improvisation Scale Degrees",description:"See how often you use different scale degrees in improvisation.",task:"pitch",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:hk},{id:"keyboard-histogram",title:"[new] Keyboard Histogram",description:"See how often you play different keyboard keys.",task:"pitch",input:"MIDI",instruments:["keyboard"],component:Sk},{id:"fretboard-heatmap",title:"Fretboard Heatmap",description:"See how often you play different fretboard positions.",task:"pitch",input:"MIDI",instruments:["guitar/bass"],component:bk},{id:"fretboard-improvisation-intervals",title:"[new] Fretboard Improvisation Intervals",description:"Once you play a note, see where on the fretboard you can reach different intervals to the last played note.",task:"pitch",input:"MIDI",instruments:["guitar/bass"],component:Ck},{id:"chord-arpeggio-timing",title:"Chord and Arpeggio Timing",description:"See how spaced out the notes in a chord or arpeggio are, and how much time lies between these.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:wk},{id:"speed-up",title:"[new] Speed-Up",description:"Record a short exercise at a slow tempo, then practice it with steadily increasing tempo.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:Bk},{id:"rhythm-sheet-music",title:"[new] Rhythm Sheet Music",description:"This demo displays the notes you play as staff notation (, , , , ) and offset in percent.",task:"timing",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],component:Gk},{id:"chord-diagrams",title:"[new] Chord Diagrams",description:"See what chords you play on a guitar/bass as chord diagrams.",task:"chords",input:"MIDI",instruments:["guitar/bass"],component:Vk}];let i=null;const a=H_(window,"d");a&&a!==""&&(i=r.filter(y=>y.id===a)[0]);let o=localStorage.getItem("pwd")??"";window.onpopstate=y=>{i!==null&&n(0,i=null)};const s=new Set(r.flatMap(y=>y.task).sort()),l=new Set(r.flatMap(y=>y.instruments).sort());let c=new Set(s),u=new Set(l);function d(){o=this.value,n(1,o)}const f=()=>{n(3,c=new Set(s))},h=y=>n(3,c=Ed(c,y)),m=y=>n(3,c=new Set([y])),p=()=>{n(2,u=new Set(l))},_=y=>n(2,u=Ed(u,y)),w=y=>n(2,u=new Set([y])),g=y=>{n(0,i=y),Rl(window,"d",y.id)},E=()=>{n(0,i="tools"),Rl(window,"d","tools")},v=()=>{const y=localStorage.getItem("usage"),M=new Blob([y],{type:"text/plain;charset=utf-8"});Pi(M,"usage.json")},x=()=>{n(0,i=null),Rl(window,"d","")};return e.$$.update=()=>{if(e.$$.dirty&2&&localStorage.setItem("pwd",o),e.$$.dirty&1&&i&&i!=="tools"){let y;localStorage.getItem("usage")!==null?(y=localStorage.getItem("usage"),y=JSON.parse(y)):y={demoClicks:{}};const M=y.demoClicks,A=M[i.id]??[];A.push(new Date().toUTCString()),M[i.id]=A,localStorage.setItem("usage",JSON.stringify(y))}e.$$.dirty&4&&console.log(u)},[i,o,u,c,r,s,l,d,f,h,m,p,_,w,g,E,v,x]}class eI extends He{constructor(t){super(),qe(this,t,Qk,Zk,Ue,{})}}new eI({target:document.getElementById("app")});
