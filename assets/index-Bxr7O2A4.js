var RU=Object.defineProperty;var LU=(e,t,i)=>t in e?RU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var pr=(e,t,i)=>(LU(e,typeof t!="symbol"?t+"":t,i),i),kx=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)};var wn=(e,t,i)=>(kx(e,t,"read from private field"),i?i.call(e):t.get(e)),Ir=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},mr=(e,t,i,r)=>(kx(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);var Ux=(e,t,i,r)=>({set _(o){mr(e,t,o,i)},get _(){return wn(e,t,r)}});function PU(e,t){for(var i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const a=Object.getOwnPropertyDescriptor(r,o);a&&Object.defineProperty(e,o,a.get?a:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function i(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=i(o);fetch(o.href,a)}})();function gn(){}function R4(e){return e()}function Gx(){return Object.create(null)}function ji(e){e.forEach(R4)}function Jf(e){return typeof e=="function"}function fi(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function DU(e){return Object.keys(e).length===0}function lg(e){return e??""}function D(e,t){e.appendChild(t)}function Bt(e,t,i){e.insertBefore(t,i||null)}function It(e){e.parentNode&&e.parentNode.removeChild(e)}function ti(e,t){for(let i=0;i<e.length;i+=1)e[i]&&e[i].d(t)}function oe(e){return document.createElement(e)}function $e(e){return document.createTextNode(e)}function ge(){return $e(" ")}function Zf(){return $e("")}function lt(e,t,i,r){return e.addEventListener(t,i,r),()=>e.removeEventListener(t,i,r)}function fe(e,t,i){i==null?e.removeAttribute(t):e.getAttribute(t)!==i&&e.setAttribute(t,i)}function Fn(e,t,i){const r=t.toLowerCase();r in e?e[r]=typeof e[r]=="boolean"&&i===""?!0:i:t in e?e[t]=typeof e[t]=="boolean"&&i===""?!0:i:fe(e,t,i)}function Yn(e){return e===""?null:+e}function NU(e){return Array.from(e.childNodes)}function jt(e,t){t=""+t,e.data!==t&&(e.data=t)}function ln(e,t){e.value=t??""}function cr(e,t,i,r){i==null?e.style.removeProperty(t):e.style.setProperty(t,i,"")}function ci(e,t,i){for(let r=0;r<e.options.length;r+=1){const o=e.options[r];if(o.__value===t){o.selected=!0;return}}(!i||t!==void 0)&&(e.selectedIndex=-1)}function Dr(e){const t=e.querySelector(":checked");return t&&t.__value}function cg(e,t){return new e(t)}let Ip;function Ap(e){Ip=e}function L4(){if(!Ip)throw new Error("Function called outside component initialization");return Ip}function tr(e){L4().$$.on_mount.push(e)}function Io(e){L4().$$.on_destroy.push(e)}const sf=[],In=[];let pf=[];const d2=[],OU=Promise.resolve();let p2=!1;function FU(){p2||(p2=!0,OU.then(P4))}function yr(e){pf.push(e)}function Ki(e){d2.push(e)}const hy=new Set;let ef=0;function P4(){if(ef!==0)return;const e=Ip;do{try{for(;ef<sf.length;){const t=sf[ef];ef++,Ap(t),kU(t.$$)}}catch(t){throw sf.length=0,ef=0,t}for(Ap(null),sf.length=0,ef=0;In.length;)In.pop()();for(let t=0;t<pf.length;t+=1){const i=pf[t];hy.has(i)||(hy.add(i),i())}pf.length=0}while(sf.length);for(;d2.length;)d2.pop()();p2=!1,hy.clear(),Ap(e)}function kU(e){if(e.fragment!==null){e.update(),ji(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(yr)}}function UU(e){const t=[],i=[];pf.forEach(r=>e.indexOf(r)===-1?t.push(r):i.push(r)),i.forEach(r=>r()),pf=t}const WA=new Set;let Vu;function u1(){Vu={r:0,c:[],p:Vu}}function h1(){Vu.r||ji(Vu.c),Vu=Vu.p}function Nt(e,t){e&&e.i&&(WA.delete(e),e.i(t))}function Ot(e,t,i,r){if(e&&e.o){if(WA.has(e))return;WA.add(e),Vu.c.push(()=>{WA.delete(e),r&&(i&&e.d(1),r())}),e.o(t)}else r&&r()}function fn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Yi(e,t,i){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=i,i(e.$$.ctx[r]))}function Ut(e){e&&e.c()}function Ft(e,t,i){const{fragment:r,after_update:o}=e.$$;r&&r.m(t,i),yr(()=>{const a=e.$$.on_mount.map(R4).filter(Jf);e.$$.on_destroy?e.$$.on_destroy.push(...a):ji(a),e.$$.on_mount=[]}),o.forEach(yr)}function kt(e,t){const i=e.$$;i.fragment!==null&&(UU(i.after_update),ji(i.on_destroy),i.fragment&&i.fragment.d(t),i.on_destroy=i.fragment=null,i.ctx=[])}function GU(e,t){e.$$.dirty[0]===-1&&(sf.push(e),FU(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function di(e,t,i,r,o,a,h=null,u=[-1]){const p=Ip;Ap(e);const c=e.$$={fragment:null,ctx:[],props:a,update:gn,not_equal:o,bound:Gx(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(p?p.$$.context:[])),callbacks:Gx(),dirty:u,skip_bound:!1,root:t.target||p.$$.root};h&&h(c.root);let f=!1;if(c.ctx=i?i(e,t.props||{},(g,m,...v)=>{const A=v.length?v[0]:m;return c.ctx&&o(c.ctx[g],c.ctx[g]=A)&&(!c.skip_bound&&c.bound[g]&&c.bound[g](A),f&&GU(e,g)),m}):[],c.update(),f=!0,ji(c.before_update),c.fragment=r?r(c.ctx):!1,t.target){if(t.hydrate){const g=NU(t.target);c.fragment&&c.fragment.l(g),g.forEach(It)}else c.fragment&&c.fragment.c();t.intro&&Nt(e.$$.fragment),Ft(e,t.target,t.anchor),P4()}Ap(p)}class pi{constructor(){pr(this,"$$");pr(this,"$$set")}$destroy(){kt(this,1),this.$destroy=gn}$on(t,i){if(!Jf(i))return gn;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(i),()=>{const o=r.indexOf(i);o!==-1&&r.splice(o,1)}}$set(t){this.$$set&&!DU(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const VU="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(VU);function $d(e,t,i){const r=new URLSearchParams(e.location.search);r.set(t,i);const o=`${e.location.protocol}//${e.location.host}${e.location.pathname}?${r.toString()}`;e.history.pushState({path:o},"",o)}function QU(e,t){return new URLSearchParams(e.location.search).get(t)}function Vo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function am(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function f1(e){let t,i,r;e.length!==2?(t=Vo,i=(u,p)=>Vo(e(u),p),r=(u,p)=>e(u)-p):(t=e===Vo||e===am?e:HU,i=e,r=e);function o(u,p,c=0,f=u.length){if(c<f){if(t(p,p)!==0)return f;do{const g=c+f>>>1;i(u[g],p)<0?c=g+1:f=g}while(c<f)}return c}function a(u,p,c=0,f=u.length){if(c<f){if(t(p,p)!==0)return f;do{const g=c+f>>>1;i(u[g],p)<=0?c=g+1:f=g}while(c<f)}return c}function h(u,p,c=0,f=u.length){const g=o(u,p,c,f-1);return g>c&&r(u[g-1],p)>-r(u[g],p)?g-1:g}return{left:o,center:h,right:a}}function HU(){return 0}function D4(e){return e===null?NaN:+e}function*zU(e,t){if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(yield i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(r=+r)>=r&&(yield r)}}const jU=f1(Vo),lm=jU.right;f1(D4).center;function V_(e,t){let i=0;for(let r of e)r!=null&&(r=+r)>=r&&++i;return i}function WU(e){return e.length|0}function $U(e){return!(e>0)}function XU(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function KU(e){return t=>e(...t)}function YU(...e){const t=typeof e[e.length-1]=="function"&&KU(e.pop());e=e.map(XU);const i=e.map(WU),r=e.length-1,o=new Array(r+1).fill(0),a=[];if(r<0||i.some($U))return a;for(;;){a.push(o.map((u,p)=>e[p][u]));let h=r;for(;++o[h]===i[h];){if(h===0)return t?a.map(t):a;o[h--]=0}}}function qU(e,t){var i=0;return Float64Array.from(e,r=>i+=+r||0)}function N4(e,t){let i=0,r,o=0,a=0;if(t===void 0)for(let h of e)h!=null&&(h=+h)>=h&&(r=h-o,o+=r/++i,a+=r*(h-o));else{let h=-1;for(let u of e)(u=t(u,++h,e))!=null&&(u=+u)>=u&&(r=u-o,o+=r/++i,a+=r*(u-o))}if(i>1)return a/(i-1)}function O4(e,t){const i=N4(e,t);return i&&Math.sqrt(i)}function Ms(e,t){let i,r;if(t===void 0)for(const o of e)o!=null&&(i===void 0?o>=o&&(i=r=o):(i>o&&(i=o),r<o&&(r=o)));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(i===void 0?a>=a&&(i=r=a):(i>a&&(i=a),r<a&&(r=a)))}return[i,r]}class qu{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let r=0;for(let o=0;o<this._n&&o<32;o++){const a=i[o],h=t+a,u=Math.abs(t)<Math.abs(a)?t-(h-a):a-(h-t);u&&(i[r++]=u),t=h}return i[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let i=this._n,r,o,a,h=0;if(i>0){for(h=t[--i];i>0&&(r=h,o=t[--i],h=r+o,a=o-(h-r),!a););i>0&&(a<0&&t[i-1]<0||a>0&&t[i-1]>0)&&(o=a*2,r=h+o,o==r-h&&(h=r))}return h}}class Ju extends Map{constructor(t,i=U4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),t!=null)for(const[r,o]of t)this.set(r,o)}get(t){return super.get(m2(this,t))}has(t){return super.has(m2(this,t))}set(t,i){return super.set(F4(this,t),i)}delete(t){return super.delete(k4(this,t))}}class cm extends Set{constructor(t,i=U4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(m2(this,t))}add(t){return super.add(F4(this,t))}delete(t){return super.delete(k4(this,t))}}function m2({_intern:e,_key:t},i){const r=t(i);return e.has(r)?e.get(r):i}function F4({_intern:e,_key:t},i){const r=t(i);return e.has(r)?e.get(r):(e.set(r,i),i)}function k4({_intern:e,_key:t},i){const r=t(i);return e.has(r)&&(i=e.get(r),e.delete(r)),i}function U4(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Bp(e){return e}function d1(e,...t){return p1(e,Bp,Bp,t)}function Rp(e,...t){return p1(e,Array.from,Bp,t)}function mf(e,t,...i){return p1(e,Bp,t,i)}function JU(e,t,...i){return p1(e,Array.from,t,i)}function p1(e,t,i,r){return function o(a,h){if(h>=r.length)return i(a);const u=new Ju,p=r[h++];let c=-1;for(const f of a){const g=p(f,++c,a),m=u.get(g);m?m.push(f):u.set(g,[f])}for(const[f,g]of u)u.set(f,o(g,h));return t(u)}(e,0)}function ZU(e,t){return Array.from(t,i=>e[i])}function ug(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[i]=t;if(i&&i.length!==2||t.length>1){const r=Uint32Array.from(e,(o,a)=>a);return t.length>1?(t=t.map(o=>e.map(o)),r.sort((o,a)=>{for(const h of t){const u=hg(h[o],h[a]);if(u)return u}})):(i=e.map(i),r.sort((o,a)=>hg(i[o],i[a]))),ZU(e,r)}return e.sort(G4(i))}function G4(e=Vo){if(e===Vo)return hg;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,i)=>{const r=e(t,i);return r||r===0?r:(e(i,i)===0)-(e(t,t)===0)}}function hg(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function Q_(e,t,i){return(t.length!==2?ug(mf(e,t,i),([r,o],[a,h])=>Vo(o,h)||Vo(r,a)):ug(d1(e,i),([r,o],[a,h])=>t(o,h)||Vo(r,a))).map(([r])=>r)}var eG=Array.prototype,tG=eG.slice;function fy(e){return()=>e}const nG=Math.sqrt(50),iG=Math.sqrt(10),rG=Math.sqrt(2);function fg(e,t,i){const r=(t-e)/Math.max(0,i),o=Math.floor(Math.log10(r)),a=r/Math.pow(10,o),h=a>=nG?10:a>=iG?5:a>=rG?2:1;let u,p,c;return o<0?(c=Math.pow(10,-o)/h,u=Math.round(e*c),p=Math.round(t*c),u/c<e&&++u,p/c>t&&--p,c=-c):(c=Math.pow(10,o)*h,u=Math.round(e/c),p=Math.round(t/c),u*c<e&&++u,p*c>t&&--p),p<u&&.5<=i&&i<2?fg(e,t,i*2):[u,p,c]}function Mf(e,t,i){if(t=+t,e=+e,i=+i,!(i>0))return[];if(e===t)return[e];const r=t<e,[o,a,h]=r?fg(t,e,i):fg(e,t,i);if(!(a>=o))return[];const u=a-o+1,p=new Array(u);if(r)if(h<0)for(let c=0;c<u;++c)p[c]=(a-c)/-h;else for(let c=0;c<u;++c)p[c]=(a-c)*h;else if(h<0)for(let c=0;c<u;++c)p[c]=(o+c)/-h;else for(let c=0;c<u;++c)p[c]=(o+c)*h;return p}function Zu(e,t,i){return t=+t,e=+e,i=+i,fg(e,t,i)[2]}function A2(e,t,i){t=+t,e=+e,i=+i;const r=t<e,o=r?Zu(t,e,i):Zu(e,t,i);return(r?-1:1)*(o<0?1/-o:o)}function sG(e,t,i){let r;for(;;){const o=Zu(e,t,i);if(o===r||o===0||!isFinite(o))return[e,t];o>0?(e=Math.floor(e/o)*o,t=Math.ceil(t/o)*o):o<0&&(e=Math.ceil(e*o)/o,t=Math.floor(t*o)/o),r=o}}function V4(e){return Math.max(1,Math.ceil(Math.log(V_(e))/Math.LN2)+1)}function Q4(){var e=Bp,t=Ms,i=V4;function r(o){Array.isArray(o)||(o=Array.from(o));var a,h=o.length,u,p,c=new Array(h);for(a=0;a<h;++a)c[a]=e(o[a],a,o);var f=t(c),g=f[0],m=f[1],v=i(c,g,m);if(!Array.isArray(v)){const M=m,w=+v;if(t===Ms&&([g,m]=sG(g,m,w)),v=Mf(g,m,w),v[0]<=g&&(p=Zu(g,m,w)),v[v.length-1]>=m)if(M>=m&&t===Ms){const S=Zu(g,m,w);isFinite(S)&&(S>0?m=(Math.floor(m/S)+1)*S:S<0&&(m=(Math.ceil(m*-S)+1)/-S))}else v.pop()}for(var A=v.length,y=0,C=A;v[y]<=g;)++y;for(;v[C-1]>m;)--C;(y||C<A)&&(v=v.slice(y,C),A=C-y);var E=new Array(A+1),x;for(a=0;a<=A;++a)x=E[a]=[],x.x0=a>0?v[a-1]:g,x.x1=a<A?v[a]:m;if(isFinite(p)){if(p>0)for(a=0;a<h;++a)(u=c[a])!=null&&g<=u&&u<=m&&E[Math.min(A,Math.floor((u-g)/p))].push(o[a]);else if(p<0){for(a=0;a<h;++a)if((u=c[a])!=null&&g<=u&&u<=m){const M=Math.floor((g-u)*p);E[Math.min(A,M+(v[M]<=u))].push(o[a])}}}else for(a=0;a<h;++a)(u=c[a])!=null&&g<=u&&u<=m&&E[lm(v,u,0,A)].push(o[a]);return E}return r.value=function(o){return arguments.length?(e=typeof o=="function"?o:fy(o),r):e},r.domain=function(o){return arguments.length?(t=typeof o=="function"?o:fy([o[0],o[1]]),r):t},r.thresholds=function(o){return arguments.length?(i=typeof o=="function"?o:fy(Array.isArray(o)?tG.call(o):o),r):i},r}function Zr(e,t){let i;if(t===void 0)for(const r of e)r!=null&&(i<r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(i<o||i===void 0&&o>=o)&&(i=o)}return i}function oG(e,t){let i,r=-1,o=-1;if(t===void 0)for(const a of e)++o,a!=null&&(i<a||i===void 0&&a>=a)&&(i=a,r=o);else for(let a of e)(a=t(a,++o,e))!=null&&(i<a||i===void 0&&a>=a)&&(i=a,r=o);return r}function So(e,t){let i;if(t===void 0)for(const r of e)r!=null&&(i>r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(i>o||i===void 0&&o>=o)&&(i=o)}return i}function H_(e,t){let i,r=-1,o=-1;if(t===void 0)for(const a of e)++o,a!=null&&(i>a||i===void 0&&a>=a)&&(i=a,r=o);else for(let a of e)(a=t(a,++o,e))!=null&&(i>a||i===void 0&&a>=a)&&(i=a,r=o);return r}function H4(e,t,i=0,r=1/0,o){if(t=Math.floor(t),i=Math.floor(Math.max(0,i)),r=Math.floor(Math.min(e.length-1,r)),!(i<=t&&t<=r))return e;for(o=o===void 0?hg:G4(o);r>i;){if(r-i>600){const p=r-i+1,c=t-i+1,f=Math.log(p),g=.5*Math.exp(2*f/3),m=.5*Math.sqrt(f*g*(p-g)/p)*(c-p/2<0?-1:1),v=Math.max(i,Math.floor(t-c*g/p+m)),A=Math.min(r,Math.floor(t+(p-c)*g/p+m));H4(e,t,v,A,o)}const a=e[t];let h=i,u=r;for(Xd(e,i,t),o(e[r],a)>0&&Xd(e,i,r);h<u;){for(Xd(e,h,u),++h,--u;o(e[h],a)<0;)++h;for(;o(e[u],a)>0;)--u}o(e[i],a)===0?Xd(e,i,u):(++u,Xd(e,u,r)),u<=t&&(i=u+1),t<=u&&(r=u-1)}return e}function Xd(e,t,i){const r=e[t];e[t]=e[i],e[i]=r}function z4(e,t=Vo){let i,r=!1;if(t.length===1){let o;for(const a of e){const h=t(a);(r?Vo(h,o)>0:Vo(h,h)===0)&&(i=a,o=h,r=!0)}}else for(const o of e)(r?t(o,i)>0:t(o,o)===0)&&(i=o,r=!0);return i}function Sf(e,t,i){if(e=Float64Array.from(zU(e,i)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return So(e);if(t>=1)return Zr(e);var r,o=(r-1)*t,a=Math.floor(o),h=Zr(H4(e,a).subarray(0,a+1)),u=So(e.subarray(a+1));return h+(u-h)*(o-a)}}function aG(e,t,i=D4){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+i(e[0],0,e);if(t>=1)return+i(e[r-1],r-1,e);var r,o=(r-1)*t,a=Math.floor(o),h=+i(e[a],a,e),u=+i(e[a+1],a+1,e);return h+(u-h)*(o-a)}}function lG(e,t,i){const r=V_(e),o=Sf(e,.75)-Sf(e,.25);return r&&o?Math.ceil((i-t)/(2*o*Math.pow(r,-1/3))):1}function j4(e,t,i){const r=V_(e),o=O4(e);return r&&o?Math.ceil((i-t)*Math.cbrt(r)/(3.49*o)):1}function W4(e,t){let i=0,r=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(++i,r+=o);else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(++i,r+=a)}if(i)return r/i}function Lp(e,t){return Sf(e,.5,t)}function*cG(e){for(const t of e)yield*t}function $4(e){return Array.from(cG(e))}function uG(e,t){const i=new Ju;if(t===void 0)for(let a of e)a!=null&&a>=a&&i.set(a,(i.get(a)||0)+1);else{let a=-1;for(let h of e)(h=t(h,++a,e))!=null&&h>=h&&i.set(h,(i.get(h)||0)+1)}let r,o=0;for(const[a,h]of i)h>o&&(o=h,r=a);return r}function hG(e,t=fG){const i=[];let r,o=!1;for(const a of e)o&&i.push(t(r,a)),r=a,o=!0;return i}function fG(e,t){return[e,t]}function Mn(e,t,i){e=+e,t=+t,i=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+i;for(var r=-1,o=Math.max(0,Math.ceil((t-e)/i))|0,a=new Array(o);++r<o;)a[r]=e+r*i;return a}function Kc(e,t){let i=0;if(t===void 0)for(let r of e)(r=+r)&&(i+=r);else{let r=-1;for(let o of e)(o=+t(o,++r,e))&&(i+=o)}return i}function dg(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function Tf(e,...t){e=new cm(e);for(const i of t)for(const r of i)e.delete(r);return e}function dG(e){return e}var pG=3,Vx=1e-6;function mG(e){return"translate("+e+",0)"}function AG(e){return t=>+e(t)}function gG(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),i=>+e(i)+t}function vG(){return!this.__axis}function bG(e,t){var i=[],r=null,o=null,a=6,h=6,u=3,p=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=1,f="y",g=mG;function m(v){var A=r??(t.ticks?t.ticks.apply(t,i):t.domain()),y=o??(t.tickFormat?t.tickFormat.apply(t,i):dG),C=Math.max(a,0)+u,E=t.range(),x=+E[0]+p,M=+E[E.length-1]+p,w=(t.bandwidth?gG:AG)(t.copy(),p),S=v.selection?v.selection():v,I=S.selectAll(".domain").data([null]),L=S.selectAll(".tick").data(A,t).order(),R=L.exit(),k=L.enter().append("g").attr("class","tick"),P=L.select("line"),F=L.select("text");I=I.merge(I.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(k),P=P.merge(k.append("line").attr("stroke","currentColor").attr(f+"2",c*a)),F=F.merge(k.append("text").attr("fill","currentColor").attr(f,c*C).attr("dy","0.71em")),v!==S&&(I=I.transition(v),L=L.transition(v),P=P.transition(v),F=F.transition(v),R=R.transition(v).attr("opacity",Vx).attr("transform",function(O){return isFinite(O=w(O))?g(O+p):this.getAttribute("transform")}),k.attr("opacity",Vx).attr("transform",function(O){var W=this.parentNode.__axis;return g((W&&isFinite(W=W(O))?W:w(O))+p)})),R.remove(),I.attr("d",h?"M"+x+","+c*h+"V"+p+"H"+M+"V"+c*h:"M"+x+","+p+"H"+M),L.attr("opacity",1).attr("transform",function(O){return g(w(O)+p)}),P.attr(f+"2",c*a),F.attr(f,c*C).text(y),S.filter(vG).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),S.each(function(){this.__axis=w})}return m.scale=function(v){return arguments.length?(t=v,m):t},m.ticks=function(){return i=Array.from(arguments),m},m.tickArguments=function(v){return arguments.length?(i=v==null?[]:Array.from(v),m):i.slice()},m.tickValues=function(v){return arguments.length?(r=v==null?null:Array.from(v),m):r&&r.slice()},m.tickFormat=function(v){return arguments.length?(o=v,m):o},m.tickSize=function(v){return arguments.length?(a=h=+v,m):a},m.tickSizeInner=function(v){return arguments.length?(a=+v,m):a},m.tickSizeOuter=function(v){return arguments.length?(h=+v,m):h},m.tickPadding=function(v){return arguments.length?(u=+v,m):u},m.offset=function(v){return arguments.length?(p=+v,m):p},m}function yG(e){return bG(pG,e)}var _G={value:()=>{}};function X4(){for(var e=0,t=arguments.length,i={},r;e<t;++e){if(!(r=arguments[e]+"")||r in i||/[\s.]/.test(r))throw new Error("illegal type: "+r);i[r]=[]}return new $A(i)}function $A(e){this._=e}function EG(e,t){return e.trim().split(/^|\s+/).map(function(i){var r="",o=i.indexOf(".");if(o>=0&&(r=i.slice(o+1),i=i.slice(0,o)),i&&!t.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:r}})}$A.prototype=X4.prototype={constructor:$A,on:function(e,t){var i=this._,r=EG(e+"",i),o,a=-1,h=r.length;if(arguments.length<2){for(;++a<h;)if((o=(e=r[a]).type)&&(o=wG(i[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<h;)if(o=(e=r[a]).type)i[o]=Qx(i[o],e.name,t);else if(t==null)for(o in i)i[o]=Qx(i[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var i in t)e[i]=t[i].slice();return new $A(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var i=new Array(o),r=0,o,a;r<o;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,o=a.length;r<o;++r)a[r].value.apply(t,i)},apply:function(e,t,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,a=r.length;o<a;++o)r[o].value.apply(t,i)}};function wG(e,t){for(var i=0,r=e.length,o;i<r;++i)if((o=e[i]).name===t)return o.value}function Qx(e,t,i){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=_G,e=e.slice(0,r).concat(e.slice(r+1));break}return i!=null&&e.push({name:t,value:i}),e}var g2="http://www.w3.org/1999/xhtml";const If={svg:"http://www.w3.org/2000/svg",xhtml:g2,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function m1(e){var t=e+="",i=t.indexOf(":");return i>=0&&(t=e.slice(0,i))!=="xmlns"&&(e=e.slice(i+1)),If.hasOwnProperty(t)?{space:If[t],local:e}:e}function CG(e){return function(){var t=this.ownerDocument,i=this.namespaceURI;return i===g2&&t.documentElement.namespaceURI===g2?t.createElement(e):t.createElementNS(i,e)}}function xG(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function A1(e){var t=m1(e);return(t.local?xG:CG)(t)}function MG(){}function z_(e){return e==null?MG:function(){return this.querySelector(e)}}function SG(e){typeof e!="function"&&(e=z_(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],h=a.length,u=r[o]=new Array(h),p,c,f=0;f<h;++f)(p=a[f])&&(c=e.call(p,p.__data__,f,a))&&("__data__"in p&&(c.__data__=p.__data__),u[f]=c);return new oa(r,this._parents)}function TG(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function IG(){return[]}function K4(e){return e==null?IG:function(){return this.querySelectorAll(e)}}function BG(e){return function(){return TG(e.apply(this,arguments))}}function RG(e){typeof e=="function"?e=BG(e):e=K4(e);for(var t=this._groups,i=t.length,r=[],o=[],a=0;a<i;++a)for(var h=t[a],u=h.length,p,c=0;c<u;++c)(p=h[c])&&(r.push(e.call(p,p.__data__,c,h)),o.push(p));return new oa(r,o)}function Y4(e){return function(){return this.matches(e)}}function q4(e){return function(t){return t.matches(e)}}var LG=Array.prototype.find;function PG(e){return function(){return LG.call(this.children,e)}}function DG(){return this.firstElementChild}function NG(e){return this.select(e==null?DG:PG(typeof e=="function"?e:q4(e)))}var OG=Array.prototype.filter;function FG(){return Array.from(this.children)}function kG(e){return function(){return OG.call(this.children,e)}}function UG(e){return this.selectAll(e==null?FG:kG(typeof e=="function"?e:q4(e)))}function GG(e){typeof e!="function"&&(e=Y4(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],h=a.length,u=r[o]=[],p,c=0;c<h;++c)(p=a[c])&&e.call(p,p.__data__,c,a)&&u.push(p);return new oa(r,this._parents)}function J4(e){return new Array(e.length)}function VG(){return new oa(this._enter||this._groups.map(J4),this._parents)}function pg(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}pg.prototype={constructor:pg,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function QG(e){return function(){return e}}function HG(e,t,i,r,o,a){for(var h=0,u,p=t.length,c=a.length;h<c;++h)(u=t[h])?(u.__data__=a[h],r[h]=u):i[h]=new pg(e,a[h]);for(;h<p;++h)(u=t[h])&&(o[h]=u)}function zG(e,t,i,r,o,a,h){var u,p,c=new Map,f=t.length,g=a.length,m=new Array(f),v;for(u=0;u<f;++u)(p=t[u])&&(m[u]=v=h.call(p,p.__data__,u,t)+"",c.has(v)?o[u]=p:c.set(v,p));for(u=0;u<g;++u)v=h.call(e,a[u],u,a)+"",(p=c.get(v))?(r[u]=p,p.__data__=a[u],c.delete(v)):i[u]=new pg(e,a[u]);for(u=0;u<f;++u)(p=t[u])&&c.get(m[u])===p&&(o[u]=p)}function jG(e){return e.__data__}function WG(e,t){if(!arguments.length)return Array.from(this,jG);var i=t?zG:HG,r=this._parents,o=this._groups;typeof e!="function"&&(e=QG(e));for(var a=o.length,h=new Array(a),u=new Array(a),p=new Array(a),c=0;c<a;++c){var f=r[c],g=o[c],m=g.length,v=$G(e.call(f,f&&f.__data__,c,r)),A=v.length,y=u[c]=new Array(A),C=h[c]=new Array(A),E=p[c]=new Array(m);i(f,g,y,C,E,v,t);for(var x=0,M=0,w,S;x<A;++x)if(w=y[x]){for(x>=M&&(M=x+1);!(S=C[M])&&++M<A;);w._next=S||null}}return h=new oa(h,r),h._enter=u,h._exit=p,h}function $G(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function XG(){return new oa(this._exit||this._groups.map(J4),this._parents)}function KG(e,t,i){var r=this.enter(),o=this,a=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),i==null?a.remove():i(a),r&&o?r.merge(o).order():o}function YG(e){for(var t=e.selection?e.selection():e,i=this._groups,r=t._groups,o=i.length,a=r.length,h=Math.min(o,a),u=new Array(o),p=0;p<h;++p)for(var c=i[p],f=r[p],g=c.length,m=u[p]=new Array(g),v,A=0;A<g;++A)(v=c[A]||f[A])&&(m[A]=v);for(;p<o;++p)u[p]=i[p];return new oa(u,this._parents)}function qG(){for(var e=this._groups,t=-1,i=e.length;++t<i;)for(var r=e[t],o=r.length-1,a=r[o],h;--o>=0;)(h=r[o])&&(a&&h.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(h,a),a=h);return this}function JG(e){e||(e=ZG);function t(g,m){return g&&m?e(g.__data__,m.__data__):!g-!m}for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a){for(var h=i[a],u=h.length,p=o[a]=new Array(u),c,f=0;f<u;++f)(c=h[f])&&(p[f]=c);p.sort(t)}return new oa(o,this._parents).order()}function ZG(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function eV(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function tV(){return Array.from(this)}function nV(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var r=e[t],o=0,a=r.length;o<a;++o){var h=r[o];if(h)return h}return null}function iV(){let e=0;for(const t of this)++e;return e}function rV(){return!this.node()}function sV(e){for(var t=this._groups,i=0,r=t.length;i<r;++i)for(var o=t[i],a=0,h=o.length,u;a<h;++a)(u=o[a])&&e.call(u,u.__data__,a,o);return this}function oV(e){return function(){this.removeAttribute(e)}}function aV(e){return function(){this.removeAttributeNS(e.space,e.local)}}function lV(e,t){return function(){this.setAttribute(e,t)}}function cV(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function uV(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttribute(e):this.setAttribute(e,i)}}function hV(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}}function fV(e,t){var i=m1(e);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((t==null?i.local?aV:oV:typeof t=="function"?i.local?hV:uV:i.local?cV:lV)(i,t))}function Z4(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function dV(e){return function(){this.style.removeProperty(e)}}function pV(e,t,i){return function(){this.style.setProperty(e,t,i)}}function mV(e,t,i){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,i)}}function AV(e,t,i){return arguments.length>1?this.each((t==null?dV:typeof t=="function"?mV:pV)(e,t,i??"")):Bf(this.node(),e)}function Bf(e,t){return e.style.getPropertyValue(t)||Z4(e).getComputedStyle(e,null).getPropertyValue(t)}function gV(e){return function(){delete this[e]}}function vV(e,t){return function(){this[e]=t}}function bV(e,t){return function(){var i=t.apply(this,arguments);i==null?delete this[e]:this[e]=i}}function yV(e,t){return arguments.length>1?this.each((t==null?gV:typeof t=="function"?bV:vV)(e,t)):this.node()[e]}function eB(e){return e.trim().split(/^|\s+/)}function j_(e){return e.classList||new tB(e)}function tB(e){this._node=e,this._names=eB(e.getAttribute("class")||"")}tB.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function nB(e,t){for(var i=j_(e),r=-1,o=t.length;++r<o;)i.add(t[r])}function iB(e,t){for(var i=j_(e),r=-1,o=t.length;++r<o;)i.remove(t[r])}function _V(e){return function(){nB(this,e)}}function EV(e){return function(){iB(this,e)}}function wV(e,t){return function(){(t.apply(this,arguments)?nB:iB)(this,e)}}function CV(e,t){var i=eB(e+"");if(arguments.length<2){for(var r=j_(this.node()),o=-1,a=i.length;++o<a;)if(!r.contains(i[o]))return!1;return!0}return this.each((typeof t=="function"?wV:t?_V:EV)(i,t))}function xV(){this.textContent=""}function MV(e){return function(){this.textContent=e}}function SV(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function TV(e){return arguments.length?this.each(e==null?xV:(typeof e=="function"?SV:MV)(e)):this.node().textContent}function IV(){this.innerHTML=""}function BV(e){return function(){this.innerHTML=e}}function RV(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function LV(e){return arguments.length?this.each(e==null?IV:(typeof e=="function"?RV:BV)(e)):this.node().innerHTML}function PV(){this.nextSibling&&this.parentNode.appendChild(this)}function DV(){return this.each(PV)}function NV(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function OV(){return this.each(NV)}function FV(e){var t=typeof e=="function"?e:A1(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function kV(){return null}function UV(e,t){var i=typeof e=="function"?e:A1(e),r=t==null?kV:typeof t=="function"?t:z_(t);return this.select(function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)})}function GV(){var e=this.parentNode;e&&e.removeChild(this)}function VV(){return this.each(GV)}function QV(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function HV(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function zV(e){return this.select(e?HV:QV)}function jV(e){return arguments.length?this.property("__data__",e):this.node().__data__}function WV(e){return function(t){e.call(this,t,this.__data__)}}function $V(e){return e.trim().split(/^|\s+/).map(function(t){var i="",r=t.indexOf(".");return r>=0&&(i=t.slice(r+1),t=t.slice(0,r)),{type:t,name:i}})}function XV(e){return function(){var t=this.__on;if(t){for(var i=0,r=-1,o=t.length,a;i<o;++i)a=t[i],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function KV(e,t,i){return function(){var r=this.__on,o,a=WV(t);if(r){for(var h=0,u=r.length;h<u;++h)if((o=r[h]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=i),o.value=t;return}}this.addEventListener(e.type,a,i),o={type:e.type,name:e.name,value:t,listener:a,options:i},r?r.push(o):this.__on=[o]}}function YV(e,t,i){var r=$V(e+""),o,a=r.length,h;if(arguments.length<2){var u=this.node().__on;if(u){for(var p=0,c=u.length,f;p<c;++p)for(o=0,f=u[p];o<a;++o)if((h=r[o]).type===f.type&&h.name===f.name)return f.value}return}for(u=t?KV:XV,o=0;o<a;++o)this.each(u(r[o],t,i));return this}function rB(e,t,i){var r=Z4(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,i):(o=r.document.createEvent("Event"),i?(o.initEvent(t,i.bubbles,i.cancelable),o.detail=i.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function qV(e,t){return function(){return rB(this,e,t)}}function JV(e,t){return function(){return rB(this,e,t.apply(this,arguments))}}function ZV(e,t){return this.each((typeof t=="function"?JV:qV)(e,t))}function*eQ(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var r=e[t],o=0,a=r.length,h;o<a;++o)(h=r[o])&&(yield h)}var sB=[null];function oa(e,t){this._groups=e,this._parents=t}function um(){return new oa([[document.documentElement]],sB)}function tQ(){return this}oa.prototype=um.prototype={constructor:oa,select:SG,selectAll:RG,selectChild:NG,selectChildren:UG,filter:GG,data:WG,enter:VG,exit:XG,join:KG,merge:YG,selection:tQ,order:qG,sort:JG,call:eV,nodes:tV,node:nV,size:iV,empty:rV,each:sV,attr:fV,style:AV,property:yV,classed:CV,text:TV,html:LV,raise:DV,lower:OV,append:FV,insert:UV,remove:VV,clone:zV,datum:jV,on:YV,dispatch:ZV,[Symbol.iterator]:eQ};function gp(e){return typeof e=="string"?new oa([[document.querySelector(e)]],[document.documentElement]):new oa([[e]],sB)}function nQ(e){let t;for(;t=e.sourceEvent;)e=t;return e}function iQ(e,t){if(e=nQ(e),t===void 0&&(t=e.currentTarget),t){var i=t.ownerSVGElement||t;if(i.createSVGPoint){var r=i.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}function ed(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function hm(e,t){var i=Object.create(e.prototype);for(var r in t)i[r]=t[r];return i}function iu(){}var eh=.7,Rf=1/eh,Af="\\s*([+-]?\\d+)\\s*",Pp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rQ=/^#([0-9a-f]{3,8})$/,sQ=new RegExp(`^rgb\\(${Af},${Af},${Af}\\)$`),oQ=new RegExp(`^rgb\\(${yl},${yl},${yl}\\)$`),aQ=new RegExp(`^rgba\\(${Af},${Af},${Af},${Pp}\\)$`),lQ=new RegExp(`^rgba\\(${yl},${yl},${yl},${Pp}\\)$`),cQ=new RegExp(`^hsl\\(${Pp},${yl},${yl}\\)$`),uQ=new RegExp(`^hsla\\(${Pp},${yl},${yl},${Pp}\\)$`),Hx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ed(iu,Yc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:zx,formatHex:zx,formatHex8:hQ,formatHsl:fQ,formatRgb:jx,toString:jx});function zx(){return this.rgb().formatHex()}function hQ(){return this.rgb().formatHex8()}function fQ(){return oB(this).formatHsl()}function jx(){return this.rgb().formatRgb()}function Yc(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=rQ.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?Wx(t):i===3?new $s(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?xA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?xA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=sQ.exec(e))?new $s(t[1],t[2],t[3],1):(t=oQ.exec(e))?new $s(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=aQ.exec(e))?xA(t[1],t[2],t[3],t[4]):(t=lQ.exec(e))?xA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=cQ.exec(e))?Kx(t[1],t[2]/100,t[3]/100,1):(t=uQ.exec(e))?Kx(t[1],t[2]/100,t[3]/100,t[4]):Hx.hasOwnProperty(e)?Wx(Hx[e]):e==="transparent"?new $s(NaN,NaN,NaN,0):null}function Wx(e){return new $s(e>>16&255,e>>8&255,e&255,1)}function xA(e,t,i,r){return r<=0&&(e=t=i=NaN),new $s(e,t,i,r)}function W_(e){return e instanceof iu||(e=Yc(e)),e?(e=e.rgb(),new $s(e.r,e.g,e.b,e.opacity)):new $s}function qc(e,t,i,r){return arguments.length===1?W_(e):new $s(e,t,i,r??1)}function $s(e,t,i,r){this.r=+e,this.g=+t,this.b=+i,this.opacity=+r}ed($s,qc,hm(iu,{brighter(e){return e=e==null?Rf:Math.pow(Rf,e),new $s(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?eh:Math.pow(eh,e),new $s(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $s($u(this.r),$u(this.g),$u(this.b),mg(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$x,formatHex:$x,formatHex8:dQ,formatRgb:Xx,toString:Xx}));function $x(){return`#${Qu(this.r)}${Qu(this.g)}${Qu(this.b)}`}function dQ(){return`#${Qu(this.r)}${Qu(this.g)}${Qu(this.b)}${Qu((isNaN(this.opacity)?1:this.opacity)*255)}`}function Xx(){const e=mg(this.opacity);return`${e===1?"rgb(":"rgba("}${$u(this.r)}, ${$u(this.g)}, ${$u(this.b)}${e===1?")":`, ${e})`}`}function mg(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $u(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qu(e){return e=$u(e),(e<16?"0":"")+e.toString(16)}function Kx(e,t,i,r){return r<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new za(e,t,i,r)}function oB(e){if(e instanceof za)return new za(e.h,e.s,e.l,e.opacity);if(e instanceof iu||(e=Yc(e)),!e)return new za;if(e instanceof za)return e;e=e.rgb();var t=e.r/255,i=e.g/255,r=e.b/255,o=Math.min(t,i,r),a=Math.max(t,i,r),h=NaN,u=a-o,p=(a+o)/2;return u?(t===a?h=(i-r)/u+(i<r)*6:i===a?h=(r-t)/u+2:h=(t-i)/u+4,u/=p<.5?a+o:2-a-o,h*=60):u=p>0&&p<1?0:h,new za(h,u,p,e.opacity)}function v2(e,t,i,r){return arguments.length===1?oB(e):new za(e,t,i,r??1)}function za(e,t,i,r){this.h=+e,this.s=+t,this.l=+i,this.opacity=+r}ed(za,v2,hm(iu,{brighter(e){return e=e==null?Rf:Math.pow(Rf,e),new za(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?eh:Math.pow(eh,e),new za(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*t,o=2*i-r;return new $s(dy(e>=240?e-240:e+120,o,r),dy(e,o,r),dy(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new za(Yx(this.h),MA(this.s),MA(this.l),mg(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=mg(this.opacity);return`${e===1?"hsl(":"hsla("}${Yx(this.h)}, ${MA(this.s)*100}%, ${MA(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Yx(e){return e=(e||0)%360,e<0?e+360:e}function MA(e){return Math.max(0,Math.min(1,e||0))}function dy(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}const aB=Math.PI/180,lB=180/Math.PI,Ag=18,cB=.96422,uB=1,hB=.82521,fB=4/29,gf=6/29,dB=3*gf*gf,pQ=gf*gf*gf;function pB(e){if(e instanceof _l)return new _l(e.l,e.a,e.b,e.opacity);if(e instanceof sc)return mB(e);e instanceof $s||(e=W_(e));var t=gy(e.r),i=gy(e.g),r=gy(e.b),o=py((.2225045*t+.7168786*i+.0606169*r)/uB),a,h;return t===i&&i===r?a=h=o:(a=py((.4360747*t+.3850649*i+.1430804*r)/cB),h=py((.0139322*t+.0971045*i+.7141733*r)/hB)),new _l(116*o-16,500*(a-o),200*(o-h),e.opacity)}function b2(e,t,i,r){return arguments.length===1?pB(e):new _l(e,t,i,r??1)}function _l(e,t,i,r){this.l=+e,this.a=+t,this.b=+i,this.opacity=+r}ed(_l,b2,hm(iu,{brighter(e){return new _l(this.l+Ag*(e??1),this.a,this.b,this.opacity)},darker(e){return new _l(this.l-Ag*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,i=isNaN(this.b)?e:e-this.b/200;return t=cB*my(t),e=uB*my(e),i=hB*my(i),new $s(Ay(3.1338561*t-1.6168667*e-.4906146*i),Ay(-.9787684*t+1.9161415*e+.033454*i),Ay(.0719453*t-.2289914*e+1.4052427*i),this.opacity)}}));function py(e){return e>pQ?Math.pow(e,1/3):e/dB+fB}function my(e){return e>gf?e*e*e:dB*(e-fB)}function Ay(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function gy(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function mQ(e){if(e instanceof sc)return new sc(e.h,e.c,e.l,e.opacity);if(e instanceof _l||(e=pB(e)),e.a===0&&e.b===0)return new sc(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*lB;return new sc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function y2(e,t,i,r){return arguments.length===1?mQ(e):new sc(e,t,i,r??1)}function sc(e,t,i,r){this.h=+e,this.c=+t,this.l=+i,this.opacity=+r}function mB(e){if(isNaN(e.h))return new _l(e.l,0,0,e.opacity);var t=e.h*aB;return new _l(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}ed(sc,y2,hm(iu,{brighter(e){return new sc(this.h,this.c,this.l+Ag*(e??1),this.opacity)},darker(e){return new sc(this.h,this.c,this.l-Ag*(e??1),this.opacity)},rgb(){return mB(this).rgb()}}));var AB=-.14861,$_=1.78277,X_=-.29227,g1=-.90649,Dp=1.97294,qx=Dp*g1,Jx=Dp*$_,Zx=$_*X_-g1*AB;function AQ(e){if(e instanceof Xu)return new Xu(e.h,e.s,e.l,e.opacity);e instanceof $s||(e=W_(e));var t=e.r/255,i=e.g/255,r=e.b/255,o=(Zx*r+qx*t-Jx*i)/(Zx+qx-Jx),a=r-o,h=(Dp*(i-o)-X_*a)/g1,u=Math.sqrt(h*h+a*a)/(Dp*o*(1-o)),p=u?Math.atan2(h,a)*lB-120:NaN;return new Xu(p<0?p+360:p,u,o,e.opacity)}function wl(e,t,i,r){return arguments.length===1?AQ(e):new Xu(e,t,i,r??1)}function Xu(e,t,i,r){this.h=+e,this.s=+t,this.l=+i,this.opacity=+r}ed(Xu,wl,hm(iu,{brighter(e){return e=e==null?Rf:Math.pow(Rf,e),new Xu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?eh:Math.pow(eh,e),new Xu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*aB,t=+this.l,i=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),o=Math.sin(e);return new $s(255*(t+i*(AB*r+$_*o)),255*(t+i*(X_*r+g1*o)),255*(t+i*(Dp*r)),this.opacity)}}));function gQ(e,t,i,r,o){var a=e*e,h=a*e;return((1-3*e+3*a-h)*t+(4-6*a+3*h)*i+(1+3*e+3*a-3*h)*r+h*o)/6}function vQ(e){var t=e.length-1;return function(i){var r=i<=0?i=0:i>=1?(i=1,t-1):Math.floor(i*t),o=e[r],a=e[r+1],h=r>0?e[r-1]:2*o-a,u=r<t-1?e[r+2]:2*a-o;return gQ((i-r/t)*t,h,o,a,u)}}const v1=e=>()=>e;function gB(e,t){return function(i){return e+i*t}}function bQ(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(r){return Math.pow(e+r*t,i)}}function K_(e,t){var i=t-e;return i?gB(e,i>180||i<-180?i-360*Math.round(i/360):i):v1(isNaN(e)?t:e)}function yQ(e){return(e=+e)==1?fo:function(t,i){return i-t?bQ(t,i,e):v1(isNaN(t)?i:t)}}function fo(e,t){var i=t-e;return i?gB(e,i):v1(isNaN(e)?t:e)}const th=function e(t){var i=yQ(t);function r(o,a){var h=i((o=qc(o)).r,(a=qc(a)).r),u=i(o.g,a.g),p=i(o.b,a.b),c=fo(o.opacity,a.opacity);return function(f){return o.r=h(f),o.g=u(f),o.b=p(f),o.opacity=c(f),o+""}}return r.gamma=e,r}(1);function _Q(e){return function(t){var i=t.length,r=new Array(i),o=new Array(i),a=new Array(i),h,u;for(h=0;h<i;++h)u=qc(t[h]),r[h]=u.r||0,o[h]=u.g||0,a[h]=u.b||0;return r=e(r),o=e(o),a=e(a),u.opacity=1,function(p){return u.r=r(p),u.g=o(p),u.b=a(p),u+""}}}var EQ=_Q(vQ);function wQ(e,t){t||(t=[]);var i=e?Math.min(t.length,e.length):0,r=t.slice(),o;return function(a){for(o=0;o<i;++o)r[o]=e[o]*(1-a)+t[o]*a;return r}}function CQ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xQ(e,t){var i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),a=new Array(i),h;for(h=0;h<r;++h)o[h]=fm(e[h],t[h]);for(;h<i;++h)a[h]=t[h];return function(u){for(h=0;h<r;++h)a[h]=o[h](u);return a}}function MQ(e,t){var i=new Date;return e=+e,t=+t,function(r){return i.setTime(e*(1-r)+t*r),i}}function uo(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function SQ(e,t){var i={},r={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?i[o]=fm(e[o],t[o]):r[o]=t[o];return function(a){for(o in i)r[o]=i[o](a);return r}}var _2=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vy=new RegExp(_2.source,"g");function TQ(e){return function(){return e}}function IQ(e){return function(t){return e(t)+""}}function vB(e,t){var i=_2.lastIndex=vy.lastIndex=0,r,o,a,h=-1,u=[],p=[];for(e=e+"",t=t+"";(r=_2.exec(e))&&(o=vy.exec(t));)(a=o.index)>i&&(a=t.slice(i,a),u[h]?u[h]+=a:u[++h]=a),(r=r[0])===(o=o[0])?u[h]?u[h]+=o:u[++h]=o:(u[++h]=null,p.push({i:h,x:uo(r,o)})),i=vy.lastIndex;return i<t.length&&(a=t.slice(i),u[h]?u[h]+=a:u[++h]=a),u.length<2?p[0]?IQ(p[0].x):TQ(t):(t=p.length,function(c){for(var f=0,g;f<t;++f)u[(g=p[f]).i]=g.x(c);return u.join("")})}function fm(e,t){var i=typeof t,r;return t==null||i==="boolean"?v1(t):(i==="number"?uo:i==="string"?(r=Yc(t))?(t=r,th):vB:t instanceof Yc?th:t instanceof Date?MQ:CQ(t)?wQ:Array.isArray(t)?xQ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?SQ:uo)(e,t)}function Y_(e,t){return e=+e,t=+t,function(i){return Math.round(e*(1-i)+t*i)}}var eM=180/Math.PI,E2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bB(e,t,i,r,o,a){var h,u,p;return(h=Math.sqrt(e*e+t*t))&&(e/=h,t/=h),(p=e*i+t*r)&&(i-=e*p,r-=t*p),(u=Math.sqrt(i*i+r*r))&&(i/=u,r/=u,p/=u),e*r<t*i&&(e=-e,t=-t,p=-p,h=-h),{translateX:o,translateY:a,rotate:Math.atan2(t,e)*eM,skewX:Math.atan(p)*eM,scaleX:h,scaleY:u}}var SA;function BQ(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?E2:bB(t.a,t.b,t.c,t.d,t.e,t.f)}function RQ(e){return e==null||(SA||(SA=document.createElementNS("http://www.w3.org/2000/svg","g")),SA.setAttribute("transform",e),!(e=SA.transform.baseVal.consolidate()))?E2:(e=e.matrix,bB(e.a,e.b,e.c,e.d,e.e,e.f))}function yB(e,t,i,r){function o(c){return c.length?c.pop()+" ":""}function a(c,f,g,m,v,A){if(c!==g||f!==m){var y=v.push("translate(",null,t,null,i);A.push({i:y-4,x:uo(c,g)},{i:y-2,x:uo(f,m)})}else(g||m)&&v.push("translate("+g+t+m+i)}function h(c,f,g,m){c!==f?(c-f>180?f+=360:f-c>180&&(c+=360),m.push({i:g.push(o(g)+"rotate(",null,r)-2,x:uo(c,f)})):f&&g.push(o(g)+"rotate("+f+r)}function u(c,f,g,m){c!==f?m.push({i:g.push(o(g)+"skewX(",null,r)-2,x:uo(c,f)}):f&&g.push(o(g)+"skewX("+f+r)}function p(c,f,g,m,v,A){if(c!==g||f!==m){var y=v.push(o(v)+"scale(",null,",",null,")");A.push({i:y-4,x:uo(c,g)},{i:y-2,x:uo(f,m)})}else(g!==1||m!==1)&&v.push(o(v)+"scale("+g+","+m+")")}return function(c,f){var g=[],m=[];return c=e(c),f=e(f),a(c.translateX,c.translateY,f.translateX,f.translateY,g,m),h(c.rotate,f.rotate,g,m),u(c.skewX,f.skewX,g,m),p(c.scaleX,c.scaleY,f.scaleX,f.scaleY,g,m),c=f=null,function(v){for(var A=-1,y=m.length,C;++A<y;)g[(C=m[A]).i]=C.x(v);return g.join("")}}}var LQ=yB(BQ,"px, ","px)","deg)"),PQ=yB(RQ,", ",")",")");function DQ(e){return function(t,i){var r=e((t=v2(t)).h,(i=v2(i)).h),o=fo(t.s,i.s),a=fo(t.l,i.l),h=fo(t.opacity,i.opacity);return function(u){return t.h=r(u),t.s=o(u),t.l=a(u),t.opacity=h(u),t+""}}}const NQ=DQ(K_);function OQ(e,t){var i=fo((e=b2(e)).l,(t=b2(t)).l),r=fo(e.a,t.a),o=fo(e.b,t.b),a=fo(e.opacity,t.opacity);return function(h){return e.l=i(h),e.a=r(h),e.b=o(h),e.opacity=a(h),e+""}}function FQ(e){return function(t,i){var r=e((t=y2(t)).h,(i=y2(i)).h),o=fo(t.c,i.c),a=fo(t.l,i.l),h=fo(t.opacity,i.opacity);return function(u){return t.h=r(u),t.c=o(u),t.l=a(u),t.opacity=h(u),t+""}}}const kQ=FQ(K_);function _B(e){return function t(i){i=+i;function r(o,a){var h=e((o=wl(o)).h,(a=wl(a)).h),u=fo(o.s,a.s),p=fo(o.l,a.l),c=fo(o.opacity,a.opacity);return function(f){return o.h=h(f),o.s=u(f),o.l=p(Math.pow(f,i)),o.opacity=c(f),o+""}}return r.gamma=t,r}(1)}_B(K_);var q_=_B(fo);function b1(e,t){t===void 0&&(t=e,e=fm);for(var i=0,r=t.length-1,o=t[0],a=new Array(r<0?0:r);i<r;)a[i]=e(o,o=t[++i]);return function(h){var u=Math.max(0,Math.min(r-1,Math.floor(h*=r)));return a[u](h-u)}}function Ka(e,t){for(var i=new Array(t),r=0;r<t;++r)i[r]=e(r/(t-1));return i}var Lf=0,ip=0,Kd=0,EB=1e3,gg,rp,vg=0,nh=0,y1=0,Np=typeof performance=="object"&&performance.now?performance:Date,wB=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function J_(){return nh||(wB(UQ),nh=Np.now()+y1)}function UQ(){nh=0}function bg(){this._call=this._time=this._next=null}bg.prototype=CB.prototype={constructor:bg,restart:function(e,t,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?J_():+i)+(t==null?0:+t),!this._next&&rp!==this&&(rp?rp._next=this:gg=this,rp=this),this._call=e,this._time=i,w2()},stop:function(){this._call&&(this._call=null,this._time=1/0,w2())}};function CB(e,t,i){var r=new bg;return r.restart(e,t,i),r}function GQ(){J_(),++Lf;for(var e=gg,t;e;)(t=nh-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Lf}function tM(){nh=(vg=Np.now())+y1,Lf=ip=0;try{GQ()}finally{Lf=0,QQ(),nh=0}}function VQ(){var e=Np.now(),t=e-vg;t>EB&&(y1-=t,vg=e)}function QQ(){for(var e,t=gg,i,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(i=t._next,t._next=null,t=e?e._next=i:gg=i);rp=e,w2(r)}function w2(e){if(!Lf){ip&&(ip=clearTimeout(ip));var t=e-nh;t>24?(e<1/0&&(ip=setTimeout(tM,e-Np.now()-y1)),Kd&&(Kd=clearInterval(Kd))):(Kd||(vg=Np.now(),Kd=setInterval(VQ,EB)),Lf=1,wB(tM))}}function nM(e,t,i){var r=new bg;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,i),r}var HQ=X4("start","end","cancel","interrupt"),zQ=[],xB=0,iM=1,C2=2,XA=3,rM=4,x2=5,KA=6;function _1(e,t,i,r,o,a){var h=e.__transition;if(!h)e.__transition={};else if(i in h)return;jQ(e,i,{name:t,index:r,group:o,on:HQ,tween:zQ,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:xB})}function Z_(e,t){var i=el(e,t);if(i.state>xB)throw new Error("too late; already scheduled");return i}function Ml(e,t){var i=el(e,t);if(i.state>XA)throw new Error("too late; already running");return i}function el(e,t){var i=e.__transition;if(!i||!(i=i[t]))throw new Error("transition not found");return i}function jQ(e,t,i){var r=e.__transition,o;r[t]=i,i.timer=CB(a,0,i.time);function a(c){i.state=iM,i.timer.restart(h,i.delay,i.time),i.delay<=c&&h(c-i.delay)}function h(c){var f,g,m,v;if(i.state!==iM)return p();for(f in r)if(v=r[f],v.name===i.name){if(v.state===XA)return nM(h);v.state===rM?(v.state=KA,v.timer.stop(),v.on.call("interrupt",e,e.__data__,v.index,v.group),delete r[f]):+f<t&&(v.state=KA,v.timer.stop(),v.on.call("cancel",e,e.__data__,v.index,v.group),delete r[f])}if(nM(function(){i.state===XA&&(i.state=rM,i.timer.restart(u,i.delay,i.time),u(c))}),i.state=C2,i.on.call("start",e,e.__data__,i.index,i.group),i.state===C2){for(i.state=XA,o=new Array(m=i.tween.length),f=0,g=-1;f<m;++f)(v=i.tween[f].value.call(e,e.__data__,i.index,i.group))&&(o[++g]=v);o.length=g+1}}function u(c){for(var f=c<i.duration?i.ease.call(null,c/i.duration):(i.timer.restart(p),i.state=x2,1),g=-1,m=o.length;++g<m;)o[g].call(e,f);i.state===x2&&(i.on.call("end",e,e.__data__,i.index,i.group),p())}function p(){i.state=KA,i.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function WQ(e,t){var i=e.__transition,r,o,a=!0,h;if(i){t=t==null?null:t+"";for(h in i){if((r=i[h]).name!==t){a=!1;continue}o=r.state>C2&&r.state<x2,r.state=KA,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete i[h]}a&&delete e.__transition}}function $Q(e){return this.each(function(){WQ(this,e)})}function XQ(e,t){var i,r;return function(){var o=Ml(this,e),a=o.tween;if(a!==i){r=i=a;for(var h=0,u=r.length;h<u;++h)if(r[h].name===t){r=r.slice(),r.splice(h,1);break}}o.tween=r}}function KQ(e,t,i){var r,o;if(typeof i!="function")throw new Error;return function(){var a=Ml(this,e),h=a.tween;if(h!==r){o=(r=h).slice();for(var u={name:t,value:i},p=0,c=o.length;p<c;++p)if(o[p].name===t){o[p]=u;break}p===c&&o.push(u)}a.tween=o}}function YQ(e,t){var i=this._id;if(e+="",arguments.length<2){for(var r=el(this.node(),i).tween,o=0,a=r.length,h;o<a;++o)if((h=r[o]).name===e)return h.value;return null}return this.each((t==null?XQ:KQ)(i,e,t))}function eE(e,t,i){var r=e._id;return e.each(function(){var o=Ml(this,r);(o.value||(o.value={}))[t]=i.apply(this,arguments)}),function(o){return el(o,r).value[t]}}function MB(e,t){var i;return(typeof t=="number"?uo:t instanceof Yc?th:(i=Yc(t))?(t=i,th):vB)(e,t)}function qQ(e){return function(){this.removeAttribute(e)}}function JQ(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ZQ(e,t,i){var r,o=i+"",a;return function(){var h=this.getAttribute(e);return h===o?null:h===r?a:a=t(r=h,i)}}function eH(e,t,i){var r,o=i+"",a;return function(){var h=this.getAttributeNS(e.space,e.local);return h===o?null:h===r?a:a=t(r=h,i)}}function tH(e,t,i){var r,o,a;return function(){var h,u=i(this),p;return u==null?void this.removeAttribute(e):(h=this.getAttribute(e),p=u+"",h===p?null:h===r&&p===o?a:(o=p,a=t(r=h,u)))}}function nH(e,t,i){var r,o,a;return function(){var h,u=i(this),p;return u==null?void this.removeAttributeNS(e.space,e.local):(h=this.getAttributeNS(e.space,e.local),p=u+"",h===p?null:h===r&&p===o?a:(o=p,a=t(r=h,u)))}}function iH(e,t){var i=m1(e),r=i==="transform"?PQ:MB;return this.attrTween(e,typeof t=="function"?(i.local?nH:tH)(i,r,eE(this,"attr."+e,t)):t==null?(i.local?JQ:qQ)(i):(i.local?eH:ZQ)(i,r,t))}function rH(e,t){return function(i){this.setAttribute(e,t.call(this,i))}}function sH(e,t){return function(i){this.setAttributeNS(e.space,e.local,t.call(this,i))}}function oH(e,t){var i,r;function o(){var a=t.apply(this,arguments);return a!==r&&(i=(r=a)&&sH(e,a)),i}return o._value=t,o}function aH(e,t){var i,r;function o(){var a=t.apply(this,arguments);return a!==r&&(i=(r=a)&&rH(e,a)),i}return o._value=t,o}function lH(e,t){var i="attr."+e;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;var r=m1(e);return this.tween(i,(r.local?oH:aH)(r,t))}function cH(e,t){return function(){Z_(this,e).delay=+t.apply(this,arguments)}}function uH(e,t){return t=+t,function(){Z_(this,e).delay=t}}function hH(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cH:uH)(t,e)):el(this.node(),t).delay}function fH(e,t){return function(){Ml(this,e).duration=+t.apply(this,arguments)}}function dH(e,t){return t=+t,function(){Ml(this,e).duration=t}}function pH(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fH:dH)(t,e)):el(this.node(),t).duration}function mH(e,t){if(typeof t!="function")throw new Error;return function(){Ml(this,e).ease=t}}function AH(e){var t=this._id;return arguments.length?this.each(mH(t,e)):el(this.node(),t).ease}function gH(e,t){return function(){var i=t.apply(this,arguments);if(typeof i!="function")throw new Error;Ml(this,e).ease=i}}function vH(e){if(typeof e!="function")throw new Error;return this.each(gH(this._id,e))}function bH(e){typeof e!="function"&&(e=Y4(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],h=a.length,u=r[o]=[],p,c=0;c<h;++c)(p=a[c])&&e.call(p,p.__data__,c,a)&&u.push(p);return new hc(r,this._parents,this._name,this._id)}function yH(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,i=e._groups,r=t.length,o=i.length,a=Math.min(r,o),h=new Array(r),u=0;u<a;++u)for(var p=t[u],c=i[u],f=p.length,g=h[u]=new Array(f),m,v=0;v<f;++v)(m=p[v]||c[v])&&(g[v]=m);for(;u<r;++u)h[u]=t[u];return new hc(h,this._parents,this._name,this._id)}function _H(e){return(e+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||t==="start"})}function EH(e,t,i){var r,o,a=_H(t)?Z_:Ml;return function(){var h=a(this,e),u=h.on;u!==r&&(o=(r=u).copy()).on(t,i),h.on=o}}function wH(e,t){var i=this._id;return arguments.length<2?el(this.node(),i).on.on(e):this.each(EH(i,e,t))}function CH(e){return function(){var t=this.parentNode;for(var i in this.__transition)if(+i!==e)return;t&&t.removeChild(this)}}function xH(){return this.on("end.remove",CH(this._id))}function MH(e){var t=this._name,i=this._id;typeof e!="function"&&(e=z_(e));for(var r=this._groups,o=r.length,a=new Array(o),h=0;h<o;++h)for(var u=r[h],p=u.length,c=a[h]=new Array(p),f,g,m=0;m<p;++m)(f=u[m])&&(g=e.call(f,f.__data__,m,u))&&("__data__"in f&&(g.__data__=f.__data__),c[m]=g,_1(c[m],t,i,m,c,el(f,i)));return new hc(a,this._parents,t,i)}function SH(e){var t=this._name,i=this._id;typeof e!="function"&&(e=K4(e));for(var r=this._groups,o=r.length,a=[],h=[],u=0;u<o;++u)for(var p=r[u],c=p.length,f,g=0;g<c;++g)if(f=p[g]){for(var m=e.call(f,f.__data__,g,p),v,A=el(f,i),y=0,C=m.length;y<C;++y)(v=m[y])&&_1(v,t,i,y,m,A);a.push(m),h.push(f)}return new hc(a,h,t,i)}var TH=um.prototype.constructor;function IH(){return new TH(this._groups,this._parents)}function BH(e,t){var i,r,o;return function(){var a=Bf(this,e),h=(this.style.removeProperty(e),Bf(this,e));return a===h?null:a===i&&h===r?o:o=t(i=a,r=h)}}function SB(e){return function(){this.style.removeProperty(e)}}function RH(e,t,i){var r,o=i+"",a;return function(){var h=Bf(this,e);return h===o?null:h===r?a:a=t(r=h,i)}}function LH(e,t,i){var r,o,a;return function(){var h=Bf(this,e),u=i(this),p=u+"";return u==null&&(p=u=(this.style.removeProperty(e),Bf(this,e))),h===p?null:h===r&&p===o?a:(o=p,a=t(r=h,u))}}function PH(e,t){var i,r,o,a="style."+t,h="end."+a,u;return function(){var p=Ml(this,e),c=p.on,f=p.value[a]==null?u||(u=SB(t)):void 0;(c!==i||o!==f)&&(r=(i=c).copy()).on(h,o=f),p.on=r}}function DH(e,t,i){var r=(e+="")=="transform"?LQ:MB;return t==null?this.styleTween(e,BH(e,r)).on("end.style."+e,SB(e)):typeof t=="function"?this.styleTween(e,LH(e,r,eE(this,"style."+e,t))).each(PH(this._id,e)):this.styleTween(e,RH(e,r,t),i).on("end.style."+e,null)}function NH(e,t,i){return function(r){this.style.setProperty(e,t.call(this,r),i)}}function OH(e,t,i){var r,o;function a(){var h=t.apply(this,arguments);return h!==o&&(r=(o=h)&&NH(e,h,i)),r}return a._value=t,a}function FH(e,t,i){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,OH(e,t,i??""))}function kH(e){return function(){this.textContent=e}}function UH(e){return function(){var t=e(this);this.textContent=t??""}}function GH(e){return this.tween("text",typeof e=="function"?UH(eE(this,"text",e)):kH(e==null?"":e+""))}function VH(e){return function(t){this.textContent=e.call(this,t)}}function QH(e){var t,i;function r(){var o=e.apply(this,arguments);return o!==i&&(t=(i=o)&&VH(o)),t}return r._value=e,r}function HH(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,QH(e))}function zH(){for(var e=this._name,t=this._id,i=TB(),r=this._groups,o=r.length,a=0;a<o;++a)for(var h=r[a],u=h.length,p,c=0;c<u;++c)if(p=h[c]){var f=el(p,t);_1(p,e,i,c,h,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new hc(r,this._parents,e,i)}function jH(){var e,t,i=this,r=i._id,o=i.size();return new Promise(function(a,h){var u={value:h},p={value:function(){--o===0&&a()}};i.each(function(){var c=Ml(this,r),f=c.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(p)),c.on=t}),o===0&&a()})}var WH=0;function hc(e,t,i,r){this._groups=e,this._parents=t,this._name=i,this._id=r}function TB(){return++WH}var Kl=um.prototype;hc.prototype={constructor:hc,select:MH,selectAll:SH,selectChild:Kl.selectChild,selectChildren:Kl.selectChildren,filter:bH,merge:yH,selection:IH,transition:zH,call:Kl.call,nodes:Kl.nodes,node:Kl.node,size:Kl.size,empty:Kl.empty,each:Kl.each,on:wH,attr:iH,attrTween:lH,style:DH,styleTween:FH,text:GH,textTween:HH,remove:xH,tween:YQ,delay:hH,duration:pH,ease:AH,easeVarying:vH,end:jH,[Symbol.iterator]:Kl[Symbol.iterator]};function $H(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var XH={time:null,delay:0,duration:250,ease:$H};function KH(e,t){for(var i;!(i=e.__transition)||!(i=i[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return i}function YH(e){var t,i;e instanceof hc?(t=e._id,e=e._name):(t=TB(),(i=XH).time=J_(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var h=r[a],u=h.length,p,c=0;c<u;++c)(p=h[c])&&_1(p,e,t,c,h,i||KH(p,t));return new hc(r,this._parents,e,t)}um.prototype.interrupt=$Q;um.prototype.transition=YH;const M2=Math.PI,S2=2*M2,Uu=1e-6,qH=S2-Uu;function IB(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function JH(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return IB;const i=10**t;return function(r){this._+=r[0];for(let o=1,a=r.length;o<a;++o)this._+=Math.round(arguments[o]*i)/i+r[o]}}class BB{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?IB:JH(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,r,o){this._append`Q${+t},${+i},${this._x1=+r},${this._y1=+o}`}bezierCurveTo(t,i,r,o,a,h){this._append`C${+t},${+i},${+r},${+o},${this._x1=+a},${this._y1=+h}`}arcTo(t,i,r,o,a){if(t=+t,i=+i,r=+r,o=+o,a=+a,a<0)throw new Error(`negative radius: ${a}`);let h=this._x1,u=this._y1,p=r-t,c=o-i,f=h-t,g=u-i,m=f*f+g*g;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(m>Uu)if(!(Math.abs(g*p-c*f)>Uu)||!a)this._append`L${this._x1=t},${this._y1=i}`;else{let v=r-h,A=o-u,y=p*p+c*c,C=v*v+A*A,E=Math.sqrt(y),x=Math.sqrt(m),M=a*Math.tan((M2-Math.acos((y+m-C)/(2*E*x)))/2),w=M/x,S=M/E;Math.abs(w-1)>Uu&&this._append`L${t+w*f},${i+w*g}`,this._append`A${a},${a},0,0,${+(g*v>f*A)},${this._x1=t+S*p},${this._y1=i+S*c}`}}arc(t,i,r,o,a,h){if(t=+t,i=+i,r=+r,h=!!h,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(o),p=r*Math.sin(o),c=t+u,f=i+p,g=1^h,m=h?o-a:a-o;this._x1===null?this._append`M${c},${f}`:(Math.abs(this._x1-c)>Uu||Math.abs(this._y1-f)>Uu)&&this._append`L${c},${f}`,r&&(m<0&&(m=m%S2+S2),m>qH?this._append`A${r},${r},0,1,${g},${t-u},${i-p}A${r},${r},0,1,${g},${this._x1=c},${this._y1=f}`:m>Uu&&this._append`A${r},${r},0,${+(m>=M2)},${g},${this._x1=t+r*Math.cos(a)},${this._y1=i+r*Math.sin(a)}`)}rect(t,i,r,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${r=+r}v${+o}h${-r}Z`}toString(){return this._}}function jc(e=3){return new BB(+e)}function ZH(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function yg(e,t){if((i=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var i,r=e.slice(0,i);return[r.length>1?r[0]+r.slice(2):r,+e.slice(i+1)]}function Pf(e){return e=yg(Math.abs(e)),e?e[1]:NaN}function ez(e,t){return function(i,r){for(var o=i.length,a=[],h=0,u=e[0],p=0;o>0&&u>0&&(p+u+1>r&&(u=Math.max(1,r-p)),a.push(i.substring(o-=u,o+u)),!((p+=u+1)>r));)u=e[h=(h+1)%e.length];return a.reverse().join(t)}}function tz(e){return function(t){return t.replace(/[0-9]/g,function(i){return e[+i]})}}var nz=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Op(e){if(!(t=nz.exec(e)))throw new Error("invalid format: "+e);var t;return new tE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Op.prototype=tE.prototype;function tE(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}tE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function iz(e){e:for(var t=e.length,i=1,r=-1,o;i<t;++i)switch(e[i]){case".":r=o=i;break;case"0":r===0&&(r=i),o=i;break;default:if(!+e[i])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(o+1):e}var RB;function rz(e,t){var i=yg(e,t);if(!i)return e+"";var r=i[0],o=i[1],a=o-(RB=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,h=r.length;return a===h?r:a>h?r+new Array(a-h+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+yg(e,Math.max(0,t+a-1))[0]}function sM(e,t){var i=yg(e,t);if(!i)return e+"";var r=i[0],o=i[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}const oM={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ZH,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>sM(e*100,t),r:sM,s:rz,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function aM(e){return e}var lM=Array.prototype.map,cM=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function sz(e){var t=e.grouping===void 0||e.thousands===void 0?aM:ez(lM.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?aM:tz(lM.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",u=e.minus===void 0?"":e.minus+"",p=e.nan===void 0?"NaN":e.nan+"";function c(g){g=Op(g);var m=g.fill,v=g.align,A=g.sign,y=g.symbol,C=g.zero,E=g.width,x=g.comma,M=g.precision,w=g.trim,S=g.type;S==="n"?(x=!0,S="g"):oM[S]||(M===void 0&&(M=12),w=!0,S="g"),(C||m==="0"&&v==="=")&&(C=!0,m="0",v="=");var I=y==="$"?i:y==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",L=y==="$"?r:/[%p]/.test(S)?h:"",R=oM[S],k=/[defgprs%]/.test(S);M=M===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function P(F){var O=I,W=L,V,$,H;if(S==="c")W=R(F)+W,F="";else{F=+F;var Y=F<0||1/F<0;if(F=isNaN(F)?p:R(Math.abs(F),M),w&&(F=iz(F)),Y&&+F==0&&A!=="+"&&(Y=!1),O=(Y?A==="("?A:u:A==="-"||A==="("?"":A)+O,W=(S==="s"?cM[8+RB/3]:"")+W+(Y&&A==="("?")":""),k){for(V=-1,$=F.length;++V<$;)if(H=F.charCodeAt(V),48>H||H>57){W=(H===46?o+F.slice(V+1):F.slice(V))+W,F=F.slice(0,V);break}}}x&&!C&&(F=t(F,1/0));var Q=O.length+F.length+W.length,G=Q<E?new Array(E-Q+1).join(m):"";switch(x&&C&&(F=t(G+F,G.length?E-W.length:1/0),G=""),v){case"<":F=O+F+W+G;break;case"=":F=O+G+F+W;break;case"^":F=G.slice(0,Q=G.length>>1)+O+F+W+G.slice(Q);break;default:F=G+O+F+W;break}return a(F)}return P.toString=function(){return g+""},P}function f(g,m){var v=c((g=Op(g),g.type="f",g)),A=Math.max(-8,Math.min(8,Math.floor(Pf(m)/3)))*3,y=Math.pow(10,-A),C=cM[8+A/3];return function(E){return v(y*E)+C}}return{format:c,formatPrefix:f}}var TA,td,LB;oz({thousands:",",grouping:[3],currency:["$",""]});function oz(e){return TA=sz(e),td=TA.format,LB=TA.formatPrefix,TA}function az(e){return Math.max(0,-Pf(Math.abs(e)))}function lz(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Pf(t)/3)))*3-Pf(Math.abs(e)))}function cz(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Pf(t)-Pf(e))+1}var ki=1e-6,PB=1e-12,Xi=Math.PI,cs=Xi/2,uM=Xi/4,aa=Xi*2,Co=180/Xi,ls=Xi/180,Br=Math.abs,nd=Math.atan,fc=Math.atan2,zi=Math.cos,DB=Math.exp,_g=Math.log,by=Math.pow,Ri=Math.sin,Ea=Math.sign||function(e){return e>0?1:e<0?-1:0},Qo=Math.sqrt,nE=Math.tan;function NB(e){return e>1?0:e<-1?Xi:Math.acos(e)}function Ta(e){return e>1?cs:e<-1?-cs:Math.asin(e)}function wa(){}function Eg(e,t){e&&fM.hasOwnProperty(e.type)&&fM[e.type](e,t)}var hM={Feature:function(e,t){Eg(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,r=-1,o=i.length;++r<o;)Eg(i[r].geometry,t)}},fM={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,r=-1,o=i.length;++r<o;)e=i[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){T2(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,r=-1,o=i.length;++r<o;)T2(i[r],t,0)},Polygon:function(e,t){dM(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,r=-1,o=i.length;++r<o;)dM(i[r],t)},GeometryCollection:function(e,t){for(var i=e.geometries,r=-1,o=i.length;++r<o;)Eg(i[r],t)}};function T2(e,t,i){var r=-1,o=e.length-i,a;for(t.lineStart();++r<o;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function dM(e,t){var i=-1,r=e.length;for(t.polygonStart();++i<r;)T2(e[i],t,1);t.polygonEnd()}function Gu(e,t){e&&hM.hasOwnProperty(e.type)?hM[e.type](e,t):Eg(e,t)}function I2(e){return[fc(e[1],e[0]),Ta(e[2])]}function Df(e){var t=e[0],i=e[1],r=zi(i);return[r*zi(t),r*Ri(t),Ri(i)]}function IA(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function wg(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function yy(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function BA(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function B2(e){var t=Qo(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function R2(e,t){function i(r,o){return r=e(r,o),t(r[0],r[1])}return e.invert&&t.invert&&(i.invert=function(r,o){return r=t.invert(r,o),r&&e.invert(r[0],r[1])}),i}function L2(e,t){return Br(e)>Xi&&(e-=Math.round(e/aa)*aa),[e,t]}L2.invert=L2;function OB(e,t,i){return(e%=aa)?t||i?R2(mM(e),AM(t,i)):mM(e):t||i?AM(t,i):L2}function pM(e){return function(t,i){return t+=e,Br(t)>Xi&&(t-=Math.round(t/aa)*aa),[t,i]}}function mM(e){var t=pM(e);return t.invert=pM(-e),t}function AM(e,t){var i=zi(e),r=Ri(e),o=zi(t),a=Ri(t);function h(u,p){var c=zi(p),f=zi(u)*c,g=Ri(u)*c,m=Ri(p),v=m*i+f*r;return[fc(g*o-v*a,f*i-m*r),Ta(v*o+g*a)]}return h.invert=function(u,p){var c=zi(p),f=zi(u)*c,g=Ri(u)*c,m=Ri(p),v=m*o-g*a;return[fc(g*o+m*a,f*i+v*r),Ta(v*i-f*r)]},h}function uz(e){e=OB(e[0]*ls,e[1]*ls,e.length>2?e[2]*ls:0);function t(i){return i=e(i[0]*ls,i[1]*ls),i[0]*=Co,i[1]*=Co,i}return t.invert=function(i){return i=e.invert(i[0]*ls,i[1]*ls),i[0]*=Co,i[1]*=Co,i},t}function hz(e,t,i,r,o,a){if(i){var h=zi(t),u=Ri(t),p=r*i;o==null?(o=t+r*aa,a=t-p/2):(o=gM(h,o),a=gM(h,a),(r>0?o<a:o>a)&&(o+=r*aa));for(var c,f=o;r>0?f>a:f<a;f-=p)c=I2([h,-u*zi(f),-u*Ri(f)]),e.point(c[0],c[1])}}function gM(e,t){t=Df(t),t[0]-=e,B2(t);var i=NB(-t[1]);return((-t[2]<0?-i:i)+aa-ki)%aa}function FB(){var e=[],t;return{point:function(i,r,o){t.push([i,r,o])},lineStart:function(){e.push(t=[])},lineEnd:wa,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function YA(e,t){return Br(e[0]-t[0])<ki&&Br(e[1]-t[1])<ki}function RA(e,t,i,r){this.x=e,this.z=t,this.o=i,this.e=r,this.v=!1,this.n=this.p=null}function kB(e,t,i,r,o){var a=[],h=[],u,p;if(e.forEach(function(A){if(!((y=A.length-1)<=0)){var y,C=A[0],E=A[y],x;if(YA(C,E)){if(!C[2]&&!E[2]){for(o.lineStart(),u=0;u<y;++u)o.point((C=A[u])[0],C[1]);o.lineEnd();return}E[0]+=2*ki}a.push(x=new RA(C,A,null,!0)),h.push(x.o=new RA(C,null,x,!1)),a.push(x=new RA(E,A,null,!1)),h.push(x.o=new RA(E,null,x,!0))}}),!!a.length){for(h.sort(t),vM(a),vM(h),u=0,p=h.length;u<p;++u)h[u].e=i=!i;for(var c=a[0],f,g;;){for(var m=c,v=!0;m.v;)if((m=m.n)===c)return;f=m.z,o.lineStart();do{if(m.v=m.o.v=!0,m.e){if(v)for(u=0,p=f.length;u<p;++u)o.point((g=f[u])[0],g[1]);else r(m.x,m.n.x,1,o);m=m.n}else{if(v)for(f=m.p.z,u=f.length-1;u>=0;--u)o.point((g=f[u])[0],g[1]);else r(m.x,m.p.x,-1,o);m=m.p}m=m.o,f=m.z,v=!v}while(!m.v);o.lineEnd()}}}function vM(e){if(t=e.length){for(var t,i=0,r=e[0],o;++i<t;)r.n=o=e[i],o.p=r,r=o;r.n=o=e[0],o.p=r}}function _y(e){return Br(e[0])<=Xi?e[0]:Ea(e[0])*((Br(e[0])+Xi)%aa-Xi)}function fz(e,t){var i=_y(t),r=t[1],o=Ri(r),a=[Ri(i),-zi(i),0],h=0,u=0,p=new qu;o===1?r=cs+ki:o===-1&&(r=-cs-ki);for(var c=0,f=e.length;c<f;++c)if(m=(g=e[c]).length)for(var g,m,v=g[m-1],A=_y(v),y=v[1]/2+uM,C=Ri(y),E=zi(y),x=0;x<m;++x,A=w,C=I,E=L,v=M){var M=g[x],w=_y(M),S=M[1]/2+uM,I=Ri(S),L=zi(S),R=w-A,k=R>=0?1:-1,P=k*R,F=P>Xi,O=C*I;if(p.add(fc(O*k*Ri(P),E*L+O*zi(P))),h+=F?R+k*aa:R,F^A>=i^w>=i){var W=wg(Df(v),Df(M));B2(W);var V=wg(a,W);B2(V);var $=(F^R>=0?-1:1)*Ta(V[2]);(r>$||r===$&&(W[0]||W[1]))&&(u+=F^R>=0?1:-1)}}return(h<-ki||h<ki&&p<-PB)^u&1}function UB(e,t,i,r){return function(o){var a=t(o),h=FB(),u=t(h),p=!1,c,f,g,m={point:v,lineStart:y,lineEnd:C,polygonStart:function(){m.point=E,m.lineStart=x,m.lineEnd=M,f=[],c=[]},polygonEnd:function(){m.point=v,m.lineStart=y,m.lineEnd=C,f=$4(f);var w=fz(c,r);f.length?(p||(o.polygonStart(),p=!0),kB(f,pz,w,i,o)):w&&(p||(o.polygonStart(),p=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),p&&(o.polygonEnd(),p=!1),f=c=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function v(w,S){e(w,S)&&o.point(w,S)}function A(w,S){a.point(w,S)}function y(){m.point=A,a.lineStart()}function C(){m.point=v,a.lineEnd()}function E(w,S){g.push([w,S]),u.point(w,S)}function x(){u.lineStart(),g=[]}function M(){E(g[0][0],g[0][1]),u.lineEnd();var w=u.clean(),S=h.result(),I,L=S.length,R,k,P;if(g.pop(),c.push(g),g=null,!!L){if(w&1){if(k=S[0],(R=k.length-1)>0){for(p||(o.polygonStart(),p=!0),o.lineStart(),I=0;I<R;++I)o.point((P=k[I])[0],P[1]);o.lineEnd()}return}L>1&&w&2&&S.push(S.pop().concat(S.shift())),f.push(S.filter(dz))}}return m}}function dz(e){return e.length>1}function pz(e,t){return((e=e.x)[0]<0?e[1]-cs-ki:cs-e[1])-((t=t.x)[0]<0?t[1]-cs-ki:cs-t[1])}const bM=UB(function(){return!0},mz,gz,[-Xi,-cs]);function mz(e){var t=NaN,i=NaN,r=NaN,o;return{lineStart:function(){e.lineStart(),o=1},point:function(a,h){var u=a>0?Xi:-Xi,p=Br(a-t);Br(p-Xi)<ki?(e.point(t,i=(i+h)/2>0?cs:-cs),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(u,i),e.point(a,i),o=0):r!==u&&p>=Xi&&(Br(t-r)<ki&&(t-=r*ki),Br(a-u)<ki&&(a-=u*ki),i=Az(t,i,a,h),e.point(r,i),e.lineEnd(),e.lineStart(),e.point(u,i),o=0),e.point(t=a,i=h),r=u},lineEnd:function(){e.lineEnd(),t=i=NaN},clean:function(){return 2-o}}}function Az(e,t,i,r){var o,a,h=Ri(e-i);return Br(h)>ki?nd((Ri(t)*(a=zi(r))*Ri(i)-Ri(r)*(o=zi(t))*Ri(e))/(o*a*h)):(t+r)/2}function gz(e,t,i,r){var o;if(e==null)o=i*cs,r.point(-Xi,o),r.point(0,o),r.point(Xi,o),r.point(Xi,0),r.point(Xi,-o),r.point(0,-o),r.point(-Xi,-o),r.point(-Xi,0),r.point(-Xi,o);else if(Br(e[0]-t[0])>ki){var a=e[0]<t[0]?Xi:-Xi;o=i*a/2,r.point(-a,o),r.point(0,o),r.point(a,o)}else r.point(t[0],t[1])}function vz(e){var t=zi(e),i=2*ls,r=t>0,o=Br(t)>ki;function a(f,g,m,v){hz(v,e,i,m,f,g)}function h(f,g){return zi(f)*zi(g)>t}function u(f){var g,m,v,A,y;return{lineStart:function(){A=v=!1,y=1},point:function(C,E){var x=[C,E],M,w=h(C,E),S=r?w?0:c(C,E):w?c(C+(C<0?Xi:-Xi),E):0;if(!g&&(A=v=w)&&f.lineStart(),w!==v&&(M=p(g,x),(!M||YA(g,M)||YA(x,M))&&(x[2]=1)),w!==v)y=0,w?(f.lineStart(),M=p(x,g),f.point(M[0],M[1])):(M=p(g,x),f.point(M[0],M[1],2),f.lineEnd()),g=M;else if(o&&g&&r^w){var I;!(S&m)&&(I=p(x,g,!0))&&(y=0,r?(f.lineStart(),f.point(I[0][0],I[0][1]),f.point(I[1][0],I[1][1]),f.lineEnd()):(f.point(I[1][0],I[1][1]),f.lineEnd(),f.lineStart(),f.point(I[0][0],I[0][1],3)))}w&&(!g||!YA(g,x))&&f.point(x[0],x[1]),g=x,v=w,m=S},lineEnd:function(){v&&f.lineEnd(),g=null},clean:function(){return y|(A&&v)<<1}}}function p(f,g,m){var v=Df(f),A=Df(g),y=[1,0,0],C=wg(v,A),E=IA(C,C),x=C[0],M=E-x*x;if(!M)return!m&&f;var w=t*E/M,S=-t*x/M,I=wg(y,C),L=BA(y,w),R=BA(C,S);yy(L,R);var k=I,P=IA(L,k),F=IA(k,k),O=P*P-F*(IA(L,L)-1);if(!(O<0)){var W=Qo(O),V=BA(k,(-P-W)/F);if(yy(V,L),V=I2(V),!m)return V;var $=f[0],H=g[0],Y=f[1],Q=g[1],G;H<$&&(G=$,$=H,H=G);var J=H-$,K=Br(J-Xi)<ki,se=K||J<ki;if(!K&&Q<Y&&(G=Y,Y=Q,Q=G),se?K?Y+Q>0^V[1]<(Br(V[0]-$)<ki?Y:Q):Y<=V[1]&&V[1]<=Q:J>Xi^($<=V[0]&&V[0]<=H)){var ue=BA(k,(-P+W)/F);return yy(ue,L),[V,I2(ue)]}}}function c(f,g){var m=r?e:Xi-e,v=0;return f<-m?v|=1:f>m&&(v|=2),g<-m?v|=4:g>m&&(v|=8),v}return UB(h,u,a,r?[0,-e]:[-Xi,e-Xi])}function bz(e,t,i,r,o,a){var h=e[0],u=e[1],p=t[0],c=t[1],f=0,g=1,m=p-h,v=c-u,A;if(A=i-h,!(!m&&A>0)){if(A/=m,m<0){if(A<f)return;A<g&&(g=A)}else if(m>0){if(A>g)return;A>f&&(f=A)}if(A=o-h,!(!m&&A<0)){if(A/=m,m<0){if(A>g)return;A>f&&(f=A)}else if(m>0){if(A<f)return;A<g&&(g=A)}if(A=r-u,!(!v&&A>0)){if(A/=v,v<0){if(A<f)return;A<g&&(g=A)}else if(v>0){if(A>g)return;A>f&&(f=A)}if(A=a-u,!(!v&&A<0)){if(A/=v,v<0){if(A>g)return;A>f&&(f=A)}else if(v>0){if(A<f)return;A<g&&(g=A)}return f>0&&(e[0]=h+f*m,e[1]=u+f*v),g<1&&(t[0]=h+g*m,t[1]=u+g*v),!0}}}}}var sp=1e9,LA=-sp;function GB(e,t,i,r){function o(c,f){return e<=c&&c<=i&&t<=f&&f<=r}function a(c,f,g,m){var v=0,A=0;if(c==null||(v=h(c,g))!==(A=h(f,g))||p(c,f)<0^g>0)do m.point(v===0||v===3?e:i,v>1?r:t);while((v=(v+g+4)%4)!==A);else m.point(f[0],f[1])}function h(c,f){return Br(c[0]-e)<ki?f>0?0:3:Br(c[0]-i)<ki?f>0?2:1:Br(c[1]-t)<ki?f>0?1:0:f>0?3:2}function u(c,f){return p(c.x,f.x)}function p(c,f){var g=h(c,1),m=h(f,1);return g!==m?g-m:g===0?f[1]-c[1]:g===1?c[0]-f[0]:g===2?c[1]-f[1]:f[0]-c[0]}return function(c){var f=c,g=FB(),m,v,A,y,C,E,x,M,w,S,I,L={point:R,lineStart:O,lineEnd:W,polygonStart:P,polygonEnd:F};function R($,H){o($,H)&&f.point($,H)}function k(){for(var $=0,H=0,Y=v.length;H<Y;++H)for(var Q=v[H],G=1,J=Q.length,K=Q[0],se,ue,he=K[0],Me=K[1];G<J;++G)se=he,ue=Me,K=Q[G],he=K[0],Me=K[1],ue<=r?Me>r&&(he-se)*(r-ue)>(Me-ue)*(e-se)&&++$:Me<=r&&(he-se)*(r-ue)<(Me-ue)*(e-se)&&--$;return $}function P(){f=g,m=[],v=[],I=!0}function F(){var $=k(),H=I&&$,Y=(m=$4(m)).length;(H||Y)&&(c.polygonStart(),H&&(c.lineStart(),a(null,null,1,c),c.lineEnd()),Y&&kB(m,u,$,a,c),c.polygonEnd()),f=c,m=v=A=null}function O(){L.point=V,v&&v.push(A=[]),S=!0,w=!1,x=M=NaN}function W(){m&&(V(y,C),E&&w&&g.rejoin(),m.push(g.result())),L.point=R,w&&f.lineEnd()}function V($,H){var Y=o($,H);if(v&&A.push([$,H]),S)y=$,C=H,E=Y,S=!1,Y&&(f.lineStart(),f.point($,H));else if(Y&&w)f.point($,H);else{var Q=[x=Math.max(LA,Math.min(sp,x)),M=Math.max(LA,Math.min(sp,M))],G=[$=Math.max(LA,Math.min(sp,$)),H=Math.max(LA,Math.min(sp,H))];bz(Q,G,e,t,i,r)?(w||(f.lineStart(),f.point(Q[0],Q[1])),f.point(G[0],G[1]),Y||f.lineEnd(),I=!1):Y&&(f.lineStart(),f.point($,H),I=!1)}x=$,M=H,w=Y}return L}}const P2=e=>e;var Ey=new qu,D2=new qu,VB,QB,N2,O2,rc={point:wa,lineStart:wa,lineEnd:wa,polygonStart:function(){rc.lineStart=yz,rc.lineEnd=Ez},polygonEnd:function(){rc.lineStart=rc.lineEnd=rc.point=wa,Ey.add(Br(D2)),D2=new qu},result:function(){var e=Ey/2;return Ey=new qu,e}};function yz(){rc.point=_z}function _z(e,t){rc.point=HB,VB=N2=e,QB=O2=t}function HB(e,t){D2.add(O2*e-N2*t),N2=e,O2=t}function Ez(){HB(VB,QB)}var Nf=1/0,Cg=Nf,Fp=-Nf,xg=Fp,Mg={point:wz,lineStart:wa,lineEnd:wa,polygonStart:wa,polygonEnd:wa,result:function(){var e=[[Nf,Cg],[Fp,xg]];return Fp=xg=-(Cg=Nf=1/0),e}};function wz(e,t){e<Nf&&(Nf=e),e>Fp&&(Fp=e),t<Cg&&(Cg=t),t>xg&&(xg=t)}var F2=0,k2=0,op=0,Sg=0,Tg=0,lf=0,U2=0,G2=0,ap=0,zB,jB,ml,Al,_a={point:ih,lineStart:yM,lineEnd:_M,polygonStart:function(){_a.lineStart=Mz,_a.lineEnd=Sz},polygonEnd:function(){_a.point=ih,_a.lineStart=yM,_a.lineEnd=_M},result:function(){var e=ap?[U2/ap,G2/ap]:lf?[Sg/lf,Tg/lf]:op?[F2/op,k2/op]:[NaN,NaN];return F2=k2=op=Sg=Tg=lf=U2=G2=ap=0,e}};function ih(e,t){F2+=e,k2+=t,++op}function yM(){_a.point=Cz}function Cz(e,t){_a.point=xz,ih(ml=e,Al=t)}function xz(e,t){var i=e-ml,r=t-Al,o=Qo(i*i+r*r);Sg+=o*(ml+e)/2,Tg+=o*(Al+t)/2,lf+=o,ih(ml=e,Al=t)}function _M(){_a.point=ih}function Mz(){_a.point=Tz}function Sz(){WB(zB,jB)}function Tz(e,t){_a.point=WB,ih(zB=ml=e,jB=Al=t)}function WB(e,t){var i=e-ml,r=t-Al,o=Qo(i*i+r*r);Sg+=o*(ml+e)/2,Tg+=o*(Al+t)/2,lf+=o,o=Al*e-ml*t,U2+=o*(ml+e),G2+=o*(Al+t),ap+=o*3,ih(ml=e,Al=t)}function $B(e){this._context=e}$B.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,aa);break}}},result:wa};var V2=new qu,wy,XB,KB,lp,cp,kp={point:wa,lineStart:function(){kp.point=Iz},lineEnd:function(){wy&&YB(XB,KB),kp.point=wa},polygonStart:function(){wy=!0},polygonEnd:function(){wy=null},result:function(){var e=+V2;return V2=new qu,e}};function Iz(e,t){kp.point=YB,XB=lp=e,KB=cp=t}function YB(e,t){lp-=e,cp-=t,V2.add(Qo(lp*lp+cp*cp)),lp=e,cp=t}let EM,Ig,wM,CM;class xM{constructor(t){this._append=t==null?qB:Bz(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,i){switch(this._point){case 0:{this._append`M${t},${i}`,this._point=1;break}case 1:{this._append`L${t},${i}`;break}default:{if(this._append`M${t},${i}`,this._radius!==wM||this._append!==Ig){const r=this._radius,o=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,wM=r,Ig=this._append,CM=this._,this._=o}this._+=CM;break}}}result(){const t=this._;return this._="",t.length?t:null}}function qB(e){let t=1;this._+=e[0];for(const i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function Bz(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return qB;if(t!==EM){const i=10**t;EM=t,Ig=function(o){let a=1;this._+=o[0];for(const h=o.length;a<h;++a)this._+=Math.round(arguments[a]*i)/i+o[a]}}return Ig}function E1(e,t){let i=3,r=4.5,o,a;function h(u){return u&&(typeof r=="function"&&a.pointRadius(+r.apply(this,arguments)),Gu(u,o(a))),a.result()}return h.area=function(u){return Gu(u,o(rc)),rc.result()},h.measure=function(u){return Gu(u,o(kp)),kp.result()},h.bounds=function(u){return Gu(u,o(Mg)),Mg.result()},h.centroid=function(u){return Gu(u,o(_a)),_a.result()},h.projection=function(u){return arguments.length?(o=u==null?(e=null,P2):(e=u).stream,h):e},h.context=function(u){return arguments.length?(a=u==null?(t=null,new xM(i)):new $B(t=u),typeof r!="function"&&a.pointRadius(r),h):t},h.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(a.pointRadius(+u),+u),h):r},h.digits=function(u){if(!arguments.length)return i;if(u==null)i=null;else{const p=Math.floor(u);if(!(p>=0))throw new RangeError(`invalid digits: ${u}`);i=p}return t===null&&(a=new xM(i)),h},h.projection(e).digits(i).context(t)}function Q2(e){return{stream:w1(e)}}function w1(e){return function(t){var i=new H2;for(var r in e)i[r]=e[r];return i.stream=t,i}}function H2(){}H2.prototype={constructor:H2,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function iE(e,t,i){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Gu(i,e.stream(Mg)),t(Mg.result()),r!=null&&e.clipExtent(r),e}function rE(e,t,i){return iE(e,function(r){var o=t[1][0]-t[0][0],a=t[1][1]-t[0][1],h=Math.min(o/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),u=+t[0][0]+(o-h*(r[1][0]+r[0][0]))/2,p=+t[0][1]+(a-h*(r[1][1]+r[0][1]))/2;e.scale(150*h).translate([u,p])},i)}function JB(e,t,i){return rE(e,[[0,0],t],i)}function ZB(e,t,i){return iE(e,function(r){var o=+t,a=o/(r[1][0]-r[0][0]),h=(o-a*(r[1][0]+r[0][0]))/2,u=-a*r[0][1];e.scale(150*a).translate([h,u])},i)}function e5(e,t,i){return iE(e,function(r){var o=+t,a=o/(r[1][1]-r[0][1]),h=-a*r[0][0],u=(o-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([h,u])},i)}var MM=16,Rz=zi(30*ls);function SM(e,t){return+t?Pz(e,t):Lz(e)}function Lz(e){return w1({point:function(t,i){t=e(t,i),this.stream.point(t[0],t[1])}})}function Pz(e,t){function i(r,o,a,h,u,p,c,f,g,m,v,A,y,C){var E=c-r,x=f-o,M=E*E+x*x;if(M>4*t&&y--){var w=h+m,S=u+v,I=p+A,L=Qo(w*w+S*S+I*I),R=Ta(I/=L),k=Br(Br(I)-1)<ki||Br(a-g)<ki?(a+g)/2:fc(S,w),P=e(k,R),F=P[0],O=P[1],W=F-r,V=O-o,$=x*W-E*V;($*$/M>t||Br((E*W+x*V)/M-.5)>.3||h*m+u*v+p*A<Rz)&&(i(r,o,a,h,u,p,F,O,k,w/=L,S/=L,I,y,C),C.point(F,O),i(F,O,k,w,S,I,c,f,g,m,v,A,y,C))}}return function(r){var o,a,h,u,p,c,f,g,m,v,A,y,C={point:E,lineStart:x,lineEnd:w,polygonStart:function(){r.polygonStart(),C.lineStart=S},polygonEnd:function(){r.polygonEnd(),C.lineStart=x}};function E(R,k){R=e(R,k),r.point(R[0],R[1])}function x(){g=NaN,C.point=M,r.lineStart()}function M(R,k){var P=Df([R,k]),F=e(R,k);i(g,m,f,v,A,y,g=F[0],m=F[1],f=R,v=P[0],A=P[1],y=P[2],MM,r),r.point(g,m)}function w(){C.point=E,r.lineEnd()}function S(){x(),C.point=I,C.lineEnd=L}function I(R,k){M(o=R,k),a=g,h=m,u=v,p=A,c=y,C.point=M}function L(){i(g,m,f,v,A,y,a,h,o,u,p,c,MM,r),C.lineEnd=w,w()}return C}}var Dz=w1({point:function(e,t){this.stream.point(e*ls,t*ls)}});function Nz(e){return w1({point:function(t,i){var r=e(t,i);return this.stream.point(r[0],r[1])}})}function Oz(e,t,i,r,o){function a(h,u){return h*=r,u*=o,[t+e*h,i-e*u]}return a.invert=function(h,u){return[(h-t)/e*r,(i-u)/e*o]},a}function TM(e,t,i,r,o,a){if(!a)return Oz(e,t,i,r,o);var h=zi(a),u=Ri(a),p=h*e,c=u*e,f=h/e,g=u/e,m=(u*i-h*t)/e,v=(u*t+h*i)/e;function A(y,C){return y*=r,C*=o,[p*y-c*C+t,i-c*y-p*C]}return A.invert=function(y,C){return[r*(f*y-g*C+m),o*(v-g*y-f*C)]},A}function ru(e){return t5(function(){return e})()}function t5(e){var t,i=150,r=480,o=250,a=0,h=0,u=0,p=0,c=0,f,g=0,m=1,v=1,A=null,y=bM,C=null,E,x,M,w=P2,S=.5,I,L,R,k,P;function F($){return R($[0]*ls,$[1]*ls)}function O($){return $=R.invert($[0],$[1]),$&&[$[0]*Co,$[1]*Co]}F.stream=function($){return k&&P===$?k:k=Dz(Nz(f)(y(I(w(P=$)))))},F.preclip=function($){return arguments.length?(y=$,A=void 0,V()):y},F.postclip=function($){return arguments.length?(w=$,C=E=x=M=null,V()):w},F.clipAngle=function($){return arguments.length?(y=+$?vz(A=$*ls):(A=null,bM),V()):A*Co},F.clipExtent=function($){return arguments.length?(w=$==null?(C=E=x=M=null,P2):GB(C=+$[0][0],E=+$[0][1],x=+$[1][0],M=+$[1][1]),V()):C==null?null:[[C,E],[x,M]]},F.scale=function($){return arguments.length?(i=+$,W()):i},F.translate=function($){return arguments.length?(r=+$[0],o=+$[1],W()):[r,o]},F.center=function($){return arguments.length?(a=$[0]%360*ls,h=$[1]%360*ls,W()):[a*Co,h*Co]},F.rotate=function($){return arguments.length?(u=$[0]%360*ls,p=$[1]%360*ls,c=$.length>2?$[2]%360*ls:0,W()):[u*Co,p*Co,c*Co]},F.angle=function($){return arguments.length?(g=$%360*ls,W()):g*Co},F.reflectX=function($){return arguments.length?(m=$?-1:1,W()):m<0},F.reflectY=function($){return arguments.length?(v=$?-1:1,W()):v<0},F.precision=function($){return arguments.length?(I=SM(L,S=$*$),V()):Qo(S)},F.fitExtent=function($,H){return rE(F,$,H)},F.fitSize=function($,H){return JB(F,$,H)},F.fitWidth=function($,H){return ZB(F,$,H)},F.fitHeight=function($,H){return e5(F,$,H)};function W(){var $=TM(i,0,0,m,v,g).apply(null,t(a,h)),H=TM(i,r-$[0],o-$[1],m,v,g);return f=OB(u,p,c),L=R2(t,H),R=R2(f,L),I=SM(L,S),V()}function V(){return k=P=null,F}return function(){return t=e.apply(this,arguments),F.invert=t.invert&&O,W()}}function sE(e){var t=0,i=Xi/3,r=t5(e),o=r(t,i);return o.parallels=function(a){return arguments.length?r(t=a[0]*ls,i=a[1]*ls):[t*Co,i*Co]},o}function Fz(e){var t=zi(e);function i(r,o){return[r*t,Ri(o)/t]}return i.invert=function(r,o){return[r/t,Ta(o*t)]},i}function kz(e,t){var i=Ri(e),r=(i+Ri(t))/2;if(Br(r)<ki)return Fz(e);var o=1+i*(2*r-i),a=Qo(o)/r;function h(u,p){var c=Qo(o-2*r*Ri(p))/r;return[c*Ri(u*=r),a-c*zi(u)]}return h.invert=function(u,p){var c=a-p,f=fc(u,Br(c))*Ea(c);return c*r<0&&(f-=Xi*Ea(u)*Ea(c)),[f/r,Ta((o-(u*u+c*c)*r*r)/(2*r))]},h}function Bg(){return sE(kz).scale(155.424).center([0,33.6442])}function n5(){return Bg().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Uz(e){var t=e.length;return{point:function(i,r){for(var o=-1;++o<t;)e[o].point(i,r)},sphere:function(){for(var i=-1;++i<t;)e[i].sphere()},lineStart:function(){for(var i=-1;++i<t;)e[i].lineStart()},lineEnd:function(){for(var i=-1;++i<t;)e[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<t;)e[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<t;)e[i].polygonEnd()}}}function Gz(){var e,t,i=n5(),r,o=Bg().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,h=Bg().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,p,c={point:function(m,v){p=[m,v]}};function f(m){var v=m[0],A=m[1];return p=null,r.point(v,A),p||(a.point(v,A),p)||(u.point(v,A),p)}f.invert=function(m){var v=i.scale(),A=i.translate(),y=(m[0]-A[0])/v,C=(m[1]-A[1])/v;return(C>=.12&&C<.234&&y>=-.425&&y<-.214?o:C>=.166&&C<.234&&y>=-.214&&y<-.115?h:i).invert(m)},f.stream=function(m){return e&&t===m?e:e=Uz([i.stream(t=m),o.stream(m),h.stream(m)])},f.precision=function(m){return arguments.length?(i.precision(m),o.precision(m),h.precision(m),g()):i.precision()},f.scale=function(m){return arguments.length?(i.scale(m),o.scale(m*.35),h.scale(m),f.translate(i.translate())):i.scale()},f.translate=function(m){if(!arguments.length)return i.translate();var v=i.scale(),A=+m[0],y=+m[1];return r=i.translate(m).clipExtent([[A-.455*v,y-.238*v],[A+.455*v,y+.238*v]]).stream(c),a=o.translate([A-.307*v,y+.201*v]).clipExtent([[A-.425*v+ki,y+.12*v+ki],[A-.214*v-ki,y+.234*v-ki]]).stream(c),u=h.translate([A-.205*v,y+.212*v]).clipExtent([[A-.214*v+ki,y+.166*v+ki],[A-.115*v-ki,y+.234*v-ki]]).stream(c),g()},f.fitExtent=function(m,v){return rE(f,m,v)},f.fitSize=function(m,v){return JB(f,m,v)},f.fitWidth=function(m,v){return ZB(f,m,v)},f.fitHeight=function(m,v){return e5(f,m,v)};function g(){return e=t=null,f}return f.scale(1070)}function i5(e){return function(t,i){var r=zi(t),o=zi(i),a=e(r*o);return a===1/0?[2,0]:[a*o*Ri(t),a*Ri(i)]}}function dm(e){return function(t,i){var r=Qo(t*t+i*i),o=e(r),a=Ri(o),h=zi(o);return[fc(t*a,r*h),Ta(r&&i*a/r)]}}var r5=i5(function(e){return Qo(2/(1+e))});r5.invert=dm(function(e){return 2*Ta(e/2)});function Vz(){return ru(r5).scale(124.75).clipAngle(180-.001)}var s5=i5(function(e){return(e=NB(e))&&e/Ri(e)});s5.invert=dm(function(e){return e});function Qz(){return ru(s5).scale(79.4188).clipAngle(180-.001)}function C1(e,t){return[e,_g(nE((cs+t)/2))]}C1.invert=function(e,t){return[e,2*nd(DB(t))-cs]};function Hz(){return o5(C1).scale(961/aa)}function o5(e){var t=ru(e),i=t.center,r=t.scale,o=t.translate,a=t.clipExtent,h=null,u,p,c;t.scale=function(g){return arguments.length?(r(g),f()):r()},t.translate=function(g){return arguments.length?(o(g),f()):o()},t.center=function(g){return arguments.length?(i(g),f()):i()},t.clipExtent=function(g){return arguments.length?(g==null?h=u=p=c=null:(h=+g[0][0],u=+g[0][1],p=+g[1][0],c=+g[1][1]),f()):h==null?null:[[h,u],[p,c]]};function f(){var g=Xi*r(),m=t(uz(t.rotate()).invert([0,0]));return a(h==null?[[m[0]-g,m[1]-g],[m[0]+g,m[1]+g]]:e===C1?[[Math.max(m[0]-g,h),u],[Math.min(m[0]+g,p),c]]:[[h,Math.max(m[1]-g,u)],[p,Math.min(m[1]+g,c)]])}return f()}function PA(e){return nE((cs+e)/2)}function zz(e,t){var i=zi(e),r=e===t?Ri(e):_g(i/zi(t))/_g(PA(t)/PA(e)),o=i*by(PA(e),r)/r;if(!r)return C1;function a(h,u){o>0?u<-cs+ki&&(u=-cs+ki):u>cs-ki&&(u=cs-ki);var p=o/by(PA(u),r);return[p*Ri(r*h),o-p*zi(r*h)]}return a.invert=function(h,u){var p=o-u,c=Ea(r)*Qo(h*h+p*p),f=fc(h,Br(p))*Ea(p);return p*r<0&&(f-=Xi*Ea(h)*Ea(p)),[f/r,2*nd(by(o/c,1/r))-cs]},a}function jz(){return sE(zz).scale(109.5).parallels([30,30])}function Rg(e,t){return[e,t]}Rg.invert=Rg;function Wz(){return ru(Rg).scale(152.63)}function $z(e,t){var i=zi(e),r=e===t?Ri(e):(i-zi(t))/(t-e),o=i/r+e;if(Br(r)<ki)return Rg;function a(h,u){var p=o-u,c=r*h;return[p*Ri(c),o-p*zi(c)]}return a.invert=function(h,u){var p=o-u,c=fc(h,Br(p))*Ea(p);return p*r<0&&(c-=Xi*Ea(h)*Ea(p)),[c/r,o-Ea(r)*Qo(h*h+p*p)]},a}function Xz(){return sE($z).scale(131.154).center([0,13.9389])}var vp=1.340264,bp=-.081106,yp=893e-6,_p=.003796,Lg=Qo(3)/2,Kz=12;function a5(e,t){var i=Ta(Lg*Ri(t)),r=i*i,o=r*r*r;return[e*zi(i)/(Lg*(vp+3*bp*r+o*(7*yp+9*_p*r))),i*(vp+bp*r+o*(yp+_p*r))]}a5.invert=function(e,t){for(var i=t,r=i*i,o=r*r*r,a=0,h,u,p;a<Kz&&(u=i*(vp+bp*r+o*(yp+_p*r))-t,p=vp+3*bp*r+o*(7*yp+9*_p*r),i-=h=u/p,r=i*i,o=r*r*r,!(Br(h)<PB));++a);return[Lg*e*(vp+3*bp*r+o*(7*yp+9*_p*r))/zi(i),Ta(Ri(i)/Lg)]};function Yz(){return ru(a5).scale(177.158)}function l5(e,t){var i=zi(t),r=zi(e)*i;return[i*Ri(e)/r,Ri(t)/r]}l5.invert=dm(nd);function qz(){return ru(l5).scale(144.049).clipAngle(60)}function c5(e,t){return[zi(t)*Ri(e),Ri(t)]}c5.invert=dm(Ta);function Jz(){return ru(c5).scale(249.5).clipAngle(90+ki)}function u5(e,t){var i=zi(t),r=1+zi(e)*i;return[i*Ri(e)/r,Ri(t)/r]}u5.invert=dm(function(e){return 2*nd(e)});function Zz(){return ru(u5).scale(250).clipAngle(142)}function h5(e,t){return[_g(nE((cs+t)/2)),-e]}h5.invert=function(e,t){return[-t,2*nd(DB(e))-cs]};function ej(){var e=o5(h5),t=e.center,i=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?i([r[0],r[1],r.length>2?r[2]+90:90]):(r=i(),[r[0],r[1],r[2]-90])},i([0,0,90]).scale(159.155)}function tj(e,t){return e.parent===t.parent?1:2}function nj(e){return e.reduce(ij,0)/e.length}function ij(e,t){return e+t.x}function rj(e){return 1+e.reduce(sj,0)}function sj(e,t){return Math.max(e,t.y)}function oj(e){for(var t;t=e.children;)e=t[0];return e}function aj(e){for(var t;t=e.children;)e=t[t.length-1];return e}function f5(){var e=tj,t=1,i=1,r=!1;function o(a){var h,u=0;a.eachAfter(function(m){var v=m.children;v?(m.x=nj(v),m.y=rj(v)):(m.x=h?u+=e(m,h):0,m.y=0,h=m)});var p=oj(a),c=aj(a),f=p.x-e(p,c)/2,g=c.x+e(c,p)/2;return a.eachAfter(r?function(m){m.x=(m.x-a.x)*t,m.y=(a.y-m.y)*i}:function(m){m.x=(m.x-f)/(g-f)*t,m.y=(1-(a.y?m.y/a.y:1))*i})}return o.separation=function(a){return arguments.length?(e=a,o):e},o.size=function(a){return arguments.length?(r=!1,t=+a[0],i=+a[1],o):r?null:[t,i]},o.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],i=+a[1],o):r?[t,i]:null},o}function lj(e){var t=0,i=e.children,r=i&&i.length;if(!r)t=1;else for(;--r>=0;)t+=i[r].value;e.value=t}function cj(){return this.eachAfter(lj)}function uj(e,t){let i=-1;for(const r of this)e.call(t,r,++i,this);return this}function hj(e,t){for(var i=this,r=[i],o,a,h=-1;i=r.pop();)if(e.call(t,i,++h,this),o=i.children)for(a=o.length-1;a>=0;--a)r.push(o[a]);return this}function fj(e,t){for(var i=this,r=[i],o=[],a,h,u,p=-1;i=r.pop();)if(o.push(i),a=i.children)for(h=0,u=a.length;h<u;++h)r.push(a[h]);for(;i=o.pop();)e.call(t,i,++p,this);return this}function dj(e,t){let i=-1;for(const r of this)if(e.call(t,r,++i,this))return r}function pj(e){return this.eachAfter(function(t){for(var i=+e(t.data)||0,r=t.children,o=r&&r.length;--o>=0;)i+=r[o].value;t.value=i})}function mj(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Aj(e){for(var t=this,i=gj(t,e),r=[t];t!==i;)t=t.parent,r.push(t);for(var o=r.length;e!==i;)r.splice(o,0,e),e=e.parent;return r}function gj(e,t){if(e===t)return e;var i=e.ancestors(),r=t.ancestors(),o=null;for(e=i.pop(),t=r.pop();e===t;)o=e,e=i.pop(),t=r.pop();return o}function vj(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function bj(){return Array.from(this)}function yj(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function _j(){var e=this,t=[];return e.each(function(i){i!==e&&t.push({source:i.parent,target:i})}),t}function*Ej(){var e=this,t,i=[e],r,o,a;do for(t=i.reverse(),i=[];e=t.pop();)if(yield e,r=e.children)for(o=0,a=r.length;o<a;++o)i.push(r[o]);while(i.length)}function d5(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=xj)):t===void 0&&(t=Cj);for(var i=new Of(e),r,o=[i],a,h,u,p;r=o.pop();)if((h=t(r.data))&&(p=(h=Array.from(h)).length))for(r.children=h,u=p-1;u>=0;--u)o.push(a=h[u]=new Of(h[u])),a.parent=r,a.depth=r.depth+1;return i.eachBefore(p5)}function wj(){return d5(this).eachBefore(Mj)}function Cj(e){return e.children}function xj(e){return Array.isArray(e)?e[1]:null}function Mj(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function p5(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Of(e){this.data=e,this.depth=this.height=0,this.parent=null}Of.prototype=d5.prototype={constructor:Of,count:cj,each:uj,eachAfter:fj,eachBefore:hj,find:dj,sum:pj,sort:mj,path:Aj,ancestors:vj,descendants:bj,leaves:yj,links:_j,copy:wj,[Symbol.iterator]:Ej};function Cy(e){return e==null?null:Sj(e)}function Sj(e){if(typeof e!="function")throw new Error;return e}var Tj={depth:-1},IM={},xy={};function Ij(e){return e.id}function Bj(e){return e.parentId}function m5(){var e=Ij,t=Bj,i;function r(o){var a=Array.from(o),h=e,u=t,p,c,f,g,m,v,A,y,C=new Map;if(i!=null){const E=a.map((w,S)=>Rj(i(w,S,o))),x=E.map(BM),M=new Set(E).add("");for(const w of x)M.has(w)||(M.add(w),E.push(w),x.push(BM(w)),a.push(xy));h=(w,S)=>E[S],u=(w,S)=>x[S]}for(f=0,p=a.length;f<p;++f)c=a[f],v=a[f]=new Of(c),(A=h(c,f,o))!=null&&(A+="")&&(y=v.id=A,C.set(y,C.has(y)?IM:v)),(A=u(c,f,o))!=null&&(A+="")&&(v.parent=A);for(f=0;f<p;++f)if(v=a[f],A=v.parent){if(m=C.get(A),!m)throw new Error("missing: "+A);if(m===IM)throw new Error("ambiguous: "+A);m.children?m.children.push(v):m.children=[v],v.parent=m}else{if(g)throw new Error("multiple roots");g=v}if(!g)throw new Error("no root");if(i!=null){for(;g.data===xy&&g.children.length===1;)g=g.children[0],--p;for(let E=a.length-1;E>=0&&(v=a[E],v.data===xy);--E)v.data=null}if(g.parent=Tj,g.eachBefore(function(E){E.depth=E.parent.depth+1,--p}).eachBefore(p5),g.parent=null,p>0)throw new Error("cycle");return g}return r.id=function(o){return arguments.length?(e=Cy(o),r):e},r.parentId=function(o){return arguments.length?(t=Cy(o),r):t},r.path=function(o){return arguments.length?(i=Cy(o),r):i},r}function Rj(e){e=`${e}`;let t=e.length;return z2(e,t-1)&&!z2(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function BM(e){let t=e.length;if(t<2)return"";for(;--t>1&&!z2(e,t););return e.slice(0,t)}function z2(e,t){if(e[t]==="/"){let i=0;for(;t>0&&e[--t]==="\\";)++i;if(!(i&1))return!0}return!1}function Lj(e,t){return e.parent===t.parent?1:2}function My(e){var t=e.children;return t?t[0]:e.t}function Sy(e){var t=e.children;return t?t[t.length-1]:e.t}function Pj(e,t,i){var r=i/(t.i-e.i);t.c-=r,t.s+=i,e.c+=r,t.z+=i,t.m+=i}function Dj(e){for(var t=0,i=0,r=e.children,o=r.length,a;--o>=0;)a=r[o],a.z+=t,a.m+=t,t+=a.s+(i+=a.c)}function Nj(e,t,i){return e.a.parent===t.parent?e.a:i}function qA(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}qA.prototype=Object.create(Of.prototype);function Oj(e){for(var t=new qA(e,0),i,r=[t],o,a,h,u;i=r.pop();)if(a=i._.children)for(i.children=new Array(u=a.length),h=u-1;h>=0;--h)r.push(o=i.children[h]=new qA(a[h],h)),o.parent=i;return(t.parent=new qA(null,0)).children=[t],t}function Pg(){var e=Lj,t=1,i=1,r=null;function o(c){var f=Oj(c);if(f.eachAfter(a),f.parent.m=-f.z,f.eachBefore(h),r)c.eachBefore(p);else{var g=c,m=c,v=c;c.eachBefore(function(x){x.x<g.x&&(g=x),x.x>m.x&&(m=x),x.depth>v.depth&&(v=x)});var A=g===m?1:e(g,m)/2,y=A-g.x,C=t/(m.x+A+y),E=i/(v.depth||1);c.eachBefore(function(x){x.x=(x.x+y)*C,x.y=x.depth*E})}return c}function a(c){var f=c.children,g=c.parent.children,m=c.i?g[c.i-1]:null;if(f){Dj(c);var v=(f[0].z+f[f.length-1].z)/2;m?(c.z=m.z+e(c._,m._),c.m=c.z-v):c.z=v}else m&&(c.z=m.z+e(c._,m._));c.parent.A=u(c,m,c.parent.A||g[0])}function h(c){c._.x=c.z+c.parent.m,c.m+=c.parent.m}function u(c,f,g){if(f){for(var m=c,v=c,A=f,y=m.parent.children[0],C=m.m,E=v.m,x=A.m,M=y.m,w;A=Sy(A),m=My(m),A&&m;)y=My(y),v=Sy(v),v.a=c,w=A.z+x-m.z-C+e(A._,m._),w>0&&(Pj(Nj(A,c,g),c,w),C+=w,E+=w),x+=A.m,C+=m.m,M+=y.m,E+=v.m;A&&!Sy(v)&&(v.t=A,v.m+=x-E),m&&!My(y)&&(y.t=m,y.m+=C-M,g=c)}return g}function p(c){c.x*=t,c.y=c.depth*i}return o.separation=function(c){return arguments.length?(e=c,o):e},o.size=function(c){return arguments.length?(r=!1,t=+c[0],i=+c[1],o):r?null:[t,i]},o.nodeSize=function(c){return arguments.length?(r=!0,t=+c[0],i=+c[1],o):r?[t,i]:null},o}function Sl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function x1(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const j2=Symbol("implicit");function oE(){var e=new Ju,t=[],i=[],r=j2;function o(a){let h=e.get(a);if(h===void 0){if(r!==j2)return r;e.set(a,h=t.push(a)-1)}return i[h%i.length]}return o.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Ju;for(const h of a)e.has(h)||e.set(h,t.push(h)-1);return o},o.range=function(a){return arguments.length?(i=Array.from(a),o):i.slice()},o.unknown=function(a){return arguments.length?(r=a,o):r},o.copy=function(){return oE(t,i).unknown(r)},Sl.apply(o,arguments),o}function M1(){var e=oE().unknown(void 0),t=e.domain,i=e.range,r=0,o=1,a,h,u=!1,p=0,c=0,f=.5;delete e.unknown;function g(){var m=t().length,v=o<r,A=v?o:r,y=v?r:o;a=(y-A)/Math.max(1,m-p+c*2),u&&(a=Math.floor(a)),A+=(y-A-a*(m-p))*f,h=a*(1-p),u&&(A=Math.round(A),h=Math.round(h));var C=Mn(m).map(function(E){return A+a*E});return i(v?C.reverse():C)}return e.domain=function(m){return arguments.length?(t(m),g()):t()},e.range=function(m){return arguments.length?([r,o]=m,r=+r,o=+o,g()):[r,o]},e.rangeRound=function(m){return[r,o]=m,r=+r,o=+o,u=!0,g()},e.bandwidth=function(){return h},e.step=function(){return a},e.round=function(m){return arguments.length?(u=!!m,g()):u},e.padding=function(m){return arguments.length?(p=Math.min(1,c=+m),g()):p},e.paddingInner=function(m){return arguments.length?(p=Math.min(1,m),g()):p},e.paddingOuter=function(m){return arguments.length?(c=+m,g()):c},e.align=function(m){return arguments.length?(f=Math.max(0,Math.min(1,m)),g()):f},e.copy=function(){return M1(t(),[r,o]).round(u).paddingInner(p).paddingOuter(c).align(f)},Sl.apply(g(),arguments)}function A5(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return A5(t())},e}function Fj(){return A5(M1.apply(null,arguments).paddingInner(1))}function kj(e){return function(){return e}}function W2(e){return+e}var RM=[0,1];function Ca(e){return e}function $2(e,t){return(t-=e=+e)?function(i){return(i-e)/t}:kj(isNaN(t)?NaN:.5)}function Uj(e,t){var i;return e>t&&(i=e,e=t,t=i),function(r){return Math.max(e,Math.min(t,r))}}function Gj(e,t,i){var r=e[0],o=e[1],a=t[0],h=t[1];return o<r?(r=$2(o,r),a=i(h,a)):(r=$2(r,o),a=i(a,h)),function(u){return a(r(u))}}function Vj(e,t,i){var r=Math.min(e.length,t.length)-1,o=new Array(r),a=new Array(r),h=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<r;)o[h]=$2(e[h],e[h+1]),a[h]=i(t[h],t[h+1]);return function(u){var p=lm(e,u,1,r)-1;return a[p](o[p](u))}}function pm(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function S1(){var e=RM,t=RM,i=fm,r,o,a,h=Ca,u,p,c;function f(){var m=Math.min(e.length,t.length);return h!==Ca&&(h=Uj(e[0],e[m-1])),u=m>2?Vj:Gj,p=c=null,g}function g(m){return m==null||isNaN(m=+m)?a:(p||(p=u(e.map(r),t,i)))(r(h(m)))}return g.invert=function(m){return h(o((c||(c=u(t,e.map(r),uo)))(m)))},g.domain=function(m){return arguments.length?(e=Array.from(m,W2),f()):e.slice()},g.range=function(m){return arguments.length?(t=Array.from(m),f()):t.slice()},g.rangeRound=function(m){return t=Array.from(m),i=Y_,f()},g.clamp=function(m){return arguments.length?(h=m?!0:Ca,f()):h!==Ca},g.interpolate=function(m){return arguments.length?(i=m,f()):i},g.unknown=function(m){return arguments.length?(a=m,g):a},function(m,v){return r=m,o=v,f()}}function g5(){return S1()(Ca,Ca)}function Qj(e,t,i,r){var o=A2(e,t,i),a;switch(r=Op(r??",f"),r.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=lz(o,h))&&(r.precision=a),LB(r,h)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=cz(o,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=az(o))&&(r.precision=a-(r.type==="%")*2);break}}return td(r)}function mm(e){var t=e.domain;return e.ticks=function(i){var r=t();return Mf(r[0],r[r.length-1],i??10)},e.tickFormat=function(i,r){var o=t();return Qj(o[0],o[o.length-1],i??10,r)},e.nice=function(i){i==null&&(i=10);var r=t(),o=0,a=r.length-1,h=r[o],u=r[a],p,c,f=10;for(u<h&&(c=h,h=u,u=c,c=o,o=a,a=c);f-- >0;){if(c=Zu(h,u,i),c===p)return r[o]=h,r[a]=u,t(r);if(c>0)h=Math.floor(h/c)*c,u=Math.ceil(u/c)*c;else if(c<0)h=Math.ceil(h*c)/c,u=Math.floor(u*c)/c;else break;p=c}return e},e}function T1(){var e=g5();return e.copy=function(){return pm(e,T1())},Sl.apply(e,arguments),mm(e)}function v5(e){var t;function i(r){return r==null||isNaN(r=+r)?t:r}return i.invert=i,i.domain=i.range=function(r){return arguments.length?(e=Array.from(r,W2),i):e.slice()},i.unknown=function(r){return arguments.length?(t=r,i):t},i.copy=function(){return v5(e).unknown(t)},e=arguments.length?Array.from(e,W2):[0,1],mm(i)}function b5(e,t){e=e.slice();var i=0,r=e.length-1,o=e[i],a=e[r],h;return a<o&&(h=i,i=r,r=h,h=o,o=a,a=h),e[i]=t.floor(o),e[r]=t.ceil(a),e}function LM(e){return Math.log(e)}function PM(e){return Math.exp(e)}function Hj(e){return-Math.log(-e)}function zj(e){return-Math.exp(-e)}function jj(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Wj(e){return e===10?jj:e===Math.E?Math.exp:t=>Math.pow(e,t)}function $j(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function DM(e){return(t,i)=>-e(-t,i)}function y5(e){const t=e(LM,PM),i=t.domain;let r=10,o,a;function h(){return o=$j(r),a=Wj(r),i()[0]<0?(o=DM(o),a=DM(a),e(Hj,zj)):e(LM,PM),t}return t.base=function(u){return arguments.length?(r=+u,h()):r},t.domain=function(u){return arguments.length?(i(u),h()):i()},t.ticks=u=>{const p=i();let c=p[0],f=p[p.length-1];const g=f<c;g&&([c,f]=[f,c]);let m=o(c),v=o(f),A,y;const C=u==null?10:+u;let E=[];if(!(r%1)&&v-m<C){if(m=Math.floor(m),v=Math.ceil(v),c>0){for(;m<=v;++m)for(A=1;A<r;++A)if(y=m<0?A/a(-m):A*a(m),!(y<c)){if(y>f)break;E.push(y)}}else for(;m<=v;++m)for(A=r-1;A>=1;--A)if(y=m>0?A/a(-m):A*a(m),!(y<c)){if(y>f)break;E.push(y)}E.length*2<C&&(E=Mf(c,f,C))}else E=Mf(m,v,Math.min(v-m,C)).map(a);return g?E.reverse():E},t.tickFormat=(u,p)=>{if(u==null&&(u=10),p==null&&(p=r===10?"s":","),typeof p!="function"&&(!(r%1)&&(p=Op(p)).precision==null&&(p.trim=!0),p=td(p)),u===1/0)return p;const c=Math.max(1,r*u/t.ticks().length);return f=>{let g=f/a(Math.round(o(f)));return g*r<r-.5&&(g*=r),g<=c?p(f):""}},t.nice=()=>i(b5(i(),{floor:u=>a(Math.floor(o(u))),ceil:u=>a(Math.ceil(o(u)))})),t}function _5(){const e=y5(S1()).domain([1,10]);return e.copy=()=>pm(e,_5()).base(e.base()),Sl.apply(e,arguments),e}function NM(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function OM(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function E5(e){var t=1,i=e(NM(t),OM(t));return i.constant=function(r){return arguments.length?e(NM(t=+r),OM(t)):t},mm(i)}function w5(){var e=E5(S1());return e.copy=function(){return pm(e,w5()).constant(e.constant())},Sl.apply(e,arguments)}function FM(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Xj(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Kj(e){return e<0?-e*e:e*e}function C5(e){var t=e(Ca,Ca),i=1;function r(){return i===1?e(Ca,Ca):i===.5?e(Xj,Kj):e(FM(i),FM(1/i))}return t.exponent=function(o){return arguments.length?(i=+o,r()):i},mm(t)}function x5(){var e=C5(S1());return e.copy=function(){return pm(e,x5()).exponent(e.exponent())},Sl.apply(e,arguments),e}function M5(){var e=[],t=[],i=[],r;function o(){var h=0,u=Math.max(1,t.length);for(i=new Array(u-1);++h<u;)i[h-1]=aG(e,h/u);return a}function a(h){return h==null||isNaN(h=+h)?r:t[lm(i,h)]}return a.invertExtent=function(h){var u=t.indexOf(h);return u<0?[NaN,NaN]:[u>0?i[u-1]:e[0],u<i.length?i[u]:e[e.length-1]]},a.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let u of h)u!=null&&!isNaN(u=+u)&&e.push(u);return e.sort(Vo),o()},a.range=function(h){return arguments.length?(t=Array.from(h),o()):t.slice()},a.unknown=function(h){return arguments.length?(r=h,a):r},a.quantiles=function(){return i.slice()},a.copy=function(){return M5().domain(e).range(t).unknown(r)},Sl.apply(a,arguments)}function S5(){var e=[.5],t=[0,1],i,r=1;function o(a){return a!=null&&a<=a?t[lm(e,a,0,r)]:i}return o.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(a){var h=t.indexOf(a);return[e[h-1],e[h]]},o.unknown=function(a){return arguments.length?(i=a,o):i},o.copy=function(){return S5().domain(e).range(t).unknown(i)},Sl.apply(o,arguments)}const Ty=new Date,Iy=new Date;function Fs(e,t,i,r){function o(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return o.floor=a=>(e(a=new Date(+a)),a),o.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),o.round=a=>{const h=o(a),u=o.ceil(a);return a-h<u-a?h:u},o.offset=(a,h)=>(t(a=new Date(+a),h==null?1:Math.floor(h)),a),o.range=(a,h,u)=>{const p=[];if(a=o.ceil(a),u=u==null?1:Math.floor(u),!(a<h)||!(u>0))return p;let c;do p.push(c=new Date(+a)),t(a,u),e(a);while(c<a&&a<h);return p},o.filter=a=>Fs(h=>{if(h>=h)for(;e(h),!a(h);)h.setTime(h-1)},(h,u)=>{if(h>=h)if(u<0)for(;++u<=0;)for(;t(h,-1),!a(h););else for(;--u>=0;)for(;t(h,1),!a(h););}),i&&(o.count=(a,h)=>(Ty.setTime(+a),Iy.setTime(+h),e(Ty),e(Iy),Math.floor(i(Ty,Iy))),o.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?o.filter(r?h=>r(h)%a===0:h=>o.count(0,h)%a===0):o)),o}const Dg=Fs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Dg.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Fs(t=>{t.setTime(Math.floor(t/e)*e)},(t,i)=>{t.setTime(+t+i*e)},(t,i)=>(i-t)/e):Dg);Dg.range;const oc=1e3,xa=oc*60,ac=xa*60,dc=ac*24,aE=dc*7,kM=dc*30,By=dc*365,ja=Fs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*oc)},(e,t)=>(t-e)/oc,e=>e.getUTCSeconds());ja.range;const Am=Fs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*oc)},(e,t)=>{e.setTime(+e+t*xa)},(e,t)=>(t-e)/xa,e=>e.getMinutes());Am.range;const gm=Fs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*xa)},(e,t)=>(t-e)/xa,e=>e.getUTCMinutes());gm.range;const vm=Fs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*oc-e.getMinutes()*xa)},(e,t)=>{e.setTime(+e+t*ac)},(e,t)=>(t-e)/ac,e=>e.getHours());vm.range;const bm=Fs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ac)},(e,t)=>(t-e)/ac,e=>e.getUTCHours());bm.range;const ch=Fs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xa)/dc,e=>e.getDate()-1);ch.range;const I1=Fs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/dc,e=>e.getUTCDate()-1);I1.range;const B1=Fs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/dc,e=>Math.floor(e/dc));B1.range;function uh(e){return Fs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,i)=>{t.setDate(t.getDate()+i*7)},(t,i)=>(i-t-(i.getTimezoneOffset()-t.getTimezoneOffset())*xa)/aE)}const Ff=uh(0),Up=uh(1),T5=uh(2),I5=uh(3),rh=uh(4),B5=uh(5),R5=uh(6);Ff.range;Up.range;T5.range;I5.range;rh.range;B5.range;R5.range;function hh(e){return Fs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCDate(t.getUTCDate()+i*7)},(t,i)=>(i-t)/aE)}const kf=hh(0),Gp=hh(1),L5=hh(2),P5=hh(3),sh=hh(4),D5=hh(5),N5=hh(6);kf.range;Gp.range;L5.range;P5.range;sh.range;D5.range;N5.range;const ym=Fs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());ym.range;const _m=Fs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());_m.range;const Ya=Fs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ya.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,i)=>{t.setFullYear(t.getFullYear()+i*e)});Ya.range;const qa=Fs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());qa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,i)=>{t.setUTCFullYear(t.getUTCFullYear()+i*e)});qa.range;function O5(e,t,i,r,o,a){const h=[[ja,1,oc],[ja,5,5*oc],[ja,15,15*oc],[ja,30,30*oc],[a,1,xa],[a,5,5*xa],[a,15,15*xa],[a,30,30*xa],[o,1,ac],[o,3,3*ac],[o,6,6*ac],[o,12,12*ac],[r,1,dc],[r,2,2*dc],[i,1,aE],[t,1,kM],[t,3,3*kM],[e,1,By]];function u(c,f,g){const m=f<c;m&&([c,f]=[f,c]);const v=g&&typeof g.range=="function"?g:p(c,f,g),A=v?v.range(c,+f+1):[];return m?A.reverse():A}function p(c,f,g){const m=Math.abs(f-c)/g,v=f1(([,,C])=>C).right(h,m);if(v===h.length)return e.every(A2(c/By,f/By,g));if(v===0)return Dg.every(Math.max(A2(c,f,g),1));const[A,y]=h[m/h[v-1][2]<h[v][2]/m?v-1:v];return A.every(y)}return[u,p]}const[Yj,F5]=O5(qa,_m,kf,B1,bm,gm),[qj,Jj]=O5(Ya,ym,Ff,ch,vm,Am);function Ry(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ly(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Yd(e,t,i){return{y:e,m:t,d:i,H:0,M:0,S:0,L:0}}function Zj(e){var t=e.dateTime,i=e.date,r=e.time,o=e.periods,a=e.days,h=e.shortDays,u=e.months,p=e.shortMonths,c=qd(o),f=Jd(o),g=qd(a),m=Jd(a),v=qd(h),A=Jd(h),y=qd(u),C=Jd(u),E=qd(p),x=Jd(p),M={a:Y,A:Q,b:G,B:J,c:null,d:zM,e:zM,f:EW,g:LW,G:DW,H:bW,I:yW,j:_W,L:k5,m:wW,M:CW,p:K,q:se,Q:$M,s:XM,S:xW,u:MW,U:SW,V:TW,w:IW,W:BW,x:null,X:null,y:RW,Y:PW,Z:NW,"%":WM},w={a:ue,A:he,b:Me,B:de,c:null,d:jM,e:jM,f:UW,g:KW,G:qW,H:OW,I:FW,j:kW,L:G5,m:GW,M:VW,p:Pe,q:Se,Q:$M,s:XM,S:QW,u:HW,U:zW,V:jW,w:WW,W:$W,x:null,X:null,y:XW,Y:YW,Z:JW,"%":WM},S={a:P,A:F,b:O,B:W,c:V,d:QM,e:QM,f:mW,g:VM,G:GM,H:HM,I:HM,j:hW,L:pW,m:uW,M:fW,p:k,q:cW,Q:gW,s:vW,S:dW,u:rW,U:sW,V:oW,w:iW,W:aW,x:$,X:H,y:VM,Y:GM,Z:lW,"%":AW};M.x=I(i,M),M.X=I(r,M),M.c=I(t,M),w.x=I(i,w),w.X=I(r,w),w.c=I(t,w);function I(Le,be){return function(je){var Te=[],rt=-1,mt=0,vt=Le.length,ft,Ze,St;for(je instanceof Date||(je=new Date(+je));++rt<vt;)Le.charCodeAt(rt)===37&&(Te.push(Le.slice(mt,rt)),(Ze=UM[ft=Le.charAt(++rt)])!=null?ft=Le.charAt(++rt):Ze=ft==="e"?" ":"0",(St=be[ft])&&(ft=St(je,Ze)),Te.push(ft),mt=rt+1);return Te.push(Le.slice(mt,rt)),Te.join("")}}function L(Le,be){return function(je){var Te=Yd(1900,void 0,1),rt=R(Te,Le,je+="",0),mt,vt;if(rt!=je.length)return null;if("Q"in Te)return new Date(Te.Q);if("s"in Te)return new Date(Te.s*1e3+("L"in Te?Te.L:0));if(be&&!("Z"in Te)&&(Te.Z=0),"p"in Te&&(Te.H=Te.H%12+Te.p*12),Te.m===void 0&&(Te.m="q"in Te?Te.q:0),"V"in Te){if(Te.V<1||Te.V>53)return null;"w"in Te||(Te.w=1),"Z"in Te?(mt=Ly(Yd(Te.y,0,1)),vt=mt.getUTCDay(),mt=vt>4||vt===0?Gp.ceil(mt):Gp(mt),mt=I1.offset(mt,(Te.V-1)*7),Te.y=mt.getUTCFullYear(),Te.m=mt.getUTCMonth(),Te.d=mt.getUTCDate()+(Te.w+6)%7):(mt=Ry(Yd(Te.y,0,1)),vt=mt.getDay(),mt=vt>4||vt===0?Up.ceil(mt):Up(mt),mt=ch.offset(mt,(Te.V-1)*7),Te.y=mt.getFullYear(),Te.m=mt.getMonth(),Te.d=mt.getDate()+(Te.w+6)%7)}else("W"in Te||"U"in Te)&&("w"in Te||(Te.w="u"in Te?Te.u%7:"W"in Te?1:0),vt="Z"in Te?Ly(Yd(Te.y,0,1)).getUTCDay():Ry(Yd(Te.y,0,1)).getDay(),Te.m=0,Te.d="W"in Te?(Te.w+6)%7+Te.W*7-(vt+5)%7:Te.w+Te.U*7-(vt+6)%7);return"Z"in Te?(Te.H+=Te.Z/100|0,Te.M+=Te.Z%100,Ly(Te)):Ry(Te)}}function R(Le,be,je,Te){for(var rt=0,mt=be.length,vt=je.length,ft,Ze;rt<mt;){if(Te>=vt)return-1;if(ft=be.charCodeAt(rt++),ft===37){if(ft=be.charAt(rt++),Ze=S[ft in UM?be.charAt(rt++):ft],!Ze||(Te=Ze(Le,je,Te))<0)return-1}else if(ft!=je.charCodeAt(Te++))return-1}return Te}function k(Le,be,je){var Te=c.exec(be.slice(je));return Te?(Le.p=f.get(Te[0].toLowerCase()),je+Te[0].length):-1}function P(Le,be,je){var Te=v.exec(be.slice(je));return Te?(Le.w=A.get(Te[0].toLowerCase()),je+Te[0].length):-1}function F(Le,be,je){var Te=g.exec(be.slice(je));return Te?(Le.w=m.get(Te[0].toLowerCase()),je+Te[0].length):-1}function O(Le,be,je){var Te=E.exec(be.slice(je));return Te?(Le.m=x.get(Te[0].toLowerCase()),je+Te[0].length):-1}function W(Le,be,je){var Te=y.exec(be.slice(je));return Te?(Le.m=C.get(Te[0].toLowerCase()),je+Te[0].length):-1}function V(Le,be,je){return R(Le,t,be,je)}function $(Le,be,je){return R(Le,i,be,je)}function H(Le,be,je){return R(Le,r,be,je)}function Y(Le){return h[Le.getDay()]}function Q(Le){return a[Le.getDay()]}function G(Le){return p[Le.getMonth()]}function J(Le){return u[Le.getMonth()]}function K(Le){return o[+(Le.getHours()>=12)]}function se(Le){return 1+~~(Le.getMonth()/3)}function ue(Le){return h[Le.getUTCDay()]}function he(Le){return a[Le.getUTCDay()]}function Me(Le){return p[Le.getUTCMonth()]}function de(Le){return u[Le.getUTCMonth()]}function Pe(Le){return o[+(Le.getUTCHours()>=12)]}function Se(Le){return 1+~~(Le.getUTCMonth()/3)}return{format:function(Le){var be=I(Le+="",M);return be.toString=function(){return Le},be},parse:function(Le){var be=L(Le+="",!1);return be.toString=function(){return Le},be},utcFormat:function(Le){var be=I(Le+="",w);return be.toString=function(){return Le},be},utcParse:function(Le){var be=L(Le+="",!0);return be.toString=function(){return Le},be}}}var UM={"-":"",_:" ",0:"0"},Ys=/^\s*\d+/,eW=/^%/,tW=/[\\^$*+?|[\]().{}]/g;function Ar(e,t,i){var r=e<0?"-":"",o=(r?-e:e)+"",a=o.length;return r+(a<i?new Array(i-a+1).join(t)+o:o)}function nW(e){return e.replace(tW,"\\$&")}function qd(e){return new RegExp("^(?:"+e.map(nW).join("|")+")","i")}function Jd(e){return new Map(e.map((t,i)=>[t.toLowerCase(),i]))}function iW(e,t,i){var r=Ys.exec(t.slice(i,i+1));return r?(e.w=+r[0],i+r[0].length):-1}function rW(e,t,i){var r=Ys.exec(t.slice(i,i+1));return r?(e.u=+r[0],i+r[0].length):-1}function sW(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.U=+r[0],i+r[0].length):-1}function oW(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.V=+r[0],i+r[0].length):-1}function aW(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.W=+r[0],i+r[0].length):-1}function GM(e,t,i){var r=Ys.exec(t.slice(i,i+4));return r?(e.y=+r[0],i+r[0].length):-1}function VM(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),i+r[0].length):-1}function lW(e,t,i){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(i,i+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),i+r[0].length):-1}function cW(e,t,i){var r=Ys.exec(t.slice(i,i+1));return r?(e.q=r[0]*3-3,i+r[0].length):-1}function uW(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.m=r[0]-1,i+r[0].length):-1}function QM(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.d=+r[0],i+r[0].length):-1}function hW(e,t,i){var r=Ys.exec(t.slice(i,i+3));return r?(e.m=0,e.d=+r[0],i+r[0].length):-1}function HM(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.H=+r[0],i+r[0].length):-1}function fW(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.M=+r[0],i+r[0].length):-1}function dW(e,t,i){var r=Ys.exec(t.slice(i,i+2));return r?(e.S=+r[0],i+r[0].length):-1}function pW(e,t,i){var r=Ys.exec(t.slice(i,i+3));return r?(e.L=+r[0],i+r[0].length):-1}function mW(e,t,i){var r=Ys.exec(t.slice(i,i+6));return r?(e.L=Math.floor(r[0]/1e3),i+r[0].length):-1}function AW(e,t,i){var r=eW.exec(t.slice(i,i+1));return r?i+r[0].length:-1}function gW(e,t,i){var r=Ys.exec(t.slice(i));return r?(e.Q=+r[0],i+r[0].length):-1}function vW(e,t,i){var r=Ys.exec(t.slice(i));return r?(e.s=+r[0],i+r[0].length):-1}function zM(e,t){return Ar(e.getDate(),t,2)}function bW(e,t){return Ar(e.getHours(),t,2)}function yW(e,t){return Ar(e.getHours()%12||12,t,2)}function _W(e,t){return Ar(1+ch.count(Ya(e),e),t,3)}function k5(e,t){return Ar(e.getMilliseconds(),t,3)}function EW(e,t){return k5(e,t)+"000"}function wW(e,t){return Ar(e.getMonth()+1,t,2)}function CW(e,t){return Ar(e.getMinutes(),t,2)}function xW(e,t){return Ar(e.getSeconds(),t,2)}function MW(e){var t=e.getDay();return t===0?7:t}function SW(e,t){return Ar(Ff.count(Ya(e)-1,e),t,2)}function U5(e){var t=e.getDay();return t>=4||t===0?rh(e):rh.ceil(e)}function TW(e,t){return e=U5(e),Ar(rh.count(Ya(e),e)+(Ya(e).getDay()===4),t,2)}function IW(e){return e.getDay()}function BW(e,t){return Ar(Up.count(Ya(e)-1,e),t,2)}function RW(e,t){return Ar(e.getFullYear()%100,t,2)}function LW(e,t){return e=U5(e),Ar(e.getFullYear()%100,t,2)}function PW(e,t){return Ar(e.getFullYear()%1e4,t,4)}function DW(e,t){var i=e.getDay();return e=i>=4||i===0?rh(e):rh.ceil(e),Ar(e.getFullYear()%1e4,t,4)}function NW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ar(t/60|0,"0",2)+Ar(t%60,"0",2)}function jM(e,t){return Ar(e.getUTCDate(),t,2)}function OW(e,t){return Ar(e.getUTCHours(),t,2)}function FW(e,t){return Ar(e.getUTCHours()%12||12,t,2)}function kW(e,t){return Ar(1+I1.count(qa(e),e),t,3)}function G5(e,t){return Ar(e.getUTCMilliseconds(),t,3)}function UW(e,t){return G5(e,t)+"000"}function GW(e,t){return Ar(e.getUTCMonth()+1,t,2)}function VW(e,t){return Ar(e.getUTCMinutes(),t,2)}function QW(e,t){return Ar(e.getUTCSeconds(),t,2)}function HW(e){var t=e.getUTCDay();return t===0?7:t}function zW(e,t){return Ar(kf.count(qa(e)-1,e),t,2)}function V5(e){var t=e.getUTCDay();return t>=4||t===0?sh(e):sh.ceil(e)}function jW(e,t){return e=V5(e),Ar(sh.count(qa(e),e)+(qa(e).getUTCDay()===4),t,2)}function WW(e){return e.getUTCDay()}function $W(e,t){return Ar(Gp.count(qa(e)-1,e),t,2)}function XW(e,t){return Ar(e.getUTCFullYear()%100,t,2)}function KW(e,t){return e=V5(e),Ar(e.getUTCFullYear()%100,t,2)}function YW(e,t){return Ar(e.getUTCFullYear()%1e4,t,4)}function qW(e,t){var i=e.getUTCDay();return e=i>=4||i===0?sh(e):sh.ceil(e),Ar(e.getUTCFullYear()%1e4,t,4)}function JW(){return"+0000"}function WM(){return"%"}function $M(e){return+e}function XM(e){return Math.floor(+e/1e3)}var tf,lE,Em;ZW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ZW(e){return tf=Zj(e),lE=tf.format,tf.parse,Em=tf.utcFormat,tf.utcParse,tf}function e$(e){return new Date(e)}function t$(e){return e instanceof Date?+e:+new Date(+e)}function cE(e,t,i,r,o,a,h,u,p,c){var f=g5(),g=f.invert,m=f.domain,v=c(".%L"),A=c(":%S"),y=c("%I:%M"),C=c("%I %p"),E=c("%a %d"),x=c("%b %d"),M=c("%B"),w=c("%Y");function S(I){return(p(I)<I?v:u(I)<I?A:h(I)<I?y:a(I)<I?C:r(I)<I?o(I)<I?E:x:i(I)<I?M:w)(I)}return f.invert=function(I){return new Date(g(I))},f.domain=function(I){return arguments.length?m(Array.from(I,t$)):m().map(e$)},f.ticks=function(I){var L=m();return e(L[0],L[L.length-1],I??10)},f.tickFormat=function(I,L){return L==null?S:c(L)},f.nice=function(I){var L=m();return(!I||typeof I.range!="function")&&(I=t(L[0],L[L.length-1],I??10)),I?m(b5(L,I)):f},f.copy=function(){return pm(f,cE(e,t,i,r,o,a,h,u,p,c))},f}function n$(){return Sl.apply(cE(qj,Jj,Ya,ym,Ff,ch,vm,Am,ja,lE).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function i$(){return Sl.apply(cE(Yj,F5,qa,_m,kf,I1,bm,gm,ja,Em).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function R1(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function L1(){var e=0,t=.5,i=1,r=1,o,a,h,u,p,c=Ca,f,g=!1,m;function v(y){return isNaN(y=+y)?m:(y=.5+((y=+f(y))-a)*(r*y<r*a?u:p),c(g?Math.max(0,Math.min(1,y)):y))}v.domain=function(y){return arguments.length?([e,t,i]=y,o=f(e=+e),a=f(t=+t),h=f(i=+i),u=o===a?0:.5/(a-o),p=a===h?0:.5/(h-a),r=a<o?-1:1,v):[e,t,i]},v.clamp=function(y){return arguments.length?(g=!!y,v):g},v.interpolator=function(y){return arguments.length?(c=y,v):c};function A(y){return function(C){var E,x,M;return arguments.length?([E,x,M]=C,c=b1(y,[E,x,M]),v):[c(0),c(.5),c(1)]}}return v.range=A(fm),v.rangeRound=A(Y_),v.unknown=function(y){return arguments.length?(m=y,v):m},function(y){return f=y,o=y(e),a=y(t),h=y(i),u=o===a?0:.5/(a-o),p=a===h?0:.5/(h-a),r=a<o?-1:1,v}}function Q5(){var e=mm(L1()(Ca));return e.copy=function(){return R1(e,Q5())},x1.apply(e,arguments)}function H5(){var e=y5(L1()).domain([.1,1,10]);return e.copy=function(){return R1(e,H5()).base(e.base())},x1.apply(e,arguments)}function z5(){var e=E5(L1());return e.copy=function(){return R1(e,z5()).constant(e.constant())},x1.apply(e,arguments)}function j5(){var e=C5(L1());return e.copy=function(){return R1(e,j5()).exponent(e.exponent())},x1.apply(e,arguments)}function Li(e){for(var t=e.length/6|0,i=new Array(t),r=0;r<t;)i[r]="#"+e.slice(r*6,++r*6);return i}const r$=Li("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),s$=Li("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),o$=Li("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Vp=Li("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),a$=Li("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),l$=Li("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),c$=Li("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),u$=Li("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),h$=Li("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),f$=Li("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),d$=Li("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ur=e=>EQ(e[e.length-1]);var W5=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Li);const $5=Ur(W5);var X5=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Li);const K5=Ur(X5);var Y5=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Li);const q5=Ur(Y5);var J5=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Li);const Z5=Ur(J5);var X2=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Li);const Ng=Ur(X2);var eR=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Li);const tR=Ur(eR);var K2=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Li);const Og=Ur(K2);var nR=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Li);const iR=Ur(nR);var rR=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Li);const sR=Ur(rR);var oR=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Li);const aR=Ur(oR);var lR=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Li);const cR=Ur(lR);var uR=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Li);const hR=Ur(uR);var fR=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Li);const dR=Ur(fR);var pR=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Li);const mR=Ur(pR);var AR=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Li);const gR=Ur(AR);var vR=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Li);const bR=Ur(vR);var yR=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Li);const _R=Ur(yR);var ER=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Li);const wR=Ur(ER);var CR=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Li);const xR=Ur(CR);var MR=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Li);const SR=Ur(MR);var TR=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Li);const IR=Ur(TR);var BR=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Li);const RR=Ur(BR);var LR=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Li);const PR=Ur(LR);var DR=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Li);const NR=Ur(DR);var OR=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Li);const FR=Ur(OR);var kR=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Li);const UR=Ur(kR);var GR=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Li);const VR=Ur(GR);function QR(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const HR=q_(wl(300,.5,0),wl(-240,.5,1));var zR=q_(wl(-100,.75,.35),wl(80,1.5,.8)),jR=q_(wl(260,.75,.35),wl(80,1.5,.8)),DA=wl();function WR(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return DA.h=360*e-100,DA.s=1.5-1.5*t,DA.l=.8-.9*t,DA+""}var NA=qc(),p$=Math.PI/3,m$=Math.PI*2/3;function $R(e){var t;return e=(.5-e)*Math.PI,NA.r=255*(t=Math.sin(e))*t,NA.g=255*(t=Math.sin(e+p$))*t,NA.b=255*(t=Math.sin(e+m$))*t,NA+""}function XR(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function P1(e){var t=e.length;return function(i){return e[Math.max(0,Math.min(t-1,Math.floor(i*t)))]}}const uE=P1(Li("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var KR=P1(Li("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),YR=P1(Li("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),qR=P1(Li("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function js(e){return function(){return e}}const JR=Math.cos,hE=Math.min,Fg=Math.sin,ks=Math.sqrt,KM=1e-12,kg=Math.PI,D1=2*kg;function ZR(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{const r=Math.floor(i);if(!(r>=0))throw new RangeError(`invalid digits: ${i}`);t=r}return e},()=>new BB(t)}function e6(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function t6(e){this._context=e}t6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function wm(e){return new t6(e)}function n6(e){return e[0]}function i6(e){return e[1]}function r6(e,t){var i=js(!0),r=null,o=wm,a=null,h=ZR(u);e=typeof e=="function"?e:e===void 0?n6:js(e),t=typeof t=="function"?t:t===void 0?i6:js(t);function u(p){var c,f=(p=e6(p)).length,g,m=!1,v;for(r==null&&(a=o(v=h())),c=0;c<=f;++c)!(c<f&&i(g=p[c],c,p))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+e(g,c,p),+t(g,c,p));if(v)return a=null,v+""||null}return u.x=function(p){return arguments.length?(e=typeof p=="function"?p:js(+p),u):e},u.y=function(p){return arguments.length?(t=typeof p=="function"?p:js(+p),u):t},u.defined=function(p){return arguments.length?(i=typeof p=="function"?p:js(!!p),u):i},u.curve=function(p){return arguments.length?(o=p,r!=null&&(a=o(r)),u):o},u.context=function(p){return arguments.length?(p==null?r=a=null:a=o(r=p),u):r},u}function A$(e,t,i){var r=null,o=js(!0),a=null,h=wm,u=null,p=ZR(c);e=typeof e=="function"?e:e===void 0?n6:js(+e),t=typeof t=="function"?t:js(t===void 0?0:+t),i=typeof i=="function"?i:i===void 0?i6:js(+i);function c(g){var m,v,A,y=(g=e6(g)).length,C,E=!1,x,M=new Array(y),w=new Array(y);for(a==null&&(u=h(x=p())),m=0;m<=y;++m){if(!(m<y&&o(C=g[m],m,g))===E)if(E=!E)v=m,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),A=m-1;A>=v;--A)u.point(M[A],w[A]);u.lineEnd(),u.areaEnd()}E&&(M[m]=+e(C,m,g),w[m]=+t(C,m,g),u.point(r?+r(C,m,g):M[m],i?+i(C,m,g):w[m]))}if(x)return u=null,x+""||null}function f(){return r6().defined(o).curve(h).context(a)}return c.x=function(g){return arguments.length?(e=typeof g=="function"?g:js(+g),r=null,c):e},c.x0=function(g){return arguments.length?(e=typeof g=="function"?g:js(+g),c):e},c.x1=function(g){return arguments.length?(r=g==null?null:typeof g=="function"?g:js(+g),c):r},c.y=function(g){return arguments.length?(t=typeof g=="function"?g:js(+g),i=null,c):t},c.y0=function(g){return arguments.length?(t=typeof g=="function"?g:js(+g),c):t},c.y1=function(g){return arguments.length?(i=g==null?null:typeof g=="function"?g:js(+g),c):i},c.lineX0=c.lineY0=function(){return f().x(e).y(t)},c.lineY1=function(){return f().x(e).y(i)},c.lineX1=function(){return f().x(r).y(t)},c.defined=function(g){return arguments.length?(o=typeof g=="function"?g:js(!!g),c):o},c.curve=function(g){return arguments.length?(h=g,a!=null&&(u=h(a)),c):h},c.context=function(g){return arguments.length?(g==null?a=u=null:u=h(a=g),c):a},c}class s6{constructor(t,i){this._context=t,this._x=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,i){switch(t=+t,i=+i,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,i):this._context.moveTo(t,i);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,i,t,i):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+i)/2,t,this._y0,t,i);break}}this._x0=t,this._y0=i}}function g$(e){return new s6(e,!0)}function v$(e){return new s6(e,!1)}const b$=ks(3),o6={draw(e,t){const i=ks(t+hE(t/28,.75))*.59436,r=i/2,o=r*b$;e.moveTo(0,i),e.lineTo(0,-i),e.moveTo(-o,-r),e.lineTo(o,r),e.moveTo(-o,r),e.lineTo(o,-r)}},Qp={draw(e,t){const i=ks(t/kg);e.moveTo(i,0),e.arc(0,0,i,0,D1)}},a6={draw(e,t){const i=ks(t/5)/2;e.moveTo(-3*i,-i),e.lineTo(-i,-i),e.lineTo(-i,-3*i),e.lineTo(i,-3*i),e.lineTo(i,-i),e.lineTo(3*i,-i),e.lineTo(3*i,i),e.lineTo(i,i),e.lineTo(i,3*i),e.lineTo(-i,3*i),e.lineTo(-i,i),e.lineTo(-3*i,i),e.closePath()}},l6=ks(1/3),y$=l6*2,c6={draw(e,t){const i=ks(t/y$),r=i*l6;e.moveTo(0,-i),e.lineTo(r,0),e.lineTo(0,i),e.lineTo(-r,0),e.closePath()}},u6={draw(e,t){const i=ks(t)*.62625;e.moveTo(0,-i),e.lineTo(i,0),e.lineTo(0,i),e.lineTo(-i,0),e.closePath()}},h6={draw(e,t){const i=ks(t-hE(t/7,2))*.87559;e.moveTo(-i,0),e.lineTo(i,0),e.moveTo(0,i),e.lineTo(0,-i)}},f6={draw(e,t){const i=ks(t),r=-i/2;e.rect(r,r,i,i)}},d6={draw(e,t){const i=ks(t)*.4431;e.moveTo(i,i),e.lineTo(i,-i),e.lineTo(-i,-i),e.lineTo(-i,i),e.closePath()}},_$=.8908130915292852,p6=Fg(kg/10)/Fg(7*kg/10),E$=Fg(D1/10)*p6,w$=-JR(D1/10)*p6,m6={draw(e,t){const i=ks(t*_$),r=E$*i,o=w$*i;e.moveTo(0,-i),e.lineTo(r,o);for(let a=1;a<5;++a){const h=D1*a/5,u=JR(h),p=Fg(h);e.lineTo(p*i,-u*i),e.lineTo(u*r-p*o,p*r+u*o)}e.closePath()}},Py=ks(3),A6={draw(e,t){const i=-ks(t/(Py*3));e.moveTo(0,i*2),e.lineTo(-Py*i,-i),e.lineTo(Py*i,-i),e.closePath()}},C$=ks(3),g6={draw(e,t){const i=ks(t)*.6824,r=i/2,o=i*C$/2;e.moveTo(0,-i),e.lineTo(o,r),e.lineTo(-o,r),e.closePath()}},ba=-.5,ya=ks(3)/2,Y2=1/ks(12),x$=(Y2/2+1)*3,v6={draw(e,t){const i=ks(t/x$),r=i/2,o=i*Y2,a=r,h=i*Y2+i,u=-a,p=h;e.moveTo(r,o),e.lineTo(a,h),e.lineTo(u,p),e.lineTo(ba*r-ya*o,ya*r+ba*o),e.lineTo(ba*a-ya*h,ya*a+ba*h),e.lineTo(ba*u-ya*p,ya*u+ba*p),e.lineTo(ba*r+ya*o,ba*o-ya*r),e.lineTo(ba*a+ya*h,ba*h-ya*a),e.lineTo(ba*u+ya*p,ba*p-ya*u),e.closePath()}},b6={draw(e,t){const i=ks(t-hE(t/6,1.7))*.6189;e.moveTo(-i,-i),e.lineTo(i,i),e.moveTo(-i,i),e.lineTo(i,-i)}},M$=[Qp,a6,c6,f6,m6,A6,v6],S$=[Qp,h6,b6,g6,o6,d6,u6];function Jc(){}function Ug(e,t,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+i)/6)}function N1(e){this._context=e}N1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ug(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ug(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function T$(e){return new N1(e)}function y6(e){this._context=e}y6.prototype={areaStart:Jc,areaEnd:Jc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ug(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function I$(e){return new y6(e)}function _6(e){this._context=e}_6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(i,r):this._context.moveTo(i,r);break;case 3:this._point=4;default:Ug(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function B$(e){return new _6(e)}function E6(e,t){this._basis=new N1(e),this._beta=t}E6.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,i=e.length-1;if(i>0)for(var r=e[0],o=t[0],a=e[i]-r,h=t[i]-o,u=-1,p;++u<=i;)p=u/i,this._basis.point(this._beta*e[u]+(1-this._beta)*(r+p*a),this._beta*t[u]+(1-this._beta)*(o+p*h));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const R$=function e(t){function i(r){return t===1?new N1(r):new E6(r,t)}return i.beta=function(r){return e(+r)},i}(.85);function Gg(e,t,i){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-i),e._x2,e._y2)}function fE(e,t){this._context=e,this._k=(1-t)/6}fE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Gg(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const L$=function e(t){function i(r){return new fE(r,t)}return i.tension=function(r){return e(+r)},i}(0);function dE(e,t){this._context=e,this._k=(1-t)/6}dE.prototype={areaStart:Jc,areaEnd:Jc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const P$=function e(t){function i(r){return new dE(r,t)}return i.tension=function(r){return e(+r)},i}(0);function pE(e,t){this._context=e,this._k=(1-t)/6}pE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const D$=function e(t){function i(r){return new pE(r,t)}return i.tension=function(r){return e(+r)},i}(0);function mE(e,t,i){var r=e._x1,o=e._y1,a=e._x2,h=e._y2;if(e._l01_a>KM){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,p=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/p,o=(o*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/p}if(e._l23_a>KM){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*c+e._x1*e._l23_2a-t*e._l12_2a)/f,h=(h*c+e._y1*e._l23_2a-i*e._l12_2a)/f}e._context.bezierCurveTo(r,o,a,h,e._x2,e._y2)}function w6(e,t){this._context=e,this._alpha=t}w6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var i=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:mE(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const N$=function e(t){function i(r){return t?new w6(r,t):new fE(r,0)}return i.alpha=function(r){return e(+r)},i}(.5);function C6(e,t){this._context=e,this._alpha=t}C6.prototype={areaStart:Jc,areaEnd:Jc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var i=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:mE(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const O$=function e(t){function i(r){return t?new C6(r,t):new dE(r,0)}return i.alpha=function(r){return e(+r)},i}(.5);function x6(e,t){this._context=e,this._alpha=t}x6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var i=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:mE(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const F$=function e(t){function i(r){return t?new x6(r,t):new pE(r,0)}return i.alpha=function(r){return e(+r)},i}(.5);function M6(e){this._context=e}M6.prototype={areaStart:Jc,areaEnd:Jc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function k$(e){return new M6(e)}function YM(e){return e<0?-1:1}function qM(e,t,i){var r=e._x1-e._x0,o=t-e._x1,a=(e._y1-e._y0)/(r||o<0&&-0),h=(i-e._y1)/(o||r<0&&-0),u=(a*o+h*r)/(r+o);return(YM(a)+YM(h))*Math.min(Math.abs(a),Math.abs(h),.5*Math.abs(u))||0}function JM(e,t){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function Dy(e,t,i){var r=e._x0,o=e._y0,a=e._x1,h=e._y1,u=(a-r)/3;e._context.bezierCurveTo(r+u,o+u*t,a-u,h-u*i,a,h)}function Vg(e){this._context=e}Vg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Dy(this,this._t0,JM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var i=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Dy(this,JM(this,i=qM(this,e,t)),i);break;default:Dy(this,this._t0,i=qM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}};function S6(e){this._context=new T6(e)}(S6.prototype=Object.create(Vg.prototype)).point=function(e,t){Vg.prototype.point.call(this,t,e)};function T6(e){this._context=e}T6.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,i,r,o,a){this._context.bezierCurveTo(t,e,r,i,a,o)}};function U$(e){return new Vg(e)}function G$(e){return new S6(e)}function I6(e){this._context=e}I6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,i=e.length;if(i)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),i===2)this._context.lineTo(e[1],t[1]);else for(var r=ZM(e),o=ZM(t),a=0,h=1;h<i;++a,++h)this._context.bezierCurveTo(r[0][a],o[0][a],r[1][a],o[1][a],e[h],t[h]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ZM(e){var t,i=e.length-1,r,o=new Array(i),a=new Array(i),h=new Array(i);for(o[0]=0,a[0]=2,h[0]=e[0]+2*e[1],t=1;t<i-1;++t)o[t]=1,a[t]=4,h[t]=4*e[t]+2*e[t+1];for(o[i-1]=2,a[i-1]=7,h[i-1]=8*e[i-1]+e[i],t=1;t<i;++t)r=o[t]/a[t-1],a[t]-=r,h[t]-=r*h[t-1];for(o[i-1]=h[i-1]/a[i-1],t=i-2;t>=0;--t)o[t]=(h[t]-o[t+1])/a[t];for(a[i-1]=(e[i]+o[i-1])/2,t=0;t<i-1;++t)a[t]=2*e[t+1]-o[t+1];return[o,a]}function V$(e){return new I6(e)}function O1(e,t){this._context=e,this._t=t}O1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,t)}break}}this._x=e,this._y=t}};function Q$(e){return new O1(e,.5)}function H$(e){return new O1(e,0)}function z$(e){return new O1(e,1)}function up(e,t,i){this.k=e,this.x=t,this.y=i}up.prototype={constructor:up,scale:function(e){return e===1?this:new up(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new up(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};up.prototype;function j$(e){return 60*1/e}function B6(e,t){return Mn(Math.ceil(e/12)*12,t+1,12)}function Jr(e,t,i){return e<t?t:e>i?i:e}function R6(e){return new Promise(t=>{setTimeout(t,e*1e3)})}function eS(e,t){return e.has(t)?e.delete(t):e.add(t),new Set(e)}function tS(e,t){for(const i of t)if(e.has(i))return!0;return!1}function nS(e,t){return Math.round(e/t)*t}const q2="demo-settings",J2="usage";function W$(){let e=0,t,i;for(i in localStorage)localStorage.hasOwnProperty(i)&&(t=(localStorage[i].length+i.length)*2,e+=t);return e/1024}function $$(){let e=" ",t=0;for(;;){try{localStorage.setItem("__test__",e)}catch{break}e=`${e}${e}`,t=e.length}return localStorage.removeItem("__test__"),t*2/1024}function X$(){const e=W$(),t=$$();return{currentKb:e,limitKb:t,percentFull:e/t*100}}function L6(){let e;return localStorage.getItem(J2)!==null?(e=localStorage.getItem(J2),e=JSON.parse(e)):e={demoClicks:{},demoRecordedData:{}},e}function K$(e){try{localStorage.setItem(J2,JSON.stringify(e))}catch(t){alert("localStorage might be full: "+t.toString())}}function iS(e){const t=localStorage.getItem(q2);if(t)return JSON.parse(t)[e]}function AE(e,t){const i=L6();console.log(i),i.demoRecordedData||(i.demoRecordedData={}),i.demoRecordedData[e]||(i.demoRecordedData[e]=[]),console.log(i),i.demoRecordedData[e].push({date:new Date().toISOString(),data:t}),K$(i)}const Yr="",qr="",rS="",sS="",oS="",aS="";var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P6={exports:{}};(function(e,t){(function(i,r){r()})(Zd,function(){function i(c,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,f,g){var m=new XMLHttpRequest;m.open("GET",c),m.responseType="blob",m.onload=function(){p(m.response,f,g)},m.onerror=function(){console.error("could not download file")},m.send()}function o(c){var f=new XMLHttpRequest;f.open("HEAD",c,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function a(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(f)}}var h=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Zd=="object"&&Zd.global===Zd?Zd:void 0,u=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=h.saveAs||(typeof window!="object"||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(c,f,g){var m=h.URL||h.webkitURL,v=document.createElement("a");f=f||c.name||"download",v.download=f,v.rel="noopener",typeof c=="string"?(v.href=c,v.origin===location.origin?a(v):o(v.href)?r(c,f,g):a(v,v.target="_blank")):(v.href=m.createObjectURL(c),setTimeout(function(){m.revokeObjectURL(v.href)},4e4),setTimeout(function(){a(v)},0))}:"msSaveOrOpenBlob"in navigator?function(c,f,g){if(f=f||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(i(c,g),f);else if(o(c))r(c,f,g);else{var m=document.createElement("a");m.href=c,m.target="_blank",setTimeout(function(){a(m)})}}:function(c,f,g,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof c=="string")return r(c,f,g);var v=c.type==="application/octet-stream",A=/constructor/i.test(h.HTMLElement)||h.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||v&&A||u)&&typeof FileReader<"u"){var C=new FileReader;C.onloadend=function(){var M=C.result;M=y?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=M:location=M,m=null},C.readAsDataURL(c)}else{var E=h.URL||h.webkitURL,x=E.createObjectURL(c);m?m.location=x:location.href=x,m=null,setTimeout(function(){E.revokeObjectURL(x)},4e4)}});h.saveAs=p.saveAs=p,e.exports=p})})(P6);var Y$=P6.exports;const D6=gE(Y$),lc=[{title:"timing",children:[{id:"sub-division",title:"playing to grid",description:"Note onsets should follow a sub-division of beats consistently, for example playing straight eighth notes or quarter triplets"},{id:"tempo-keeping",title:"tempo keeping",description:"The tempo should be kept same over a longer stretch of time without the help of a metronome"},{id:"chord-timing",title:"chord timing",description:"Notes in a chord should start at the same time and the time between chords should be consistent"},{id:"arpeggio-timing",title:"arpeggio timing",description:"Notes in an arpeggio should be spaced out evenly and the time between arpeggios should be consistent"},{id:"swing-feel",title:"swing feel",description:"Playing a swing feel, meaning that every even (sub)beat is shifted in time consistently by the intended amount"},{id:"timing-consistency",title:"timing consistency",description:"When playing the same musical pattern multiple times, the timing should be similar"},{id:"rests",title:"rests",description:"Notes should stop in time for a rest"},{id:"syncopation",title:"syncopation",description:"When playing different rhythms together, the timing should be on grid"}]},{title:"pitch",children:[{id:"on-pitch",title:"on pitch",description:"When playing a melody, the notes' pitches should be hit correctly"},{id:"pitch-intervals",title:"intervals",description:"In improvisation, the intervals between consecutive notes should match the intended harmony or dissonance"},{id:"scale-degrees",title:"scale degrees",description:"In improvisation, scale degrees should be used to appropriate amounts"},{id:"chord-notes",title:"chord notes",description:"The notes in a chord should be played as planned or chosen to match the intended harmony or dissonance"},{id:"pitch-keeping",title:"pitch keeping",description:"The pitch should start and stay at the intended note"},{id:"bending",title:"bending",description:"Bends should reach and stay at the intended semitone, the bend should start and end as quickly as intended"},{id:"vibrato",title:"vibrato",description:"Vibratos should have the intended shift in pitch and the intended frequency of modulation"}]},{title:"dynamics",children:[{id:"constant-dynamics",title:"constant dynamics",description:"Notes should have the same loudness"},{id:"accents",title:"accents",description:"Important notes should be louder than others, for example to higlight the first of a group of 3 or 4 notes"},{id:"(de)crescendo",title:"(de-) crescendo",description:"When getting louder/quiter, the loudness should in- or decrease smoothly"}]},{title:"instrument",children:[{id:"instrument-layout",title:"instrument layout",description:"The musician should know where notes are played on the instrument and use different parts of it appropriately"},{id:"strumming-direction",title:"strumming direction",description:"Chords should be strummed in the intended direction"},{id:"strumming-strings",title:"strumming strings",description:"Only the intended strings should be strummed"}]}];function N6(e){let t=[];for(const i of e)i.id?t.push(i):t=[...t,...N6(i.children)];return t}const q$=N6(lc);function lS(e,t,i){const r=e.slice();return r[7]=t[i],r}function cS(e,t,i){const r=e.slice();return r[10]=t[i],r}function uS(e){let t,i=fn(e[7].children),r=[];for(let o=0;o<i.length;o+=1)r[o]=hS(cS(e,i,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();t=Zf()},m(o,a){for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(o,a);Bt(o,t,a)},p(o,a){if(a&5){i=fn(o[7].children);let h;for(h=0;h<i.length;h+=1){const u=cS(o,i,h);r[h]?r[h].p(u,a):(r[h]=hS(u),r[h].c(),r[h].m(t.parentNode,t))}for(;h<r.length;h+=1)r[h].d(1);r.length=i.length}},d(o){o&&It(t),ti(r,o)}}}function hS(e){let t,i=e[10].title+"",r,o,a,h;function u(){return e[6](e[10])}return{c(){t=oe("button"),r=$e(i),o=ge(),fe(t,"class","skill svelte-m042vp")},m(p,c){Bt(p,t,c),D(t,r),D(t,o),a||(h=lt(t,"click",u),a=!0)},p(p,c){e=p,c&4&&i!==(i=e[10].title+"")&&jt(r,i)},d(p){p&&It(t),a=!1,h()}}}function fS(e){let t,i=(e[7].shown?rS:sS)+"",r,o,a=e[7].title+"",h,u,p,c,f;function g(){return e[5](e[7])}let m=e[7].shown&&uS(e);return{c(){t=oe("button"),r=$e(i),o=ge(),h=$e(a),u=ge(),m&&m.c(),p=Zf(),fe(t,"class","node svelte-m042vp")},m(v,A){Bt(v,t,A),D(t,r),D(t,o),D(t,h),Bt(v,u,A),m&&m.m(v,A),Bt(v,p,A),c||(f=lt(t,"click",g),c=!0)},p(v,A){e=v,A&4&&i!==(i=(e[7].shown?rS:sS)+"")&&jt(r,i),A&4&&a!==(a=e[7].title+"")&&jt(h,a),e[7].shown?m?m.p(e,A):(m=uS(e),m.c(),m.m(p.parentNode,p)):m&&(m.d(1),m=null)},d(v){v&&(It(t),It(u),It(p)),m&&m.d(v),c=!1,f()}}}function J$(e){let t,i,r,o,a,h,u,p=fn(e[2]),c=[];for(let f=0;f<p.length;f+=1)c[f]=fS(lS(e,p,f));return{c(){t=oe("main"),i=oe("h2"),i.textContent="skills",r=ge(),o=oe("button"),o.textContent="show all",a=ge();for(let f=0;f<c.length;f+=1)c[f].c();fe(t,"class","svelte-m042vp")},m(f,g){Bt(f,t,g),D(t,i),D(t,r),D(t,o),D(t,a);for(let m=0;m<c.length;m+=1)c[m]&&c[m].m(t,null);h||(u=lt(o,"click",e[4]),h=!0)},p(f,[g]){if(g&13){p=fn(f[2]);let m;for(m=0;m<p.length;m+=1){const v=lS(f,p,m);c[m]?c[m].p(v,g):(c[m]=fS(v),c[m].c(),c[m].m(t,null))}for(;m<c.length;m+=1)c[m].d(1);c.length=p.length}},i:gn,o:gn,d(f){f&&It(t),ti(c,f),h=!1,u()}}}function Z$(e,t,i){let{allSkills:r=new Set}=t,{currentSkills:o=new Set}=t,a=lc;const h=f=>{const g=!f.shown;g&&a.flat(1/0).forEach(m=>m.shown=!1),f.shown=g,i(2,a=[...a])},u=()=>i(0,o=r),p=f=>h(f),c=f=>i(0,o=new Set([f.id]));return e.$$set=f=>{"allSkills"in f&&i(1,r=f.allSkills),"currentSkills"in f&&i(0,o=f.currentSkills)},[o,r,a,h,u,p,c]}class eX extends pi{constructor(t){super(),di(this,t,Z$,J$,fi,{allSkills:1,currentSkills:0})}}function O6(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function F6(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"&&!isNaN(e.step)&&!isNaN(e.alt)}var k6=[0,2,4,-1,1,3,5],U6=k6.map(e=>Math.floor(e*7/12));function G6(e){const{step:t,alt:i,oct:r,dir:o=1}=e,a=k6[t]+7*i;if(r===void 0)return[o*a];const h=r-U6[t]-4*i;return[o*a,o*h]}var tX=[3,0,4,1,5,2,6];function nX(e){const[t,i,r]=e,o=tX[iX(t)],a=Math.floor((t+1)/7);if(i===void 0)return{step:o,alt:a,dir:r};const h=i+4*a+U6[o];return{step:o,alt:a,oct:h,dir:r}}function iX(e){const t=(e+1)%7;return t<0?7+t:t}var dS=(e,t)=>Array(Math.abs(t)+1).join(e),Z2=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),rX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",sX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",oX=new RegExp("^"+rX+"|"+sX+"$");function aX(e){const t=oX.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var pS={};function Qg(e){return typeof e=="string"?pS[e]||(pS[e]=lX(e)):F6(e)?Qg(uX(e)):O6(e)?Qg(e.name):Z2}var mS=[0,2,4,5,7,9,11],V6="PMMPPMM";function lX(e){const t=aX(e);if(t[0]==="")return Z2;const i=+t[0],r=t[1],o=(Math.abs(i)-1)%7,a=V6[o];if(a==="M"&&r==="P")return Z2;const h=a==="M"?"majorable":"perfectable",u=""+i+r,p=i<0?-1:1,c=i===8||i===-8?i:p*(o+1),f=cX(h,r),g=Math.floor((Math.abs(i)-1)/7),m=p*(mS[o]+f+12*g),v=(p*(mS[o]+f)%12+12)%12,A=G6({step:o,alt:f,oct:g,dir:p});return{empty:!1,name:u,num:i,q:r,step:o,alt:f,dir:p,type:h,simple:c,semitones:m,chroma:v,coord:A,oct:g}}function cX(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function uX(e){const{step:t,alt:i,oct:r=0,dir:o}=e;if(!o)return"";const a=t+1+7*r,h=a===0?t+1:a,u=o<0?"-":"",p=V6[t]==="M"?"majorable":"perfectable";return u+h+hX(p,i)}function hX(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?dS("A",t):dS("d",e==="perfectable"?t:t+1)}var AS=(e,t)=>Array(Math.abs(t)+1).join(e),Q6=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),gS=new Map,fX=e=>"CDEFGAB".charAt(e),dX=e=>e<0?AS("b",-e):AS("#",e),pX=e=>e[0]==="b"?-e.length:e.length;function ss(e){const t=JSON.stringify(e),i=gS.get(t);if(i)return i;const r=typeof e=="string"?bX(e):F6(e)?ss(yX(e)):O6(e)?ss(e.name):Q6;return gS.set(t,r),r}var mX=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function AX(e){const t=mX.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function gX(e){return ss(nX(e))}var vX=(e,t)=>(e%t+t)%t,Ny=[0,2,4,5,7,9,11];function bX(e){const t=AX(e);if(t[0]===""||t[3]!=="")return Q6;const i=t[0],r=t[1],o=t[2],a=(i.charCodeAt(0)+3)%7,h=pX(r),u=o.length?+o:void 0,p=G6({step:a,alt:h,oct:u}),c=i+r+o,f=i+r,g=(Ny[a]+h+120)%12,m=u===void 0?vX(Ny[a]+h,12)-12*99:Ny[a]+h+12*(u+1),v=m>=0&&m<=127?m:null,A=u===void 0?null:Math.pow(2,(m-69)/12)*440;return{empty:!1,acc:r,alt:h,chroma:g,coord:p,freq:A,height:m,letter:i,midi:v,name:c,oct:u,pc:f,step:a}}function yX(e){const{step:t,alt:i,oct:r}=e,o=fX(t);if(!o)return"";const a=o+dX(i);return r||r===0?a+r:a}function Uf(e,t){const i=ss(e),r=Array.isArray(t)?t:Qg(t).coord;if(i.empty||!r||r.length<2)return"";const o=i.coord,a=o.length===1?[o[0]+r[0]]:[o[0]+r[0],o[1]+r[1]];return gX(a).name}function H6(e,t){const i=e.length;return r=>{if(!t)return"";const o=r<0?(i- -r%i)%i:r%i,a=Math.floor(r/i),h=Uf(t,[0,a]);return Uf(h,e[o])}}function _X(e,t,i){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),i.apply(this,r)}}function EX(e,t){const i=[];for(;t--;i[t]=t+e);return i}function wX(e,t){const i=[];for(;t--;i[t]=e-t);return i}function CX(e,t){return e<t?EX(e,t-e+1):wX(e,e-t+1)}function Cm(e,t){const i=t.length,r=(e%i+i)%i;return t.slice(r,i).concat(t.slice(0,r))}function xX(e){return e.filter(t=>t===0||t)}var Zc={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},z6=e=>Number(e).toString(2).padStart(12,"0"),vS=e=>parseInt(e,2),MX=/^[01]{12}$/;function vE(e){return MX.test(e)}var SX=e=>typeof e=="number"&&e>=0&&e<=4095,TX=e=>e&&vE(e.chroma),bS={[Zc.chroma]:Zc};function pc(e){const t=vE(e)?e:SX(e)?z6(e):Array.isArray(e)?DX(e):TX(e)?e.chroma:Zc.chroma;return bS[t]=bS[t]||PX(t)}var IX=e=>pc(e).chroma,BX=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function RX(e){const t=[];for(let i=0;i<12;i++)e.charAt(i)==="1"&&t.push(BX[i]);return t}function j6(e,t=!0){const r=pc(e).chroma.split("");return xX(r.map((o,a)=>{const h=Cm(a,r);return t&&h[0]==="0"?null:h.join("")}))}function bE(e){const t=pc(e).setNum;return i=>{const r=pc(i).setNum;return t&&t!==r&&(r&t)===r}}function yE(e){const t=pc(e).setNum;return i=>{const r=pc(i).setNum;return t&&t!==r&&(r|t)===r}}function LX(e){const t=e.split("");return t.map((i,r)=>Cm(r,t).join(""))}function PX(e){const t=vS(e),i=LX(e).map(vS).filter(a=>a>=2048).sort()[0],r=z6(i),o=RX(e);return{empty:!1,name:"",setNum:t,chroma:e,normalized:r,intervals:o}}function DX(e){if(e.length===0)return Zc.chroma;let t;const i=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<e.length;r++)t=ss(e[r]),t.empty&&(t=Qg(e[r])),t.empty||(i[t.chroma]=1);return i.join("")}var NX=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],OX=NX;({...Zc});var _E=[],JA={};function W6(){return _E.slice()}function FX(e,t,i){const r=UX(e),o={...pc(e),name:i||"",quality:r,intervals:e,aliases:t};_E.push(o),o.name&&(JA[o.name]=o),JA[o.setNum]=o,JA[o.chroma]=o,o.aliases.forEach(a=>kX(o,a))}function kX(e,t){JA[t]=e}function UX(e){const t=i=>e.indexOf(i)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}OX.forEach(([e,t,i])=>FX(e.split(" "),i.split(" "),t));_E.sort((e,t)=>e.setNum-t.setNum);var GX=e=>{const t=e.reduce((i,r)=>{const o=ss(r).chroma;return o!==void 0&&(i[o]=i[o]||ss(r).name),i},{});return i=>t[i]};function VX(e,t={}){const i=e.map(o=>ss(o).pc).filter(o=>o);return ss.length===0?[]:XX(i,1,t).filter(o=>o.weight).sort((o,a)=>a.weight-o.weight).map(o=>o.name)}var F1={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},k1=e=>t=>!!(t&e),QX=k1(F1.anyThirds),HX=k1(F1.perfectFifth),zX=k1(F1.anySeventh),jX=k1(F1.nonPerfectFifths);function WX(e){const t=parseInt(e.chroma,2);return QX(t)&&HX(t)&&zX(t)}function $X(e){const t=parseInt(e,2);return jX(t)?e:(t|16).toString(2)}function XX(e,t,i){const r=e[0],o=ss(r).chroma,a=GX(e),h=j6(e,!1),u=[];return h.forEach((p,c)=>{const f=i.assumePerfectFifth&&$X(p);W6().filter(m=>i.assumePerfectFifth&&WX(m)?m.chroma===f:m.chroma===p).forEach(m=>{const v=m.aliases[0],A=a(c);c!==o?u.push({weight:.5*t,name:`${A}${v}/${r}`}):u.push({weight:1*t,name:`${A}${v}`})})}),u}function $6(e){return e!==null&&typeof e=="object"&&"name"in e&&typeof e.name=="string"}function X6(e){return e!==null&&typeof e=="object"&&"step"in e&&typeof e.step=="number"&&"alt"in e&&typeof e.alt=="number"}var K6=[0,2,4,-1,1,3,5],Y6=K6.map(e=>Math.floor(e*7/12));function q6(e){const{step:t,alt:i,oct:r,dir:o=1}=e,a=K6[t]+7*i;if(r===void 0)return[o*a];const h=r-Y6[t]-4*i;return[o*a,o*h]}var KX=[3,0,4,1,5,2,6];function J6(e){const[t,i,r]=e,o=KX[YX(t)],a=Math.floor((t+1)/7);if(i===void 0)return{step:o,alt:a,dir:r};const h=i+4*a+Y6[o];return{step:o,alt:a,oct:h,dir:r}}function YX(e){const t=(e+1)%7;return t<0?7+t:t}var yS=(e,t)=>Array(Math.abs(t)+1).join(e),e_={empty:!0,name:"",acc:""},qX="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",JX="(AA|A|P|M|m|d|dd)([-+]?\\d+)",ZX=new RegExp("^"+qX+"|"+JX+"$");function eK(e){const t=ZX.exec(`${e}`);return t===null?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}var _S={};function Hg(e){return typeof e=="string"?_S[e]||(_S[e]=tK(e)):X6(e)?Hg(rK(e)):$6(e)?Hg(e.name):e_}var ES=[0,2,4,5,7,9,11],Z6="PMMPPMM";function tK(e){const t=eK(e);if(t[0]==="")return e_;const i=+t[0],r=t[1],o=(Math.abs(i)-1)%7,a=Z6[o];if(a==="M"&&r==="P")return e_;const h=a==="M"?"majorable":"perfectable",u=""+i+r,p=i<0?-1:1,c=i===8||i===-8?i:p*(o+1),f=iK(h,r),g=Math.floor((Math.abs(i)-1)/7),m=p*(ES[o]+f+12*g),v=(p*(ES[o]+f)%12+12)%12,A=q6({step:o,alt:f,oct:g,dir:p});return{empty:!1,name:u,num:i,q:r,step:o,alt:f,dir:p,type:h,simple:c,semitones:m,chroma:v,coord:A,oct:g}}function nK(e,t){const[i,r=0]=e,o=i*7+r*12<0,a=t||o?[-i,-r,-1]:[i,r,1];return Hg(J6(a))}function iK(e,t){return t==="M"&&e==="majorable"||t==="P"&&e==="perfectable"?0:t==="m"&&e==="majorable"?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*(e==="perfectable"?t.length:t.length+1):0}function rK(e){const{step:t,alt:i,oct:r=0,dir:o}=e;if(!o)return"";const a=t+1+7*r,h=a===0?t+1:a,u=o<0?"-":"",p=Z6[t]==="M"?"majorable":"perfectable";return u+h+sK(p,i)}function sK(e,t){return t===0?e==="majorable"?"M":"P":t===-1&&e==="majorable"?"m":t>0?yS("A",t):yS("d",e==="perfectable"?t:t+1)}var wS=(e,t)=>Array(Math.abs(t)+1).join(e),e8={empty:!0,name:"",pc:"",acc:""},CS=new Map,oK=e=>"CDEFGAB".charAt(e),aK=e=>e<0?wS("b",-e):wS("#",e),lK=e=>e[0]==="b"?-e.length:e.length;function eu(e){const t=JSON.stringify(e),i=CS.get(t);if(i)return i;const r=typeof e=="string"?fK(e):X6(e)?eu(dK(e)):$6(e)?eu(e.name):e8;return CS.set(t,r),r}var cK=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function t8(e){const t=cK.exec(e);return t?[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]:["","","",""]}function uK(e){return eu(J6(e))}var hK=(e,t)=>(e%t+t)%t,Oy=[0,2,4,5,7,9,11];function fK(e){const t=t8(e);if(t[0]===""||t[3]!=="")return e8;const i=t[0],r=t[1],o=t[2],a=(i.charCodeAt(0)+3)%7,h=lK(r),u=o.length?+o:void 0,p=q6({step:a,alt:h,oct:u}),c=i+r+o,f=i+r,g=(Oy[a]+h+120)%12,m=u===void 0?hK(Oy[a]+h,12)-12*99:Oy[a]+h+12*(u+1),v=m>=0&&m<=127?m:null,A=u===void 0?null:Math.pow(2,(m-69)/12)*440;return{empty:!1,acc:r,alt:h,chroma:g,coord:p,freq:A,height:m,letter:i,midi:v,name:c,oct:u,pc:f,step:a}}function dK(e){const{step:t,alt:i,oct:r}=e,o=oK(t);if(!o)return"";const a=o+aK(i);return r||r===0?a+r:a}function zg(e,t){const i=eu(e),r=Array.isArray(t)?t:Hg(t).coord;if(i.empty||!r||r.length<2)return"";const o=i.coord,a=o.length===1?[o[0]+r[0]]:[o[0]+r[0],o[1]+r[1]];return uK(a).name}function n8(e,t){const i=e.length;return r=>{if(!t)return"";const o=r<0?(i- -r%i)%i:r%i,a=Math.floor(r/i),h=zg(t,[0,a]);return zg(h,e[o])}}function pK(e,t){const i=eu(e),r=eu(t);if(i.empty||r.empty)return"";const o=i.coord,a=r.coord,h=a[0]-o[0],u=o.length===2&&a.length===2?a[1]-o[1]:-Math.floor(h*7/12),p=r.height===i.height&&r.midi!==null&&i.midi!==null&&i.step>r.step;return nK([h,u],p).name}function mK(e,t,i){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),i.apply(this,r)}}var AK=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],gK=AK,vK={...Zc,name:"",quality:"Unknown",intervals:[],aliases:[]},EE=[],Ep={};function bK(e){return Ep[e]||vK}function i8(){return EE.slice()}function yK(e,t,i){const r=EK(e),o={...pc(e),name:i||"",quality:r,intervals:e,aliases:t};EE.push(o),o.name&&(Ep[o.name]=o),Ep[o.setNum]=o,Ep[o.chroma]=o,o.aliases.forEach(a=>_K(o,a))}function _K(e,t){Ep[t]=e}function EK(e){const t=i=>e.indexOf(i)!==-1;return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}gK.forEach(([e,t,i])=>yK(e.split(" "),i.split(" "),t));EE.sort((e,t)=>e.setNum-t.setNum);var wK=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],CK=wK,xK={...Zc,intervals:[],aliases:[]},wE=[],wp={};function MK(){return wE.map(e=>e.name)}function r8(e){return wp[e]||xK}function U1(){return wE.slice()}function SK(e,t,i=[]){const r={...pc(e),name:t,intervals:e,aliases:i};return wE.push(r),wp[r.name]=r,wp[r.setNum]=r,wp[r.chroma]=r,r.aliases.forEach(o=>TK(r,o)),r}function TK(e,t){wp[t]=e}CK.forEach(([e,t,...i])=>SK(e.split(" "),t,i));var t_={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function CE(e){const[t,i,r,o]=t8(e);return t===""?["",e]:t==="A"&&o==="ug"?["","aug"]:[t+i,r+o]}function fh(e){if(e==="")return t_;if(Array.isArray(e)&&e.length===2)return ZA(e[1],e[0]);{const[t,i]=CE(e),r=ZA(i,t);return r.empty?ZA(e):r}}function ZA(e,t,i){const r=bK(e),o=eu(t||""),a=eu(i||"");if(r.empty||t&&o.empty||i&&a.empty)return t_;const h=pK(o.pc,a.pc),u=r.intervals.indexOf(h)+1;if(!a.empty&&!u)return t_;const p=Array.from(r.intervals);for(let m=1;m<u;m++){const v=p[0][0],A=p[0][1],y=parseInt(v,10)+7;p.push(`${y}${A}`),p.shift()}const c=o.empty?[]:p.map(m=>zg(o,m));e=r.aliases.indexOf(e)!==-1?e:r.aliases[0];const f=`${o.empty?"":o.pc}${e}${a.empty||u<=1?"":"/"+a.pc}`,g=`${t?o.pc+" ":""}${r.name}${u>1&&i?" over "+a.pc:""}`;return{...r,name:g,symbol:f,type:r.name,root:a.name,intervals:p,rootDegree:u,tonic:o.name,notes:c}}var IK=mK("Chord.chord","Chord.get",fh);function BK(e,t){const[i,r]=CE(e);return i?zg(i,t)+r:e}function RK(e){const t=fh(e),i=yE(t.chroma);return U1().filter(r=>i(r.chroma)).map(r=>r.name)}function LK(e){const t=fh(e),i=yE(t.chroma);return i8().filter(r=>i(r.chroma)).map(r=>t.tonic+r.aliases[0])}function PK(e){const t=fh(e),i=bE(t.chroma);return i8().filter(r=>i(r.chroma)).map(r=>t.tonic+r.aliases[0])}function DK(e){const{intervals:t,tonic:i}=fh(e),r=n8(t,i);return o=>o?r(o>0?o-1:o):""}function NK(e){const{intervals:t,tonic:i}=fh(e);return n8(t,i)}var jg={getChord:ZA,get:fh,detect:VX,chordScales:RK,extended:LK,reduced:PK,tokenize:CE,transpose:BK,degrees:DK,steps:NK,chord:IK};function s8(e){return+e>=0&&+e<=127}function OK(e){if(s8(e))return+e;const t=ss(e);return t.empty?null:t.midi}function FK(e,t=440){return Math.pow(2,(e-69)/12)*t}var kK=Math.log(2),UK=Math.log(440);function xE(e){const t=12*(Math.log(e)-UK)/kK+69;return Math.round(t*100)/100}var GK="C C# D D# E F F# G G# A A# B".split(" "),VK="C Db D Eb E F Gb G Ab A Bb B".split(" ");function dh(e,t={}){if(isNaN(e)||e===-1/0||e===1/0)return"";e=Math.round(e);const r=(t.sharps===!0?GK:VK)[e%12];if(t.pitchClass)return r;const o=Math.floor(e/12)-1;return r+o}function ME(e){return e%12}function QK(e){return e.split("").reduce((t,i,r)=>(r<12&&i==="1"&&t.push(r),t),[])}function HK(e){return e.map(ME).sort((t,i)=>t-i).filter((t,i,r)=>i===0||t!==r[i-1])}function SE(e){return Array.isArray(e)?HK(e):QK(e)}function zK(e){const t=SE(e);return i=>{const r=ME(i);for(let o=0;o<12;o++){if(t.includes(r+o))return i+o;if(t.includes(r-o))return i-o}}}function o8(e,t){const i=SE(e),r=i.length;return o=>{const a=o<0?(r- -o%r)%r:o%r,h=Math.floor(o/r);return i[a]+h*12+t}}function jK(e,t){const i=o8(e,t);return r=>{if(r!==0)return i(r>0?r-1:r)}}var Gf={chroma:ME,freqToMidi:xE,isMidi:s8,midiToFreq:FK,midiToNoteName:dh,pcsetNearest:zK,pcset:SE,pcsetDegrees:jK,pcsetSteps:o8,toMidi:OK},WK=["C","D","E","F","G","A","B"],a8=e=>e.name,l8=e=>e.map(ss).filter(t=>!t.empty);function $K(e){return e===void 0?WK.slice():Array.isArray(e)?l8(e).map(a8):[]}var Ja=ss,XK=e=>Ja(e).name,KK=e=>Ja(e).pc,YK=e=>Ja(e).acc,qK=e=>Ja(e).oct,JK=e=>Ja(e).midi,ZK=e=>Ja(e).freq,eY=e=>Ja(e).chroma;function c8(e){return dh(e)}function tY(e){return dh(xE(e))}function nY(e){return dh(xE(e),{sharps:!0})}function iY(e){return dh(e,{sharps:!0})}var xm=Uf,rY=Uf,u8=e=>t=>xm(t,e),sY=u8,h8=e=>t=>xm(e,t),oY=h8;function f8(e,t){return xm(e,[t,0])}var aY=f8;function lY(e,t){return xm(e,[0,t])}var TE=(e,t)=>e.height-t.height,cY=(e,t)=>t.height-e.height;function d8(e,t){return t=t||TE,l8(e).sort(t).map(a8)}function p8(e){return d8(e,TE).filter((t,i,r)=>i===0||t!==r[i-1])}var uY=e=>{const t=Ja(e);return t.empty?"":dh(t.midi||t.chroma,{sharps:t.alt>0,pitchClass:t.midi===null})};function m8(e,t){const i=Ja(e);if(i.empty)return"";const r=Ja(t||dh(i.midi||i.chroma,{sharps:i.alt<0,pitchClass:!0}));if(r.empty||r.chroma!==i.chroma)return"";if(i.oct===void 0)return r.pc;const o=i.chroma-i.alt,a=r.chroma-r.alt,h=o>11||a<0?-1:o<0||a>11?1:0,u=i.oct+h;return r.pc+u}var Ss={names:$K,get:Ja,name:XK,pitchClass:KK,accidentals:YK,octave:qK,midi:JK,ascending:TE,descending:cY,sortedNames:d8,sortedUniqNames:p8,fromMidi:c8,fromMidiSharps:iY,freq:ZK,fromFreq:tY,fromFreqSharps:nY,chroma:eY,transpose:xm,tr:rY,transposeBy:u8,trBy:sY,transposeFrom:h8,trFrom:oY,transposeFifths:f8,transposeOctaves:lY,trFifths:aY,simplify:uY,enharmonic:m8},IE=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],xS={...Zc,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},hY=IE.map(fY),n_={};hY.forEach(e=>{n_[e.name]=e,e.aliases.forEach(t=>{n_[t]=e})});function A8(e){return typeof e=="string"?n_[e.toLowerCase()]||xS:e&&e.name?A8(e.name):xS}function fY(e){const[t,i,r,o,a,h,u]=e,p=u?[u]:[],c=Number(i).toString(2);return{empty:!1,intervals:r8(o).intervals,modeNum:t,chroma:c,normalized:c,name:o,setNum:i,alt:r,triad:a,seventh:h,aliases:p}}function g8(e){return(t,i)=>{const r=A8(t);if(r.empty)return[];const o=Cm(r.modeNum,e),a=r.intervals.map(h=>Uf(i,h));return o.map((h,u)=>a[u]+h)}}g8(IE.map(e=>e[4]));g8(IE.map(e=>e[5]));var dY={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function v8(e){if(typeof e!="string")return["",""];const t=e.indexOf(" "),i=ss(e.substring(0,t));if(i.empty){const o=ss(e);return o.empty?["",e]:[o.name,""]}const r=e.substring(i.name.length+1).toLowerCase();return[i.name,r.length?r:""]}var pY=MK;function Cl(e){const t=Array.isArray(e)?e:v8(e),i=ss(t[0]).name,r=r8(t[1]);if(r.empty)return dY;const o=r.name,a=i?r.intervals.map(u=>Uf(i,u)):[],h=i?i+" "+o:o;return{...r,name:h,type:o,tonic:i,notes:a}}var mY=_X("Scale.scale","Scale.get",Cl);function AY(e,t={}){const i=IX(e),r=ss(t.tonic??e[0]??""),o=r.chroma;if(o===void 0)return[];const a=i.split("");a[o]="1";const h=Cm(o,a).join(""),u=U1().find(c=>c.chroma===h),p=[];return u&&p.push(r.name+" "+u.name),t.match==="exact"||b8(h).forEach(c=>{p.push(r.name+" "+c)}),p}function gY(e){const t=Cl(e),i=bE(t.chroma);return W6().filter(r=>i(r.chroma)).map(r=>r.aliases[0])}function b8(e){const t=vE(e)?e:Cl(e).chroma,i=yE(t);return U1().filter(r=>i(r.chroma)).map(r=>r.name)}function vY(e){const t=bE(Cl(e).chroma);return U1().filter(i=>t(i.chroma)).map(i=>i.name)}function y8(e){const t=e.map(o=>ss(o).pc).filter(o=>o),i=t[0],r=p8(t);return Cm(r.indexOf(i),r)}function bY(e){const t=Cl(e);if(t.empty)return[];const i=t.tonic?t.notes:t.intervals;return j6(t.chroma).map((r,o)=>{const a=Cl(r).name;return a?[i[o],a]:["",""]}).filter(r=>r[0])}function yY(e){const t=Array.isArray(e)?y8(e):Cl(e).notes,i=t.map(r=>ss(r).chroma);return r=>{const o=ss(typeof r=="number"?c8(r):r),a=o.height;if(a===void 0)return;const h=a%12,u=i.indexOf(h);if(u!==-1)return m8(o.name,t[u])}}function _Y(e){const t=yY(e);return(i,r)=>{const o=ss(i).height,a=ss(r).height;return o===void 0||a===void 0?[]:CX(o,a).map(t).filter(h=>h)}}function EY(e){const{intervals:t,tonic:i}=Cl(e),r=H6(t,i);return o=>o?r(o>0?o-1:o):""}function wY(e){const{intervals:t,tonic:i}=Cl(e);return H6(t,i)}var Ws={degrees:EY,detect:AY,extended:b8,get:Cl,modeNames:bY,names:pY,rangeOf:_Y,reduced:vY,scaleChords:gY,scaleNotes:y8,steps:wY,tokenize:v8,scale:mY};class Wa{constructor(t=!1){this.eventMap={},this.eventsSuspended=t==!0}addListener(t,i,r={}){if(typeof t=="string"&&t.length<1||t instanceof String&&t.length<1||typeof t!="string"&&!(t instanceof String)&&t!==Wa.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(typeof i!="function")throw new TypeError("The callback must be a function.");const o=new MS(t,this,i,r);return this.eventMap[t]||(this.eventMap[t]=[]),r.prepend?this.eventMap[t].unshift(o):this.eventMap[t].push(o),o}addOneTimeListener(t,i,r={}){r.remaining=1,this.addListener(t,i,r)}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t,i){return t===void 0?this.eventMap[Wa.ANY_EVENT]&&this.eventMap[Wa.ANY_EVENT].length>0?!0:Object.entries(this.eventMap).some(([,r])=>r.length>0):this.eventMap[t]&&this.eventMap[t].length>0?i instanceof MS?this.eventMap[t].filter(o=>o===i).length>0:typeof i=="function"?this.eventMap[t].filter(o=>o.callback===i).length>0:i==null:!1}get eventNames(){return Object.keys(this.eventMap)}getListeners(t){return this.eventMap[t]||[]}suspendEvent(t){this.getListeners(t).forEach(i=>{i.suspended=!0})}unsuspendEvent(t){this.getListeners(t).forEach(i=>{i.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(t,...i){if(typeof t!="string"&&!(t instanceof String))throw new TypeError("The 'event' parameter must be a string.");if(this.eventsSuspended)return;let r=[],o=this.eventMap[Wa.ANY_EVENT]||[];return this.eventMap[t]&&(o=o.concat(this.eventMap[t])),o.forEach(a=>{if(a.suspended)return;let h=[...i];Array.isArray(a.arguments)&&(h=h.concat(a.arguments)),a.remaining>0&&(r.push(a.callback.apply(a.context,h)),a.count++),--a.remaining<1&&a.remove()}),r}removeListener(t,i,r={}){if(t===void 0){this.eventMap={};return}else if(!this.eventMap[t])return;let o=this.eventMap[t].filter(a=>i&&a.callback!==i||r.remaining&&r.remaining!==a.remaining||r.context&&r.context!==a.context);o.length?this.eventMap[t]=o:delete this.eventMap[t]}async waitFor(t,i={}){return i.duration=parseInt(i.duration),(isNaN(i.duration)||i.duration<=0)&&(i.duration=1/0),new Promise((r,o)=>{let a,h=this.addListener(t,()=>{clearTimeout(a),r()},{remaining:1});i.duration!==1/0&&(a=setTimeout(()=>{h.remove(),o("The duration expired before the event was emitted.")},i.duration))})}get eventCount(){return Object.keys(this.eventMap).length}}class MS{constructor(t,i,r,o={}){if(typeof t!="string"&&!(t instanceof String)&&t!==Wa.ANY_EVENT)throw new TypeError("The 'event' parameter must be a string or EventEmitter.ANY_EVENT.");if(!i)throw new ReferenceError("The 'target' parameter is mandatory.");if(typeof r!="function")throw new TypeError("The 'callback' must be a function.");o.arguments!==void 0&&!Array.isArray(o.arguments)&&(o.arguments=[o.arguments]),o=Object.assign({context:i,remaining:1/0,arguments:void 0,duration:1/0},o),o.duration!==1/0&&setTimeout(()=>this.remove(),o.duration),this.arguments=o.arguments,this.callback=r,this.context=o.context,this.count=0,this.event=t,this.remaining=parseInt(o.remaining)>=1?parseInt(o.remaining):1/0,this.suspended=!1,this.target=i}remove(){this.target.removeListener(this.event,this.callback,{context:this.context,remaining:this.remaining})}}/**
 * The `Enumerations` class contains enumerations and arrays of elements used throughout the
 * library. All its properties are static and should be referenced using the class name. For
 * example: `Enumerations.CHANNEL_MESSAGES`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class Wt{static get MIDI_CHANNEL_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MESSAGES enum instead."),Wt.CHANNEL_MESSAGES}static get CHANNEL_MESSAGES(){return{noteoff:8,noteon:9,keyaftertouch:10,controlchange:11,programchange:12,channelaftertouch:13,pitchbend:14}}static get CHANNEL_NUMBERS(){return[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get MIDI_CHANNEL_NUMBERS(){return this.validation&&console.warn("The MIDI_CHANNEL_NUMBERS array has been deprecated. Use the Enumerations.CHANNEL_NUMBERS array instead."),[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}static get CHANNEL_MODE_MESSAGES(){return{allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been deprecated. Use the Enumerations.CHANNEL_MODE_MESSAGES enum instead."),Wt.CHANNEL_MODE_MESSAGES}static get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been deprecated. Use the Enumerations.CONTROL_CHANGE_MESSAGES array instead."),{bankselectcoarse:0,modulationwheelcoarse:1,breathcontrollercoarse:2,controller3:3,footcontrollercoarse:4,portamentotimecoarse:5,dataentrycoarse:6,volumecoarse:7,balancecoarse:8,controller9:9,pancoarse:10,expressioncoarse:11,effectcontrol1coarse:12,effectcontrol2coarse:13,controller14:14,controller15:15,generalpurposeslider1:16,generalpurposeslider2:17,generalpurposeslider3:18,generalpurposeslider4:19,controller20:20,controller21:21,controller22:22,controller23:23,controller24:24,controller25:25,controller26:26,controller27:27,controller28:28,controller29:29,controller30:30,controller31:31,bankselectfine:32,modulationwheelfine:33,breathcontrollerfine:34,controller35:35,footcontrollerfine:36,portamentotimefine:37,dataentryfine:38,volumefine:39,balancefine:40,controller41:41,panfine:42,expressionfine:43,effectcontrol1fine:44,effectcontrol2fine:45,controller46:46,controller47:47,controller48:48,controller49:49,controller50:50,controller51:51,controller52:52,controller53:53,controller54:54,controller55:55,controller56:56,controller57:57,controller58:58,controller59:59,controller60:60,controller61:61,controller62:62,controller63:63,holdpedal:64,portamento:65,sustenutopedal:66,softpedal:67,legatopedal:68,hold2pedal:69,soundvariation:70,resonance:71,soundreleasetime:72,soundattacktime:73,brightness:74,soundcontrol6:75,soundcontrol7:76,soundcontrol8:77,soundcontrol9:78,soundcontrol10:79,generalpurposebutton1:80,generalpurposebutton2:81,generalpurposebutton3:82,generalpurposebutton4:83,controller84:84,controller85:85,controller86:86,controller87:87,controller88:88,controller89:89,controller90:90,reverblevel:91,tremololevel:92,choruslevel:93,celestelevel:94,phaserlevel:95,databuttonincrement:96,databuttondecrement:97,nonregisteredparametercoarse:98,nonregisteredparameterfine:99,registeredparametercoarse:100,registeredparameterfine:101,controller102:102,controller103:103,controller104:104,controller105:105,controller106:106,controller107:107,controller108:108,controller109:109,controller110:110,controller111:111,controller112:112,controller113:113,controller114:114,controller115:115,controller116:116,controller117:117,controller118:118,controller119:119,allsoundoff:120,resetallcontrollers:121,localcontrol:122,allnotesoff:123,omnimodeoff:124,omnimodeon:125,monomodeon:126,polymodeon:127}}static get CONTROL_CHANGE_MESSAGES(){return[{number:0,name:"bankselectcoarse",description:"Bank Select (Coarse)",position:"msb"},{number:1,name:"modulationwheelcoarse",description:"Modulation Wheel (Coarse)",position:"msb"},{number:2,name:"breathcontrollercoarse",description:"Breath Controller (Coarse)",position:"msb"},{number:3,name:"controller3",description:"Undefined",position:"msb"},{number:4,name:"footcontrollercoarse",description:"Foot Controller (Coarse)",position:"msb"},{number:5,name:"portamentotimecoarse",description:"Portamento Time (Coarse)",position:"msb"},{number:6,name:"dataentrycoarse",description:"Data Entry (Coarse)",position:"msb"},{number:7,name:"volumecoarse",description:"Channel Volume (Coarse)",position:"msb"},{number:8,name:"balancecoarse",description:"Balance (Coarse)",position:"msb"},{number:9,name:"controller9",description:"Controller 9 (Coarse)",position:"msb"},{number:10,name:"pancoarse",description:"Pan (Coarse)",position:"msb"},{number:11,name:"expressioncoarse",description:"Expression Controller (Coarse)",position:"msb"},{number:12,name:"effectcontrol1coarse",description:"Effect Control 1 (Coarse)",position:"msb"},{number:13,name:"effectcontrol2coarse",description:"Effect Control 2 (Coarse)",position:"msb"},{number:14,name:"controller14",description:"Undefined",position:"msb"},{number:15,name:"controller15",description:"Undefined",position:"msb"},{number:16,name:"generalpurposecontroller1",description:"General Purpose Controller 1 (Coarse)",position:"msb"},{number:17,name:"generalpurposecontroller2",description:"General Purpose Controller 2 (Coarse)",position:"msb"},{number:18,name:"generalpurposecontroller3",description:"General Purpose Controller 3 (Coarse)",position:"msb"},{number:19,name:"generalpurposecontroller4",description:"General Purpose Controller 4 (Coarse)",position:"msb"},{number:20,name:"controller20",description:"Undefined",position:"msb"},{number:21,name:"controller21",description:"Undefined",position:"msb"},{number:22,name:"controller22",description:"Undefined",position:"msb"},{number:23,name:"controller23",description:"Undefined",position:"msb"},{number:24,name:"controller24",description:"Undefined",position:"msb"},{number:25,name:"controller25",description:"Undefined",position:"msb"},{number:26,name:"controller26",description:"Undefined",position:"msb"},{number:27,name:"controller27",description:"Undefined",position:"msb"},{number:28,name:"controller28",description:"Undefined",position:"msb"},{number:29,name:"controller29",description:"Undefined",position:"msb"},{number:30,name:"controller30",description:"Undefined",position:"msb"},{number:31,name:"controller31",description:"Undefined",position:"msb"},{number:32,name:"bankselectfine",description:"Bank Select (Fine)",position:"lsb"},{number:33,name:"modulationwheelfine",description:"Modulation Wheel (Fine)",position:"lsb"},{number:34,name:"breathcontrollerfine",description:"Breath Controller (Fine)",position:"lsb"},{number:35,name:"controller35",description:"Undefined",position:"lsb"},{number:36,name:"footcontrollerfine",description:"Foot Controller (Fine)",position:"lsb"},{number:37,name:"portamentotimefine",description:"Portamento Time (Fine)",position:"lsb"},{number:38,name:"dataentryfine",description:"Data Entry (Fine)",position:"lsb"},{number:39,name:"channelvolumefine",description:"Channel Volume (Fine)",position:"lsb"},{number:40,name:"balancefine",description:"Balance (Fine)",position:"lsb"},{number:41,name:"controller41",description:"Undefined",position:"lsb"},{number:42,name:"panfine",description:"Pan (Fine)",position:"lsb"},{number:43,name:"expressionfine",description:"Expression Controller (Fine)",position:"lsb"},{number:44,name:"effectcontrol1fine",description:"Effect control 1 (Fine)",position:"lsb"},{number:45,name:"effectcontrol2fine",description:"Effect control 2 (Fine)",position:"lsb"},{number:46,name:"controller46",description:"Undefined",position:"lsb"},{number:47,name:"controller47",description:"Undefined",position:"lsb"},{number:48,name:"controller48",description:"General Purpose Controller 1 (Fine)",position:"lsb"},{number:49,name:"controller49",description:"General Purpose Controller 2 (Fine)",position:"lsb"},{number:50,name:"controller50",description:"General Purpose Controller 3 (Fine)",position:"lsb"},{number:51,name:"controller51",description:"General Purpose Controller 4 (Fine)",position:"lsb"},{number:52,name:"controller52",description:"Undefined",position:"lsb"},{number:53,name:"controller53",description:"Undefined",position:"lsb"},{number:54,name:"controller54",description:"Undefined",position:"lsb"},{number:55,name:"controller55",description:"Undefined",position:"lsb"},{number:56,name:"controller56",description:"Undefined",position:"lsb"},{number:57,name:"controller57",description:"Undefined",position:"lsb"},{number:58,name:"controller58",description:"Undefined",position:"lsb"},{number:59,name:"controller59",description:"Undefined",position:"lsb"},{number:60,name:"controller60",description:"Undefined",position:"lsb"},{number:61,name:"controller61",description:"Undefined",position:"lsb"},{number:62,name:"controller62",description:"Undefined",position:"lsb"},{number:63,name:"controller63",description:"Undefined",position:"lsb"},{number:64,name:"damperpedal",description:"Damper Pedal On/Off"},{number:65,name:"portamento",description:"Portamento On/Off"},{number:66,name:"sostenuto",description:"Sostenuto On/Off"},{number:67,name:"softpedal",description:"Soft Pedal On/Off"},{number:68,name:"legatopedal",description:"Legato Pedal On/Off"},{number:69,name:"hold2",description:"Hold 2 On/Off"},{number:70,name:"soundvariation",description:"Sound Variation",position:"lsb"},{number:71,name:"resonance",description:"Resonance",position:"lsb"},{number:72,name:"releasetime",description:"Release Time",position:"lsb"},{number:73,name:"attacktime",description:"Attack Time",position:"lsb"},{number:74,name:"brightness",description:"Brightness",position:"lsb"},{number:75,name:"decaytime",description:"Decay Time",position:"lsb"},{number:76,name:"vibratorate",description:"Vibrato Rate",position:"lsb"},{number:77,name:"vibratodepth",description:"Vibrato Depth",position:"lsb"},{number:78,name:"vibratodelay",description:"Vibrato Delay",position:"lsb"},{number:79,name:"controller79",description:"Undefined",position:"lsb"},{number:80,name:"generalpurposecontroller5",description:"General Purpose Controller 5",position:"lsb"},{number:81,name:"generalpurposecontroller6",description:"General Purpose Controller 6",position:"lsb"},{number:82,name:"generalpurposecontroller7",description:"General Purpose Controller 7",position:"lsb"},{number:83,name:"generalpurposecontroller8",description:"General Purpose Controller 8",position:"lsb"},{number:84,name:"portamentocontrol",description:"Portamento Control",position:"lsb"},{number:85,name:"controller85",description:"Undefined"},{number:86,name:"controller86",description:"Undefined"},{number:87,name:"controller87",description:"Undefined"},{number:88,name:"highresolutionvelocityprefix",description:"High Resolution Velocity Prefix",position:"lsb"},{number:89,name:"controller89",description:"Undefined"},{number:90,name:"controller90",description:"Undefined"},{number:91,name:"effect1depth",description:"Effects 1 Depth (Reverb Send Level)"},{number:92,name:"effect2depth",description:"Effects 2 Depth"},{number:93,name:"effect3depth",description:"Effects 3 Depth (Chorus Send Level)"},{number:94,name:"effect4depth",description:"Effects 4 Depth"},{number:95,name:"effect5depth",description:"Effects 5 Depth"},{number:96,name:"dataincrement",description:"Data Increment"},{number:97,name:"datadecrement",description:"Data Decrement"},{number:98,name:"nonregisteredparameterfine",description:"Non-Registered Parameter Number (Fine)",position:"lsb"},{number:99,name:"nonregisteredparametercoarse",description:"Non-Registered Parameter Number (Coarse)",position:"msb"},{number:100,name:"registeredparameterfine",description:"Registered Parameter Number (Fine)",position:"lsb"},{number:101,name:"registeredparametercoarse",description:"Registered Parameter Number (Coarse)",position:"msb"},{number:102,name:"controller102",description:"Undefined"},{number:103,name:"controller103",description:"Undefined"},{number:104,name:"controller104",description:"Undefined"},{number:105,name:"controller105",description:"Undefined"},{number:106,name:"controller106",description:"Undefined"},{number:107,name:"controller107",description:"Undefined"},{number:108,name:"controller108",description:"Undefined"},{number:109,name:"controller109",description:"Undefined"},{number:110,name:"controller110",description:"Undefined"},{number:111,name:"controller111",description:"Undefined"},{number:112,name:"controller112",description:"Undefined"},{number:113,name:"controller113",description:"Undefined"},{number:114,name:"controller114",description:"Undefined"},{number:115,name:"controller115",description:"Undefined"},{number:116,name:"controller116",description:"Undefined"},{number:117,name:"controller117",description:"Undefined"},{number:118,name:"controller118",description:"Undefined"},{number:119,name:"controller119",description:"Undefined"},{number:120,name:"allsoundoff",description:"All Sound Off"},{number:121,name:"resetallcontrollers",description:"Reset All Controllers"},{number:122,name:"localcontrol",description:"Local Control On/Off"},{number:123,name:"allnotesoff",description:"All Notes Off"},{number:124,name:"omnimodeoff",description:"Omni Mode Off"},{number:125,name:"omnimodeon",description:"Omni Mode On"},{number:126,name:"monomodeon",description:"Mono Mode On"},{number:127,name:"polymodeon",description:"Poly Mode On"}]}static get REGISTERED_PARAMETERS(){return{pitchbendrange:[0,0],channelfinetuning:[0,1],channelcoarsetuning:[0,2],tuningprogram:[0,3],tuningbank:[0,4],modulationrange:[0,5],azimuthangle:[61,0],elevationangle:[61,1],gain:[61,2],distanceratio:[61,3],maximumdistance:[61,4],maximumdistancegain:[61,5],referencedistanceratio:[61,6],panspreadangle:[61,7],rollangle:[61,8]}}static get MIDI_REGISTERED_PARAMETERS(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETERS enum has been deprecated. Use the Enumerations.REGISTERED_PARAMETERS enum instead."),Wt.MIDI_REGISTERED_PARAMETERS}static get SYSTEM_MESSAGES(){return{sysex:240,timecode:241,songposition:242,songselect:243,tunerequest:246,tuningrequest:246,sysexend:247,clock:248,start:250,continue:251,stop:252,activesensing:254,reset:255,midimessage:0,unknownsystemmessage:-1}}static get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been deprecated. Use the Enumerations.SYSTEM_MESSAGES enum instead."),Wt.SYSTEM_MESSAGES}static get CHANNEL_EVENTS(){return["noteoff","controlchange","noteon","keyaftertouch","programchange","channelaftertouch","pitchbend","allnotesoff","allsoundoff","localcontrol","monomode","omnimode","resetallcontrollers","nrpn","nrpn-dataentrycoarse","nrpn-dataentryfine","nrpn-dataincrement","nrpn-datadecrement","rpn","rpn-dataentrycoarse","rpn-dataentryfine","rpn-dataincrement","rpn-datadecrement","nrpn-databuttonincrement","nrpn-databuttondecrement","rpn-databuttonincrement","rpn-databuttondecrement"]}}/**
 * The `Note` class represents a single musical note such as `"D3"`, `"G#4"`, `"F-1"`, `"Gb7"`, etc.
 *
 * `Note` objects can be played back on a single channel by calling
 * [`OutputChannel.playNote()`]{@link OutputChannel#playNote} or, on multiple channels of the same
 * output, by calling [`Output.playNote()`]{@link Output#playNote}.
 *
 * The note has [`attack`](#attack) and [`release`](#release) velocities set at `0.5` by default.
 * These can be changed by passing in the appropriate option. It is also possible to set a
 * system-wide default for attack and release velocities by using the
 * [`WebMidi.defaults`](WebMidi#defaults) property.
 *
 * If you prefer to work with raw MIDI values (`0` to `127`), you can use [`rawAttack`](#rawAttack) and
 * [`rawRelease`](#rawRelease) to both get and set the values.
 *
 * The note may have a [`duration`](#duration). If it does, playback will be automatically stopped
 * when the duration has elapsed by sending a `"noteoff"` event. By default, the duration is set to
 * `Infinity`. In this case, it will never stop playing unless explicitly stopped by calling a
 * method such as [`OutputChannel.stopNote()`]{@link OutputChannel#stopNote},
 * [`Output.stopNote()`]{@link Output#stopNote} or similar.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */let cf=class{constructor(t,i={}){this.duration=yn.defaults.note.duration,this.attack=yn.defaults.note.attack,this.release=yn.defaults.note.release,i.duration!=null&&(this.duration=i.duration),i.attack!=null&&(this.attack=i.attack),i.rawAttack!=null&&(this.attack=xn.from7bitToFloat(i.rawAttack)),i.release!=null&&(this.release=i.release),i.rawRelease!=null&&(this.release=xn.from7bitToFloat(i.rawRelease)),Number.isInteger(t)?this.identifier=xn.toNoteIdentifier(t):this.identifier=t}get identifier(){return this._name+(this._accidental||"")+this._octave}set identifier(t){const i=xn.getNoteDetails(t);if(yn.validation&&!t)throw new Error("Invalid note identifier");this._name=i.name,this._accidental=i.accidental,this._octave=i.octave}get name(){return this._name}set name(t){if(yn.validation&&(t=t.toUpperCase(),!["C","D","E","F","G","A","B"].includes(t)))throw new Error("Invalid name value");this._name=t}get accidental(){return this._accidental}set accidental(t){if(yn.validation&&(t=t.toLowerCase(),!["#","##","b","bb"].includes(t)))throw new Error("Invalid accidental value");this._accidental=t}get octave(){return this._octave}set octave(t){if(yn.validation&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid octave value");this._octave=t}get duration(){return this._duration}set duration(t){if(yn.validation&&(t=parseFloat(t),isNaN(t)||t===null||t<0))throw new RangeError("Invalid duration value.");this._duration=t}get attack(){return this._attack}set attack(t){if(yn.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid attack value.");this._attack=t}get release(){return this._release}set release(t){if(yn.validation&&(t=parseFloat(t),isNaN(t)||!(t>=0&&t<=1)))throw new RangeError("Invalid release value.");this._release=t}get rawAttack(){return xn.fromFloatTo7Bit(this._attack)}set rawAttack(t){this._attack=xn.from7bitToFloat(t)}get rawRelease(){return xn.fromFloatTo7Bit(this._release)}set rawRelease(t){this._release=xn.from7bitToFloat(t)}get number(){return xn.toNoteNumber(this.identifier)}getOffsetNumber(t=0,i=0){return yn.validation&&(t=parseInt(t)||0,i=parseInt(i)||0),Math.min(Math.max(this.number+t*12+i,0),127)}};/**
 * The `Utilities` class contains general-purpose utility methods. All methods are static and
 * should be called using the class name. For example: `Utilities.getNoteDetails("C4")`.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class xn{static toNoteNumber(t,i=0){if(i=i==null?0:parseInt(i),isNaN(i))throw new RangeError("Invalid 'octaveOffset' value");typeof t!="string"&&(t="");const r=this.getNoteDetails(t);if(!r)throw new TypeError("Invalid note identifier");const o={C:0,D:2,E:4,F:5,G:7,A:9,B:11};let a=(r.octave+1+i)*12;if(a+=o[r.name],r.accidental&&(r.accidental.startsWith("b")?a-=r.accidental.length:a+=r.accidental.length),a<0||a>127)throw new RangeError("Invalid octaveOffset value");return a}static getNoteDetails(t){Number.isInteger(t)&&(t=this.toNoteIdentifier(t));const i=t.match(/^([CDEFGAB])(#{0,2}|b{0,2})(-?\d+)$/i);if(!i)throw new TypeError("Invalid note identifier");const r=i[1].toUpperCase(),o=parseInt(i[3]);let a=i[2].toLowerCase();return a=a===""?void 0:a,{accidental:a,identifier:r+(a||"")+o,name:r,octave:o}}static sanitizeChannels(t){let i;if(yn.validation){if(t==="all")i=["all"];else if(t==="none")return[]}return Array.isArray(t)?i=t:i=[t],i.indexOf("all")>-1&&(i=Wt.MIDI_CHANNEL_NUMBERS),i.map(function(r){return parseInt(r)}).filter(function(r){return r>=1&&r<=16})}static toTimestamp(t){let i=!1;const r=parseFloat(t);return isNaN(r)?!1:(typeof t=="string"&&t.substring(0,1)==="+"?r>=0&&(i=yn.time+r):r>=0&&(i=r),i)}static guessNoteNumber(t,i){i=parseInt(i)||0;let r=!1;if(Number.isInteger(t)&&t>=0&&t<=127)r=parseInt(t);else if(parseInt(t)>=0&&parseInt(t)<=127)r=parseInt(t);else if(typeof t=="string"||t instanceof String)try{r=this.toNoteNumber(t.trim(),i)}catch{return!1}return r}static toNoteIdentifier(t,i){if(t=parseInt(t),isNaN(t)||t<0||t>127)throw new RangeError("Invalid note number");if(i=i==null?0:parseInt(i),isNaN(i))throw new RangeError("Invalid octaveOffset value");const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=Math.floor(t/12-1)+i;return r[t%12]+o.toString()}static buildNote(t,i={}){if(i.octaveOffset=parseInt(i.octaveOffset)||0,t instanceof cf)return t;let r=this.guessNoteNumber(t,i.octaveOffset);if(r===!1)throw new TypeError(`The input could not be parsed as a note (${t})`);return i.octaveOffset=void 0,new cf(r,i)}static buildNoteArray(t,i={}){let r=[];return Array.isArray(t)||(t=[t]),t.forEach(o=>{r.push(this.buildNote(o,i))}),r}static from7bitToFloat(t){return t===1/0&&(t=127),t=parseInt(t)||0,Math.min(Math.max(t/127,0),1)}static fromFloatTo7Bit(t){return t===1/0&&(t=1),t=parseFloat(t)||0,Math.min(Math.max(Math.round(t*127),0),127)}static fromMsbLsbToFloat(t,i=0){yn.validation&&(t=Math.min(Math.max(parseInt(t)||0,0),127),i=Math.min(Math.max(parseInt(i)||0,0),127));const r=((t<<7)+i)/16383;return Math.min(Math.max(r,0),1)}static fromFloatToMsbLsb(t){yn.validation&&(t=Math.min(Math.max(parseFloat(t)||0,0),1));const i=Math.round(t*16383);return{msb:i>>7,lsb:i&127}}static offsetNumber(t,i=0,r=0){if(yn.validation){if(t=parseInt(t),isNaN(t))throw new Error("Invalid note number");i=parseInt(i)||0,r=parseInt(r)||0}return Math.min(Math.max(t+i*12+r,0),127)}static getPropertyByValue(t,i){return Object.keys(t).find(r=>t[r]===i)}static getCcNameByNumber(t){if(!(yn.validation&&(t=parseInt(t),!(t>=0&&t<=127))))return Wt.CONTROL_CHANGE_MESSAGES[t].name}static getCcNumberByName(t){let i=Wt.CONTROL_CHANGE_MESSAGES.find(r=>r.name===t);return i?i.number:Wt.MIDI_CONTROL_CHANGE_MESSAGES[t]}static getChannelModeByNumber(t){if(!(t>=120&&t<=127))return!1;for(let i in Wt.CHANNEL_MODE_MESSAGES)if(Wt.CHANNEL_MODE_MESSAGES.hasOwnProperty(i)&&t===Wt.CHANNEL_MODE_MESSAGES[i])return i;return!1}static get isNode(){return typeof process<"u"&&process.versions!=null&&process.versions.node!=null}static get isBrowser(){return typeof window<"u"&&typeof window.document<"u"}}/**
 * The `OutputChannel` class represents a single output MIDI channel. `OutputChannel` objects are
 * provided by an [`Output`](Output) port which, itself, is made available by a device. The
 * `OutputChannel` object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `OutputChannel` objects can be found inside the parent output's
 * [`channels`]{@link Output#channels} property.
 *
 * @param {Output} output The [`Output`](Output) this channel belongs to.
 * @param {number} number The MIDI channel number (`1` - `16`).
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class CY extends Wa{constructor(t,i){super(),this._output=t,this._number=i,this._octaveOffset=0}destroy(){this._output=null,this._number=null,this._octaveOffset=0,this.removeListener()}send(t,i={time:0}){return this.output.send(t,i),this}sendKeyAftertouch(t,i,r={}){if(yn.validation){if(r.useRawValue&&(r.rawValue=r.useRawValue),isNaN(parseFloat(i)))throw new RangeError("Invalid key aftertouch value.");if(r.rawValue){if(!(i>=0&&i<=127&&Number.isInteger(i)))throw new RangeError("Key aftertouch raw value must be an integer between 0 and 127.")}else if(!(i>=0&&i<=1))throw new RangeError("Key aftertouch value must be a float between 0 and 1.")}r.rawValue||(i=xn.fromFloatTo7Bit(i));const o=yn.octaveOffset+this.output.octaveOffset+this.octaveOffset;return Array.isArray(t)||(t=[t]),xn.buildNoteArray(t).forEach(a=>{this.send([(Wt.CHANNEL_MESSAGES.keyaftertouch<<4)+(this.number-1),a.getOffsetNumber(o),i],{time:xn.toTimestamp(r.time)})}),this}sendControlChange(t,i,r={}){if(typeof t=="string"&&(t=xn.getCcNumberByName(t)),Array.isArray(i)||(i=[i]),yn.validation){if(t===void 0)throw new TypeError("Control change must be identified with a valid name or an integer between 0 and 127.");if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new TypeError("Control change number must be an integer between 0 and 127.");if(i=i.map(o=>{const a=Math.min(Math.max(parseInt(o),0),127);if(isNaN(a))throw new TypeError("Values must be integers between 0 and 127");return a}),i.length===2&&t>=32)throw new TypeError("To use a value array, the controller must be between 0 and 31")}return i.forEach((o,a)=>{this.send([(Wt.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t+a*32,i[a]],{time:xn.toTimestamp(r.time)})}),this}_selectNonRegisteredParameter(t,i={}){return this.sendControlChange(99,t[0],i),this.sendControlChange(98,t[1],i),this}_deselectRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_deselectNonRegisteredParameter(t={}){return this.sendControlChange(101,127,t),this.sendControlChange(100,127,t),this}_selectRegisteredParameter(t,i={}){return this.sendControlChange(101,t[0],i),this.sendControlChange(100,t[1],i),this}_setCurrentParameter(t,i={}){return t=[].concat(t),this.sendControlChange(6,t[0],i),t.length<2?this:(this.sendControlChange(38,t[1],i),this)}sendRpnDecrement(t,i={}){if(Array.isArray(t)||(t=Wt.REGISTERED_PARAMETERS[t]),yn.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(Wt.REGISTERED_PARAMETERS).forEach(o=>{Wt.REGISTERED_PARAMETERS[o][0]===t[0]&&Wt.REGISTERED_PARAMETERS[o][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,i),this.sendControlChange(97,0,i),this._deselectRegisteredParameter(i),this}sendRpnIncrement(t,i={}){if(Array.isArray(t)||(t=Wt.REGISTERED_PARAMETERS[t]),yn.validation){if(t===void 0)throw new TypeError("The specified registered parameter is invalid.");let r=!1;if(Object.getOwnPropertyNames(Wt.REGISTERED_PARAMETERS).forEach(o=>{Wt.REGISTERED_PARAMETERS[o][0]===t[0]&&Wt.REGISTERED_PARAMETERS[o][1]===t[1]&&(r=!0)}),!r)throw new TypeError("The specified registered parameter is invalid.")}return this._selectRegisteredParameter(t,i),this.sendControlChange(96,0,i),this._deselectRegisteredParameter(i),this}playNote(t,i={}){this.sendNoteOn(t,i);const r=Array.isArray(t)?t:[t];for(let o of r)if(parseInt(o.duration)>0){const a={time:(xn.toTimestamp(i.time)||yn.time)+parseInt(o.duration),release:o.release,rawRelease:o.rawRelease};this.sendNoteOff(o,a)}else if(parseInt(i.duration)>0){const a={time:(xn.toTimestamp(i.time)||yn.time)+parseInt(i.duration),release:i.release,rawRelease:i.rawRelease};this.sendNoteOff(o,a)}return this}sendNoteOff(t,i={}){if(yn.validation){if(i.rawRelease!=null&&!(i.rawRelease>=0&&i.rawRelease<=127))throw new RangeError("The 'rawRelease' option must be an integer between 0 and 127");if(i.release!=null&&!(i.release>=0&&i.release<=1))throw new RangeError("The 'release' option must be an number between 0 and 1");i.rawVelocity&&(i.rawRelease=i.velocity,console.warn("The 'rawVelocity' option is deprecated. Use 'rawRelease' instead.")),i.velocity&&(i.release=i.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;i.rawRelease!=null?r=i.rawRelease:isNaN(i.release)||(r=Math.round(i.release*127));const o=yn.octaveOffset+this.output.octaveOffset+this.octaveOffset;return xn.buildNoteArray(t,{rawRelease:parseInt(r)}).forEach(a=>{this.send([(Wt.CHANNEL_MESSAGES.noteoff<<4)+(this.number-1),a.getOffsetNumber(o),a.rawRelease],{time:xn.toTimestamp(i.time)})}),this}stopNote(t,i={}){return this.sendNoteOff(t,i)}sendNoteOn(t,i={}){if(yn.validation){if(i.rawAttack!=null&&!(i.rawAttack>=0&&i.rawAttack<=127))throw new RangeError("The 'rawAttack' option must be an integer between 0 and 127");if(i.attack!=null&&!(i.attack>=0&&i.attack<=1))throw new RangeError("The 'attack' option must be an number between 0 and 1");i.rawVelocity&&(i.rawAttack=i.velocity,i.rawRelease=i.release,console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' or 'rawRelease'.")),i.velocity&&(i.attack=i.velocity,console.warn("The 'velocity' option is deprecated. Use 'attack' instead."))}let r=64;i.rawAttack!=null?r=i.rawAttack:isNaN(i.attack)||(r=Math.round(i.attack*127));const o=yn.octaveOffset+this.output.octaveOffset+this.octaveOffset;return xn.buildNoteArray(t,{rawAttack:r}).forEach(a=>{this.send([(Wt.CHANNEL_MESSAGES.noteon<<4)+(this.number-1),a.getOffsetNumber(o),a.rawAttack],{time:xn.toTimestamp(i.time)})}),this}sendChannelMode(t,i=0,r={}){if(typeof t=="string"&&(t=Wt.CHANNEL_MODE_MESSAGES[t]),yn.validation){if(t===void 0)throw new TypeError("Invalid channel mode message name or number.");if(isNaN(t)||!(t>=120&&t<=127))throw new TypeError("Invalid channel mode message number.");if(isNaN(parseInt(i))||i<0||i>127)throw new RangeError("Value must be an integer between 0 and 127.")}return this.send([(Wt.CHANNEL_MESSAGES.controlchange<<4)+(this.number-1),t,i],{time:xn.toTimestamp(r.time)}),this}sendOmniMode(t,i={}){return t===void 0||t?this.sendChannelMode("omnimodeon",0,i):this.sendChannelMode("omnimodeoff",0,i),this}sendChannelAftertouch(t,i={}){if(yn.validation){if(isNaN(parseFloat(t)))throw new RangeError("Invalid channel aftertouch value.");if(i.rawValue){if(!(t>=0&&t<=127&&Number.isInteger(t)))throw new RangeError("Channel aftertouch raw value must be an integer between 0 and 127.")}else if(!(t>=0&&t<=1))throw new RangeError("Channel aftertouch value must be a float between 0 and 1.")}return i.rawValue||(t=xn.fromFloatTo7Bit(t)),this.send([(Wt.CHANNEL_MESSAGES.channelaftertouch<<4)+(this.number-1),Math.round(t)],{time:xn.toTimestamp(i.time)}),this}sendMasterTuning(t,i={}){if(t=parseFloat(t)||0,yn.validation&&!(t>-65&&t<64))throw new RangeError("The value must be a decimal number larger than -65 and smaller than 64.");let r=Math.floor(t)+64,o=t-Math.floor(t);o=Math.round((o+1)/2*16383);let a=o>>7&127,h=o&127;return this.sendRpnValue("channelcoarsetuning",r,i),this.sendRpnValue("channelfinetuning",[a,h],i),this}sendModulationRange(t,i,r={}){if(yn.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(i!=null&&(!Number.isInteger(i)||!(i>=0&&i<=127)))throw new RangeError("If specified, the cents value must be an integer between 0 and 127.")}return i>=0&&i<=127||(i=0),this.sendRpnValue("modulationrange",[t,i],r),this}sendNrpnValue(t,i,r={}){if(i=[].concat(i),yn.validation){if(!Array.isArray(t)||!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the NRPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the NRPN must be between 0 and 127.");i.forEach(o=>{if(!(o>=0&&o<=127))throw new RangeError("The data bytes of the NRPN must be between 0 and 127.")})}return this._selectNonRegisteredParameter(t,r),this._setCurrentParameter(i,r),this._deselectNonRegisteredParameter(r),this}sendPitchBend(t,i={}){if(yn.validation)if(i.rawValue&&Array.isArray(t)){if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The pitch bend LSB must be an integer between 0 and 127.")}else if(i.rawValue&&!Array.isArray(t)){if(!(t>=0&&t<=127))throw new RangeError("The pitch bend MSB must be an integer between 0 and 127.")}else{if(isNaN(t)||t===null)throw new RangeError("Invalid pitch bend value.");if(!(t>=-1&&t<=1))throw new RangeError("The pitch bend value must be a float between -1 and 1.")}let r=0,o=0;if(i.rawValue&&Array.isArray(t))r=t[0],o=t[1];else if(i.rawValue&&!Array.isArray(t))r=t;else{const a=xn.fromFloatToMsbLsb((t+1)/2);r=a.msb,o=a.lsb}return this.send([(Wt.CHANNEL_MESSAGES.pitchbend<<4)+(this.number-1),o,r],{time:xn.toTimestamp(i.time)}),this}sendPitchBendRange(t,i,r={}){if(yn.validation){if(!Number.isInteger(t)||!(t>=0&&t<=127))throw new RangeError("The semitones value must be an integer between 0 and 127.");if(!Number.isInteger(i)||!(i>=0&&i<=127))throw new RangeError("The cents value must be an integer between 0 and 127.")}return this.sendRpnValue("pitchbendrange",[t,i],r),this}sendProgramChange(t,i={}){if(t=parseInt(t)||0,yn.validation&&!(t>=0&&t<=127))throw new RangeError("The program number must be between 0 and 127.");return this.send([(Wt.CHANNEL_MESSAGES.programchange<<4)+(this.number-1),t],{time:xn.toTimestamp(i.time)}),this}sendRpnValue(t,i,r={}){if(Array.isArray(t)||(t=Wt.REGISTERED_PARAMETERS[t]),yn.validation){if(!Number.isInteger(t[0])||!Number.isInteger(t[1]))throw new TypeError("The specified NRPN is invalid.");if(!(t[0]>=0&&t[0]<=127))throw new RangeError("The first byte of the RPN must be between 0 and 127.");if(!(t[1]>=0&&t[1]<=127))throw new RangeError("The second byte of the RPN must be between 0 and 127.");[].concat(i).forEach(o=>{if(!(o>=0&&o<=127))throw new RangeError("The data bytes of the RPN must be between 0 and 127.")})}return this._selectRegisteredParameter(t,r),this._setCurrentParameter(i,r),this._deselectRegisteredParameter(r),this}sendTuningBank(t,i={}){if(yn.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning bank number must be between 0 and 127.");return this.sendRpnValue("tuningbank",t,i),this}sendTuningProgram(t,i={}){if(yn.validation&&(!Number.isInteger(t)||!(t>=0&&t<=127)))throw new RangeError("The tuning program number must be between 0 and 127.");return this.sendRpnValue("tuningprogram",t,i),this}sendLocalControl(t,i={}){return t?this.sendChannelMode("localcontrol",127,i):this.sendChannelMode("localcontrol",0,i)}sendAllNotesOff(t={}){return this.sendChannelMode("allnotesoff",0,t)}sendAllSoundOff(t={}){return this.sendChannelMode("allsoundoff",0,t)}sendResetAllControllers(t={}){return this.sendChannelMode("resetallcontrollers",0,t)}sendPolyphonicMode(t,i={}){return t==="mono"?this.sendChannelMode("monomodeon",0,i):this.sendChannelMode("polymodeon",0,i)}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get output(){return this._output}get number(){return this._number}}/**
 * The `Output` class represents a single MIDI output port (not to be confused with a MIDI channel).
 * A port is made available by a MIDI device. A MIDI device can advertise several input and output
 * ports. Each port has 16 MIDI channels which can be accessed via the [`channels`](#channels)
 * property.
 *
 * The `Output` object is automatically instantiated by the library according to the host's MIDI
 * subsystem and should not be directly instantiated.
 *
 * You can access all available `Output` objects by referring to the
 * [`WebMidi.outputs`](WebMidi#outputs) array or by using methods such as
 * [`WebMidi.getOutputByName()`](WebMidi#getOutputByName) or
 * [`WebMidi.getOutputById()`](WebMidi#getOutputById).
 *
 * @fires Output#opened
 * @fires Output#disconnected
 * @fires Output#closed
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class i_ extends Wa{constructor(t){super(),this._midiOutput=t,this._octaveOffset=0,this.channels=[];for(let i=1;i<=16;i++)this.channels[i]=new CY(this,i);this._midiOutput.onstatechange=this._onStateChange.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._midiOutput&&(this._midiOutput.onstatechange=null),await this.close(),this._midiOutput=null}_onStateChange(t){let i={timestamp:yn.time};t.port.connection==="open"?(i.type="opened",i.target=this,i.port=i.target,this.emit("opened",i)):t.port.connection==="closed"&&t.port.state==="connected"?(i.type="closed",i.target=this,i.port=i.target,this.emit("closed",i)):t.port.connection==="closed"&&t.port.state==="disconnected"?(i.type="disconnected",i.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",i)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught:",t.port.connection,t.port.state)}async open(){try{return await this._midiOutput.open(),Promise.resolve(this)}catch(t){return Promise.reject(t)}}async close(){this._midiOutput?await this._midiOutput.close():await Promise.resolve()}send(t,i={time:0},r=0){if(t instanceof _8&&(t=xn.isNode?t.data:t.rawData),t instanceof Uint8Array&&xn.isNode&&(t=Array.from(t)),yn.validation){if(!Array.isArray(t)&&!(t instanceof Uint8Array)&&(t=[t],Array.isArray(i)&&(t=t.concat(i)),i=isNaN(r)?{time:0}:{time:r}),!(parseInt(t[0])>=128&&parseInt(t[0])<=255))throw new RangeError("The first byte (status) must be an integer between 128 and 255.");t.slice(1).forEach(o=>{if(o=parseInt(o),!(o>=0&&o<=255))throw new RangeError("Data bytes must be integers between 0 and 255.")}),i||(i={time:0})}return this._midiOutput.send(t,xn.toTimestamp(i.time)),this}sendSysex(t,i=[],r={}){if(t=[].concat(t),i instanceof Uint8Array){const o=new Uint8Array(1+t.length+i.length+1);o[0]=Wt.SYSTEM_MESSAGES.sysex,o.set(Uint8Array.from(t),1),o.set(i,1+t.length),o[o.length-1]=Wt.SYSTEM_MESSAGES.sysexend,this.send(o,{time:r.time})}else{const o=t.concat(i,Wt.SYSTEM_MESSAGES.sysexend);this.send([Wt.SYSTEM_MESSAGES.sysex].concat(o),{time:r.time})}return this}clear(){return this._midiOutput.clear?this._midiOutput.clear():yn.validation&&console.warn("The 'clear()' method has not yet been implemented in your environment."),this}sendTimecodeQuarterFrame(t,i={}){if(yn.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The value must be an integer between 0 and 127.");return this.send([Wt.SYSTEM_MESSAGES.timecode,t],{time:i.time}),this}sendSongPosition(t=0,i={}){t=Math.floor(t)||0;var r=t>>7&127,o=t&127;return this.send([Wt.SYSTEM_MESSAGES.songposition,r,o],{time:i.time}),this}sendSongSelect(t=0,i={}){if(yn.validation&&(t=parseInt(t),isNaN(t)||!(t>=0&&t<=127)))throw new RangeError("The program value must be between 0 and 127");return this.send([Wt.SYSTEM_MESSAGES.songselect,t],{time:i.time}),this}sendTuneRequest(t={}){return this.send([Wt.SYSTEM_MESSAGES.tunerequest],{time:t.time}),this}sendClock(t={}){return this.send([Wt.SYSTEM_MESSAGES.clock],{time:t.time}),this}sendStart(t={}){return this.send([Wt.SYSTEM_MESSAGES.start],{time:t.time}),this}sendContinue(t={}){return this.send([Wt.SYSTEM_MESSAGES.continue],{time:t.time}),this}sendStop(t={}){return this.send([Wt.SYSTEM_MESSAGES.stop],{time:t.time}),this}sendActiveSensing(t={}){return this.send([Wt.SYSTEM_MESSAGES.activesensing],{time:t.time}),this}sendReset(t={}){return this.send([Wt.SYSTEM_MESSAGES.reset],{time:t.time}),this}sendTuningRequest(t={}){return yn.validation&&console.warn("The sendTuningRequest() method has been deprecated. Use sendTuningRequest() instead."),this.sendTuneRequest(t)}sendKeyAftertouch(t,i,r={}){return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendKeyAftertouch(t,i,r)}),this}sendControlChange(t,i,r={},o={}){if(yn.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const a=r;r=o,r.channels=a,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(a=>{this.channels[a].sendControlChange(t,i,r)}),this}sendPitchBendRange(t=0,i=0,r={}){return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendPitchBendRange(t,i,r)}),this}setPitchBendRange(t=0,i=0,r="all",o={}){return yn.validation&&(console.warn("The setPitchBendRange() method is deprecated. Use sendPitchBendRange() instead."),o.channels=r,o.channels==="all"&&(o.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendPitchBendRange(t,i,o)}sendRpnValue(t,i,r={}){return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendRpnValue(t,i,r)}),this}setRegisteredParameter(t,i=[],r="all",o={}){return yn.validation&&(console.warn("The setRegisteredParameter() method is deprecated. Use sendRpnValue() instead."),o.channels=r,o.channels==="all"&&(o.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendRpnValue(t,i,o)}sendChannelAftertouch(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendChannelAftertouch(t,i)}),this}sendPitchBend(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendPitchBend(t,i)}),this}sendProgramChange(t=0,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendProgramChange(t,i)}),this}sendModulationRange(t,i,r={}){return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendModulationRange(t,i,r)}),this}setModulationRange(t=0,i=0,r="all",o={}){return yn.validation&&(console.warn("The setModulationRange() method is deprecated. Use sendModulationRange() instead."),o.channels=r,o.channels==="all"&&(o.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendModulationRange(t,i,o)}sendMasterTuning(t,i={}){return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(r=>{this.channels[r].sendMasterTuning(t,i)}),this}setMasterTuning(t,i={},r={}){return yn.validation&&(console.warn("The setMasterTuning() method is deprecated. Use sendMasterTuning() instead."),r.channels=i,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendMasterTuning(t,r)}sendTuningProgram(t,i={}){return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(r=>{this.channels[r].sendTuningProgram(t,i)}),this}setTuningProgram(t,i="all",r={}){return yn.validation&&(console.warn("The setTuningProgram() method is deprecated. Use sendTuningProgram() instead."),r.channels=i,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendTuningProgram(t,r)}sendTuningBank(t=0,i={}){return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(r=>{this.channels[r].sendTuningBank(t,i)}),this}setTuningBank(t,i="all",r={}){return yn.validation&&(console.warn("The setTuningBank() method is deprecated. Use sendTuningBank() instead."),r.channels=i,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendTuningBank(t,r)}sendChannelMode(t,i=0,r={},o={}){if(yn.validation&&(Array.isArray(r)||Number.isInteger(r)||r==="all")){const a=r;r=o,r.channels=a,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)}return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(a=>{this.channels[a].sendChannelMode(t,i,r)}),this}sendAllSoundOff(t={}){return t.channels==null&&(t.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(t.channels).forEach(i=>{this.channels[i].sendAllSoundOff(t)}),this}sendAllNotesOff(t={}){return t.channels==null&&(t.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(t.channels).forEach(i=>{this.channels[i].sendAllNotesOff(t)}),this}sendResetAllControllers(t={},i={}){if(yn.validation&&(Array.isArray(t)||Number.isInteger(t)||t==="all")){const r=t;t=i,t.channels=r,t.channels==="all"&&(t.channels=Wt.MIDI_CHANNEL_NUMBERS)}return t.channels==null&&(t.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(t.channels).forEach(r=>{this.channels[r].sendResetAllControllers(t)}),this}sendPolyphonicMode(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendPolyphonicMode(t,i)}),this}sendLocalControl(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendLocalControl(t,i)}),this}sendOmniMode(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendOmniMode(t,i)}),this}sendNrpnValue(t,i,r={}){return r.channels==null&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].sendNrpnValue(t,i,r)}),this}setNonRegisteredParameter(t,i=[],r="all",o={}){return yn.validation&&(console.warn("The setNonRegisteredParameter() method is deprecated. Use sendNrpnValue() instead."),o.channels=r,o.channels==="all"&&(o.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendNrpnValue(t,i,o)}sendRpnIncrement(t,i={}){return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(r=>{this.channels[r].sendRpnIncrement(t,i)}),this}incrementRegisteredParameter(t,i="all",r={}){return yn.validation&&(console.warn("The incrementRegisteredParameter() method is deprecated. Use sendRpnIncrement() instead."),r.channels=i,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendRpnIncrement(t,r)}sendRpnDecrement(t,i={}){return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(r=>{this.channels[r].sendRpnDecrement(t,i)}),this}decrementRegisteredParameter(t,i="all",r={}){return yn.validation&&(console.warn("The decrementRegisteredParameter() method is deprecated. Use sendRpnDecrement() instead."),r.channels=i,r.channels==="all"&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS)),this.sendRpnDecrement(t,r)}sendNoteOff(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendNoteOff(t,i)}),this}stopNote(t,i){return this.sendNoteOff(t,i)}playNote(t,i={},r={}){if(yn.validation&&(i.rawVelocity&&console.warn("The 'rawVelocity' option is deprecated. Use 'rawAttack' instead."),i.velocity&&console.warn("The 'velocity' option is deprecated. Use 'velocity' instead."),Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].playNote(t,i)}),this}sendNoteOn(t,i={},r={}){if(yn.validation&&(Array.isArray(i)||Number.isInteger(i)||i==="all")){const o=i;i=r,i.channels=o,i.channels==="all"&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS)}return i.channels==null&&(i.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(i.channels).forEach(o=>{this.channels[o].sendNoteOn(t,i)}),this}get name(){return this._midiOutput.name}get id(){return this._midiOutput.id}get connection(){return this._midiOutput.connection}get manufacturer(){return this._midiOutput.manufacturer}get state(){return this._midiOutput.state}get type(){return this._midiOutput.type}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}}/**
 * The `Forwarder` class allows the forwarding of MIDI messages to predetermined outputs. When you
 * call its [`forward()`](#forward) method, it will send the specified [`Message`](Message) object
 * to all the outputs listed in its [`destinations`](#destinations) property.
 *
 * If specific channels or message types have been defined in the [`channels`](#channels) or
 * [`types`](#types) properties, only messages matching the channels/types will be forwarded.
 *
 * While it can be manually instantiated, you are more likely to come across a `Forwarder` object as
 * the return value of the [`Input.addForwarder()`](Input#addForwarder) method.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class SS{constructor(t=[],i={}){this.destinations=[],this.types=[...Object.keys(Wt.SYSTEM_MESSAGES),...Object.keys(Wt.CHANNEL_MESSAGES)],this.channels=Wt.MIDI_CHANNEL_NUMBERS,this.suspended=!1,Array.isArray(t)||(t=[t]),i.types&&!Array.isArray(i.types)&&(i.types=[i.types]),i.channels&&!Array.isArray(i.channels)&&(i.channels=[i.channels]),yn.validation&&(t.forEach(r=>{if(!(r instanceof i_))throw new TypeError("Destinations must be of type 'Output'.")}),i.types!==void 0&&i.types.forEach(r=>{if(!Wt.SYSTEM_MESSAGES.hasOwnProperty(r)&&!Wt.CHANNEL_MESSAGES.hasOwnProperty(r))throw new TypeError("Type must be a valid message type.")}),i.channels!==void 0&&i.channels.forEach(r=>{if(!Wt.MIDI_CHANNEL_NUMBERS.includes(r))throw new TypeError("MIDI channel must be between 1 and 16.")})),this.destinations=t,i.types&&(this.types=i.types),i.channels&&(this.channels=i.channels)}forward(t){this.suspended||this.types.includes(t.type)&&(t.channel&&!this.channels.includes(t.channel)||this.destinations.forEach(i=>{yn.validation&&!(i instanceof i_)||i.send(t)}))}}/**
 * The `InputChannel` class represents a single MIDI input channel (1-16) from a single input
 * device. This object is derived from the host's MIDI subsystem and should not be instantiated
 * directly.
 *
 * All 16 `InputChannel` objects can be found inside the input's [`channels`](Input#channels)
 * property.
 *
 * @fires InputChannel#midimessage
 * @fires InputChannel#unknownmessage
 *
 * @fires InputChannel#noteoff
 * @fires InputChannel#noteon
 * @fires InputChannel#keyaftertouch
 * @fires InputChannel#programchange
 * @fires InputChannel#channelaftertouch
 * @fires InputChannel#pitchbend
 *
 * @fires InputChannel#allnotesoff
 * @fires InputChannel#allsoundoff
 * @fires InputChannel#localcontrol
 * @fires InputChannel#monomode
 * @fires InputChannel#omnimode
 * @fires InputChannel#resetallcontrollers
 *
 * @fires InputChannel#event:nrpn
 * @fires InputChannel#event:nrpn-dataentrycoarse
 * @fires InputChannel#event:nrpn-dataentryfine
 * @fires InputChannel#event:nrpn-dataincrement
 * @fires InputChannel#event:nrpn-datadecrement
 * @fires InputChannel#event:rpn
 * @fires InputChannel#event:rpn-dataentrycoarse
 * @fires InputChannel#event:rpn-dataentryfine
 * @fires InputChannel#event:rpn-dataincrement
 * @fires InputChannel#event:rpn-datadecrement
 *
 * @fires InputChannel#controlchange
 * @fires InputChannel#event:controlchange-controllerxxx
 * @fires InputChannel#event:controlchange-bankselectcoarse
 * @fires InputChannel#event:controlchange-modulationwheelcoarse
 * @fires InputChannel#event:controlchange-breathcontrollercoarse
 * @fires InputChannel#event:controlchange-footcontrollercoarse
 * @fires InputChannel#event:controlchange-portamentotimecoarse
 * @fires InputChannel#event:controlchange-dataentrycoarse
 * @fires InputChannel#event:controlchange-volumecoarse
 * @fires InputChannel#event:controlchange-balancecoarse
 * @fires InputChannel#event:controlchange-pancoarse
 * @fires InputChannel#event:controlchange-expressioncoarse
 * @fires InputChannel#event:controlchange-effectcontrol1coarse
 * @fires InputChannel#event:controlchange-effectcontrol2coarse
 * @fires InputChannel#event:controlchange-generalpurposecontroller1
 * @fires InputChannel#event:controlchange-generalpurposecontroller2
 * @fires InputChannel#event:controlchange-generalpurposecontroller3
 * @fires InputChannel#event:controlchange-generalpurposecontroller4
 * @fires InputChannel#event:controlchange-bankselectfine
 * @fires InputChannel#event:controlchange-modulationwheelfine
 * @fires InputChannel#event:controlchange-breathcontrollerfine
 * @fires InputChannel#event:controlchange-footcontrollerfine
 * @fires InputChannel#event:controlchange-portamentotimefine
 * @fires InputChannel#event:controlchange-dataentryfine
 * @fires InputChannel#event:controlchange-channelvolumefine
 * @fires InputChannel#event:controlchange-balancefine
 * @fires InputChannel#event:controlchange-panfine
 * @fires InputChannel#event:controlchange-expressionfine
 * @fires InputChannel#event:controlchange-effectcontrol1fine
 * @fires InputChannel#event:controlchange-effectcontrol2fine
 * @fires InputChannel#event:controlchange-damperpedal
 * @fires InputChannel#event:controlchange-portamento
 * @fires InputChannel#event:controlchange-sostenuto
 * @fires InputChannel#event:controlchange-softpedal
 * @fires InputChannel#event:controlchange-legatopedal
 * @fires InputChannel#event:controlchange-hold2
 * @fires InputChannel#event:controlchange-soundvariation
 * @fires InputChannel#event:controlchange-resonance
 * @fires InputChannel#event:controlchange-releasetime
 * @fires InputChannel#event:controlchange-attacktime
 * @fires InputChannel#event:controlchange-brightness
 * @fires InputChannel#event:controlchange-decaytime
 * @fires InputChannel#event:controlchange-vibratorate
 * @fires InputChannel#event:controlchange-vibratodepth
 * @fires InputChannel#event:controlchange-vibratodelay
 * @fires InputChannel#event:controlchange-generalpurposecontroller5
 * @fires InputChannel#event:controlchange-generalpurposecontroller6
 * @fires InputChannel#event:controlchange-generalpurposecontroller7
 * @fires InputChannel#event:controlchange-generalpurposecontroller8
 * @fires InputChannel#event:controlchange-portamentocontrol
 * @fires InputChannel#event:controlchange-highresolutionvelocityprefix
 * @fires InputChannel#event:controlchange-effect1depth
 * @fires InputChannel#event:controlchange-effect2depth
 * @fires InputChannel#event:controlchange-effect3depth
 * @fires InputChannel#event:controlchange-effect4depth
 * @fires InputChannel#event:controlchange-effect5depth
 * @fires InputChannel#event:controlchange-dataincrement
 * @fires InputChannel#event:controlchange-datadecrement
 * @fires InputChannel#event:controlchange-nonregisteredparameterfine
 * @fires InputChannel#event:controlchange-nonregisteredparametercoarse
 * @fires InputChannel#event:controlchange-registeredparameterfine
 * @fires InputChannel#event:controlchange-registeredparametercoarse
 * @fires InputChannel#event:controlchange-allsoundoff
 * @fires InputChannel#event:controlchange-resetallcontrollers
 * @fires InputChannel#event:controlchange-localcontrol
 * @fires InputChannel#event:controlchange-allnotesoff
 * @fires InputChannel#event:controlchange-omnimodeoff
 * @fires InputChannel#event:controlchange-omnimodeon
 * @fires InputChannel#event:controlchange-monomodeon
 * @fires InputChannel#event:controlchange-polymodeon
 * @fires InputChannel#event:
 *
 * @extends EventEmitter
 * @license Apache-2.0
 * @since 3.0.0
 */class xY extends Wa{constructor(t,i){super(),this._input=t,this._number=i,this._octaveOffset=0,this._nrpnBuffer=[],this._rpnBuffer=[],this.parameterNumberEventsEnabled=!0,this.notesState=new Array(128).fill(!1)}destroy(){this._input=null,this._number=null,this._octaveOffset=0,this._nrpnBuffer=[],this.notesState=new Array(128).fill(!1),this.parameterNumberEventsEnabled=!1,this.removeListener()}_processMidiMessageEvent(t){const i=Object.assign({},t);i.port=this.input,i.target=this,i.type="midimessage",this.emit(i.type,i),this._parseEventForStandardMessages(i)}_parseEventForStandardMessages(t){const i=Object.assign({},t);i.type=i.message.type||"unknownmessage";const r=t.message.dataBytes[0],o=t.message.dataBytes[1];if(i.type==="noteoff"||i.type==="noteon"&&o===0)this.notesState[r]=!1,i.type="noteoff",i.note=new cf(xn.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+yn.octaveOffset),{rawAttack:0,rawRelease:o}),i.value=xn.from7bitToFloat(o),i.rawValue=o,i.velocity=i.note.release,i.rawVelocity=i.note.rawRelease;else if(i.type==="noteon")this.notesState[r]=!0,i.note=new cf(xn.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+yn.octaveOffset),{rawAttack:o}),i.value=xn.from7bitToFloat(o),i.rawValue=o,i.velocity=i.note.attack,i.rawVelocity=i.note.rawAttack;else if(i.type==="keyaftertouch")i.note=new cf(xn.offsetNumber(r,this.octaveOffset+this.input.octaveOffset+yn.octaveOffset)),i.value=xn.from7bitToFloat(o),i.rawValue=o,i.identifier=i.note.identifier,i.key=i.note.number,i.rawKey=r;else if(i.type==="controlchange"){i.controller={number:r,name:Wt.CONTROL_CHANGE_MESSAGES[r].name,description:Wt.CONTROL_CHANGE_MESSAGES[r].description,position:Wt.CONTROL_CHANGE_MESSAGES[r].position},i.subtype=i.controller.name||"controller"+r,i.value=xn.from7bitToFloat(o),i.rawValue=o;const a=Object.assign({},i);a.type=`${i.type}-controller${r}`,delete a.subtype,this.emit(a.type,a);const h=Object.assign({},i);h.type=`${i.type}-`+Wt.CONTROL_CHANGE_MESSAGES[r].name,delete h.subtype,h.type.indexOf("controller")!==0&&this.emit(h.type,h),i.message.dataBytes[0]>=120&&this._parseChannelModeMessage(i),this.parameterNumberEventsEnabled&&this._isRpnOrNrpnController(i.message.dataBytes[0])&&this._parseEventForParameterNumber(i)}else i.type==="programchange"?(i.value=r,i.rawValue=i.value):i.type==="channelaftertouch"?(i.value=xn.from7bitToFloat(r),i.rawValue=r):i.type==="pitchbend"?(i.value=((o<<7)+r-8192)/8192,i.rawValue=(o<<7)+r):i.type="unknownmessage";this.emit(i.type,i)}_parseChannelModeMessage(t){const i=Object.assign({},t);i.type=i.controller.name,i.type==="localcontrol"&&(i.value=i.message.data[2]===127,i.rawValue=i.message.data[2]),i.type==="omnimodeon"?(i.type="omnimode",i.value=!0,i.rawValue=i.message.data[2]):i.type==="omnimodeoff"&&(i.type="omnimode",i.value=!1,i.rawValue=i.message.data[2]),i.type==="monomodeon"?(i.type="monomode",i.value=!0,i.rawValue=i.message.data[2]):i.type==="polymodeon"&&(i.type="monomode",i.value=!1,i.rawValue=i.message.data[2]),this.emit(i.type,i)}_parseEventForParameterNumber(t){const i=t.message.dataBytes[0],r=t.message.dataBytes[1];i===99||i===101?(this._nrpnBuffer=[],this._rpnBuffer=[],i===99?this._nrpnBuffer=[t.message]:r!==127&&(this._rpnBuffer=[t.message])):i===98||i===100?i===98?(this._rpnBuffer=[],this._nrpnBuffer.length===1?this._nrpnBuffer.push(t.message):this._nrpnBuffer=[]):(this._nrpnBuffer=[],this._rpnBuffer.length===1&&r!==127?this._rpnBuffer.push(t.message):this._rpnBuffer=[]):(i===6||i===38||i===96||i===97)&&(this._rpnBuffer.length===2?this._dispatchParameterNumberEvent("rpn",this._rpnBuffer[0].dataBytes[1],this._rpnBuffer[1].dataBytes[1],t):this._nrpnBuffer.length===2?this._dispatchParameterNumberEvent("nrpn",this._nrpnBuffer[0].dataBytes[1],this._nrpnBuffer[1].dataBytes[1],t):(this._nrpnBuffer=[],this._rpnBuffer=[]))}_isRpnOrNrpnController(t){return t===6||t===38||t===96||t===97||t===98||t===99||t===100||t===101}_dispatchParameterNumberEvent(t,i,r,o){t=t==="nrpn"?"nrpn":"rpn";const a={target:o.target,timestamp:o.timestamp,message:o.message,parameterMsb:i,parameterLsb:r,value:xn.from7bitToFloat(o.message.dataBytes[1]),rawValue:o.message.dataBytes[1]};t==="rpn"?a.parameter=Object.keys(Wt.REGISTERED_PARAMETERS).find(p=>Wt.REGISTERED_PARAMETERS[p][0]===i&&Wt.REGISTERED_PARAMETERS[p][1]===r):a.parameter=(i<<7)+r;const h=Wt.CONTROL_CHANGE_MESSAGES[o.message.dataBytes[0]].name;a.type=`${t}-${h}`,this.emit(a.type,a);const u=Object.assign({},a);u.type==="nrpn-dataincrement"?u.type="nrpn-databuttonincrement":u.type==="nrpn-datadecrement"?u.type="nrpn-databuttondecrement":u.type==="rpn-dataincrement"?u.type="rpn-databuttonincrement":u.type==="rpn-datadecrement"&&(u.type="rpn-databuttondecrement"),this.emit(u.type,u),a.type=t,a.subtype=h,this.emit(a.type,a)}getChannelModeByNumber(t){return yn.validation&&(console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class."),t=Math.floor(t)),xn.getChannelModeByNumber(t)}getCcNameByNumber(t){if(yn.validation&&(console.warn("The 'getCcNameByNumber()' method has been moved to the 'Utilities' class."),t=parseInt(t),!(t>=0&&t<=127)))throw new RangeError("Invalid control change number.");return xn.getCcNameByNumber(t)}getNoteState(t){t instanceof cf&&(t=t.identifier);const i=xn.guessNoteNumber(t,yn.octaveOffset+this.input.octaveOffset+this.octaveOffset);return this.notesState[i]}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get input(){return this._input}get number(){return this._number}get nrpnEventsEnabled(){return this.parameterNumberEventsEnabled}set nrpnEventsEnabled(t){this.validation&&(t=!!t),this.parameterNumberEventsEnabled=t}}/**
 * The `Message` class represents a single MIDI message. It has several properties that make it
 * easy to make sense of the binary data it contains.
 *
 * @license Apache-2.0
 * @since 3.0.0
 */class _8{constructor(t){this.rawData=t,this.data=Array.from(this.rawData),this.statusByte=this.rawData[0],this.rawDataBytes=this.rawData.slice(1),this.dataBytes=this.data.slice(1),this.isChannelMessage=!1,this.isSystemMessage=!1,this.command=void 0,this.channel=void 0,this.manufacturerId=void 0,this.type=void 0,this.statusByte<240?(this.isChannelMessage=!0,this.command=this.statusByte>>4,this.channel=(this.statusByte&15)+1):(this.isSystemMessage=!0,this.command=this.statusByte),this.isChannelMessage?this.type=xn.getPropertyByValue(Wt.CHANNEL_MESSAGES,this.command):this.isSystemMessage&&(this.type=xn.getPropertyByValue(Wt.SYSTEM_MESSAGES,this.command)),this.statusByte===Wt.SYSTEM_MESSAGES.sysex&&(this.dataBytes[0]===0?(this.manufacturerId=this.dataBytes.slice(0,3),this.dataBytes=this.dataBytes.slice(3,this.rawDataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(3,this.rawDataBytes.length-1)):(this.manufacturerId=[this.dataBytes[0]],this.dataBytes=this.dataBytes.slice(1,this.dataBytes.length-1),this.rawDataBytes=this.rawDataBytes.slice(1,this.rawDataBytes.length-1)))}}/**
 * The `Input` class represents a single MIDI input port. This object is automatically instantiated
 * by the library according to the host's MIDI subsystem and does not need to be directly
 * instantiated. Instead, you can access all `Input` objects by referring to the
 * [`WebMidi.inputs`](WebMidi#inputs) array. You can also retrieve inputs by using methods such as
 * [`WebMidi.getInputByName()`](WebMidi#getInputByName) and
 * [`WebMidi.getInputById()`](WebMidi#getInputById).
 *
 * Note that a single MIDI device may expose several inputs and/or outputs.
 *
 * **Important**: the `Input` class does not directly fire channel-specific MIDI messages
 * (such as [`noteon`](InputChannel#event:noteon) or
 * [`controlchange`](InputChannel#event:controlchange), etc.). The [`InputChannel`](InputChannel)
 * object does that. However, you can still use the
 * [`Input.addListener()`](#addListener) method to listen to channel-specific events on multiple
 * [`InputChannel`](InputChannel) objects at once.
 *
 * @fires Input#opened
 * @fires Input#disconnected
 * @fires Input#closed
 * @fires Input#midimessage
 *
 * @fires Input#sysex
 * @fires Input#timecode
 * @fires Input#songposition
 * @fires Input#songselect
 * @fires Input#tunerequest
 * @fires Input#clock
 * @fires Input#start
 * @fires Input#continue
 * @fires Input#stop
 * @fires Input#activesensing
 * @fires Input#reset
 *
 * @fires Input#unknownmidimessage
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class MY extends Wa{constructor(t){super(),this._midiInput=t,this._octaveOffset=0,this.channels=[];for(let i=1;i<=16;i++)this.channels[i]=new xY(this,i);this._forwarders=[],this._midiInput.onstatechange=this._onStateChange.bind(this),this._midiInput.onmidimessage=this._onMidiMessage.bind(this)}async destroy(){this.removeListener(),this.channels.forEach(t=>t.destroy()),this.channels=[],this._forwarders=[],this._midiInput&&(this._midiInput.onstatechange=null,this._midiInput.onmidimessage=null),await this.close(),this._midiInput=null}_onStateChange(t){let i={timestamp:yn.time,target:this,port:this};t.port.connection==="open"?(i.type="opened",this.emit("opened",i)):t.port.connection==="closed"&&t.port.state==="connected"?(i.type="closed",this.emit("closed",i)):t.port.connection==="closed"&&t.port.state==="disconnected"?(i.type="disconnected",i.port={connection:t.port.connection,id:t.port.id,manufacturer:t.port.manufacturer,name:t.port.name,state:t.port.state,type:t.port.type},this.emit("disconnected",i)):t.port.connection==="pending"&&t.port.state==="disconnected"||console.warn("This statechange event was not caught: ",t.port.connection,t.port.state)}_onMidiMessage(t){const i=new _8(t.data),r={port:this,target:this,message:i,timestamp:t.timeStamp,type:"midimessage",data:i.data,rawData:i.data,statusByte:i.data[0],dataBytes:i.dataBytes};this.emit("midimessage",r),i.isSystemMessage?this._parseEvent(r):i.isChannelMessage&&this.channels[i.channel]._processMidiMessageEvent(r),this._forwarders.forEach(o=>o.forward(i))}_parseEvent(t){const i=Object.assign({},t);i.type=i.message.type||"unknownmidimessage",i.type==="songselect"&&(i.song=t.data[1]+1,i.value=t.data[1],i.rawValue=i.value),this.emit(i.type,i)}async open(){try{await this._midiInput.open()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}async close(){if(!this._midiInput)return Promise.resolve(this);try{await this._midiInput.close()}catch(t){return Promise.reject(t)}return Promise.resolve(this)}getChannelModeByNumber(){yn.validation&&console.warn("The 'getChannelModeByNumber()' method has been moved to the 'Utilities' class.")}addListener(t,i,r={}){if(yn.validation&&typeof r=="function"){let o=i!=null?[].concat(i):void 0;i=r,r={channels:o}}if(Wt.CHANNEL_EVENTS.includes(t)){r.channels===void 0&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS);let o=[];return xn.sanitizeChannels(r.channels).forEach(a=>{o.push(this.channels[a].addListener(t,i,r))}),o}else return super.addListener(t,i,r)}addOneTimeListener(t,i,r={}){return r.remaining=1,this.addListener(t,i,r)}on(t,i,r,o){return this.addListener(t,i,r,o)}hasListener(t,i,r={}){if(yn.validation&&typeof r=="function"){let o=[].concat(i);i=r,r={channels:o}}return Wt.CHANNEL_EVENTS.includes(t)?(r.channels===void 0&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),xn.sanitizeChannels(r.channels).every(o=>this.channels[o].hasListener(t,i))):super.hasListener(t,i)}removeListener(t,i,r={}){if(yn.validation&&typeof r=="function"){let o=[].concat(i);i=r,r={channels:o}}if(r.channels===void 0&&(r.channels=Wt.MIDI_CHANNEL_NUMBERS),t==null)return xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o]&&this.channels[o].removeListener()}),super.removeListener();Wt.CHANNEL_EVENTS.includes(t)?xn.sanitizeChannels(r.channels).forEach(o=>{this.channels[o].removeListener(t,i,r)}):super.removeListener(t,i,r)}addForwarder(t,i={}){let r;return t instanceof SS?r=t:r=new SS(t,i),this._forwarders.push(r),r}removeForwarder(t){this._forwarders=this._forwarders.filter(i=>i!==t)}hasForwarder(t){return this._forwarders.includes(t)}get name(){return this._midiInput.name}get id(){return this._midiInput.id}get connection(){return this._midiInput.connection}get manufacturer(){return this._midiInput.manufacturer}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get state(){return this._midiInput.state}get type(){return this._midiInput.type}get nrpnEventsEnabled(){return yn.validation&&console.warn("The 'nrpnEventsEnabled' property has been moved to the 'InputChannel' class."),!1}}/**
 * The `WebMidi` object makes it easier to work with the low-level Web MIDI API. Basically, it
 * simplifies sending outgoing MIDI messages and reacting to incoming MIDI messages.
 *
 * When using the WebMidi.js library, you should know that the `WebMidi` class has already been
 * instantiated. You cannot instantiate it yourself. If you use the **IIFE** version, you should
 * simply use the global object called `WebMidi`. If you use the **CJS** (CommonJS) or **ESM** (ES6
 * module) version, you get an already-instantiated object when you import the module.
 *
 * @fires WebMidi#connected
 * @fires WebMidi#disabled
 * @fires WebMidi#disconnected
 * @fires WebMidi#enabled
 * @fires WebMidi#error
 * @fires WebMidi#midiaccessgranted
 * @fires WebMidi#portschanged
 *
 * @extends EventEmitter
 * @license Apache-2.0
 */class SY extends Wa{constructor(){super(),this.defaults={note:{attack:xn.from7bitToFloat(64),release:xn.from7bitToFloat(64),duration:1/0}},this.interface=null,this.validation=!0,this._inputs=[],this._disconnectedInputs=[],this._outputs=[],this._disconnectedOutputs=[],this._stateChangeQueue=[],this._octaveOffset=0}async enable(t={},i=!1){if(xn.isNode){try{window.navigator}catch{let u=await Object.getPrototypeOf(async function(){}).constructor(`
        let jzz = await import("jzz");
        return jzz.default;
        `)();global.navigator||(global.navigator={}),Object.assign(global.navigator,u)}try{}catch{global.performance=await Object.getPrototypeOf(async function(){}).constructor(`
        let perf_hooks = await import("perf_hooks");
        return perf_hooks.performance;
        `)()}}if(this.validation=t.validation!==!1,this.validation&&(typeof t=="function"&&(t={callback:t,sysex:i}),i&&(t.sysex=!0)),this.enabled)return typeof t.callback=="function"&&t.callback(),Promise.resolve();const r={timestamp:this.time,target:this,type:"error",error:void 0},o={timestamp:this.time,target:this,type:"midiaccessgranted"},a={timestamp:this.time,target:this,type:"enabled"};try{typeof t.requestMIDIAccessFunction=="function"?this.interface=await t.requestMIDIAccessFunction({sysex:t.sysex,software:t.software}):this.interface=await navigator.requestMIDIAccess({sysex:t.sysex,software:t.software})}catch(h){return r.error=h,this.emit("error",r),typeof t.callback=="function"&&t.callback(h),Promise.reject(h)}this.emit("midiaccessgranted",o),this.interface.onstatechange=this._onInterfaceStateChange.bind(this);try{await this._updateInputsAndOutputs()}catch(h){return r.error=h,this.emit("error",r),typeof t.callback=="function"&&t.callback(h),Promise.reject(h)}return this.emit("enabled",a),typeof t.callback=="function"&&t.callback(),Promise.resolve(this)}async disable(){return this.interface&&(this.interface.onstatechange=void 0),this._destroyInputsAndOutputs().then(()=>{navigator&&typeof navigator.close=="function"&&navigator.close(),this.interface=null;let t={timestamp:this.time,target:this,type:"disabled"};this.emit("disabled",t),this.removeListener()})}getInputById(t,i={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(i.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(this._disconnectedInputs[r].id===t.toString())return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(this.inputs[r].id===t.toString())return this.inputs[r]}getInputByName(t,i={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(i.disconnected){for(let r=0;r<this._disconnectedInputs.length;r++)if(~this._disconnectedInputs[r].name.indexOf(t))return this._disconnectedInputs[r]}else for(let r=0;r<this.inputs.length;r++)if(~this.inputs[r].name.indexOf(t))return this.inputs[r]}getOutputByName(t,i={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return;t=t.toString()}if(i.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(~this._disconnectedOutputs[r].name.indexOf(t))return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(~this.outputs[r].name.indexOf(t))return this.outputs[r]}getOutputById(t,i={disconnected:!1}){if(this.validation){if(!this.enabled)throw new Error("WebMidi is not enabled.");if(!t)return}if(i.disconnected){for(let r=0;r<this._disconnectedOutputs.length;r++)if(this._disconnectedOutputs[r].id===t.toString())return this._disconnectedOutputs[r]}else for(let r=0;r<this.outputs.length;r++)if(this.outputs[r].id===t.toString())return this.outputs[r]}noteNameToNumber(t){return this.validation&&console.warn("The noteNameToNumber() method is deprecated. Use Utilities.toNoteNumber() instead."),xn.toNoteNumber(t,this.octaveOffset)}getOctave(t){return this.validation&&(console.warn("The getOctave()is deprecated. Use Utilities.getNoteDetails() instead"),t=parseInt(t)),!isNaN(t)&&t>=0&&t<=127?xn.getNoteDetails(xn.offsetNumber(t,this.octaveOffset)).octave:!1}sanitizeChannels(t){return this.validation&&console.warn("The sanitizeChannels() method has been moved to the utilities class."),xn.sanitizeChannels(t)}toMIDIChannels(t){return this.validation&&console.warn("The toMIDIChannels() method has been deprecated. Use Utilities.sanitizeChannels() instead."),xn.sanitizeChannels(t)}guessNoteNumber(t){return this.validation&&console.warn("The guessNoteNumber() method has been deprecated. Use Utilities.guessNoteNumber() instead."),xn.guessNoteNumber(t,this.octaveOffset)}getValidNoteArray(t,i={}){return this.validation&&console.warn("The getValidNoteArray() method has been moved to the Utilities.buildNoteArray()"),xn.buildNoteArray(t,i)}convertToTimestamp(t){return this.validation&&console.warn("The convertToTimestamp() method has been moved to Utilities.toTimestamp()."),xn.toTimestamp(t)}async _destroyInputsAndOutputs(){let t=[];return this.inputs.forEach(i=>t.push(i.destroy())),this.outputs.forEach(i=>t.push(i.destroy())),Promise.all(t).then(()=>{this._inputs=[],this._outputs=[]})}_onInterfaceStateChange(t){this._updateInputsAndOutputs();let i={timestamp:t.timeStamp,type:t.port.state,target:this};if(t.port.state==="connected"&&t.port.connection==="open"){t.port.type==="output"?i.port=this.getOutputById(t.port.id):t.port.type==="input"&&(i.port=this.getInputById(t.port.id)),this.emit(t.port.state,i);const r=Object.assign({},i);r.type="portschanged",this.emit(r.type,r)}else if(t.port.state==="disconnected"&&t.port.connection==="pending"){t.port.type==="input"?i.port=this.getInputById(t.port.id,{disconnected:!0}):t.port.type==="output"&&(i.port=this.getOutputById(t.port.id,{disconnected:!0})),this.emit(t.port.state,i);const r=Object.assign({},i);r.type="portschanged",this.emit(r.type,r)}}async _updateInputsAndOutputs(){return Promise.all([this._updateInputs(),this._updateOutputs()])}async _updateInputs(){if(!this.interface)return;for(let i=this._inputs.length-1;i>=0;i--){const r=this._inputs[i];Array.from(this.interface.inputs.values()).find(a=>a===r._midiInput)||(this._disconnectedInputs.push(r),this._inputs.splice(i,1))}let t=[];return this.interface.inputs.forEach(i=>{if(!this._inputs.find(r=>r._midiInput===i)){let r=this._disconnectedInputs.find(o=>o._midiInput===i);r||(r=new MY(i)),this._inputs.push(r),t.push(r.open())}}),Promise.all(t)}async _updateOutputs(){if(!this.interface)return;for(let i=this._outputs.length-1;i>=0;i--){const r=this._outputs[i];Array.from(this.interface.outputs.values()).find(a=>a===r._midiOutput)||(this._disconnectedOutputs.push(r),this._outputs.splice(i,1))}let t=[];return this.interface.outputs.forEach(i=>{if(!this._outputs.find(r=>r._midiOutput===i)){let r=this._disconnectedOutputs.find(o=>o._midiOutput===i);r||(r=new i_(i)),this._outputs.push(r),t.push(r.open())}}),Promise.all(t)}get enabled(){return this.interface!==null}get inputs(){return this._inputs}get isNode(){return this.validation&&console.warn("WebMidi.isNode has been deprecated. Use Utilities.isNode instead."),xn.isNode}get isBrowser(){return this.validation&&console.warn("WebMidi.isBrowser has been deprecated. Use Utilities.isBrowser instead."),xn.isBrowser}get octaveOffset(){return this._octaveOffset}set octaveOffset(t){if(this.validation&&(t=parseInt(t),isNaN(t)))throw new TypeError("The 'octaveOffset' property must be an integer.");this._octaveOffset=t}get outputs(){return this._outputs}get supported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}get sysexEnabled(){return!!(this.interface&&this.interface.sysexEnabled)}get time(){return performance.now()}get version(){return"3.1.9"}get flavour(){return"esm"}get CHANNEL_EVENTS(){return this.validation&&console.warn("The CHANNEL_EVENTS enum has been moved to Enumerations.CHANNEL_EVENTS."),Wt.CHANNEL_EVENTS}get MIDI_SYSTEM_MESSAGES(){return this.validation&&console.warn("The MIDI_SYSTEM_MESSAGES enum has been moved to Enumerations.SYSTEM_MESSAGES."),Wt.SYSTEM_MESSAGES}get MIDI_CHANNEL_MODE_MESSAGES(){return this.validation&&console.warn("The MIDI_CHANNEL_MODE_MESSAGES enum has been moved to Enumerations.CHANNEL_MODE_MESSAGES."),Wt.CHANNEL_MODE_MESSAGES}get MIDI_CONTROL_CHANGE_MESSAGES(){return this.validation&&console.warn("The MIDI_CONTROL_CHANGE_MESSAGES enum has been replaced by the Enumerations.CONTROL_CHANGE_MESSAGES array."),Wt.MIDI_CONTROL_CHANGE_MESSAGES}get MIDI_REGISTERED_PARAMETER(){return this.validation&&console.warn("The MIDI_REGISTERED_PARAMETER enum has been moved to Enumerations.REGISTERED_PARAMETERS."),Wt.REGISTERED_PARAMETERS}get NOTES(){return this.validation&&console.warn("The NOTES enum has been deprecated."),["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]}}const yn=new SY;yn.constructor=null;function TY(e,t,i){let{midiMessage:r=null}=t,{noteOn:o=null}=t,{noteOff:a=null}=t,{controlChange:h=null}=t,{pitchBend:u=null}=t,{errorCallback:p=g=>alert(g)}=t,{midiDevices:c=[]}=t;const f=()=>{i(0,c=[]),yn.inputs.length<1?console.warn("No MIDI device detected"):(yn.inputs.forEach((g,m)=>{console.log(`MIDI device ${m}: ${g.name}`),r&&g.addListener("midimessage",r),o&&g.addListener("noteon",o),a&&g.addListener("noteoff",a),h&&g.addListener("controlchange",h),u&&g.addListener("pitchbend",u)}),i(0,c=[...yn.inputs]))};return tr(()=>{yn.enable().then(f).catch(p)}),Io(()=>{for(const g of yn.inputs)g.removeListener()}),e.$$set=g=>{"midiMessage"in g&&i(1,r=g.midiMessage),"noteOn"in g&&i(2,o=g.noteOn),"noteOff"in g&&i(3,a=g.noteOff),"controlChange"in g&&i(4,h=g.controlChange),"pitchBend"in g&&i(5,u=g.pitchBend),"errorCallback"in g&&i(6,p=g.errorCallback),"midiDevices"in g&&i(0,c=g.midiDevices)},[c,r,o,a,h,u,p]}class Nr extends pi{constructor(t){super(),di(this,t,TY,null,fi,{midiMessage:1,noteOn:2,noteOff:3,controlChange:4,pitchBend:5,errorCallback:6,midiDevices:0})}}function IY(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g=e[1].join(", ")+"",m,v,A,y,C=e[2].join(" or ")+"",E,x,M,w;return M=new Nr({props:{noteOn:e[3]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Play a chord on a MIDI instrument. The notes you played and the detected
        chord will be shown below.`,u=ge(),p=oe("div"),c=$e("Notes: "),f=oe("b"),m=$e(g),v=oe("br"),A=$e(`
        Detected chord: `),y=oe("b"),E=$e(C),x=ge(),Ut(M.$$.fragment),fe(h,"class","explanation"),fe(p,"class","visualization"),fe(t,"class","demo")},m(S,I){Bt(S,t,I),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(p,f),D(f,m),D(p,v),D(p,A),D(p,y),D(y,E),D(t,x),Ft(M,t,null),w=!0},p(S,[I]){(!w||I&1)&&r!==(r=S[0].title+"")&&jt(o,r),(!w||I&2)&&g!==(g=S[1].join(", ")+"")&&jt(m,g),(!w||I&4)&&C!==(C=S[2].join(" or ")+"")&&jt(E,C)},i(S){w||(Nt(M.$$.fragment,S),w=!0)},o(S){Ot(M.$$.fragment,S),w=!1},d(S){S&&It(t),kt(M)}}}function BY(e,t,i){let{toolInfo:r}=t,o=0,a=[],h=[],u=[];const p=f=>{a.length===0&&(o=f.timestamp);const g=(f.timestamp-o)/1e3,m={number:f.note.number,velocity:f.rawVelocity,time:g,channel:f.message.channel};a.push(m),c()},c=()=>{const f=Zr(a,g=>g.time);i(1,h=a.filter(g=>g.time>f-1).sort((g,m)=>g.number-m.number).map(g=>Ss.fromMidiSharps(g.number))),i(1,h=[...new Set(h)]),i(2,u=jg.detect(h))};return tr(c),e.$$set=f=>{"toolInfo"in f&&i(0,r=f.toolInfo)},[r,h,u,p]}class RY extends pi{constructor(t){super(),di(this,t,BY,IY,fi,{toolInfo:0})}}function tu(e){return e!=null&&!Number.isNaN(e)}function Ia(e,t){return+tu(t)-+tu(e)||Vo(e,t)}function Wg(e,t){return+tu(t)-+tu(e)||am(e,t)}function BE(e){return e!=null&&`${e}`!=""}function E8(e){return isFinite(e)?e:NaN}function G1(e){return e>0&&isFinite(e)?e:NaN}function RE(e){return e<0&&isFinite(e)?e:NaN}function LY(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const i=e.getUTCHours(),r=e.getUTCMinutes(),o=e.getUTCSeconds(),a=e.getUTCMilliseconds();return`${PY(e.getUTCFullYear())}-${ec(e.getUTCMonth()+1,2)}-${ec(e.getUTCDate(),2)}${i||r||o||a?`T${ec(i,2)}:${ec(r,2)}${o||a?`:${ec(o,2)}${a?`.${ec(a,3)}`:""}`:""}Z`:""}`}function PY(e){return e<0?`-${ec(-e,6)}`:e>9999?`+${ec(e,6)}`:ec(e,4)}function ec(e,t){return`${e}`.padStart(t,"0")}const DY=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function w8(e,t){return DY.test(e+="")?new Date(e):typeof t=="function"?t(e):t}function Vf(e){if(e==null)return;const t=e[0],i=e[e.length-1];return am(t,i)}const uf=1e3,Wc=uf*60,$c=Wc*60,xl=$c*24,hl=xl*7,Ku=xl*30,Gc=xl*365,Fy=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",uf],["5 seconds",5*uf],["15 seconds",15*uf],["30 seconds",30*uf],["minute",Wc],["5 minutes",5*Wc],["15 minutes",15*Wc],["30 minutes",30*Wc],["hour",$c],["3 hours",3*$c],["6 hours",6*$c],["12 hours",12*$c],["day",xl],["2 days",2*xl],["week",hl],["2 weeks",2*hl],["month",Ku],["3 months",3*Ku],["6 months",6*Ku],["year",Gc],["2 years",2*Gc],["5 years",5*Gc],["10 years",10*Gc],["20 years",20*Gc],["50 years",50*Gc],["100 years",100*Gc]],LE=new Map([["second",uf],["minute",Wc],["hour",$c],["day",xl],["monday",hl],["tuesday",hl],["wednesday",hl],["thursday",hl],["friday",hl],["saturday",hl],["sunday",hl],["week",hl],["month",Ku],["year",Gc]]),C8=new Map([["second",ja],["minute",Am],["hour",vm],["day",ch],["monday",Up],["tuesday",T5],["wednesday",I5],["thursday",rh],["friday",B5],["saturday",R5],["sunday",Ff],["week",Ff],["month",ym],["year",Ya]]),PE=new Map([["second",ja],["minute",gm],["hour",bm],["day",B1],["monday",Gp],["tuesday",L5],["wednesday",P5],["thursday",sh],["friday",D5],["saturday",N5],["sunday",kf],["week",kf],["month",_m],["year",qa]]),Mm=Symbol("intervalDuration"),V1=Symbol("intervalType");for(const[e,t]of C8)t[Mm]=LE.get(e),t[V1]="time";for(const[e,t]of PE)t[Mm]=LE.get(e),t[V1]="utc";const hp=[["year",qa,"utc"],["month",_m,"utc"],["day",B1,"utc",6*Ku],["hour",bm,"utc",3*xl],["minute",gm,"utc",6*$c],["second",ja,"utc",30*Wc]],eg=[["year",Ya,"time"],["month",ym,"time"],["day",ch,"time",6*Ku],["hour",vm,"time",3*xl],["minute",Am,"time",6*$c],["second",ja,"time",30*Wc]],NY=[hp[0],eg[0],hp[1],eg[1],hp[2],eg[2],...hp.slice(3)];function x8(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let i=1;const r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),i=+r[1]),t){case"quarter":t="month",i*=3;break;case"half":t="month",i*=6;break}let o=PE.get(t);if(!o)throw new Error(`unknown interval: ${e}`);if(i>1&&!o.every)throw new Error(`non-periodic interval: ${t}`);return[t,i]}function M8(e){return S8(x8(e),"time")}function DE(e){return S8(x8(e),"utc")}function S8([e,t],i){let r=(i==="time"?C8:PE).get(e);return t>1&&(r=r.every(t),r[Mm]=LE.get(e)*t,r[V1]=i),r}function TS(e,t){if(!(t>1))return;const i=e[Mm];if(!Fy.some(([,o])=>o===i)||i%xl===0&&xl<i&&i<Ku)return;const[r]=Fy[f1(([,o])=>Math.log(o)).center(Fy,Math.log(i*t))];return(e[V1]==="time"?M8:DE)(r)}function IS(e,t,i){const r=t==="time"?lE:Em;if(i==null)return r(e==="year"?"%Y":e==="month"?"%Y-%m":e==="day"?"%Y-%m-%d":e==="hour"||e==="minute"?"%Y-%m-%dT%H:%M":e==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const o=OY(i);switch(e){case"millisecond":return nf(r(".%L"),r(":%M:%S"),o);case"second":return nf(r(":%S"),r("%-I:%M"),o);case"minute":return nf(r("%-I:%M"),r("%p"),o);case"hour":return nf(r("%-I %p"),r("%b %-d"),o);case"day":return nf(r("%-d"),r("%b"),o);case"month":return nf(r("%b"),r("%Y"),o);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function OY(e){return e==="left"||e==="right"?(t,i)=>`
${t}
${i}`:e==="top"?(t,i)=>`${i}
${t}`:(t,i)=>`${t}
${i}`}function FY(e){return e==="time"?eg:e==="utc"?hp:NY}function kY(e,t,i){const r=Zr(hG(t,(o,a)=>Math.abs(a-o)));if(r<1e3)return IS("millisecond","utc",i);for(const[o,a,h,u]of FY(e)){if(r>u||o==="hour"&&!r)break;if(t.every(p=>a.floor(p)>=p))return IS(o,h,i)}}function nf(e,t,i){return(r,o,a)=>{const h=e(r,o),u=t(r,o),p=o-Vf(a);return o!==p&&a[p]!==void 0&&u===t(a[p],p)?h:i(h,u)}}const Hp=Object.getPrototypeOf(Uint8Array),UY=Object.prototype.toString,T8=Symbol("reindex");function Xr(e,t,i){const r=typeof t;return r==="string"?BS(e,I8(t),i):r==="function"?BS(e,t,i):r==="number"||t instanceof Date||r==="boolean"?Os(e,Tm(t),i):typeof(t==null?void 0:t.transform)=="function"?RS(t.transform(e),i):GY(RS(t,i),e==null?void 0:e[T8])}function GY(e,t){return t?UE(e,t):e}function BS(e,t,i){return Os(e,(i==null?void 0:i.prototype)instanceof Hp?VY(t):t,i)}function RS(e,t){return t===void 0?la(e):e instanceof t?e:t.prototype instanceof Hp&&!(e instanceof Hp)?t.from(e,OE):t.from(e)}function VY(e){return(t,i)=>OE(e(t,i))}const tg=[null],I8=e=>t=>t[e],Sm={transform:gc},fs={transform:e=>e},NE=()=>1,QY=()=>!0,xo=e=>e==null?e:`${e}`,Pr=e=>e==null?e:+e,B8=e=>e?e[0]:void 0,r_=e=>e?e[1]:void 0,Tm=e=>()=>e;function HY(e){const t=+`${e}`.slice(1)/100;return(i,r)=>Sf(i,t,r)}function vl(e){return e instanceof Hp?e:Os(e,OE,Float64Array)}function OE(e){return e==null?NaN:Number(e)}function zY(e){return Os(e,R8)}function R8(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?w8(e):e==null||isNaN(e=+e)?void 0:new Date(e)}function Za(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:H1(e)?[void 0,e]:[e,void 0]}function Mo(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function L8(e,t,i){if(e!=null)return Pa(e,t,i)}function Pa(e,t,i){const r=`${e}`.toLowerCase();if(!i.includes(r))throw new Error(`invalid ${t}: ${e}`);return r}function la(e){return e==null||e instanceof Array||e instanceof Hp?e:Array.from(e)}function Os(e,t,i=Array){return e==null?e:e instanceof i?e.map(t):i.from(e,t)}function zp(e,t=Array){return e instanceof t?e.slice():t.from(e)}function P8({x:e,x1:t,x2:i}){return e!==void 0||t!==void 0||i!==void 0}function D8({y:e,y1:t,y2:i}){return e!==void 0||t!==void 0||i!==void 0}function FE(e){return P8(e)||D8(e)||e.interval!==void 0}function Tl(e){return(e==null?void 0:e.toString)===UY}function s_(e){return Tl(e)&&(e.type!==void 0||e.domain!==void 0)}function Q1(e){return Tl(e)&&typeof e.transform!="function"}function Qf(e){return Q1(e)&&e.value===void 0&&e.channel===void 0}function N8(e,t,i,r=fs){return t===void 0&&i===void 0?(t=0,i=e===void 0?r:e):t===void 0?t=e===void 0?0:e:i===void 0&&(i=e===void 0?0:e),[t,i]}function id(e,t){return e===void 0&&t===void 0?[B8,r_]:[e,t]}function kE({z:e,fill:t,stroke:i}={}){return e===void 0&&([e]=Za(t)),e===void 0&&([e]=Za(i)),e}function gc(e){const t=e.length,i=new Uint32Array(t);for(let r=0;r<t;++r)i[r]=r;return i}function UE(e,t){return Os(t,i=>e[i],e.constructor)}function jY(e,t,i){return e.subarray?e.subarray(t,i):e.slice(t,i)}function Hu(e){return e!==null&&typeof e=="object"?e.valueOf():e}function WY(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function $a(e){let t;return[{transform:()=>t,label:ph(e)},i=>t=i]}function Uo(e){return e==null?[e]:$a(e)}function ph(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function $g(e,t){return{transform(i){const r=e.transform(i),o=t.transform(i);return Ho(r)||Ho(o)?Os(r,(a,h)=>new Date((+r[h]+ +o[h])/2)):Os(r,(a,h)=>(+r[h]+ +o[h])/2,Float64Array)},label:e.label}}function Xg(e,t){const i=O8(t==null?void 0:t.interval,t==null?void 0:t.type);return i?Os(e,i):e}function O8(e,t){const i=GE(e,t);return i&&(r=>tu(r)?i.floor(r):r)}function GE(e,t){if(e!=null){if(typeof e=="number"){0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const i=Math.abs(e);return e<0?{floor:r=>Math.floor(r*i)/i,offset:r=>(r*i+1)/i,range:(r,o)=>Mn(Math.ceil(r*i),o*i).map(a=>a/i)}:{floor:r=>Math.floor(r/i)*i,offset:r=>r+i,range:(r,o)=>Mn(Math.ceil(r/i),o/i).map(a=>a*i)}}if(typeof e=="string")return(t==="time"?M8:DE)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function rd(e,t){if(e=GE(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function $Y(e,t){if(e=rd(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function XY(e){return hf(e)&&typeof(e==null?void 0:e.floor)=="function"&&e.floor()instanceof Date}function hf(e){return typeof(e==null?void 0:e.range)=="function"}function Im(e){return e===void 0||Q1(e)?e:{value:e}}function KY(e){return e==null?null:{transform:t=>Xr(t,e,Float64Array),label:ph(e)}}function su(e){return e&&typeof e[Symbol.iterator]=="function"}function F8(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function LS(e){for(const t of e){if(t==null)continue;const i=typeof t;return i==="string"||i==="boolean"}}function Ho(e){for(const t of e)if(t!=null)return t instanceof Date}function YY(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&w8(t)}function qY(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function JY(e){for(const t of e)if(t!=null)return typeof t=="number"}function ky(e,t){let i;for(const r of e)if(r!=null){if(!t(r))return!1;i=!0}return i}const ZY=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function H1(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||ZY.has(e))}function eq(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function ho(e){return e==null||jp(e)}function jp(e){return/^\s*none\s*$/i.test(e)}function tq(e){return/^\s*round\s*$/i.test(e)}function o_(e,t){return L8(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function z1(e="middle"){return o_(e,"frameAnchor")}function nq(e={},...t){let i=e;for(const r of t)for(const o in r)if(i[o]===void 0){const a=r[o];i===e?i={...i,[o]:a}:i[o]=a}return i}function iq(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,i=>{const{name:r}=i;if(r==null)throw new Error("missing name");const o=`${r}`;if(o==="__proto__")throw new Error(`illegal name: ${o}`);if(t.has(o))throw new Error(`duplicate name: ${o}`);return t.add(o),[r,i]}))}function k8(e){return su(e)?iq(e):e}function U8(e){return e===!0?e="frame":e===!1?e=null:e!=null&&(e=Pa(e,"clip",["frame","sphere"])),e}const bl=Symbol("position"),vc=Symbol("color"),Bm=Symbol("radius"),Rm=Symbol("length"),Lm=Symbol("opacity"),j1=Symbol("symbol"),G8=Symbol("projection"),us=new Map([["x",bl],["y",bl],["fx",bl],["fy",bl],["r",Bm],["color",vc],["opacity",Lm],["symbol",j1],["length",Rm],["projection",G8]]);function rq(e){return e===bl||e===G8}function sq(e){return e===bl||e===Bm||e===Rm||e===Lm}const oq=Math.sqrt(3),aq=2/oq,lq={draw(e,t){const i=Math.sqrt(t/Math.PI),r=i*aq,o=r/2;e.moveTo(0,r),e.lineTo(i,o),e.lineTo(i,-o),e.lineTo(0,-r),e.lineTo(-i,-o),e.lineTo(-i,o),e.closePath()}},VE=new Map([["asterisk",o6],["circle",Qp],["cross",a6],["diamond",c6],["diamond2",u6],["hexagon",lq],["plus",h6],["square",f6],["square2",d6],["star",m6],["times",b6],["triangle",A6],["triangle2",g6],["wye",v6]]);function QE(e){return e&&typeof e.draw=="function"}function cq(e){return QE(e)?!0:typeof e!="string"?!1:VE.has(e.toLowerCase())}function HE(e){if(e==null||QE(e))return e;const t=VE.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function uq(e){if(e==null||QE(e))return[void 0,e];if(typeof e=="string"){const t=VE.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function mh({filter:e,sort:t,reverse:i,transform:r,initializer:o,...a}={},h){if(r===void 0&&(e!=null&&(r=V8(e)),t!=null&&!Qf(t)&&(r=Uy(r,zE(t))),i&&(r=Uy(r,Q8))),h!=null&&o!=null)throw new Error("transforms cannot be applied after initializers");return{...a,...(t===null||Qf(t))&&{sort:t},transform:Uy(r,h)}}function Hf({filter:e,sort:t,reverse:i,initializer:r,...o}={},a){return r===void 0&&(e!=null&&(r=V8(e)),t!=null&&!Qf(t)&&(r=Gy(r,zE(t))),i&&(r=Gy(r,Q8))),{...o,...(t===null||Qf(t))&&{sort:t},initializer:Gy(r,a)}}function Uy(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(i,r,o){return{data:i,facets:r}=e.call(this,i,r,o),t.call(this,la(i),r,o)}}function Gy(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(i,r,o,...a){let h,u,p,c,f,g;return{data:u=i,facets:p=r,channels:h}=e.call(this,i,r,o,...a),{data:f=u,facets:g=p,channels:c}=t.call(this,u,p,{...o,...h},...a),{data:f,facets:g,channels:{...h,...c}}}}function hq(e,t){return(e.initializer!=null?Hf:mh)(e,t)}function V8(e){return(t,i)=>{const r=Xr(t,e);return{data:t,facets:i.map(o=>o.filter(a=>r[a]))}}}function Q8(e,t){return{data:e,facets:t.map(i=>i.slice().reverse())}}function fq(e,{sort:t,...i}={}){return{...(Q1(e)&&e.channel!==void 0?Hf:hq)(i,zE(e)),sort:Qf(t)?t:null}}function zE(e){return(typeof e=="function"&&e.length!==1?dq:pq)(e)}function dq(e){return(t,i)=>{const r=(o,a)=>e(t[o],t[a]);return{data:t,facets:i.map(o=>o.slice().sort(r))}}}function pq(e){let t,i;({channel:t,value:e,order:i}={...Im(e)});const r=t==null?void 0:t.startsWith("-");if(r&&(t=t.slice(1)),i===void 0&&(i=r?Wg:Ia),typeof i!="function")switch(`${i}`.toLowerCase()){case"ascending":i=Ia;break;case"descending":i=Wg;break;default:throw new Error(`invalid order: ${i}`)}return(o,a,h)=>{let u;if(t===void 0)u=Xr(o,e);else{if(h===void 0)throw new Error("channel sort requires an initializer");if(u=h[t],!u)return{};u=u.value}const p=(c,f)=>i(u[c],u[f]);return{data:o,facets:a.map(c=>c.slice().sort(p))}}}function mq(e={y:"count"},t={}){const{x:i=fs}=t;if(i==null)throw new Error("missing channel: x");return H8(i,null,e,t)}function Aq(e={fill:"count"},t={}){let{x:i,y:r}=t;if([i,r]=id(i,r),i==null)throw new Error("missing channel: x");if(r==null)throw new Error("missing channel: y");return H8(i,r,e,t)}function H8(e,t,{data:i=$E,filter:r,sort:o,reverse:a,...h}={},u={}){h=bq(h,u),i=$8(i,fs),o=o==null?void 0:j8("sort",o,u),r=r==null?void 0:W8("filter",r,u);const[p,c]=Uo(e),[f,g]=Uo(t),{z:m,fill:v,stroke:A,x1:y,x2:C,y1:E,y2:x,...M}=u,[w,S]=Uo(m),[I]=Za(v),[L]=Za(A),[R,k]=Uo(I),[P,F]=Uo(L);return{..."z"in u&&{z:w||m},..."fill"in u&&{fill:R||v},..."stroke"in u&&{stroke:P||A},...mh(M,(O,W,V)=>{const $=Xg(Xr(O,e),V==null?void 0:V.x),H=Xg(Xr(O,t),V==null?void 0:V.y),Y=Xr(O,m),Q=Xr(O,I),G=Xr(O,L),J=X8(h,{z:Y,fill:Q,stroke:G}),K=[],se=[],ue=$&&c([]),he=H&&g([]),Me=Y&&S([]),de=Q&&k([]),Pe=G&&F([]);let Se=0;for(const Le of h)Le.initialize(O);o&&o.initialize(O),r&&r.initialize(O);for(const Le of W){const be=[];for(const je of h)je.scope("facet",Le);o&&o.scope("facet",Le),r&&r.scope("facet",Le);for(const[je,Te]of xp(Le,J))for(const[rt,mt]of xp(Te,H))for(const[vt,ft]of xp(mt,$)){const Ze={data:O};if($&&(Ze.x=vt),H&&(Ze.y=rt),J&&(Ze.z=je),!(r&&!r.reduce(ft,Ze))){be.push(Se++),se.push(i.reduceIndex(ft,O,Ze)),$&&ue.push(vt),H&&he.push(rt),Y&&Me.push(J===Y?je:Y[ft[0]]),Q&&de.push(J===Q?je:Q[ft[0]]),G&&Pe.push(J===G?je:G[ft[0]]);for(const St of h)St.reduce(ft,Ze);o&&o.reduce(ft,Ze)}}K.push(be)}return K8(K,o,a),{data:se,facets:K}}),...!Cp(h,"x")&&(p?{x:p}:{x1:y,x2:C}),...!Cp(h,"y")&&(f?{y:f}:{y1:E,y2:x}),...Object.fromEntries(h.map(({name:O,output:W})=>[O,W]))}}function Cp(e,...t){for(const{name:i}of e)if(t.includes(i))return!0;return!1}function z8(e,t,i=jE){const r=Object.entries(e);return t.title!=null&&e.title===void 0&&r.push(["title",wq]),t.href!=null&&e.href===void 0&&r.push(["href",XE]),r.filter(([,o])=>o!==void 0).map(([o,a])=>a===null?gq(o):i(o,a,t))}function jE(e,t,i,r=WE){let o;Tl(t)&&"reduce"in t&&(o=t.scale,t=t.reduce);const a=r(e,t,i),[h,u]=$a(a.label);let p;return{name:e,output:o===void 0?h:{value:h,scale:o},initialize(c){a.initialize(c),p=u([])},scope(c,f){a.scope(c,f)},reduce(c,f){p.push(a.reduce(c,f))}}}function gq(e){return{name:e,initialize(){},scope(){},reduce(){}}}function WE(e,t,i,r=W1){const o=WY(e,i),a=r(t,o);let h,u;return{label:ph(a===Kg?null:o,a.label),initialize(p){h=o===void 0?p:Xr(p,o),a.scope==="data"&&(u=a.reduceIndex(gc(p),h))},scope(p,c){a.scope===p&&(u=a.reduceIndex(c,h))},reduce(p,c){return a.scope==null?a.reduceIndex(p,h,c):a.reduceIndex(p,h,u,c)}}}function xp(e,t){return t?d1(e,i=>t[i]):[[,e]]}function W1(e,t,i=vq){if(e==null)return i(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&Tl(e))return _q(e);if(typeof e=="function")return Eq(e);if(/^p\d{2}$/i.test(e))return Zl(HY(e));switch(`${e}`.toLowerCase()){case"first":return XE;case"last":return Cq;case"identity":return $E;case"count":return Kg;case"distinct":return xq;case"sum":return t==null?Kg:Mq;case"proportion":return DS(t,"data");case"proportion-facet":return DS(t,"facet");case"deviation":return Zl(O4);case"min":return Zl(So);case"min-index":return Zl(H_);case"max":return Zl(Zr);case"max-index":return Zl(oG);case"mean":return PS(W4);case"median":return PS(Lp);case"variance":return Zl(N4);case"mode":return Zl(uG)}return i(e)}function vq(e){throw new Error(`invalid reduce: ${e}`)}function bq(e,t){return z8(e,t,j8)}function j8(e,t,i){return jE(e,t,i,W8)}function W8(e,t,i){return WE(e,t,i,$8)}function $8(e,t){return W1(e,t,yq)}function yq(e){switch(`${e}`.toLowerCase()){case"x":return Sq;case"y":return Tq;case"z":return Y8}throw new Error(`invalid group reduce: ${e}`)}function X8(e,t){for(const i in t){const r=t[i];if(r!==void 0&&!e.some(o=>o.name===i))return r}}function K8(e,t,i){if(t){const r=t.output.transform(),o=(a,h)=>Ia(r[a],r[h]);e.forEach(a=>a.sort(o))}i&&e.forEach(r=>r.reverse())}function _q(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function Eq(e){return{reduceIndex(t,i,r){return e(UE(i,t),r)}}}function Zl(e){return{reduceIndex(t,i){return e(t,r=>i[r])}}}function PS(e){return{reduceIndex(t,i){const r=e(t,o=>i[o]);return Ho(i)?new Date(r):r}}}const $E={reduceIndex(e,t){return UE(t,e)}},XE={reduceIndex(e,t){return t[e[0]]}},wq={reduceIndex(e,t){const r=ug(mf(e,a=>a.length,a=>t[a]),r_),o=r.slice(-5).reverse();if(o.length<r.length){const a=r.slice(0,-4);o[4]=[` ${a.length.toLocaleString("en-US")} more`,Kc(a,r_)]}return o.map(([a,h])=>`${a} (${h.toLocaleString("en-US")})`).join(`
`)}},Cq={reduceIndex(e,t){return t[e[e.length-1]]}},Kg={label:"Frequency",reduceIndex(e){return e.length}},xq={label:"Distinct",reduceIndex(e,t){const i=new cm;for(const r of e)i.add(t[r]);return i.size}},Mq=Zl(Kc);function DS(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(i,r,o=1)=>i.length/o}:{scope:t,reduceIndex:(i,r,o=1)=>Kc(i,a=>r[a])/o}}const Sq={reduceIndex(e,t,{x:i}){return i}},Tq={reduceIndex(e,t,{y:i}){return i}},Y8={reduceIndex(e,t,{z:i}){return i}};function Wp(e,{scale:t,type:i,value:r,filter:o,hint:a,label:h=ph(r)},u){return a===void 0&&typeof(r==null?void 0:r.transform)=="function"&&(a=r.hint),q8(u,{scale:t,type:i,value:Xr(e,r),label:h,filter:o,hint:a})}function Iq(e,t){return Object.fromEntries(Object.entries(e).map(([i,r])=>[i,Wp(t,r,i)]))}function Bq(e,t){const i=Object.fromEntries(Object.entries(e).map(([r,{scale:o,value:a}])=>{const h=o==null?null:t[o];return[r,h==null?a:Os(a,h)]}));return i.channels=e,i}function q8(e,t){const{scale:i,value:r}=t;if(i===!0||i==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=i!==!0&&ky(r,H1)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=i!==!0&&ky(r,eq)?null:"opacity";break;case"symbol":i!==!0&&ky(r,cq)?(t.scale=null,t.value=Os(r,HE)):t.scale="symbol";break;default:t.scale=us.has(e)?e:null;break}else if(i===!1)t.scale=null;else if(i!=null&&!us.has(i))throw new Error(`unknown scale: ${i}`);return t}function Rq(e,t,i,r,o){const{order:a,reverse:h,reduce:u=!0,limit:p}=o;for(const c in o){if(!us.has(c))continue;let{value:f,order:g=a,reverse:m=h,reduce:v=u,limit:A=p}=Im(o[c]);const y=f==null?void 0:f.startsWith("-");if(y&&(f=f.slice(1)),g=g===void 0?y!==(f==="width"||f==="height")?Z8:J8:Dq(g),v==null||v===!1)continue;const C=c==="fx"||c==="fy"?Pq(t,r[c]):Lq(i,c);if(!C)throw new Error(`missing channel for scale: ${c}`);const E=C.value,[x=0,M=1/0]=su(A)?A:A<0?[A]:[0,A];if(f==null)C.domain=()=>{let w=Array.from(new cm(E));return m&&(w=w.reverse()),(x!==0||M!==1/0)&&(w=w.slice(x,M)),w};else{const w=f==="data"?e:f==="height"?NS(i,"y1","y2"):f==="width"?NS(i,"x1","x2"):a_(i,f,f==="y"?"y2":f==="x"?"x2":void 0),S=W1(v===!0?"max":v,w);C.domain=()=>{let I=JU(gc(E),L=>S.reduceIndex(L,w),L=>E[L]);return g&&I.sort(g),m&&I.reverse(),(x!==0||M!==1/0)&&(I=I.slice(x,M)),I.map(B8)}}}}function Lq(e,t){for(const i in e){const r=e[i];if(r.scale===t)return r}}function Pq(e,t){const i=e.original;if(i===e)return t;const r=t.value,o=t.value=[];for(let a=0;a<i.length;++a){const h=r[i[a][0]];for(const u of e[a])o[u]=h}return t}function NS(e,t,i){const r=a_(e,t),o=a_(e,i);return Os(o,(a,h)=>Math.abs(a-r[h]),Float64Array)}function a_(e,t,i){let r=e[t];if(!r&&i!==void 0&&(r=e[i]),r)return r.value;throw new Error(`missing channel: ${t}`)}function Dq(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return J8;case"descending":return Z8}throw new Error(`invalid order: ${e}`)}function J8([e,t],[i,r]){return Ia(t,r)||Ia(e,i)}function Z8([e,t],[i,r]){return Wg(t,r)||Ia(e,i)}function OS(e,t){let i=e[t];if(i){for(;i.source;)i=i.source;return i.source===null?null:i}}function KE(e={}){const{document:t=typeof window<"u"?window.document:void 0,clip:i}=e;return{document:t,clip:U8(i)}}function ys(e,{document:t}){return gp(A1(e).call(t.documentElement))}let l_=0,c_;function Nq(){const e=l_;return l_=0,c_=void 0,e}function Xc(e){e!==c_&&(c_=e,console.warn(e),++l_)}const e7=Math.PI,Yl=2*e7,FS=.618;function Oq({projection:e,inset:t=0,insetTop:i=t,insetRight:r=t,insetBottom:o=t,insetLeft:a=t}={},h){if(e==null)return;if(typeof e.stream=="function")return e;let u,p,c="frame";if(Tl(e)){let S;if({type:e,domain:p,inset:S,insetTop:i=S!==void 0?S:i,insetRight:r=S!==void 0?S:r,insetBottom:o=S!==void 0?S:o,insetLeft:a=S!==void 0?S:a,clip:c=c,...u}=e,e==null)return}typeof e!="function"&&({type:e}=t7(e));const{width:f,height:g,marginLeft:m,marginRight:v,marginTop:A,marginBottom:y}=h,C=f-m-v-a-r,E=g-A-y-i-o;if(e=e==null?void 0:e({width:C,height:E,clip:c,...u}),e==null)return;c=Fq(c,m,A,f-v,g-y);let x=m+a,M=A+i,w;if(p!=null){const[[S,I],[L,R]]=E1(e).bounds(p),k=Math.min(C/(L-S),E/(R-I));k>0?(x-=(k*(S+L)-C)/2,M-=(k*(I+R)-E)/2,w=Q2({point(P,F){this.stream.point(P*k+x,F*k+M)}})):Xc("Warning: the projection could not be fit to the specified domain; using the default scale.")}return w??(w=x===0&&M===0?n7():Q2({point(S,I){this.stream.point(S+x,I+M)}})),{stream:S=>e.stream(w.stream(c(S)))}}function t7(e){switch(`${e}`.toLowerCase()){case"albers-usa":return Va(Gz,.7463,.4673);case"albers":return OA(n5,.7463,.4673);case"azimuthal-equal-area":return Va(Vz,4,4);case"azimuthal-equidistant":return Va(Qz,Yl,Yl);case"conic-conformal":return OA(jz,Yl,Yl);case"conic-equal-area":return OA(Bg,6.1702,2.9781);case"conic-equidistant":return OA(Xz,7.312,3.6282);case"equal-earth":return Va(Yz,5.4133,2.6347);case"equirectangular":return Va(Wz,Yl,e7);case"gnomonic":return Va(qz,3.4641,3.4641);case"identity":return{type:n7};case"reflect-y":return{type:kq};case"mercator":return Va(Hz,Yl,Yl);case"orthographic":return Va(Jz,2,2);case"stereographic":return Va(Zz,2,2);case"transverse-mercator":return Va(ej,Yl,Yl);default:throw new Error(`unknown projection type: ${e}`)}}function Fq(e,t,i,r,o){if(e===!1||e==null||typeof e=="number")return a=>a;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return GB(t,i,r,o);default:throw new Error(`unknown projection clip type: ${e}`)}}function Va(e,t,i){return{type:({width:r,height:o,rotate:a,precision:h=.15,clip:u})=>{var c,f,g;const p=e();return h!=null&&((c=p.precision)==null||c.call(p,h)),a!=null&&((f=p.rotate)==null||f.call(p,a)),typeof u=="number"&&((g=p.clipAngle)==null||g.call(p,u)),p.scale(Math.min(r/t,o/i)),p.translate([r/2,o/2]),p},aspectRatio:i/t}}function OA(e,t,i){const{type:r,aspectRatio:o}=Va(e,t,i);return{type:a=>{const{parallels:h,domain:u,width:p,height:c}=a,f=r(a);return h!=null&&(f.parallels(h),u===void 0&&f.fitSize([p,c],{type:"Sphere"})),f},aspectRatio:o}}const n7=Tm({stream:e=>e}),kq=Tm(Q2({point(e,t){this.stream.point(e,-t)}}));function Uq(e,t,i,r){const o=i[e],a=i[t],h=o.length,u=i[e]=new Float64Array(h).fill(NaN),p=i[t]=new Float64Array(h).fill(NaN);let c;const f=r.stream({point(g,m){u[c]=g,p[c]=m}});for(c=0;c<h;++c)f.point(o[c],a[c])}function Gq({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(Tl(e)&&(e=e.type),e!=null)}function Vq(e){if(typeof(e==null?void 0:e.stream)=="function")return FS;if(Tl(e)&&(e=e.type),e!=null){if(typeof e!="function"){const{aspectRatio:t}=t7(e);if(t)return t}return FS}}function Qq(e){const t=[],i=[],r={scale:"x",value:t},o={scale:"y",value:i},a={point(h,u){t.push(h),i.push(u)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const h of e.value)Gu(h,a);return[r,o]}const i7=new Map([["accent",s$],["category10",r$],["dark2",o$],["observable10",Vp],["paired",a$],["pastel1",l$],["pastel2",c$],["set1",u$],["set2",h$],["set3",f$],["tableau10",d$]]);function Hq(e){return e!=null&&i7.has(`${e}`.toLowerCase())}const kS=new Map([...i7,["brbg",ql(W5,$5)],["prgn",ql(X5,K5)],["piyg",ql(Y5,q5)],["puor",ql(J5,Z5)],["rdbu",ql(X2,Ng)],["rdgy",ql(eR,tR)],["rdylbu",ql(K2,Og)],["rdylgn",ql(nR,iR)],["spectral",ql(rR,sR)],["burd",US(X2,Ng)],["buylrd",US(K2,Og)],["blues",zs(BR,RR)],["greens",zs(LR,PR)],["greys",zs(DR,NR)],["oranges",zs(GR,VR)],["purples",zs(OR,FR)],["reds",zs(kR,UR)],["turbo",Jl(XR)],["viridis",Jl(uE)],["magma",Jl(KR)],["inferno",Jl(YR)],["plasma",Jl(qR)],["cividis",Jl(QR)],["cubehelix",Jl(HR)],["warm",Jl(zR)],["cool",Jl(jR)],["bugn",zs(oR,aR)],["bupu",zs(lR,cR)],["gnbu",zs(uR,hR)],["orrd",zs(fR,dR)],["pubu",zs(AR,gR)],["pubugn",zs(pR,mR)],["purd",zs(vR,bR)],["rdpu",zs(yR,_R)],["ylgn",zs(CR,xR)],["ylgnbu",zs(ER,wR)],["ylorbr",zs(MR,SR)],["ylorrd",zs(TR,IR)],["rainbow",GS(WR)],["sinebow",GS($R)]]);function zs(e,t){return({length:i})=>i===1?[e[3][1]]:i===2?[e[3][1],e[3][2]]:(i=Math.max(3,Math.floor(i)),i>9?Ka(t,i):e[i])}function ql(e,t){return({length:i})=>i===2?[e[3][0],e[3][2]]:(i=Math.max(3,Math.floor(i)),i>11?Ka(t,i):e[i])}function US(e,t){return({length:i})=>i===2?[e[3][2],e[3][0]]:(i=Math.max(3,Math.floor(i)),i>11?Ka(r=>t(1-r),i):e[i].slice().reverse())}function Jl(e){return({length:t})=>Ka(e,Math.max(2,Math.floor(t)))}function GS(e){return({length:t})=>Ka(e,Math.floor(t)+1).slice(0,-1)}function r7(e){const t=`${e}`.toLowerCase();if(!kS.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return kS.get(t)}function $1(e,t){const i=r7(e),r=typeof i=="function"?i({length:t}):i;return r.length!==t?r.slice(0,t):r}function zq(e,t="greys"){const i=new Set,[r,o]=$1(t,2);for(const a of e)if(a!=null)if(a===!0)i.add(o);else if(a===!1)i.add(r);else return;return[...i]}const VS=new Map([["brbg",$5],["prgn",K5],["piyg",q5],["puor",Z5],["rdbu",Ng],["rdgy",tR],["rdylbu",Og],["rdylgn",iR],["spectral",sR],["burd",e=>Ng(1-e)],["buylrd",e=>Og(1-e)],["blues",RR],["greens",PR],["greys",NR],["purples",FR],["reds",UR],["oranges",VR],["turbo",XR],["viridis",uE],["magma",KR],["inferno",YR],["plasma",qR],["cividis",QR],["cubehelix",HR],["warm",zR],["cool",jR],["bugn",aR],["bupu",cR],["gnbu",hR],["orrd",dR],["pubugn",mR],["pubu",gR],["purd",bR],["rdpu",_R],["ylgnbu",wR],["ylgn",xR],["ylorbr",SR],["ylorrd",IR],["rainbow",WR],["sinebow",$R]]);function YE(e){const t=`${e}`.toLowerCase();if(!VS.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return VS.get(t)}const jq=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function Wq(e){return e!=null&&jq.has(`${e}`.toLowerCase())}const s7=e=>t=>e(1-t),Vy=[0,1],QS=new Map([["number",uo],["rgb",th],["hsl",NQ],["hcl",kQ],["lab",OQ]]);function o7(e){const t=`${e}`.toLowerCase();if(!QS.has(t))throw new Error(`unknown interpolator: ${t}`);return QS.get(t)}function Pm(e,t,i,{type:r,nice:o,clamp:a,zero:h,domain:u=l7(e,i),unknown:p,round:c,scheme:f,interval:g,range:m=us.get(e)===Bm?iJ(i,u):us.get(e)===Rm?rJ(i,u):us.get(e)===Lm?Vy:void 0,interpolate:v=us.get(e)===vc?f==null&&m!==void 0?th:YE(f!==void 0?f:r==="cyclical"?"rainbow":"turbo"):c?Y_:uo,reverse:A}){if(g=rd(g,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof v!="function"&&(v=o7(v)),A=!!A,m!==void 0){const y=(u=la(u)).length,C=(m=la(m)).length;if(y!==C){if(v.length===1)throw new Error("invalid piecewise interpolator");v=b1(v,m),m=void 0}}if(v.length===1?(A&&(v=s7(v),A=!1),m===void 0&&(m=Float64Array.from(u,(y,C)=>C/(u.length-1)),m.length===2&&(m=Vy)),t.interpolate((m===Vy?Tm:JE)(v))):t.interpolate(v),h){const[y,C]=Ms(u);(y>0||C<0)&&(u=zp(u),Vf(u)!==Math.sign(y)?u[u.length-1]=0:u[0]=0)}return A&&(u=dg(u)),t.domain(u).unknown(p),o&&(t.nice($q(o,r)),u=t.domain()),m!==void 0&&t.range(m),a&&t.clamp(a),{type:r,domain:u,range:m,scale:t,interpolate:v,interval:g}}function $q(e,t){return e===!0?void 0:typeof e=="number"?e:$Y(e,t)}function Xq(e,t,i){return Pm(e,T1(),t,i)}function Kq(e,t,i){return a7(e,t,{...i,exponent:.5})}function a7(e,t,{exponent:i=1,...r}){return Pm(e,x5().exponent(i),t,{...r,type:"pow"})}function Yq(e,t,{base:i=10,domain:r=sJ(t),...o}){return Pm(e,_5().base(i),t,{...o,domain:r})}function qq(e,t,{constant:i=1,...r}){return Pm(e,w5().constant(i),t,r)}function Jq(e,t,{range:i,quantiles:r=i===void 0?5:(i=[...i]).length,n:o=r,scheme:a="rdylbu",domain:h=oJ(t),unknown:u,interpolate:p,reverse:c}){return i===void 0&&(i=p!==void 0?Ka(p,o):us.get(e)===vc?$1(a,o):void 0),h.length>0&&(h=M5(h,i===void 0?{length:o}:i).quantiles()),qE(e,t,{domain:h,range:i,reverse:c,unknown:u})}function Zq(e,t,{range:i,n:r=i===void 0?5:(i=[...i]).length,scheme:o="rdylbu",domain:a=l7(e,t),unknown:h,interpolate:u,reverse:p}){const[c,f]=Ms(a);let g;return i===void 0?(g=Mf(c,f,r),g[0]<=c&&g.splice(0,1),g[g.length-1]>=f&&g.pop(),r=g.length+1,i=u!==void 0?Ka(u,r):us.get(e)===vc?$1(o,r):void 0):(g=Ka(uo(c,f),r+1).slice(1,-1),c instanceof Date&&(g=g.map(m=>new Date(m)))),Vf(la(a))<0&&g.reverse(),qE(e,t,{domain:g,range:i,reverse:p,unknown:h})}function qE(e,t,{domain:i=[0],unknown:r,scheme:o="rdylbu",interpolate:a,range:h=a!==void 0?Ka(a,i.length+1):us.get(e)===vc?$1(o,i.length+1):void 0,reverse:u}){i=la(i);const p=Vf(i);if(!isNaN(p)&&!eJ(i,p))throw new Error(`the ${e} scale has a non-monotonic domain`);return u&&(h=dg(h)),{type:"threshold",scale:S5(p<0?dg(i):i,h===void 0?[]:h).unknown(r),domain:i,range:h}}function eJ(e,t){for(let i=1,r=e.length,o=e[0];i<r;++i){const a=am(o,o=e[i]);if(a!==0&&a!==t)return!1}return!0}function tJ(e){return{type:"identity",scale:sq(us.get(e))?v5():t=>t}}function $p(e,t=E8){return e.length?[So(e,({value:i})=>i===void 0?i:So(i,t)),Zr(e,({value:i})=>i===void 0?i:Zr(i,t))]:[0,1]}function l7(e,t){const i=us.get(e);return(i===Bm||i===Lm||i===Rm?nJ:$p)(t)}function nJ(e){return[0,e.length?Zr(e,({value:t})=>t===void 0?t:Zr(t,E8)):1]}function iJ(e,t){const i=e.find(({radius:h})=>h!==void 0);if(i!==void 0)return[0,i.radius];const r=Sf(e,.5,({value:h})=>h===void 0?NaN:Sf(h,.25,G1)),o=t.map(h=>3*Math.sqrt(h/r)),a=30/Zr(o);return a<1?o.map(h=>h*a):o}function rJ(e,t){const i=Lp(e,({value:a})=>a===void 0?NaN:Lp(a,Math.abs)),r=t.map(a=>12*a/i),o=60/Zr(r);return o<1?r.map(a=>a*o):r}function sJ(e){for(const{value:t}of e)if(t!==void 0)for(let i of t){if(i>0)return $p(e,G1);if(i<0)return $p(e,RE)}return[1,10]}function oJ(e){const t=[];for(const{value:i}of e)if(i!==void 0)for(const r of i)t.push(r);return t}function JE(e){return(t,i)=>r=>e(t+r*(i-t))}function X1(e,t,i,r,{type:o,nice:a,clamp:h,domain:u=$p(r),unknown:p,pivot:c=0,scheme:f,range:g,symmetric:m=!0,interpolate:v=us.get(e)===vc?f==null&&g!==void 0?th:YE(f!==void 0?f:"rdbu"):uo,reverse:A}){c=+c,u=la(u);let[y,C]=u;if(u.length>2&&Xc(`Warning: the diverging ${e} scale domain contains extra elements.`),am(y,C)<0&&([y,C]=[C,y],A=!A),y=Math.min(y,c),C=Math.max(C,c),typeof v!="function"&&(v=o7(v)),g!==void 0&&(v=v.length===1?JE(v)(...g):b1(v,g)),A&&(v=s7(v)),m){const E=i.apply(c),x=E-i.apply(y),M=i.apply(C)-E;x<M?y=i.invert(E-M):x>M&&(C=i.invert(E+x))}return t.domain([y,c,C]).unknown(p).interpolator(v),h&&t.clamp(h),a&&t.nice(a),{type:o,domain:[y,C],pivot:c,interpolate:v,scale:t}}function aJ(e,t,i){return X1(e,Q5(),hJ,t,i)}function lJ(e,t,i){return c7(e,t,{...i,exponent:.5})}function c7(e,t,{exponent:i=1,...r}){return X1(e,j5().exponent(i=+i),pJ(i),t,{...r,type:"diverging-pow"})}function cJ(e,t,{base:i=10,pivot:r=1,domain:o=$p(t,r<0?RE:G1),...a}){return X1(e,H5().base(i=+i),fJ,t,{domain:o,pivot:r,...a})}function uJ(e,t,{constant:i=1,...r}){return X1(e,z5().constant(i=+i),mJ(i),t,r)}const hJ={apply(e){return e},invert(e){return e}},fJ={apply:Math.log,invert:Math.exp},dJ={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function pJ(e){return e===.5?dJ:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function mJ(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function u7(e,t,i,r){return Pm(e,t,i,r)}function AJ(e,t,i){return u7(e,n$(),t,i)}function gJ(e,t,i){return u7(e,i$(),t,i)}const Dm=Symbol("ordinal");function h7(e,t,i,{type:r,interval:o,domain:a,range:h,reverse:u,hint:p}){return o=rd(o,r),a===void 0&&(a=d7(i,o,e)),(r==="categorical"||r===Dm)&&(r="ordinal"),u&&(a=dg(a)),a=t.domain(a).domain(),h!==void 0&&(typeof h=="function"&&(h=h(a)),t.range(h)),{type:r,domain:a,range:h,scale:t,hint:p,interval:o}}function vJ(e,t,{type:i,interval:r,domain:o,range:a,scheme:h,unknown:u,...p}){r=rd(r,i),o===void 0&&(o=d7(t,r,e));let c;if(us.get(e)===j1)c=_J(t),a=a===void 0?EJ(c):Os(a,HE);else if(us.get(e)===vc&&(a===void 0&&(i==="ordinal"||i===Dm)&&(a=zq(o,h),a!==void 0&&(h=void 0)),h===void 0&&a===void 0&&(h=i==="ordinal"?"turbo":"observable10"),h!==void 0))if(a!==void 0){const f=YE(h),g=a[0],m=a[1]-a[0];a=({length:v})=>Ka(A=>f(g+m*A),v)}else a=r7(h);if(u===j2)throw new Error(`implicit unknown on ${e} scale is not supported`);return h7(e,oE().unknown(u),t,{...p,type:i,domain:o,range:a,hint:c})}function bJ(e,t,{align:i=.5,padding:r=.5,...o}){return f7(Fj().align(i).padding(r),t,o,e)}function yJ(e,t,{align:i=.5,padding:r=.1,paddingInner:o=r,paddingOuter:a=e==="fx"||e==="fy"?0:r,...h}){return f7(M1().align(i).paddingInner(o).paddingOuter(a),t,h,e)}function f7(e,t,i,r){let{round:o}=i;return o!==void 0&&e.round(o=!!o),e=h7(r,e,t,i),e.round=o,e}function d7(e,t,i){const r=new cm;for(const{value:o,domain:a}of e){if(a!==void 0)return a();if(o!==void 0)for(const h of o)r.add(h)}if(t!==void 0){const[o,a]=Ms(r).map(t.floor,t);return t.range(o,t.offset(a))}if(r.size>1e4&&us.get(i)===bl)throw new Error(`implicit ordinal domain of ${i} scale has more than 10,000 values`);return ug(r,Ia)}function HS(e,t){let i;for(const{hint:r}of e){const o=r==null?void 0:r[t];if(o!==void 0){if(i===void 0)i=o;else if(i!==o)return}}return i}function _J(e){return{fill:HS(e,"fill"),stroke:HS(e,"stroke")}}function EJ(e){return ho(e.fill)?S$:M$}function u_(e,{label:t,inset:i=0,insetTop:r=i,insetRight:o=i,insetBottom:a=i,insetLeft:h=i,round:u,nice:p,clamp:c,zero:f,align:g,padding:m,projection:v,facet:{label:A=t}={},...y}={}){const C={};for(const[E,x]of e){const M=y[E],w=SJ(E,x,{round:us.get(E)===bl?u:void 0,nice:p,clamp:c,zero:f,align:g,padding:m,projection:v,...M});if(w){let{label:S=E==="fx"||E==="fy"?A:t,percent:I,transform:L,inset:R,insetTop:k=R!==void 0?R:E==="y"?r:0,insetRight:P=R!==void 0?R:E==="x"?o:0,insetBottom:F=R!==void 0?R:E==="y"?a:0,insetLeft:O=R!==void 0?R:E==="x"?h:0}=M||{};if(L==null)L=void 0;else if(typeof L!="function")throw new Error("invalid scale transform; not a function");w.percent=!!I,w.label=S===void 0?CJ(x,w):S,w.transform=L,E==="x"||E==="fx"?(w.insetLeft=+O,w.insetRight=+P):(E==="y"||E==="fy")&&(w.insetTop=+k,w.insetBottom=+F),C[E]=w}}return C}function zS(e){const t={},i={scales:t};for(const[r,o]of Object.entries(e)){const{scale:a,type:h,interval:u,label:p}=o;t[r]=LJ(o),i[r]=a,a.type=h,u!=null&&(a.interval=u),p!=null&&(a.label=p)}return i}function wJ(e,t){const{x:i,y:r,fx:o,fy:a}=e,h=o||a?ZE(t):t;o&&jS(o,h),a&&WS(a,h);const u=o||a?p7(e,t):t;i&&jS(i,u),r&&WS(r,u)}function CJ(e=[],t){let i;for(const{label:r}of e)if(r!==void 0){if(i===void 0)i=r;else if(i!==r)return}if(i!==void 0)return!Ah(t)&&t.percent&&(i=`${i} (%)`),{inferred:!0,toString:()=>i}}function xJ(e){return Math.sign(Vf(e.domain()))*Math.sign(Vf(e.range()))}function ZE(e){const{marginTop:t,marginRight:i,marginBottom:r,marginLeft:o,width:a,height:h,facet:{marginTop:u,marginRight:p,marginBottom:c,marginLeft:f}}=e;return{marginTop:Math.max(t,u),marginRight:Math.max(i,p),marginBottom:Math.max(r,c),marginLeft:Math.max(o,f),width:a,height:h}}function p7({fx:e,fy:t},i){const{marginTop:r,marginRight:o,marginBottom:a,marginLeft:h,width:u,height:p}=ZE(i);return{marginTop:r,marginRight:o,marginBottom:a,marginLeft:h,width:e?e.scale.bandwidth()+h+o:u,height:t?t.scale.bandwidth()+r+a:p,facet:{width:u,height:p}}}function jS(e,t){if(e.range===void 0){const{insetLeft:i,insetRight:r}=e,{width:o,marginLeft:a=0,marginRight:h=0}=t,u=a+i,p=o-h-r;e.range=[u,Math.max(u,p)],Ah(e)||(e.range=A7(e)),e.scale.range(e.range)}m7(e)}function WS(e,t){if(e.range===void 0){const{insetTop:i,insetBottom:r}=e,{height:o,marginTop:a=0,marginBottom:h=0}=t,u=a+i,p=o-h-r;e.range=[Math.max(u,p),u],Ah(e)?e.range.reverse():e.range=A7(e),e.scale.range(e.range)}m7(e)}function m7(e){e.round===void 0&&IJ(e)&&MJ(e)<=30&&e.scale.round(!0)}function MJ({scale:e}){const t=e.domain().length,[i,r]=e.range(),o=e.paddingInner?e.paddingInner():1,a=e.paddingOuter?e.paddingOuter():e.padding(),h=t-o,u=Math.abs(r-i)/Math.max(1,h+a*2);return(u-Math.floor(u))*h}function A7(e){const t=e.scale.domain().length+g7(e);if(!(t>2))return e.range;const[i,r]=e.range;return Array.from({length:t},(o,a)=>i+a/(t-1)*(r-i))}function SJ(e,t=[],i={}){const r=TJ(e,t,i);if(i.type===void 0&&i.domain===void 0&&i.range===void 0&&i.interval==null&&e!=="fx"&&e!=="fy"&&Ah({type:r})){const o=t.map(({value:a})=>a).filter(a=>a!==void 0);o.some(Ho)?Xc(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${rf(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${rf(r)}".`):o.some(YY)?Xc(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${rf(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${rf(r)}".`):o.some(qY)&&Xc(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${rf(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${rf(r)}".`)}switch(i.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":i=FA(t,i,vl);break;case"identity":switch(us.get(e)){case bl:i=FA(t,i,vl);break;case j1:i=FA(t,i,BJ);break}break;case"utc":case"time":i=FA(t,i,zY);break}switch(r){case"diverging":return aJ(e,t,i);case"diverging-sqrt":return lJ(e,t,i);case"diverging-pow":return c7(e,t,i);case"diverging-log":return cJ(e,t,i);case"diverging-symlog":return uJ(e,t,i);case"categorical":case"ordinal":case Dm:return vJ(e,t,i);case"cyclical":case"sequential":case"linear":return Xq(e,t,i);case"sqrt":return Kq(e,t,i);case"threshold":return qE(e,t,i);case"quantile":return Jq(e,t,i);case"quantize":return Zq(e,t,i);case"pow":return a7(e,t,i);case"log":return Yq(e,t,i);case"symlog":return qq(e,t,i);case"utc":return gJ(e,t,i);case"time":return AJ(e,t,i);case"point":return bJ(e,t,i);case"band":return yJ(e,t,i);case"identity":return tJ(e);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function rf(e){return typeof e=="symbol"?e.description:e}function $S(e){return typeof e=="string"?`${e}`.toLowerCase():e}const XS={toString:()=>"projection"};function TJ(e,t,{type:i,domain:r,range:o,scheme:a,pivot:h,projection:u}){if(i=$S(i),e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&u!=null&&(i=XS);for(const c of t){const f=$S(c.type);if(f!==void 0){if(i===void 0)i=f;else if(i!==f)throw new Error(`scale incompatible with channel: ${i} !== ${f}`)}}if(i===XS)return;if(i!==void 0)return i;if(r===void 0&&!t.some(({value:c})=>c!==void 0))return;const p=us.get(e);if(p===Bm)return"sqrt";if(p===Lm||p===Rm)return"linear";if(p===j1)return"ordinal";if((r||o||[]).length>2)return Qy(p);if(r!==void 0){if(LS(r))return Qy(p);if(Ho(r))return"utc"}else{const c=t.map(({value:f})=>f).filter(f=>f!==void 0);if(c.some(LS))return Qy(p);if(c.some(Ho))return"utc"}if(p===vc){if(h!=null||Wq(a))return"diverging";if(Hq(a))return"categorical"}return"linear"}function Qy(e){switch(e){case bl:return"point";case vc:return Dm;default:return"ordinal"}}function Ah({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===Dm}function g7({type:e}){return e==="threshold"}function IJ({type:e}){return e==="point"||e==="band"}function Ma(e){if(e===void 0)return!0;const t=e.domain(),i=e(t[0]);for(let r=1,o=t.length;r<o;++r)if(e(t[r])-i)return!1;return!0}function FA(e,{domain:t,...i},r){var o;for(const a of e)a.value!==void 0&&(t===void 0&&(t=(o=a.value)==null?void 0:o.domain),a.value=r(a.value));return{domain:t===void 0?t:r(t),...i}}function BJ(e){return Os(e,HE)}function RJ(e){return t=>{if(!us.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return e[t]}}function LJ({scale:e,type:t,domain:i,range:r,interpolate:o,interval:a,transform:h,percent:u,pivot:p}){if(t==="identity")return{type:"identity",apply:f=>f,invert:f=>f};const c=e.unknown?e.unknown():void 0;return{type:t,domain:zp(i),...r!==void 0&&{range:zp(r)},...h!==void 0&&{transform:h},...u&&{percent:u},...c!==void 0&&{unknown:c},...a!==void 0&&{interval:a},...o!==void 0&&{interpolate:o},...e.clamp&&{clamp:e.clamp()},...p!==void 0&&{pivot:p,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:f=>e(f),...e.invert&&{invert:f=>e.invert(f)}}}function PJ(e){let t,i;return(...r)=>(((i==null?void 0:i.length)!==r.length||i.some((o,a)=>o!==r[a]))&&(i=r,t=e(...r)),t)}const DJ=PJ(e=>new Intl.NumberFormat(e));function NJ(e="en-US"){const t=DJ(e);return i=>i!=null&&!isNaN(i)?t.format(i):void 0}function OJ(e){return LY(e,"Invalid Date")}function FJ(e="en-US"){const t=NJ(e);return i=>(i instanceof Date?OJ:typeof i=="number"?t:xo)(i)}const oh=FJ(),Go=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let kJ=0;function KS(){return`plot-clip-${++kJ}`}function UJ(e,{title:t,href:i,ariaLabel:r,ariaDescription:o,ariaHidden:a,target:h,fill:u,fillOpacity:p,stroke:c,strokeWidth:f,strokeOpacity:g,strokeLinejoin:m,strokeLinecap:v,strokeMiterlimit:A,strokeDasharray:y,strokeDashoffset:C,opacity:E,mixBlendMode:x,imageFilter:M,paintOrder:w,pointerEvents:S,shapeRendering:I,channels:L},{ariaLabel:R,fill:k="currentColor",fillOpacity:P,stroke:F="none",strokeOpacity:O,strokeWidth:W,strokeLinecap:V,strokeLinejoin:$,strokeMiterlimit:H,paintOrder:Y}){k===null&&(u=null,p=null),F===null&&(c=null,g=null),ho(k)?!ho(F)&&(!ho(u)||L!=null&&L.fill)&&(F="none"):ho(F)&&(!ho(c)||L!=null&&L.stroke)&&(k="none");const[Q,G]=Za(u,k),[J,K]=Mo(p,P),[se,ue]=Za(c,F),[he,Me]=Mo(g,O),[de,Pe]=Mo(E);jp(ue)||(f===void 0&&(f=W),v===void 0&&(v=V),m===void 0&&(m=$),A===void 0&&!tq(m)&&(A=H),!jp(G)&&w===void 0&&(w=Y));const[Se,Le]=Mo(f);return k!==null&&(e.fill=Ns(G,"currentColor"),e.fillOpacity=ep(K,1)),F!==null&&(e.stroke=Ns(ue,"none"),e.strokeWidth=ep(Le,1),e.strokeOpacity=ep(Me,1),e.strokeLinejoin=Ns(m,"miter"),e.strokeLinecap=Ns(v,"butt"),e.strokeMiterlimit=ep(A,4),e.strokeDasharray=Ns(y,"none"),e.strokeDashoffset=Ns(C,"0")),e.target=xo(h),e.ariaLabel=xo(R),e.ariaDescription=xo(o),e.ariaHidden=xo(a),e.opacity=ep(Pe,1),e.mixBlendMode=Ns(x,"normal"),e.imageFilter=Ns(M,"none"),e.paintOrder=Ns(w,"normal"),e.pointerEvents=Ns(S,"auto"),e.shapeRendering=Ns(I,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:i,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:Q,scale:"auto",optional:!0},fillOpacity:{value:J,scale:"auto",optional:!0},stroke:{value:se,scale:"auto",optional:!0},strokeOpacity:{value:he,scale:"auto",optional:!0},strokeWidth:{value:Se,optional:!0},opacity:{value:de,scale:"auto",optional:!0}}}function GJ(e,t){t&&e.filter(i=>BE(t[i])).append("title").call(QJ,t)}function VJ(e,t){t&&e.filter(([i])=>BE(t[i])).append("title").call(HJ,t)}function QJ(e,t){t&&e.text(i=>oh(t[i]))}function HJ(e,t){t&&e.text(([i])=>oh(t[i]))}function Il(e,{target:t,tip:i},{ariaLabel:r,title:o,fill:a,fillOpacity:h,stroke:u,strokeOpacity:p,strokeWidth:c,opacity:f,href:g}){r&&Mi(e,"aria-label",m=>r[m]),a&&Mi(e,"fill",m=>a[m]),h&&Mi(e,"fill-opacity",m=>h[m]),u&&Mi(e,"stroke",m=>u[m]),p&&Mi(e,"stroke-opacity",m=>p[m]),c&&Mi(e,"stroke-width",m=>c[m]),f&&Mi(e,"opacity",m=>f[m]),g&&y7(e,m=>g[m],t),i||GJ(e,o)}function v7(e,{target:t,tip:i},{ariaLabel:r,title:o,fill:a,fillOpacity:h,stroke:u,strokeOpacity:p,strokeWidth:c,opacity:f,href:g}){r&&Mi(e,"aria-label",([m])=>r[m]),a&&Mi(e,"fill",([m])=>a[m]),h&&Mi(e,"fill-opacity",([m])=>h[m]),u&&Mi(e,"stroke",([m])=>u[m]),p&&Mi(e,"stroke-opacity",([m])=>p[m]),c&&Mi(e,"stroke-width",([m])=>c[m]),f&&Mi(e,"opacity",([m])=>f[m]),g&&y7(e,([m])=>g[m],t),i||VJ(e,o)}function zJ({ariaLabel:e,title:t,fill:i,fillOpacity:r,stroke:o,strokeOpacity:a,strokeWidth:h,opacity:u,href:p},{tip:c}){return[e,c?void 0:t,i,r,o,a,h,u,p].filter(f=>f!==void 0)}function jJ(e,t,i){const r=d1(e,o=>t[o]);return i===void 0&&r.size>1+e.length>>1&&Xc("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*b7(e,t,i,r){const{z:o}=i,{z:a}=r,h=zJ(r,i),u=[...t,...h];for(const p of a?jJ(e,a,o):[e]){let c,f;e:for(const g of p){for(const m of u)if(!tu(m[g])){f&&f.push(-1);continue e}if(c===void 0){f&&(yield f),c=h.map(m=>Hu(m[g])),f=[g];continue}f.push(g);for(let m=0;m<h.length;++m)if(Hu(h[m][g])!==c[m]){yield f,c=h.map(A=>Hu(A[g])),f=[g];continue e}}f&&(yield f)}}function WJ(e,t,i,r){let o;const{clip:a=r.clip}=t;switch(a){case"frame":{const{width:h,height:u,marginLeft:p,marginRight:c,marginTop:f,marginBottom:g}=i,m=KS();o=`url(#${m})`,e=ys("svg:g",r).call(v=>v.append("svg:clipPath").attr("id",m).append("rect").attr("x",p).attr("y",f).attr("width",h-c-p).attr("height",u-f-g)).each(function(){this.appendChild(e.node()),e.node=()=>this});break}case"sphere":{const{projection:h}=r;if(!h)throw new Error('the "sphere" clip option requires a projection');const u=KS();o=`url(#${u})`,e.append("clipPath").attr("id",u).append("path").attr("d",E1(h)({type:"Sphere"}));break}}Mi(e,"aria-label",t.ariaLabel),Mi(e,"aria-description",t.ariaDescription),Mi(e,"aria-hidden",t.ariaHidden),Mi(e,"clip-path",o)}function ca(e,t,i,r){WJ(e,t,i,r),Mi(e,"fill",t.fill),Mi(e,"fill-opacity",t.fillOpacity),Mi(e,"stroke",t.stroke),Mi(e,"stroke-width",t.strokeWidth),Mi(e,"stroke-opacity",t.strokeOpacity),Mi(e,"stroke-linejoin",t.strokeLinejoin),Mi(e,"stroke-linecap",t.strokeLinecap),Mi(e,"stroke-miterlimit",t.strokeMiterlimit),Mi(e,"stroke-dasharray",t.strokeDasharray),Mi(e,"stroke-dashoffset",t.strokeDashoffset),Mi(e,"shape-rendering",t.shapeRendering),Mi(e,"filter",t.imageFilter),Mi(e,"paint-order",t.paintOrder);const{pointerEvents:o=r.pointerSticky===!1?"none":void 0}=t;Mi(e,"pointer-events",o)}function ua(e,t){$J(e,"mix-blend-mode",t.mixBlendMode),Mi(e,"opacity",t.opacity)}function y7(e,t,i){e.each(function(r){const o=t(r);if(o!=null){const a=this.ownerDocument.createElementNS(If.svg,"a");a.setAttribute("fill","inherit"),a.setAttributeNS(If.xlink,"href",o),i!=null&&a.setAttribute("target",i),this.parentNode.insertBefore(a,this).appendChild(this)}})}function Mi(e,t,i){i!=null&&e.attr(t,i)}function $J(e,t,i){i!=null&&e.style(t,i)}function Bo(e,t,{x:i,y:r},o=Go,a=Go){o+=t.dx,a+=t.dy,i!=null&&i.bandwidth&&(o+=i.bandwidth()/2),r!=null&&r.bandwidth&&(a+=r.bandwidth()/2),(o||a)&&e.attr("transform",`translate(${o},${a})`)}function Ns(e,t){if((e=xo(e))!==t)return e}function ep(e,t){if((e=Pr(e))!==t)return e}const XJ=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function ew(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!XJ.test(e))throw new Error(`invalid class name: ${e}`);return e}function tw(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const i of e)Object.assign(i.style,t)}function Nm({frameAnchor:e},{width:t,height:i,marginTop:r,marginRight:o,marginBottom:a,marginLeft:h}){return[/left$/.test(e)?h:/right$/.test(e)?t-o:(h+t-o)/2,/^top/.test(e)?r:/^bottom/.test(e)?i-a:(r+i-a)/2]}function KJ(e,t,i={}){let r=.5-Go,o=.5+Go,a=.5+Go,h=.5-Go;for(const{marginTop:y,marginRight:C,marginBottom:E,marginLeft:x}of t)y>r&&(r=y),C>o&&(o=C),E>a&&(a=E),x>h&&(h=x);let{margin:u,marginTop:p=u!==void 0?u:r,marginRight:c=u!==void 0?u:o,marginBottom:f=u!==void 0?u:a,marginLeft:g=u!==void 0?u:h}=i;p=+p,c=+c,f=+f,g=+g;let{width:m=640,height:v=YJ(e,i,{width:m,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:a,marginLeftDefault:h})+Math.max(0,p-r+f-a)}=i;m=+m,v=+v;const A={width:m,height:v,marginTop:p,marginRight:c,marginBottom:f,marginLeft:g};if(e.fx||e.fy){let{margin:y,marginTop:C=y!==void 0?y:p,marginRight:E=y!==void 0?y:c,marginBottom:x=y!==void 0?y:f,marginLeft:M=y!==void 0?y:g}=i.facet??{};C=+C,E=+E,x=+x,M=+M,A.facet={marginTop:C,marginRight:E,marginBottom:x,marginLeft:M}}return A}function YJ({x:e,y:t,fy:i,fx:r},{projection:o,aspectRatio:a},{width:h,marginTopDefault:u,marginRightDefault:p,marginBottomDefault:c,marginLeftDefault:f}){const g=i?i.scale.domain().length:1,m=Vq(o);if(m){const A=r?r.scale.domain().length:1,y=(1.1*g-.1)/(1.1*A-.1)*m,C=Math.max(.1,Math.min(10,y));return Math.round((h-f-p)*C+u+c)}const v=t?Ah(t)?t.scale.domain().length:Math.max(7,17/g):1;if(a!=null){if(a=+a,!(isFinite(a)&&a>0))throw new Error(`invalid aspectRatio: ${a}`);const A=YS("y",t)/(YS("x",e)*a),y=r?r.scale.bandwidth():1,C=i?i.scale.bandwidth():1,E=y*(h-f-p)-e.insetLeft-e.insetRight;return(A*E+t.insetTop+t.insetBottom)/C+u+c}return!!(t||i)*Math.max(1,Math.min(60,v*g))*20+!!r*30+60}function YS(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:i,domain:r}=t;let o;switch(i){case"linear":case"utc":case"time":o=Number;break;case"pow":{const u=t.scale.exponent();o=p=>Math.pow(p,u);break}case"log":o=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${i}`)}const[a,h]=Ms(r);return Math.abs(o(h)-o(a))}function qJ(e,t){const{fx:i,fy:r}=u_(e,t),o=i==null?void 0:i.scale.domain(),a=r==null?void 0:r.scale.domain();return o&&a?YU(o,a).map(([h,u],p)=>({x:h,y:u,i:p})):o?o.map((h,u)=>({x:h,i:u})):a?a.map((h,u)=>({y:h,i:u})):void 0}function JJ(e,{x:t,y:i}){return t&&(t=h_(t)),i&&(i=h_(i)),e.filter(t&&i?r=>t.has(r.x)&&i.has(r.y):t?r=>t.has(r.x):r=>i.has(r.y)).sort(t&&i?(r,o)=>t.get(r.x)-t.get(o.x)||i.get(r.y)-i.get(o.y):t?(r,o)=>t.get(r.x)-t.get(o.x):(r,o)=>i.get(r.y)-i.get(o.y))}function nw(e,{fx:t,fy:i}){const r=gc(e),o=t==null?void 0:t.value,a=i==null?void 0:i.value;return t&&i?mf(r,h=>(h.fx=o[h[0]],h.fy=a[h[0]],h),h=>o[h],h=>a[h]):t?mf(r,h=>(h.fx=o[h[0]],h),h=>o[h]):mf(r,h=>(h.fy=a[h[0]],h),h=>a[h])}function ZJ(e,t,{marginTop:i,marginLeft:r}){return e&&t?({x:o,y:a})=>`translate(${e(o)-r},${t(a)-i})`:e?({x:o})=>`translate(${e(o)-r},0)`:({y:o})=>`translate(0,${t(o)-i})`}function eZ(e){const t=[],i=new Uint32Array(Kc(e,r=>r.length));for(const r of e){let o=0;for(const a of e)r!==a&&(i.set(a,o),o+=a.length);t.push(i.slice(0,o))}return t}const tZ=new Map([["top",Hy],["right",Wy],["bottom",zy],["left",jy],["top-left",kA(Hy,jy)],["top-right",kA(Hy,Wy)],["bottom-left",kA(zy,jy)],["bottom-right",kA(zy,Wy)],["top-empty",rZ],["right-empty",aZ],["bottom-empty",sZ],["left-empty",oZ],["empty",lZ]]);function nZ(e){if(e==null)return null;const t=tZ.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const qS=new WeakMap;function h_(e){let t=qS.get(e);return t||qS.set(e,t=new Ju(Os(e,(i,r)=>[i,r]))),t}function ou(e,t){return h_(e).get(t)}function iZ(e,t,i){return t=Hu(t),i=Hu(i),e.find(r=>Object.is(Hu(r.x),t)&&Object.is(Hu(r.y),i))}function K1(e,t,i){var r;return(r=iZ(e,t,i))==null?void 0:r.empty}function Hy(e,{y:t},{y:i}){return t?ou(t,i)===0:!0}function zy(e,{y:t},{y:i}){return t?ou(t,i)===t.length-1:!0}function jy(e,{x:t},{x:i}){return t?ou(t,i)===0:!0}function Wy(e,{x:t},{x:i}){return t?ou(t,i)===t.length-1:!0}function rZ(e,{y:t},{x:i,y:r,empty:o}){if(o)return!1;if(!t)return;const a=ou(t,r);if(a>0)return K1(e,i,t[a-1])}function sZ(e,{y:t},{x:i,y:r,empty:o}){if(o)return!1;if(!t)return;const a=ou(t,r);if(a<t.length-1)return K1(e,i,t[a+1])}function oZ(e,{x:t},{x:i,y:r,empty:o}){if(o)return!1;if(!t)return;const a=ou(t,i);if(a>0)return K1(e,t[a-1],r)}function aZ(e,{x:t},{x:i,y:r,empty:o}){if(o)return!1;if(!t)return;const a=ou(t,i);if(a<t.length-1)return K1(e,t[a+1],r)}function lZ(e,t,{empty:i}){return i}function kA(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function $y(e,{channels:{fx:t,fy:i},groups:r}){return t&&i?e.map(({x:o,y:a})=>{var h;return((h=r.get(o))==null?void 0:h.get(a))??[]}):t?e.map(({x:o})=>r.get(o)??[]):e.map(({y:o})=>r.get(o)??[])}class mo{constructor(t,i={},r={},o){const{facet:a="auto",facetAnchor:h,fx:u,fy:p,sort:c,dx:f=0,dy:g=0,margin:m=0,marginTop:v=m,marginRight:A=m,marginBottom:y=m,marginLeft:C=m,clip:E=o==null?void 0:o.clip,channels:x,tip:M,render:w}=r;if(this.data=t,this.sort=Qf(c)?c:null,this.initializer=Hf(r).initializer,this.transform=this.initializer?r.transform:mh(r).transform,a===null||a===!1?this.facet=null:(this.facet=Pa(a===!0?"include":a,"facet",["auto","include","exclude","super"]),this.fx=t===tg&&typeof u=="string"?[u]:u,this.fy=t===tg&&typeof p=="string"?[p]:p),this.facetAnchor=nZ(h),i=k8(i),x!==void 0&&(i={...cZ(x),...i}),o!==void 0&&(i={...UJ(this,r,o),...i}),this.channels=Object.fromEntries(Object.entries(i).map(([S,I])=>{if(Q1(I.value)){const{value:L,label:R=I.label,scale:k=I.scale}=I.value;I={...I,label:R,scale:k,value:L}}if(t===tg&&typeof I.value=="string"){const{value:L}=I;I={...I,value:[L]}}return[S,I]}).filter(([S,{value:I,optional:L}])=>{if(I!=null)return!0;if(L)return!1;throw new Error(`missing channel value: ${S}`)})),this.dx=+f,this.dy=+g,this.marginTop=+v,this.marginRight=+A,this.marginBottom=+y,this.marginLeft=+C,this.clip=U8(E),this.tip=uZ(M),this.facet==="super"){if(u||p)throw new Error("super-faceting cannot use fx or fy");for(const S in this.channels){const{scale:I}=i[S];if(!(I!=="x"&&I!=="y"))throw new Error("super-faceting cannot use x or y")}}w!=null&&(this.render=_7(w,this.render))}initialize(t,i,r){let o=la(this.data);t===void 0&&o!=null&&(t=[gc(o)]);const a=t;this.transform!=null&&({facets:t,data:o}=this.transform(o,t,r),o=la(o)),t!==void 0&&(t.original=a);const h=Iq(this.channels,o);return this.sort!=null&&Rq(o,t,h,i,this.sort),{data:o,facets:t,channels:h}}filter(t,i,r){for(const o in i){const{filter:a=tu}=i[o];if(a!==null){const h=r[o];t=t.filter(u=>a(h[u]))}}return t}project(t,i,r){for(const o in t)if(t[o].scale==="x"&&/^x|x$/.test(o)){const a=o.replace(/^x|x$/,"y");a in t&&t[a].scale==="y"&&Uq(o,a,i,r.projection)}}scale(t,i,r){const o=Bq(t,i);return r.projection&&this.project(t,o,r),o}}function iw(...e){return e.plot=mo.prototype.plot,e}function _7(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(i,r,o,a,h,u){return e.call(this,i,r,o,a,h,(p,c,f,g,m)=>t.call(this,p,c,f,g,m,u))}}function cZ(e){return Object.fromEntries(Object.entries(k8(e)).map(([t,i])=>(i=typeof i=="string"?{value:i,label:t}:Im(i),i.filter===void 0&&i.scale==null&&(i={...i,filter:null}),[t,i])))}function uZ(e){return e===!0?"xy":e===!1||e==null?null:typeof e=="string"?Pa(e,"tip",["x","y","xy"]):e}function Om(e,t){return(e==null?void 0:e.tip)===!0?{...e,tip:t}:Tl(e==null?void 0:e.tip)&&e.tip.pointer===void 0?{...e,tip:{...e.tip,pointer:t}}:e}const JS=new WeakMap;function rw(e,t,{x:i,y:r,px:o,py:a,maxRadius:h=40,channels:u,render:p,...c}={}){return h=+h,o!=null&&(i??(i=null),u={...u,px:{value:o,scale:"x"}}),a!=null&&(r??(r=null),u={...u,py:{value:a,scale:"y"}}),{x:i,y:r,channels:u,...c,render:_7(function(f,g,m,v,A,y){A={...A,pointerSticky:!1};const C=A.ownerSVGElement,{data:E}=A.getMarkState(this);let x=JS.get(C);x||JS.set(C,x={sticky:!1,roots:[],renders:[]});let M=x.renders.push(ue)-1;const{x:w,y:S,fx:I,fy:L}=g;let R=I?I(f.fx)-v.marginLeft:0,k=L?L(f.fy)-v.marginTop:0;w!=null&&w.bandwidth&&(R+=w.bandwidth()/2),S!=null&&S.bandwidth&&(k+=S.bandwidth()/2);const P=f.fi!=null;let F;if(P){let Pe=x.facetStates;Pe||(x.facetStates=Pe=new Map),F=Pe.get(this),F||Pe.set(this,F=new Map)}const[O,W]=Nm(this,v),{px:V,py:$}=m,H=V?Pe=>V[Pe]:E7(m,O),Y=$?Pe=>$[Pe]:w7(m,W);let Q,G,J,K;function se(Pe,Se){if(P)if(K&&(K=cancelAnimationFrame(K)),Pe==null)F.delete(f.fi);else{F.set(f.fi,Se),K=requestAnimationFrame(()=>{K=null;for(const[Le,be]of F)if(be<Se||be===Se&&Le<f.fi){Pe=null;break}ue(Pe)});return}ue(Pe)}function ue(Pe){if(Q===Pe&&J===x.sticky)return;Q=Pe,J=A.pointerSticky=x.sticky;const Se=Q==null?[]:[Q];P&&(Se.fx=f.fx,Se.fy=f.fy,Se.fi=f.fi);const Le=y(Se,g,m,v,A);if(G){if(P){const be=G.parentNode,je=G.getAttribute("transform"),Te=Le.getAttribute("transform");je?Le.setAttribute("transform",je):Le.removeAttribute("transform"),Te?be.setAttribute("transform",Te):be.removeAttribute("transform"),Le.removeAttribute("aria-label"),Le.removeAttribute("aria-description"),Le.removeAttribute("aria-hidden")}G.replaceWith(Le)}return x.roots[M]=G=Le,Q==null&&(F==null?void 0:F.size)>1||A.dispatchValue(Q==null?null:E[Q]),Le}function he(Pe){if(x.sticky||Pe.pointerType==="mouse"&&Pe.buttons===1)return;let[Se,Le]=iQ(Pe);Se-=R,Le-=k;const be=Se<v.marginLeft||Se>v.width-v.marginRight?1:e,je=Le<v.marginTop||Le>v.height-v.marginBottom?1:t;let Te=null,rt=h*h;for(const mt of f){const vt=be*(H(mt)-Se),ft=je*(Y(mt)-Le),Ze=vt*vt+ft*ft;Ze<=rt&&(Te=mt,rt=Ze)}if(Te!=null&&(e!==1||t!==1)){const mt=H(Te)-Se,vt=Y(Te)-Le;rt=mt*mt+vt*vt}se(Te,rt)}function Me(Pe){Pe.pointerType==="mouse"&&Q!=null&&(x.sticky&&x.roots.some(Se=>Se==null?void 0:Se.contains(Pe.target))||(x.sticky?(x.sticky=!1,x.renders.forEach(Se=>Se(null))):(x.sticky=!0,ue(Q)),Pe.stopImmediatePropagation()))}function de(Pe){Pe.pointerType==="mouse"&&(x.sticky||se(null))}return C.addEventListener("pointerenter",he),C.addEventListener("pointermove",he),C.addEventListener("pointerdown",Me),C.addEventListener("pointerleave",de),ue(null)},p)}}function hZ(e){return rw(1,1,e)}function fZ(e){return rw(1,.01,e)}function ZS(e){return rw(.01,1,e)}function E7({x1:e,x2:t,x:i=e},r){return e&&t?o=>(e[o]+t[o])/2:i?o=>i[o]:()=>r}function w7({y1:e,y2:t,y:i=e},r){return e&&t?o=>(e[o]+t[o])/2:i?o=>i[o]:()=>r}function C7(e){return Ah(e)&&e.interval===void 0?void 0:"tabular-nums"}function dZ(e,t){let{label:i=e.label,tickSize:r=6,width:o=240,height:a=44+r,marginTop:h=18,marginRight:u=0,marginBottom:p=16+r,marginLeft:c=0,style:f,ticks:g=(o-c-u)/64,tickFormat:m,fontVariant:v=C7(e),round:A=!0,opacity:y,className:C}=t;const E=KE(t);C=ew(C),y=Mo(y)[1],m===null&&(m=()=>null);const x=ys("svg",E).attr("class",`${C}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",a).attr("viewBox",`0 0 ${o} ${a}`).call(O=>O.append("style").text(`:where(.${C}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${C}-ramp text) {
  white-space: pre;
}`)).call(tw,f);let M=O=>O.selectAll(".tick line").attr("y1",h+p-a),w;const S=A?(O,W)=>O.rangeRound(W):(O,W)=>O.range(W),{type:I,domain:L,range:R,interpolate:k,scale:P,pivot:F}=e;if(k){const O=R===void 0?k:b1(k.length===1?JE(k):k,R);w=S(P.copy(),Ka(uo(c,o-u),Math.min(L.length+(F!==void 0),R===void 0?1/0:R.length)));const W=256,V=E.document.createElement("canvas");V.width=W,V.height=1;const $=V.getContext("2d");for(let H=0,Y=W-1;H<W;++H)$.fillStyle=O(H/Y),$.fillRect(H,0,1,1);x.append("image").attr("opacity",y).attr("x",c).attr("y",h).attr("width",o-c-u).attr("height",a-h-p).attr("preserveAspectRatio","none").attr("xlink:href",V.toDataURL())}else if(I==="threshold"){const O=L,W=m===void 0?V=>V:typeof m=="string"?td(m):m;w=S(T1().domain([-1,R.length-1]),[c,o-u]),x.append("g").attr("fill-opacity",y).selectAll().data(R).enter().append("rect").attr("x",(V,$)=>w($-1)).attr("y",h).attr("width",(V,$)=>w($)-w($-1)).attr("height",a-h-p).attr("fill",V=>V),g=Os(O,(V,$)=>$),m=V=>W(O[V],V)}else w=S(M1().domain(L),[c,o-u]),x.append("g").attr("fill-opacity",y).selectAll().data(L).enter().append("rect").attr("x",w).attr("y",h).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-h-p).attr("fill",P),M=()=>{};return x.append("g").attr("transform",`translate(0,${a-p})`).call(yG(w).ticks(Array.isArray(g)?null:g,typeof m=="string"?m:void 0).tickFormat(typeof m=="function"?m:void 0).tickSize(r).tickValues(Array.isArray(g)?g:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Ns(v,"normal")).call(M).call(O=>O.select(".domain").remove()),i!==void 0&&x.append("text").attr("x",c).attr("y",h-6).attr("fill","currentColor").attr("font-weight","bold").text(i),x.node()}const x7=Math.PI/180;function Fm(e,{marker:t,markerStart:i=t,markerMid:r=t,markerEnd:o=t}={}){e.markerStart=Xy(i),e.markerMid=Xy(r),e.markerEnd=Xy(o)}function Xy(e){if(e==null||e===!1)return null;if(e===!0)return tT;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return eT("auto");case"arrow-reverse":return eT("auto-start-reverse");case"dot":return pZ;case"circle":case"circle-fill":return tT;case"circle-stroke":return mZ;case"tick":return Ky("auto");case"tick-x":return Ky(90);case"tick-y":return Ky(0)}throw new Error(`invalid marker: ${e}`)}function eT(e){return(t,i)=>ys("svg:marker",i).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function pZ(e,t){return ys("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(i=>i.append("circle").attr("r",2.5)).node()}function tT(e,t){return ys("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(i=>i.append("circle").attr("r",3)).node()}function mZ(e,t){return ys("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(i=>i.append("circle").attr("r",3)).node()}function Ky(e){return(t,i)=>ys("svg:marker",i).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let AZ=0;function Y1(e,t,{stroke:i},r){return M7(e,t,i&&(o=>i[o]),r)}function gZ(e,t,{stroke:i},r){return M7(e,t,i&&(([o])=>i[o]),r)}function M7(e,{markerStart:t,markerMid:i,markerEnd:r,stroke:o},a=()=>o,h){const u=new Map;function p(c){return function(f){const g=a(f);let m=u.get(c);m||u.set(c,m=new Map);let v=m.get(g);if(!v){const A=this.parentNode.insertBefore(c(g,h),this),y=`plot-marker-${++AZ}`;A.setAttribute("id",y),m.set(g,v=`url(#${y})`)}return v}}t&&e.attr("marker-start",p(t)),i&&e.attr("marker-mid",p(i)),r&&e.attr("marker-end",p(r))}function q1({inset:e,insetLeft:t,insetRight:i,...r}={}){return[t,i]=S7(e,t,i),{inset:e,insetLeft:t,insetRight:i,...r}}function sw({inset:e,insetTop:t,insetBottom:i,...r}={}){return[t,i]=S7(e,t,i),{inset:e,insetTop:t,insetBottom:i,...r}}function S7(e,t,i){return e===void 0&&t===void 0&&i===void 0?Go?[1,0]:[.5,.5]:[t,i]}function T7(e,{interval:t}){return e={...Im(e)},e.interval=GE(e.interval===void 0?t:e.interval),e}function J1(e,t,i,r){const{[e]:o,[`${e}1`]:a,[`${e}2`]:h}=i,{value:u,interval:p}=T7(o,i);if(u==null||p==null&&!r)return i;const c=ph(o);if(p==null){let v;const A={transform:y=>v||(v=Xr(y,u)),label:c};return{...i,[e]:void 0,[`${e}1`]:a===void 0?A:a,[`${e}2`]:h===void 0&&!(a===h&&r)?A:h}}let f,g;function m(v){return g!==void 0&&v===f?g:g=Os(Xr(f=v,u),A=>p.floor(A))}return t({...i,[e]:void 0,[`${e}1`]:a===void 0?{transform:m,label:c}:a,[`${e}2`]:h===void 0?{transform:v=>m(v).map(A=>p.offset(A)),label:c}:h})}function I7(e,t,i){const{[e]:r}=i,{value:o,interval:a}=T7(r,i);return o==null||a==null?i:t({...i,[e]:{label:ph(r),transform:h=>{const u=Os(Xr(h,o),c=>a.floor(c)),p=u.map(c=>a.offset(c));return u.map(Ho(u)?(c,f)=>c==null||isNaN(c=+c)||(f=p[f],f==null)||isNaN(f=+f)?void 0:new Date((c+f)/2):(c,f)=>c==null||(f=p[f],f==null)?NaN:(+c+ +f)/2)}}})}function B7(e={}){return J1("x",q1,e,!0)}function vZ(e={}){return J1("y",sw,e,!0)}function R7(e={}){return J1("x",q1,e)}function L7(e={}){return J1("y",sw,e)}function bZ(e={}){return I7("x",q1,e)}function yZ(e={}){return I7("y",sw,e)}const P7={ariaLabel:"rule",fill:null,stroke:"currentColor"};class _Z extends mo{constructor(t,i={}){const{x:r,y1:o,y2:a,inset:h=0,insetTop:u=h,insetBottom:p=h}=i;super(t,{x:{value:r,scale:"x",optional:!0},y1:{value:o,scale:"y",optional:!0},y2:{value:a,scale:"y",optional:!0}},Om(i,"x"),P7),this.insetTop=Pr(u),this.insetBottom=Pr(p),Fm(this,i)}render(t,i,r,o,a){const{x:h,y:u}=i,{x:p,y1:c,y2:f}=r,{width:g,height:m,marginTop:v,marginRight:A,marginLeft:y,marginBottom:C}=o,{insetTop:E,insetBottom:x}=this;return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,{x:p&&h},Go,0).call(M=>M.selectAll().data(t).enter().append("line").call(ua,this).attr("x1",p?w=>p[w]:(y+g-A)/2).attr("x2",p?w=>p[w]:(y+g-A)/2).attr("y1",c&&!Ma(u)?w=>c[w]+E:v+E).attr("y2",f&&!Ma(u)?u.bandwidth?w=>f[w]+u.bandwidth()-x:w=>f[w]-x:m-C-x).call(Il,this,r).call(Y1,this,r,a)).node()}}class EZ extends mo{constructor(t,i={}){const{x1:r,x2:o,y:a,inset:h=0,insetRight:u=h,insetLeft:p=h}=i;super(t,{y:{value:a,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:o,scale:"x",optional:!0}},Om(i,"y"),P7),this.insetRight=Pr(u),this.insetLeft=Pr(p),Fm(this,i)}render(t,i,r,o,a){const{x:h,y:u}=i,{y:p,x1:c,x2:f}=r,{width:g,height:m,marginTop:v,marginRight:A,marginLeft:y,marginBottom:C}=o,{insetLeft:E,insetRight:x}=this;return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,{y:p&&u},0,Go).call(M=>M.selectAll().data(t).enter().append("line").call(ua,this).attr("x1",c&&!Ma(h)?w=>c[w]+E:y+E).attr("x2",f&&!Ma(h)?h.bandwidth?w=>f[w]+h.bandwidth()-x:w=>f[w]-x:g-A-x).attr("y1",p?w=>p[w]:(v+m-C)/2).attr("y2",p?w=>p[w]:(v+m-C)/2).call(Il,this,r).call(Y1,this,r,a)).node()}}function no(e,t){let{x:i=fs,y:r,y1:o,y2:a,...h}=L7(t);return[o,a]=D7(r,o,a),new _Z(e,{...h,x:i,y1:o,y2:a})}function hs(e,t){let{y:i=fs,x:r,x1:o,x2:a,...h}=R7(t);return[o,a]=D7(r,o,a),new EZ(e,{...h,y:i,x1:o,x2:a})}function D7(e,t,i){if(e==null){if(t===void 0){if(i!==void 0)return[0,i]}else if(i===void 0)return[0,t]}else{if(t===void 0)return i===void 0?[0,e]:[e,i];if(i===void 0)return[e,t]}return[t,i]}function ow(e,...t){let i=t.length;for(let r=0,o=!0;r<i;++r)typeof t[r]!="function"&&(o&&(e=e.slice(),o=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--i);return r=>{let o=e[0];for(let a=0;a<i;++a)o+=t[a](r)+e[a+1];return o}}const wZ={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},N7="";class aw extends mo{constructor(t,i={}){const{x:r,y:o,text:a=su(t)&&F8(t)?fs:Sm,frameAnchor:h,textAnchor:u=/right$/i.test(h)?"end":/left$/i.test(h)?"start":"middle",lineAnchor:p=/^top/i.test(h)?"top":/^bottom/i.test(h)?"bottom":"middle",lineHeight:c=1,lineWidth:f=1/0,textOverflow:g,monospace:m,fontFamily:v=m?"ui-monospace, monospace":void 0,fontSize:A,fontStyle:y,fontVariant:C,fontWeight:E,rotate:x}=i,[M,w]=Mo(x,0),[S,I]=IZ(A);if(super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},fontSize:{value:S,optional:!0},rotate:{value:KY(M),optional:!0},text:{value:a,filter:BE,optional:!0}},i,wZ),this.rotate=w,this.textAnchor=Ns(u,"middle"),this.lineAnchor=Pa(p,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+f,this.textOverflow=O7(g),this.monospace=!!m,this.fontFamily=xo(v),this.fontSize=I,this.fontStyle=xo(y),this.fontVariant=xo(C),this.fontWeight=xo(E),this.frameAnchor=z1(h),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${f}`);this.splitLines=k7(this),this.clipLine=U7(this)}render(t,i,r,o,a){const{x:h,y:u}=i,{x:p,y:c,rotate:f,text:g,title:m,fontSize:v}=r,{rotate:A}=this,[y,C]=Nm(this,o);return ys("svg:g",a).call(ca,this,o,a).call(F7,this,g,o).call(Bo,this,{x:p&&h,y:c&&u}).call(E=>E.selectAll().data(t).enter().append("text").call(ua,this).call(CZ,this,g,m).attr("transform",ow`translate(${p?x=>p[x]:y},${c?x=>c[x]:C})${f?x=>` rotate(${f[x]})`:A?` rotate(${A})`:""}`).call(Mi,"font-size",v&&(x=>v[x])).call(Il,this,r)).node()}}function O7(e){return e==null?null:Pa(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function CZ(e,t,i,r){if(!i)return;const{lineAnchor:o,lineHeight:a,textOverflow:h,splitLines:u,clipLine:p}=t;e.each(function(c){const f=u(oh(i[c])??"").map(p),g=f.length,m=o==="top"?.71:o==="bottom"?1-g:(164-g*100)/200;if(g>1){let v=0;for(let A=0;A<g;++A){if(++v,!f[A])continue;const y=this.ownerDocument.createElementNS(If.svg,"tspan");y.setAttribute("x",0),A===v-1?y.setAttribute("y",`${(m+A)*a}em`):y.setAttribute("dy",`${v*a}em`),y.textContent=f[A],this.appendChild(y),v=0}}else m&&this.setAttribute("y",`${m*a}em`),this.textContent=f[0];if(h&&!r&&f[0]!==i[c]){const v=this.ownerDocument.createElementNS(If.svg,"title");v.textContent=i[c],this.appendChild(v)}})}function Ba(e,{x:t,y:i,...r}={}){return r.frameAnchor===void 0&&([t,i]=id(t,i)),new aw(e,{...r,x:t,y:i})}function xZ(e,{x:t=fs,...i}={}){return new aw(e,yZ({...i,x:t}))}function MZ(e,{y:t=fs,...i}={}){return new aw(e,bZ({...i,y:t}))}function F7(e,t,i){Mi(e,"text-anchor",t.textAnchor),Mi(e,"font-family",t.fontFamily),Mi(e,"font-size",t.fontSize),Mi(e,"font-style",t.fontStyle),Mi(e,"font-variant",t.fontVariant===void 0?SZ(i):t.fontVariant),Mi(e,"font-weight",t.fontWeight)}function SZ(e){return e&&(JY(e)||Ho(e))?"tabular-nums":void 0}const TZ=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function IZ(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),TZ.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function BZ(e,t,i){const r=[];let o,a=0;for(const[h,u,p]of RZ(e)){if(o===void 0&&(o=h),a>o&&i(e,o,u)>t&&(r.push(e.slice(o,a)+(e[a-1]===N7?"-":"")),o=h),p){r.push(e.slice(o,u)),o=void 0;continue}a=u}return r}function*RZ(e){let t=0,i=0;const r=e.length;for(;i<r;){let o=1;switch(e[i]){case N7:case"-":++i,yield[t,i,!1],t=i;break;case" ":for(yield[t,i,!1];e[++i]===" ";);t=i;break;case"\r":e[i+1]===`
`&&++o;case`
`:yield[t,i,!0],i+=o,t=i;break;default:++i;break}}yield[t,i,!0]}const nT={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"":31,"":31,"":47,"":47,"":82};function lw(e,t=0,i=e.length){let r=0;for(let o=t;o<i;o=sd(e,o))r+=nT[e[o]]??(V7(e,o)?120:nT.e);return r}function cw(e,t=0,i=e.length){let r=0;for(let o=t;o<i;o=sd(e,o))r+=V7(e,o)?126:63;return r}function k7({monospace:e,lineWidth:t,textOverflow:i}){if(i!=null||t==1/0)return a=>a.split(/\r\n?|\n/g);const r=e?cw:lw,o=t*100;return a=>BZ(a,o,r)}function U7({monospace:e,lineWidth:t,textOverflow:i}){if(i==null||t==1/0)return a=>a;const r=e?cw:lw,o=t*100;switch(i){case"clip-start":return a=>rT(a,o,r,"");case"clip-end":return a=>iT(a,o,r,"");case"ellipsis-start":return a=>rT(a,o,r,vf);case"ellipsis-middle":return a=>LZ(a,o,r,vf);case"ellipsis-end":return a=>iT(a,o,r,vf)}}const vf="";function zf(e,t,i,r){const o=[];let a=0;for(let h=0,u=0,p=e.length;h<p;h=u){u=sd(e,h);const c=i(e,h,u);if(a+c>t){for(a+=r;a>t&&h>0;)u=h,h=o.pop(),a-=i(e,h,u);return[h,t-a]}a+=c,o.push(h)}return[-1,0]}function iT(e,t,i,r){e=e.trim();const o=i(r),[a]=zf(e,t,i,o);return a<0?e:e.slice(0,a).trimEnd()+r}function LZ(e,t,i,r){e=e.trim();const o=i(e);if(o<=t)return e;const a=i(r)/2,[h,u]=zf(e,t/2,i,a),[p]=zf(e,o-t/2-u+a,i,-a);return p<0?r:e.slice(0,h).trimEnd()+r+e.slice(sd(e,p)).trimStart()}function rT(e,t,i,r){e=e.trim();const o=i(e);if(o<=t)return e;const a=i(r),[h]=zf(e,o-t+a,i,-a);return h<0?r:r+e.slice(sd(e,h)).trimStart()}const f_=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,sT=new RegExp("\\p{Extended_Pictographic}","uy");function sd(e,t){return t+=PZ(e,t)?2:1,NZ(e,t)&&(t=f_.lastIndex),DZ(e,t)?sd(e,t+1):t}function G7(e,t){return e.charCodeAt(t)<128}function PZ(e,t){const i=e.charCodeAt(t);if(i>=55296&&i<56320){const r=e.charCodeAt(t+1);return r>=56320&&r<57344}return!1}function DZ(e,t){return e.charCodeAt(t)===8205}function NZ(e,t){return G7(e,t)?!1:(f_.lastIndex=t,f_.test(e))}function V7(e,t){return G7(e,t)?!1:(sT.lastIndex=t,sT.test(e))}const OZ={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Q7=3.5,FZ=Q7*5,H7={draw(e,t,i){const r=t*i/FZ;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},kZ={draw(e,t,i){e.moveTo(-i,0),e.lineTo(0,-t),e.lineTo(i,0)}},UZ=new Map([["arrow",H7],["spike",kZ]]);function GZ(e){return e&&typeof e.draw=="function"}function VZ(e){if(GZ(e))return e;const t=UZ.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class z7 extends mo{constructor(t,i={}){const{x:r,y:o,r:a=Q7,length:h,rotate:u,shape:p=H7,anchor:c="middle",frameAnchor:f}=i,[g,m]=Mo(h,12),[v,A]=Mo(u,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},length:{value:g,scale:"length",optional:!0},rotate:{value:v,optional:!0}},i,OZ),this.r=+a,this.length=m,this.rotate=A,this.shape=VZ(p),this.anchor=Pa(c,"anchor",["start","middle","end"]),this.frameAnchor=z1(f)}render(t,i,r,o,a){const{x:h,y:u}=i,{x:p,y:c,length:f,rotate:g}=r,{length:m,rotate:v,anchor:A,shape:y,r:C}=this,[E,x]=Nm(this,o);return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,{x:p&&h,y:c&&u}).call(M=>M.selectAll().data(t).enter().append("path").call(ua,this).attr("transform",ow`translate(${p?w=>p[w]:E},${c?w=>c[w]:x})${g?w=>` rotate(${g[w]})`:v?` rotate(${v})`:""}${A==="start"?"":A==="end"?f?w=>` translate(0,${f[w]})`:` translate(0,${m})`:f?w=>` translate(0,${f[w]/2})`:` translate(0,${m/2})`}`).attr("d",f?w=>{const S=jc();return y.draw(S,f[w],C),S}:(()=>{const w=jc();return y.draw(w,m,C),w})()).call(Il,this,r)).node()}}function QZ(e,t={}){const{x:i=fs,...r}=t;return new z7(e,{...r,x:i})}function HZ(e,t={}){const{y:i=fs,...r}=t;return new z7(e,{...r,y:i})}function au(e,t){return arguments.length<2&&!su(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function Z1({anchor:e}={},t){return e===void 0?t[0]:Pa(e,"anchor",t)}function j7(e){return Z1(e,["left","right"])}function W7(e){return Z1(e,["right","left"])}function $7(e){return Z1(e,["bottom","top"])}function X7(e){return Z1(e,["top","bottom"])}function K7(){const[e,t]=au(...arguments);return q7("y",j7(t),e,t)}function zZ(){const[e,t]=au(...arguments);return q7("fy",W7(t),e,t)}function Y7(){const[e,t]=au(...arguments);return J7("x",$7(t),e,t)}function jZ(){const[e,t]=au(...arguments);return J7("fx",X7(t),e,t)}function q7(e,t,i,{color:r="currentColor",opacity:o=1,stroke:a=r,strokeOpacity:h=o,strokeWidth:u=1,fill:p=r,fillOpacity:c=o,textAnchor:f,textStroke:g,textStrokeOpacity:m,textStrokeWidth:v,tickSize:A=e==="y"?6:0,tickPadding:y,tickRotate:C,x:E,margin:x,marginTop:M=x===void 0?20:x,marginRight:w=x===void 0?t==="right"?40:0:x,marginBottom:S=x===void 0?20:x,marginLeft:I=x===void 0?t==="left"?40:0:x,label:L,labelAnchor:R,labelArrow:k,labelOffset:P,...F}){return A=Pr(A),y=Pr(y),C=Pr(C),R!==void 0&&(R=Pa(R,"labelAnchor",["center","top","bottom"])),k=oL(k),iw(A&&!ho(a)?WZ(e,t,i,{stroke:a,strokeOpacity:h,strokeWidth:u,tickSize:A,tickPadding:y,tickRotate:C,x:E,...F}):null,ho(p)?null:XZ(e,t,i,{fill:p,fillOpacity:c,stroke:g,strokeOpacity:m,strokeWidth:v,textAnchor:f,tickSize:A,tickPadding:y,tickRotate:C,x:E,marginTop:M,marginRight:w,marginBottom:S,marginLeft:I,...F}),!ho(p)&&L!==null?Ba([],nL({fill:p,fillOpacity:c,...F},function(O,W,V,$,H){const Y=$[e],{marginTop:Q,marginRight:G,marginBottom:J,marginLeft:K}=e==="y"&&H.inset||H,se=R??(Y.bandwidth?"center":"top"),ue=P??(t==="right"?G:K)-3;return se==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=se,this.frameAnchor=`${se}-${t}`,this.rotate=0),this.dy=se==="top"?3-Q:se==="bottom"?J-3:0,this.dx=t==="right"?ue:-ue,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[sL(e,Y,{anchor:t,label:L,labelAnchor:se,labelArrow:k})]}}}})):null)}function J7(e,t,i,{color:r="currentColor",opacity:o=1,stroke:a=r,strokeOpacity:h=o,strokeWidth:u=1,fill:p=r,fillOpacity:c=o,textAnchor:f,textStroke:g,textStrokeOpacity:m,textStrokeWidth:v,tickSize:A=e==="x"?6:0,tickPadding:y,tickRotate:C,y:E,margin:x,marginTop:M=x===void 0?t==="top"?30:0:x,marginRight:w=x===void 0?20:x,marginBottom:S=x===void 0?t==="bottom"?30:0:x,marginLeft:I=x===void 0?20:x,label:L,labelAnchor:R,labelArrow:k,labelOffset:P,...F}){return A=Pr(A),y=Pr(y),C=Pr(C),R!==void 0&&(R=Pa(R,"labelAnchor",["center","left","right"])),k=oL(k),iw(A&&!ho(a)?$Z(e,t,i,{stroke:a,strokeOpacity:h,strokeWidth:u,tickSize:A,tickPadding:y,tickRotate:C,y:E,...F}):null,ho(p)?null:KZ(e,t,i,{fill:p,fillOpacity:c,stroke:g,strokeOpacity:m,strokeWidth:v,textAnchor:f,tickSize:A,tickPadding:y,tickRotate:C,y:E,marginTop:M,marginRight:w,marginBottom:S,marginLeft:I,...F}),!ho(p)&&L!==null?Ba([],nL({fill:p,fillOpacity:c,...F},function(O,W,V,$,H){const Y=$[e],{marginTop:Q,marginRight:G,marginBottom:J,marginLeft:K}=e==="x"&&H.inset||H,se=R??(Y.bandwidth?"center":"right"),ue=P??(t==="top"?Q:J)-3;return se==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${se}`,this.textAnchor=se==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-ue:ue,this.dx=se==="right"?G-3:se==="left"?3-K:0,this.ariaLabel=`${e}-axis label`,{facets:[[0]],channels:{text:{value:[sL(e,Y,{anchor:t,label:L,labelAnchor:se,labelArrow:k})]}}}})):null)}function WZ(e,t,i,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:a=null,facetAnchor:h=t+(e==="y"?"-empty":""),frameAnchor:u=t,tickSize:p,inset:c=0,insetLeft:f=c,insetRight:g=c,dx:m=0,y:v=e==="y"?void 0:null,...A}){return od(HZ,e,i,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:o,strokeLinejoin:a,facetAnchor:h,frameAnchor:u,y:v,...A,dx:t==="left"?+m-Go+ +f:+m+Go-g,anchor:"start",length:p,shape:t==="left"?iee:ree})}function $Z(e,t,i,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:a=null,facetAnchor:h=t+(e==="x"?"-empty":""),frameAnchor:u=t,tickSize:p,inset:c=0,insetTop:f=c,insetBottom:g=c,dy:m=0,x:v=e==="x"?void 0:null,...A}){return od(QZ,e,i,{ariaLabel:`${e}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:a,strokeLinecap:o,facetAnchor:h,frameAnchor:u,x:v,...A,dy:t==="bottom"?+m-Go-g:+m+Go+ +f,anchor:"start",length:p,shape:t==="bottom"?tee:nee})}function XZ(e,t,i,{facetAnchor:r=t+(e==="y"?"-empty":""),frameAnchor:o=t,tickSize:a,tickRotate:h=0,tickPadding:u=Math.max(3,9-a)+(Math.abs(h)>60?4*Math.cos(h*x7):0),text:p,textAnchor:c=Math.abs(h)>60?"middle":t==="left"?"end":"start",lineAnchor:f=h>60?"top":h<-60?"bottom":"middle",fontVariant:g,inset:m=0,insetLeft:v=m,insetRight:A=m,dx:y=0,y:C=e==="y"?void 0:null,...E}){return od(MZ,e,i,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:p,textAnchor:c,lineAnchor:f,fontVariant:g,rotate:h,y:C,...E,dx:t==="left"?+y-a-u+ +v:+y+ +a+ +u-A},function(x,M,w,S,I){g===void 0&&(this.fontVariant=rL(x)),p===void 0&&(I.text=iL(x,M,w,S,t))})}function KZ(e,t,i,{facetAnchor:r=t+(e==="x"?"-empty":""),frameAnchor:o=t,tickSize:a,tickRotate:h=0,tickPadding:u=Math.max(3,9-a)+(Math.abs(h)>=10?4*Math.cos(h*x7):0),text:p,textAnchor:c=Math.abs(h)>=10?h<0^t==="bottom"?"start":"end":"middle",lineAnchor:f=Math.abs(h)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:g,inset:m=0,insetTop:v=m,insetBottom:A=m,dy:y=0,x:C=e==="x"?void 0:null,...E}){return od(xZ,e,i,{ariaLabel:`${e}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:p===void 0?null:p,textAnchor:c,lineAnchor:f,fontVariant:g,rotate:h,x:C,...E,dy:t==="bottom"?+y+ +a+ +u-A:+y-a-u+ +v},function(x,M,w,S,I){g===void 0&&(this.fontVariant=rL(x)),p===void 0&&(I.text=iL(x,M,w,S,t))})}function YZ(){const[e,t]=au(...arguments);return Z7("y",j7(t),e,t)}function qZ(){const[e,t]=au(...arguments);return Z7("fy",W7(t),e,t)}function JZ(){const[e,t]=au(...arguments);return eL("x",$7(t),e,t)}function ZZ(){const[e,t]=au(...arguments);return eL("fx",X7(t),e,t)}function Z7(e,t,i,{y:r=e==="y"?void 0:null,x:o=null,x1:a=t==="left"?o:null,x2:h=t==="right"?o:null,...u}){return od(hs,e,i,{ariaLabel:`${e}-grid`,ariaHidden:!0},{y:r,x1:a,x2:h,...tL(u)})}function eL(e,t,i,{x:r=e==="x"?void 0:null,y:o=null,y1:a=t==="top"?o:null,y2:h=t==="bottom"?o:null,...u}){return od(no,e,i,{ariaLabel:`${e}-grid`,ariaHidden:!0},{x:r,y1:a,y2:h,...tL(u)})}function tL({color:e="currentColor",opacity:t=.1,stroke:i=e,strokeOpacity:r=t,strokeWidth:o=1,...a}){return{stroke:i,strokeOpacity:r,strokeWidth:o,...a}}function nL({fill:e,fillOpacity:t,fontFamily:i,fontSize:r,fontStyle:o,fontVariant:a,fontWeight:h,monospace:u,pointerEvents:p,shapeRendering:c,clip:f=!1},g){return[,e]=Za(e),[,t]=Mo(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:i,fontSize:r,fontStyle:o,fontVariant:a,fontWeight:h,monospace:u,pointerEvents:p,shapeRendering:c,clip:f,initializer:g}}function od(e,t,i,r,o,a){let h;function u(f,g,m,v,A,y){const C=f==null&&(t==="fx"||t==="fy"),{[t]:E}=v;if(!E)throw new Error(`missing scale: ${t}`);const x=E.domain();let{interval:M,ticks:w,tickFormat:S,tickSpacing:I=t==="x"?80:35}=o;if(typeof w=="string"&&aL(E)&&(M=w,w=void 0),w===void 0&&(w=rd(M,E.type)??eee(E,I)),f==null){if(su(w))f=la(w);else if(hf(w))f=Yy(w,...Ms(x));else if(E.interval){let R=E.interval;if(E.ticks){const[k,P]=Ms(x),F=(P-k)/R[Mm];R=TS(R,F/w)??R,f=Yy(R,k,P)}else{f=x;const k=f.length;R=TS(R,k/w)??R,R!==E.interval&&(f=Yy(R,...Ms(f)))}if(R===E.interval){const k=Math.round(f.length/w);k>1&&(f=f.filter((P,F)=>F%k===0))}}else E.ticks?f=E.ticks(w):f=x;if(!E.ticks&&f.length&&f!==x){const R=new cm(x);f=f.filter(k=>R.has(k)),f.length||Xc(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}t==="y"||t==="x"?g=[gc(f)]:h[t]={scale:t,value:fs}}a==null||a.call(this,E,f,w,S,h);const L=Object.fromEntries(Object.entries(h).map(([R,k])=>[R,{...k,value:Xr(f,k.value)}]));return C&&(g=y.filterFacets(f,L)),{data:f,facets:g,channels:L}}const p=Hf(o).initializer,c=e(i,Hf({...o,initializer:u},p));return i==null?(h=c.channels,c.channels={}):h={},r!==void 0&&Object.assign(c,r),c.clip===void 0&&(c.clip=!1),c}function eee(e,t){const[i,r]=Ms(e.range());return(r-i)/t}function iL(e,t,i,r,o){return{value:uw(e,t,i,r,o)}}function uw(e,t,i,r,o){return typeof r=="function"?r:r===void 0&&t&&Ho(t)?kY(e.type,t,o)??oh:e.tickFormat?e.tickFormat(typeof i=="number"?i:null,r):r===void 0?oh:typeof r=="string"?(Ho(e.domain())?Em:td)(r):Tm(r)}function Yy(e,t,i){return e.range(t,e.offset(e.floor(i)))}const tee={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},nee={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},iee={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},ree={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function rL(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function sL(e,t,{anchor:i,label:r=t.label,labelAnchor:o,labelArrow:a}={}){if(!(r==null||r.inferred&&aL(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),a==="auto"&&(a=(!t.bandwidth||t.interval)&&!/[]/.test(r)),!a)return r;if(a===!0){const h=xJ(t);h&&(a=/x$/.test(e)||o==="center"?/x$/.test(e)===h<0?"left":"right":h<0?"up":"down")}switch(a){case"left":return` ${r}`;case"right":return`${r} `;case"up":return i==="right"?`${r} `:` ${r}`;case"down":return i==="right"?`${r} `:` ${r}`}return r}}function oL(e="auto"){return ho(e)?!1:typeof e=="boolean"?e:Pa(e,"labelArrow",["auto","up","right","down","left"])}function aL(e){return Ho(e.domain())}function oT(e,t){if(t==null)return t;const i=e(t);if(!i)throw new Error(`scale not found: ${t}`);return i}function see(e,{opacity:t,...i}={}){if(!Ah(e)&&!g7(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return lL(e,i,(r,o,a,h)=>r.append("svg").attr("width",a).attr("height",h).attr("fill",o.scale).attr("fill-opacity",Mo(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function oee(e,{fill:t=(c=>(c=e.hint)==null?void 0:c.fill)()!==void 0?e.hint.fill:"none",fillOpacity:i=1,stroke:r=(f=>(f=e.hint)==null?void 0:f.stroke)()!==void 0?e.hint.stroke:ho(t)?"currentColor":"none",strokeOpacity:o=1,strokeWidth:a=1.5,r:h=4.5,...u}={},p){const[g,m]=Za(t),[v,A]=Za(r),y=oT(p,g),C=oT(p,v),E=h*h*Math.PI;return i=Mo(i)[1],o=Mo(o)[1],a=Mo(a)[1],lL(e,u,(x,M,w,S)=>x.append("svg").attr("viewBox","-8 -8 16 16").attr("width",w).attr("height",S).attr("fill",g==="color"?I=>y.scale(I):m).attr("fill-opacity",i).attr("stroke",v==="color"?I=>C.scale(I):A).attr("stroke-opacity",o).attr("stroke-width",a).append("path").attr("d",I=>{const L=jc();return e.scale(I).draw(L,E),L}))}function lL(e,t={},i){let{columns:r,tickFormat:o,fontVariant:a=C7(e),swatchSize:h=15,swatchWidth:u=h,swatchHeight:p=h,marginLeft:c=0,className:f,style:g,width:m}=t;const v=KE(t);f=ew(f),o=uw(e.scale,e.domain,void 0,o);const A=ys("div",v).attr("class",`${f}-swatches ${f}-swatches-${r!=null?"columns":"wrap"}`);let y;return r!=null?(y=`:where(.${f}-swatches-columns .${f}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${f}-swatches-columns .${f}-swatch::before) {
  flex-shrink: 0;
}
:where(.${f}-swatches-columns .${f}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,A.style("columns",r).selectAll().data(e.domain).enter().append("div").attr("class",`${f}-swatch`).call(i,e,u,p).call(C=>C.append("div").attr("class",`${f}-swatch-label`).attr("title",o).text(o))):(y=`:where(.${f}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${f}-swatches-wrap .${f}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,A.selectAll().data(e.domain).enter().append("span").attr("class",`${f}-swatch`).call(i,e,u,p).append(function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))})),A.call(C=>C.insert("style","*").text(`:where(.${f}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${f}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${y}`)).style("margin-left",c?`${+c}px`:null).style("width",m===void 0?null:`${+m}px`).style("font-variant",Ns(a,"normal")).call(tw,g).node()}const d_=new Map([["symbol",oee],["color",uL],["opacity",lee]]);function aee(e,t,i={}){return(r,o)=>{if(!d_.has(r))throw new Error(`unknown legend type: ${r}`);if(r in e)return d_.get(r)(e[r],cL(t,i[r],o),a=>e[a])}}function cL({className:e,...t},{label:i,ticks:r,tickFormat:o}={},a){return nq(a,{className:e,...t},{label:i,ticks:r,tickFormat:o})}function uL(e,{legend:t=!0,...i}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return see(e,i);case"ramp":return dZ(e,i);default:throw new Error(`unknown legend type: ${t}`)}}function lee({type:e,interpolate:t,...i},{legend:r=!0,color:o=qc(0,0,0),...a}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return uL({type:e,...i,interpolate:cee(o)},{legend:r,...a})}function cee(e){const{r:t,g:i,b:r}=qc(e)||qc(0,0,0);return o=>`rgba(${t},${i},${r},${o})`}function uee(e,t,i){const r=[];for(const[o,a]of d_){const h=i[o];if(h!=null&&h.legend&&o in e){const u=a(e[o],cL(t,e[o],h),p=>e[p]);u!=null&&r.push(u)}}return r}const hee={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},fee={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class dee extends mo{constructor(t={}){const{anchor:i=null,inset:r=0,insetTop:o=r,insetRight:a=r,insetBottom:h=r,insetLeft:u=r,rx:p,ry:c}=t;super(tg,void 0,t,i==null?hee:fee),this.anchor=L8(i,"anchor",["top","right","bottom","left"]),this.insetTop=Pr(o),this.insetRight=Pr(a),this.insetBottom=Pr(h),this.insetLeft=Pr(u),this.rx=Pr(p),this.ry=Pr(c)}render(t,i,r,o,a){const{marginTop:h,marginRight:u,marginBottom:p,marginLeft:c,width:f,height:g}=o,{anchor:m,insetTop:v,insetRight:A,insetBottom:y,insetLeft:C,rx:E,ry:x}=this,M=c+C,w=f-u-A,S=h+v,I=g-p-y;return ys(m?"svg:line":"svg:rect",a).datum(0).call(ca,this,o,a).call(ua,this).call(Il,this,r).call(Bo,this,{}).call(m==="left"?L=>L.attr("x1",M).attr("x2",M).attr("y1",S).attr("y2",I):m==="right"?L=>L.attr("x1",w).attr("x2",w).attr("y1",S).attr("y2",I):m==="top"?L=>L.attr("x1",M).attr("x2",w).attr("y1",S).attr("y2",S):m==="bottom"?L=>L.attr("x1",M).attr("x2",w).attr("y1",I).attr("y2",I):L=>L.attr("x",M).attr("y",S).attr("width",w-M).attr("height",I-S).attr("rx",E).attr("ry",x)).node()}}function pee(e){return new dee(e)}const qy={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},mee=new Set(["geometry","href","src","ariaLabel","scales"]);class Aee extends mo{constructor(t,i={}){i.tip&&(i={...i,tip:!1}),i.title===void 0&&su(t)&&F8(t)&&(i={...i,title:fs});const{x:r,y:o,x1:a,x2:h,y1:u,y2:p,anchor:c,preferredAnchor:f="bottom",monospace:g,fontFamily:m=g?"ui-monospace, monospace":void 0,fontSize:v,fontStyle:A,fontVariant:y,fontWeight:C,lineHeight:E=1,lineWidth:x=20,frameAnchor:M,format:w,textAnchor:S="start",textOverflow:I,textPadding:L=8,title:R,pointerSize:k=12,pathFilter:P="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=i;super(t,{x:{value:a!=null&&h!=null?null:r,scale:"x",optional:!0},y:{value:u!=null&&p!=null?null:o,scale:"y",optional:!0},x1:{value:a,scale:"x",optional:h==null},y1:{value:u,scale:"y",optional:p==null},x2:{value:h,scale:"x",optional:a==null},y2:{value:p,scale:"y",optional:u==null},title:{value:R,optional:!0}},i,qy),this.anchor=o_(c,"anchor"),this.preferredAnchor=o_(f,"preferredAnchor"),this.frameAnchor=z1(M),this.textAnchor=Ns(S,"middle"),this.textPadding=+L,this.pointerSize=+k,this.pathFilter=xo(P),this.lineHeight=+E,this.lineWidth=+x,this.textOverflow=O7(I),this.monospace=!!g,this.fontFamily=xo(m),this.fontSize=Pr(v),this.fontStyle=xo(A),this.fontVariant=xo(y),this.fontWeight=xo(C);for(const F in qy)F in this.channels&&(this[F]=qy[F]);this.splitLines=k7(this),this.clipLine=U7(this),this.format={...w}}render(t,i,r,o,a){const h=this,{x:u,y:p,fx:c,fy:f}=i,{ownerSVGElement:g,document:m}=a,{anchor:v,monospace:A,lineHeight:y,lineWidth:C}=this,{textPadding:E,pointerSize:x,pathFilter:M}=this,{marginTop:w,marginLeft:S}=o,{x1:I,y1:L,x2:R,y2:k,x:P=I??R,y:F=L??k}=r,O=c?c(t.fx)-S:0,W=f?f(t.fy)-w:0,[V,$]=Nm(this,o),H=E7(r,V),Y=w7(r,$),Q=A?cw:lw,G=Q(vf);let J,K;"title"in r?(J=r.channels,K=Eee):(J=_ee.call(this,r,i),K=wee);const se=ys("svg:g",a).call(ca,this,o,a).call(F7,this).call(Bo,this,{x:P&&u,y:F&&p}).call(Me=>Me.selectAll().data(t).enter().append("g").attr("transform",de=>`translate(${Math.round(H(de))},${Math.round(Y(de))})`).call(ua,this).call(de=>de.append("path").attr("filter",M)).call(de=>de.append("text").each(function(Pe){const Se=gp(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const Le=K.call(h,Pe,t,J,i,r);if(typeof Le=="string")for(const be of h.splitLines(Le))ue(Se,{value:h.clipLine(be)});else{const be=new Set;for(const je of Le){const{label:Te=""}=je;Te&&be.has(Te)||(be.add(Te),ue(Se,je))}}})));function ue(Me,{label:de,value:Pe,color:Se,opacity:Le}){de??(de=""),Pe??(Pe="");const be=Se!=null||Le!=null;let je,Te=C*100;const[rt]=zf(de,Te,Q,G);if(rt>=0)de=de.slice(0,rt).trimEnd()+vf,je=Pe.trim(),Pe="";else{(de||!Pe&&!be)&&(Pe=" "+Pe);const[vt]=zf(Pe,Te-Q(de),Q,G);vt>=0&&(je=Pe.trim(),Pe=Pe.slice(0,vt).trimEnd()+vf)}const mt=Me.append("tspan").attr("x",0).attr("dy",`${y}em`).text("");de&&mt.append("tspan").attr("font-weight","bold").text(de),Pe&&mt.append(()=>m.createTextNode(Pe)),be&&mt.append("tspan").text(" ").attr("fill",Se).attr("fill-opacity",Le).style("user-select","none"),je&&mt.append("title").text(je)}function he(){const{width:Me,height:de}=o.facet??o;se.selectChildren().each(function(Pe){let{x:Se,width:Le,height:be}=this.getBBox();Le=Math.round(Le),be=Math.round(be);let je=v;if(je===void 0){const mt=H(Pe)+O,vt=Y(Pe)+W,ft=mt+Le+x+E*2<Me,Ze=mt-Le-x-E*2>0,St=vt+be+x+E*2<de,$t=vt-be-x-E*2>0;je=ft&&Ze?St&&$t?h.preferredAnchor:$t?"bottom":"top":St&&$t?ft?"left":"right":(ft||Ze)&&(St||$t)?`${$t?"bottom":"top"}-${ft?"left":"right"}`:h.preferredAnchor}const Te=this.firstChild,rt=this.lastChild;if(Te.setAttribute("d",yee(je,x,E,Le,be)),Se)for(const mt of rt.childNodes)mt.setAttribute("x",-Se);rt.setAttribute("y",`${+vee(je,rt.childNodes.length,y).toFixed(6)}em`),rt.setAttribute("transform",`translate(${bee(je,x,E,Le,be)})`)}),se.attr("visibility",null)}return t.length&&(se.attr("visibility","hidden"),g.isConnected?Promise.resolve().then(he):typeof requestAnimationFrame<"u"&&requestAnimationFrame(he)),se.node()}}function gee(e,{x:t,y:i,...r}={}){return r.frameAnchor===void 0&&([t,i]=id(t,i)),new Aee(e,{...r,x:t,y:i})}function vee(e,t,i){return/^top(?:-|$)/.test(e)?.94-i:-.29-t*i}function bee(e,t,i,r,o){switch(e){case"middle":return[-r/2,o/2];case"top-left":return[i,t+i];case"top":return[-r/2,t/2+i];case"top-right":return[-r-i,t+i];case"right":return[-t/2-r-i,o/2];case"bottom-left":return[i,-t-i];case"bottom":return[-r/2,-t/2-i];case"bottom-right":return[-r-i,-t-i];case"left":return[i+t/2,o/2]}}function yee(e,t,i,r,o){const a=r+i*2,h=o+i*2;switch(e){case"middle":return`M${-a/2},${-h/2}h${a}v${h}h${-a}z`;case"top-left":return`M0,0l${t},${t}h${a-t}v${h}h${-a}z`;case"top":return`M0,0l${t/2},${t/2}h${(a-t)/2}v${h}h${-a}v${-h}h${(a-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-a}v${h}h${a}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-h/2}h${-a}v${h}h${a}v${t/2-h/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${a-t}v${-h}h${-a}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(a-t)/2}v${-h}h${-a}v${h}h${(a-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-a}v${-h}h${a}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-h/2}h${a}v${h}h${-a}v${t/2-h/2}z`}}function _ee({channels:e},t){var o,a;const i={};let r=this.format;r=aT(r,e,"x"),r=aT(r,e,"y"),this.format=r;for(const h in r){const u=r[h];if(!(u===null||u===!1))if(h==="fx"||h==="fy")i[h]=!0;else{const p=OS(e,h);p&&(i[h]=p)}}for(const h in e){if(h in i||h in r||mee.has(h))continue;const u=OS(e,h);u&&(i[h]=u)}this.facet&&(t.fx&&!("fx"in r)&&(i.fx=!0),t.fy&&!("fy"in r)&&(i.fy=!0));for(const h in i){const u=this.format[h];if(typeof u=="string"){const p=((o=i[h])==null?void 0:o.value)??((a=t[h])==null?void 0:a.domain())??[];this.format[h]=(Ho(p)?Em:td)(u)}else if(u===void 0||u===!0){const p=t[h];this.format[h]=p!=null&&p.bandwidth?uw(p,p.domain()):oh}}return i}function aT(e,t,i){if(!(i in e))return e;const r=`${i}1`,o=`${i}2`;if((r in e||!(r in t))&&(o in e||!(o in t)))return e;const a=Object.entries(e),h=e[i];return a.splice(a.findIndex(([u])=>u===i)+1,0,[r,h],[o,h]),Object.fromEntries(a)}function Eee(e,t,{title:i}){return oh(i.value[e],e)}function*wee(e,t,i,r,o){for(const a in i){if(a==="fx"||a==="fy"){yield{label:Yg(r,i,a),value:this.format[a](t[a],e)};continue}if(a==="x1"&&"x2"in i||a==="y1"&&"y2"in i)continue;const h=i[a];if(a==="x2"&&"x1"in i)yield{label:cT(r,i,"x"),value:lT(this.format.x2,i.x1,h,e)};else if(a==="y2"&&"y1"in i)yield{label:cT(r,i,"y"),value:lT(this.format.y2,i.y1,h,e)};else{const u=h.value[e],p=h.scale;if(!tu(u)&&p==null)continue;yield{label:Yg(r,i,a),value:this.format[a](u,e),color:p==="color"?o[a][e]:null,opacity:p==="opacity"?o[a][e]:null}}}}function lT(e,t,i,r){var o;return(o=i.hint)!=null&&o.length?`${e(i.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}${e(i.value[r],r)}`}function cT(e,t,i){const r=Yg(e,t,`${i}1`,i),o=Yg(e,t,`${i}2`,i);return r===o?r:`${r}${o}`}function Yg(e,t,i,r=i){const o=t[i],a=e[(o==null?void 0:o.scale)??i];return String((a==null?void 0:a.label)??(o==null?void 0:o.label)??r)}function Ji(e={}){var G;const{facet:t,style:i,title:r,subtitle:o,caption:a,ariaLabel:h,ariaDescription:u}=e,p=ew(e.className),c=e.marks===void 0?[]:hT(e.marks);c.push(...Ree(c));const f=Iee(t,e),g=new Map;for(const J of c){const K=fT(J,f,e);K&&g.set(J,K)}const m=new Map;f&&tp(m,[f],e),tp(m,g,e);const v=hT(Lee(c,m,e));for(const J of v){const K=fT(J,f,e);K&&g.set(J,K)}c.unshift(...v);let A=qJ(m,e);if(A!==void 0){const J=f?$y(A,f):void 0;for(const se of c){if(se.facet===null||se.facet==="super")continue;const ue=g.get(se);ue!==void 0&&(ue.facetsIndex=se.fx!=null||se.fy!=null?$y(A,ue):J)}const K=new Set;for(const{facetsIndex:se}of g.values())se==null||se.forEach((ue,he)=>{(ue==null?void 0:ue.length)>0&&K.add(he)});A.forEach(0<K.size&&K.size<A.length?(se,ue)=>se.empty=!K.has(ue):se=>se.empty=!1);for(const se of c)if(se.facet==="exclude"){const ue=g.get(se);ue!==void 0&&(ue.facetsIndex=eZ(ue.facetsIndex))}}for(const J of us.keys())s_(e[J])&&J!=="fx"&&J!=="fy"&&m.set(J,[]);const y=new Map;for(const J of c){if(y.has(J))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:K,channels:se}=g.get(J)??{},{data:ue,facets:he,channels:Me}=J.initialize(K,se,e);hw(Me,e),y.set(J,{data:ue,facets:he,channels:Me})}const C=u_(tp(m,y,e),e),E=KJ(C,c,e);wJ(C,E);const x=zS(C),{fx:M,fy:w}=x,S=M||w?p7(C,E):E,I=M||w?Uee(x,E):E,L=KE(e),R=L.document,k=A1("svg").call(R.documentElement);let P=k;L.ownerSVGElement=k,L.className=p,L.projection=Oq(e,S),L.filterFacets=(J,K)=>$y(A,{channels:K,groups:nw(J,K)}),L.getMarkState=J=>{const K=y.get(J),se=g.get(J);return{...K,channels:{...K.channels,...se==null?void 0:se.channels}}},L.dispatchValue=J=>{P.value!==J&&(P.value=J,P.dispatchEvent(new Event("input",{bubbles:!0})))};const F=new Set;for(const[J,K]of y)if(J.initializer!=null){const se=J.facet==="super"?I:S,ue=J.initializer(K.data,K.facets,K.channels,x,se,L);if(ue.data!==void 0&&(K.data=ue.data),ue.facets!==void 0&&(K.facets=ue.facets),ue.channels!==void 0){const{fx:he,fy:Me,...de}=ue.channels;Tee(de),Object.assign(K.channels,de);for(const Pe of Object.values(de)){const{scale:Se}=Pe;Se!=null&&!rq(us.get(Se))&&(hL(Pe,e),F.add(Se))}(he!=null||Me!=null)&&g.set(J,!0)}}if(F.size){const J=new Map;tp(J,y,e,he=>F.has(he)),tp(m,y,e,he=>F.has(he));const K=kee(u_(J,e),C),{scales:se,...ue}=zS(K);Object.assign(C,K),Object.assign(x,ue),Object.assign(x.scales,se)}let O,W;A!==void 0&&(O={x:M==null?void 0:M.domain(),y:w==null?void 0:w.domain()},A=JJ(A,O),W=ZJ(M,w,E));for(const[J,K]of y)K.values=J.scale(K.channels,x,L);const{width:V,height:$}=E;gp(k).attr("class",p).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",V).attr("height",$).attr("viewBox",`0 0 ${V} ${$}`).attr("aria-label",h).attr("aria-description",u).call(J=>J.append("style").text(`:where(.${p}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${p} text),
:where(.${p} tspan) {
  white-space: pre;
}`)).call(tw,i);for(const J of c){const{channels:K,values:se,facets:ue}=y.get(J);if(A===void 0||J.facet==="super"){let he=null;if(ue&&(he=ue[0],he=J.filter(he,K,se),he.length===0))continue;const Me=J.render(he,x,se,I,L);if(Me==null)continue;k.appendChild(Me)}else{let he;for(const Me of A){if(!(((G=J.facetAnchor)==null?void 0:G.call(J,A,O,Me))??!Me.empty))continue;let de=null;if(ue){const Se=g.has(J);if(de=ue[Se?Me.i:0],de=J.filter(de,K,se),de.length===0)continue;!Se&&de===ue[0]&&(de=jY(de)),de.fx=Me.x,de.fy=Me.y,de.fi=Me.i}const Pe=J.render(de,x,se,S,L);if(Pe!=null){(he??(he=gp(k).append("g"))).append(()=>Pe).datum(Me);for(const Se of["aria-label","aria-description","aria-hidden","transform"])Pe.hasAttribute(Se)&&(he.attr(Se,Pe.getAttribute(Se)),Pe.removeAttribute(Se))}}he==null||he.selectChildren().attr("transform",W)}}const H=uee(C,L,e),{figure:Y=r!=null||o!=null||a!=null||H.length>0}=e;Y&&(P=R.createElement("figure"),P.className=`${p}-figure`,P.style.maxWidth="initial",r!=null&&P.append(uT(R,r,"h2")),o!=null&&P.append(uT(R,o,"h3")),P.append(...H,k),a!=null&&P.append(Cee(R,a))),P.scale=RJ(x.scales),P.legend=aee(C,L,e);const Q=Nq();return Q>0&&gp(k).append("text").attr("x",V).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("").append("title").text(`${Q.toLocaleString("en-US")} warning${Q===1?"":"s"}. Please check the console.`),P}function uT(e,t,i){if(t.ownerDocument)return t;const r=e.createElement(i);return r.append(t),r}function Cee(e,t){const i=e.createElement("figcaption");return i.append(t),i}function xee({marks:e=[],...t}={}){return Ji({...t,marks:[...e,this]})}mo.prototype.plot=xee;function hT(e){return e.flat(1/0).filter(t=>t!=null).map(Mee)}function Mee(e){return typeof e.render=="function"?e:new See(e)}class See extends mo{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function hw(e,t){for(const i in e)hL(e[i],t);return e}function hL(e,t){const{scale:i,transform:r=!0}=e;if(i==null||!r)return;const{type:o,percent:a,interval:h,transform:u=a?p=>p*100:O8(h,o)}=t[i]??{};u!=null&&(e.value=Os(e.value,u),e.transform=!1)}function Tee(e){for(const t in e)q8(t,e[t])}function tp(e,t,i,r=QY){var o,a;for(const{channels:h}of t.values())for(const u in h){const p=h[u],{scale:c}=p;if(c!=null&&r(c))if(c==="projection"){if(!Gq(i)){const f=((o=i.x)==null?void 0:o.domain)===void 0,g=((a=i.y)==null?void 0:a.domain)===void 0;if(f||g){const[m,v]=Qq(p);f&&Jy(e,"x",m),g&&Jy(e,"y",v)}}}else Jy(e,c,p)}return e}function Jy(e,t,i){const r=e.get(t);r!==void 0?r.push(i):e.set(t,[i])}function Iee(e,t){if(e==null)return;const{x:i,y:r}=e;if(i==null&&r==null)return;const o=la(e.data);if(o==null)throw new Error("missing facet data");const a={};i!=null&&(a.fx=Wp(o,{value:i,scale:"fx"})),r!=null&&(a.fy=Wp(o,{value:r,scale:"fy"})),hw(a,t);const h=nw(o,a);return{channels:a,groups:h,data:e.data}}function fT(e,t,i){var p;if(e.facet===null||e.facet==="super")return;const{fx:r,fy:o}=e;if(r!=null||o!=null){const c=la(e.data??r??o);if(c===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(c===null)return;const f={};return r!=null&&(f.fx=Wp(c,{value:r,scale:"fx"})),o!=null&&(f.fy=Wp(c,{value:o,scale:"fy"})),hw(f,i),{channels:f,groups:nw(c,f)}}if(t===void 0)return;const{channels:a,groups:h,data:u}=t;if(e.facet!=="auto"||e.data===u)return{channels:a,groups:h};u.length>0&&(h.size>1||h.size===1&&a.fx&&a.fy&&[...h][0][1].size>1)&&((p=la(e.data))==null?void 0:p.length)===u.length&&Xc(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isnt faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function Bee(e,t={}){return Hf({...t,x:null,y:null},(i,r,o,a,h,u)=>u.getMarkState(e))}function Ree(e){const t=[];for(const i of e){let r=i.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:o,preferredAnchor:a}=r;o=/^x$/i.test(o)?fZ:/^y$/i.test(o)?ZS:hZ,r=o(Bee(i,r)),r.title=null,a===void 0&&(r.preferredAnchor=o===ZS?"left":"bottom");const h=gee(i.data,r);h.facet=i.facet,h.facetAnchor=i.facetAnchor,t.push(h)}}return t}function Lee(e,t,i){let{projection:r,x:o={},y:a={},fx:h={},fy:u={},axis:p,grid:c,facet:f={},facet:{axis:g=p,grid:m}=f,x:{axis:v=p,grid:A=v===null?null:c}=o,y:{axis:y=p,grid:C=y===null?null:c}=a,fx:{axis:E=g,grid:x=E===null?null:m}=h,fy:{axis:M=g,grid:w=M===null?null:m}=u}=i;(r||!s_(o)&&!dT("x",e))&&(v=A=null),(r||!s_(a)&&!dT("y",e))&&(y=C=null),t.has("fx")||(E=x=null),t.has("fy")||(M=w=null),v===void 0&&(v=!VA(e,"x")),y===void 0&&(y=!VA(e,"y")),E===void 0&&(E=!VA(e,"fx")),M===void 0&&(M=!VA(e,"fy")),v===!0&&(v="bottom"),y===!0&&(y="left"),E===!0&&(E=v==="top"||v===null?"bottom":"top"),M===!0&&(M=y==="right"||y===null?"left":"right");const S=[];return GA(S,w,qZ,u),UA(S,M,zZ,"right","left",f,u),GA(S,x,ZZ,h),UA(S,E,jZ,"top","bottom",f,h),GA(S,C,YZ,a),UA(S,y,K7,"left","right",i,a),GA(S,A,JZ,o),UA(S,v,Y7,"bottom","top",i,o),S}function UA(e,t,i,r,o,a,h){if(!t)return;const u=Pee(t);h=Dee(u?r:t,a,h);const{line:p}=h;(i===K7||i===Y7)&&p&&!jp(p)&&e.push(pee(Nee(h))),e.push(i(h)),u&&e.push(i({...h,anchor:o,label:null}))}function GA(e,t,i,r){!t||jp(t)||e.push(i(Oee(t,r)))}function Pee(e){return/^\s*both\s*$/i.test(e)}function Dee(e,t,{line:i=t.line,ticks:r,tickSize:o,tickSpacing:a,tickPadding:h,tickFormat:u,tickRotate:p,fontVariant:c,ariaLabel:f,ariaDescription:g,label:m=t.label,labelAnchor:v,labelArrow:A=t.labelArrow,labelOffset:y}){return{anchor:e,line:i,ticks:r,tickSize:o,tickSpacing:a,tickPadding:h,tickFormat:u,tickRotate:p,fontVariant:c,ariaLabel:f,ariaDescription:g,label:m,labelAnchor:v,labelArrow:A,labelOffset:y}}function Nee(e){const{anchor:t,line:i}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:i===!0?void 0:i}}function Oee(e,{stroke:t=H1(e)?e:void 0,ticks:i=Fee(e)?e:void 0,tickSpacing:r,ariaLabel:o,ariaDescription:a}){return{stroke:t,ticks:i,tickSpacing:r,ariaLabel:o,ariaDescription:a}}function Fee(e){switch(typeof e){case"number":return!0;case"string":return!H1(e)}return su(e)||typeof(e==null?void 0:e.range)=="function"}function VA(e,t){const i=`${t}-axis `;return e.some(r=>{var o;return(o=r.ariaLabel)==null?void 0:o.startsWith(i)})}function dT(e,t){for(const i of t)for(const r in i.channels){const{scale:o}=i.channels[r];if(o===e||o==="projection")return!0}return!1}function kee(e,t){for(const i in e){const r=e[i],o=t[i];r.label===void 0&&o&&(r.label=o.label)}return e}function Uee({fx:e,fy:t},i){const{marginTop:r,marginRight:o,marginBottom:a,marginLeft:h,width:u,height:p}=ZE(i),c=e&&pT(e),f=t&&pT(t);return{marginTop:t?f[0]:r,marginRight:e?u-c[1]:o,marginBottom:t?p-f[1]:a,marginLeft:e?c[0]:h,inset:{marginTop:i.marginTop,marginRight:i.marginRight,marginBottom:i.marginBottom,marginLeft:i.marginLeft},width:u,height:p}}function pT(e){const t=e.domain();let i=e(t[0]),r=e(t[t.length-1]);return r<i&&([i,r]=[r,i]),[i,r+e.bandwidth()]}const Gee=new Map([["basis",T$],["basis-closed",I$],["basis-open",B$],["bundle",R$],["bump-x",g$],["bump-y",v$],["cardinal",L$],["cardinal-closed",P$],["cardinal-open",D$],["catmull-rom",N$],["catmull-rom-closed",O$],["catmull-rom-open",F$],["linear",wm],["linear-closed",k$],["monotone-x",U$],["monotone-y",G$],["natural",V$],["step",Q$],["step-after",z$],["step-before",H$]]);function fL(e=wm,t){if(typeof e=="function")return e;const i=Gee.get(`${e}`.toLowerCase());if(!i)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in i)return i.beta(t);if("tension"in i)return i.tension(t);if("alpha"in i)return i.alpha(t)}return i}function dL(e=jf,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?jf:fL(e,t)}function jf(e){return wm(e)}function ev(e={y:"count"},t={}){[e,t]=zee(e,t);const{x:i,y:r}=t;return Hee(jee(i,t,fs),null,null,r,e,q1(t))}function Vee(e,t,i={}){if((i==null?void 0:i.interval)==null)return i;const{reduce:r=XE}=i,o={filter:null};return i[t]!=null&&(o[t]=r),i[`${t}1`]!=null&&(o[`${t}1`]=r),i[`${t}2`]!=null&&(o[`${t}2`]=r),e(o,i)}function Qee(e={}){return Vee(ev,"y",Om(e,"x"))}function Hee(e,t,i,r,{data:o=$E,filter:a=Kg,sort:h,reverse:u,...p}={},c={}){e=mT(e),t=mT(t),p=$ee(p,c),o=AL(o,fs),h=h==null?void 0:pL("sort",h,c),a=a==null?void 0:mL("filter",a,c),r!=null&&Cp(p,"y","y1","y2")&&(r=null);const[f,g]=Uo(e),[m,v]=Uo(e),[A,y]=Uo(t),[C,E]=Uo(t),[x,M]=r!=null?[r,"y"]:[],[w,S]=Uo(x),{x:I,y:L,z:R,fill:k,stroke:P,x1:F,x2:O,y1:W,y2:V,domain:$,cumulative:H,thresholds:Y,interval:Q,...G}=c,[J,K]=Uo(R),[se]=Za(k),[ue]=Za(P),[he,Me]=Uo(se),[de,Pe]=Uo(ue);return{..."z"in c&&{z:J||R},..."fill"in c&&{fill:he||k},..."stroke"in c&&{stroke:de||P},...mh(G,(Se,Le,be)=>{const je=Xg(Xr(Se,x),be==null?void 0:be[M]),Te=Xr(Se,R),rt=Xr(Se,se),mt=Xr(Se,ue),vt=X8(p,{z:Te,fill:rt,stroke:mt}),ft=[],Ze=[],St=je&&S([]),$t=Te&&K([]),ct=rt&&Me([]),Ct=mt&&Pe([]),Tt=e&&g([]),At=e&&v([]),pn=t&&y([]),yt=t&&E([]),kn=Yee(e,t,Se);let qn=0;for(const Gt of p)Gt.initialize(Se);h&&h.initialize(Se),a&&a.initialize(Se);for(const Gt of Le){const bt=[];for(const ye of p)ye.scope("facet",Gt);h&&h.scope("facet",Gt),a&&a.scope("facet",Gt);for(const[ye,_e]of xp(Gt,vt))for(const[Ue,Re]of xp(_e,je))for(const[Ce,Ne]of kn(Re))if(vt&&(Ne.z=ye),!(a&&!a.reduce(Ce,Ne))){bt.push(qn++),Ze.push(o.reduceIndex(Ce,Se,Ne)),je&&St.push(Ue),Te&&$t.push(vt===Te?ye:Te[(Ce.length>0?Ce:Re)[0]]),rt&&ct.push(vt===rt?ye:rt[(Ce.length>0?Ce:Re)[0]]),mt&&Ct.push(vt===mt?ye:mt[(Ce.length>0?Ce:Re)[0]]),Tt&&(Tt.push(Ne.x1),At.push(Ne.x2)),pn&&(pn.push(Ne.y1),yt.push(Ne.y2));for(const le of p)le.reduce(Ce,Ne);h&&h.reduce(Ce,Ne)}ft.push(bt)}return K8(ft,h,u),{data:Ze,facets:ft}}),...!Cp(p,"x")&&(f?{x1:f,x2:m,x:$g(f,m)}:{x:I,x1:F,x2:O}),...!Cp(p,"y")&&(A?{y1:A,y2:C,y:$g(A,C)}:{y:L,y1:W,y2:V}),...w&&{[M]:w},...Object.fromEntries(p.map(({name:Se,output:Le})=>[Se,Le]))}}function zee({cumulative:e,domain:t,thresholds:i,interval:r,...o},a){return[o,{cumulative:e,domain:t,thresholds:i,interval:r,...a}]}function jee(e,{cumulative:t,domain:i,thresholds:r,interval:o},a){return e={...Im(e)},e.domain===void 0&&(e.domain=i),e.cumulative===void 0&&(e.cumulative=t),e.thresholds===void 0&&(e.thresholds=r),e.interval===void 0&&(e.interval=o),e.value===void 0&&(e.value=a),e.thresholds=Wee(e.thresholds,e.interval),e}function mT(e){if(e==null)return;const{value:t,cumulative:i,domain:r=Ms,thresholds:o}=e,a=h=>{let u=Xr(h,t),p;if(Ho(u)||Kee(o)){u=Os(u,R8,Float64Array);let[f,g]=typeof r=="function"?r(u):r,m=typeof o=="function"&&!hf(o)?o(u,f,g):o;typeof m=="number"&&(m=F5(f,g,m)),hf(m)&&(r===Ms&&(f=m.floor(f),g=m.offset(m.floor(g))),m=m.range(f,m.offset(g))),p=m}else{u=vl(u);let[f,g]=typeof r=="function"?r(u):r,m=typeof o=="function"&&!hf(o)?o(u,f,g):o;if(typeof m=="number")if(r===Ms){let v=Zu(f,g,m);if(isFinite(v))if(v>0){let A=Math.round(f/v),y=Math.round(g/v);A*v<=f||--A,y*v>g||++y;let C=y-A+1;m=new Float64Array(C);for(let E=0;E<C;++E)m[E]=(A+E)*v}else if(v<0){v=-v;let A=Math.round(f*v),y=Math.round(g*v);A/v<=f||--A,y/v>g||++y;let C=y-A+1;m=new Float64Array(C);for(let E=0;E<C;++E)m[E]=(A+E)/v}else m=[f];else m=[f]}else m=Mf(f,g,m);else hf(m)&&(r===Ms&&(f=m.floor(f),g=m.offset(m.floor(g))),m=m.range(f,m.offset(g)));p=m}const c=[];if(p.length===1)c.push([p[0],p[0]]);else for(let f=1;f<p.length;++f)c.push([p[f-1],p[f]]);return c.bin=(i<0?Jee:i>0?qee:fw)(c,p,u),c};return a.label=ph(t),a}function Wee(e,t,i=AT){if(e===void 0)return t===void 0?i:rd(t);if(typeof e=="string"){switch(e.toLowerCase()){case"freedman-diaconis":return lG;case"scott":return j4;case"sturges":return V4;case"auto":return AT}return DE(e)}return e}function $ee(e,t){return z8(e,t,pL)}function pL(e,t,i){return jE(e,t,i,mL)}function mL(e,t,i){return WE(e,t,i,AL)}function AL(e,t){return W1(e,t,Xee)}function Xee(e){switch(`${e}`.toLowerCase()){case"x":return Zee;case"x1":return tte;case"x2":return nte;case"y":return ete;case"y1":return ite;case"y2":return rte;case"z":return Y8}throw new Error(`invalid bin reduce: ${e}`)}function AT(e,t,i){return Math.min(200,j4(e,t,i))}function Kee(e){return XY(e)||su(e)&&Ho(e)}function Yee(e,t,i){const r=e==null?void 0:e(i),o=t==null?void 0:t(i);return r&&o?function*(a){const h=r.bin(a);for(const[u,[p,c]]of r.entries()){const f=o.bin(h[u]);for(const[g,[m,v]]of o.entries())yield[f[g],{data:i,x1:p,y1:m,x2:c,y2:v}]}}:r?function*(a){const h=r.bin(a);for(const[u,[p,c]]of r.entries())yield[h[u],{data:i,x1:p,x2:c}]}:function*(a){const h=o.bin(a);for(const[u,[p,c]]of o.entries())yield[h[u],{data:i,y1:p,y2:c}]}}function fw(e,t,i){return t=vl(t),r=>{var a;const o=e.map(()=>[]);for(const h of r)(a=o[lm(t,i[h])-1])==null||a.push(h);return o}}function qee(e,t,i){const r=fw(e,t,i);return o=>{const a=r(o);for(let h=1,u=a.length;h<u;++h){const p=a[h-1],c=a[h];for(const f of p)c.push(f)}return a}}function Jee(e,t,i){const r=fw(e,t,i);return o=>{const a=r(o);for(let h=a.length-2;h>=0;--h){const u=a[h+1],p=a[h];for(const c of u)p.push(c)}return a}}function gL(e,t){const i=(+e+ +t)/2;return e instanceof Date?new Date(i):i}const Zee={reduceIndex(e,t,{x1:i,x2:r}){return gL(i,r)}},ete={reduceIndex(e,t,{y1:i,y2:r}){return gL(i,r)}},tte={reduceIndex(e,t,{x1:i}){return i}},nte={reduceIndex(e,t,{x2:i}){return i}},ite={reduceIndex(e,t,{y1:i}){return i}},rte={reduceIndex(e,t,{y2:i}){return i}};function ste(e={}){return P8(e)?e:{...e,x:fs}}function dw(e={}){return D8(e)?e:{...e,y:fs}}function ote(e,t){if(t.length===1)return{data:e,facets:t};const i=e.length,r=new Uint8Array(i);let o=0;for(const u of t)for(const p of u)r[p]&&++o,r[p]=1;if(o===0)return{data:e,facets:t};e=zp(e);const a=e[T8]=new Uint32Array(i+o);t=t.map(u=>zp(u,Uint32Array));let h=i;r.fill(0);for(const u of t)for(let p=0,c=u.length;p<c;++p){const f=u[p];r[f]?(u[p]=h,e[h]=e[f],a[h]=f,++h):a[f]=f,r[f]=1}return{data:e,facets:t}}function ate(e={},t={}){arguments.length===1&&([e,t]=vL(e));const{y1:i,y:r=i,x:o,...a}=t,[h,u,p,c]=bL(r,o,"y","x",e,a);return{...h,y1:i,y:u,x1:p,x2:c,x:$g(p,c)}}function lte(e={},t={}){arguments.length===1&&([e,t]=vL(e));const{x1:i,x:r=i,y:o,...a}=t,[h,u,p,c]=bL(r,o,"x","y",e,a);return{...h,x1:i,x:u,y1:p,y2:c,y:$g(p,c)}}function cte({x:e,x1:t,x2:i,...r}={}){return r=Om(r,"y"),t===void 0&&i===void 0?ate({x:e,...r}):([t,i]=N8(e,t,i),{...r,x1:t,x2:i})}function pw({y:e,y1:t,y2:i,...r}={}){return r=Om(r,"x"),t===void 0&&i===void 0?lte({y:e,...r}):([t,i]=N8(e,t,i),{...r,y1:t,y2:i})}function vL(e){const{offset:t,order:i,reverse:r,...o}=e;return[{offset:t,order:i,reverse:r},o]}const ute={length:!0};function bL(e,t=NE,i,r,{offset:o,order:a,reverse:h},u){if(t===null)throw new Error(`stack requires ${r}`);const p=kE(u),[c,f]=Uo(e),[g,m]=$a(t),[v,A]=$a(t);return g.hint=v.hint=ute,o=hte(o),a=pte(a,o,r),[mh(u,(y,C,E)=>{({data:y,facets:C}=ote(y,C));const x=e==null?void 0:f(Xg(Xr(y,e),E==null?void 0:E[i])),M=Xr(y,t,Float64Array),w=Xr(y,p),S=a&&a(y,x,M,w),I=y.length,L=m(new Float64Array(I)),R=A(new Float64Array(I)),k=[];for(const P of C){const F=x?Array.from(d1(P,O=>x[O]).values()):[P];if(S)for(const O of F)O.sort(S);for(const O of F){let W=0,V=0;h&&O.reverse();for(const $ of O){const H=M[$];H<0?W=R[$]=(L[$]=W)+H:H>0?V=R[$]=(L[$]=V)+H:R[$]=L[$]=V}}k.push(F)}return o&&o(k,L,R,w),{data:y,facets:C}}),c,g,v]}function hte(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return fte;case"center":case"silhouette":return dte;case"wiggle":return _L}throw new Error(`unknown offset: ${e}`)}}function yL(e,t){let i=0,r=0;for(const o of e){const a=t[o];a<i&&(i=a),a>r&&(r=a)}return[i,r]}function fte(e,t,i){for(const r of e)for(const o of r){const[a,h]=yL(o,i);for(const u of o){const p=1/(h-a||1);t[u]=p*(t[u]-a),i[u]=p*(i[u]-a)}}}function dte(e,t,i){for(const r of e){for(const o of r){const[a,h]=yL(o,i);for(const u of o){const p=(h+a)/2;t[u]-=p,i[u]-=p}}EL(r,t,i)}wL(e,t,i)}function _L(e,t,i,r){for(const o of e){const a=new Ju;let h=0;for(const u of o){let p=-1;const c=u.map(v=>Math.abs(i[v]-t[v])),f=u.map(v=>{p=r?r[v]:++p;const A=i[v]-t[v],y=a.has(p)?A-a.get(p):0;return a.set(p,A),y}),g=[0,...qU(f)];for(const v of u)t[v]+=h,i[v]+=h;const m=Kc(c);m&&(h-=Kc(c,(v,A)=>(f[A]/2+g[A])*v)/m)}EL(o,t,i)}wL(e,t,i)}function EL(e,t,i){const r=So(e,o=>So(o,a=>t[a]));for(const o of e)for(const a of o)t[a]-=r,i[a]-=r}function wL(e,t,i){const r=e.length;if(r===1)return;const o=e.map(u=>u.flat()),a=o.map(u=>(So(u,p=>t[p])+Zr(u,p=>i[p]))/2),h=So(a);for(let u=0;u<r;u++){const p=h-a[u];for(const c of o[u])t[c]+=p,i[c]+=p}}function pte(e,t,i){if(e===void 0&&t===_L)return gT(Ia);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),o=r?Wg:Ia;switch((r?e.slice(1):e).toLowerCase()){case"value":case i:return mte(o);case"z":return Ate(o);case"sum":return gte(o);case"appearance":return vte(o);case"inside-out":return gT(o)}return vT(I8(e))}if(typeof e=="function")return(e.length===1?vT:bte)(e);if(Array.isArray(e))return yte(e);throw new Error(`invalid order: ${e}`)}}function mte(e){return(t,i,r)=>(o,a)=>e(r[o],r[a])}function Ate(e){return(t,i,r,o)=>(a,h)=>e(o[a],o[h])}function gte(e){return tv(e,(t,i,r,o)=>Q_(gc(t),a=>Kc(a,h=>r[h]),a=>o[a]))}function vte(e){return tv(e,(t,i,r,o)=>Q_(gc(t),a=>i[z4(a,h=>r[h])],a=>o[a]))}function gT(e){return tv(e,(t,i,r,o)=>{const a=gc(t),h=Q_(a,g=>i[z4(g,m=>r[m])],g=>o[g]),u=mf(a,g=>Kc(g,m=>r[m]),g=>o[g]),p=[],c=[];let f=0;for(const g of h)f<0?(f+=u.get(g),p.push(g)):(f-=u.get(g),c.push(g));return c.reverse().concat(p)})}function vT(e){return t=>{const i=Xr(t,e);return(r,o)=>Ia(i[r],i[o])}}function bte(e){return t=>(i,r)=>e(t[i],t[r])}function yte(e){return tv(Ia,()=>e)}function tv(e,t){return(i,r,o,a)=>{if(!a)throw new Error("missing channel: z");const h=new Ju(t(i,r,o,a).map((u,p)=>[u,p]));return(u,p)=>e(h.get(a[u]),h.get(a[p]))}}const _te={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Ete extends mo{constructor(t,i={}){const{x1:r,y1:o,x2:a,y2:h,z:u,curve:p,tension:c}=i;super(t,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:a,scale:"x",optional:!0},y2:{value:h,scale:"y",optional:!0},z:{value:kE(i),optional:!0}},i,_te),this.z=u,this.curve=fL(p,c)}filter(t){return t}render(t,i,r,o,a){const{x1:h,y1:u,x2:p=h,y2:c=u}=r;return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,i,0,0).call(f=>f.selectAll().data(b7(t,[h,u,p,c],this,r)).enter().append("path").call(ua,this).call(v7,this,r).attr("d",A$().curve(this.curve).defined(g=>g>=0).x0(g=>h[g]).y0(g=>u[g]).x1(g=>p[g]).y1(g=>c[g]))).node()}}function mw(e,t){const{x:i=Sm,...r}=Qee(t);return new Ete(e,pw(dw({...r,x1:i,x2:void 0})))}const wte={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Cte extends mo{constructor(t,i={}){const{x1:r,y1:o,x2:a,y2:h,curve:u,tension:p}=i;super(t,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:a,scale:"x",optional:!0},y2:{value:h,scale:"y",optional:!0}},i,wte),this.curve=dL(u,p),Fm(this,i)}project(t,i,r){this.curve!==jf&&super.project(t,i,r)}render(t,i,r,o,a){const{x1:h,y1:u,x2:p=h,y2:c=u}=r,{curve:f}=this;return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,i).call(g=>g.selectAll().data(t).enter().append("path").call(ua,this).attr("d",f===jf&&a.projection?xte(a.projection,h,u,p,c):m=>{const v=jc(),A=f(v);return A.lineStart(),A.point(h[m],u[m]),A.point(p[m],c[m]),A.lineEnd(),v}).call(Il,this,r).call(Y1,this,r,a)).node()}}function xte(e,t,i,r,o){const a=E1(e);return t=vl(t),i=vl(i),r=vl(r),o=vl(o),h=>a({type:"LineString",coordinates:[[t[h],i[h]],[r[h],o[h]]]})}function p_(e,{x:t,x1:i,x2:r,y:o,y1:a,y2:h,...u}={}){return[i,r]=bT(t,i,r),[a,h]=bT(o,a,h),new Cte(e,{...u,x1:i,x2:r,y1:a,y2:h})}function bT(e,t,i){if(e===void 0){if(t===void 0){if(i!==void 0)return[i]}else if(i===void 0)return[t]}else{if(t===void 0)return i===void 0?[e]:[e,i];if(i===void 0)return[e,t]}return[t,i]}class Aw extends mo{constructor(t,i,r={},o){super(t,i,r,o);const{inset:a=0,insetTop:h=a,insetRight:u=a,insetBottom:p=a,insetLeft:c=a,rx:f,ry:g}=r;this.insetTop=Pr(h),this.insetRight=Pr(u),this.insetBottom=Pr(p),this.insetLeft=Pr(c),this.rx=Ns(f,"auto"),this.ry=Ns(g,"auto")}render(t,i,r,o,a){const{rx:h,ry:u}=this;return ys("svg:g",a).call(ca,this,o,a).call(this._transform,this,i).call(p=>p.selectAll().data(t).enter().append("rect").call(ua,this).attr("x",this._x(i,r,o)).attr("width",this._width(i,r,o)).attr("y",this._y(i,r,o)).attr("height",this._height(i,r,o)).call(Mi,"rx",h).call(Mi,"ry",u).call(Il,this,r)).node()}_x(t,{x:i},{marginLeft:r}){const{insetLeft:o}=this;return i?a=>i[a]+o:r+o}_y(t,{y:i},{marginTop:r}){const{insetTop:o}=this;return i?a=>i[a]+o:r+o}_width({x:t},{x:i},{marginRight:r,marginLeft:o,width:a}){const{insetLeft:h,insetRight:u}=this,p=i&&t?t.bandwidth():a-r-o;return Math.max(0,p-h-u)}_height({y:t},{y:i},{marginTop:r,marginBottom:o,height:a}){const{insetTop:h,insetBottom:u}=this,p=i&&t?t.bandwidth():a-r-o;return Math.max(0,p-h-u)}}const CL={ariaLabel:"bar"};class Mte extends Aw{constructor(t,i={}){const{x1:r,x2:o,y:a}=i;super(t,{x1:{value:r,scale:"x"},x2:{value:o,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},i,CL)}_transform(t,i,{x:r}){t.call(Bo,i,{x:r},0,0)}_x({x:t},{x1:i,x2:r},{marginLeft:o}){const{insetLeft:a}=this;return Ma(t)?o+a:h=>Math.min(i[h],r[h])+a}_width({x:t},{x1:i,x2:r},{marginRight:o,marginLeft:a,width:h}){const{insetLeft:u,insetRight:p}=this;return Ma(t)?h-o-a-u-p:c=>Math.max(0,Math.abs(r[c]-i[c])-u-p)}}class Ste extends Aw{constructor(t,i={}){const{x:r,y1:o,y2:a}=i;super(t,{y1:{value:o,scale:"y"},y2:{value:a,scale:"y"},x:{value:r,scale:"x",type:"band",optional:!0}},i,CL)}_transform(t,i,{y:r}){t.call(Bo,i,{y:r},0,0)}_y({y:t},{y1:i,y2:r},{marginTop:o}){const{insetTop:a}=this;return Ma(t)?o+a:h=>Math.min(i[h],r[h])+a}_height({y:t},{y1:i,y2:r},{marginTop:o,marginBottom:a,height:h}){const{insetTop:u,insetBottom:p}=this;return Ma(t)?h-o-a-u-p:c=>Math.max(0,Math.abs(r[c]-i[c])-u-p)}}function km(e,t={}){return FE(t)||(t={...t,y:Sm,x2:fs}),new Mte(e,cte(R7(ste(t))))}function Wf(e,t={}){return FE(t)||(t={...t,x:Sm,y2:fs}),new Ste(e,pw(L7(dw(t))))}const Tte={ariaLabel:"cell"};class Ite extends Aw{constructor(t,{x:i,y:r,...o}={}){super(t,{x:{value:i,scale:"x",type:"band",optional:!0},y:{value:r,scale:"y",type:"band",optional:!0}},o,Tte)}_transform(t,i){t.call(Bo,i,{},0,0)}}function m_(e,{x:t,y:i,...r}={}){return[t,i]=id(t,i),new Ite(e,{...r,x:t,y:i})}const Bte={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Rte(e){return e.sort===void 0&&e.reverse===void 0?fq({channel:"-r"},e):e}class Lte extends mo{constructor(t,i={}){const{x:r,y:o,r:a,rotate:h,symbol:u=Qp,frameAnchor:p}=i,[c,f]=Mo(h,0),[g,m]=uq(u),[v,A]=Mo(a,g==null?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:v,scale:"r",filter:G1,optional:!0},rotate:{value:c,optional:!0},symbol:{value:g,scale:"auto",optional:!0}},Rte(i),Bte),this.r=A,this.rotate=f,this.symbol=m,this.frameAnchor=z1(p);const{channels:y}=this,{symbol:C}=y;if(C){const{fill:E,stroke:x}=y;C.hint={fill:E?E.value===C.value?"color":"currentColor":this.fill??"currentColor",stroke:x?x.value===C.value?"color":"currentColor":this.stroke??"none"}}}render(t,i,r,o,a){const{x:h,y:u}=i,{x:p,y:c,r:f,rotate:g,symbol:m}=r,{r:v,rotate:A,symbol:y}=this,[C,E]=Nm(this,o),x=y===Qp,M=f?void 0:v*v*Math.PI;return RE(v)&&(t=[]),ys("svg:g",a).call(ca,this,o,a).call(Bo,this,{x:p&&h,y:c&&u}).call(w=>w.selectAll().data(t).enter().append(x?"circle":"path").call(ua,this).call(x?S=>{S.attr("cx",p?I=>p[I]:C).attr("cy",c?I=>c[I]:E).attr("r",f?I=>f[I]:v)}:S=>{S.attr("transform",ow`translate(${p?I=>p[I]:C},${c?I=>c[I]:E})${g?I=>` rotate(${g[I]})`:A?` rotate(${A})`:""}`).attr("d",f&&m?I=>{const L=jc();return m[I].draw(L,f[I]*f[I]*Math.PI),L}:f?I=>{const L=jc();return y.draw(L,f[I]*f[I]*Math.PI),L}:m?I=>{const L=jc();return m[I].draw(L,M),L}:(()=>{const I=jc();return y.draw(I,M),I})())}).call(Il,this,r)).node()}}function po(e,{x:t,y:i,...r}={}){return r.frameAnchor===void 0&&([t,i]=id(t,i)),new Lte(e,{...r,x:t,y:i})}const Pte={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Dte extends mo{constructor(t,i={}){const{x:r,y:o,z:a,curve:h,tension:u}=i;super(t,{x:{value:r,scale:"x"},y:{value:o,scale:"y"},z:{value:kE(i),optional:!0}},i,Pte),this.z=a,this.curve=dL(h,u),Fm(this,i)}filter(t){return t}project(t,i,r){this.curve!==jf&&super.project(t,i,r)}render(t,i,r,o,a){const{x:h,y:u}=r,{curve:p}=this;return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,i).call(c=>c.selectAll().data(b7(t,[h,u],this,r)).enter().append("path").call(ua,this).call(v7,this,r).call(gZ,this,r,a).attr("d",p===jf&&a.projection?Nte(a.projection,h,u):r6().curve(p).defined(f=>f>=0).x(f=>h[f]).y(f=>u[f]))).node()}}function Nte(e,t,i){const r=E1(e);return t=vl(t),i=vl(i),o=>{let a=[];const h=[a];for(const u of o)u===-1?(a=[],h.push(a)):a.push([t[u],i[u]]);return r({type:"MultiLineString",coordinates:h})}}function qg(e,{x:t,y:i,...r}={}){return[t,i]=id(t,i),new Dte(e,{...r,x:t,y:i})}const Ote={ariaLabel:"rect"};class xL extends mo{constructor(t,i={}){const{x1:r,y1:o,x2:a,y2:h,inset:u=0,insetTop:p=u,insetRight:c=u,insetBottom:f=u,insetLeft:g=u,rx:m,ry:v}=i;super(t,{x1:{value:r,scale:"x",type:r!=null&&a==null?"band":void 0,optional:!0},y1:{value:o,scale:"y",type:o!=null&&h==null?"band":void 0,optional:!0},x2:{value:a,scale:"x",optional:!0},y2:{value:h,scale:"y",optional:!0}},i,Ote),this.insetTop=Pr(p),this.insetRight=Pr(c),this.insetBottom=Pr(f),this.insetLeft=Pr(g),this.rx=Ns(m,"auto"),this.ry=Ns(v,"auto")}render(t,i,r,o,a){const{x:h,y:u}=i,{x1:p,y1:c,x2:f,y2:g}=r,{marginTop:m,marginRight:v,marginBottom:A,marginLeft:y,width:C,height:E}=o,{projection:x}=a,{insetTop:M,insetRight:w,insetBottom:S,insetLeft:I,rx:L,ry:R}=this,k=(h!=null&&h.bandwidth?h.bandwidth():0)-I-w,P=(u!=null&&u.bandwidth?u.bandwidth():0)-M-S;return ys("svg:g",a).call(ca,this,o,a).call(Bo,this,{},0,0).call(F=>F.selectAll().data(t).enter().append("rect").call(ua,this).attr("x",p&&(x||!Ma(h))?f?O=>Math.min(p[O],f[O])+I:O=>p[O]+I:y+I).attr("y",c&&(x||!Ma(u))?g?O=>Math.min(c[O],g[O])+M:O=>c[O]+M:m+M).attr("width",p&&(x||!Ma(h))?f?O=>Math.max(0,Math.abs(f[O]-p[O])+k):k:C-v-y-w-I).attr("height",c&&(x||!Ma(u))?g?O=>Math.max(0,Math.abs(c[O]-g[O])+P):P:E-m-A-M-S).call(Mi,"rx",L).call(Mi,"ry",R).call(Il,this,r)).node()}}function Fte(e,t){return new xL(e,B7(vZ(t)))}function gw(e,t={}){return FE(t)||(t={...t,x:Sm,y2:fs,interval:1}),new xL(e,pw(B7(dw(t))))}const kte={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Ute extends mo{constructor(t,i,r){super(t,i,r,kte),Fm(this,r)}render(t,i,r,o,a){return ys("svg:g",a).call(ca,this,o,a).call(this._transform,this,i).call(h=>h.selectAll().data(t).enter().append("line").call(ua,this).attr("x1",this._x1(i,r,o)).attr("x2",this._x2(i,r,o)).attr("y1",this._y1(i,r,o)).attr("y2",this._y2(i,r,o)).call(Il,this,r).call(Y1,this,r,a)).node()}}class Gte extends Ute{constructor(t,i={}){const{x:r,y:o,inset:a=0,insetTop:h=a,insetBottom:u=a}=i;super(t,{x:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},i),this.insetTop=Pr(h),this.insetBottom=Pr(u)}_transform(t,i,{x:r}){t.call(Bo,i,{x:r},Go,0)}_x1(t,{x:i}){return r=>i[r]}_x2(t,{x:i}){return r=>i[r]}_y1({y:t},{y:i},{marginTop:r}){const{insetTop:o}=this;return i&&t?a=>i[a]+o:r+o}_y2({y:t},{y:i},{height:r,marginBottom:o}){const{insetBottom:a}=this;return i&&t?h=>i[h]+t.bandwidth()-a:r-o-a}}function Xa(e,{x:t=fs,...i}={}){return new Gte(e,{...i,x:t})}function yT({path:e=fs,delimiter:t,frameAnchor:i,treeLayout:r=Pg,treeSort:o,treeSeparation:a,treeAnchor:h,treeFilter:u,...p}={}){h=vw(h),o=ML(o),u!=null&&(u=g_(u)),i===void 0&&(i=h.frameAnchor);const c=SL(t),f=DL(p,g_),[g,m]=$a(),[v,A]=$a();return{x:g,y:v,frameAnchor:i,...mh(p,(y,C)=>{const E=c(Xr(y,e)),x=m([]),M=A([]);let w=-1;const S=[],I=[],L=m5().path(k=>E[k]),R=r();R.nodeSize&&R.nodeSize([1,1]),R.separation&&a!==void 0&&R.separation(a??NE);for(const k of f)k[Jg]=k[LL]([]);for(const k of C){const P=[],F=L(k.filter(O=>E[O]!=null)).each(O=>O.data=y[O.data]);o!=null&&F.sort(o),R(F);for(const O of F.descendants())if(!(u!=null&&!u(O))){P.push(++w),S[w]=O.data,h.position(O,w,x,M);for(const W of f)W[Jg][w]=W[PL](O)}I.push(P)}return{data:S,facets:I}}),...Object.fromEntries(f)}}function Vte({path:e=fs,delimiter:t,curve:i="bump-x",stroke:r="#555",strokeWidth:o=1.5,strokeOpacity:a=.5,treeLayout:h=Pg,treeSort:u,treeSeparation:p,treeAnchor:c,treeFilter:f,...g}={}){c=vw(c),u=ML(u),f!=null&&(f=ET(f)),g={curve:i,stroke:r,strokeWidth:o,strokeOpacity:a,...g};const m=SL(t),v=DL(g,ET),[A,y]=$a(),[C,E]=$a(),[x,M]=$a(),[w,S]=$a();return{x1:A,x2:C,y1:x,y2:w,...mh(g,(I,L)=>{const R=m(Xr(I,e)),k=y([]),P=E([]),F=M([]),O=S([]);let W=-1;const V=[],$=[],H=m5().path(Q=>R[Q]),Y=h();Y.nodeSize&&Y.nodeSize([1,1]),Y.separation&&p!==void 0&&Y.separation(p??NE);for(const Q of v)Q[Jg]=Q[LL]([]);for(const Q of L){const G=[],J=H(Q.filter(K=>R[K]!=null)).each(K=>K.data=I[K.data]);u!=null&&J.sort(u),Y(J);for(const{source:K,target:se}of J.links())if(!(f!=null&&!f(se,K))){G.push(++W),V[W]=se.data,c.position(K,W,k,F),c.position(se,W,P,O);for(const ue of v)ue[Jg][W]=ue[PL](se,K)}$.push(G)}return{data:V,facets:$}}),...Object.fromEntries(v)}}function vw(e="left"){switch(`${e}`.trim().toLowerCase()){case"left":return Qte;case"right":return Hte}throw new Error(`invalid tree anchor: ${e}`)}const Qte={frameAnchor:"left",dx:6,position({x:e,y:t},i,r,o){r[i]=t,o[i]=-e}},Hte={frameAnchor:"right",dx:-6,position({x:e,y:t},i,r,o){r[i]=-t,o[i]=-e}};function ML(e){return e==null||typeof e=="function"?e:`${e}`.trim().toLowerCase().startsWith("node:")?_T(g_(e)):_T(zte(e))}function _T(e){return(t,i)=>Ia(e(t),e(i))}function zte(e){return t=>{var i;return(i=t.data)==null?void 0:i[e]}}function SL(e="/"){if(e=`${e}`,e==="/")return i=>i;if(e.length!==1)throw new Error("delimiter must be exactly one character");const t=e.charCodeAt(0);return i=>i.map(r=>jte(r,t))}const A_=92,TL=47;function jte(e,t){if(t===A_)throw new Error("delimiter cannot be backslash");let i=!1;for(let r=0,o=e.length;r<o;++r){switch(e.charCodeAt(r)){case A_:if(!i){i=!0;continue}break;case t:i?(e=e.slice(0,r-1)+e.slice(r),--r,--o):e=e.slice(0,r)+"/"+e.slice(r+1);break;case TL:i?(e=e.slice(0,r)+"\\\\"+e.slice(r),r+=2,o+=2):(e=e.slice(0,r)+"\\"+e.slice(r),++r,++o);break}i=!1}return e}function Wte(e){let t=!1;for(let i=0,r=e.length;i<r;++i){switch(e.charCodeAt(i)){case A_:if(!t){t=!0;continue}case TL:t&&(e=e.slice(0,i-1)+e.slice(i),--i,--r);break}t=!1}return e}function IL(e){return Tl(e)&&typeof e.node=="function"}function $te(e){return Tl(e)&&typeof e.link=="function"}function g_(e){if(IL(e))return e.node;if(e=`${e}`.trim().toLowerCase(),!!e.startsWith("node:")){switch(e){case"node:name":return b_;case"node:path":return v_;case"node:internal":return BL;case"node:external":return RL;case"node:depth":return y_;case"node:height":return __}throw new Error(`invalid node value: ${e}`)}}function ET(e){if(IL(e))return e.node;if($te(e))return e.link;if(e=`${e}`.trim().toLowerCase(),!(!e.startsWith("node:")&&!e.startsWith("parent:"))){switch(e){case"parent:name":return QA(b_);case"parent:path":return QA(v_);case"parent:depth":return QA(y_);case"parent:height":return QA(__);case"node:name":return b_;case"node:path":return v_;case"node:internal":return BL;case"node:external":return RL;case"node:depth":return y_;case"node:height":return __}throw new Error(`invalid link value: ${e}`)}}function v_(e){return e.id}function b_(e){return Xte(e.id)}function y_(e){return e.depth}function __(e){return e.height}function BL(e){return!!e.children}function RL(e){return!e.children}function QA(e){return(t,i)=>i==null?void 0:e(i)}function Xte(e){let t=e.length;for(;--t>0&&!Kte(e,t););return Wte(e.slice(t+1))}function Kte(e,t){if(e[t]==="/"){let i=0;for(;t>0&&e[--t]==="\\";)++i;if(!(i&1))return!0}return!1}const LL=2,PL=3,Jg=4;function DL(e,t){const i=[];for(const r in e){const o=e[r],a=t(o);a!==void 0&&i.push([r,...$a(o),a])}return i}function Yte(e,{fill:t,stroke:i,strokeWidth:r,strokeOpacity:o,strokeLinejoin:a,strokeLinecap:h,strokeMiterlimit:u,strokeDasharray:p,strokeDashoffset:c,marker:f,markerStart:g=f,markerEnd:m=f,dot:v=ho(g)&&ho(m),text:A="node:name",textStroke:y="var(--plot-background)",title:C="node:path",dx:E,dy:x,textAnchor:M,treeLayout:w=Pg,textLayout:S=w===Pg||w===f5?"mirrored":"normal",tip:I,...L}={}){if(E===void 0&&(E=vw(L.treeAnchor).dx),M!==void 0)throw new Error("textAnchor is not a configurable tree option");S=Pa(S,"textLayout",["mirrored","normal"]);function R(k){return Ba(e,yT({treeLayout:w,text:A,fill:t===void 0?"currentColor":t,stroke:y,dx:E,dy:x,title:C,...k,...L}))}return iw(p_(e,Vte({treeLayout:w,markerStart:g,markerEnd:m,stroke:i!==void 0?i:t===void 0?"node:internal":t,strokeWidth:r,strokeOpacity:o,strokeLinejoin:a,strokeLinecap:h,strokeMiterlimit:u,strokeDasharray:p,strokeDashoffset:c,...L})),v?po(e,yT({treeLayout:w,fill:t===void 0?"node:internal":t,title:C,tip:I,...L})):null,A!=null?S==="mirrored"?[R({textAnchor:"start",treeFilter:"node:external"}),R({textAnchor:"end",treeFilter:"node:internal",dx:-E})]:R():null)}function qte(e,t){return Yte(e,{...t,treeLayout:f5})}const NL=new Map,OL=new Map,Jte=new Map,Zte=new Map;function ng(e){return NL.get(e)}function nv(e){return OL.get(e)}function Mp(e){const t=e%12;return t===1||t===3||t===6||t===8||t===10}const ene=new Map([["Cb","B"],["Db","C#"],["Eb","D#"],["Fb","E"],["Gb","F#"],["Ab","G#"],["Bb","A#"]]),nu=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Um=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],$f=[{pitch:0,name:"C",octave:-1,label:"C-1",frequency:8.176},{pitch:1,name:"C#",octave:-1,label:"C#-1",frequency:8.662},{pitch:2,name:"D",octave:-1,label:"D-1",frequency:9.177},{pitch:3,name:"D#",octave:-1,label:"D#-1",frequency:9.723},{pitch:4,name:"E",octave:-1,label:"E-1",frequency:10.301},{pitch:5,name:"F",octave:-1,label:"F-1",frequency:10.913},{pitch:6,name:"F#",octave:-1,label:"F#-1",frequency:11.562},{pitch:7,name:"G",octave:-1,label:"G-1",frequency:12.25},{pitch:8,name:"G#",octave:-1,label:"G#-1",frequency:12.978},{pitch:9,name:"A",octave:-1,label:"A-1",frequency:13.75},{pitch:10,name:"A#",octave:-1,label:"A#-1",frequency:14.568},{pitch:11,name:"B",octave:-1,label:"B-1",frequency:15.434},{pitch:12,name:"C",octave:0,label:"C0",frequency:16.352},{pitch:13,name:"C#",octave:0,label:"C#0",frequency:17.324},{pitch:14,name:"D",octave:0,label:"D0",frequency:18.354},{pitch:15,name:"D#",octave:0,label:"D#0",frequency:19.445},{pitch:16,name:"E",octave:0,label:"E0",frequency:20.602},{pitch:17,name:"F",octave:0,label:"F0",frequency:21.827},{pitch:18,name:"F#",octave:0,label:"F#0",frequency:23.125},{pitch:19,name:"G",octave:0,label:"G0",frequency:24.5},{pitch:20,name:"G#",octave:0,label:"G#0",frequency:25.957},{pitch:21,name:"A",octave:0,label:"A0",frequency:27.5},{pitch:22,name:"A#",octave:0,label:"A#0",frequency:29.135},{pitch:23,name:"B",octave:0,label:"B0",frequency:30.868},{pitch:24,name:"C",octave:1,label:"C1",frequency:32.703},{pitch:25,name:"C#",octave:1,label:"C#1",frequency:34.648},{pitch:26,name:"D",octave:1,label:"D1",frequency:36.708},{pitch:27,name:"D#",octave:1,label:"D#1",frequency:38.891},{pitch:28,name:"E",octave:1,label:"E1",frequency:41.203},{pitch:29,name:"F",octave:1,label:"F1",frequency:43.654},{pitch:30,name:"F#",octave:1,label:"F#1",frequency:46.249},{pitch:31,name:"G",octave:1,label:"G1",frequency:48.999},{pitch:32,name:"G#",octave:1,label:"G#1",frequency:51.913},{pitch:33,name:"A",octave:1,label:"A1",frequency:55},{pitch:34,name:"A#",octave:1,label:"A#1",frequency:58.27},{pitch:35,name:"B",octave:1,label:"B1",frequency:61.735},{pitch:36,name:"C",octave:2,label:"C2",frequency:65.406},{pitch:37,name:"C#",octave:2,label:"C#2",frequency:69.296},{pitch:38,name:"D",octave:2,label:"D2",frequency:73.416},{pitch:39,name:"D#",octave:2,label:"D#2",frequency:77.782},{pitch:40,name:"E",octave:2,label:"E2",frequency:82.407},{pitch:41,name:"F",octave:2,label:"F2",frequency:87.307},{pitch:42,name:"F#",octave:2,label:"F#2",frequency:92.499},{pitch:43,name:"G",octave:2,label:"G2",frequency:97.999},{pitch:44,name:"G#",octave:2,label:"G#2",frequency:103.826},{pitch:45,name:"A",octave:2,label:"A2",frequency:110},{pitch:46,name:"A#",octave:2,label:"A#2",frequency:116.541},{pitch:47,name:"B",octave:2,label:"B2",frequency:123.471},{pitch:48,name:"C",octave:3,label:"C3",frequency:130.813},{pitch:49,name:"C#",octave:3,label:"C#3",frequency:138.591},{pitch:50,name:"D",octave:3,label:"D3",frequency:146.832},{pitch:51,name:"D#",octave:3,label:"D#3",frequency:155.563},{pitch:52,name:"E",octave:3,label:"E3",frequency:164.814},{pitch:53,name:"F",octave:3,label:"F3",frequency:174.614},{pitch:54,name:"F#",octave:3,label:"F#3",frequency:184.997},{pitch:55,name:"G",octave:3,label:"G3",frequency:195.998},{pitch:56,name:"G#",octave:3,label:"G#3",frequency:207.652},{pitch:57,name:"A",octave:3,label:"A3",frequency:220},{pitch:58,name:"A#",octave:3,label:"A#3",frequency:233.082},{pitch:59,name:"B",octave:3,label:"B3",frequency:246.942},{pitch:60,name:"C",octave:4,label:"C4",frequency:261.626},{pitch:61,name:"C#",octave:4,label:"C#4",frequency:277.183},{pitch:62,name:"D",octave:4,label:"D4",frequency:293.665},{pitch:63,name:"D#",octave:4,label:"D#4",frequency:311.127},{pitch:64,name:"E",octave:4,label:"E4",frequency:329.628},{pitch:65,name:"F",octave:4,label:"F4",frequency:349.228},{pitch:66,name:"F#",octave:4,label:"F#4",frequency:369.994},{pitch:67,name:"G",octave:4,label:"G4",frequency:391.995},{pitch:68,name:"G#",octave:4,label:"G#4",frequency:415.305},{pitch:69,name:"A",octave:4,label:"A4",frequency:440},{pitch:70,name:"A#",octave:4,label:"A#4",frequency:466.164},{pitch:71,name:"B",octave:4,label:"B4",frequency:493.883},{pitch:72,name:"C",octave:5,label:"C5",frequency:523.251},{pitch:73,name:"C#",octave:5,label:"C#5",frequency:554.365},{pitch:74,name:"D",octave:5,label:"D5",frequency:587.33},{pitch:75,name:"D#",octave:5,label:"D#5",frequency:622.254},{pitch:76,name:"E",octave:5,label:"E5",frequency:659.255},{pitch:77,name:"F",octave:5,label:"F5",frequency:698.456},{pitch:78,name:"F#",octave:5,label:"F#5",frequency:739.989},{pitch:79,name:"G",octave:5,label:"G5",frequency:783.991},{pitch:80,name:"G#",octave:5,label:"G#5",frequency:830.609},{pitch:81,name:"A",octave:5,label:"A5",frequency:880},{pitch:82,name:"A#",octave:5,label:"A#5",frequency:932.328},{pitch:83,name:"B",octave:5,label:"B5",frequency:987.767},{pitch:84,name:"C",octave:6,label:"C6",frequency:1046.502},{pitch:85,name:"C#",octave:6,label:"C#6",frequency:1108.731},{pitch:86,name:"D",octave:6,label:"D6",frequency:1174.659},{pitch:87,name:"D#",octave:6,label:"D#6",frequency:1244.508},{pitch:88,name:"E",octave:6,label:"E6",frequency:1318.51},{pitch:89,name:"F",octave:6,label:"F6",frequency:1396.913},{pitch:90,name:"F#",octave:6,label:"F#6",frequency:1479.978},{pitch:91,name:"G",octave:6,label:"G6",frequency:1567.982},{pitch:92,name:"G#",octave:6,label:"G#6",frequency:1661.219},{pitch:93,name:"A",octave:6,label:"A6",frequency:1760},{pitch:94,name:"A#",octave:6,label:"A#6",frequency:1864.655},{pitch:95,name:"B",octave:6,label:"B6",frequency:1975.533},{pitch:96,name:"C",octave:7,label:"C7",frequency:2093.005},{pitch:97,name:"C#",octave:7,label:"C#7",frequency:2217.461},{pitch:98,name:"D",octave:7,label:"D7",frequency:2349.318},{pitch:99,name:"D#",octave:7,label:"D#7",frequency:2489.016},{pitch:100,name:"E",octave:7,label:"E7",frequency:2637.02},{pitch:101,name:"F",octave:7,label:"F7",frequency:2793.826},{pitch:102,name:"F#",octave:7,label:"F#7",frequency:2959.955},{pitch:103,name:"G",octave:7,label:"G7",frequency:3135.963},{pitch:104,name:"G#",octave:7,label:"G#7",frequency:3322.438},{pitch:105,name:"A",octave:7,label:"A7",frequency:3520},{pitch:106,name:"A#",octave:7,label:"A#7",frequency:3729.31},{pitch:107,name:"B",octave:7,label:"B7",frequency:3951.066},{pitch:108,name:"C",octave:8,label:"C8",frequency:4186.009},{pitch:109,name:"C#",octave:8,label:"C#8",frequency:4434.922},{pitch:110,name:"D",octave:8,label:"D8",frequency:4698.636},{pitch:111,name:"D#",octave:8,label:"D#8",frequency:4978.032},{pitch:112,name:"E",octave:8,label:"E8",frequency:5274.041},{pitch:113,name:"F",octave:8,label:"F8",frequency:5587.652},{pitch:114,name:"F#",octave:8,label:"F#8",frequency:5919.911},{pitch:115,name:"G",octave:8,label:"G8",frequency:6271.927},{pitch:116,name:"G#",octave:8,label:"G#8",frequency:6644.875},{pitch:117,name:"A",octave:8,label:"A8",frequency:7040},{pitch:118,name:"A#",octave:8,label:"A#8",frequency:7458.62},{pitch:119,name:"B",octave:8,label:"B8",frequency:7902.133},{pitch:120,name:"C",octave:9,label:"C9",frequency:8372.018},{pitch:121,name:"C#",octave:9,label:"C#9",frequency:8869.844},{pitch:122,name:"D",octave:9,label:"D9",frequency:9397.273},{pitch:123,name:"D#",octave:9,label:"D#9",frequency:9956.063},{pitch:124,name:"E",octave:9,label:"E9",frequency:10548.08},{pitch:125,name:"F",octave:9,label:"F9",frequency:11175.3},{pitch:126,name:"F#",octave:9,label:"F#9",frequency:11839.82},{pitch:127,name:"G",octave:9,label:"G9",frequency:12543.85}],tne=[{number:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,group:"Piano",label:"Bright Acoustic Piano"},{number:2,group:"Piano",label:"Electric Grand Piano"},{number:3,group:"Piano",label:"Honky-tonk Piano"},{number:4,group:"Piano",label:"Electric Piano 1"},{number:5,group:"Piano",label:"Electric Piano 2"},{number:6,group:"Piano",label:"Harpsichord"},{number:7,group:"Piano",label:"Clavinet"},{number:8,group:"Chromatic Percussion",label:"Celesta"},{number:9,group:"Chromatic Percussion",label:"Glockenspiel"},{number:10,group:"Chromatic Percussion",label:"Music Box"},{number:11,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,group:"Chromatic Percussion",label:"Marimba"},{number:13,group:"Chromatic Percussion",label:"Xylophone"},{number:14,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,group:"Chromatic Percussion",label:"Dulcimer"},{number:16,group:"Organ",label:"Drawbar Organ"},{number:17,group:"Organ",label:"Percussive Organ"},{number:18,group:"Organ",label:"Rock Organ"},{number:19,group:"Organ",label:"Church Organ"},{number:20,group:"Organ",label:"Reed Organ"},{number:21,group:"Organ",label:"Accordion"},{number:22,group:"Organ",label:"Harmonica"},{number:23,group:"Organ",label:"Tango Accordion"},{number:24,group:"Guitar",label:"Acoustic Guitar(nylon)"},{number:25,group:"Guitar",label:"Acoustic Guitar(steel)"},{number:26,group:"Guitar",label:"Electric Guitar(jazz)"},{number:27,group:"Guitar",label:"Electric Guitar(clean)"},{number:28,group:"Guitar",label:"Electric Guitar(muted)"},{number:29,group:"Guitar",label:"Overdriven Guitar"},{number:30,group:"Guitar",label:"Distortion Guitar"},{number:31,group:"Guitar",label:"Guitar harmonics"},{number:32,group:"Bass",label:"Acoustic Bass"},{number:33,group:"Bass",label:"Electric Bass(finger)"},{number:34,group:"Bass",label:"Electric Bass(pick)"},{number:35,group:"Bass",label:"Fretless Bass"},{number:36,group:"Bass",label:"Slap Bass 1"},{number:37,group:"Bass",label:"Slap Bass 2"},{number:38,group:"Bass",label:"Synth Bass 1"},{number:39,group:"Bass",label:"Synth Bass 2"},{number:40,group:"Strings",label:"Violin"},{number:41,group:"Strings",label:"Viola"},{number:42,group:"Strings",label:"Cello"},{number:43,group:"Strings",label:"Contrabass"},{number:44,group:"Strings",label:"Tremolo Strings"},{number:45,group:"Strings",label:"Pizzicato Strings"},{number:46,group:"Strings",label:"Orchestral Harp"},{number:47,group:"Strings",label:"Timpani"},{number:48,group:"Strings (continued)",label:"String Ensemble 1"},{number:49,group:"Strings (continued)",label:"String Ensemble 2"},{number:50,group:"Strings (continued)",label:"Synth Strings 1"},{number:51,group:"Strings (continued)",label:"Synth Strings 2"},{number:52,group:"Strings (continued)",label:"Choir Aahs"},{number:53,group:"Strings (continued)",label:"Voice Oohs"},{number:54,group:"Strings (continued)",label:"Synth Voice"},{number:55,group:"Strings (continued)",label:"Orchestra Hit"},{number:56,group:"Brass",label:"Trumpet"},{number:57,group:"Brass",label:"Trombone"},{number:58,group:"Brass",label:"Tuba"},{number:59,group:"Brass",label:"Muted Trumpet"},{number:60,group:"Brass",label:"French Horn"},{number:61,group:"Brass",label:"Brass Section"},{number:62,group:"Brass",label:"Synth Brass 1"},{number:63,group:"Brass",label:"Synth Brass 2"},{number:64,group:"Reed",label:"Soprano Sax"},{number:65,group:"Reed",label:"Alto Sax"},{number:66,group:"Reed",label:"Tenor Sax"},{number:67,group:"Reed",label:"Baritone Sax"},{number:68,group:"Reed",label:"Oboe"},{number:69,group:"Reed",label:"English Horn"},{number:70,group:"Reed",label:"Bassoon"},{number:71,group:"Reed",label:"Clarinet"},{number:72,group:"Pipe",label:"Piccolo"},{number:73,group:"Pipe",label:"Flute"},{number:74,group:"Pipe",label:"Recorder"},{number:75,group:"Pipe",label:"Pan Flute"},{number:76,group:"Pipe",label:"Blown Bottle"},{number:77,group:"Pipe",label:"Shakuhachi"},{number:78,group:"Pipe",label:"Whistle"},{number:79,group:"Pipe",label:"Ocarina"},{number:80,group:"Synth Lead",label:"Lead 1(square)"},{number:81,group:"Synth Lead",label:"Lead 2(sawtooth)"},{number:82,group:"Synth Lead",label:"Lead 3(calliope)"},{number:83,group:"Synth Lead",label:"Lead 4(chiff)"},{number:84,group:"Synth Lead",label:"Lead 5(charang)"},{number:85,group:"Synth Lead",label:"Lead 6(voice)"},{number:86,group:"Synth Lead",label:"Lead 7(fifths)"},{number:87,group:"Synth Lead",label:"Lead 8(bass + lead)"},{number:88,group:"Synth Pad",label:"Pad 1(new age)"},{number:89,group:"Synth Pad",label:"Pad 2(warm)"},{number:90,group:"Synth Pad",label:"Pad 3(polysynth)"},{number:91,group:"Synth Pad",label:"Pad 4(choir)"},{number:92,group:"Synth Pad",label:"Pad 5(bowed)"},{number:93,group:"Synth Pad",label:"Pad 6(metallic)"},{number:94,group:"Synth Pad",label:"Pad 7(halo)"},{number:95,group:"Synth Pad",label:"Pad 8(sweep)"},{number:96,group:"Synth Effects",label:"FX 1(rain)"},{number:97,group:"Synth Effects",label:"FX 2(soundtrack)"},{number:98,group:"Synth Effects",label:"FX 3(crystal)"},{number:99,group:"Synth Effects",label:"FX 4(atmosphere)"},{number:100,group:"Synth Effects",label:"FX 5(brightness)"},{number:101,group:"Synth Effects",label:"FX 6(goblins)"},{number:102,group:"Synth Effects",label:"FX 7(echoes)"},{number:103,group:"Synth Effects",label:"FX 8(sci-fi)"},{number:104,group:"Ethnic",label:"Sitar"},{number:105,group:"Ethnic",label:"Banjo"},{number:106,group:"Ethnic",label:"Shamisen"},{number:107,group:"Ethnic",label:"Koto"},{number:108,group:"Ethnic",label:"Kalimba"},{number:109,group:"Ethnic",label:"Bag pipe"},{number:110,group:"Ethnic",label:"Fiddle"},{number:111,group:"Ethnic",label:"Shanai"},{number:112,group:"Percussive",label:"Tinkle Bell"},{number:113,group:"Percussive",label:"Agogo"},{number:114,group:"Percussive",label:"Steel Drums"},{number:115,group:"Percussive",label:"Woodblock"},{number:116,group:"Percussive",label:"Taiko Drum"},{number:117,group:"Percussive",label:"Melodic Tom"},{number:118,group:"Percussive",label:"Synth Drum"},{number:119,group:"Sound Effects",label:"Reverse Cymbal"},{number:120,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,group:"Sound Effects",label:"Breath Noise"},{number:122,group:"Sound Effects",label:"Seashore"},{number:123,group:"Sound Effects",label:"Bird Tweet"},{number:124,group:"Sound Effects",label:"Telephone Ring"},{number:125,group:"Sound Effects",label:"Helicopter"},{number:126,group:"Sound Effects",label:"Applause"},{number:127,group:"Sound Effects",label:"Gunshot"}],nne=[{number:1,subnumber:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,subnumber:1,group:"Piano",label:"Wide Acoustic Grand"},{number:1,subnumber:2,group:"Piano",label:"Dark Acoustic Grand"},{number:2,subnumber:0,group:"Piano",label:"Bright Acoustic Piano"},{number:2,subnumber:1,group:"Piano",label:"Wide Bright Acoustic"},{number:3,subnumber:0,group:"Piano",label:"Electric Grand Piano"},{number:3,subnumber:1,group:"Piano",label:"Wide Electric Grand"},{number:4,subnumber:0,group:"Piano",label:"Honky-tonk Piano"},{number:4,subnumber:1,group:"Piano",label:"Wide Honky-tonk"},{number:5,subnumber:0,group:"Piano",label:"Rhodes Piano"},{number:5,subnumber:1,group:"Piano",label:"Detuned Electric Piano 1"},{number:5,subnumber:2,group:"Piano",label:"Electric Piano 1 Variation"},{number:5,subnumber:3,group:"Piano",label:"60's Electric Piano"},{number:6,subnumber:0,group:"Piano",label:"Chorused Electric Piano"},{number:6,subnumber:1,group:"Piano",label:"Detuned Electric Piano 2"},{number:6,subnumber:2,group:"Piano",label:"Electric Piano 2 Variation"},{number:6,subnumber:3,group:"Piano",label:"Electric Piano Legend"},{number:6,subnumber:4,group:"Piano",label:"Electric Piano Phase"},{number:7,subnumber:0,group:"Piano",label:"Harpsichord"},{number:7,subnumber:1,group:"Piano",label:"Coupled Harpsichord"},{number:7,subnumber:2,group:"Piano",label:"Wide Harpsichord"},{number:7,subnumber:3,group:"Piano",label:"Open Harpsichord"},{number:8,subnumber:0,group:"Piano",label:"Clavinet"},{number:8,subnumber:1,group:"Piano",label:"Pulse Clavinet"},{number:9,subnumber:0,group:"Chromatic Percussion",label:"Celesta"},{number:10,subnumber:0,group:"Chromatic Percussion",label:"Glockenspiel"},{number:11,subnumber:0,group:"Chromatic Percussion",label:"Music Box"},{number:12,subnumber:0,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,subnumber:1,group:"Chromatic Percussion",label:"Wet Vibraphone"},{number:13,subnumber:0,group:"Chromatic Percussion",label:"Marimba"},{number:13,subnumber:1,group:"Chromatic Percussion",label:"Wide Marimba"},{number:14,subnumber:0,group:"Chromatic Percussion",label:"Xylophone"},{number:15,subnumber:0,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,subnumber:1,group:"Chromatic Percussion",label:"Church Bells"},{number:15,subnumber:2,group:"Chromatic Percussion",label:"Carillon"},{number:16,subnumber:0,group:"Chromatic Percussion",label:"Dulcimer / Santur"},{number:17,subnumber:0,group:"Organ",label:"Hammond Organ"},{number:17,subnumber:1,group:"Organ",label:"Detuned Organ 1"},{number:17,subnumber:2,group:"Organ",label:"60's Organ 1"},{number:17,subnumber:3,group:"Organ",label:"Organ 4"},{number:18,subnumber:0,group:"Organ",label:"Percussive Organ"},{number:18,subnumber:1,group:"Organ",label:"Detuned Organ 2"},{number:18,subnumber:2,group:"Organ",label:"Organ 5"},{number:19,subnumber:0,group:"Organ",label:"Rock Organ"},{number:20,subnumber:0,group:"Organ",label:"Church Organ 1"},{number:20,subnumber:1,group:"Organ",label:"Church Organ 2"},{number:20,subnumber:2,group:"Organ",label:"Church Organ 3"},{number:21,subnumber:0,group:"Organ",label:"Reed Organ"},{number:21,subnumber:1,group:"Organ",label:"Puff Organ"},{number:22,subnumber:0,group:"Organ",label:"French Accordion"},{number:22,subnumber:1,group:"Organ",label:"Italian Accordion"},{number:23,subnumber:0,group:"Organ",label:"Harmonica"},{number:24,subnumber:0,group:"Organ",label:"Bandoneon"},{number:25,subnumber:0,group:"Guitar",label:"Nylon-String Guitar"},{number:25,subnumber:1,group:"Guitar",label:"Ukelele"},{number:25,subnumber:2,group:"Guitar",label:"Open Nylon Guitar"},{number:25,subnumber:3,group:"Guitar",label:"Nylon Guitar 2"},{number:26,subnumber:0,group:"Guitar",label:"Steel-String Guitar"},{number:26,subnumber:1,group:"Guitar",label:"12-String Guitar"},{number:26,subnumber:2,group:"Guitar",label:"Mandolin"},{number:26,subnumber:3,group:"Guitar",label:"Steel + Body"},{number:27,subnumber:0,group:"Guitar",label:"Jazz Guitar"},{number:27,subnumber:1,group:"Guitar",label:"Hawaiian Guitar"},{number:28,subnumber:0,group:"Guitar",label:"Clean Electric Guitar"},{number:28,subnumber:1,group:"Guitar",label:"Chorus Guitar"},{number:28,subnumber:2,group:"Guitar",label:"Mid Tone Guitar"},{number:29,subnumber:0,group:"Guitar",label:"Muted Electric Guitar"},{number:29,subnumber:1,group:"Guitar",label:"Funk Guitar"},{number:29,subnumber:2,group:"Guitar",label:"Funk Guitar 2"},{number:29,subnumber:3,group:"Guitar",label:"Jazz Man"},{number:30,subnumber:0,group:"Guitar",label:"Overdriven Guitar"},{number:30,subnumber:1,group:"Guitar",label:"Guitar Pinch"},{number:31,subnumber:0,group:"Guitar",label:"Distortion Guitar"},{number:31,subnumber:1,group:"Guitar",label:"Feedback Guitar"},{number:31,subnumber:2,group:"Guitar",label:"Distortion Rtm Guitar"},{number:32,subnumber:0,group:"Guitar",label:"Guitar Harmonics"},{number:32,subnumber:1,group:"Guitar",label:"Guitar Feedback"},{number:33,subnumber:0,group:"Bass",label:"Acoustic Bass"},{number:34,subnumber:0,group:"Bass",label:"Fingered Bass"},{number:34,subnumber:1,group:"Bass",label:"Finger Slap"},{number:35,subnumber:0,group:"Bass",label:"Picked Bass"},{number:36,subnumber:0,group:"Bass",label:"Fretless Bass"},{number:37,subnumber:0,group:"Bass",label:"Slap Bass 1"},{number:38,subnumber:0,group:"Bass",label:"Slap Bass 2"},{number:39,subnumber:0,group:"Bass",label:"Synth Bass 1"},{number:39,subnumber:1,group:"Bass",label:"Synth Bass 101"},{number:39,subnumber:2,group:"Bass",label:"Synth Bass 3"},{number:39,subnumber:3,group:"Bass",label:"Clavi Bass"},{number:39,subnumber:4,group:"Bass",label:"Hammer"},{number:40,subnumber:0,group:"Bass",label:"Synth Bass 2"},{number:40,subnumber:1,group:"Bass",label:"Synth Bass 4"},{number:40,subnumber:2,group:"Bass",label:"Rubber Bass"},{number:40,subnumber:3,group:"Bass",label:"Attack Pulse"},{number:41,subnumber:0,group:"Strings",label:"Violin"},{number:41,subnumber:1,group:"Strings",label:"Slow Violin"},{number:42,subnumber:0,group:"Strings",label:"Viola"},{number:43,subnumber:0,group:"Strings",label:"Cello"},{number:44,subnumber:0,group:"Strings",label:"Contrabass"},{number:45,subnumber:0,group:"Strings",label:"Tremolo Strings"},{number:46,subnumber:0,group:"Strings",label:"Pizzicato Strings"},{number:47,subnumber:0,group:"Strings",label:"Harp"},{number:47,subnumber:1,group:"Strings",label:"Yang Qin"},{number:48,subnumber:0,group:"Strings",label:"Timpani"},{number:49,subnumber:0,group:"Orchestral Ensemble",label:"String Ensemble"},{number:49,subnumber:1,group:"Orchestral Ensemble",label:"Orchestra Strings"},{number:49,subnumber:2,group:"Orchestral Ensemble",label:"60's Strings"},{number:50,subnumber:0,group:"Orchestral Ensemble",label:"Slow String Ensemble"},{number:51,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 1"},{number:51,subnumber:1,group:"Orchestral Ensemble",label:"Synth Strings 3"},{number:52,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 2"},{number:53,subnumber:0,group:"Orchestral Ensemble",label:"Choir Aahs"},{number:53,subnumber:1,group:"Orchestral Ensemble",label:"Choir Aahs 2"},{number:54,subnumber:0,group:"Orchestral Ensemble",label:"Voice Oohs"},{number:54,subnumber:1,group:"Orchestral Ensemble",label:"Humming"},{number:55,subnumber:0,group:"Orchestral Ensemble",label:"Synth Voice"},{number:55,subnumber:1,group:"Orchestral Ensemble",label:"Analog Voice"},{number:56,subnumber:0,group:"Orchestral Ensemble",label:"Orchestra Hit"},{number:56,subnumber:1,group:"Orchestral Ensemble",label:"Bass Hit"},{number:56,subnumber:2,group:"Orchestral Ensemble",label:"6th Hit"},{number:56,subnumber:3,group:"Orchestral Ensemble",label:"Euro Hit"},{number:57,subnumber:0,group:"Brass",label:"Trumpet"},{number:57,subnumber:1,group:"Brass",label:"Dark Trumpet"},{number:58,subnumber:0,group:"Brass",label:"Trombone"},{number:58,subnumber:1,group:"Brass",label:"Trombone 2"},{number:58,subnumber:2,group:"Brass",label:"Bright Trombone"},{number:59,subnumber:0,group:"Brass",label:"Tuba"},{number:60,subnumber:0,group:"Brass",label:"Muted Trumpet"},{number:60,subnumber:1,group:"Brass",label:"Muted Trumpet 2"},{number:61,subnumber:0,group:"Brass",label:"French Horn"},{number:61,subnumber:1,group:"Brass",label:"French Horn 2"},{number:62,subnumber:0,group:"Brass",label:"Brass Section"},{number:62,subnumber:1,group:"Brass",label:"Brass Section"},{number:63,subnumber:0,group:"Brass",label:"Synth Brass 1"},{number:63,subnumber:1,group:"Brass",label:"Synth Brass 3"},{number:63,subnumber:2,group:"Brass",label:"Analog Brass 1"},{number:63,subnumber:3,group:"Brass",label:"Jump Brass"},{number:64,subnumber:0,group:"Brass",label:"Synth Brass 2"},{number:64,subnumber:1,group:"Brass",label:"Synth Brass 4"},{number:64,subnumber:2,group:"Brass",label:"Analog Brass 2"},{number:65,subnumber:0,group:"Reed",label:"Soprano Sax"},{number:66,subnumber:0,group:"Reed",label:"Alto Sax"},{number:67,subnumber:0,group:"Reed",label:"Tenor Sax"},{number:68,subnumber:0,group:"Reed",label:"Baritone Sax"},{number:69,subnumber:0,group:"Reed",label:"Oboe"},{number:70,subnumber:0,group:"Reed",label:"English Horn"},{number:71,subnumber:0,group:"Reed",label:"Bassoon"},{number:72,subnumber:0,group:"Reed",label:"Clarinet"},{number:73,subnumber:0,group:"Wind",label:"Piccolo"},{number:74,subnumber:0,group:"Wind",label:"Flute"},{number:75,subnumber:0,group:"Wind",label:"Recorder"},{number:76,subnumber:0,group:"Wind",label:"Pan Flute"},{number:77,subnumber:0,group:"Wind",label:"Blown Bottle"},{number:78,subnumber:0,group:"Wind",label:"Shakuhachi"},{number:79,subnumber:0,group:"Wind",label:"Whistle"},{number:80,subnumber:0,group:"Wind",label:"Ocarina"},{number:81,subnumber:0,group:"Lead",label:"Square Lead"},{number:81,subnumber:1,group:"Lead",label:"Square Wave"},{number:81,subnumber:2,group:"Lead",label:"Sine Wave"},{number:82,subnumber:0,group:"Lead",label:"Saw Lead"},{number:82,subnumber:1,group:"Lead",label:"Saw Wave"},{number:82,subnumber:2,group:"Lead",label:"Doctor Solo"},{number:82,subnumber:3,group:"Lead",label:"Natural Lead"},{number:82,subnumber:4,group:"Lead",label:"Sequenced Saw"},{number:83,subnumber:0,group:"Lead",label:"Synth Calliope"},{number:84,subnumber:0,group:"Lead",label:"Chiffer Lead"},{number:85,subnumber:0,group:"Lead",label:"Charang"},{number:85,subnumber:1,group:"Lead",label:"Wire Lead"},{number:86,subnumber:0,group:"Lead",label:"Solo Synth Vox"},{number:87,subnumber:0,group:"Lead",label:"5th Saw Wave"},{number:88,subnumber:0,group:"Lead",label:"Bass & Lead"},{number:88,subnumber:1,group:"Lead",label:"Delayed Lead"},{number:89,subnumber:0,group:"Synth Pad",label:"Fantasia Pad"},{number:90,subnumber:0,group:"Synth Pad",label:"Warm Pad"},{number:90,subnumber:1,group:"Synth Pad",label:"Sine Pad"},{number:91,subnumber:0,group:"Synth Pad",label:"Polysynth Pad"},{number:92,subnumber:0,group:"Synth Pad",label:"Space Voice Pad"},{number:92,subnumber:1,group:"Synth Pad",label:"Itopia"},{number:93,subnumber:0,group:"Synth Pad",label:"Bowed Glass Pad"},{number:94,subnumber:0,group:"Synth Pad",label:"Metal Pad"},{number:95,subnumber:0,group:"Synth Pad",label:"Halo Pad"},{number:96,subnumber:0,group:"Synth Pad",label:"Sweep Pad"},{number:97,subnumber:0,group:"Synth Effects",label:"Ice Rain"},{number:98,subnumber:0,group:"Synth Effects",label:"Soundtrack"},{number:99,subnumber:0,group:"Synth Effects",label:"Crystal"},{number:99,subnumber:1,group:"Synth Effects",label:"Synth Mallet"},{number:100,subnumber:0,group:"Synth Effects",label:"Atmosphere"},{number:101,subnumber:0,group:"Synth Effects",label:"Brightness"},{number:102,subnumber:0,group:"Synth Effects",label:"Goblin"},{number:103,subnumber:0,group:"Synth Effects",label:"Echo Drops"},{number:103,subnumber:1,group:"Synth Effects",label:"Echo Bell"},{number:103,subnumber:2,group:"Synth Effects",label:"Echo Pan"},{number:104,subnumber:0,group:"Synth Effects",label:"Star Theme"},{number:105,subnumber:0,group:"Ethnic",label:"Sitar"},{number:105,subnumber:1,group:"Ethnic",label:"Sitar 2"},{number:106,subnumber:0,group:"Ethnic",label:"Banjo"},{number:107,subnumber:0,group:"Ethnic",label:"Shamisen"},{number:108,subnumber:0,group:"Ethnic",label:"Koto"},{number:108,subnumber:1,group:"Ethnic",label:"Taisho Koto"},{number:109,subnumber:0,group:"Ethnic",label:"Kalimba"},{number:110,subnumber:0,group:"Ethnic",label:"Bagpipe"},{number:111,subnumber:0,group:"Ethnic",label:"Fiddle"},{number:112,subnumber:0,group:"Ethnic",label:"Shanai"},{number:113,subnumber:0,group:"Percussive",label:"Tinkle Bell"},{number:114,subnumber:0,group:"Percussive",label:"Agogo"},{number:115,subnumber:0,group:"Percussive",label:"Steel Drums"},{number:116,subnumber:0,group:"Percussive",label:"Woodblock"},{number:116,subnumber:1,group:"Percussive",label:"Castanets"},{number:117,subnumber:0,group:"Percussive",label:"Taiko Drum"},{number:117,subnumber:1,group:"Percussive",label:"Concert Bass Drum"},{number:118,subnumber:0,group:"Percussive",label:"Melodic Tom 1"},{number:118,subnumber:1,group:"Percussive",label:"Melodic Tom 2"},{number:119,subnumber:0,group:"Percussive",label:"Synth Drum"},{number:119,subnumber:1,group:"Percussive",label:"808 Tom"},{number:119,subnumber:2,group:"Percussive",label:"Electric Percussion"},{number:120,subnumber:0,group:"Percussive",label:"Reverse Cymbal"},{number:121,subnumber:0,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,subnumber:1,group:"Sound Effects",label:"Guitar Cut Noise"},{number:121,subnumber:2,group:"Sound Effects",label:"String Slap"},{number:122,subnumber:0,group:"Sound Effects",label:"Breath Noise"},{number:122,subnumber:1,group:"Sound Effects",label:"Flute Key Click"},{number:123,subnumber:0,group:"Sound Effects",label:"Seashore"},{number:123,subnumber:1,group:"Sound Effects",label:"Rain"},{number:123,subnumber:2,group:"Sound Effects",label:"Thunder"},{number:123,subnumber:3,group:"Sound Effects",label:"Wind"},{number:123,subnumber:4,group:"Sound Effects",label:"Stream"},{number:123,subnumber:5,group:"Sound Effects",label:"Bubble"},{number:124,subnumber:0,group:"Sound Effects",label:"Bird Tweet"},{number:124,subnumber:1,group:"Sound Effects",label:"Dog"},{number:124,subnumber:2,group:"Sound Effects",label:"Horse Gallop"},{number:124,subnumber:3,group:"Sound Effects",label:"Bird 2"},{number:125,subnumber:0,group:"Sound Effects",label:"Telephone 1"},{number:125,subnumber:1,group:"Sound Effects",label:"Telephone 2"},{number:125,subnumber:2,group:"Sound Effects",label:"Door Creaking"},{number:125,subnumber:3,group:"Sound Effects",label:"Door Closing"},{number:125,subnumber:4,group:"Sound Effects",label:"Scratch"},{number:125,subnumber:5,group:"Sound Effects",label:"Wind Chimes"},{number:126,subnumber:0,group:"Sound Effects",label:"Helicopter"},{number:126,subnumber:1,group:"Sound Effects",label:"Car Engine"},{number:126,subnumber:2,group:"Sound Effects",label:"Car Stop"},{number:126,subnumber:3,group:"Sound Effects",label:"Car Pass"},{number:126,subnumber:4,group:"Sound Effects",label:"Car Crash"},{number:126,subnumber:5,group:"Sound Effects",label:"Siren"},{number:126,subnumber:6,group:"Sound Effects",label:"Train"},{number:126,subnumber:7,group:"Sound Effects",label:"Jetplane"},{number:126,subnumber:8,group:"Sound Effects",label:"Starship"},{number:126,subnumber:9,group:"Sound Effects",label:"Burst Noise"},{number:127,subnumber:0,group:"Sound Effects",label:"Applause"},{number:127,subnumber:1,group:"Sound Effects",label:"Laughing"},{number:127,subnumber:2,group:"Sound Effects",label:"Screaming"},{number:127,subnumber:3,group:"Sound Effects",label:"Punch"},{number:127,subnumber:4,group:"Sound Effects",label:"Heart Beat"},{number:127,subnumber:5,group:"Sound Effects",label:"Footsteps"},{number:128,subnumber:0,group:"Sound Effects",label:"Gun Shot"},{number:128,subnumber:1,group:"Sound Effects",label:"Machine Gun"},{number:128,subnumber:2,group:"Sound Effects",label:"Lasergun"},{number:128,subnumber:3,group:"Sound Effects",label:"Explosion"}];for(const e of $f)NL.set(e.pitch,e),OL.set(e.label,e);for(const e of tne)Jte.set(e.number,e);for(const e of nne){const t=`${e.number}-${e.subnumber}`;Zte.set(t,e)}class cc{constructor(t=0,i=0,r=127,o=0,a=null){if(t<0||t>127)throw new Error(`Invalid pitch ${t}`);try{this.name=ng(t).label}catch{throw new Error(`Invalid pitch ${t}`)}this.pitch=t,this.start=i,this.velocity=r,this.channel=o,this.end=a}static from(t){let{pitch:i=0,start:r=0,velocity:o=127,channel:a=0,end:h=null,duration:u=null}=t;if(typeof i=="string"&&Number.isNaN(+i)){const p=nv(i);if(p==null)throw new Error("Invalid pitch for Note.from()");i=p.pitch}return h==null&&u!==null&&!Number.isNaN(u)&&(h=r+u),new cc(i,r,o,a,h)}static startPitchComparator(t,i){return t.start!==i.start?t.start-i.start:t.pitch-i.pitch}clone(){return new cc(this.pitch,this.start,this.velocity,this.channel,this.end)}getDuration(){return this.end===null?0:this.end-this.start}getName(){return this.name}getLetter(){return ng(this.pitch).name}getOctave(){return ng(this.pitch).octave}shiftTime(t){const i=this.clone();return i.start+=t,i.end=i.end===null?null:i.end+t,i}scaleTime(t){const i=this.clone();return i.start*=t,i.end=i.end===null?null:i.end*t,i}overlapsInTime(t){return this.start>=t.start&&this.start<=t.end||this.end>=t.start&&this.end<=t.end}overlapInSeconds(t){if(!this.overlapsInTime(t))return 0;const i=Math.max(this.start,t.start);return Math.min(this.end,t.end)-i}equals(t){return t instanceof cc?this.pitch===t.pitch&&this.start===t.start&&this.velocity===t.velocity&&this.channel===t.channel&&this.end===t.end:!1}toString(t=!1){return t?`Note(n: ${this.name}, p: ${this.pitch}, s: ${this.start}, e: ${this.end}, v: ${this.velocity}, c: ${this.channel})`:`Note(name: ${this.name}, pitch: ${this.pitch}, start: ${this.start}, end: ${this.end}, velocity: ${this.velocity}, channel: ${this.channel})`}}class ff extends cc{constructor(t=0,i=0,r=127,o=0,a=null,h=null,u=null){super(t,i,r,o,a),this.string=h,this.fret=u}static from(t){let{pitch:i=0,start:r=0,velocity:o=127,channel:a=0,end:h=null,string:u=null,fret:p=null}=t;if(typeof i=="string"&&Number.isNaN(+i)){const c=nv(i);if(c==null)throw new Error("Invalid pitch for GuitarNote.from()");i=c.pitch}return new ff(i,r,o,a,h,u,p)}static fromNote(t,i,r){return new ff(t.pitch,t.start,t.velocity,t.channel,t.end,i,r)}toNote(){return new cc(this.pitch,this.start,this.velocity,this.channel,this.end)}clone(){return new ff(this.pitch,this.start,this.velocity,this.channel,this.end,this.string,this.fret)}equals(t){return t instanceof ff?this.pitch===t.pitch&&this.start===t.start&&this.velocity===t.velocity&&this.channel===t.channel&&this.end===t.end&&this.string===t.string&&this.fret===t.fret:!1}toString(t=!1){return t?`GuitarNote(n: ${this.name}, p: ${this.pitch}, s: ${this.start}, e: ${this.end}, v: ${this.velocity}, c: ${this.channel}, s: ${this.string}, f: ${this.fret})`:`GuitarNote(name: ${this.name}, pitch: ${this.pitch}, start: ${this.start}, end: ${this.end}, velocity: ${this.velocity}, channel: ${this.channel}, string: ${this.string}, fret: ${this.fret})`}}function ine(e,t){let i;if(t===void 0)for(const r of e)r!=null&&(i>r||i===void 0&&r>=r)&&(i=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(i>o||i===void 0&&o>=o)&&(i=o)}return i}var rne={value:()=>{}};function FL(){for(var e=0,t=arguments.length,i={},r;e<t;++e){if(!(r=arguments[e]+"")||r in i||/[\s.]/.test(r))throw new Error("illegal type: "+r);i[r]=[]}return new ig(i)}function ig(e){this._=e}function sne(e,t){return e.trim().split(/^|\s+/).map(function(i){var r="",o=i.indexOf(".");if(o>=0&&(r=i.slice(o+1),i=i.slice(0,o)),i&&!t.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:r}})}ig.prototype=FL.prototype={constructor:ig,on:function(e,t){var i=this._,r=sne(e+"",i),o,a=-1,h=r.length;if(arguments.length<2){for(;++a<h;)if((o=(e=r[a]).type)&&(o=one(i[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<h;)if(o=(e=r[a]).type)i[o]=wT(i[o],e.name,t);else if(t==null)for(o in i)i[o]=wT(i[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var i in t)e[i]=t[i].slice();return new ig(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var i=new Array(o),r=0,o,a;r<o;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,o=a.length;r<o;++r)a[r].value.apply(t,i)},apply:function(e,t,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,a=r.length;o<a;++o)r[o].value.apply(t,i)}};function one(e,t){for(var i=0,r=e.length,o;i<r;++i)if((o=e[i]).name===t)return o.value}function wT(e,t,i){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=rne,e=e.slice(0,r).concat(e.slice(r+1));break}return i!=null&&e.push({name:t,value:i}),e}var E_="http://www.w3.org/1999/xhtml";const CT={svg:"http://www.w3.org/2000/svg",xhtml:E_,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function iv(e){var t=e+="",i=t.indexOf(":");return i>=0&&(t=e.slice(0,i))!=="xmlns"&&(e=e.slice(i+1)),CT.hasOwnProperty(t)?{space:CT[t],local:e}:e}function ane(e){return function(){var t=this.ownerDocument,i=this.namespaceURI;return i===E_&&t.documentElement.namespaceURI===E_?t.createElement(e):t.createElementNS(i,e)}}function lne(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function kL(e){var t=iv(e);return(t.local?lne:ane)(t)}function cne(){}function bw(e){return e==null?cne:function(){return this.querySelector(e)}}function une(e){typeof e!="function"&&(e=bw(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],h=a.length,u=r[o]=new Array(h),p,c,f=0;f<h;++f)(p=a[f])&&(c=e.call(p,p.__data__,f,a))&&("__data__"in p&&(c.__data__=p.__data__),u[f]=c);return new Ra(r,this._parents)}function UL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function hne(){return[]}function GL(e){return e==null?hne:function(){return this.querySelectorAll(e)}}function fne(e){return function(){var t=e.apply(this,arguments);return t==null?[]:UL(t)}}function dne(e){typeof e=="function"?e=fne(e):e=GL(e);for(var t=this._groups,i=t.length,r=[],o=[],a=0;a<i;++a)for(var h=t[a],u=h.length,p,c=0;c<u;++c)(p=h[c])&&(r.push(e.call(p,p.__data__,c,h)),o.push(p));return new Ra(r,o)}function VL(e){return function(){return this.matches(e)}}function QL(e){return function(t){return t.matches(e)}}var pne=Array.prototype.find;function mne(e){return function(){return pne.call(this.children,e)}}function Ane(){return this.firstElementChild}function gne(e){return this.select(e==null?Ane:mne(typeof e=="function"?e:QL(e)))}var vne=Array.prototype.filter;function bne(){return this.children}function yne(e){return function(){return vne.call(this.children,e)}}function _ne(e){return this.selectAll(e==null?bne:yne(typeof e=="function"?e:QL(e)))}function Ene(e){typeof e!="function"&&(e=VL(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],h=a.length,u=r[o]=[],p,c=0;c<h;++c)(p=a[c])&&e.call(p,p.__data__,c,a)&&u.push(p);return new Ra(r,this._parents)}function HL(e){return new Array(e.length)}function wne(){return new Ra(this._enter||this._groups.map(HL),this._parents)}function Zg(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Zg.prototype={constructor:Zg,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Cne(e){return function(){return e}}function xne(e,t,i,r,o,a){for(var h=0,u,p=t.length,c=a.length;h<c;++h)(u=t[h])?(u.__data__=a[h],r[h]=u):i[h]=new Zg(e,a[h]);for(;h<p;++h)(u=t[h])&&(o[h]=u)}function Mne(e,t,i,r,o,a,h){var u,p,c=new Map,f=t.length,g=a.length,m=new Array(f),v;for(u=0;u<f;++u)(p=t[u])&&(m[u]=v=h.call(p,p.__data__,u,t)+"",c.has(v)?o[u]=p:c.set(v,p));for(u=0;u<g;++u)v=h.call(e,a[u],u,a)+"",(p=c.get(v))?(r[u]=p,p.__data__=a[u],c.delete(v)):i[u]=new Zg(e,a[u]);for(u=0;u<f;++u)(p=t[u])&&c.get(m[u])===p&&(o[u]=p)}function Sne(e){return e.__data__}function Tne(e,t){if(!arguments.length)return Array.from(this,Sne);var i=t?Mne:xne,r=this._parents,o=this._groups;typeof e!="function"&&(e=Cne(e));for(var a=o.length,h=new Array(a),u=new Array(a),p=new Array(a),c=0;c<a;++c){var f=r[c],g=o[c],m=g.length,v=UL(e.call(f,f&&f.__data__,c,r)),A=v.length,y=u[c]=new Array(A),C=h[c]=new Array(A),E=p[c]=new Array(m);i(f,g,y,C,E,v,t);for(var x=0,M=0,w,S;x<A;++x)if(w=y[x]){for(x>=M&&(M=x+1);!(S=C[M])&&++M<A;);w._next=S||null}}return h=new Ra(h,r),h._enter=u,h._exit=p,h}function Ine(){return new Ra(this._exit||this._groups.map(HL),this._parents)}function Bne(e,t,i){var r=this.enter(),o=this,a=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(o=t(o)),i==null?a.remove():i(a),r&&o?r.merge(o).order():o}function Rne(e){if(!(e instanceof Ra))throw new Error("invalid merge");for(var t=this._groups,i=e._groups,r=t.length,o=i.length,a=Math.min(r,o),h=new Array(r),u=0;u<a;++u)for(var p=t[u],c=i[u],f=p.length,g=h[u]=new Array(f),m,v=0;v<f;++v)(m=p[v]||c[v])&&(g[v]=m);for(;u<r;++u)h[u]=t[u];return new Ra(h,this._parents)}function Lne(){for(var e=this._groups,t=-1,i=e.length;++t<i;)for(var r=e[t],o=r.length-1,a=r[o],h;--o>=0;)(h=r[o])&&(a&&h.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(h,a),a=h);return this}function Pne(e){e||(e=Dne);function t(g,m){return g&&m?e(g.__data__,m.__data__):!g-!m}for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a){for(var h=i[a],u=h.length,p=o[a]=new Array(u),c,f=0;f<u;++f)(c=h[f])&&(p[f]=c);p.sort(t)}return new Ra(o,this._parents).order()}function Dne(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Nne(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function One(){return Array.from(this)}function Fne(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var r=e[t],o=0,a=r.length;o<a;++o){var h=r[o];if(h)return h}return null}function kne(){let e=0;for(const t of this)++e;return e}function Une(){return!this.node()}function Gne(e){for(var t=this._groups,i=0,r=t.length;i<r;++i)for(var o=t[i],a=0,h=o.length,u;a<h;++a)(u=o[a])&&e.call(u,u.__data__,a,o);return this}function Vne(e){return function(){this.removeAttribute(e)}}function Qne(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Hne(e,t){return function(){this.setAttribute(e,t)}}function zne(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function jne(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttribute(e):this.setAttribute(e,i)}}function Wne(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}}function $ne(e,t){var i=iv(e);if(arguments.length<2){var r=this.node();return i.local?r.getAttributeNS(i.space,i.local):r.getAttribute(i)}return this.each((t==null?i.local?Qne:Vne:typeof t=="function"?i.local?Wne:jne:i.local?zne:Hne)(i,t))}function zL(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Xne(e){return function(){this.style.removeProperty(e)}}function Kne(e,t,i){return function(){this.style.setProperty(e,t,i)}}function Yne(e,t,i){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,i)}}function qne(e,t,i){return arguments.length>1?this.each((t==null?Xne:typeof t=="function"?Yne:Kne)(e,t,i??"")):Xf(this.node(),e)}function Xf(e,t){return e.style.getPropertyValue(t)||zL(e).getComputedStyle(e,null).getPropertyValue(t)}function Jne(e){return function(){delete this[e]}}function Zne(e,t){return function(){this[e]=t}}function eie(e,t){return function(){var i=t.apply(this,arguments);i==null?delete this[e]:this[e]=i}}function tie(e,t){return arguments.length>1?this.each((t==null?Jne:typeof t=="function"?eie:Zne)(e,t)):this.node()[e]}function jL(e){return e.trim().split(/^|\s+/)}function yw(e){return e.classList||new WL(e)}function WL(e){this._node=e,this._names=jL(e.getAttribute("class")||"")}WL.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function $L(e,t){for(var i=yw(e),r=-1,o=t.length;++r<o;)i.add(t[r])}function XL(e,t){for(var i=yw(e),r=-1,o=t.length;++r<o;)i.remove(t[r])}function nie(e){return function(){$L(this,e)}}function iie(e){return function(){XL(this,e)}}function rie(e,t){return function(){(t.apply(this,arguments)?$L:XL)(this,e)}}function sie(e,t){var i=jL(e+"");if(arguments.length<2){for(var r=yw(this.node()),o=-1,a=i.length;++o<a;)if(!r.contains(i[o]))return!1;return!0}return this.each((typeof t=="function"?rie:t?nie:iie)(i,t))}function oie(){this.textContent=""}function aie(e){return function(){this.textContent=e}}function lie(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function cie(e){return arguments.length?this.each(e==null?oie:(typeof e=="function"?lie:aie)(e)):this.node().textContent}function uie(){this.innerHTML=""}function hie(e){return function(){this.innerHTML=e}}function fie(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function die(e){return arguments.length?this.each(e==null?uie:(typeof e=="function"?fie:hie)(e)):this.node().innerHTML}function pie(){this.nextSibling&&this.parentNode.appendChild(this)}function mie(){return this.each(pie)}function Aie(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gie(){return this.each(Aie)}function vie(e){var t=typeof e=="function"?e:kL(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function bie(){return null}function yie(e,t){var i=typeof e=="function"?e:kL(e),r=t==null?bie:typeof t=="function"?t:bw(t);return this.select(function(){return this.insertBefore(i.apply(this,arguments),r.apply(this,arguments)||null)})}function _ie(){var e=this.parentNode;e&&e.removeChild(this)}function Eie(){return this.each(_ie)}function wie(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Cie(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xie(e){return this.select(e?Cie:wie)}function Mie(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Sie(e){return function(t){e.call(this,t,this.__data__)}}function Tie(e){return e.trim().split(/^|\s+/).map(function(t){var i="",r=t.indexOf(".");return r>=0&&(i=t.slice(r+1),t=t.slice(0,r)),{type:t,name:i}})}function Iie(e){return function(){var t=this.__on;if(t){for(var i=0,r=-1,o=t.length,a;i<o;++i)a=t[i],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function Bie(e,t,i){return function(){var r=this.__on,o,a=Sie(t);if(r){for(var h=0,u=r.length;h<u;++h)if((o=r[h]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=i),o.value=t;return}}this.addEventListener(e.type,a,i),o={type:e.type,name:e.name,value:t,listener:a,options:i},r?r.push(o):this.__on=[o]}}function Rie(e,t,i){var r=Tie(e+""),o,a=r.length,h;if(arguments.length<2){var u=this.node().__on;if(u){for(var p=0,c=u.length,f;p<c;++p)for(o=0,f=u[p];o<a;++o)if((h=r[o]).type===f.type&&h.name===f.name)return f.value}return}for(u=t?Bie:Iie,o=0;o<a;++o)this.each(u(r[o],t,i));return this}function KL(e,t,i){var r=zL(e),o=r.CustomEvent;typeof o=="function"?o=new o(t,i):(o=r.document.createEvent("Event"),i?(o.initEvent(t,i.bubbles,i.cancelable),o.detail=i.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function Lie(e,t){return function(){return KL(this,e,t)}}function Pie(e,t){return function(){return KL(this,e,t.apply(this,arguments))}}function Die(e,t){return this.each((typeof t=="function"?Pie:Lie)(e,t))}function*Nie(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var r=e[t],o=0,a=r.length,h;o<a;++o)(h=r[o])&&(yield h)}var Oie=[null];function Ra(e,t){this._groups=e,this._parents=t}function Gm(){return new Ra([[document.documentElement]],Oie)}function Fie(){return this}Ra.prototype=Gm.prototype={constructor:Ra,select:une,selectAll:dne,selectChild:gne,selectChildren:_ne,filter:Ene,data:Tne,enter:wne,exit:Ine,join:Bne,merge:Rne,selection:Fie,order:Lne,sort:Pne,call:Nne,nodes:One,node:Fne,size:kne,empty:Une,each:Gne,attr:$ne,style:qne,property:tie,classed:sie,text:cie,html:die,raise:mie,lower:gie,append:vie,insert:yie,remove:Eie,clone:xie,datum:Mie,on:Rie,dispatch:Die,[Symbol.iterator]:Nie};function _w(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function YL(e,t){var i=Object.create(e.prototype);for(var r in t)i[r]=t[r];return i}function Vm(){}var Xp=.7,e1=1/Xp,bf="\\s*([+-]?\\d+)\\s*",Kp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",El="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",kie=/^#([0-9a-f]{3,8})$/,Uie=new RegExp("^rgb\\("+[bf,bf,bf]+"\\)$"),Gie=new RegExp("^rgb\\("+[El,El,El]+"\\)$"),Vie=new RegExp("^rgba\\("+[bf,bf,bf,Kp]+"\\)$"),Qie=new RegExp("^rgba\\("+[El,El,El,Kp]+"\\)$"),Hie=new RegExp("^hsl\\("+[Kp,El,El]+"\\)$"),zie=new RegExp("^hsla\\("+[Kp,El,El,Kp]+"\\)$"),xT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_w(Vm,Kf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:MT,formatHex:MT,formatHsl:jie,formatRgb:ST,toString:ST});function MT(){return this.rgb().formatHex()}function jie(){return qL(this).formatHsl()}function ST(){return this.rgb().formatRgb()}function Kf(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=kie.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?TT(t):i===3?new sa(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?HA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?HA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Uie.exec(e))?new sa(t[1],t[2],t[3],1):(t=Gie.exec(e))?new sa(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Vie.exec(e))?HA(t[1],t[2],t[3],t[4]):(t=Qie.exec(e))?HA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Hie.exec(e))?RT(t[1],t[2]/100,t[3]/100,1):(t=zie.exec(e))?RT(t[1],t[2]/100,t[3]/100,t[4]):xT.hasOwnProperty(e)?TT(xT[e]):e==="transparent"?new sa(NaN,NaN,NaN,0):null}function TT(e){return new sa(e>>16&255,e>>8&255,e&255,1)}function HA(e,t,i,r){return r<=0&&(e=t=i=NaN),new sa(e,t,i,r)}function Wie(e){return e instanceof Vm||(e=Kf(e)),e?(e=e.rgb(),new sa(e.r,e.g,e.b,e.opacity)):new sa}function w_(e,t,i,r){return arguments.length===1?Wie(e):new sa(e,t,i,r??1)}function sa(e,t,i,r){this.r=+e,this.g=+t,this.b=+i,this.opacity=+r}_w(sa,w_,YL(Vm,{brighter:function(e){return e=e==null?e1:Math.pow(e1,e),new sa(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Xp:Math.pow(Xp,e),new sa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:IT,formatHex:IT,formatRgb:BT,toString:BT}));function IT(){return"#"+Zy(this.r)+Zy(this.g)+Zy(this.b)}function BT(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Zy(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function RT(e,t,i,r){return r<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new gl(e,t,i,r)}function qL(e){if(e instanceof gl)return new gl(e.h,e.s,e.l,e.opacity);if(e instanceof Vm||(e=Kf(e)),!e)return new gl;if(e instanceof gl)return e;e=e.rgb();var t=e.r/255,i=e.g/255,r=e.b/255,o=Math.min(t,i,r),a=Math.max(t,i,r),h=NaN,u=a-o,p=(a+o)/2;return u?(t===a?h=(i-r)/u+(i<r)*6:i===a?h=(r-t)/u+2:h=(t-i)/u+4,u/=p<.5?a+o:2-a-o,h*=60):u=p>0&&p<1?0:h,new gl(h,u,p,e.opacity)}function JL(e,t,i,r){return arguments.length===1?qL(e):new gl(e,t,i,r??1)}function gl(e,t,i,r){this.h=+e,this.s=+t,this.l=+i,this.opacity=+r}_w(gl,JL,YL(Vm,{brighter:function(e){return e=e==null?e1:Math.pow(e1,e),new gl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Xp:Math.pow(Xp,e),new gl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,r=i+(i<.5?i:1-i)*t,o=2*i-r;return new sa(e2(e>=240?e-240:e+120,o,r),e2(e,o,r),e2(e<120?e+240:e-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function e2(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}const ZL=e=>()=>e;function $ie(e,t){return function(i){return e+i*t}}function Xie(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(r){return Math.pow(e+r*t,i)}}function Kie(e){return(e=+e)==1?eP:function(t,i){return i-t?Xie(t,i,e):ZL(isNaN(t)?i:t)}}function eP(e,t){var i=t-e;return i?$ie(e,i):ZL(isNaN(e)?t:e)}const C_=function e(t){var i=Kie(t);function r(o,a){var h=i((o=w_(o)).r,(a=w_(a)).r),u=i(o.g,a.g),p=i(o.b,a.b),c=eP(o.opacity,a.opacity);return function(f){return o.r=h(f),o.g=u(f),o.b=p(f),o.opacity=c(f),o+""}}return r.gamma=e,r}(1);function Vc(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}var x_=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,t2=new RegExp(x_.source,"g");function Yie(e){return function(){return e}}function qie(e){return function(t){return e(t)+""}}function Jie(e,t){var i=x_.lastIndex=t2.lastIndex=0,r,o,a,h=-1,u=[],p=[];for(e=e+"",t=t+"";(r=x_.exec(e))&&(o=t2.exec(t));)(a=o.index)>i&&(a=t.slice(i,a),u[h]?u[h]+=a:u[++h]=a),(r=r[0])===(o=o[0])?u[h]?u[h]+=o:u[++h]=o:(u[++h]=null,p.push({i:h,x:Vc(r,o)})),i=t2.lastIndex;return i<t.length&&(a=t.slice(i),u[h]?u[h]+=a:u[++h]=a),u.length<2?p[0]?qie(p[0].x):Yie(t):(t=p.length,function(c){for(var f=0,g;f<t;++f)u[(g=p[f]).i]=g.x(c);return u.join("")})}var LT=180/Math.PI,M_={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tP(e,t,i,r,o,a){var h,u,p;return(h=Math.sqrt(e*e+t*t))&&(e/=h,t/=h),(p=e*i+t*r)&&(i-=e*p,r-=t*p),(u=Math.sqrt(i*i+r*r))&&(i/=u,r/=u,p/=u),e*r<t*i&&(e=-e,t=-t,p=-p,h=-h),{translateX:o,translateY:a,rotate:Math.atan2(t,e)*LT,skewX:Math.atan(p)*LT,scaleX:h,scaleY:u}}var zA;function Zie(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?M_:tP(t.a,t.b,t.c,t.d,t.e,t.f)}function ere(e){return e==null||(zA||(zA=document.createElementNS("http://www.w3.org/2000/svg","g")),zA.setAttribute("transform",e),!(e=zA.transform.baseVal.consolidate()))?M_:(e=e.matrix,tP(e.a,e.b,e.c,e.d,e.e,e.f))}function nP(e,t,i,r){function o(c){return c.length?c.pop()+" ":""}function a(c,f,g,m,v,A){if(c!==g||f!==m){var y=v.push("translate(",null,t,null,i);A.push({i:y-4,x:Vc(c,g)},{i:y-2,x:Vc(f,m)})}else(g||m)&&v.push("translate("+g+t+m+i)}function h(c,f,g,m){c!==f?(c-f>180?f+=360:f-c>180&&(c+=360),m.push({i:g.push(o(g)+"rotate(",null,r)-2,x:Vc(c,f)})):f&&g.push(o(g)+"rotate("+f+r)}function u(c,f,g,m){c!==f?m.push({i:g.push(o(g)+"skewX(",null,r)-2,x:Vc(c,f)}):f&&g.push(o(g)+"skewX("+f+r)}function p(c,f,g,m,v,A){if(c!==g||f!==m){var y=v.push(o(v)+"scale(",null,",",null,")");A.push({i:y-4,x:Vc(c,g)},{i:y-2,x:Vc(f,m)})}else(g!==1||m!==1)&&v.push(o(v)+"scale("+g+","+m+")")}return function(c,f){var g=[],m=[];return c=e(c),f=e(f),a(c.translateX,c.translateY,f.translateX,f.translateY,g,m),h(c.rotate,f.rotate,g,m),u(c.skewX,f.skewX,g,m),p(c.scaleX,c.scaleY,f.scaleX,f.scaleY,g,m),c=f=null,function(v){for(var A=-1,y=m.length,C;++A<y;)g[(C=m[A]).i]=C.x(v);return g.join("")}}}var tre=nP(Zie,"px, ","px)","deg)"),nre=nP(ere,", ",")",")"),Yf=0,fp=0,np=0,iP=1e3,t1,dp,n1=0,ah=0,rv=0,Yp=typeof performance=="object"&&performance.now?performance:Date,rP=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ew(){return ah||(rP(ire),ah=Yp.now()+rv)}function ire(){ah=0}function i1(){this._call=this._time=this._next=null}i1.prototype=sP.prototype={constructor:i1,restart:function(e,t,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?Ew():+i)+(t==null?0:+t),!this._next&&dp!==this&&(dp?dp._next=this:t1=this,dp=this),this._call=e,this._time=i,S_()},stop:function(){this._call&&(this._call=null,this._time=1/0,S_())}};function sP(e,t,i){var r=new i1;return r.restart(e,t,i),r}function rre(){Ew(),++Yf;for(var e=t1,t;e;)(t=ah-e._time)>=0&&e._call.call(null,t),e=e._next;--Yf}function PT(){ah=(n1=Yp.now())+rv,Yf=fp=0;try{rre()}finally{Yf=0,ore(),ah=0}}function sre(){var e=Yp.now(),t=e-n1;t>iP&&(rv-=t,n1=e)}function ore(){for(var e,t=t1,i,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(i=t._next,t._next=null,t=e?e._next=i:t1=i);dp=e,S_(r)}function S_(e){if(!Yf){fp&&(fp=clearTimeout(fp));var t=e-ah;t>24?(e<1/0&&(fp=setTimeout(PT,e-Yp.now()-rv)),np&&(np=clearInterval(np))):(np||(n1=Yp.now(),np=setInterval(sre,iP)),Yf=1,rP(PT))}}function DT(e,t,i){var r=new i1;return t=t==null?0:+t,r.restart(o=>{r.stop(),e(o+t)},t,i),r}var are=FL("start","end","cancel","interrupt"),lre=[],oP=0,NT=1,T_=2,rg=3,OT=4,I_=5,sg=6;function sv(e,t,i,r,o,a){var h=e.__transition;if(!h)e.__transition={};else if(i in h)return;cre(e,i,{name:t,index:r,group:o,on:are,tween:lre,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:oP})}function ww(e,t){var i=tl(e,t);if(i.state>oP)throw new Error("too late; already scheduled");return i}function Bl(e,t){var i=tl(e,t);if(i.state>rg)throw new Error("too late; already running");return i}function tl(e,t){var i=e.__transition;if(!i||!(i=i[t]))throw new Error("transition not found");return i}function cre(e,t,i){var r=e.__transition,o;r[t]=i,i.timer=sP(a,0,i.time);function a(c){i.state=NT,i.timer.restart(h,i.delay,i.time),i.delay<=c&&h(c-i.delay)}function h(c){var f,g,m,v;if(i.state!==NT)return p();for(f in r)if(v=r[f],v.name===i.name){if(v.state===rg)return DT(h);v.state===OT?(v.state=sg,v.timer.stop(),v.on.call("interrupt",e,e.__data__,v.index,v.group),delete r[f]):+f<t&&(v.state=sg,v.timer.stop(),v.on.call("cancel",e,e.__data__,v.index,v.group),delete r[f])}if(DT(function(){i.state===rg&&(i.state=OT,i.timer.restart(u,i.delay,i.time),u(c))}),i.state=T_,i.on.call("start",e,e.__data__,i.index,i.group),i.state===T_){for(i.state=rg,o=new Array(m=i.tween.length),f=0,g=-1;f<m;++f)(v=i.tween[f].value.call(e,e.__data__,i.index,i.group))&&(o[++g]=v);o.length=g+1}}function u(c){for(var f=c<i.duration?i.ease.call(null,c/i.duration):(i.timer.restart(p),i.state=I_,1),g=-1,m=o.length;++g<m;)o[g].call(e,f);i.state===I_&&(i.on.call("end",e,e.__data__,i.index,i.group),p())}function p(){i.state=sg,i.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function ure(e,t){var i=e.__transition,r,o,a=!0,h;if(i){t=t==null?null:t+"";for(h in i){if((r=i[h]).name!==t){a=!1;continue}o=r.state>T_&&r.state<I_,r.state=sg,r.timer.stop(),r.on.call(o?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete i[h]}a&&delete e.__transition}}function hre(e){return this.each(function(){ure(this,e)})}function fre(e,t){var i,r;return function(){var o=Bl(this,e),a=o.tween;if(a!==i){r=i=a;for(var h=0,u=r.length;h<u;++h)if(r[h].name===t){r=r.slice(),r.splice(h,1);break}}o.tween=r}}function dre(e,t,i){var r,o;if(typeof i!="function")throw new Error;return function(){var a=Bl(this,e),h=a.tween;if(h!==r){o=(r=h).slice();for(var u={name:t,value:i},p=0,c=o.length;p<c;++p)if(o[p].name===t){o[p]=u;break}p===c&&o.push(u)}a.tween=o}}function pre(e,t){var i=this._id;if(e+="",arguments.length<2){for(var r=tl(this.node(),i).tween,o=0,a=r.length,h;o<a;++o)if((h=r[o]).name===e)return h.value;return null}return this.each((t==null?fre:dre)(i,e,t))}function Cw(e,t,i){var r=e._id;return e.each(function(){var o=Bl(this,r);(o.value||(o.value={}))[t]=i.apply(this,arguments)}),function(o){return tl(o,r).value[t]}}function aP(e,t){var i;return(typeof t=="number"?Vc:t instanceof Kf?C_:(i=Kf(t))?(t=i,C_):Jie)(e,t)}function mre(e){return function(){this.removeAttribute(e)}}function Are(e){return function(){this.removeAttributeNS(e.space,e.local)}}function gre(e,t,i){var r,o=i+"",a;return function(){var h=this.getAttribute(e);return h===o?null:h===r?a:a=t(r=h,i)}}function vre(e,t,i){var r,o=i+"",a;return function(){var h=this.getAttributeNS(e.space,e.local);return h===o?null:h===r?a:a=t(r=h,i)}}function bre(e,t,i){var r,o,a;return function(){var h,u=i(this),p;return u==null?void this.removeAttribute(e):(h=this.getAttribute(e),p=u+"",h===p?null:h===r&&p===o?a:(o=p,a=t(r=h,u)))}}function yre(e,t,i){var r,o,a;return function(){var h,u=i(this),p;return u==null?void this.removeAttributeNS(e.space,e.local):(h=this.getAttributeNS(e.space,e.local),p=u+"",h===p?null:h===r&&p===o?a:(o=p,a=t(r=h,u)))}}function _re(e,t){var i=iv(e),r=i==="transform"?nre:aP;return this.attrTween(e,typeof t=="function"?(i.local?yre:bre)(i,r,Cw(this,"attr."+e,t)):t==null?(i.local?Are:mre)(i):(i.local?vre:gre)(i,r,t))}function Ere(e,t){return function(i){this.setAttribute(e,t.call(this,i))}}function wre(e,t){return function(i){this.setAttributeNS(e.space,e.local,t.call(this,i))}}function Cre(e,t){var i,r;function o(){var a=t.apply(this,arguments);return a!==r&&(i=(r=a)&&wre(e,a)),i}return o._value=t,o}function xre(e,t){var i,r;function o(){var a=t.apply(this,arguments);return a!==r&&(i=(r=a)&&Ere(e,a)),i}return o._value=t,o}function Mre(e,t){var i="attr."+e;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;var r=iv(e);return this.tween(i,(r.local?Cre:xre)(r,t))}function Sre(e,t){return function(){ww(this,e).delay=+t.apply(this,arguments)}}function Tre(e,t){return t=+t,function(){ww(this,e).delay=t}}function Ire(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Sre:Tre)(t,e)):tl(this.node(),t).delay}function Bre(e,t){return function(){Bl(this,e).duration=+t.apply(this,arguments)}}function Rre(e,t){return t=+t,function(){Bl(this,e).duration=t}}function Lre(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Bre:Rre)(t,e)):tl(this.node(),t).duration}function Pre(e,t){if(typeof t!="function")throw new Error;return function(){Bl(this,e).ease=t}}function Dre(e){var t=this._id;return arguments.length?this.each(Pre(t,e)):tl(this.node(),t).ease}function Nre(e,t){return function(){var i=t.apply(this,arguments);if(typeof i!="function")throw new Error;Bl(this,e).ease=i}}function Ore(e){if(typeof e!="function")throw new Error;return this.each(Nre(this._id,e))}function Fre(e){typeof e!="function"&&(e=VL(e));for(var t=this._groups,i=t.length,r=new Array(i),o=0;o<i;++o)for(var a=t[o],h=a.length,u=r[o]=[],p,c=0;c<h;++c)(p=a[c])&&e.call(p,p.__data__,c,a)&&u.push(p);return new mc(r,this._parents,this._name,this._id)}function kre(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,i=e._groups,r=t.length,o=i.length,a=Math.min(r,o),h=new Array(r),u=0;u<a;++u)for(var p=t[u],c=i[u],f=p.length,g=h[u]=new Array(f),m,v=0;v<f;++v)(m=p[v]||c[v])&&(g[v]=m);for(;u<r;++u)h[u]=t[u];return new mc(h,this._parents,this._name,this._id)}function Ure(e){return(e+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||t==="start"})}function Gre(e,t,i){var r,o,a=Ure(t)?ww:Bl;return function(){var h=a(this,e),u=h.on;u!==r&&(o=(r=u).copy()).on(t,i),h.on=o}}function Vre(e,t){var i=this._id;return arguments.length<2?tl(this.node(),i).on.on(e):this.each(Gre(i,e,t))}function Qre(e){return function(){var t=this.parentNode;for(var i in this.__transition)if(+i!==e)return;t&&t.removeChild(this)}}function Hre(){return this.on("end.remove",Qre(this._id))}function zre(e){var t=this._name,i=this._id;typeof e!="function"&&(e=bw(e));for(var r=this._groups,o=r.length,a=new Array(o),h=0;h<o;++h)for(var u=r[h],p=u.length,c=a[h]=new Array(p),f,g,m=0;m<p;++m)(f=u[m])&&(g=e.call(f,f.__data__,m,u))&&("__data__"in f&&(g.__data__=f.__data__),c[m]=g,sv(c[m],t,i,m,c,tl(f,i)));return new mc(a,this._parents,t,i)}function jre(e){var t=this._name,i=this._id;typeof e!="function"&&(e=GL(e));for(var r=this._groups,o=r.length,a=[],h=[],u=0;u<o;++u)for(var p=r[u],c=p.length,f,g=0;g<c;++g)if(f=p[g]){for(var m=e.call(f,f.__data__,g,p),v,A=tl(f,i),y=0,C=m.length;y<C;++y)(v=m[y])&&sv(v,t,i,y,m,A);a.push(m),h.push(f)}return new mc(a,h,t,i)}var Wre=Gm.prototype.constructor;function $re(){return new Wre(this._groups,this._parents)}function Xre(e,t){var i,r,o;return function(){var a=Xf(this,e),h=(this.style.removeProperty(e),Xf(this,e));return a===h?null:a===i&&h===r?o:o=t(i=a,r=h)}}function lP(e){return function(){this.style.removeProperty(e)}}function Kre(e,t,i){var r,o=i+"",a;return function(){var h=Xf(this,e);return h===o?null:h===r?a:a=t(r=h,i)}}function Yre(e,t,i){var r,o,a;return function(){var h=Xf(this,e),u=i(this),p=u+"";return u==null&&(p=u=(this.style.removeProperty(e),Xf(this,e))),h===p?null:h===r&&p===o?a:(o=p,a=t(r=h,u))}}function qre(e,t){var i,r,o,a="style."+t,h="end."+a,u;return function(){var p=Bl(this,e),c=p.on,f=p.value[a]==null?u||(u=lP(t)):void 0;(c!==i||o!==f)&&(r=(i=c).copy()).on(h,o=f),p.on=r}}function Jre(e,t,i){var r=(e+="")=="transform"?tre:aP;return t==null?this.styleTween(e,Xre(e,r)).on("end.style."+e,lP(e)):typeof t=="function"?this.styleTween(e,Yre(e,r,Cw(this,"style."+e,t))).each(qre(this._id,e)):this.styleTween(e,Kre(e,r,t),i).on("end.style."+e,null)}function Zre(e,t,i){return function(r){this.style.setProperty(e,t.call(this,r),i)}}function ese(e,t,i){var r,o;function a(){var h=t.apply(this,arguments);return h!==o&&(r=(o=h)&&Zre(e,h,i)),r}return a._value=t,a}function tse(e,t,i){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,ese(e,t,i??""))}function nse(e){return function(){this.textContent=e}}function ise(e){return function(){var t=e(this);this.textContent=t??""}}function rse(e){return this.tween("text",typeof e=="function"?ise(Cw(this,"text",e)):nse(e==null?"":e+""))}function sse(e){return function(t){this.textContent=e.call(this,t)}}function ose(e){var t,i;function r(){var o=e.apply(this,arguments);return o!==i&&(t=(i=o)&&sse(o)),t}return r._value=e,r}function ase(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,ose(e))}function lse(){for(var e=this._name,t=this._id,i=cP(),r=this._groups,o=r.length,a=0;a<o;++a)for(var h=r[a],u=h.length,p,c=0;c<u;++c)if(p=h[c]){var f=tl(p,t);sv(p,e,i,c,h,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new mc(r,this._parents,e,i)}function cse(){var e,t,i=this,r=i._id,o=i.size();return new Promise(function(a,h){var u={value:h},p={value:function(){--o===0&&a()}};i.each(function(){var c=Bl(this,r),f=c.on;f!==e&&(t=(e=f).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(p)),c.on=t}),o===0&&a()})}var use=0;function mc(e,t,i,r){this._groups=e,this._parents=t,this._name=i,this._id=r}function cP(){return++use}var ku=Gm.prototype;mc.prototype={constructor:mc,select:zre,selectAll:jre,filter:Fre,merge:kre,selection:$re,transition:lse,call:ku.call,nodes:ku.nodes,node:ku.node,size:ku.size,empty:ku.empty,each:ku.each,on:Vre,attr:_re,attrTween:Mre,style:Jre,styleTween:tse,text:rse,textTween:ase,remove:Hre,tween:pre,delay:Ire,duration:Lre,ease:Dre,easeVarying:Ore,end:cse,[Symbol.iterator]:ku[Symbol.iterator]};function hse(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var fse={time:null,delay:0,duration:250,ease:hse};function dse(e,t){for(var i;!(i=e.__transition)||!(i=i[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return i}function pse(e){var t,i;e instanceof mc?(t=e._id,e=e._name):(t=cP(),(i=fse).time=Ew(),e=e==null?null:e+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var h=r[a],u=h.length,p,c=0;c<u;++c)(p=h[c])&&sv(p,e,t,c,h,i||dse(p,t));return new mc(r,this._parents,e,t)}Gm.prototype.interrupt=hre;Gm.prototype.transition=pse;function pp(e,t,i){this.k=e,this.x=t,this.y=i}pp.prototype={constructor:pp,scale:function(e){return e===1?this:new pp(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new pp(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};pp.prototype;function mse(e,t,i){return Math.max(t,Math.min(i,e))}class df{constructor(t=[],i=!1){i?this._notes=t:this._notes=t.map(r=>r.string!==void 0&&r.fret!==void 0?ff.from(r):cc.from(r))}getNotes(){return this._notes}setNotes(t){return this._notes=t,this}*[Symbol.iterator](){for(const t of this._notes)yield t}addNotes(t,i=!0){return this._notes=[...this._notes,...t],i&&this.sortByTime(),this}concat(t){return this._notes=[...this._notes,...t._notes],this}append(t,i=0){const r=this.getDuration(),o=t.clone();return o.shiftTime(r+i),this._notes=[...this._notes,...o._notes],this.sortByTime(),this}repeat(t){const i=this.clone();if(t<1)return new df;if(t===1)return i;const r=this.clone(),o=this.getDuration();for(let a=1;a<t;a++)r.shiftTime(o),i.concat(r);return i}length(){return this._notes.length}getStartTime(){return ine(this._notes,t=>t.start)}getDuration(){let t=0;for(const i of this._notes){const r=i.end===null?i.start:i.end;r>t&&(t=r)}return t}scaleTime(t){return this._notes=this._notes.map(i=>i.scaleTime(t)),this}shiftTime(t){return this._notes=this._notes.map(i=>i.shiftTime(t)),this}shiftToStartAt(t){this.sortByTime();const r=this._notes[0].start-t;return this._notes.forEach(o=>{o.start-=r,o.end!==null&&(o.end-=r)}),this}forEach(t){return this._notes.forEach((i,r,o)=>t(i,r,o)),this}sort(t){return this._notes=this._notes.sort(t),this}sortByTime(){return this._notes=this._notes.sort((t,i)=>t.start-i.start),this}map(t){return this._notes=this._notes.map((i,r,o)=>t(i,r,o)),this}slice(t,i){return this._notes=this._notes.slice(t,i),this}sliceTime(t,i,r="contained"){const o=t,a=i;let h;if(r==="start")h=u=>u.start>=o&&u.start<a;else if(r==="end")h=u=>u.end!==null&&u.end>=o&&u.end<a;else if(r==="contained")h=u=>u.end!==null&&u.start>=o&&u.end<a;else if(r==="touched")h=u=>u.start>=o&&u.start<=a||u.end!==null&&u.end>=o&&u.end<=a;else if(r==="touched-included")h=u=>u.start>=o&&u.start<=a||u.end!==null&&u.end>=o&&u.end<=a||u.end!==null&&u.start<=o&&u.end>=a;else throw new Error("Invalid slicing mode");return this._notes=this._notes.filter(h),this}sliceAtTimes(t,i,r=!1){if(t.length===0)return[this._notes];const o=this.getDuration();Math.max(...t)<=o&&t.push(o+1);const a=[];let h=0;for(const u of t)a.push(new df(this._notes,r).sliceTime(h,u,i).getNotes()),h=u;return a}segmentAtGaps(t,i){if(this._notes.length<2)return[this._notes];if(i==="start-start"){const r=this.clone().sortByTime().getNotes(),o=[];for(let a=1;a<r.length;a++)r[a].start-r[a-1].start>=t&&o.push(r[a].start);return this.sliceAtTimes(o,"start")}else{const r=[];for(const a of this._notes){const{start:h,end:u}=a,p=[];for(let c=0;c<r.length;c++){const[f,g]=r[c];(f>=h&&f<=u||g>=h&&g<=u)&&(r.splice(c,1),p.push([f,g]))}if(p.length===0)r.push([h,u]);else{const c=Math.min(h,...p.map(g=>g[0])),f=Math.max(u,...p.map(g=>g[1]));r.push([c,f])}}if(r.length===1)return[this._notes];const o=[];for(let a=1;a<r.length;a++){const h=r[a][0],u=r[a-1][1];h-u>=t&&o.push(h)}return this.sliceAtTimes(o,"start")}}segmentAtIndices(t){const i=[];let r=0;for(const o of t)i.push(this._notes.slice(r,o)),r=o;return i}filter(t){return this._notes=this._notes.filter((i,r,o)=>t(i,r,o)),this}filterPitches(t){return t instanceof Set||(t=new Set(t)),this._notes=this._notes.filter(i=>t.has(i.pitch)),this}transpose(t){return this._notes=this._notes.map(i=>cc.from({...i,pitch:mse(i.pitch+t,0,127)})),this}removeOctaves(){return this._notes=this._notes.map(t=>cc.from({...t,pitch:t.pitch%12})),this}reverse(){const t=this.getDuration();return this._notes=this._notes.map(i=>{const r=i.clone();return r.start=t-i.end,r.end=r.start+i.getDuration(),r}),this.sortByTime(),this}equals(t){if(!(t instanceof df))return!1;const i=t.getNotes();if(this._notes.length!==i.length)return!1;for(const[r,o]of i.entries())if(!this._notes[r].equals(o))return!1;return!0}clone(){return new df(this._notes)}}var Ase={exports:{}};(function(e){(function(){const t=function(r){let o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/;if(r=r.replace(/^.*?base64,/,""),r=String(r).replace(/[\t\n\f\r ]+/g,""),!a.test(r))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");r+="==".slice(2-(r.length&3));let h,u="",p,c,f=0;for(;f<r.length;)h=o.indexOf(r.charAt(f++))<<18|o.indexOf(r.charAt(f++))<<12|(p=o.indexOf(r.charAt(f++)))<<6|(c=o.indexOf(r.charAt(f++))),u+=p===64?String.fromCharCode(h>>16&255):c===64?String.fromCharCode(h>>16&255,h>>8&255):String.fromCharCode(h>>16&255,h>>8&255,h&255);return u},i={debug:!1,parse:function(r,o){if(r instanceof Uint8Array)return i.Uint8(r);if(typeof r=="string")return i.Base64(r);if(r instanceof HTMLElement&&r.type==="file")return i.addListener(r,o);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(r,o){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(r===void 0||!(r instanceof HTMLElement)||r.tagName!=="INPUT"||r.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;o=o||function(){},r.addEventListener("change",function(a){if(!a.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let h=new FileReader;h.readAsArrayBuffer(a.target.files[0]),h.onload=function(u){o(i.Uint8(new Uint8Array(u.target.result)))}})},Base64:function(r){r=String(r);let o=t(r),a=o.length,h=new Uint8Array(new ArrayBuffer(a));for(let u=0;u<a;u++)h[u]=o.charCodeAt(u);return i.Uint8(h)},Uint8:function(r){let o={data:null,pointer:0,movePointer:function(p){return this.pointer+=p,this.pointer},readInt:function(p){if(p=Math.min(p,this.data.byteLength-this.pointer),p<1)return-1;let c=0;if(p>1)for(let f=1;f<=p-1;f++)c+=this.data.getUint8(this.pointer)*Math.pow(256,p-f),this.pointer++;return c+=this.data.getUint8(this.pointer),this.pointer++,c},readStr:function(p){let c="";for(let f=1;f<=p;f++)c+=String.fromCharCode(this.readInt(1));return c},readIntVLV:function(){let p=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)p=this.readInt(1);else{let c=[];for(;this.data.getUint8(this.pointer)>=128;)c.push(this.readInt(1)-128);let f=this.readInt(1);for(let g=1;g<=c.length;g++)p+=c[c.length-g]*Math.pow(128,g);p+=f}return p}};if(o.data=new DataView(r.buffer,r.byteOffset,r.byteLength),o.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;o.readInt(4);let a={};a.formatType=o.readInt(2),a.tracks=o.readInt(2),a.track=[];let h=o.readInt(1),u=o.readInt(1);h>=128?(a.timeDivision=[],a.timeDivision[0]=h-128,a.timeDivision[1]=u):a.timeDivision=h*256+u;for(let p=1;p<=a.tracks;p++){a.track[p-1]={event:[]};let c=o.readInt(4);if(c===-1)break;if(c!==1297379947)return!1;o.readInt(4);let f=0,g=!1,m,v;for(;!g&&(f++,a.track[p-1].event[f-1]={},a.track[p-1].event[f-1].deltaTime=o.readIntVLV(),m=o.readInt(1),m!==-1);)if(m>=128?v=m:(m=v,o.movePointer(-1)),m===255){a.track[p-1].event[f-1].type=255,a.track[p-1].event[f-1].metaType=o.readInt(1);let A=o.readIntVLV();switch(a.track[p-1].event[f-1].metaType){case 47:case-1:g=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:a.track[p-1].event[f-1].data=o.readStr(A);break;case 33:case 89:case 81:a.track[p-1].event[f-1].data=o.readInt(A);break;case 84:a.track[p-1].event[f-1].data=[],a.track[p-1].event[f-1].data[0]=o.readInt(1),a.track[p-1].event[f-1].data[1]=o.readInt(1),a.track[p-1].event[f-1].data[2]=o.readInt(1),a.track[p-1].event[f-1].data[3]=o.readInt(1),a.track[p-1].event[f-1].data[4]=o.readInt(1);break;case 88:a.track[p-1].event[f-1].data=[],a.track[p-1].event[f-1].data[0]=o.readInt(1),a.track[p-1].event[f-1].data[1]=o.readInt(1),a.track[p-1].event[f-1].data[2]=o.readInt(1),a.track[p-1].event[f-1].data[3]=o.readInt(1);break;default:this.customInterpreter!==null&&(a.track[p-1].event[f-1].data=this.customInterpreter(a.track[p-1].event[f-1].metaType,o,A)),(this.customInterpreter===null||a.track[p-1].event[f-1].data===!1)&&(o.readInt(A),a.track[p-1].event[f-1].data=o.readInt(A),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch(m=m.toString(16).split(""),m[1]||m.unshift("0"),a.track[p-1].event[f-1].type=parseInt(m[0],16),a.track[p-1].event[f-1].channel=parseInt(m[1],16),a.track[p-1].event[f-1].type){case 15:{if(this.customInterpreter!==null&&(a.track[p-1].event[f-1].data=this.customInterpreter(a.track[p-1].event[f-1].type,o,!1)),this.customInterpreter===null||a.track[p-1].event[f-1].data===!1){let A=o.readIntVLV();a.track[p-1].event[f-1].data=o.readInt(A),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer")}break}case 10:case 11:case 14:case 8:case 9:a.track[p-1].event[f-1].data=[],a.track[p-1].event[f-1].data[0]=o.readInt(1),a.track[p-1].event[f-1].data[1]=o.readInt(1);break;case 12:case 13:a.track[p-1].event[f-1].data=o.readInt(1);break;case-1:g=!0;break;default:if(this.customInterpreter!==null&&(a.track[p-1].event[f-1].data=this.customInterpreter(a.track[p-1].event[f-1].metaType,o,!1)),this.customInterpreter===null||a.track[p-1].event[f-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return a},customInterpreter:null};e.exports=i})()})(Ase);function xs(e){return 1/(e/60)}const uP=[],gse=[2,1,1/2,1/4,1/8,1/16,1/32,1/64];for(const e of gse)for(let t=0;t<4;t++){let i=e,r=e;for(let o=0;o<t;o++)r/=2,i+=r;uP.push({type:e,dots:t,duration:i})}uP.sort((e,t)=>e.duration-t.duration);function B_(e,t,i,r){e.beginPath(),e.arc(t,i,r,0,2*Math.PI),e.stroke()}class Si{constructor(t,i){this.name=t,this.notes=i,this.short=i.join(" "),this.pitches=i.map(r=>nv(r).pitch),this.stringCount=i.length}}const vse=new Map([["Guitar",new Map([[6,[new Si("E stand.",["E2","A2","D3","G3","B3","E4"]),new Si("Drop D",["D2","A2","D3","G3","B3","E4"]),new Si("Drop C",["C2","G2","C3","F3","A3","D4"]),new Si("1/2 down",["D#2","G#2","C#3","F#3","A#3","D#4"]),new Si("1 down",["D2","G2","C3","F3","A3","D4"]),new Si("1 1/2 down",["C#2","F#2","B2","E3","G#3","C#4"]),new Si("2 down",["C2","F2","A#2","D#3","G3","C4"]),new Si("DADGAG",["D2","A2","D3","G3","A3","D4"])]],[7,[new Si("B stand.",["B1","E2","A2","D3","G3","B3","E4"]),new Si("Drop A",["A1","E2","A2","D3","G3","B3","E4"]),new Si("1/2 down",["A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new Si("1 down",["A1","D2","G2","C3","F3","A3","D4"]),new Si("1 1/2 down",["G#1","C#2","F#2","B2","E3","G#3","C#4"]),new Si("2 down",["G1","C2","F2","A#2","D#3","G3","C4"])]],[8,[new Si("F# stand.",["F#1","B1","E2","A2","D3","G3","B3","E4"]),new Si("Drop E",["E1","B1","E2","A2","D3","G3","B3","E4"]),new Si("1/2 down",["F1","A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new Si("1 down",["E1","A1","D2","G2","C3","F3","A3","D4"]),new Si("1 1/2 down",["D#1","G#1","C#2","F#2","B2","E3","G#3","C#4"]),new Si("2 down",["D1","G1","C2","F2","A#2","D#3","G3","C4"])]]])],["Bass",new Map([[4,[new Si("E stand.",["E1","A1","D2","G2"]),new Si("Drop D",["D1","A1","D2","G2"]),new Si("1/2 down",["D#1","G#1","C#2","F#2"]),new Si("1 down",["D1","G1","C2","F2"]),new Si("1 1/2 down",["C#1","F#1","B1","E2"]),new Si("2 down",["C1","F1","A#1","D#2"])]],[5,[new Si("B stand.",["B0","E1","A1","D2","G2"]),new Si("Drop A",["A0","D1","A1","D2","G2"]),new Si("1/2 down",["A#0","D#1","G#1","C#2","F#2"]),new Si("1 down",["A0","D1","G1","C2","F2"]),new Si("1 1/2 down",["G#0","C#1","F#1","B1","E2"]),new Si("2 down",["G0","C1","F1","A#1","D#2"])]],[6,[new Si("F# stand.",["F#0","B0","E1","A1","D2","G2"]),new Si("Drop E",["E0","A0","D1","A1","D2","G2"]),new Si("1/2 down",["F0","A#0","D#1","G#1","C#2","F#2"]),new Si("1 down",["E1","A0","D1","G1","C2","F2"]),new Si("1 1/2 down",["D#0","G#0","C#1","F#1","B1","E2"]),new Si("2 down",["D0","G0","C1","F1","A#1","D#2"])]]])],["Ukulele",new Map([[4,[new Si("Hawaii",["G4","C4","E4","A4"]),new Si("Low G",["G3","C4","E4","A4"]),new Si("D-tuning",["A4","D4","F#4","B4"]),new Si("Canadian",["A3","D4","F#4","B4"]),new Si("Bariton",["D3","G3","B3","E4"])]]])]]);class Uc{constructor(t,i){this.name=t,this.notes=i,this.short=i.join(" "),this.pitches=i.map(r=>nv(r).pitch),this.pitchesSorted=[...this.pitches].sort((r,o)=>r-o),this.keyCount=i.length}getNumbers(){const t=this.pitchesSorted,i=new Map;for(const[r,o]of t.entries()){let a=r+1,h="",u=o-12;for(;u>0&&i.has(u);)a=i.get(u).number,h+="",u-=12;i.set(o,{number:a,numberString:`${a}${h}`})}return[...i.values()].map(r=>r.numberString)}getLetters(){const t=this.pitchesSorted,i=new Map;for(const[r,o]of t.entries()){let a=r+1,h="",u=o-12;for(;u>0&&i.has(u);)a=i.get(u).number,h+="",u-=12;const p=ng(o).name;i.set(o,{number:a,letterString:`${p}${h}`})}return[...i.values()].map(r=>r.letterString)}}new Uc("9 A Major",["A5","C#6","C#5","A5","A4","F#5","E5","E6","B5"]),new Uc("9 A Minor",["A5","C6","C5","A5","A4","F5","E5","E6","B5"]),new Uc("9 A Minor 7",["A5","C6","C5","A5","A4","F#5","E5","E6","B5"]),new Uc("9 A Ake Bono",["A5","D6","D5","A5","A4","F5","E5","E6","A#5"]),new Uc("9 A Hijaz",["G5","D6","D5","A5","A4","F#5","D#5","D#6","A#5"]),new Uc("9 A Pygmy",["G5","C6","C5","G5","G4","D#5","D5","D#6","A#5"]),new Uc("17 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","C4","E4","G4","B4","D5","F5","A5","C6","E6"]),new Uc("21 C Major",["D6","B5","G5","E5","C5","A4","F4","D4","B3","G3","F3","A3","C4","E4","G4","B4","D5","F5","A5","C6","E6"]);function bse(e){const{r:t,g:i,b:r}=Kf(e).rgb();return(t+t+t+r+i+i+i+i>>3)/2.55}function yse(e,t=1){const i=JL(e);return i.s=t,i.toString()}const _se=["#ff0000","#ff4e00","#db7b00","#ffcc00","#e4ed00","#81d700","#00ffb4","#00ffea","#00baff","#3c00ff","#a800ff","#ff00fd"].map(e=>yse(e,.5)),Ese=["#6699ff","#66ffff","#000000","#647878","#993366","#ff0000","#ffcc99","#ffff01","#ff9900","#009900","#66ff99","#0000cc"],wse=["#9aebff","#add5ff","#d6d6ff","#ebd5ff","#ffc2eb","#ffcbcc","#ffd5c2","#ffebc2","#ebffc2","#c2d599","#99ebbe","#adebeb"],Cse=["#FA0B0C","#FA0B0C","#F88010","#F88010","#F5F43C","#149033","#149033","#FA0B0C","#FA0B0C","#7F087C","#7F087C","#908791"],xse=["#1C0D82","#F5F5F5","#149033","#709226","#F5F43C","#F5D23B","#F88010","#FA0B0C","#A00C09","#D71386","#4B0E7D","#7F087C"],Mse=["#1C0D82","#1C0D82","#7F087C","#7F087C","#FA0B0C","#F88010","#F88010","#F5F43C","#F5F43C","#709226","#709226","#149033"],Sse=["#FA0B0C","#F44712","#F88010","#F5D23B","#F5F43C","#149033","#1B9081","#1C0D82","#4B0E7D","#7F087C","#A61586","#D71386"],Tse=["#6A1C1C","#FA0B0C","#F88010","#F5D23B","#F5F43C","#709226","#1B9081","#1C0D82","#7F087C","#D71386","#6A1C1C","#070707"],Ise=["#FA0B0C","#A00C09","#F44712","#F88010","#F5F43C","#709226","#149033","#27A481","#1B9081","#7F087C","#1C0D82","#D71386"],Bse=["#FA0B0C","#A00C09","#F88010","#F6D111","#F5F43C","#BCE039","#149033","#27A481","#7F087C","#D71386","#D91951","#FA0B0C"],Rse=["#F5F43C","#149033","#1B9081","#1C5BA0","#7F087C","#D71386","#9D0E55","#FA0B0C","#D32C0A","#D32C0A","#F62E0D","#F17A0F"],Lse=["#FA0B0C","#D71386","#F5F43C","#5A5685","#1C5BA0","#A00C09","#1C0D82","#F88010","#7F087C","#149033","#5A5685","#1C5BA0"],Pse=["#C40A09","#FA0B0C","#F44712","#F88010","#F5F43C","#BCE039","#149033","#1B9081","#1C0D82","#781887","#D71386","#9D0E55"],Dse=["#FA0B0C","#FA0B0C","#F88010","#F88010","#F5F43C","#F5F43C","#149033","#1B9081","#1B9081","#1C5BA0","#4B0E7D","#7F087C"],Nse=["#FA0B0C","#F44712","#F88010","#F6D111","#F5F43C","#BCE039","#149033","#1B9081","#1C0D82","#A61586","#D71386","#AD0E48"],Ose=["#BCE039","#149033","#1B9081","#1C0D82","#7F087C","#D71386","#6F0D45","#A00C09","#FA0B0C","#F88010","#EDF087","#F5F43C"],Fse=C_("black","steelblue");Array.from({length:12}).map((e,t)=>Fse(t/11));function kse(e,t,i){const r=e.slice();return r[16]=t[i],r}function Use(e){let t;return{c(){t=oe("option"),t.textContent=`${e[16]}`,t.__value=e[16],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Gse(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P=fn(["velocity","piano","channel","none"]),F=[];for(let O=0;O<4;O+=1)F[O]=Use(kse(e,P,O));return I=new Nr({props:{noteOn:e[7],noteOff:e[8]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`The guitar tab below shows incoming MIDI notes as rectangles with their
        string (y position) and start and end times (x left and right side of
        the rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`color
            `),g=oe("select");for(let O=0;O<4;O+=1)F[O].c();m=ge(),v=oe("label"),A=$e(`time
            `),y=oe("input"),C=ge(),E=oe("div"),x=ge(),M=oe("div"),w=oe("button"),w.textContent="reset",S=ge(),Ut(I.$$.fragment),fe(h,"class","explanation"),e[3]===void 0&&yr(()=>e[9].call(g)),fe(y,"type","number"),fe(y,"min","10"),fe(y,"max","300"),fe(y,"step","10"),fe(v,"title","time in seconds for past notes to be shown"),fe(p,"class","control"),fe(E,"class","visualization"),fe(w,"title","Clear all played notes"),fe(M,"class","control"),fe(t,"class","demo")},m(O,W){Bt(O,t,W),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let V=0;V<4;V+=1)F[V]&&F[V].m(g,null);ci(g,e[3],!0),D(p,m),D(p,v),D(v,A),D(v,y),ln(y,e[2]),D(t,C),D(t,E),e[11](E),D(t,x),D(t,M),D(M,w),D(t,S),Ft(I,t,null),L=!0,R||(k=[lt(g,"change",e[9]),lt(y,"input",e[10]),lt(w,"click",e[12])],R=!0)},p(O,[W]){(!L||W&1)&&r!==(r=O[0].title+"")&&jt(o,r),W&8&&ci(g,O[3]),W&4&&Yn(y.value)!==O[2]&&ln(y,O[2])},i(O){L||(Nt(I.$$.fragment,O),L=!0)},o(O){Ot(I.$$.fragment,O),L=!1},d(O){O&&It(t),ti(F,O),e[11](null),kt(I),R=!1,ji(k)}}}let Vse=1e3,Qse=500,Hse=6;function zse(e,t,i){let{toolInfo:r}=t,o=[64,59,55,50,45,40],a,h=30,u="velocity",p=0,c=[],f=new Map,g=null;const m=M=>{const w=(M.timestamp-p)/1e3,S=M.message.channel-1,I={number:M.note.number,velocity:M.rawVelocity,time:w,channel:M.message.channel,string:S,fret:M.note.number-o[S]};if(f.has(M.note.number)){const L=f.get(M.note.number);L.end===void 0&&(L.end=w)}c.push(I),f.set(M.note.number,I)},v=M=>{if(f.has(M.note.number)){const w=f.get(M.note.number),S=(M.timestamp-p)/1e3;w.end=S}},A=()=>{const M=(performance.now()-p)/1e3,w=M-h,S=c.filter(F=>F.end>w||F.end===void 0),I=Ms(S,F=>F.number),L=o.map(Ss.fromMidiSharps);let R,k;u==="velocity"?(R={label:"Note velocity",scheme:"blues",domain:[0,127]},k="velocity"):u==="piano"?(R={label:"Piano key color",domain:["black","white"],range:["black","white"]},k=F=>Mp(F.number)?"black":"white"):u==="channel"?(R={type:"categorical",label:"MIDI channel",scheme:"tableau10"},k=F=>F.channel):u==="none"&&(k="#ddd");const P=Ji({insetRight:10,width:Vse,height:Qse,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[w,M]},y:{label:"String",grid:!0,domain:Mn(0,Hse),tickFormat:F=>L[F]},color:{...R,legend:u!=="none",marginLeft:100,width:300},marks:[hs(Mn(Math.ceil((I[0]-1)/12)*12,I[1]+2,12)),no([M],{stroke:"#888"}),km(S,{clip:!0,x1:"time",x2:F=>F.end===void 0?M:Math.max(F.end,F.time+.025),y:"string",fill:k,stroke:"#ccc",rx:5}),Ba(S,{clip:!0,x:"time",y:"string",fill:"black",stroke:"white",text:"fret",textAnchor:"start",dx:2})]});i(1,a.textContent="",a),a.appendChild(P),g=requestAnimationFrame(A)};tr(()=>{i(4,p=performance.now()),g=requestAnimationFrame(A)}),Io(()=>{cancelAnimationFrame(g)});function y(){u=Dr(this),i(3,u)}function C(){h=Yn(this.value),i(2,h)}function E(M){In[M?"unshift":"push"](()=>{a=M,i(1,a)})}const x=()=>{confirm("Reset played notes?")&&(i(5,c=[]),i(6,f=new Map),i(4,p=performance.now()))};return e.$$set=M=>{"toolInfo"in M&&i(0,r=M.toolInfo)},[r,a,h,u,p,c,f,m,v,y,C,E,x]}class jse extends pi{constructor(t){super(),di(this,t,zse,Gse,fi,{toolInfo:0})}}function Wse(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y=e[3]?"":"",C,E,x,M,w=e[4]?"":"",S,I,L,R,k,P,F,O,W=e[1]>=6?"guitar":"bass guitar",V,$,H=e[2]===0?"in standard tuning":`${Math.abs(e[2])} ${e[2]<0?"steps down":"steps up"}`,Y,Q,G=e[3]?"and dropped":"",J,K,se,ue,he,Me,de,Pe,Se,Le;return{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("label"),u=$e(`strings
        `),p=oe("input"),c=ge(),f=oe("label"),g=$e(`tune up/down (semitones)
        `),m=oe("input"),v=ge(),A=oe("button"),C=$e(y),E=$e(" dropped"),x=ge(),M=oe("button"),S=$e(w),I=$e(" octave shown"),L=ge(),R=oe("div"),k=oe("p"),P=$e("You selected a "),F=$e(e[1]),O=$e(" string "),V=$e(W),$=$e(", tuned "),Y=$e(H),Q=ge(),J=$e(G),K=ge(),se=oe("p"),ue=$e("Resulting tuning, low to high:"),he=oe("br"),Me=ge(),de=oe("b"),Pe=$e(e[5]),fe(p,"type","number"),fe(p,"min","4"),fe(p,"max","8"),fe(p,"step","1"),fe(m,"type","number"),fe(m,"min","-12"),fe(m,"max","12"),fe(m,"step","1")},m(be,je){Bt(be,t,je),D(t,i),D(i,o),D(t,a),D(t,h),D(h,u),D(h,p),ln(p,e[1]),D(t,c),D(t,f),D(f,g),D(f,m),ln(m,e[2]),D(t,v),D(t,A),D(A,C),D(A,E),D(t,x),D(t,M),D(M,S),D(M,I),D(t,L),D(t,R),D(R,k),D(k,P),D(k,F),D(k,O),D(k,V),D(k,$),D(k,Y),D(k,Q),D(k,J),D(R,K),D(R,se),D(se,ue),D(se,he),D(se,Me),D(se,de),D(de,Pe),Se||(Le=[lt(p,"input",e[6]),lt(m,"input",e[7]),lt(A,"click",e[8]),lt(M,"click",e[9])],Se=!0)},p(be,[je]){je&1&&r!==(r=be[0].title+"")&&jt(o,r),je&2&&Yn(p.value)!==be[1]&&ln(p,be[1]),je&4&&Yn(m.value)!==be[2]&&ln(m,be[2]),je&8&&y!==(y=be[3]?"":"")&&jt(C,y),je&16&&w!==(w=be[4]?"":"")&&jt(S,w),je&2&&jt(F,be[1]),je&2&&W!==(W=be[1]>=6?"guitar":"bass guitar")&&jt(V,W),je&4&&H!==(H=be[2]===0?"in standard tuning":`${Math.abs(be[2])} ${be[2]<0?"steps down":"steps up"}`)&&jt(Y,H),je&8&&G!==(G=be[3]?"and dropped":"")&&jt(J,G),je&32&&jt(Pe,be[5])},i:gn,o:gn,d(be){be&&It(t),Se=!1,ji(Le)}}}function $se(e,t,i){let r,{toolInfo:o}=t,a=6,h=0,u=!1,p=!0;const c=(A,y,C,E)=>{let M=vse.get(A>5?"Guitar":"Bass").get(A)[0].pitches.map(w=>w+y);return C&&(M[0]-=2),E?M=M.map(w=>$f[w].label):M=M.map(w=>$f[w].name),M.join(" ")};function f(){a=Yn(this.value),i(1,a)}function g(){h=Yn(this.value),i(2,h)}const m=()=>{i(3,u=!u)},v=()=>{i(4,p=!p)};return e.$$set=A=>{"toolInfo"in A&&i(0,o=A.toolInfo)},e.$$.update=()=>{e.$$.dirty&30&&i(5,r=c(a,h,u,p))},[o,a,h,u,p,r,f,g,m,v]}class Xse extends pi{constructor(t){super(),di(this,t,$se,Wse,fi,{toolInfo:0})}}function FT(e,t,i){const r=e.slice();return r[5]=t[i],r}function kT(e){let t,i,r=e[5].timestamp.toFixed(1)+"",o,a,h,u=e[5].port.manufacturer+"",p,c,f,g=e[5].port.name+"",m,v,A,y=e[5].message.channel+"",C,E,x,M=e[5].message.command+"",w,S,I=e[5].message.type+"",L,R,k,P=e[5].message.dataBytes+"",F,O,W,V=(["noteon","noteoff"].includes(e[5].message.type)?Ss.fromMidiSharps(e[5].message.dataBytes[0]):"")+"",$,H,Y,Q=(["noteon","noteoff"].includes(e[5].message.type)?e[5].message.dataBytes[1]:"")+"",G,J;return{c(){t=oe("tr"),i=oe("td"),o=$e(r),a=ge(),h=oe("td"),p=$e(u),c=ge(),f=oe("td"),m=$e(g),v=ge(),A=oe("td"),C=$e(y),E=ge(),x=oe("td"),w=$e(M),S=ge(),L=$e(I),R=ge(),k=oe("td"),F=$e(P),O=ge(),W=oe("td"),$=$e(V),H=ge(),Y=oe("td"),G=$e(Q),J=ge(),fe(i,"class","svelte-1x83ix2"),fe(h,"class","svelte-1x83ix2"),fe(f,"class","svelte-1x83ix2"),fe(A,"class","svelte-1x83ix2"),fe(x,"class","svelte-1x83ix2"),fe(k,"class","svelte-1x83ix2"),fe(W,"class","svelte-1x83ix2"),fe(Y,"class","svelte-1x83ix2"),fe(t,"class","svelte-1x83ix2")},m(K,se){Bt(K,t,se),D(t,i),D(i,o),D(t,a),D(t,h),D(h,p),D(t,c),D(t,f),D(f,m),D(t,v),D(t,A),D(A,C),D(t,E),D(t,x),D(x,w),D(x,S),D(x,L),D(t,R),D(t,k),D(k,F),D(t,O),D(t,W),D(W,$),D(t,H),D(t,Y),D(Y,G),D(t,J)},p(K,se){se&2&&r!==(r=K[5].timestamp.toFixed(1)+"")&&jt(o,r),se&2&&u!==(u=K[5].port.manufacturer+"")&&jt(p,u),se&2&&g!==(g=K[5].port.name+"")&&jt(m,g),se&2&&y!==(y=K[5].message.channel+"")&&jt(C,y),se&2&&M!==(M=K[5].message.command+"")&&jt(w,M),se&2&&I!==(I=K[5].message.type+"")&&jt(L,I),se&2&&P!==(P=K[5].message.dataBytes+"")&&jt(F,P),se&2&&V!==(V=(["noteon","noteoff"].includes(K[5].message.type)?Ss.fromMidiSharps(K[5].message.dataBytes[0]):"")+"")&&jt($,V),se&2&&Q!==(Q=(["noteon","noteoff"].includes(K[5].message.type)?K[5].message.dataBytes[1]:"")+"")&&jt(G,Q)},d(K){K&&It(t)}}}function Kse(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v=e[1].length+"",A,y,C,E,x,M,w,S,I,L,R,k,P=fn(e[1].slice(0,100)),F=[];for(let O=0;O<P.length;O+=1)F[O]=kT(FT(e,P,O));return I=new Nr({props:{midiMessage:e[2]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent="Input anything on a MIDI device to see the incoming messages below.",u=ge(),p=oe("div"),c=oe("button"),c.textContent="reset",f=ge(),g=oe("div"),m=oe("p"),A=$e(v),y=$e(" messages received"),C=ge(),E=oe("table"),x=oe("thead"),x.innerHTML="<th>timestamp</th> <th>manufacturer</th> <th>name</th> <th>channel</th> <th>command</th> <th>data</th> <th>note</th> <th>velocity</th>",M=ge(),w=oe("tbody");for(let O=0;O<F.length;O+=1)F[O].c();S=ge(),Ut(I.$$.fragment),fe(h,"class","explanation"),fe(c,"title","Clear all messages"),fe(p,"class","control"),fe(E,"class","svelte-1x83ix2"),fe(g,"class","visualization"),fe(t,"class","demo")},m(O,W){Bt(O,t,W),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(t,f),D(t,g),D(g,m),D(m,A),D(m,y),D(g,C),D(g,E),D(E,x),D(E,M),D(E,w);for(let V=0;V<F.length;V+=1)F[V]&&F[V].m(w,null);D(t,S),Ft(I,t,null),L=!0,R||(k=lt(c,"click",e[3]),R=!0)},p(O,[W]){if((!L||W&1)&&r!==(r=O[0].title+"")&&jt(o,r),(!L||W&2)&&v!==(v=O[1].length+"")&&jt(A,v),W&2){P=fn(O[1].slice(0,100));let V;for(V=0;V<P.length;V+=1){const $=FT(O,P,V);F[V]?F[V].p($,W):(F[V]=kT($),F[V].c(),F[V].m(w,null))}for(;V<F.length;V+=1)F[V].d(1);F.length=P.length}},i(O){L||(Nt(I.$$.fragment,O),L=!0)},o(O){Ot(I.$$.fragment,O),L=!1},d(O){O&&It(t),ti(F,O),kt(I),R=!1,k()}}}function Yse(e,t,i){let{toolInfo:r}=t,o=[];const a=u=>{i(1,o=[u,...o])};tr(()=>{performance.now()});const h=()=>{i(1,o=[])};return e.$$set=u=>{"toolInfo"in u&&i(0,r=u.toolInfo)},[r,o,a,h]}class qse extends pi{constructor(t){super(),di(this,t,Yse,Kse,fi,{toolInfo:0})}}const Sp={noteColormap:_se,noteColormapAccessible:Ese,noteColormapAccessible2:wse,newton:Cse,castel:xse,field:Mse,jameson:Sse,seemann:Tse,rimington:Ise,bishop:Bse,helmholtz:Rse,scriabin:Lse,klein:Pse,aeppli:Dse,belmont:Nse,zieverink:Ose};function UT(e,t,i){const r=e.slice();return r[2]=t[i],r}function GT(e,t,i){const r=e.slice();return r[5]=t[i],r[7]=i,r}function Jse(e,t,i){const r=e.slice();return r[8]=t[i],r}function Zse(e){let t;return{c(){t=oe("th"),t.textContent=`${e[8]}`},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function VT(e){let t,i=e[5]+"",r;return{c(){t=oe("td"),r=$e(i),fe(t,"title",nu[e[7]]),cr(t,"background-color",e[5]),cr(t,"color",bse(e[5])>50?"black":"white"),cr(t,"font-size","12px"),fe(t,"class","svelte-1xnq8ek")},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function QT(e){let t,i,r,o,a=fn(e[2].colors),h=[];for(let u=0;u<a.length;u+=1)h[u]=VT(GT(e,a,u));return{c(){t=oe("tr"),i=oe("td"),i.textContent=`${e[2].name}`,r=ge();for(let u=0;u<h.length;u+=1)h[u].c();o=ge(),fe(i,"class","svelte-1xnq8ek"),fe(t,"class","svelte-1xnq8ek")},m(u,p){Bt(u,t,p),D(t,i),D(t,r);for(let c=0;c<h.length;c+=1)h[c]&&h[c].m(t,null);D(t,o)},p(u,p){if(p&2){a=fn(u[2].colors);let c;for(c=0;c<a.length;c+=1){const f=GT(u,a,c);h[c]?h[c].p(f,p):(h[c]=VT(f),h[c].c(),h[c].m(t,o))}for(;c<h.length;c+=1)h[c].d(1);h.length=a.length}},d(u){u&&It(t),ti(h,u)}}}function eoe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y=fn(nu),C=[];for(let M=0;M<y.length;M+=1)C[M]=Zse(Jse(e,y,M));let E=fn(e[1]),x=[];for(let M=0;M<E.length;M+=1)x[M]=QT(UT(e,E,M));return{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`See <a href="https://github.com/fheyen/musicvis-lib/blob/905edbdc8280e8ca76a329ffc83a160f3cda674a/src/utils/NoteColorUtils.js" target="_blank">here</a>
        for literature references and color string arrays. Most schemes are found
        in:
        <i>Schmidt, Kathryn L. (2019) Meaningful Music Visualizations. Purdue
            University Graduate School. <a href="https://doi.org/10.25394/PGS.7498700.v1" target="_blank">DOI</a>
            (page 13)</i>`,u=ge(),p=oe("div"),c=oe("table"),f=oe("thead"),g=oe("th"),g.textContent="name",m=ge();for(let M=0;M<C.length;M+=1)C[M].c();v=ge(),A=oe("tbody");for(let M=0;M<x.length;M+=1)x[M].c();fe(h,"class","explanation"),fe(c,"class","svelte-1xnq8ek"),fe(p,"class","visualization"),fe(t,"class","demo")},m(M,w){Bt(M,t,w),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(f,g),D(f,m);for(let S=0;S<C.length;S+=1)C[S]&&C[S].m(f,null);D(c,v),D(c,A);for(let S=0;S<x.length;S+=1)x[S]&&x[S].m(A,null)},p(M,[w]){if(w&1&&r!==(r=M[0].title+"")&&jt(o,r),w&2){E=fn(M[1]);let S;for(S=0;S<E.length;S+=1){const I=UT(M,E,S);x[S]?x[S].p(I,w):(x[S]=QT(I),x[S].c(),x[S].m(A,null))}for(;S<x.length;S+=1)x[S].d(1);x.length=E.length}},i:gn,o:gn,d(M){M&&It(t),ti(C,M),ti(x,M)}}}function toe(e,t,i){let{toolInfo:r}=t;const o=[];for(const a in Sp)Sp.hasOwnProperty(a)&&o.push({name:a,colors:Sp[a].map(h=>Yc(h).formatHex())});return e.$$set=a=>{"toolInfo"in a&&i(0,r=a.toolInfo)},[r,o]}class noe extends pi{constructor(t){super(),di(this,t,toe,eoe,fi,{toolInfo:0})}}function ioe(e,t,i){const r=e.slice();return r[16]=t[i],r}function roe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[16]}`,t.__value=e[16],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function soe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P=fn(["velocity","piano","channel","none"]),F=[];for(let O=0;O<4;O+=1)F[O]=roe(ioe(e,P,O));return I=new Nr({props:{noteOn:e[6],noteOff:e[7],controlChange:e[8]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`The piano roll below shows incoming MIDI notes as rectangles with their
        pitch (y position) and start and end times (x left and right side of the
        rectangle). The color encodes the MIDI velocity, which tells how
        hard/loud a note was played.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`color
            `),g=oe("select");for(let O=0;O<4;O+=1)F[O].c();m=ge(),v=oe("label"),A=$e(`time
            `),y=oe("input"),C=ge(),E=oe("div"),x=ge(),M=oe("div"),w=oe("button"),w.textContent="reset",S=ge(),Ut(I.$$.fragment),fe(h,"class","explanation"),e[3]===void 0&&yr(()=>e[9].call(g)),fe(y,"type","number"),fe(y,"min","10"),fe(y,"max","300"),fe(y,"step","10"),fe(v,"title","time in seconds for past notes to be shown"),fe(p,"class","control"),fe(E,"class","visualization"),fe(w,"title","Clear all played notes"),fe(M,"class","control"),fe(t,"class","demo")},m(O,W){Bt(O,t,W),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let V=0;V<4;V+=1)F[V]&&F[V].m(g,null);ci(g,e[3],!0),D(p,m),D(p,v),D(v,A),D(v,y),ln(y,e[2]),D(t,C),D(t,E),e[11](E),D(t,x),D(t,M),D(M,w),D(t,S),Ft(I,t,null),L=!0,R||(k=[lt(g,"change",e[9]),lt(y,"input",e[10]),lt(w,"click",e[12])],R=!0)},p(O,[W]){(!L||W&1)&&r!==(r=O[0].title+"")&&jt(o,r),W&8&&ci(g,O[3]),W&4&&Yn(y.value)!==O[2]&&ln(y,O[2])},i(O){L||(Nt(I.$$.fragment,O),L=!0)},o(O){Ot(I.$$.fragment,O),L=!1},d(O){O&&It(t),ti(F,O),e[11](null),kt(I),R=!1,ji(k)}}}let ooe=1e3,aoe=500;function loe(e,t,i){let{toolInfo:r}=t,o,a=30,h="velocity",u=0,p=[];const c=new Map;let f=null;const g=M=>{const w=(M.timestamp-u)/1e3,S={number:M.note.number,velocity:M.rawVelocity,time:w,channel:M.message.channel};if(c.has(M.note.number)){const I=c.get(M.note.number);I.end===void 0&&(I.end=w)}p.push(S),c.set(M.note.number,S)},m=M=>{if(c.has(M.note.number)){const w=c.get(M.note.number),S=(M.timestamp-u)/1e3;w.end=S}},v=M=>{i(2,a=M.value*55+5)},A=()=>{const M=(performance.now()-u)/1e3,w=M-a,S=p.filter(P=>P.end>w||P.end===void 0),I=Ms(S,P=>P.number);let L,R;h==="velocity"?(L={label:"Note velocity",scheme:"blues",domain:[0,127]},R="velocity"):h==="piano"?(L={label:"Piano key color",domain:["black","white"],range:["black","white"]},R=P=>Mp(P.number)?"black":"white"):h==="channel"?(L={type:"categorical",label:"MIDI channel",scheme:"tableau10"},R=P=>P.channel):h==="none"&&(R="#ddd");const k=Ji({insetRight:10,width:ooe,height:aoe,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[w,M]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,domain:Mn(I[0]-1,I[1]+2),tickFormat:P=>$f[P].label},color:{...L,legend:h!=="none",marginLeft:100,width:300},marks:[hs(B6(I[0]-1,I[1]+2)),no([M],{stroke:"#888"}),km(S,{clip:!0,x1:"time",x2:P=>P.end===void 0?M:Math.max(P.end,P.time+.025),y:"number",fill:R,stroke:"#ccc",rx:5})]});i(1,o.textContent="",o),o.appendChild(k),f=requestAnimationFrame(A)};tr(()=>{i(4,u=performance.now()),f=requestAnimationFrame(A)}),Io(()=>{cancelAnimationFrame(f)});function y(){h=Dr(this),i(3,h)}function C(){a=Yn(this.value),i(2,a)}function E(M){In[M?"unshift":"push"](()=>{o=M,i(1,o)})}const x=()=>{confirm("Reset played notes?")&&(i(5,p=[]),i(4,u=performance.now()))};return e.$$set=M=>{"toolInfo"in M&&i(0,r=M.toolInfo)},[r,o,a,h,u,p,g,m,v,y,C,E,x]}class coe extends pi{constructor(t){super(),di(this,t,loe,soe,fi,{toolInfo:0})}}function Wo(e){if(this.size=e|0,this.size<=1||this.size&this.size-1)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=e<<1;for(var t=new Array(this.size*2),i=0;i<t.length;i+=2){const p=Math.PI*i/this.size;t[i]=Math.cos(p),t[i+1]=-Math.sin(p)}this.table=t;for(var r=0,o=1;this.size>o;o<<=1)r++;this._width=r%2===0?r-1:r,this._bitrev=new Array(1<<this._width);for(var a=0;a<this._bitrev.length;a++){this._bitrev[a]=0;for(var h=0;h<this._width;h+=2){var u=this._width-h-2;this._bitrev[a]|=(a>>>h&3)<<u}}this._out=null,this._data=null,this._inv=0}var uoe=Wo;Wo.prototype.fromComplexArray=function(t,i){for(var r=i||new Array(t.length>>>1),o=0;o<t.length;o+=2)r[o>>>1]=t[o];return r};Wo.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var i=0;i<t.length;i++)t[i]=0;return t};Wo.prototype.toComplexArray=function(t,i){for(var r=i||this.createComplexArray(),o=0;o<r.length;o+=2)r[o]=t[o>>>1],r[o+1]=0;return r};Wo.prototype.completeSpectrum=function(t){for(var i=this._csize,r=i>>>1,o=2;o<r;o+=2)t[i-o]=t[o],t[i-o+1]=-t[o+1]};Wo.prototype.transform=function(t,i){if(t===i)throw new Error("Input and output buffers must be different");this._out=t,this._data=i,this._inv=0,this._transform4(),this._out=null,this._data=null};Wo.prototype.realTransform=function(t,i){if(t===i)throw new Error("Input and output buffers must be different");this._out=t,this._data=i,this._inv=0,this._realTransform4(),this._out=null,this._data=null};Wo.prototype.inverseTransform=function(t,i){if(t===i)throw new Error("Input and output buffers must be different");this._out=t,this._data=i,this._inv=1,this._transform4();for(var r=0;r<t.length;r++)t[r]/=this.size;this._out=null,this._data=null};Wo.prototype._transform4=function(){var t=this._out,i=this._csize,r=this._width,o=1<<r,a=i/o<<1,h,u,p=this._bitrev;if(a===4)for(h=0,u=0;h<i;h+=a,u++){const y=p[u];this._singleTransform2(h,y,o)}else for(h=0,u=0;h<i;h+=a,u++){const y=p[u];this._singleTransform4(h,y,o)}var c=this._inv?-1:1,f=this.table;for(o>>=2;o>=2;o>>=2){a=i/o<<1;var g=a>>>2;for(h=0;h<i;h+=a)for(var m=h+g,v=h,A=0;v<m;v+=2,A+=o){const y=v,C=y+g,E=C+g,x=E+g,M=t[y],w=t[y+1],S=t[C],I=t[C+1],L=t[E],R=t[E+1],k=t[x],P=t[x+1],F=M,O=w,W=f[A],V=c*f[A+1],$=S*W-I*V,H=S*V+I*W,Y=f[2*A],Q=c*f[2*A+1],G=L*Y-R*Q,J=L*Q+R*Y,K=f[3*A],se=c*f[3*A+1],ue=k*K-P*se,he=k*se+P*K,Me=F+G,de=O+J,Pe=F-G,Se=O-J,Le=$+ue,be=H+he,je=c*($-ue),Te=c*(H-he),rt=Me+Le,mt=de+be,vt=Me-Le,ft=de-be,Ze=Pe+Te,St=Se-je,$t=Pe-Te,ct=Se+je;t[y]=rt,t[y+1]=mt,t[C]=Ze,t[C+1]=St,t[E]=vt,t[E+1]=ft,t[x]=$t,t[x+1]=ct}}};Wo.prototype._singleTransform2=function(t,i,r){const o=this._out,a=this._data,h=a[i],u=a[i+1],p=a[i+r],c=a[i+r+1],f=h+p,g=u+c,m=h-p,v=u-c;o[t]=f,o[t+1]=g,o[t+2]=m,o[t+3]=v};Wo.prototype._singleTransform4=function(t,i,r){const o=this._out,a=this._data,h=this._inv?-1:1,u=r*2,p=r*3,c=a[i],f=a[i+1],g=a[i+r],m=a[i+r+1],v=a[i+u],A=a[i+u+1],y=a[i+p],C=a[i+p+1],E=c+v,x=f+A,M=c-v,w=f-A,S=g+y,I=m+C,L=h*(g-y),R=h*(m-C),k=E+S,P=x+I,F=M+R,O=w-L,W=E-S,V=x-I,$=M-R,H=w+L;o[t]=k,o[t+1]=P,o[t+2]=F,o[t+3]=O,o[t+4]=W,o[t+5]=V,o[t+6]=$,o[t+7]=H};Wo.prototype._realTransform4=function(){var t=this._out,i=this._csize,r=this._width,o=1<<r,a=i/o<<1,h,u,p=this._bitrev;if(a===4)for(h=0,u=0;h<i;h+=a,u++){const Ce=p[u];this._singleRealTransform2(h,Ce>>>1,o>>>1)}else for(h=0,u=0;h<i;h+=a,u++){const Ce=p[u];this._singleRealTransform4(h,Ce>>>1,o>>>1)}var c=this._inv?-1:1,f=this.table;for(o>>=2;o>=2;o>>=2){a=i/o<<1;var g=a>>>1,m=g>>>1,v=m>>>1;for(h=0;h<i;h+=a)for(var A=0,y=0;A<=v;A+=2,y+=o){var C=h+A,E=C+m,x=E+m,M=x+m,w=t[C],S=t[C+1],I=t[E],L=t[E+1],R=t[x],k=t[x+1],P=t[M],F=t[M+1],O=w,W=S,V=f[y],$=c*f[y+1],H=I*V-L*$,Y=I*$+L*V,Q=f[2*y],G=c*f[2*y+1],J=R*Q-k*G,K=R*G+k*Q,se=f[3*y],ue=c*f[3*y+1],he=P*se-F*ue,Me=P*ue+F*se,de=O+J,Pe=W+K,Se=O-J,Le=W-K,be=H+he,je=Y+Me,Te=c*(H-he),rt=c*(Y-Me),mt=de+be,vt=Pe+je,ft=Se+rt,Ze=Le-Te;if(t[C]=mt,t[C+1]=vt,t[E]=ft,t[E+1]=Ze,A===0){var St=de-be,$t=Pe-je;t[x]=St,t[x+1]=$t;continue}if(A!==v){var ct=Se,Ct=-Le,Tt=de,At=-Pe,pn=-c*rt,yt=-c*Te,kn=-c*je,qn=-c*be,Gt=ct+pn,bt=Ct+yt,ye=Tt+qn,_e=At-kn,Ue=h+m-A,Re=h+g-A;t[Ue]=Gt,t[Ue+1]=bt,t[Re]=ye,t[Re+1]=_e}}}};Wo.prototype._singleRealTransform2=function(t,i,r){const o=this._out,a=this._data,h=a[i],u=a[i+r],p=h+u,c=h-u;o[t]=p,o[t+1]=0,o[t+2]=c,o[t+3]=0};Wo.prototype._singleRealTransform4=function(t,i,r){const o=this._out,a=this._data,h=this._inv?-1:1,u=r*2,p=r*3,c=a[i],f=a[i+r],g=a[i+u],m=a[i+p],v=c+g,A=c-g,y=f+m,C=h*(f-m),E=v+y,x=A,M=-C,w=v-y,S=A,I=C;o[t]=E,o[t+1]=0,o[t+2]=x,o[t+3]=M,o[t+4]=w,o[t+5]=0,o[t+6]=S,o[t+7]=I};const hoe=gE(uoe);class Tp{constructor(t,i){pr(this,"_inputLength");pr(this,"_fft");pr(this,"_bufferSupplier");pr(this,"_paddedInputBuffer");pr(this,"_transformBuffer");pr(this,"_inverseBuffer");if(t<1)throw new Error("Input length must be at least one");this._inputLength=t,this._fft=new hoe(poe(2*t)),this._bufferSupplier=i,this._paddedInputBuffer=this._bufferSupplier(this._fft.size),this._transformBuffer=this._bufferSupplier(2*this._fft.size),this._inverseBuffer=this._bufferSupplier(2*this._fft.size)}static forFloat32Array(t){return new Tp(t,i=>new Float32Array(i))}static forFloat64Array(t){return new Tp(t,i=>new Float64Array(i))}static forNumberArray(t){return new Tp(t,i=>Array(i))}get inputLength(){return this._inputLength}autocorrelate(t,i=this._bufferSupplier(t.length)){if(t.length!==this._inputLength)throw new Error(`Input must have length ${this._inputLength} but had length ${t.length}`);for(let o=0;o<t.length;o++)this._paddedInputBuffer[o]=t[o];for(let o=t.length;o<this._paddedInputBuffer.length;o++)this._paddedInputBuffer[o]=0;this._fft.realTransform(this._transformBuffer,this._paddedInputBuffer),this._fft.completeSpectrum(this._transformBuffer);const r=this._transformBuffer;for(let o=0;o<r.length;o+=2)r[o]=r[o]*r[o]+r[o+1]*r[o+1],r[o+1]=0;this._fft.inverseTransform(this._inverseBuffer,this._transformBuffer);for(let o=0;o<t.length;o++)i[o]=this._inverseBuffer[2*o];return i}}function foe(e){const t=[];let i=!1,r=-1/0,o=-1;for(let a=1;a<e.length-1;a++)e[a-1]<=0&&e[a]>0?(i=!0,o=a,r=e[a]):e[a-1]>0&&e[a]<=0?(i=!1,o!==-1&&t.push(o)):i&&e[a]>r&&(r=e[a],o=a);return t}function doe(e,t){const[i,r,o]=[e-1,e,e+1],[a,h,u]=[t[i],t[r],t[o]],p=a/2-h+u/2,c=-(a/2)*(r+o)+h*(i+o)-u/2*(i+r),f=a*r*o/2-h*i*o+u*i*r/2,g=-c/(2*p),m=p*g*g+c*g+f;return[g,m]}class Yu{constructor(t,i){pr(this,"_autocorrelator");pr(this,"_nsdfBuffer");pr(this,"_clarityThreshold",.9);pr(this,"_minVolumeAbsolute",0);pr(this,"_maxInputAmplitude",1);this._autocorrelator=new Tp(t,i),this._nsdfBuffer=i(t)}static forFloat32Array(t){return new Yu(t,i=>new Float32Array(i))}static forFloat64Array(t){return new Yu(t,i=>new Float64Array(i))}static forNumberArray(t){return new Yu(t,i=>Array(i))}get inputLength(){return this._autocorrelator.inputLength}set clarityThreshold(t){if(!Number.isFinite(t)||t<=0||t>1)throw new Error("clarityThreshold must be a number in the range (0, 1]");this._clarityThreshold=t}set minVolumeAbsolute(t){if(!Number.isFinite(t)||t<0||t>this._maxInputAmplitude)throw new Error(`minVolumeAbsolute must be a number in the range [0, ${this._maxInputAmplitude}]`);this._minVolumeAbsolute=t}set minVolumeDecibels(t){if(!Number.isFinite(t)||t>0)throw new Error("minVolumeDecibels must be a number <= 0");this._minVolumeAbsolute=this._maxInputAmplitude*10**(t/10)}set maxInputAmplitude(t){if(!Number.isFinite(t)||t<=0)throw new Error("maxInputAmplitude must be a number > 0");this._maxInputAmplitude=t}findPitch(t,i){if(this._belowMinimumVolume(t))return[0,0];this._nsdf(t);const r=foe(this._nsdfBuffer);if(r.length===0)return[0,0];const o=Math.max(...r.map(p=>this._nsdfBuffer[p])),a=r.find(p=>this._nsdfBuffer[p]>=this._clarityThreshold*o),[h,u]=doe(a,this._nsdfBuffer);return[i/h,Math.min(u,1)]}_belowMinimumVolume(t){if(this._minVolumeAbsolute===0)return!1;let i=0;for(let r=0;r<t.length;r++)i+=t[r]**2;return Math.sqrt(i/t.length)<this._minVolumeAbsolute}_nsdf(t){this._autocorrelator.autocorrelate(t,this._nsdfBuffer);let i=2*this._nsdfBuffer[0],r;for(r=0;r<this._nsdfBuffer.length&&i>0;r++)this._nsdfBuffer[r]=2*this._nsdfBuffer[r]/i,i-=t[r]**2+t[t.length-r-1]**2;for(;r<this._nsdfBuffer.length;r++)this._nsdfBuffer[r]=0}}function poe(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e}function moe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v=e[2].toFixed(1)+"",A,y,C,E,x,M=(e[3]*100).toFixed()+"",w,S,I,L,R,k,P,F,O;return{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Allow microphone access and make a sound, the detected pitch will be
        displayed below together with the closest note and the offset from this
        notes in cents.`,u=ge(),p=oe("div"),c=ge(),f=oe("div"),g=oe("div"),m=$e("frequency: "),A=$e(v),y=$e(" Hz"),C=ge(),E=oe("div"),x=$e("clarity: "),w=$e(M),S=$e(" %"),I=ge(),L=oe("div"),R=$e("note: "),k=oe("b"),P=$e(e[4]),F=ge(),O=oe("div"),fe(h,"class","explanation"),fe(p,"class","control"),fe(O,"class","visualization"),fe(t,"class","demo")},m(W,V){Bt(W,t,V),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(t,c),D(t,f),D(f,g),D(g,m),D(g,A),D(g,y),D(f,C),D(f,E),D(E,x),D(E,w),D(E,S),D(f,I),D(f,L),D(L,R),D(L,k),D(k,P),D(t,F),D(t,O),e[5](O)},p(W,[V]){V&1&&r!==(r=W[0].title+"")&&jt(o,r),V&4&&v!==(v=W[2].toFixed(1)+"")&&jt(A,v),V&8&&M!==(M=(W[3]*100).toFixed()+"")&&jt(w,M),V&16&&jt(P,W[4])},i:gn,o:gn,d(W){W&&It(t),e[5](null)}}}let Aoe=1e3,goe=300;function voe(e,t,i){let{toolInfo:r}=t,o,a,h,u,p=-20,c=0,f=0,g="",m=0,v=0,A=[];function y(x,M,w,S){x.getFloatTimeDomainData(w);const I=M.findPitch(w,S);i(2,c=I[0]),i(3,f=I[1]),i(4,g=Ss.fromFreq(c)),m=Ss.midi(g),v=(Gf.freqToMidi(c)-m)*100,A=[...A.slice(-50),v],C(),u=requestAnimationFrame(()=>y(x,M,w,S))}const C=()=>{i(1,o.textContent="",o);const x=Ji({width:Aoe,height:goe,marginLeft:40,x:{label:"offset in cents",domain:[-50,50]},y:{reverse:!0,ticks:[]},marks:[no([-50,0,50],{stroke:"#ddd"}),Xa(A,{stroke:"#333",x:M=>M,y:(M,w)=>w})]});o.appendChild(x)};tr(()=>{a=new window.AudioContext,h=a.createAnalyser(),navigator.mediaDevices.getUserMedia({audio:!0}).then(x=>{a.createMediaStreamSource(x).connect(h);const M=Yu.forFloat32Array(h.fftSize);M.minVolumeDecibels=p;const w=new Float32Array(M.inputLength);y(h,M,w,a.sampleRate)})}),Io(()=>{cancelAnimationFrame(u)});function E(x){In[x?"unshift":"push"](()=>{o=x,i(1,o)})}return e.$$set=x=>{"toolInfo"in x&&i(0,r=x.toolInfo)},[r,o,c,f,g,E]}class boe extends pi{constructor(t){super(),di(this,t,voe,moe,fi,{toolInfo:0})}}function HT(e,t,i){const r=e.slice();return r[15]=t[i],r}function zT(e,t,i){const r=e.slice();return r[18]=t[i],r}function jT(e,t,i){const r=e.slice();return r[21]=t[i],r}function WT(e,t,i){const r=e.slice();return r[24]=t[i],r}function $T(e,t,i){const r=e.slice();return r[27]=t[i],r}function XT(e){let t,i=e[27]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[27],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function KT(e){let t,i=e[24]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[24],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function YT(e){let t,i,r,o=e[21].name+"",a,h,u=e[21].notes.join(" ")+"",p,c,f=[...Tf(e[3].notes,e[21].notes)].join(" ")+"",g,m,v,A;function y(){return e[12](e[21])}return{c(){t=oe("div"),i=oe("button"),i.textContent="show",r=ge(),a=$e(o),h=$e(`:
                `),p=$e(u),c=$e(`
                (no `),g=$e(f),m=$e(")")},m(C,E){Bt(C,t,E),D(t,i),D(t,r),D(t,a),D(t,h),D(t,p),D(t,c),D(t,g),D(t,m),v||(A=lt(i,"click",y),v=!0)},p(C,E){e=C,E&128&&o!==(o=e[21].name+"")&&jt(a,o),E&128&&u!==(u=e[21].notes.join(" ")+"")&&jt(p,u),E&136&&f!==(f=[...Tf(e[3].notes,e[21].notes)].join(" ")+"")&&jt(g,f)},d(C){C&&It(t),v=!1,A()}}}function qT(e){let t,i,r,o=e[18].name+"",a,h,u=e[18].notes.join(" ")+"",p,c,f=[...Tf(e[18].notes,e[3].notes)].join(" ")+"",g,m,v,A;function y(){return e[13](e[18])}return{c(){t=oe("div"),i=oe("button"),i.textContent="show",r=ge(),a=$e(o),h=$e(`:
                `),p=$e(u),c=$e(`
                (adds `),g=$e(f),m=$e(")")},m(C,E){Bt(C,t,E),D(t,i),D(t,r),D(t,a),D(t,h),D(t,p),D(t,c),D(t,g),D(t,m),v||(A=lt(i,"click",y),v=!0)},p(C,E){e=C,E&64&&o!==(o=e[18].name+"")&&jt(a,o),E&64&&u!==(u=e[18].notes.join(" ")+"")&&jt(p,u),E&72&&f!==(f=[...Tf(e[18].notes,e[3].notes)].join(" ")+"")&&jt(g,f)},d(C){C&&It(t),v=!1,A()}}}function JT(e){let t,i,r,o=e[15]+"",a,h,u=jg.get(`${e[1]} ${e[15]}`).notes.join(" ")+"",p,c;return{c(){t=oe("div"),i=$e(e[1]),r=ge(),a=$e(o),h=$e(`:
                `),p=$e(u),c=ge()},m(f,g){Bt(f,t,g),D(t,i),D(t,r),D(t,a),D(t,h),D(t,p),D(t,c)},p(f,g){g&2&&jt(i,f[1]),g&32&&o!==(o=f[15]+"")&&jt(a,o),g&34&&u!==(u=jg.get(`${f[1]} ${f[15]}`).notes.join(" ")+"")&&jt(p,u)},d(f){f&&It(t)}}}function yoe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x=e[3].name+"",M,w,S,I,L=e[3].notes.join(" ")+"",R,k,P,F,O,W,V,$,H,Y,Q,G,J=fn(e[8]),K=[];for(let be=0;be<J.length;be+=1)K[be]=XT($T(e,J,be));let se=fn(e[9]),ue=[];for(let be=0;be<se.length;be+=1)ue[be]=KT(WT(e,se,be));let he=fn(e[7]),Me=[];for(let be=0;be<he.length;be+=1)Me[be]=YT(jT(e,he,be));let de=fn(e[6]),Pe=[];for(let be=0;be<de.length;be+=1)Pe[be]=qT(zT(e,de,be));let Se=fn(e[5]),Le=[];for(let be=0;be<Se.length;be+=1)Le[be]=JT(HT(e,Se,be));return{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Select a root note and scale and see how this scale relates to others.
        This tool is mainly a graphical interface for <a href="https://github.com/tonaljs/tonal/tree/main/packages/scale" target="_blank">tonaljs.</a>`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`scale
            `),g=oe("select");for(let be=0;be<K.length;be+=1)K[be].c();m=ge(),v=oe("select");for(let be=0;be<ue.length;be+=1)ue[be].c();A=ge(),y=oe("div"),C=oe("h2"),E=$e("current scale: "),M=$e(x),w=ge(),S=oe("h3"),S.textContent="notes",I=ge(),R=$e(L),k=ge(),P=oe("h3"),P.textContent="scales that are subsets",F=ge();for(let be=0;be<Me.length;be+=1)Me[be].c();O=ge(),W=oe("h3"),W.textContent="scales that are supersets",V=ge();for(let be=0;be<Pe.length;be+=1)Pe[be].c();$=ge(),H=oe("h3"),H.textContent="chords",Y=ge();for(let be=0;be<Le.length;be+=1)Le[be].c();fe(h,"class","explanation"),e[1]===void 0&&yr(()=>e[10].call(g)),e[2]===void 0&&yr(()=>e[11].call(v)),fe(p,"class","control"),fe(y,"class","visualization"),fe(t,"class","demo")},m(be,je){Bt(be,t,je),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let Te=0;Te<K.length;Te+=1)K[Te]&&K[Te].m(g,null);ci(g,e[1],!0),D(c,m),D(c,v);for(let Te=0;Te<ue.length;Te+=1)ue[Te]&&ue[Te].m(v,null);ci(v,e[2],!0),D(t,A),D(t,y),D(y,C),D(C,E),D(C,M),D(y,w),D(y,S),D(y,I),D(y,R),D(y,k),D(y,P),D(y,F);for(let Te=0;Te<Me.length;Te+=1)Me[Te]&&Me[Te].m(y,null);D(y,O),D(y,W),D(y,V);for(let Te=0;Te<Pe.length;Te+=1)Pe[Te]&&Pe[Te].m(y,null);D(y,$),D(y,H),D(y,Y);for(let Te=0;Te<Le.length;Te+=1)Le[Te]&&Le[Te].m(y,null);e[14](y),Q||(G=[lt(g,"change",e[10]),lt(v,"change",e[11])],Q=!0)},p(be,[je]){if(je&1&&r!==(r=be[0].title+"")&&jt(o,r),je&256){J=fn(be[8]);let Te;for(Te=0;Te<J.length;Te+=1){const rt=$T(be,J,Te);K[Te]?K[Te].p(rt,je):(K[Te]=XT(rt),K[Te].c(),K[Te].m(g,null))}for(;Te<K.length;Te+=1)K[Te].d(1);K.length=J.length}if(je&258&&ci(g,be[1]),je&512){se=fn(be[9]);let Te;for(Te=0;Te<se.length;Te+=1){const rt=WT(be,se,Te);ue[Te]?ue[Te].p(rt,je):(ue[Te]=KT(rt),ue[Te].c(),ue[Te].m(v,null))}for(;Te<ue.length;Te+=1)ue[Te].d(1);ue.length=se.length}if(je&516&&ci(v,be[2]),je&8&&x!==(x=be[3].name+"")&&jt(M,x),je&8&&L!==(L=be[3].notes.join(" ")+"")&&jt(R,L),je&140){he=fn(be[7]);let Te;for(Te=0;Te<he.length;Te+=1){const rt=jT(be,he,Te);Me[Te]?Me[Te].p(rt,je):(Me[Te]=YT(rt),Me[Te].c(),Me[Te].m(y,O))}for(;Te<Me.length;Te+=1)Me[Te].d(1);Me.length=he.length}if(je&76){de=fn(be[6]);let Te;for(Te=0;Te<de.length;Te+=1){const rt=zT(be,de,Te);Pe[Te]?Pe[Te].p(rt,je):(Pe[Te]=qT(rt),Pe[Te].c(),Pe[Te].m(y,$))}for(;Te<Pe.length;Te+=1)Pe[Te].d(1);Pe.length=de.length}if(je&34){Se=fn(be[5]);let Te;for(Te=0;Te<Se.length;Te+=1){const rt=HT(be,Se,Te);Le[Te]?Le[Te].p(rt,je):(Le[Te]=JT(rt),Le[Te].c(),Le[Te].m(y,null))}for(;Te<Le.length;Te+=1)Le[Te].d(1);Le.length=Se.length}},i:gn,o:gn,d(be){be&&It(t),ti(K,be),ti(ue,be),ti(Me,be),ti(Pe,be),ti(Le,be),e[14](null),Q=!1,ji(G)}}}function _oe(e,t,i){let r,o,a,h,{toolInfo:u}=t,p,c="A",f="minor";const g=Um,m=Ws.names();function v(){c=Dr(this),i(1,c),i(8,g)}function A(){f=Dr(this),i(2,f),i(9,m)}const y=x=>i(2,f=x.type),C=x=>i(2,f=x.type);function E(x){In[x?"unshift":"push"](()=>{p=x,i(4,p)})}return e.$$set=x=>{"toolInfo"in x&&i(0,u=x.toolInfo)},e.$$.update=()=>{e.$$.dirty&6&&i(3,r=Ws.get(`${c} ${f}`)),e.$$.dirty&10&&i(7,o=Ws.reduced(r.name).map(x=>Ws.get(`${c} ${x}`))),e.$$.dirty&10&&i(6,a=Ws.extended(r.name).map(x=>Ws.get(`${c} ${x}`))),e.$$.dirty&6&&i(5,h=Ws.scaleChords(`${c} ${f}`))},[u,c,f,r,p,h,a,o,g,m,v,A,y,C,E]}class Eoe extends pi{constructor(t){super(),di(this,t,_oe,yoe,fi,{toolInfo:0})}}function woe(e,t,i){const r=e.slice();return r[17]=t[i],r}function ZT(e,t,i){const r=e.slice();return r[20]=t[i],r}function eI(e){let t,i=e[20]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[20],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function Coe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[17]}`,t.__value=e[17],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function xoe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M=(e[5]?Yr:qr)+"",w,S,I,L,R,k,P=fn(e[6]),F=[];for(let V=0;V<P.length;V+=1)F[V]=eI(ZT(e,P,V));let O=fn(["default","name","notes","number of notes"]),W=[];for(let V=0;V<4;V+=1)W[V]=Coe(woe(e,O,V));return{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Select a root note and see all scales with this root and their notes.
        Using <a href="https://github.com/tonaljs/tonal/tree/main/packages/scale" target="_blank">tonaljs.</a>
        Ported from
        <a href="https://observablehq.com/@fheyen/musical-scales" target="_blank">here.</a>`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`scale
            `),g=oe("select");for(let V=0;V<F.length;V+=1)F[V].c();m=ge(),v=oe("label"),A=$e(`ordering
            `),y=oe("select");for(let V=0;V<4;V+=1)W[V].c();C=ge(),E=oe("button"),x=$e("colors "),w=$e(M),S=ge(),I=oe("div"),L=oe("canvas"),fe(h,"class","explanation"),e[1]===void 0&&yr(()=>e[10].call(g)),e[2]===void 0&&yr(()=>e[11].call(y)),fe(E,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),fe(p,"class","control"),cr(L,"width",R_+"px"),cr(L,"height",og+"px"),fe(I,"class","visualization"),fe(t,"class","demo")},m(V,$){Bt(V,t,$),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let H=0;H<F.length;H+=1)F[H]&&F[H].m(g,null);ci(g,e[1],!0),D(p,m),D(p,v),D(v,A),D(v,y);for(let H=0;H<4;H+=1)W[H]&&W[H].m(y,null);ci(y,e[2],!0),D(p,C),D(p,E),D(E,x),D(E,w),D(t,S),D(t,I),D(I,L),e[13](L),e[14](I),R||(k=[lt(g,"change",e[10]),lt(y,"change",e[11]),lt(E,"click",e[12])],R=!0)},p(V,[$]){if($&1&&r!==(r=V[0].title+"")&&jt(o,r),$&64){P=fn(V[6]);let H;for(H=0;H<P.length;H+=1){const Y=ZT(V,P,H);F[H]?F[H].p(Y,$):(F[H]=eI(Y),F[H].c(),F[H].m(g,null))}for(;H<F.length;H+=1)F[H].d(1);F.length=P.length}$&66&&ci(g,V[1]),$&4&&ci(y,V[2]),$&32&&M!==(M=(V[5]?Yr:qr)+"")&&jt(w,M)},i:gn,o:gn,d(V){V&&It(t),ti(F,V),ti(W,V),e[13](null),e[14](null),R=!1,ji(k)}}}const R_=400,og=1200;function Moe(e,t,i){let r,o,{toolInfo:a}=t,h,u,p="C",c="default",f=!0;const g=nu,m=Ws.names(),v=(w,S)=>{if(w==="default")return[...S];if(w==="name")return[...S].sort((I,L)=>I.name<L.name?-1:1);if(w==="notes")return[...S].sort((I,L)=>I.notes.join(" ")<L.notes.join(" ")?-1:1);if(w==="number of notes")return[...S].sort((I,L)=>I.notes.length>L.notes.length?-1:1)},A=()=>{if(!u)return;const w=u.getContext("2d"),S=window.devicePixelRatio,I=u.getBoundingClientRect();i(4,u.width=I.width*S,u),i(4,u.height=I.height*S,u),w.scale(S,S),i(4,u.style.width=`${I.width}px`,u),i(4,u.style.height=`${I.height}px`,u),w.fillStyle="white",w.fillRect(0,0,R_,og);const L=130,R=(R_-L)/12,k=R*.9,P=(og-30)/r.length,F=P*.9;w.textAlign="center",w.fillStyle="black";for(const[W,V]of g.entries()){const $=L+(W+.5)*R;w.fillText(V,$,10),w.fillText(V,$,og-3)}const O=new Map(g.map((W,V)=>[W,V]));for(const[W,V]of o.entries()){const $=15+W*P;w.fillStyle="black",w.textAlign="right",w.fillText(V.type,L-5,$+P-2.5),w.fillStyle="#666";for(const H of V.notes){const Y=O.get(H);f?w.fillStyle=Sp.noteColormap[Y]:w.fillStyle=H===p?"#777":"#bbb";const Q=L+Y*R+R*.05;w.fillRect(Q,$,k,F),w.fillStyle="white",w.textAlign="center";const G=L+(Y+.5)*R;w.fillText(H,G,$+P-3.5)}}};tr(A);function y(){p=Dr(this),i(1,p),i(6,g)}function C(){c=Dr(this),i(2,c)}const E=()=>{i(5,f=!f),A()};function x(w){In[w?"unshift":"push"](()=>{u=w,i(4,u)})}function M(w){In[w?"unshift":"push"](()=>{h=w,i(3,h)})}return e.$$set=w=>{"toolInfo"in w&&i(0,a=w.toolInfo)},e.$$.update=()=>{e.$$.dirty&2&&i(9,r=m.map(w=>Ws.get(`${p} ${w}`)).filter(w=>!w.empty).map(w=>(w.notes=w.notes.map(S=>ene.get(S)??S),w))),e.$$.dirty&516&&i(8,o=v(c,r)),e.$$.dirty&256&&o&&A()},[a,p,c,h,u,f,g,A,o,r,y,C,E,x,M]}class Soe extends pi{constructor(t){super(),di(this,t,Moe,xoe,fi,{toolInfo:0})}}function tI(e,t,i){const r=e.slice();return r[3]=t[i],r}function Toe(e){let t,i,r;var o=e[0].component;function a(h,u){return{props:{toolInfo:h[0]}}}return o&&(i=cg(o,a(e))),{c(){t=oe("div"),i&&Ut(i.$$.fragment)},m(h,u){Bt(h,t,u),i&&Ft(i,t,null),r=!0},p(h,u){if(u&1&&o!==(o=h[0].component)){if(i){u1();const p=i;Ot(p.$$.fragment,1,0,()=>{kt(p,1)}),h1()}o?(i=cg(o,a(h)),Ut(i.$$.fragment),Nt(i.$$.fragment,1),Ft(i,t,null)):i=null}else if(o){const p={};u&1&&(p.toolInfo=h[0]),i.$set(p)}},i(h){r||(i&&Nt(i.$$.fragment,h),r=!0)},o(h){i&&Ot(i.$$.fragment,h),r=!1},d(h){h&&It(t),i&&kt(i)}}}function Ioe(e){let t,i,r,o=fn(e[1]),a=[];for(let h=0;h<o.length;h+=1)a[h]=nI(tI(e,o,h));return{c(){t=oe("p"),t.textContent="This page contains a collection of simple but useful tools.",i=ge(),r=oe("div");for(let h=0;h<a.length;h+=1)a[h].c();fe(t,"class","explanation"),fe(r,"class","grid")},m(h,u){Bt(h,t,u),Bt(h,i,u),Bt(h,r,u);for(let p=0;p<a.length;p+=1)a[p]&&a[p].m(r,null)},p(h,u){if(u&3){o=fn(h[1]);let p;for(p=0;p<o.length;p+=1){const c=tI(h,o,p);a[p]?a[p].p(c,u):(a[p]=nI(c),a[p].c(),a[p].m(r,null))}for(;p<a.length;p+=1)a[p].d(1);a.length=o.length}},i:gn,o:gn,d(h){h&&(It(t),It(i),It(r)),ti(a,h)}}}function nI(e){let t,i,r,o,a,h,u;function p(){return e[2](e[3])}return{c(){t=oe("div"),i=oe("h2"),i.textContent=`${e[3].title}`,r=ge(),o=oe("div"),o.textContent=`${e[3].description}`,a=ge(),fe(o,"class","description"),fe(t,"class","card")},m(c,f){Bt(c,t,f),D(t,i),D(t,r),D(t,o),D(t,a),h||(u=lt(t,"click",p),h=!0)},p(c,f){e=c},d(c){c&&It(t),h=!1,u()}}}function Boe(e){let t,i,r,o;const a=[Ioe,Toe],h=[];function u(p,c){return p[0]?1:0}return i=u(e),r=h[i]=a[i](e),{c(){t=oe("main"),r.c()},m(p,c){Bt(p,t,c),h[i].m(t,null),o=!0},p(p,[c]){let f=i;i=u(p),i===f?h[i].p(p,c):(u1(),Ot(h[f],1,1,()=>{h[f]=null}),h1(),r=h[i],r?r.p(p,c):(r=h[i]=a[i](p),r.c()),Nt(r,1),r.m(t,null))},i(p){o||(Nt(r),o=!0)},o(p){Ot(r),o=!1},d(p){p&&It(t),h[i].d()}}}function Roe(e,t,i){let r=[{id:"midi-logger",title:"MIDI Logger",description:"Logs all incoming MIDI messages. Useful for getting to know a device or debugging MIDI issues.",component:qse},{id:"piano-roll",title:"Piano Roll",description:"Shows MIDI input as a piano roll.",component:coe},{id:"guitar-tab",title:"Guitar Tab",description:"Shows MIDI input as guitar tab.",component:jse},{id:"guitar-tunings",title:"Guitar Tunings",description:"Small tool that computes the notes for a guitar tuning based on parameters. Open tunings are not included.",component:Xse},{id:"chord-detection",title:"Chord Detection",description:"Play a chord and see what it's named.",component:RY},{id:"note-colors",title:"Note Colors",description:"Different note coor schemes.",component:noe},{id:"scale-sets",title:"Scale Sets",description:"See how different musical scales relate to each other.",component:Eoe},{id:"scale-notes",title:"Scale Notes",description:"See which notes are in each scale.",component:Soe},{id:"tuner",title:"Tuner",description:"Tries to detect the currently most prominent pitch from microphone audio. Useful for tuning instruments.",component:boe}],{currentTool:o}=t;const a=h=>{i(0,o=h)};return e.$$set=h=>{"currentTool"in h&&i(0,o=h.currentTool)},[o,r,a]}class Loe extends pi{constructor(t){super(),di(this,t,Roe,Boe,fi,{currentTool:0})}}function Poe(e){let t,i,r,o,a,h,u,p,c,f,g,m,v,A,y,C,E,x;return{c(){t=oe("main"),i=oe("h2"),i.textContent="Settings",r=ge(),o=oe("h3"),o.textContent="Guitar MIDI",a=ge(),h=oe("p"),h.textContent="These settings allow reducing noise from MIDI guitars.",u=ge(),p=oe("label"),c=$e(`Minimum velocity (0-127)
        `),f=oe("input"),m=ge(),v=oe("label"),A=$e(`Minimum duration (seconds)
        `),y=oe("input"),fe(f,"type","number"),fe(f,"min","0"),fe(f,"max","127"),f.value=g=e[0].guitarMidiMinVelocity??0,fe(p,"class","svelte-1dsjbtd"),fe(y,"type","number"),fe(y,"min","0"),fe(y,"max","0.5"),fe(y,"step","0.05"),y.value=C=e[0].guitarMidiMinDuration??0,fe(v,"class","svelte-1dsjbtd")},m(M,w){Bt(M,t,w),D(t,i),D(t,r),D(t,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(p,f),D(t,m),D(t,v),D(v,A),D(v,y),E||(x=[lt(f,"change",e[2]),lt(y,"change",e[3])],E=!0)},p(M,[w]){w&1&&g!==(g=M[0].guitarMidiMinVelocity??0)&&f.value!==g&&(f.value=g),w&1&&C!==(C=M[0].guitarMidiMinDuration??0)&&y.value!==C&&(y.value=C)},i:gn,o:gn,d(M){M&&It(t),E=!1,ji(x)}}}function Doe(e,t,i){let r=JSON.parse(localStorage.getItem(q2)??"{}");const o=(u,p)=>{i(0,r[u]=p,r),localStorage.setItem(q2,JSON.stringify(r))};return[r,o,u=>o("guitarMidiMinVelocity",+u.target.value),u=>o("guitarMidiMinDuration",+u.target.value)]}class Noe extends pi{constructor(t){super(),di(this,t,Doe,Poe,fi,{})}}function iI(e,t,i){const r=e.slice();return r[7]=t[i],r}function rI(e,t,i){const r=e.slice();return r[10]=t[i],r}function sI(e,t,i){const r=e.slice();return r[13]=t[i],r}function oI(e,t,i){const r=e.slice();return r[7]=t[i],r}function aI(e,t,i){const r=e.slice();return r[10]=t[i],r}function Ooe(e,t,i){const r=e.slice();return r[7]=t[i],r}function Foe(e,t,i){const r=e.slice();return r[10]=t[i],r}function koe(e,t,i){const r=e.slice();return r[7]=t[i],r[25]=i,r}function lI(e,t,i){const r=e.slice();return r[26]=t[i],r}function cI(e,t,i){const r=e.slice();return r[13]=t[i],r}function uI(e,t,i){const r=e.slice();return r[26]=t[i],r}function hI(e,t,i){const r=e.slice();return r[26]=t[i],r}function fI(e){let t,i=e[26]+"",r;return{c(){t=oe("th"),r=$e(i),fe(t,"class","small svelte-14z88rj")},m(o,a){Bt(o,t,a),D(t,r)},p(o,a){a[0]&2&&i!==(i=o[26]+"")&&jt(r,i)},d(o){o&&It(t)}}}function dI(e){let t,i=e[13].instruments.includes(e[26])?"":"",r;return{c(){t=oe("td"),r=$e(i),fe(t,"class","svelte-14z88rj")},m(o,a){Bt(o,t,a),D(t,r)},p(o,a){a[0]&3&&i!==(i=o[13].instruments.includes(o[26])?"":"")&&jt(r,i)},d(o){o&&It(t)}}}function pI(e){let t,i,r=e[13].title+"",o,a,h,u=e[13].input==="MIDI"?"":"",p,c,f,g=e[13].input==="audio"?"":"",m,v,A,y=fn([...e[1]]),C=[];for(let E=0;E<y.length;E+=1)C[E]=dI(uI(e,y,E));return{c(){t=oe("tr"),i=oe("td"),o=$e(r),a=ge(),h=oe("td"),p=$e(u),c=ge(),f=oe("td"),m=$e(g),v=ge();for(let E=0;E<C.length;E+=1)C[E].c();A=ge(),cr(i,"text-align","right"),fe(i,"class","svelte-14z88rj"),fe(h,"class","svelte-14z88rj"),fe(f,"class","svelte-14z88rj"),fe(t,"class","svelte-14z88rj")},m(E,x){Bt(E,t,x),D(t,i),D(i,o),D(t,a),D(t,h),D(h,p),D(t,c),D(t,f),D(f,m),D(t,v);for(let M=0;M<C.length;M+=1)C[M]&&C[M].m(t,null);D(t,A)},p(E,x){if(x[0]&1&&r!==(r=E[13].title+"")&&jt(o,r),x[0]&1&&u!==(u=E[13].input==="MIDI"?"":"")&&jt(p,u),x[0]&1&&g!==(g=E[13].input==="audio"?"":"")&&jt(m,g),x[0]&3){y=fn([...E[1]]);let M;for(M=0;M<y.length;M+=1){const w=uI(E,y,M);C[M]?C[M].p(w,x):(C[M]=dI(w),C[M].c(),C[M].m(t,A))}for(;M<C.length;M+=1)C[M].d(1);C.length=y.length}},d(E){E&&It(t),ti(C,E)}}}function mI(e){let t,i=e[0].filter(o).length+"",r;function o(...a){return e[3](e[26],...a)}return{c(){t=oe("td"),r=$e(i),fe(t,"class","svelte-14z88rj")},m(a,h){Bt(a,t,h),D(t,r)},p(a,h){e=a,h[0]&3&&i!==(i=e[0].filter(o).length+"")&&jt(r,i)},d(a){a&&It(t)}}}function Uoe(e){let t;return{c(){t=oe("th"),t.textContent=`${e[7].title} `,fe(t,"colspan",e[7].children.length),cr(t,"border-bottom","4px solid "+Vp[e[25]])},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Goe(e){let t;return{c(){t=oe("th"),t.textContent=`${e[10].title}`,fe(t,"class","small svelte-14z88rj")},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Voe(e){let t,i=fn(e[7].children),r=[];for(let o=0;o<i.length;o+=1)r[o]=Goe(Foe(e,i,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();t=Zf()},m(o,a){for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(o,a);Bt(o,t,a)},p:gn,d(o){o&&It(t),ti(r,o)}}}function AI(e){let t,i=e[13].skills.includes(e[10].id)?"":"",r;return{c(){t=oe("td"),r=$e(i),fe(t,"class","svelte-14z88rj")},m(o,a){Bt(o,t,a),D(t,r)},p(o,a){a[0]&1&&i!==(i=o[13].skills.includes(o[10].id)?"":"")&&jt(r,i)},d(o){o&&It(t)}}}function gI(e){let t,i=fn(e[7].children),r=[];for(let o=0;o<i.length;o+=1)r[o]=AI(aI(e,i,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();t=Zf()},m(o,a){for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(o,a);Bt(o,t,a)},p(o,a){if(a[0]&1){i=fn(o[7].children);let h;for(h=0;h<i.length;h+=1){const u=aI(o,i,h);r[h]?r[h].p(u,a):(r[h]=AI(u),r[h].c(),r[h].m(t.parentNode,t))}for(;h<r.length;h+=1)r[h].d(1);r.length=i.length}},d(o){o&&It(t),ti(r,o)}}}function vI(e){let t,i,r=e[13].title+"",o,a,h,u=fn(lc),p=[];for(let c=0;c<u.length;c+=1)p[c]=gI(oI(e,u,c));return{c(){t=oe("tr"),i=oe("td"),o=$e(r),a=ge();for(let c=0;c<p.length;c+=1)p[c].c();h=ge(),cr(i,"text-align","right"),fe(i,"class","svelte-14z88rj"),fe(t,"class","svelte-14z88rj")},m(c,f){Bt(c,t,f),D(t,i),D(i,o),D(t,a);for(let g=0;g<p.length;g+=1)p[g]&&p[g].m(t,null);D(t,h)},p(c,f){if(f[0]&1&&r!==(r=c[13].title+"")&&jt(o,r),f[0]&1){u=fn(lc);let g;for(g=0;g<u.length;g+=1){const m=oI(c,u,g);p[g]?p[g].p(m,f):(p[g]=gI(m),p[g].c(),p[g].m(t,h))}for(;g<p.length;g+=1)p[g].d(1);p.length=u.length}},d(c){c&&It(t),ti(p,c)}}}function bI(e){let t,i=e[0].filter(a).length+"",r,o;function a(...h){return e[4](e[10],...h)}return{c(){t=oe("td"),r=$e(i),o=ge(),fe(t,"class","svelte-14z88rj")},m(h,u){Bt(h,t,u),D(t,r),D(t,o)},p(h,u){e=h,u[0]&1&&i!==(i=e[0].filter(a).length+"")&&jt(r,i)},d(h){h&&It(t)}}}function yI(e){let t,i=fn(e[7].children),r=[];for(let o=0;o<i.length;o+=1)r[o]=bI(rI(e,i,o));return{c(){for(let o=0;o<r.length;o+=1)r[o].c();t=Zf()},m(o,a){for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(o,a);Bt(o,t,a)},p(o,a){if(a[0]&1){i=fn(o[7].children);let h;for(h=0;h<i.length;h+=1){const u=rI(o,i,h);r[h]?r[h].p(u,a):(r[h]=bI(u),r[h].c(),r[h].m(t.parentNode,t))}for(;h<r.length;h+=1)r[h].d(1);r.length=i.length}},d(o){o&&It(t),ti(r,o)}}}function Qoe(e){let t,i,r,o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q=e[0].length+"",G,J,K,se=e[0].filter(_I).length+"",ue,he,Me,de=e[0].filter(EI).length+"",Pe,Se,Le,be,je,Te,rt,mt,vt,ft,Ze,St,$t,ct,Ct,Tt,At,pn,yt=e[0].length+"",kn,qn,Gt,bt,ye,_e,Ue=fn([...e[1]]),Re=[];for(let st=0;st<Ue.length;st+=1)Re[st]=fI(hI(e,Ue,st));let Ce=fn(e[0]),Ne=[];for(let st=0;st<Ce.length;st+=1)Ne[st]=pI(cI(e,Ce,st));let le=fn([...e[1]]),j=[];for(let st=0;st<le.length;st+=1)j[st]=mI(lI(e,le,st));let Z=fn(lc),pe=[];for(let st=0;st<Z.length;st+=1)pe[st]=Uoe(koe(e,Z,st));let Ee=fn(lc),Qe=[];for(let st=0;st<Ee.length;st+=1)Qe[st]=Voe(Ooe(e,Ee,st));let He=fn(e[0]),Pt=[];for(let st=0;st<He.length;st+=1)Pt[st]=vI(sI(e,He,st));let rn=fn(lc),Xt=[];for(let st=0;st<rn.length;st+=1)Xt[st]=yI(iI(e,rn,st));return{c(){t=oe("main"),i=oe("h2"),i.textContent="input and instrument",r=ge(),o=oe("table"),a=oe("thead"),h=oe("th"),h.textContent="title",u=ge(),p=oe("th"),p.textContent="input",c=ge(),f=oe("th"),g=$e("instrument"),v=ge(),A=oe("thead"),y=oe("th"),C=ge(),E=oe("th"),E.textContent="MIDI",x=ge(),M=oe("th"),M.textContent="audio",w=ge();for(let st=0;st<Re.length;st+=1)Re[st].c();S=ge(),I=oe("thead"),L=oe("th"),R=ge(),k=oe("th"),P=ge(),F=oe("th"),W=ge(),V=oe("tbody");for(let st=0;st<Ne.length;st+=1)Ne[st].c();$=ge(),H=oe("tr"),Y=oe("td"),G=$e(Q),J=ge(),K=oe("td"),ue=$e(se),he=ge(),Me=oe("td"),Pe=$e(de),Se=ge();for(let st=0;st<j.length;st+=1)j[st].c();Le=ge(),be=oe("h2"),be.textContent="skills",je=ge(),Te=oe("table"),rt=oe("thead"),mt=oe("th"),mt.textContent="title",vt=ge();for(let st=0;st<pe.length;st+=1)pe[st].c();ft=ge(),Ze=oe("thead"),St=oe("th"),$t=ge();for(let st=0;st<Qe.length;st+=1)Qe[st].c();ct=ge(),Ct=oe("tbody");for(let st=0;st<Pt.length;st+=1)Pt[st].c();Tt=ge(),At=oe("tr"),pn=oe("td"),kn=$e(yt),qn=ge();for(let st=0;st<Xt.length;st+=1)Xt[st].c();Gt=ge(),bt=oe("h2"),bt.textContent="skill tree",ye=ge(),_e=oe("div"),fe(p,"colspan","2"),fe(p,"class","blue svelte-14z88rj"),fe(f,"colspan",m=e[1].size),fe(f,"class","green svelte-14z88rj"),fe(E,"class","small svelte-14z88rj"),fe(M,"class","small svelte-14z88rj"),fe(k,"colspan","2"),fe(F,"colspan",O=e[1].size),fe(Y,"class","svelte-14z88rj"),fe(K,"class","svelte-14z88rj"),fe(Me,"class","svelte-14z88rj"),fe(H,"class","svelte-14z88rj"),fe(o,"class","svelte-14z88rj"),cr(mt,"min-width","270px"),fe(pn,"class","svelte-14z88rj"),fe(At,"class","svelte-14z88rj"),fe(Te,"class","svelte-14z88rj"),fe(_e,"class","visualization")},m(st,An){Bt(st,t,An),D(t,i),D(t,r),D(t,o),D(o,a),D(a,h),D(a,u),D(a,p),D(a,c),D(a,f),D(f,g),D(o,v),D(o,A),D(A,y),D(A,C),D(A,E),D(A,x),D(A,M),D(A,w);for(let Vt=0;Vt<Re.length;Vt+=1)Re[Vt]&&Re[Vt].m(A,null);D(o,S),D(o,I),D(I,L),D(I,R),D(I,k),D(I,P),D(I,F),D(o,W),D(o,V);for(let Vt=0;Vt<Ne.length;Vt+=1)Ne[Vt]&&Ne[Vt].m(V,null);D(V,$),D(V,H),D(H,Y),D(Y,G),D(H,J),D(H,K),D(K,ue),D(H,he),D(H,Me),D(Me,Pe),D(H,Se);for(let Vt=0;Vt<j.length;Vt+=1)j[Vt]&&j[Vt].m(H,null);D(t,Le),D(t,be),D(t,je),D(t,Te),D(Te,rt),D(rt,mt),D(rt,vt);for(let Vt=0;Vt<pe.length;Vt+=1)pe[Vt]&&pe[Vt].m(rt,null);D(Te,ft),D(Te,Ze),D(Ze,St),D(Ze,$t);for(let Vt=0;Vt<Qe.length;Vt+=1)Qe[Vt]&&Qe[Vt].m(Ze,null);D(Te,ct),D(Te,Ct);for(let Vt=0;Vt<Pt.length;Vt+=1)Pt[Vt]&&Pt[Vt].m(Ct,null);D(Ct,Tt),D(Ct,At),D(At,pn),D(pn,kn),D(At,qn);for(let Vt=0;Vt<Xt.length;Vt+=1)Xt[Vt]&&Xt[Vt].m(At,null);D(t,Gt),D(t,bt),D(t,ye),D(t,_e),e[5](_e)},p(st,An){if(An[0]&2&&m!==(m=st[1].size)&&fe(f,"colspan",m),An[0]&2){Ue=fn([...st[1]]);let Vt;for(Vt=0;Vt<Ue.length;Vt+=1){const Dn=hI(st,Ue,Vt);Re[Vt]?Re[Vt].p(Dn,An):(Re[Vt]=fI(Dn),Re[Vt].c(),Re[Vt].m(A,null))}for(;Vt<Re.length;Vt+=1)Re[Vt].d(1);Re.length=Ue.length}if(An[0]&2&&O!==(O=st[1].size)&&fe(F,"colspan",O),An[0]&3){Ce=fn(st[0]);let Vt;for(Vt=0;Vt<Ce.length;Vt+=1){const Dn=cI(st,Ce,Vt);Ne[Vt]?Ne[Vt].p(Dn,An):(Ne[Vt]=pI(Dn),Ne[Vt].c(),Ne[Vt].m(V,$))}for(;Vt<Ne.length;Vt+=1)Ne[Vt].d(1);Ne.length=Ce.length}if(An[0]&1&&Q!==(Q=st[0].length+"")&&jt(G,Q),An[0]&1&&se!==(se=st[0].filter(_I).length+"")&&jt(ue,se),An[0]&1&&de!==(de=st[0].filter(EI).length+"")&&jt(Pe,de),An[0]&3){le=fn([...st[1]]);let Vt;for(Vt=0;Vt<le.length;Vt+=1){const Dn=lI(st,le,Vt);j[Vt]?j[Vt].p(Dn,An):(j[Vt]=mI(Dn),j[Vt].c(),j[Vt].m(H,null))}for(;Vt<j.length;Vt+=1)j[Vt].d(1);j.length=le.length}if(An[0]&1){He=fn(st[0]);let Vt;for(Vt=0;Vt<He.length;Vt+=1){const Dn=sI(st,He,Vt);Pt[Vt]?Pt[Vt].p(Dn,An):(Pt[Vt]=vI(Dn),Pt[Vt].c(),Pt[Vt].m(Ct,Tt))}for(;Vt<Pt.length;Vt+=1)Pt[Vt].d(1);Pt.length=He.length}if(An[0]&1&&yt!==(yt=st[0].length+"")&&jt(kn,yt),An[0]&1){rn=fn(lc);let Vt;for(Vt=0;Vt<rn.length;Vt+=1){const Dn=iI(st,rn,Vt);Xt[Vt]?Xt[Vt].p(Dn,An):(Xt[Vt]=yI(Dn),Xt[Vt].c(),Xt[Vt].m(At,null))}for(;Vt<Xt.length;Vt+=1)Xt[Vt].d(1);Xt.length=rn.length}},i:gn,o:gn,d(st){st&&It(t),ti(Re,st),ti(Ne,st),ti(j,st),ti(pe,st),ti(Qe,st),ti(Pt,st),ti(Xt,st),e[5](null)}}}const _I=e=>e.input==="MIDI",EI=e=>e.input==="audio";function Hoe(e,t,i){let{demos:r=[]}=t,{allInstruments:o=new Set}=t,a;tr(()=>{const f=v=>{if(v.children){const A=v.children.flatMap(y=>f(y).map(C=>`${v.title}/${C}`));return[v.title,...A]}else return[v.title]},g=f({title:"skills",children:lc}),m=Ji({axis:null,margin:10,marginLeft:60,marginRight:160,width:800,marks:[qte(g,{treeSort:"node:height",fontSize:16})]});i(2,a.textContent="",a),a.appendChild(m)});const u=(f,g)=>g.instruments.includes(f),p=(f,g)=>g.skills.includes(f.id);function c(f){In[f?"unshift":"push"](()=>{a=f,i(2,a)})}return e.$$set=f=>{"demos"in f&&i(0,r=f.demos),"allInstruments"in f&&i(1,o=f.allInstruments)},[r,o,a,u,p,c]}class zoe extends pi{constructor(t){super(),di(this,t,Hoe,Qoe,fi,{demos:0,allInstruments:1},null,[-1,-1])}}var a1,l1,c1,yf,nm,zu,im,_f,rm,Qa,fl,Ef;class xw{constructor(){Ir(this,a1,.03);Ir(this,l1,.1);Ir(this,c1,50);Ir(this,yf,!1);Ir(this,nm,null);Ir(this,zu,null);Ir(this,im,4);Ir(this,_f,1/0);Ir(this,rm,void 0);Ir(this,Qa,null);Ir(this,fl,new AudioContext);Ir(this,Ef,null);pr(this,"_scheduler",()=>{const t=wn(this,im),i=60/wn(this,zu);let r=wn(this,rm)+wn(this,Qa)*i;for(;r<wn(this,fl).currentTime+wn(this,l1);)if(wn(this,Qa)<wn(this,_f)-1){r+=i;const o=wn(this,Qa)%t===t-1||wn(this,Qa)===-1,a=r-wn(this,fl).currentTime,h=performance.now()+a*1e3;this._playSound(r,h,o),Ux(this,Qa)._++}wn(this,Qa)<wn(this,_f)-1?mr(this,nm,setTimeout(this._scheduler,wn(this,c1))):this.stop()})}get bpm(){return wn(this,zu)}get beatCount(){return wn(this,Qa)}onClick(t){mr(this,Ef,t)}start(t,i=4,r=1/0){if(!t||Number.isNaN(+t)){console.error(`[Metronome] Invalid bpm ${t}`);return}if(!i||Number.isNaN(+i)){console.error(`[Metronome] Invalid accent ${i}`);return}if(!r||Number.isNaN(+r)){console.error(`[Metronome] Invalid maxBeeps ${r}`);return}wn(this,fl).state==="suspended"&&wn(this,fl).resume(),mr(this,zu,+t),mr(this,im,+i),mr(this,_f,+r),mr(this,yf,!0),console.log(`Metronome @ ${t}bpm, accent every ${i}. beat, limited to ${r}`),mr(this,Qa,-1),mr(this,rm,wn(this,fl).currentTime),this._scheduler()}stop(){console.log("[Metronome] stopped"),clearTimeout(wn(this,nm)),mr(this,yf,!1)}toggle(t,i=4,r=1/0){wn(this,yf)?this.stop():(t===void 0&&(t=wn(this,zu)),this.start(t,i,r))}_playSound(t,i,r){wn(this,Ef)&&wn(this,Ef).call(this,t,i,r);const o=wn(this,fl).createOscillator();o.connect(wn(this,fl).destination);const a=r?300:200;o.frequency.value=a,o.start(t),o.stop(t+wn(this,a1))}}a1=new WeakMap,l1=new WeakMap,c1=new WeakMap,yf=new WeakMap,nm=new WeakMap,zu=new WeakMap,im=new WeakMap,_f=new WeakMap,rm=new WeakMap,Qa=new WeakMap,fl=new WeakMap,Ef=new WeakMap;function joe(e){let t,i,r;return{c(){t=oe("button"),t.textContent="metronome",fe(t,"title","Toggle metronome (click)")},m(o,a){Bt(o,t,a),i||(r=lt(t,"click",e[4]),i=!0)},p:gn,i:gn,o:gn,d(o){o&&It(t),i=!1,r()}}}function Woe(e,t,i){let{tempo:r=120}=t,{accent:o=4}=t,{maxBeeps:a=1/0}=t;const h=new xw;Io(()=>{h.stop()});const u=()=>{h.toggle(r,o,a)};return e.$$set=p=>{"tempo"in p&&i(0,r=p.tempo),"accent"in p&&i(1,o=p.accent),"maxBeeps"in p&&i(2,a=p.maxBeeps)},[r,o,a,h,u]}class bc extends pi{constructor(t){super(),di(this,t,Woe,joe,fi,{tempo:0,accent:1,maxBeeps:2})}}function $oe(e){let t,i,r,o,a,h;return{c(){t=oe("label"),i=$e(e[2]),r=ge(),o=oe("input"),fe(o,"type","number"),fe(o,"step","5"),fe(o,"min","10"),fe(o,"max","400"),cr(o,"width","55px"),fe(t,"title",e[3])},m(u,p){Bt(u,t,p),D(t,i),D(t,r),D(t,o),ln(o,e[0]),a||(h=[lt(o,"input",e[4]),lt(o,"change",function(){Jf(e[1])&&e[1].apply(this,arguments)})],a=!0)},p(u,[p]){e=u,p&4&&jt(i,e[2]),p&1&&Yn(o.value)!==e[0]&&ln(o,e[0]),p&8&&fe(t,"title",e[3])},i:gn,o:gn,d(u){u&&It(t),a=!1,ji(h)}}}function Xoe(e,t,i){let{value:r}=t,{callback:o=()=>{}}=t,{label:a="tempo"}=t,{title:h="The tempo in beats per minute (bpm)"}=t;function u(){r=Yn(this.value),i(0,r)}return e.$$set=p=>{"value"in p&&i(0,r=p.value),"callback"in p&&i(1,o=p.callback),"label"in p&&i(2,a=p.label),"title"in p&&i(3,h=p.title)},[r,o,a,h,u]}class La extends pi{constructor(t){super(),di(this,t,Xoe,$oe,fi,{value:0,callback:1,label:2,title:3})}}function Koe(e){let t,i,r,o,a,h;return{c(){t=oe("label"),i=$e(e[2]),r=ge(),o=oe("input"),fe(o,"type","number"),fe(o,"step","10"),fe(o,"min",e[4]),fe(o,"max",e[5]),cr(o,"width","55px"),fe(t,"title",e[3])},m(u,p){Bt(u,t,p),D(t,i),D(t,r),D(t,o),ln(o,e[0]),a||(h=[lt(o,"input",e[6]),lt(o,"change",function(){Jf(e[1])&&e[1].apply(this,arguments)})],a=!0)},p(u,[p]){e=u,p&4&&jt(i,e[2]),p&16&&fe(o,"min",e[4]),p&32&&fe(o,"max",e[5]),p&1&&Yn(o.value)!==e[0]&&ln(o,e[0]),p&8&&fe(t,"title",e[3])},i:gn,o:gn,d(u){u&&It(t),a=!1,ji(h)}}}function Yoe(e,t,i){let{value:r}=t,{callback:o=()=>{}}=t,{label:a="note count"}=t,{title:h="The number of most recently played notes that are shown"}=t,{min:u=10}=t,{max:p=500}=t;function c(){r=Yn(this.value),i(0,r)}return e.$$set=f=>{"value"in f&&i(0,r=f.value),"callback"in f&&i(1,o=f.callback),"label"in f&&i(2,a=f.label),"title"in f&&i(3,h=f.title),"min"in f&&i(4,u=f.min),"max"in f&&i(5,p=f.max)},[r,o,a,h,u,p,c]}class ad extends pi{constructor(t){super(),di(this,t,Yoe,Koe,fi,{value:0,callback:1,label:2,title:3,min:4,max:5})}}const hP=[{name:"double-whole",beats:8,symbol:"_"},{name:"dotted-whole",beats:6,symbol:".",dotted:!0},{name:"whole",beats:4,symbol:""},{name:"dotted-half",beats:3,symbol:".",dotted:!0},{name:"half",beats:2,symbol:""},{name:"dotted-quarter",beats:1.5,symbol:".",dotted:!0},{name:"quarter",beats:1,symbol:""},{name:"quarter-triplet",beats:1/3,symbol:""},{name:"dotted-eighth",beats:.75,symbol:".",dotted:!0},{name:"eighth",beats:.5,symbol:""},{name:"dotted-sixteenth",beats:.375,symbol:".",dotted:!0},{name:"sixteenth",beats:.25,symbol:""},{name:"thirtysecond",beats:.125,symbol:""},{name:"sixtyfourth",beats:.0625,symbol:""}];function qoe(e){let t,i,r;return{c(){t=oe("button"),t.textContent="reset",fe(t,"title","Clear all played notes")},m(o,a){Bt(o,t,a),i||(r=lt(t,"click",e[2]),i=!0)},p:gn,i:gn,o:gn,d(o){o&&It(t),i=!1,r()}}}function Joe(e,t,i){let{notes:r=[]}=t,{callback:o=()=>{}}=t;const a=()=>{(r.length===0||confirm("Reset played notes?"))&&(i(0,r=[]),o())};return e.$$set=h=>{"notes"in h&&i(0,r=h.notes),"callback"in h&&i(1,o=h.callback)},[r,o,a]}class qs extends pi{constructor(t){super(),di(this,t,Joe,qoe,fi,{notes:0,callback:1})}}function Zoe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S=(e[4]?Yr:qr)+"",I,L,R,k,P,F,O,W,V,$,H,Y,Q,G;function J(de){e[9](de)}let K={callback:e[8]};e[2]!==void 0&&(K.value=e[2]),v=new La({props:K}),In.push(()=>Yi(v,"value",J));function se(de){e[10](de)}let ue={callback:e[8]};e[3]!==void 0&&(ue.value=e[3]),C=new ad({props:ue}),In.push(()=>Yi(C,"value",se));function he(de){e[14](de)}let Me={callback:e[13]};return e[6]!==void 0&&(Me.notes=e[6]),F=new qs({props:Me}),In.push(()=>Yi(F,"notes",he)),V=new bc({props:{tempo:e[2],accent:4}}),H=new Nr({props:{noteOn:e[7]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Set a tempo and start playing. The time between the notes you play will
        be displayed as note symbols, so you can see whether you play, for
        example, correct quarter notes. The note's velocity is encoded as font
        size, so you can see whether you accent the correct notes, for example
        the first note in each triplet, or the the first in each group of 4. You
        can also try different accent patterns such as:`,u=ge(),p=oe("p"),p.innerHTML="<b>1</b>e+<b>a</b> 2e+a 3<b>e</b>+a <b>4</b>e+a",c=ge(),f=oe("p"),f.innerHTML=`<span class="acc svelte-64izzl"></span>   <span class="acc svelte-64izzl"></span> |     | 
        <span class="acc svelte-64izzl"></span>
          |
        <span class="acc svelte-64izzl"></span>
          `,g=ge(),m=oe("div"),Ut(v.$$.fragment),y=ge(),Ut(C.$$.fragment),x=ge(),M=oe("button"),w=$e("dotted notes "),I=$e(S),L=ge(),R=oe("div"),k=ge(),P=oe("div"),Ut(F.$$.fragment),W=ge(),Ut(V.$$.fragment),$=ge(),Ut(H.$$.fragment),fe(h,"class","explanation"),fe(M,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),fe(m,"class","control"),fe(R,"class","visualization"),fe(P,"class","control"),fe(t,"class","demo")},m(de,Pe){Bt(de,t,Pe),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(t,c),D(t,f),D(t,g),D(t,m),Ft(v,m,null),D(m,y),Ft(C,m,null),D(m,x),D(m,M),D(M,w),D(M,I),D(t,L),D(t,R),e[12](R),D(t,k),D(t,P),Ft(F,P,null),D(P,W),Ft(V,P,null),D(t,$),Ft(H,t,null),Y=!0,Q||(G=lt(M,"click",e[11]),Q=!0)},p(de,[Pe]){(!Y||Pe&1)&&r!==(r=de[0].title+"")&&jt(o,r);const Se={};!A&&Pe&4&&(A=!0,Se.value=de[2],Ki(()=>A=!1)),v.$set(Se);const Le={};!E&&Pe&8&&(E=!0,Le.value=de[3],Ki(()=>E=!1)),C.$set(Le),(!Y||Pe&16)&&S!==(S=(de[4]?Yr:qr)+"")&&jt(I,S);const be={};Pe&32&&(be.callback=de[13]),!O&&Pe&64&&(O=!0,be.notes=de[6],Ki(()=>O=!1)),F.$set(be);const je={};Pe&4&&(je.tempo=de[2]),V.$set(je)},i(de){Y||(Nt(v.$$.fragment,de),Nt(C.$$.fragment,de),Nt(F.$$.fragment,de),Nt(V.$$.fragment,de),Nt(H.$$.fragment,de),Y=!0)},o(de){Ot(v.$$.fragment,de),Ot(C.$$.fragment,de),Ot(F.$$.fragment,de),Ot(V.$$.fragment,de),Ot(H.$$.fragment,de),Y=!1},d(de){de&&It(t),kt(v),kt(C),e[12](null),kt(F),kt(V),kt(H),Q=!1,G()}}}let wI=1e3;function eae(e,t,i){let{demoInfo:r}=t,o,a=120,h=12,u=!0,p=0,c=[];const f=hP,g=f.filter(w=>!w.dotted),m=async w=>{const I={time:(w.timestamp-p)/1e3,velocity:w.velocity};c.push(I),v()},v=()=>{if(i(1,o.textContent="",o),c.length===0)return;let w=xs(a);const S=c.slice(-(h+1)),I=S.map((F,O)=>O===0?{}:{delta:(F.time-S[O-1].time)/w,velocity:S[O-1].velocity}),L=u?f:g,R=I.slice(1).map(F=>{const O=H_(L,V=>Math.abs(F.delta-V.beats)),W=L[O];return{...W,beats:F,velocity:F.velocity,offsetPercent:(F.delta/W.beats*100).toFixed()}}),k=Ji({width:wI,height:100,marginLeft:80,x:{label:"",domain:Mn(1,h),ticks:[]},y:{},marks:[Ba(R,{text:"symbol",x:(F,O)=>O,fontSize:F=>F.velocity*60+10})]});o.appendChild(k);const P=Ji({width:wI,height:100,marginLeft:80,marks:[Ba(Mn(.1,1.1,.1),{text:F=>"",x:(F,O)=>F,fontSize:F=>F*60+10})]});o.appendChild(P)};tr(v);function A(w){a=w,i(2,a)}function y(w){h=w,i(3,h)}const C=()=>{i(4,u=!u),v()};function E(w){In[w?"unshift":"push"](()=>{o=w,i(1,o)})}const x=()=>{i(5,p=performance.now()),v()};function M(w){c=w,i(6,c)}return e.$$set=w=>{"demoInfo"in w&&i(0,r=w.demoInfo)},[r,o,a,h,u,p,c,m,v,A,y,C,E,x,M]}class tae extends pi{constructor(t){super(),di(this,t,eae,Zoe,fi,{demoInfo:0})}}function Mw(e,t){const i=[];let r=[];for(const o of e)r.length===0||o.time-r.at(-1).time<t?r.push(o):(i.push(r),r=[o]);return i.push(r),i}function nae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k;return I=new Nr({props:{noteOn:e[6]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Play chords or short arpeggios with pauses inbetween. In the
        visualization below, you can then see how long the time between the
        first and last note of each chord/arpeggio was and how much time lies
        between consecutive chords/arpeggios.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`max. note distance
            `),g=oe("input"),m=ge(),v=oe("label"),A=$e(`time
            `),y=oe("input"),C=ge(),E=oe("div"),x=ge(),M=oe("div"),w=oe("button"),w.textContent="reset",S=ge(),Ut(I.$$.fragment),fe(h,"class","explanation"),fe(g,"type","number"),fe(g,"min","0.05"),fe(g,"max","5"),fe(g,"step","0.05"),fe(c,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),fe(y,"type","number"),fe(y,"min","10"),fe(y,"max","300"),fe(y,"step","10"),fe(v,"title","time in seconds for past notes to be shown"),fe(p,"class","control"),fe(E,"class","visualization"),fe(w,"title","Clear all played notes"),fe(M,"class","control"),fe(t,"class","demo")},m(P,F){Bt(P,t,F),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g),ln(g,e[3]),D(p,m),D(p,v),D(v,A),D(v,y),ln(y,e[2]),D(t,C),D(t,E),e[10](E),D(t,x),D(t,M),D(M,w),D(t,S),Ft(I,t,null),L=!0,R||(k=[lt(g,"input",e[8]),lt(g,"change",e[7]),lt(y,"input",e[9]),lt(y,"change",e[7]),lt(w,"click",e[11])],R=!0)},p(P,[F]){(!L||F&1)&&r!==(r=P[0].title+"")&&jt(o,r),F&8&&Yn(g.value)!==P[3]&&ln(g,P[3]),F&4&&Yn(y.value)!==P[2]&&ln(y,P[2])},i(P){L||(Nt(I.$$.fragment,P),L=!0)},o(P){Ot(I.$$.fragment,P),L=!1},d(P){P&&It(t),e[10](null),kt(I),R=!1,ji(k)}}}let n2=1e3,iae=400;function rae(e,t,i){let{demoInfo:r}=t,o,a=10,h=.2,u=0,p=[];const c=y=>{p.length===0&&i(4,u=y.timestamp);const C=(y.timestamp-u)/1e3,E={number:y.note.number,velocity:y.rawVelocity,time:C,channel:y.message.channel};p.push(E),f()},f=()=>{const y=Zr(p,R=>R.time)+.5,C=y-a,E=p.filter(R=>R.end>C||R.end===void 0),M=Mw(E,h).map(R=>Ms(R,k=>k.time)),w=M.slice(1).map((R,k)=>[M[k][0],R[0]]),S=Ji({insetRight:10,width:n2,height:iae,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[C,y]},y:{label:"MIDI Pitch",grid:!0,reverse:!0,tickFormat:R=>$f[R].label},marks:[Xa(E,{clip:!0,x:"time",y:"number",fill:"#ddd",stroke:"#ccc"})]}),I=Ji({insetRight:10,width:n2,height:100,marginLeft:60,marginTop:0,marginBottom:0,padding:0,x:{label:null,domain:[C,y],axis:!1},y:{ticks:[],label:"durations (s)"},marks:[p_(M,{clip:!0,x1:R=>R[0],x2:R=>R[1],y:0}),Ba(M,{clip:!0,x:R=>R[0],y:0,text:(R,k)=>(R[1]-R[0]).toFixed(2),dy:10,textAnchor:"start"})]}),L=Ji({insetRight:10,width:n2,height:100,marginLeft:60,marginBottom:40,padding:0,x:{label:"Time in seconds",domain:[C,y]},y:{ticks:[],label:"gaps (s)"},marks:[p_(w,{clip:!0,x1:R=>R[0],x2:R=>R[1],y:0}),Xa(w,{clip:!0,x:R=>R[0]}),Ba(w,{clip:!0,x:R=>R[0],y:0,text:(R,k)=>(R[1]-R[0]).toFixed(2),dx:2,dy:10,textAnchor:"start"})]});i(1,o.textContent="",o),o.appendChild(S),o.appendChild(I),o.appendChild(L)};tr(f);function g(){h=Yn(this.value),i(3,h)}function m(){a=Yn(this.value),i(2,a)}function v(y){In[y?"unshift":"push"](()=>{o=y,i(1,o)})}const A=()=>{confirm("Reset played notes?")&&(i(5,p=[]),i(4,u=performance.now()))};return e.$$set=y=>{"demoInfo"in y&&i(0,r=y.demoInfo)},[r,o,a,h,u,p,c,f,g,m,v,A]}class sae extends pi{constructor(t){super(),di(this,t,rae,nae,fi,{demoInfo:0})}}function oae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W;return P=new Nr({props:{noteOn:e[7]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent="Play chords on a guitar and see the chord names and diagrams.",u=ge(),p=oe("div"),c=oe("label"),f=$e(`max. note distance
            `),g=oe("input"),m=ge(),v=oe("label"),A=$e(`max. fret span
            `),y=oe("input"),C=ge(),E=oe("label"),x=$e(`chord count
            `),M=oe("input"),w=ge(),S=oe("div"),I=ge(),L=oe("div"),R=oe("button"),R.textContent="reset",k=ge(),Ut(P.$$.fragment),fe(h,"class","explanation"),fe(g,"type","number"),fe(g,"min","0.05"),fe(g,"max","5"),fe(g,"step","0.05"),fe(c,"title","maximum distance between notes such that they still count as beloning to the same chord/arpeggio"),fe(y,"type","number"),fe(y,"min","5"),fe(y,"max","25"),fe(y,"step","1"),fe(v,"title","maximum distance between the lowest and highest fret"),fe(M,"type","number"),fe(M,"min","10"),fe(M,"max","300"),fe(M,"step","10"),fe(E,"title","The number of played chords that is displayed"),fe(p,"class","control"),fe(S,"class","visualization"),fe(R,"title","Clear all played notes"),fe(L,"class","control"),fe(t,"class","demo")},m(V,$){Bt(V,t,$),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g),ln(g,e[4]),D(p,m),D(p,v),D(v,A),D(v,y),ln(y,e[3]),D(p,C),D(p,E),D(E,x),D(E,M),ln(M,e[2]),D(t,w),D(t,S),e[12](S),D(t,I),D(t,L),D(L,R),D(t,k),Ft(P,t,null),F=!0,O||(W=[lt(g,"input",e[9]),lt(g,"change",e[8]),lt(y,"input",e[10]),lt(y,"change",e[8]),lt(M,"input",e[11]),lt(M,"change",e[8]),lt(R,"click",e[13])],O=!0)},p(V,[$]){(!F||$&1)&&r!==(r=V[0].title+"")&&jt(o,r),$&16&&Yn(g.value)!==V[4]&&ln(g,V[4]),$&8&&Yn(y.value)!==V[3]&&ln(y,V[3]),$&4&&Yn(M.value)!==V[2]&&ln(M,V[2])},i(V){F||(Nt(P.$$.fragment,V),F=!0)},o(V){Ot(P.$$.fragment,V),F=!1},d(V){V&&It(t),e[12](null),kt(P),O=!1,ji(W)}}}let CI=200,xI=6,aae=24;function lae(e,t,i){let{demoInfo:r}=t,o,a=5,h=5,u=.1,p=[64,59,55,50,45,40];const c=p.map(Ss.fromMidiSharps);let f=0,g=[];const m=M=>{g.length===0&&i(5,f=M.timestamp);const w=(M.timestamp-f)/1e3,S=M.message.channel-1,I={time:w,number:M.note.number,velocity:M.rawVelocity,string:S,fret:M.note.number-p[S],channel:M.message.channel};g.push(I),v()},v=()=>{let M=Mw(g,u);M=M.map(L=>{const R=L.filter(F=>F.fret>0);let k;R.length===0?k=0:k=So(R,F=>F.fret);const P=k+h;return L.filter(F=>F.fret<=P)}),M=M.filter(L=>L.length>2).slice(-a);for(const[L,R]of M.entries())for(const k of R)k.chordId=L;const w=M.map(L=>{let R=L.sort((k,P)=>k.number-P.number).map(k=>Ss.fromMidiSharps(k.number));return R=[...new Set(R)],jg.detect(R)}),S=(CI-35)/3*(h+1)+50,I=(S-100)/(h+2);i(1,o.textContent="",o);for(const[L,R]of M.entries()){const k=R.filter(W=>W.fret>0);let P=0;k.length>0&&(P=So(k,W=>W.fret));const F=P+h,O=Ji({width:S,height:CI,marginLeft:40,marginRight:10,marginBottom:25,padding:0,figure:!0,subtitle:w[L].join(", "),style:{textAlign:"center"},x:{domain:Mn(P===0?0:P-1,F+2),label:"",tickSize:0,tickPadding:15},y:{domain:Mn(0,xI),tickFormat:W=>c[W],label:"",tickSize:0,tickPadding:15},color:{domain:Mn(12),range:Sp.noteColormap,legend:L===0,marginLeft:100,width:600,type:"categorical",tickFormat:W=>nu[W]},r:{domain:[0,1],range:[5,10]},marks:[no(Mn(0,aae+1),{stroke:"#ddd",dx:I/2}),hs(Mn(0,xI),{stroke:"#ddd",strokeWidth:W=>Math.sqrt(W+1)}),po([3,5,7,9,15,17,19,21],{x:W=>W,y:2,dy:I/2,fill:"#ddd",r:8}),po([12,12,24,24],{x:W=>W,y:(W,V)=>V%2===0?1:3,dy:I/2,fill:"#ddd",r:8}),po(R.filter(W=>W.fret>0),{x:"fret",y:"string",r:"velocity",fill:W=>W.number%12,tip:!0}),po(R.filter(W=>W.fret===0),{x:P===0?0:P-1,y:"string",r:"velocity",stroke:W=>W.number%12,tip:!0})]});o.appendChild(O)}};tr(v);function A(){u=Yn(this.value),i(4,u)}function y(){h=Yn(this.value),i(3,h)}function C(){a=Yn(this.value),i(2,a)}function E(M){In[M?"unshift":"push"](()=>{o=M,i(1,o)})}const x=()=>{confirm("Reset played notes?")&&(i(6,g=[]),i(5,f=performance.now()))};return e.$$set=M=>{"demoInfo"in M&&i(0,r=M.demoInfo)},[r,o,a,h,u,f,g,m,v,A,y,C,E,x]}class cae extends pi{constructor(t){super(),di(this,t,lae,oae,fi,{demoInfo:0})}}function uae(e){let t,i,r;return{c(){t=oe("button"),t.textContent="export",fe(t,"title","Export all data and settings")},m(o,a){Bt(o,t,a),i||(r=lt(t,"click",function(){Jf(e[0])&&e[0].apply(this,arguments)}),i=!0)},p(o,[a]){e=o},i:gn,o:gn,d(o){o&&It(t),i=!1,r()}}}function hae(e,t,i){let{exportFunction:r}=t;return e.$$set=o=>{"exportFunction"in o&&i(0,r=o.exportFunction)},[r]}class $o extends pi{constructor(t){super(),di(this,t,hae,uae,fi,{exportFunction:0})}}function fae(e){let t,i,r,o,a;return{c(){t=oe("button"),t.textContent="import",i=ge(),r=oe("input"),fe(t,"title","Import all data and settings"),fe(r,"type","file"),fe(r,"id","file-input"),cr(r,"display","none")},m(h,u){Bt(h,t,u),Bt(h,i,u),Bt(h,r,u),e[3](r),o||(a=[lt(t,"click",e[2]),lt(r,"input",function(){Jf(e[0])&&e[0].apply(this,arguments)})],o=!0)},p(h,[u]){e=h},i:gn,o:gn,d(h){h&&(It(t),It(i),It(r)),e[3](null),o=!1,ji(a)}}}function dae(e,t,i){let{importFunction:r}=t,o;const a=()=>o.click();function h(u){In[u?"unshift":"push"](()=>{o=u,i(1,o)})}return e.$$set=u=>{"importFunction"in u&&i(0,r=u.importFunction)},[r,o,a,h]}class Xo extends pi{constructor(t){super(),di(this,t,dae,fae,fi,{importFunction:0})}}function pae(e,t){return t instanceof Map?{dataType:"Map",value:Array.from(t.entries())}:t}function mae(e,t){return typeof t=="object"&&t!==null&&t.dataType==="Map"?new Map(t.value):t}async function Ro(e){const i=await e.target.files[0].text();return JSON.parse(i,mae)}function Lo(e,t){t._demoId=e,t._date=new Date().toISOString();const i=JSON.stringify(t,pae,2),r=new Blob([i],{type:"text/plain;charset=utf-8"});D6(r,`${e}.json`)}function Aae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g=(e[2]?Yr:qr)+"",m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$;function H(Q){e[12](Q)}let Y={callback:e[6]};return e[4]!==void 0&&(Y.notes=e[4]),S=new qs({props:Y}),In.push(()=>Yi(S,"notes",H)),R=new $o({props:{exportFunction:e[7]}}),P=new Xo({props:{importFunction:e[8]}}),O=new Nr({props:{noteOn:e[5]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI instrument and start playing. The loudness of each note
        will be shown as a bar. Bar heights are either exact or rounded to the
        <a href="https://en.wikipedia.org/wiki/Dynamics_(music)">closest rough dynamics</a>, for example a forte.`,u=ge(),p=oe("div"),c=oe("button"),f=$e("binning "),m=$e(g),v=ge(),A=oe("label"),y=$e(`bars
            `),C=oe("input"),E=ge(),x=oe("div"),M=ge(),w=oe("div"),Ut(S.$$.fragment),L=ge(),Ut(R.$$.fragment),k=ge(),Ut(P.$$.fragment),F=ge(),Ut(O.$$.fragment),fe(h,"class","explanation"),fe(c,"title","You can change between seeing exact bar heights and binned (rounded) heights."),fe(C,"type","number"),fe(C,"step","25"),fe(C,"min","25"),fe(C,"max","1000"),cr(C,"width","55px"),fe(A,"title","The number of most recent notes that are shown as bars."),fe(p,"class","control svelte-1p166uy"),fe(x,"class","visualization svelte-1p166uy"),fe(w,"class","control svelte-1p166uy"),fe(t,"class","demo")},m(Q,G){Bt(Q,t,G),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,m),D(p,v),D(p,A),D(A,y),D(A,C),ln(C,e[3]),D(t,E),D(t,x),e[11](x),D(t,M),D(t,w),Ft(S,w,null),D(w,L),Ft(R,w,null),D(w,k),Ft(P,w,null),D(t,F),Ft(O,t,null),W=!0,V||($=[lt(c,"click",e[9]),lt(C,"input",e[10]),lt(C,"change",e[6])],V=!0)},p(Q,[G]){(!W||G&1)&&r!==(r=Q[0].title+"")&&jt(o,r),(!W||G&4)&&g!==(g=(Q[2]?Yr:qr)+"")&&jt(m,g),G&8&&Yn(C.value)!==Q[3]&&ln(C,Q[3]);const J={};!I&&G&16&&(I=!0,J.notes=Q[4],Ki(()=>I=!1)),S.$set(J)},i(Q){W||(Nt(S.$$.fragment,Q),Nt(R.$$.fragment,Q),Nt(P.$$.fragment,Q),Nt(O.$$.fragment,Q),W=!0)},o(Q){Ot(S.$$.fragment,Q),Ot(R.$$.fragment,Q),Ot(P.$$.fragment,Q),Ot(O.$$.fragment,Q),W=!1},d(Q){Q&&It(t),e[11](null),kt(S),kt(R),kt(P),kt(O),V=!1,ji($)}}}let gae=1e3,vae=600;function bae(e,t,i){let{demoInfo:r}=t,o;const h=new Map([[0,"silent"],[16,"ppp"],[32,"pp"],[48,"p"],[64,"mp"],[80,"mf"],[96,"f"],[112,"ff"],[127,"fff"]]);let u=!0,p=50,c=[];const f=x=>{c.push(x.rawVelocity),g()},g=()=>{let x=c;u&&(x=c.map(S=>{for(const I of h.keys())if(S<=I)return I}));const M=[...h.keys()],w=Ji({width:gae,height:vae,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:M,tickFormat:S=>h.get(S),domain:[0,128],tickSize:0},marks:[Wf(x.slice(-p),{x:(S,I)=>I,y:S=>S,fill:"#ddd",inset:0,dx:.5}),hs(M,{stroke:"#888"})]});i(1,o.textContent="",o),o.appendChild(w)},m=()=>{const x={isBinning:u,barLimit:p,noteVelocities:c};Lo(r.id,x)},v=async x=>{if(c.length===0||confirm("Import data and overwrite currently unsaved data?")){const M=await Ro(x);i(2,u=M.isBinning),i(3,p=M.barLimit),i(4,c=M.noteVelocities),g()}};tr(g);const A=()=>{i(2,u=!u),g()};function y(){p=Yn(this.value),i(3,p)}function C(x){In[x?"unshift":"push"](()=>{o=x,i(1,o)})}function E(x){c=x,i(4,c)}return e.$$set=x=>{"demoInfo"in x&&i(0,r=x.demoInfo)},[r,o,u,p,c,f,g,m,v,A,y,C,E]}class yae extends pi{constructor(t){super(),di(this,t,bae,Aae,fi,{demoInfo:0})}}function _ae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M;function w(R){e[6](R)}let S={callback:e[5]};e[2]!==void 0&&(S.value=e[2]),c=new ad({props:S}),In.push(()=>Yi(c,"value",w));function I(R){e[8](R)}let L={callback:e[5]};return e[3]!==void 0&&(L.notes=e[3]),y=new qs({props:L}),In.push(()=>Yi(y,"notes",I)),x=new Nr({props:{noteOn:e[4]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI guitar and start playing. The heatmap below shows how
        often you played each fretboard position.`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("div"),v=ge(),A=oe("div"),Ut(y.$$.fragment),E=ge(),Ut(x.$$.fragment),fe(h,"class","explanation"),fe(p,"class","control"),fe(m,"class","visualization"),fe(A,"class","control"),fe(t,"class","demo")},m(R,k){Bt(R,t,k),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(t,g),D(t,m),e[7](m),D(t,v),D(t,A),Ft(y,A,null),D(t,E),Ft(x,t,null),M=!0},p(R,[k]){(!M||k&1)&&r!==(r=R[0].title+"")&&jt(o,r);const P={};!f&&k&4&&(f=!0,P.value=R[2],Ki(()=>f=!1)),c.$set(P);const F={};!C&&k&8&&(C=!0,F.notes=R[3],Ki(()=>C=!1)),y.$set(F)},i(R){M||(Nt(c.$$.fragment,R),Nt(y.$$.fragment,R),Nt(x.$$.fragment,R),M=!0)},o(R){Ot(c.$$.fragment,R),Ot(y.$$.fragment,R),Ot(x.$$.fragment,R),M=!1},d(R){R&&It(t),kt(c),e[7](null),kt(y),kt(x)}}}let MI=1e3,Eae=280,SI=6,i2=24;function wae(e,t,i){let{demoInfo:r}=t,o=[64,59,55,50,45,40];const a=o.map(Ss.fromMidiSharps);let h,u=200,p=0,c=[];const f=y=>{c.length===0&&(p=y.timestamp);const C=(y.timestamp-p)/1e3,E=y.message.channel-1,x={time:C,number:y.note.number,velocity:y.rawVelocity,string:E,fret:y.note.number-o[E],channel:y.message.channel};c.push(x),g()},g=()=>{const y=c.slice(-u),C=(MI-100)/25,E=Ji({width:MI,height:Eae,marginLeft:60,marginBottom:50,padding:0,x:{domain:Mn(0,i2+1),ticks:Mn(0,i2+1),tickSize:0},y:{domain:Mn(0,SI),tickFormat:x=>a[x],tickSize:0},color:{legend:!0,marginLeft:100,width:400,scheme:"blues",label:"count"},marks:[no(Mn(0,i2+1),{stroke:"#ddd",dx:C/2}),hs(Mn(0,SI),{stroke:"#ddd",strokeWidth:x=>Math.sqrt(x+1)}),po([3,5,7,9,15,17,19,21],{x:x=>x,y:2,dy:C/2,fill:"#ddd",r:8}),po([12,12,24,24],{x:x=>x,y:(x,M)=>M%2===0?1:3,dy:C/2,fill:"#ddd",r:8}),m_(y,Aq({fill:"count"},{x:"fret",y:"string",fill:"count",inset:5,rx:"50%",tip:!0}))]});i(1,h.textContent="",h),h.appendChild(E)};tr(g);function m(y){u=y,i(2,u)}function v(y){In[y?"unshift":"push"](()=>{h=y,i(1,h)})}function A(y){c=y,i(3,c)}return e.$$set=y=>{"demoInfo"in y&&i(0,r=y.demoInfo)},[r,h,u,c,f,g,m,v,A]}class Cae extends pi{constructor(t){super(),di(this,t,wae,_ae,fi,{demoInfo:0})}}function TI(e,t,i){const r=e.slice();return r[15]=t[i],r}function II(e,t,i){const r=e.slice();return r[18]=t[i],r}function BI(e){let t,i=e[18]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[18],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function RI(e){let t,i=e[15]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[15],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function xae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k=fn(e[5]),P=[];for(let $=0;$<k.length;$+=1)P[$]=BI(II(e,k,$));let F=fn(e[6]),O=[];for(let $=0;$<F.length;$+=1)O[$]=RI(TI(e,F,$));function W($){e[12]($)}let V={callback:e[8]};return e[4]!==void 0&&(V.notes=e[4]),x=new qs({props:V}),In.push(()=>Yi(x,"notes",W)),S=new Nr({props:{noteOn:e[7]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Each time you play a note, the fretboard below shows you how far each
        note of the scale is away from the note you just played.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`scale
            `),g=oe("select");for(let $=0;$<P.length;$+=1)P[$].c();m=ge(),v=oe("select");for(let $=0;$<O.length;$+=1)O[$].c();A=ge(),y=oe("div"),C=ge(),E=oe("div"),Ut(x.$$.fragment),w=ge(),Ut(S.$$.fragment),fe(h,"class","explanation"),e[2]===void 0&&yr(()=>e[9].call(g)),e[3]===void 0&&yr(()=>e[10].call(v)),fe(p,"class","control"),fe(y,"class","visualization"),fe(E,"class","control"),fe(t,"class","demo")},m($,H){Bt($,t,H),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let Y=0;Y<P.length;Y+=1)P[Y]&&P[Y].m(g,null);ci(g,e[2],!0),D(c,m),D(c,v);for(let Y=0;Y<O.length;Y+=1)O[Y]&&O[Y].m(v,null);ci(v,e[3],!0),D(t,A),D(t,y),e[11](y),D(t,C),D(t,E),Ft(x,E,null),D(t,w),Ft(S,t,null),I=!0,L||(R=[lt(g,"change",e[9]),lt(g,"change",e[8]),lt(v,"change",e[10]),lt(v,"change",e[8])],L=!0)},p($,[H]){if((!I||H&1)&&r!==(r=$[0].title+"")&&jt(o,r),H&32){k=fn($[5]);let Q;for(Q=0;Q<k.length;Q+=1){const G=II($,k,Q);P[Q]?P[Q].p(G,H):(P[Q]=BI(G),P[Q].c(),P[Q].m(g,null))}for(;Q<P.length;Q+=1)P[Q].d(1);P.length=k.length}if(H&36&&ci(g,$[2]),H&64){F=fn($[6]);let Q;for(Q=0;Q<F.length;Q+=1){const G=TI($,F,Q);O[Q]?O[Q].p(G,H):(O[Q]=RI(G),O[Q].c(),O[Q].m(v,null))}for(;Q<O.length;Q+=1)O[Q].d(1);O.length=F.length}H&72&&ci(v,$[3]);const Y={};!M&&H&16&&(M=!0,Y.notes=$[4],Ki(()=>M=!1)),x.$set(Y)},i($){I||(Nt(x.$$.fragment,$),Nt(S.$$.fragment,$),I=!0)},o($){Ot(x.$$.fragment,$),Ot(S.$$.fragment,$),I=!1},d($){$&&It(t),ti(P,$),ti(O,$),e[11](null),kt(x),kt(S),L=!1,ji(R)}}}let LI=1e3,Mae=280,r2=6,s2=24;function Sae(e,t,i){let{demoInfo:r}=t,o,a="A",h="minor pentatonic",u=[],p=[64,59,55,50,45,40];const c=p.map(Ss.fromMidiSharps),f=Um,g=Ws.names(),m=x=>{const M=x.message.channel-1,w={number:x.note.number,velocity:x.rawVelocity,time:x.timestamp,channel:x.message.channel,string:M,fret:x.note.number-p[M]};u.push(w),v()},v=()=>{const x=u.at(-1),M=[];if(x){const I=x.number%12,L=Ws.get(`${a} ${h}`),R=new Map(L.notes.map((k,P)=>{const F=f.indexOf(k);let O=F-I;O=O>=0?O:O+12;const W={name:k,chroma:F,interval:L.intervals[P],degree:P,offset:O};return[F,W]}));for(let k=0;k<r2;k++)for(let P=0;P<s2+1;P++){const F=(p[k]+P)%12;R.has(F)&&M.push({string:k,fret:P,step:R.get(F).offset})}}const w=(LI-100)/25,S=Ji({width:LI,height:Mae,marginLeft:60,marginBottom:50,padding:0,x:{domain:Mn(0,s2+1),tickSize:0},y:{domain:Mn(0,r2),tickFormat:I=>c[I],tickSize:0},color:{legend:!0,marginLeft:100,width:400,type:"categorical"},marks:[no(Mn(0,s2+1),{stroke:"#ddd",dx:w/2}),hs(Mn(0,r2),{stroke:"#ddd",strokeWidth:I=>Math.sqrt(I+1)}),po([3,5,7,9,15,17,19,21],{x:I=>I,y:2,dy:w/2,fill:"#ddd",r:8}),po([12,12,24,24],{x:I=>I,y:(I,L)=>L%2===0?1:3,dy:w/2,fill:"#ddd",r:8}),x?m_([x],{x:"fret",y:"string",fill:"black",tip:!0,inset:5,rx:5}):null,m_(M,{x:"fret",y:"string",fill:"step",inset:10,rx:"50%",tip:!0})]});i(1,o.textContent="",o),o.appendChild(S)};tr(v);function A(){a=Dr(this),i(2,a),i(5,f)}function y(){h=Dr(this),i(3,h),i(6,g)}function C(x){In[x?"unshift":"push"](()=>{o=x,i(1,o)})}function E(x){u=x,i(4,u)}return e.$$set=x=>{"demoInfo"in x&&i(0,r=x.demoInfo)},[r,o,a,h,u,f,g,m,v,A,y,C,E]}class Tae extends pi{constructor(t){super(),di(this,t,Sae,xae,fi,{demoInfo:0})}}function Iae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M;function w(R){e[7](R)}let S={callback:e[6]};e[2]!==void 0&&(S.value=e[2]),c=new ad({props:S}),In.push(()=>Yi(c,"value",w));function I(R){e[9](R)}let L={callback:e[6]};return e[3]!==void 0&&(L.notes=e[3]),y=new qs({props:L}),In.push(()=>Yi(y,"notes",I)),x=new Nr({props:{noteOn:e[4],controlChange:e[5]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI guitar and start playing. The fretboard scatterplot below
        shows you where you played, color-coded by time.`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("div"),v=ge(),A=oe("div"),Ut(y.$$.fragment),E=ge(),Ut(x.$$.fragment),fe(h,"class","explanation"),fe(p,"class","control"),fe(m,"class","visualization"),fe(A,"class","control"),fe(t,"class","demo")},m(R,k){Bt(R,t,k),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(t,g),D(t,m),e[8](m),D(t,v),D(t,A),Ft(y,A,null),D(t,E),Ft(x,t,null),M=!0},p(R,[k]){(!M||k&1)&&r!==(r=R[0].title+"")&&jt(o,r);const P={};!f&&k&4&&(f=!0,P.value=R[2],Ki(()=>f=!1)),c.$set(P);const F={};!C&&k&8&&(C=!0,F.notes=R[3],Ki(()=>C=!1)),y.$set(F)},i(R){M||(Nt(c.$$.fragment,R),Nt(y.$$.fragment,R),Nt(x.$$.fragment,R),M=!0)},o(R){Ot(c.$$.fragment,R),Ot(y.$$.fragment,R),Ot(x.$$.fragment,R),M=!1},d(R){R&&It(t),kt(c),e[8](null),kt(y),kt(x)}}}let PI=1e3,Bae=300,DI=6,o2=24;function Rae(e,t,i){let{demoInfo:r}=t;const o=()=>(Math.random()-.5)*.5;let a=[64,59,55,50,45,40];const h=a.map(Ss.fromMidiSharps);let u,p=200,c=0,f=[];const g=E=>{f.length===0&&(c=E.timestamp);const x=(E.timestamp-c)/1e3,M=E.message.channel-1,w=E.note.number-a[M],S={number:E.note.number,velocity:E.rawVelocity,time:x,channel:E.message.channel,string:M,fret:w,stringJitter:M+o(),fretJitter:w+o()};f.push(S),v()},m=E=>{i(2,p=Math.round(Jr(E.rawValue*2,0,200))),v()},v=()=>{const E=f.slice(-p),x=(PI-100)/25,M=Ji({width:PI,height:Bae,marginLeft:60,marginBottom:50,padding:0,x:{domain:[-1,o2+1.5],ticks:Mn(0,o2+1),tickSize:0,label:"fret"},y:{domain:[DI-.5,-.5],tickFormat:w=>h[w],tickSize:0,label:"string"},color:{legend:!0,marginLeft:100,width:400,scheme:"viridis",reverse:!0,domain:[0,p],label:"note index"},r:{domain:[0,127],range:[0,5]},marks:[no(Mn(0,o2+1),{stroke:"#ddd",dx:x/2}),hs(Mn(0,DI),{stroke:"#ddd",strokeWidth:w=>Math.sqrt(w+1)}),po([3,5,7,9,15,17,19,21],{x:w=>w,y:2,dy:x/2,fill:"#ddd",r:8}),po([12,12,24,24],{x:w=>w,y:(w,S)=>S%2===0?1:3,dy:x/2,fill:"#ddd",r:8}),po(E,{x:"fretJitter",y:"stringJitter",fill:(w,S)=>S,r:"velocity",opacity:.5})]});i(1,u.textContent="",u),u.appendChild(M)};tr(v);function A(E){p=E,i(2,p)}function y(E){In[E?"unshift":"push"](()=>{u=E,i(1,u)})}function C(E){f=E,i(3,f)}return e.$$set=E=>{"demoInfo"in E&&i(0,r=E.demoInfo)},[r,u,p,f,g,m,v,A,y,C]}class Lae extends pi{constructor(t){super(),di(this,t,Rae,Iae,fi,{demoInfo:0})}}var fP={exports:{}};(function(e,t){var i={};(function(o,a){e.exports=a()})(self,()=>(()=>{var r={"./node_modules/an-array/index.js":u=>{var p=Object.prototype.toString;u.exports=c;function c(f){return f.BYTES_PER_ELEMENT&&p.call(f.buffer)==="[object ArrayBuffer]"||Array.isArray(f)}},"./node_modules/as-number/index.js":u=>{u.exports=function(c,f){return typeof c=="number"?c:typeof f=="number"?f:0}},"./node_modules/base64-js/index.js":(u,p)=>{p.byteLength=C,p.toByteArray=x,p.fromByteArray=S;for(var c=[],f=[],g=typeof Uint8Array<"u"?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=0,A=m.length;v<A;++v)c[v]=m[v],f[m.charCodeAt(v)]=v;f[45]=62,f[95]=63;function y(I){var L=I.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var R=I.indexOf("=");R===-1&&(R=L);var k=R===L?0:4-R%4;return[R,k]}function C(I){var L=y(I),R=L[0],k=L[1];return(R+k)*3/4-k}function E(I,L,R){return(L+R)*3/4-R}function x(I){var L,R=y(I),k=R[0],P=R[1],F=new g(E(I,k,P)),O=0,W=P>0?k-4:k,V;for(V=0;V<W;V+=4)L=f[I.charCodeAt(V)]<<18|f[I.charCodeAt(V+1)]<<12|f[I.charCodeAt(V+2)]<<6|f[I.charCodeAt(V+3)],F[O++]=L>>16&255,F[O++]=L>>8&255,F[O++]=L&255;return P===2&&(L=f[I.charCodeAt(V)]<<2|f[I.charCodeAt(V+1)]>>4,F[O++]=L&255),P===1&&(L=f[I.charCodeAt(V)]<<10|f[I.charCodeAt(V+1)]<<4|f[I.charCodeAt(V+2)]>>2,F[O++]=L>>8&255,F[O++]=L&255),F}function M(I){return c[I>>18&63]+c[I>>12&63]+c[I>>6&63]+c[I&63]}function w(I,L,R){for(var k,P=[],F=L;F<R;F+=3)k=(I[F]<<16&16711680)+(I[F+1]<<8&65280)+(I[F+2]&255),P.push(M(k));return P.join("")}function S(I){for(var L,R=I.length,k=R%3,P=[],F=16383,O=0,W=R-k;O<W;O+=F)P.push(w(I,O,O+F>W?W:O+F));return k===1?(L=I[R-1],P.push(c[L>>2]+c[L<<4&63]+"==")):k===2&&(L=(I[R-2]<<8)+I[R-1],P.push(c[L>>10]+c[L>>4&63]+c[L<<2&63]+"=")),P.join("")}},"./node_modules/buffer-equal/index.js":(u,p,c)=>{var f=c("./node_modules/buffer/index.js").Buffer;u.exports=function(g,m){if(f.isBuffer(g)&&f.isBuffer(m)){if(typeof g.equals=="function")return g.equals(m);if(g.length!==m.length)return!1;for(var v=0;v<g.length;v++)if(g[v]!==m[v])return!1;return!0}}},"./node_modules/buffer/index.js":(u,p,c)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const f=c("./node_modules/base64-js/index.js"),g=c("./node_modules/ieee754/index.js"),m=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;p.Buffer=C,p.SlowBuffer=F,p.INSPECT_MAX_BYTES=50;const v=2147483647;p.kMaxLength=v,C.TYPED_ARRAY_SUPPORT=A(),!C.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function A(){try{const le=new Uint8Array(1),j={foo:function(){return 42}};return Object.setPrototypeOf(j,Uint8Array.prototype),Object.setPrototypeOf(le,j),le.foo()===42}catch{return!1}}Object.defineProperty(C.prototype,"parent",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.buffer}}),Object.defineProperty(C.prototype,"offset",{enumerable:!0,get:function(){if(C.isBuffer(this))return this.byteOffset}});function y(le){if(le>v)throw new RangeError('The value "'+le+'" is invalid for option "size"');const j=new Uint8Array(le);return Object.setPrototypeOf(j,C.prototype),j}function C(le,j,Z){if(typeof le=="number"){if(typeof j=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(le)}return E(le,j,Z)}C.poolSize=8192;function E(le,j,Z){if(typeof le=="string")return S(le,j);if(ArrayBuffer.isView(le))return L(le);if(le==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof le);if(_e(le,ArrayBuffer)||le&&_e(le.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(_e(le,SharedArrayBuffer)||le&&_e(le.buffer,SharedArrayBuffer)))return R(le,j,Z);if(typeof le=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const pe=le.valueOf&&le.valueOf();if(pe!=null&&pe!==le)return C.from(pe,j,Z);const Ee=k(le);if(Ee)return Ee;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof le[Symbol.toPrimitive]=="function")return C.from(le[Symbol.toPrimitive]("string"),j,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof le)}C.from=function(le,j,Z){return E(le,j,Z)},Object.setPrototypeOf(C.prototype,Uint8Array.prototype),Object.setPrototypeOf(C,Uint8Array);function x(le){if(typeof le!="number")throw new TypeError('"size" argument must be of type number');if(le<0)throw new RangeError('The value "'+le+'" is invalid for option "size"')}function M(le,j,Z){return x(le),le<=0?y(le):j!==void 0?typeof Z=="string"?y(le).fill(j,Z):y(le).fill(j):y(le)}C.alloc=function(le,j,Z){return M(le,j,Z)};function w(le){return x(le),y(le<0?0:P(le)|0)}C.allocUnsafe=function(le){return w(le)},C.allocUnsafeSlow=function(le){return w(le)};function S(le,j){if((typeof j!="string"||j==="")&&(j="utf8"),!C.isEncoding(j))throw new TypeError("Unknown encoding: "+j);const Z=O(le,j)|0;let pe=y(Z);const Ee=pe.write(le,j);return Ee!==Z&&(pe=pe.slice(0,Ee)),pe}function I(le){const j=le.length<0?0:P(le.length)|0,Z=y(j);for(let pe=0;pe<j;pe+=1)Z[pe]=le[pe]&255;return Z}function L(le){if(_e(le,Uint8Array)){const j=new Uint8Array(le);return R(j.buffer,j.byteOffset,j.byteLength)}return I(le)}function R(le,j,Z){if(j<0||le.byteLength<j)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<j+(Z||0))throw new RangeError('"length" is outside of buffer bounds');let pe;return j===void 0&&Z===void 0?pe=new Uint8Array(le):Z===void 0?pe=new Uint8Array(le,j):pe=new Uint8Array(le,j,Z),Object.setPrototypeOf(pe,C.prototype),pe}function k(le){if(C.isBuffer(le)){const j=P(le.length)|0,Z=y(j);return Z.length===0||le.copy(Z,0,0,j),Z}if(le.length!==void 0)return typeof le.length!="number"||Ue(le.length)?y(0):I(le);if(le.type==="Buffer"&&Array.isArray(le.data))return I(le.data)}function P(le){if(le>=v)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+v.toString(16)+" bytes");return le|0}function F(le){return+le!=le&&(le=0),C.alloc(+le)}C.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==C.prototype},C.compare=function(j,Z){if(_e(j,Uint8Array)&&(j=C.from(j,j.offset,j.byteLength)),_e(Z,Uint8Array)&&(Z=C.from(Z,Z.offset,Z.byteLength)),!C.isBuffer(j)||!C.isBuffer(Z))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===Z)return 0;let pe=j.length,Ee=Z.length;for(let Qe=0,He=Math.min(pe,Ee);Qe<He;++Qe)if(j[Qe]!==Z[Qe]){pe=j[Qe],Ee=Z[Qe];break}return pe<Ee?-1:Ee<pe?1:0},C.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},C.concat=function(j,Z){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return C.alloc(0);let pe;if(Z===void 0)for(Z=0,pe=0;pe<j.length;++pe)Z+=j[pe].length;const Ee=C.allocUnsafe(Z);let Qe=0;for(pe=0;pe<j.length;++pe){let He=j[pe];if(_e(He,Uint8Array))Qe+He.length>Ee.length?(C.isBuffer(He)||(He=C.from(He)),He.copy(Ee,Qe)):Uint8Array.prototype.set.call(Ee,He,Qe);else if(C.isBuffer(He))He.copy(Ee,Qe);else throw new TypeError('"list" argument must be an Array of Buffers');Qe+=He.length}return Ee};function O(le,j){if(C.isBuffer(le))return le.length;if(ArrayBuffer.isView(le)||_e(le,ArrayBuffer))return le.byteLength;if(typeof le!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof le);const Z=le.length,pe=arguments.length>2&&arguments[2]===!0;if(!pe&&Z===0)return 0;let Ee=!1;for(;;)switch(j){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return kn(le).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z*2;case"hex":return Z>>>1;case"base64":return bt(le).length;default:if(Ee)return pe?-1:kn(le).length;j=(""+j).toLowerCase(),Ee=!0}}C.byteLength=O;function W(le,j,Z){let pe=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0,j>>>=0,Z<=j))return"";for(le||(le="utf8");;)switch(le){case"hex":return Se(this,j,Z);case"utf8":case"utf-8":return ue(this,j,Z);case"ascii":return de(this,j,Z);case"latin1":case"binary":return Pe(this,j,Z);case"base64":return se(this,j,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Le(this,j,Z);default:if(pe)throw new TypeError("Unknown encoding: "+le);le=(le+"").toLowerCase(),pe=!0}}C.prototype._isBuffer=!0;function V(le,j,Z){const pe=le[j];le[j]=le[Z],le[Z]=pe}C.prototype.swap16=function(){const j=this.length;if(j%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Z=0;Z<j;Z+=2)V(this,Z,Z+1);return this},C.prototype.swap32=function(){const j=this.length;if(j%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Z=0;Z<j;Z+=4)V(this,Z,Z+3),V(this,Z+1,Z+2);return this},C.prototype.swap64=function(){const j=this.length;if(j%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Z=0;Z<j;Z+=8)V(this,Z,Z+7),V(this,Z+1,Z+6),V(this,Z+2,Z+5),V(this,Z+3,Z+4);return this},C.prototype.toString=function(){const j=this.length;return j===0?"":arguments.length===0?ue(this,0,j):W.apply(this,arguments)},C.prototype.toLocaleString=C.prototype.toString,C.prototype.equals=function(j){if(!C.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j?!0:C.compare(this,j)===0},C.prototype.inspect=function(){let j="";const Z=p.INSPECT_MAX_BYTES;return j=this.toString("hex",0,Z).replace(/(.{2})/g,"$1 ").trim(),this.length>Z&&(j+=" ... "),"<Buffer "+j+">"},m&&(C.prototype[m]=C.prototype.inspect),C.prototype.compare=function(j,Z,pe,Ee,Qe){if(_e(j,Uint8Array)&&(j=C.from(j,j.offset,j.byteLength)),!C.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(Z===void 0&&(Z=0),pe===void 0&&(pe=j?j.length:0),Ee===void 0&&(Ee=0),Qe===void 0&&(Qe=this.length),Z<0||pe>j.length||Ee<0||Qe>this.length)throw new RangeError("out of range index");if(Ee>=Qe&&Z>=pe)return 0;if(Ee>=Qe)return-1;if(Z>=pe)return 1;if(Z>>>=0,pe>>>=0,Ee>>>=0,Qe>>>=0,this===j)return 0;let He=Qe-Ee,Pt=pe-Z;const rn=Math.min(He,Pt),Xt=this.slice(Ee,Qe),st=j.slice(Z,pe);for(let An=0;An<rn;++An)if(Xt[An]!==st[An]){He=Xt[An],Pt=st[An];break}return He<Pt?-1:Pt<He?1:0};function $(le,j,Z,pe,Ee){if(le.length===0)return-1;if(typeof Z=="string"?(pe=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),Z=+Z,Ue(Z)&&(Z=Ee?0:le.length-1),Z<0&&(Z=le.length+Z),Z>=le.length){if(Ee)return-1;Z=le.length-1}else if(Z<0)if(Ee)Z=0;else return-1;if(typeof j=="string"&&(j=C.from(j,pe)),C.isBuffer(j))return j.length===0?-1:H(le,j,Z,pe,Ee);if(typeof j=="number")return j=j&255,typeof Uint8Array.prototype.indexOf=="function"?Ee?Uint8Array.prototype.indexOf.call(le,j,Z):Uint8Array.prototype.lastIndexOf.call(le,j,Z):H(le,[j],Z,pe,Ee);throw new TypeError("val must be string, number or Buffer")}function H(le,j,Z,pe,Ee){let Qe=1,He=le.length,Pt=j.length;if(pe!==void 0&&(pe=String(pe).toLowerCase(),pe==="ucs2"||pe==="ucs-2"||pe==="utf16le"||pe==="utf-16le")){if(le.length<2||j.length<2)return-1;Qe=2,He/=2,Pt/=2,Z/=2}function rn(st,An){return Qe===1?st[An]:st.readUInt16BE(An*Qe)}let Xt;if(Ee){let st=-1;for(Xt=Z;Xt<He;Xt++)if(rn(le,Xt)===rn(j,st===-1?0:Xt-st)){if(st===-1&&(st=Xt),Xt-st+1===Pt)return st*Qe}else st!==-1&&(Xt-=Xt-st),st=-1}else for(Z+Pt>He&&(Z=He-Pt),Xt=Z;Xt>=0;Xt--){let st=!0;for(let An=0;An<Pt;An++)if(rn(le,Xt+An)!==rn(j,An)){st=!1;break}if(st)return Xt}return-1}C.prototype.includes=function(j,Z,pe){return this.indexOf(j,Z,pe)!==-1},C.prototype.indexOf=function(j,Z,pe){return $(this,j,Z,pe,!0)},C.prototype.lastIndexOf=function(j,Z,pe){return $(this,j,Z,pe,!1)};function Y(le,j,Z,pe){Z=Number(Z)||0;const Ee=le.length-Z;pe?(pe=Number(pe),pe>Ee&&(pe=Ee)):pe=Ee;const Qe=j.length;pe>Qe/2&&(pe=Qe/2);let He;for(He=0;He<pe;++He){const Pt=parseInt(j.substr(He*2,2),16);if(Ue(Pt))return He;le[Z+He]=Pt}return He}function Q(le,j,Z,pe){return ye(kn(j,le.length-Z),le,Z,pe)}function G(le,j,Z,pe){return ye(qn(j),le,Z,pe)}function J(le,j,Z,pe){return ye(bt(j),le,Z,pe)}function K(le,j,Z,pe){return ye(Gt(j,le.length-Z),le,Z,pe)}C.prototype.write=function(j,Z,pe,Ee){if(Z===void 0)Ee="utf8",pe=this.length,Z=0;else if(pe===void 0&&typeof Z=="string")Ee=Z,pe=this.length,Z=0;else if(isFinite(Z))Z=Z>>>0,isFinite(pe)?(pe=pe>>>0,Ee===void 0&&(Ee="utf8")):(Ee=pe,pe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Qe=this.length-Z;if((pe===void 0||pe>Qe)&&(pe=Qe),j.length>0&&(pe<0||Z<0)||Z>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ee||(Ee="utf8");let He=!1;for(;;)switch(Ee){case"hex":return Y(this,j,Z,pe);case"utf8":case"utf-8":return Q(this,j,Z,pe);case"ascii":case"latin1":case"binary":return G(this,j,Z,pe);case"base64":return J(this,j,Z,pe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,j,Z,pe);default:if(He)throw new TypeError("Unknown encoding: "+Ee);Ee=(""+Ee).toLowerCase(),He=!0}},C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function se(le,j,Z){return j===0&&Z===le.length?f.fromByteArray(le):f.fromByteArray(le.slice(j,Z))}function ue(le,j,Z){Z=Math.min(le.length,Z);const pe=[];let Ee=j;for(;Ee<Z;){const Qe=le[Ee];let He=null,Pt=Qe>239?4:Qe>223?3:Qe>191?2:1;if(Ee+Pt<=Z){let rn,Xt,st,An;switch(Pt){case 1:Qe<128&&(He=Qe);break;case 2:rn=le[Ee+1],(rn&192)===128&&(An=(Qe&31)<<6|rn&63,An>127&&(He=An));break;case 3:rn=le[Ee+1],Xt=le[Ee+2],(rn&192)===128&&(Xt&192)===128&&(An=(Qe&15)<<12|(rn&63)<<6|Xt&63,An>2047&&(An<55296||An>57343)&&(He=An));break;case 4:rn=le[Ee+1],Xt=le[Ee+2],st=le[Ee+3],(rn&192)===128&&(Xt&192)===128&&(st&192)===128&&(An=(Qe&15)<<18|(rn&63)<<12|(Xt&63)<<6|st&63,An>65535&&An<1114112&&(He=An))}}He===null?(He=65533,Pt=1):He>65535&&(He-=65536,pe.push(He>>>10&1023|55296),He=56320|He&1023),pe.push(He),Ee+=Pt}return Me(pe)}const he=4096;function Me(le){const j=le.length;if(j<=he)return String.fromCharCode.apply(String,le);let Z="",pe=0;for(;pe<j;)Z+=String.fromCharCode.apply(String,le.slice(pe,pe+=he));return Z}function de(le,j,Z){let pe="";Z=Math.min(le.length,Z);for(let Ee=j;Ee<Z;++Ee)pe+=String.fromCharCode(le[Ee]&127);return pe}function Pe(le,j,Z){let pe="";Z=Math.min(le.length,Z);for(let Ee=j;Ee<Z;++Ee)pe+=String.fromCharCode(le[Ee]);return pe}function Se(le,j,Z){const pe=le.length;(!j||j<0)&&(j=0),(!Z||Z<0||Z>pe)&&(Z=pe);let Ee="";for(let Qe=j;Qe<Z;++Qe)Ee+=Re[le[Qe]];return Ee}function Le(le,j,Z){const pe=le.slice(j,Z);let Ee="";for(let Qe=0;Qe<pe.length-1;Qe+=2)Ee+=String.fromCharCode(pe[Qe]+pe[Qe+1]*256);return Ee}C.prototype.slice=function(j,Z){const pe=this.length;j=~~j,Z=Z===void 0?pe:~~Z,j<0?(j+=pe,j<0&&(j=0)):j>pe&&(j=pe),Z<0?(Z+=pe,Z<0&&(Z=0)):Z>pe&&(Z=pe),Z<j&&(Z=j);const Ee=this.subarray(j,Z);return Object.setPrototypeOf(Ee,C.prototype),Ee};function be(le,j,Z){if(le%1!==0||le<0)throw new RangeError("offset is not uint");if(le+j>Z)throw new RangeError("Trying to access beyond buffer length")}C.prototype.readUintLE=C.prototype.readUIntLE=function(j,Z,pe){j=j>>>0,Z=Z>>>0,pe||be(j,Z,this.length);let Ee=this[j],Qe=1,He=0;for(;++He<Z&&(Qe*=256);)Ee+=this[j+He]*Qe;return Ee},C.prototype.readUintBE=C.prototype.readUIntBE=function(j,Z,pe){j=j>>>0,Z=Z>>>0,pe||be(j,Z,this.length);let Ee=this[j+--Z],Qe=1;for(;Z>0&&(Qe*=256);)Ee+=this[j+--Z]*Qe;return Ee},C.prototype.readUint8=C.prototype.readUInt8=function(j,Z){return j=j>>>0,Z||be(j,1,this.length),this[j]},C.prototype.readUint16LE=C.prototype.readUInt16LE=function(j,Z){return j=j>>>0,Z||be(j,2,this.length),this[j]|this[j+1]<<8},C.prototype.readUint16BE=C.prototype.readUInt16BE=function(j,Z){return j=j>>>0,Z||be(j,2,this.length),this[j]<<8|this[j+1]},C.prototype.readUint32LE=C.prototype.readUInt32LE=function(j,Z){return j=j>>>0,Z||be(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+this[j+3]*16777216},C.prototype.readUint32BE=C.prototype.readUInt32BE=function(j,Z){return j=j>>>0,Z||be(j,4,this.length),this[j]*16777216+(this[j+1]<<16|this[j+2]<<8|this[j+3])},C.prototype.readBigUInt64LE=Ce(function(j){j=j>>>0,Tt(j,"offset");const Z=this[j],pe=this[j+7];(Z===void 0||pe===void 0)&&At(j,this.length-8);const Ee=Z+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24,Qe=this[++j]+this[++j]*2**8+this[++j]*2**16+pe*2**24;return BigInt(Ee)+(BigInt(Qe)<<BigInt(32))}),C.prototype.readBigUInt64BE=Ce(function(j){j=j>>>0,Tt(j,"offset");const Z=this[j],pe=this[j+7];(Z===void 0||pe===void 0)&&At(j,this.length-8);const Ee=Z*2**24+this[++j]*2**16+this[++j]*2**8+this[++j],Qe=this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+pe;return(BigInt(Ee)<<BigInt(32))+BigInt(Qe)}),C.prototype.readIntLE=function(j,Z,pe){j=j>>>0,Z=Z>>>0,pe||be(j,Z,this.length);let Ee=this[j],Qe=1,He=0;for(;++He<Z&&(Qe*=256);)Ee+=this[j+He]*Qe;return Qe*=128,Ee>=Qe&&(Ee-=Math.pow(2,8*Z)),Ee},C.prototype.readIntBE=function(j,Z,pe){j=j>>>0,Z=Z>>>0,pe||be(j,Z,this.length);let Ee=Z,Qe=1,He=this[j+--Ee];for(;Ee>0&&(Qe*=256);)He+=this[j+--Ee]*Qe;return Qe*=128,He>=Qe&&(He-=Math.pow(2,8*Z)),He},C.prototype.readInt8=function(j,Z){return j=j>>>0,Z||be(j,1,this.length),this[j]&128?(255-this[j]+1)*-1:this[j]},C.prototype.readInt16LE=function(j,Z){j=j>>>0,Z||be(j,2,this.length);const pe=this[j]|this[j+1]<<8;return pe&32768?pe|4294901760:pe},C.prototype.readInt16BE=function(j,Z){j=j>>>0,Z||be(j,2,this.length);const pe=this[j+1]|this[j]<<8;return pe&32768?pe|4294901760:pe},C.prototype.readInt32LE=function(j,Z){return j=j>>>0,Z||be(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},C.prototype.readInt32BE=function(j,Z){return j=j>>>0,Z||be(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},C.prototype.readBigInt64LE=Ce(function(j){j=j>>>0,Tt(j,"offset");const Z=this[j],pe=this[j+7];(Z===void 0||pe===void 0)&&At(j,this.length-8);const Ee=this[j+4]+this[j+5]*2**8+this[j+6]*2**16+(pe<<24);return(BigInt(Ee)<<BigInt(32))+BigInt(Z+this[++j]*256+this[++j]*65536+this[++j]*16777216)}),C.prototype.readBigInt64BE=Ce(function(j){j=j>>>0,Tt(j,"offset");const Z=this[j],pe=this[j+7];(Z===void 0||pe===void 0)&&At(j,this.length-8);const Ee=(Z<<24)+this[++j]*2**16+this[++j]*2**8+this[++j];return(BigInt(Ee)<<BigInt(32))+BigInt(this[++j]*16777216+this[++j]*65536+this[++j]*256+pe)}),C.prototype.readFloatLE=function(j,Z){return j=j>>>0,Z||be(j,4,this.length),g.read(this,j,!0,23,4)},C.prototype.readFloatBE=function(j,Z){return j=j>>>0,Z||be(j,4,this.length),g.read(this,j,!1,23,4)},C.prototype.readDoubleLE=function(j,Z){return j=j>>>0,Z||be(j,8,this.length),g.read(this,j,!0,52,8)},C.prototype.readDoubleBE=function(j,Z){return j=j>>>0,Z||be(j,8,this.length),g.read(this,j,!1,52,8)};function je(le,j,Z,pe,Ee,Qe){if(!C.isBuffer(le))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>Ee||j<Qe)throw new RangeError('"value" argument is out of bounds');if(Z+pe>le.length)throw new RangeError("Index out of range")}C.prototype.writeUintLE=C.prototype.writeUIntLE=function(j,Z,pe,Ee){if(j=+j,Z=Z>>>0,pe=pe>>>0,!Ee){const Pt=Math.pow(2,8*pe)-1;je(this,j,Z,pe,Pt,0)}let Qe=1,He=0;for(this[Z]=j&255;++He<pe&&(Qe*=256);)this[Z+He]=j/Qe&255;return Z+pe},C.prototype.writeUintBE=C.prototype.writeUIntBE=function(j,Z,pe,Ee){if(j=+j,Z=Z>>>0,pe=pe>>>0,!Ee){const Pt=Math.pow(2,8*pe)-1;je(this,j,Z,pe,Pt,0)}let Qe=pe-1,He=1;for(this[Z+Qe]=j&255;--Qe>=0&&(He*=256);)this[Z+Qe]=j/He&255;return Z+pe},C.prototype.writeUint8=C.prototype.writeUInt8=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,1,255,0),this[Z]=j&255,Z+1},C.prototype.writeUint16LE=C.prototype.writeUInt16LE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,2,65535,0),this[Z]=j&255,this[Z+1]=j>>>8,Z+2},C.prototype.writeUint16BE=C.prototype.writeUInt16BE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,2,65535,0),this[Z]=j>>>8,this[Z+1]=j&255,Z+2},C.prototype.writeUint32LE=C.prototype.writeUInt32LE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,4,4294967295,0),this[Z+3]=j>>>24,this[Z+2]=j>>>16,this[Z+1]=j>>>8,this[Z]=j&255,Z+4},C.prototype.writeUint32BE=C.prototype.writeUInt32BE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,4,4294967295,0),this[Z]=j>>>24,this[Z+1]=j>>>16,this[Z+2]=j>>>8,this[Z+3]=j&255,Z+4};function Te(le,j,Z,pe,Ee){Ct(j,pe,Ee,le,Z,7);let Qe=Number(j&BigInt(4294967295));le[Z++]=Qe,Qe=Qe>>8,le[Z++]=Qe,Qe=Qe>>8,le[Z++]=Qe,Qe=Qe>>8,le[Z++]=Qe;let He=Number(j>>BigInt(32)&BigInt(4294967295));return le[Z++]=He,He=He>>8,le[Z++]=He,He=He>>8,le[Z++]=He,He=He>>8,le[Z++]=He,Z}function rt(le,j,Z,pe,Ee){Ct(j,pe,Ee,le,Z,7);let Qe=Number(j&BigInt(4294967295));le[Z+7]=Qe,Qe=Qe>>8,le[Z+6]=Qe,Qe=Qe>>8,le[Z+5]=Qe,Qe=Qe>>8,le[Z+4]=Qe;let He=Number(j>>BigInt(32)&BigInt(4294967295));return le[Z+3]=He,He=He>>8,le[Z+2]=He,He=He>>8,le[Z+1]=He,He=He>>8,le[Z]=He,Z+8}C.prototype.writeBigUInt64LE=Ce(function(j,Z=0){return Te(this,j,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),C.prototype.writeBigUInt64BE=Ce(function(j,Z=0){return rt(this,j,Z,BigInt(0),BigInt("0xffffffffffffffff"))}),C.prototype.writeIntLE=function(j,Z,pe,Ee){if(j=+j,Z=Z>>>0,!Ee){const rn=Math.pow(2,8*pe-1);je(this,j,Z,pe,rn-1,-rn)}let Qe=0,He=1,Pt=0;for(this[Z]=j&255;++Qe<pe&&(He*=256);)j<0&&Pt===0&&this[Z+Qe-1]!==0&&(Pt=1),this[Z+Qe]=(j/He>>0)-Pt&255;return Z+pe},C.prototype.writeIntBE=function(j,Z,pe,Ee){if(j=+j,Z=Z>>>0,!Ee){const rn=Math.pow(2,8*pe-1);je(this,j,Z,pe,rn-1,-rn)}let Qe=pe-1,He=1,Pt=0;for(this[Z+Qe]=j&255;--Qe>=0&&(He*=256);)j<0&&Pt===0&&this[Z+Qe+1]!==0&&(Pt=1),this[Z+Qe]=(j/He>>0)-Pt&255;return Z+pe},C.prototype.writeInt8=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,1,127,-128),j<0&&(j=255+j+1),this[Z]=j&255,Z+1},C.prototype.writeInt16LE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,2,32767,-32768),this[Z]=j&255,this[Z+1]=j>>>8,Z+2},C.prototype.writeInt16BE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,2,32767,-32768),this[Z]=j>>>8,this[Z+1]=j&255,Z+2},C.prototype.writeInt32LE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,4,2147483647,-2147483648),this[Z]=j&255,this[Z+1]=j>>>8,this[Z+2]=j>>>16,this[Z+3]=j>>>24,Z+4},C.prototype.writeInt32BE=function(j,Z,pe){return j=+j,Z=Z>>>0,pe||je(this,j,Z,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[Z]=j>>>24,this[Z+1]=j>>>16,this[Z+2]=j>>>8,this[Z+3]=j&255,Z+4},C.prototype.writeBigInt64LE=Ce(function(j,Z=0){return Te(this,j,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),C.prototype.writeBigInt64BE=Ce(function(j,Z=0){return rt(this,j,Z,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function mt(le,j,Z,pe,Ee,Qe){if(Z+pe>le.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function vt(le,j,Z,pe,Ee){return j=+j,Z=Z>>>0,Ee||mt(le,j,Z,4),g.write(le,j,Z,pe,23,4),Z+4}C.prototype.writeFloatLE=function(j,Z,pe){return vt(this,j,Z,!0,pe)},C.prototype.writeFloatBE=function(j,Z,pe){return vt(this,j,Z,!1,pe)};function ft(le,j,Z,pe,Ee){return j=+j,Z=Z>>>0,Ee||mt(le,j,Z,8),g.write(le,j,Z,pe,52,8),Z+8}C.prototype.writeDoubleLE=function(j,Z,pe){return ft(this,j,Z,!0,pe)},C.prototype.writeDoubleBE=function(j,Z,pe){return ft(this,j,Z,!1,pe)},C.prototype.copy=function(j,Z,pe,Ee){if(!C.isBuffer(j))throw new TypeError("argument should be a Buffer");if(pe||(pe=0),!Ee&&Ee!==0&&(Ee=this.length),Z>=j.length&&(Z=j.length),Z||(Z=0),Ee>0&&Ee<pe&&(Ee=pe),Ee===pe||j.length===0||this.length===0)return 0;if(Z<0)throw new RangeError("targetStart out of bounds");if(pe<0||pe>=this.length)throw new RangeError("Index out of range");if(Ee<0)throw new RangeError("sourceEnd out of bounds");Ee>this.length&&(Ee=this.length),j.length-Z<Ee-pe&&(Ee=j.length-Z+pe);const Qe=Ee-pe;return this===j&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Z,pe,Ee):Uint8Array.prototype.set.call(j,this.subarray(pe,Ee),Z),Qe},C.prototype.fill=function(j,Z,pe,Ee){if(typeof j=="string"){if(typeof Z=="string"?(Ee=Z,Z=0,pe=this.length):typeof pe=="string"&&(Ee=pe,pe=this.length),Ee!==void 0&&typeof Ee!="string")throw new TypeError("encoding must be a string");if(typeof Ee=="string"&&!C.isEncoding(Ee))throw new TypeError("Unknown encoding: "+Ee);if(j.length===1){const He=j.charCodeAt(0);(Ee==="utf8"&&He<128||Ee==="latin1")&&(j=He)}}else typeof j=="number"?j=j&255:typeof j=="boolean"&&(j=Number(j));if(Z<0||this.length<Z||this.length<pe)throw new RangeError("Out of range index");if(pe<=Z)return this;Z=Z>>>0,pe=pe===void 0?this.length:pe>>>0,j||(j=0);let Qe;if(typeof j=="number")for(Qe=Z;Qe<pe;++Qe)this[Qe]=j;else{const He=C.isBuffer(j)?j:C.from(j,Ee),Pt=He.length;if(Pt===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(Qe=0;Qe<pe-Z;++Qe)this[Qe+Z]=He[Qe%Pt]}return this};const Ze={};function St(le,j,Z){Ze[le]=class extends Z{constructor(){super(),Object.defineProperty(this,"message",{value:j.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${le}]`,this.stack,delete this.name}get code(){return le}set code(Ee){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ee,writable:!0})}toString(){return`${this.name} [${le}]: ${this.message}`}}}St("ERR_BUFFER_OUT_OF_BOUNDS",function(le){return le?`${le} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),St("ERR_INVALID_ARG_TYPE",function(le,j){return`The "${le}" argument must be of type number. Received type ${typeof j}`},TypeError),St("ERR_OUT_OF_RANGE",function(le,j,Z){let pe=`The value of "${le}" is out of range.`,Ee=Z;return Number.isInteger(Z)&&Math.abs(Z)>4294967296?Ee=$t(String(Z)):typeof Z=="bigint"&&(Ee=String(Z),(Z>BigInt(2)**BigInt(32)||Z<-(BigInt(2)**BigInt(32)))&&(Ee=$t(Ee)),Ee+="n"),pe+=` It must be ${j}. Received ${Ee}`,pe},RangeError);function $t(le){let j="",Z=le.length;const pe=le[0]==="-"?1:0;for(;Z>=pe+4;Z-=3)j=`_${le.slice(Z-3,Z)}${j}`;return`${le.slice(0,Z)}${j}`}function ct(le,j,Z){Tt(j,"offset"),(le[j]===void 0||le[j+Z]===void 0)&&At(j,le.length-(Z+1))}function Ct(le,j,Z,pe,Ee,Qe){if(le>Z||le<j){const He=typeof j=="bigint"?"n":"";let Pt;throw j===0||j===BigInt(0)?Pt=`>= 0${He} and < 2${He} ** ${(Qe+1)*8}${He}`:Pt=`>= -(2${He} ** ${(Qe+1)*8-1}${He}) and < 2 ** ${(Qe+1)*8-1}${He}`,new Ze.ERR_OUT_OF_RANGE("value",Pt,le)}ct(pe,Ee,Qe)}function Tt(le,j){if(typeof le!="number")throw new Ze.ERR_INVALID_ARG_TYPE(j,"number",le)}function At(le,j,Z){throw Math.floor(le)!==le?(Tt(le,Z),new Ze.ERR_OUT_OF_RANGE("offset","an integer",le)):j<0?new Ze.ERR_BUFFER_OUT_OF_BOUNDS:new Ze.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${j}`,le)}const pn=/[^+/0-9A-Za-z-_]/g;function yt(le){if(le=le.split("=")[0],le=le.trim().replace(pn,""),le.length<2)return"";for(;le.length%4!==0;)le=le+"=";return le}function kn(le,j){j=j||1/0;let Z;const pe=le.length;let Ee=null;const Qe=[];for(let He=0;He<pe;++He){if(Z=le.charCodeAt(He),Z>55295&&Z<57344){if(!Ee){if(Z>56319){(j-=3)>-1&&Qe.push(239,191,189);continue}else if(He+1===pe){(j-=3)>-1&&Qe.push(239,191,189);continue}Ee=Z;continue}if(Z<56320){(j-=3)>-1&&Qe.push(239,191,189),Ee=Z;continue}Z=(Ee-55296<<10|Z-56320)+65536}else Ee&&(j-=3)>-1&&Qe.push(239,191,189);if(Ee=null,Z<128){if((j-=1)<0)break;Qe.push(Z)}else if(Z<2048){if((j-=2)<0)break;Qe.push(Z>>6|192,Z&63|128)}else if(Z<65536){if((j-=3)<0)break;Qe.push(Z>>12|224,Z>>6&63|128,Z&63|128)}else if(Z<1114112){if((j-=4)<0)break;Qe.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,Z&63|128)}else throw new Error("Invalid code point")}return Qe}function qn(le){const j=[];for(let Z=0;Z<le.length;++Z)j.push(le.charCodeAt(Z)&255);return j}function Gt(le,j){let Z,pe,Ee;const Qe=[];for(let He=0;He<le.length&&!((j-=2)<0);++He)Z=le.charCodeAt(He),pe=Z>>8,Ee=Z%256,Qe.push(Ee),Qe.push(pe);return Qe}function bt(le){return f.toByteArray(yt(le))}function ye(le,j,Z,pe){let Ee;for(Ee=0;Ee<pe&&!(Ee+Z>=j.length||Ee>=le.length);++Ee)j[Ee+Z]=le[Ee];return Ee}function _e(le,j){return le instanceof j||le!=null&&le.constructor!=null&&le.constructor.name!=null&&le.constructor.name===j.name}function Ue(le){return le!==le}const Re=function(){const le="0123456789abcdef",j=new Array(256);for(let Z=0;Z<16;++Z){const pe=Z*16;for(let Ee=0;Ee<16;++Ee)j[pe+Ee]=le[Z]+le[Ee]}return j}();function Ce(le){return typeof BigInt>"u"?Ne:le}function Ne(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":u=>{u.exports=function(p){var c=[];return c.toString=function(){return this.map(function(g){var m="",v=typeof g[5]<"u";return g[4]&&(m+="@supports (".concat(g[4],") {")),g[2]&&(m+="@media ".concat(g[2]," {")),v&&(m+="@layer".concat(g[5].length>0?" ".concat(g[5]):""," {")),m+=p(g),v&&(m+="}"),g[2]&&(m+="}"),g[4]&&(m+="}"),m}).join("")},c.i=function(g,m,v,A,y){typeof g=="string"&&(g=[[null,g,void 0]]);var C={};if(v)for(var E=0;E<this.length;E++){var x=this[E][0];x!=null&&(C[x]=!0)}for(var M=0;M<g.length;M++){var w=[].concat(g[M]);v&&C[w[0]]||(typeof y<"u"&&(typeof w[5]>"u"||(w[1]="@layer".concat(w[5].length>0?" ".concat(w[5]):""," {").concat(w[1],"}")),w[5]=y),m&&(w[2]&&(w[1]="@media ".concat(w[2]," {").concat(w[1],"}")),w[2]=m),A&&(w[4]?(w[1]="@supports (".concat(w[4],") {").concat(w[1],"}"),w[4]=A):w[4]="".concat(A)),c.push(w))}},c}},"./node_modules/css-loader/dist/runtime/getUrl.js":u=>{u.exports=function(p,c){return c||(c={}),p&&(p=String(p.__esModule?p.default:p),/^['"].*['"]$/.test(p)&&(p=p.slice(1,-1)),c.hash&&(p+=c.hash),/["'() \t\n]|(%20)/.test(p)||c.needQuotes?'"'.concat(p.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):p)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":u=>{u.exports=function(p){var c=p[1],f=p[3];if(!f)return c;if(typeof btoa=="function"){var g=btoa(unescape(encodeURIComponent(JSON.stringify(f)))),m="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(g),v="/*# ".concat(m," */");return[c].concat([v]).join(`
`)}return[c].join(`
`)}},"./node_modules/debug/src/browser.js":(u,p,c)=>{p.formatArgs=g,p.save=m,p.load=v,p.useColors=f,p.storage=A(),p.destroy=(()=>{let C=!1;return()=>{C||(C=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),p.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function f(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function g(C){if(C[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+C[0]+(this.useColors?"%c ":" ")+"+"+u.exports.humanize(this.diff),!this.useColors)return;const E="color: "+this.color;C.splice(1,0,E,"color: inherit");let x=0,M=0;C[0].replace(/%[a-zA-Z%]/g,w=>{w!=="%%"&&(x++,w==="%c"&&(M=x))}),C.splice(M,0,E)}p.log=console.debug||console.log||(()=>{});function m(C){try{C?p.storage.setItem("debug",C):p.storage.removeItem("debug")}catch{}}function v(){let C;try{C=p.storage.getItem("debug")}catch{}return!C&&typeof process<"u"&&"env"in process&&(C=i.DEBUG),C}function A(){try{return localStorage}catch{}}u.exports=c("./node_modules/debug/src/common.js")(p);const{formatters:y}=u.exports;y.j=function(C){try{return JSON.stringify(C)}catch(E){return"[UnexpectedJSONParseError]: "+E.message}}},"./node_modules/debug/src/common.js":(u,p,c)=>{function f(g){v.debug=v,v.default=v,v.coerce=M,v.disable=C,v.enable=y,v.enabled=E,v.humanize=c("./node_modules/ms/index.js"),v.destroy=w,Object.keys(g).forEach(S=>{v[S]=g[S]}),v.names=[],v.skips=[],v.formatters={};function m(S){let I=0;for(let L=0;L<S.length;L++)I=(I<<5)-I+S.charCodeAt(L),I|=0;return v.colors[Math.abs(I)%v.colors.length]}v.selectColor=m;function v(S){let I,L=null,R,k;function P(...F){if(!P.enabled)return;const O=P,W=Number(new Date),V=W-(I||W);O.diff=V,O.prev=I,O.curr=W,I=W,F[0]=v.coerce(F[0]),typeof F[0]!="string"&&F.unshift("%O");let $=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,(Y,Q)=>{if(Y==="%%")return"%";$++;const G=v.formatters[Q];if(typeof G=="function"){const J=F[$];Y=G.call(O,J),F.splice($,1),$--}return Y}),v.formatArgs.call(O,F),(O.log||v.log).apply(O,F)}return P.namespace=S,P.useColors=v.useColors(),P.color=v.selectColor(S),P.extend=A,P.destroy=v.destroy,Object.defineProperty(P,"enabled",{enumerable:!0,configurable:!1,get:()=>L!==null?L:(R!==v.namespaces&&(R=v.namespaces,k=v.enabled(S)),k),set:F=>{L=F}}),typeof v.init=="function"&&v.init(P),P}function A(S,I){const L=v(this.namespace+(typeof I>"u"?":":I)+S);return L.log=this.log,L}function y(S){v.save(S),v.namespaces=S,v.names=[],v.skips=[];let I;const L=(typeof S=="string"?S:"").split(/[\s,]+/),R=L.length;for(I=0;I<R;I++)L[I]&&(S=L[I].replace(/\*/g,".*?"),S[0]==="-"?v.skips.push(new RegExp("^"+S.slice(1)+"$")):v.names.push(new RegExp("^"+S+"$")))}function C(){const S=[...v.names.map(x),...v.skips.map(x).map(I=>"-"+I)].join(",");return v.enable(""),S}function E(S){if(S[S.length-1]==="*")return!0;let I,L;for(I=0,L=v.skips.length;I<L;I++)if(v.skips[I].test(S))return!1;for(I=0,L=v.names.length;I<L;I++)if(v.names[I].test(S))return!0;return!1}function x(S){return S.toString().substring(2,S.toString().length-2).replace(/\.\*\?$/,"*")}function M(S){return S instanceof Error?S.stack||S.message:S}function w(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return v.enable(v.load()),v}u.exports=f},"./node_modules/deep-assign/index.js":(u,p,c)=>{var f=c("./node_modules/is-obj/index.js"),g=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;function v(C){if(C==null)throw new TypeError("Sources cannot be null or undefined");return Object(C)}function A(C,E,x){var M=E[x];if(M!=null){if(g.call(C,x)&&(C[x]===void 0||C[x]===null))throw new TypeError("Cannot convert undefined or null to object ("+x+")");!g.call(C,x)||!f(M)?C[x]=M:C[x]=y(Object(C[x]),E[x])}}function y(C,E){if(C===E)return C;E=Object(E);for(var x in E)g.call(E,x)&&A(C,E,x);if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(E),w=0;w<M.length;w++)m.call(E,M[w])&&A(C,E,M[w]);return C}u.exports=function(E){E=v(E);for(var x=1;x<arguments.length;x++)y(E,arguments[x]);return E}},"./node_modules/dtype/index.js":u=>{u.exports=function(p){switch(p){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(u,p,c)=>{var f;typeof window<"u"?f=window:typeof c.g<"u"?f=c.g:typeof self<"u"?f=self:f={},u.exports=f},"./node_modules/ieee754/index.js":(u,p)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */p.read=function(c,f,g,m,v){var A,y,C=v*8-m-1,E=(1<<C)-1,x=E>>1,M=-7,w=g?v-1:0,S=g?-1:1,I=c[f+w];for(w+=S,A=I&(1<<-M)-1,I>>=-M,M+=C;M>0;A=A*256+c[f+w],w+=S,M-=8);for(y=A&(1<<-M)-1,A>>=-M,M+=m;M>0;y=y*256+c[f+w],w+=S,M-=8);if(A===0)A=1-x;else{if(A===E)return y?NaN:(I?-1:1)*(1/0);y=y+Math.pow(2,m),A=A-x}return(I?-1:1)*y*Math.pow(2,A-m)},p.write=function(c,f,g,m,v,A){var y,C,E,x=A*8-v-1,M=(1<<x)-1,w=M>>1,S=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=m?0:A-1,L=m?1:-1,R=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(C=isNaN(f)?1:0,y=M):(y=Math.floor(Math.log(f)/Math.LN2),f*(E=Math.pow(2,-y))<1&&(y--,E*=2),y+w>=1?f+=S/E:f+=S*Math.pow(2,1-w),f*E>=2&&(y++,E/=2),y+w>=M?(C=0,y=M):y+w>=1?(C=(f*E-1)*Math.pow(2,v),y=y+w):(C=f*Math.pow(2,w-1)*Math.pow(2,v),y=0));v>=8;c[g+I]=C&255,I+=L,C/=256,v-=8);for(y=y<<v|C,x+=v;x>0;c[g+I]=y&255,I+=L,y/=256,x-=8);c[g+I-L]|=R*128}},"./node_modules/is-buffer/index.js":u=>{/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */u.exports=function(f){return f!=null&&(p(f)||c(f)||!!f._isBuffer)};function p(f){return!!f.constructor&&typeof f.constructor.isBuffer=="function"&&f.constructor.isBuffer(f)}function c(f){return typeof f.readFloatLE=="function"&&typeof f.slice=="function"&&p(f.slice(0,0))}},"./node_modules/is-function/index.js":u=>{u.exports=c;var p=Object.prototype.toString;function c(f){if(!f)return!1;var g=p.call(f);return g==="[object Function]"||typeof f=="function"&&g!=="[object RegExp]"||typeof window<"u"&&(f===window.setTimeout||f===window.alert||f===window.confirm||f===window.prompt)}},"./node_modules/is-obj/index.js":u=>{u.exports=function(p){var c=typeof p;return p!==null&&(c==="object"||c==="function")}},"./node_modules/layout-bmfont-text/index.js":(u,p,c)=>{var f=c("./node_modules/word-wrapper/index.js"),g=c("./node_modules/xtend/immutable.js"),m=c("./node_modules/as-number/index.js"),v=["x","e","a","o","n","s","r","c","u","m","v","w","z"],A=["m","w"],y=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],C=9,E=32,x=0,M=1,w=2;u.exports=function(H){return new S(H)};function S($){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update($)}S.prototype.update=function($){if($=g({measure:this._measure},$),this._opt=$,this._opt.tabSize=m(this._opt.tabSize,4),!$.font)throw new Error("must provide a valid bitmap font");var H=this.glyphs,Y=$.text||"",Q=$.font;this._setupSpaceGlyphs(Q);var G=f.lines(Y,$),J=$.width||0;H.length=0;var K=G.reduce(function(je,Te){return Math.max(je,Te.width,J)},0),se=0,ue=0,he=m($.lineHeight,Q.common.lineHeight),Me=Q.common.base,de=he-Me,Pe=$.letterSpacing||0,Se=he*G.length-de,Le=W(this._opt.align);ue-=Se,this._width=K,this._height=Se,this._descender=he-Me,this._baseline=Me,this._xHeight=k(Q),this._capHeight=F(Q),this._lineHeight=he,this._ascender=he-de-this._xHeight;var be=this;G.forEach(function(je,Te){for(var rt=je.start,mt=je.end,vt=je.width,ft,Ze=rt;Ze<mt;Ze++){var St=Y.charCodeAt(Ze),$t=be.getGlyph(Q,St);if($t){ft&&(se+=O(Q,ft.id,$t.id));var ct=se;Le===M?ct+=(K-vt)/2:Le===w&&(ct+=K-vt),H.push({position:[ct,ue],data:$t,index:Ze,line:Te}),se+=$t.xadvance+Pe,ft=$t}}ue+=he,se=0}),this._linesTotal=G.length},S.prototype._setupSpaceGlyphs=function($){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!$.chars||$.chars.length===0)){var H=R($,E)||P($)||$.chars[0],Y=this._opt.tabSize*H.xadvance;this._fallbackSpaceGlyph=H,this._fallbackTabGlyph=g(H,{x:0,y:0,xadvance:Y,id:C,xoffset:0,yoffset:0,width:0,height:0})}},S.prototype.getGlyph=function($,H){var Y=R($,H);return Y||(H===C?this._fallbackTabGlyph:H===E?this._fallbackSpaceGlyph:null)},S.prototype.computeMetrics=function($,H,Y,Q){var G=this._opt.letterSpacing||0,J=this._opt.font,K=0,se=0,ue=0,he,Me;if(!J.chars||J.chars.length===0)return{start:H,end:H,width:0};Y=Math.min($.length,Y);for(var de=H;de<Y;de++){var Pe=$.charCodeAt(de),he=this.getGlyph(J,Pe);if(he){he.xoffset;var Se=Me?O(J,Me.id,he.id):0;K+=Se;var Le=K+he.xadvance+G,be=K+he.width;if(be>=Q||Le>=Q)break;K=Le,se=be,Me=he}ue++}return Me&&(se+=Me.xoffset),{start:H,end:H+ue,width:se}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(I);function I($){Object.defineProperty(S.prototype,$,{get:L($),configurable:!0})}function L($){return new Function(["return function "+$+"() {","  return this._"+$,"}"].join(`
`))()}function R($,H){if(!$.chars||$.chars.length===0)return null;var Y=V($.chars,H);return Y>=0?$.chars[Y]:null}function k($){for(var H=0;H<v.length;H++){var Y=v[H].charCodeAt(0),Q=V($.chars,Y);if(Q>=0)return $.chars[Q].height}return 0}function P($){for(var H=0;H<A.length;H++){var Y=A[H].charCodeAt(0),Q=V($.chars,Y);if(Q>=0)return $.chars[Q]}return 0}function F($){for(var H=0;H<y.length;H++){var Y=y[H].charCodeAt(0),Q=V($.chars,Y);if(Q>=0)return $.chars[Q].height}return 0}function O($,H,Y){if(!$.kernings||$.kernings.length===0)return 0;for(var Q=$.kernings,G=0;G<Q.length;G++){var J=Q[G];if(J.first===H&&J.second===Y)return J.amount}return 0}function W($){return $==="center"?M:$==="right"?w:x}function V($,H,Y){Y=Y||0;for(var Q=Y;Q<$.length;Q++)if($[Q].id===H)return Q;return-1}},"./node_modules/load-bmfont/browser.js":(u,p,c)=>{var f=c("./node_modules/buffer/index.js").Buffer,g=c("./node_modules/xhr/index.js"),m=function(){},v=c("./node_modules/parse-bmfont-ascii/index.js"),A=c("./node_modules/parse-bmfont-xml/lib/browser.js"),y=c("./node_modules/parse-bmfont-binary/index.js"),C=c("./node_modules/load-bmfont/lib/is-binary.js"),E=c("./node_modules/xtend/immutable.js"),x=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();u.exports=function(S,I){I=typeof I=="function"?I:m,typeof S=="string"?S={uri:S}:S||(S={});var L=S.binary;L&&(S=w(S)),g(S,function(R,k,P){if(R)return I(R);if(!/^2/.test(k.statusCode))return I(new Error("http status code: "+k.statusCode));if(!P)return I(new Error("no body result"));var F=!1;if(M(P)){var O=new Uint8Array(P);P=f.from(O,"binary")}C(P)&&(F=!0,typeof P=="string"&&(P=f.from(P,"binary"))),F||(f.isBuffer(P)&&(P=P.toString(S.encoding)),P=P.trim());var W;try{var V=k.headers["content-type"];F?W=y(P):/json/.test(V)||P.charAt(0)==="{"?W=JSON.parse(P):/xml/.test(V)||P.charAt(0)==="<"?W=A(P):W=v(P)}catch($){I(new Error("error parsing font "+$.message)),I=m}I(null,W)})};function M(S){var I=Object.prototype.toString;return I.call(S)==="[object ArrayBuffer]"}function w(S){if(x)return E(S,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var I=new self.XMLHttpRequest;return I.overrideMimeType("text/plain; charset=x-user-defined"),E({xhr:I},S)}},"./node_modules/load-bmfont/lib/is-binary.js":(u,p,c)=>{var f=c("./node_modules/buffer/index.js").Buffer,g=c("./node_modules/buffer-equal/index.js"),m=f.from([66,77,70,3]);u.exports=function(v){return typeof v=="string"?v.substring(0,3)==="BMF":v.length>4&&g(v.slice(0,4),m)}},"./node_modules/ms/index.js":u=>{var p=1e3,c=p*60,f=c*60,g=f*24,m=g*7,v=g*365.25;u.exports=function(x,M){M=M||{};var w=typeof x;if(w==="string"&&x.length>0)return A(x);if(w==="number"&&isFinite(x))return M.long?C(x):y(x);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(x))};function A(x){if(x=String(x),!(x.length>100)){var M=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(x);if(M){var w=parseFloat(M[1]),S=(M[2]||"ms").toLowerCase();switch(S){case"years":case"year":case"yrs":case"yr":case"y":return w*v;case"weeks":case"week":case"w":return w*m;case"days":case"day":case"d":return w*g;case"hours":case"hour":case"hrs":case"hr":case"h":return w*f;case"minutes":case"minute":case"mins":case"min":case"m":return w*c;case"seconds":case"second":case"secs":case"sec":case"s":return w*p;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}function y(x){var M=Math.abs(x);return M>=g?Math.round(x/g)+"d":M>=f?Math.round(x/f)+"h":M>=c?Math.round(x/c)+"m":M>=p?Math.round(x/p)+"s":x+"ms"}function C(x){var M=Math.abs(x);return M>=g?E(x,M,g,"day"):M>=f?E(x,M,f,"hour"):M>=c?E(x,M,c,"minute"):M>=p?E(x,M,p,"second"):x+" ms"}function E(x,M,w,S){var I=M>=w*1.5;return Math.round(x/w)+" "+S+(I?"s":"")}},"./node_modules/parse-bmfont-ascii/index.js":u=>{u.exports=function(m){if(!m)throw new Error("no data provided");m=m.toString().trim();var v={pages:[],chars:[],kernings:[]},A=m.split(/\r\n?|\n/g);if(A.length===0)throw new Error("no data in BMFont file");for(var y=0;y<A.length;y++){var C=p(A[y],y);if(C)if(C.key==="page"){if(typeof C.data.id!="number")throw new Error("malformed file at line "+y+" -- needs page id=N");if(typeof C.data.file!="string")throw new Error("malformed file at line "+y+' -- needs page file="path"');v.pages[C.data.id]=C.data.file}else C.key==="chars"||C.key==="kernings"||(C.key==="char"?v.chars.push(C.data):C.key==="kerning"?v.kernings.push(C.data):v[C.key]=C.data)}return v};function p(g,m){if(g=g.replace(/\t+/g," ").trim(),!g)return null;var v=g.indexOf(" ");if(v===-1)throw new Error("no named row at line "+m);var A=g.substring(0,v);g=g.substring(v+1),g=g.replace(/letter=[\'\"]\S+[\'\"]/gi,""),g=g.split("="),g=g.map(function(M){return M.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var y=[],C=0;C<g.length;C++){var E=g[C];C===0?y.push({key:E[0],data:""}):C===g.length-1?y[y.length-1].data=c(E[0]):(y[y.length-1].data=c(E[0]),y.push({key:E[1],data:""}))}var x={key:A,data:{}};return y.forEach(function(M){x.data[M.key]=M.data}),x}function c(g){return!g||g.length===0?"":g.indexOf('"')===0||g.indexOf("'")===0?g.substring(1,g.length-1):g.indexOf(",")!==-1?f(g):parseInt(g,10)}function f(g){return g.split(",").map(function(m){return parseInt(m,10)})}},"./node_modules/parse-bmfont-binary/index.js":u=>{var p=[66,77,70];u.exports=function(x){if(x.length<6)throw new Error("invalid buffer length for BMFont");var M=p.every(function(R,k){return x.readUInt8(k)===R});if(!M)throw new Error("BMFont missing BMF byte header");var w=3,S=x.readUInt8(w++);if(S>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var I={kernings:[],chars:[]},L=0;L<5;L++)w+=c(I,x,w);return I};function c(E,x,M){if(M>x.length-1)return 0;var w=x.readUInt8(M++),S=x.readInt32LE(M);switch(M+=4,w){case 1:E.info=f(x,M);break;case 2:E.common=g(x,M);break;case 3:E.pages=m(x,M,S);break;case 4:E.chars=v(x,M,S);break;case 5:E.kernings=A(x,M,S);break}return 5+S}function f(E,x){var M={};M.size=E.readInt16LE(x);var w=E.readUInt8(x+2);return M.smooth=w>>7&1,M.unicode=w>>6&1,M.italic=w>>5&1,M.bold=w>>4&1,w>>3&1&&(M.fixedHeight=1),M.charset=E.readUInt8(x+3)||"",M.stretchH=E.readUInt16LE(x+4),M.aa=E.readUInt8(x+6),M.padding=[E.readInt8(x+7),E.readInt8(x+8),E.readInt8(x+9),E.readInt8(x+10)],M.spacing=[E.readInt8(x+11),E.readInt8(x+12)],M.outline=E.readUInt8(x+13),M.face=C(E,x+14),M}function g(E,x){var M={};return M.lineHeight=E.readUInt16LE(x),M.base=E.readUInt16LE(x+2),M.scaleW=E.readUInt16LE(x+4),M.scaleH=E.readUInt16LE(x+6),M.pages=E.readUInt16LE(x+8),E.readUInt8(x+10),M.packed=0,M.alphaChnl=E.readUInt8(x+11),M.redChnl=E.readUInt8(x+12),M.greenChnl=E.readUInt8(x+13),M.blueChnl=E.readUInt8(x+14),M}function m(E,x,M){for(var w=[],S=y(E,x),I=S.length+1,L=M/I,R=0;R<L;R++)w[R]=E.slice(x,x+S.length).toString("utf8"),x+=I;return w}function v(E,x,M){for(var w=[],S=M/20,I=0;I<S;I++){var L={},R=I*20;L.id=E.readUInt32LE(x+0+R),L.x=E.readUInt16LE(x+4+R),L.y=E.readUInt16LE(x+6+R),L.width=E.readUInt16LE(x+8+R),L.height=E.readUInt16LE(x+10+R),L.xoffset=E.readInt16LE(x+12+R),L.yoffset=E.readInt16LE(x+14+R),L.xadvance=E.readInt16LE(x+16+R),L.page=E.readUInt8(x+18+R),L.chnl=E.readUInt8(x+19+R),w[I]=L}return w}function A(E,x,M){for(var w=[],S=M/10,I=0;I<S;I++){var L={},R=I*10;L.first=E.readUInt32LE(x+0+R),L.second=E.readUInt32LE(x+4+R),L.amount=E.readInt16LE(x+8+R),w[I]=L}return w}function y(E,x){for(var M=x;M<E.length&&E[M]!==0;M++);return E.slice(x,M)}function C(E,x){return y(E,x).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(u,p,c)=>{var f=c("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),g=c("./node_modules/xml-parse-from-string/index.js"),m={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};u.exports=function(E){E=E.toString();var x=g(E),M={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(P){var F=x.getElementsByTagName(P)[0];F&&(M[P]=f(v(F)))});var w=x.getElementsByTagName("pages")[0];if(!w)throw new Error("malformed file -- no <pages> element");for(var S=w.getElementsByTagName("page"),I=0;I<S.length;I++){var L=S[I],R=parseInt(L.getAttribute("id"),10),k=L.getAttribute("file");if(isNaN(R))throw new Error('malformed file -- page "id" attribute is NaN');if(!k)throw new Error('malformed file -- needs page "file" attribute');M.pages[parseInt(R,10)]=k}return["chars","kernings"].forEach(function(P){var F=x.getElementsByTagName(P)[0];if(F)for(var O=P.substring(0,P.length-1),W=F.getElementsByTagName(O),V=0;V<W.length;V++){var $=W[V];M[P].push(f(v($)))}}),M};function v(C){var E=A(C);return E.reduce(function(x,M){var w=y(M.nodeName);return x[w]=M.nodeValue,x},{})}function A(C){for(var E=[],x=0;x<C.attributes.length;x++)E.push(C.attributes[x]);return E}function y(C){return m[C.toLowerCase()]||C}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":u=>{var p="chasrset";u.exports=function(g){p in g&&(g.charset=g[p],delete g[p]);for(var m in g)m==="face"||m==="charset"||(m==="padding"||m==="spacing"?g[m]=c(g[m]):g[m]=parseInt(g[m],10));return g};function c(f){return f.split(",").map(function(g){return parseInt(g,10)})}},"./node_modules/parse-headers/parse-headers.js":u=>{var p=function(f){return f.replace(/^\s+|\s+$/g,"")},c=function(f){return Object.prototype.toString.call(f)==="[object Array]"};u.exports=function(f){if(!f)return{};for(var g={},m=p(f).split(`
`),v=0;v<m.length;v++){var A=m[v],y=A.indexOf(":"),C=p(A.slice(0,y)).toLowerCase(),E=p(A.slice(y+1));typeof g[C]>"u"?g[C]=E:c(g[C])?g[C].push(E):g[C]=[g[C],E]}return g}},"./node_modules/quad-indices/index.js":(u,p,c)=>{var f=c("./node_modules/dtype/index.js"),g=c("./node_modules/an-array/index.js"),m=c("./node_modules/is-buffer/index.js"),v=[0,2,3],A=[2,1,3];u.exports=function(C,E){(!C||!(g(C)||m(C)))&&(E=C||{},C=null),typeof E=="number"?E={count:E}:E=E||{};for(var x=typeof E.type=="string"?E.type:"uint16",M=typeof E.count=="number"?E.count:1,w=E.start||0,S=E.clockwise!==!1?v:A,I=S[0],L=S[1],R=S[2],k=M*6,P=C||new(f(x))(k),F=0,O=0;F<k;F+=6,O+=4){var W=F+w;P[W+0]=O+0,P[W+1]=O+1,P[W+2]=O+2,P[W+3]=O+I,P[W+4]=O+L,P[W+5]=O+R}return P}},"./node_modules/super-animejs/lib/anime.es.js":(u,p,c)=>{c.r(p),c.d(p,{default:()=>nl});var f={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},g={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},m=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],v={CSS:{},springs:{}};function A(Oe,We,ot){return Math.min(Math.max(Oe,We),ot)}function y(Oe,We){return Oe.indexOf(We)>-1}function C(Oe,We){return Oe.apply(null,We)}var E=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,x=/^rgb/,M=/^hsl/,w={arr:function(Oe){return Array.isArray(Oe)},obj:function(Oe){return y(Object.prototype.toString.call(Oe),"Object")},pth:function(Oe){return w.obj(Oe)&&Oe.hasOwnProperty("totalLength")},svg:function(Oe){return Oe instanceof SVGElement},inp:function(Oe){return Oe instanceof HTMLInputElement},dom:function(Oe){return Oe.nodeType||w.svg(Oe)},str:function(Oe){return typeof Oe=="string"},fnc:function(Oe){return typeof Oe=="function"},und:function(Oe){return typeof Oe>"u"},hex:function(Oe){return E.test(Oe)},rgb:function(Oe){return x.test(Oe)},hsl:function(Oe){return M.test(Oe)},col:function(Oe){return w.hex(Oe)||w.rgb(Oe)||w.hsl(Oe)},key:function(Oe){return!f.hasOwnProperty(Oe)&&!g.hasOwnProperty(Oe)&&Oe!=="targets"&&Oe!=="keyframes"}},S=/\(([^)]+)\)/;function I(Oe){var We=S.exec(Oe);return We?We[1].split(",").map(function(ot){return parseFloat(ot)}):[]}function L(Oe,We){var ot=I(Oe),Rt=A(w.und(ot[0])?1:ot[0],.1,100),gt=A(w.und(ot[1])?100:ot[1],.1,100),Ht=A(w.und(ot[2])?10:ot[2],.1,100),an=A(w.und(ot[3])?0:ot[3],.1,100),jn=Math.sqrt(gt/Rt),Bn=Ht/(2*Math.sqrt(gt*Rt)),zt=Bn<1?jn*Math.sqrt(1-Bn*Bn):0,Zn=1,oi=Bn<1?(Bn*jn+-an)/zt:-an+jn;function hi(Ti){var bi=We?We*Ti/1e3:Ti;return Bn<1?bi=Math.exp(-bi*Bn*jn)*(Zn*Math.cos(zt*bi)+oi*Math.sin(zt*bi)):bi=(Zn+oi*bi)*Math.exp(-bi*jn),Ti===0||Ti===1?Ti:1-bi}function wr(){var Ti=v.springs[Oe];if(Ti)return Ti;for(var bi=1/6,Wi=0,Or=0;;)if(Wi+=bi,hi(Wi)===1){if(Or++,Or>=16)break}else Or=0;var ms=Wi*bi*1e3;return v.springs[Oe]=ms,ms}return We?hi:wr}function R(Oe,We){Oe===void 0&&(Oe=1),We===void 0&&(We=.5);var ot=A(Oe,1,10),Rt=A(We,.1,2);return function(gt){return gt===0||gt===1?gt:-ot*Math.pow(2,10*(gt-1))*Math.sin((gt-1-Rt/(Math.PI*2)*Math.asin(1/ot))*(Math.PI*2)/Rt)}}function k(Oe){return Oe===void 0&&(Oe=10),function(We){return Math.round(We*Oe)*(1/Oe)}}var P=function(){var Oe=11,We=1/(Oe-1);function ot(Zn,oi){return 1-3*oi+3*Zn}function Rt(Zn,oi){return 3*oi-6*Zn}function gt(Zn){return 3*Zn}function Ht(Zn,oi,hi){return((ot(oi,hi)*Zn+Rt(oi,hi))*Zn+gt(oi))*Zn}function an(Zn,oi,hi){return 3*ot(oi,hi)*Zn*Zn+2*Rt(oi,hi)*Zn+gt(oi)}function jn(Zn,oi,hi,wr,Ti){var bi,Wi,Or=0;do Wi=oi+(hi-oi)/2,bi=Ht(Wi,wr,Ti)-Zn,bi>0?hi=Wi:oi=Wi;while(Math.abs(bi)>1e-7&&++Or<10);return Wi}function Bn(Zn,oi,hi,wr){for(var Ti=0;Ti<4;++Ti){var bi=an(oi,hi,wr);if(bi===0)return oi;var Wi=Ht(oi,hi,wr)-Zn;oi-=Wi/bi}return oi}function zt(Zn,oi,hi,wr){if(!(0<=Zn&&Zn<=1&&0<=hi&&hi<=1))return;var Ti=new Float32Array(Oe);if(Zn!==oi||hi!==wr)for(var bi=0;bi<Oe;++bi)Ti[bi]=Ht(bi*We,Zn,hi);function Wi(Or){for(var ms=0,Rn=1,Ii=Oe-1;Rn!==Ii&&Ti[Rn]<=Or;++Rn)ms+=We;--Rn;var es=(Or-Ti[Rn])/(Ti[Rn+1]-Ti[Rn]),Zi=ms+es*We,ne=an(Zi,Zn,hi);return ne>=.001?Bn(Or,Zi,Zn,hi):ne===0?Zi:jn(Or,ms,ms+We,Zn,hi)}return function(Or){return Zn===oi&&hi===wr||Or===0||Or===1?Or:Ht(Wi(Or),oi,wr)}}return zt}(),F=function(){var Oe=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],We={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],R],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(an,jn){return function(Bn){return 1-R(an,jn)(1-Bn)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(an,jn){return function(Bn){return Bn<.5?R(an,jn)(Bn*2)/2:1-R(an,jn)(Bn*-2+2)/2}}]},ot={linear:[.25,.25,.75,.75]};for(var Rt in We)for(var gt=0,Ht=We[Rt].length;gt<Ht;gt++)ot["ease"+Rt+Oe[gt]]=We[Rt][gt];return ot}();function O(Oe,We){if(w.fnc(Oe))return Oe;var ot=Oe.split("(")[0],Rt=F[ot],gt=I(Oe);switch(ot){case"spring":return L(Oe,We);case"cubicBezier":return C(P,gt);case"steps":return C(k,gt);default:return w.fnc(Rt)?C(Rt,gt):C(P,Rt)}}function W(Oe){try{var We=document.querySelectorAll(Oe);return We}catch{return}}var V=[];function $(Oe,We){for(var ot=V,Rt=Oe.length,gt=arguments.length>=2?arguments[1]:void 0,Ht=0;Ht<Rt;Ht++)if(Ht in Oe){var an=Oe[Ht];We.call(gt,an,Ht,Oe)&&ot.push(an)}return V=Oe,V.length=0,ot}function H(Oe,We){We||(We=[]);for(var ot=0,Rt=Oe.length;ot<Rt;ot++){var gt=Oe[ot];Array.isArray(gt)?H(gt,We):We.push(gt)}return We}function Y(Oe){return w.arr(Oe)?Oe:(w.str(Oe)&&(Oe=W(Oe)||Oe),Oe instanceof NodeList||Oe instanceof HTMLCollection?[].slice.call(Oe):[Oe])}function Q(Oe,We){return Oe.some(function(ot){return ot===We})}function G(Oe){var We={};for(var ot in Oe)We[ot]=Oe[ot];return We}function J(Oe,We){var ot=G(Oe);for(var Rt in Oe)ot[Rt]=We.hasOwnProperty(Rt)?We[Rt]:Oe[Rt];return ot}function K(Oe,We){var ot=G(Oe);for(var Rt in We)ot[Rt]=w.und(Oe[Rt])?We[Rt]:Oe[Rt];return ot}var se=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function ue(Oe){var We=se.exec(Oe);return We?"rgba("+We[1]+",1)":Oe}var he=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Me=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function de(Oe){var We=Oe.replace(he,function(an,jn,Bn,zt){return jn+jn+Bn+Bn+zt+zt}),ot=Me.exec(We),Rt=parseInt(ot[1],16),gt=parseInt(ot[2],16),Ht=parseInt(ot[3],16);return"rgba("+Rt+","+gt+","+Ht+",1)"}var Pe=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Se=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Le(Oe){var We=Pe.exec(Oe)||Se.exec(Oe),ot=parseInt(We[1],10)/360,Rt=parseInt(We[2],10)/100,gt=parseInt(We[3],10)/100,Ht=We[4]||1;function an(hi,wr,Ti){return Ti<0&&(Ti+=1),Ti>1&&(Ti-=1),Ti<.16666666666666666?hi+(wr-hi)*6*Ti:Ti<.5?wr:Ti<.6666666666666666?hi+(wr-hi)*(.6666666666666666-Ti)*6:hi}var jn,Bn,zt;if(Rt==0)jn=Bn=zt=gt;else{var Zn=gt<.5?gt*(1+Rt):gt+Rt-gt*Rt,oi=2*gt-Zn;jn=an(oi,Zn,ot+.3333333333333333),Bn=an(oi,Zn,ot),zt=an(oi,Zn,ot-.3333333333333333)}return"rgba("+jn*255+","+Bn*255+","+zt*255+","+Ht+")"}function be(Oe){if(w.rgb(Oe))return ue(Oe);if(w.hex(Oe))return de(Oe);if(w.hsl(Oe))return Le(Oe)}var je=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Te(Oe){var We=je.exec(Oe);if(We)return We[2]}function rt(Oe){if(y(Oe,"translate")||Oe==="perspective")return"px";if(y(Oe,"rotate")||y(Oe,"skew"))return"deg"}function mt(Oe,We){return w.fnc(Oe)?Oe(We.target,We.id,We.total):Oe}function vt(Oe,We){return Oe.getAttribute(We)}function ft(Oe,We,ot){var Rt=Te(We);if(Q([ot,"deg","rad","turn"],Rt))return We;var gt=v.CSS[We+ot];if(!w.und(gt))return gt;var Ht=100,an=document.createElement(Oe.tagName),jn=Oe.parentNode&&Oe.parentNode!==document?Oe.parentNode:document.body;jn.appendChild(an),an.style.position="absolute",an.style.width=Ht+ot;var Bn=Ht/an.offsetWidth;jn.removeChild(an);var zt=Bn*parseFloat(We);return v.CSS[We+ot]=zt,zt}function Ze(Oe,We,ot){if(We in Oe.style){var Rt=We.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),gt=Oe.style[We]||getComputedStyle(Oe).getPropertyValue(Rt)||"0";return ot?ft(Oe,gt,ot):gt}}function St(Oe,We){if(w.dom(Oe)&&!w.inp(Oe)&&(vt(Oe,We)||w.svg(Oe)&&Oe[We]))return"attribute";if(w.dom(Oe)&&Q(m,We))return"transform";if(w.dom(Oe)&&We!=="transform"&&Ze(Oe,We))return"css";if(Oe[We]!=null)return"object"}var $t=/(\w+)\(([^)]*)\)/g;function ct(Oe){if(w.dom(Oe)){for(var We=Oe.style.transform||"",ot=new Map,Rt;Rt=$t.exec(We);)ot.set(Rt[1],Rt[2]);return ot}}function Ct(Oe,We,ot,Rt){var gt=y(We,"scale")?1:0+rt(We),Ht=ct(Oe).get(We)||gt;return ot&&(ot.transforms.list.set(We,Ht),ot.transforms.last=We),Rt?ft(Oe,Ht,Rt):Ht}function Tt(Oe,We,ot,Rt){switch(St(Oe,We)){case"transform":return Ct(Oe,We,Rt,ot);case"css":return Ze(Oe,We,ot);case"attribute":return vt(Oe,We);default:return Oe[We]||0}}var At=/^(\*=|\+=|-=)/;function pn(Oe,We){var ot=At.exec(Oe);if(!ot)return Oe;var Rt=Te(Oe)||0,gt=parseFloat(We),Ht=parseFloat(Oe.replace(ot[0],""));switch(ot[0][0]){case"+":return gt+Ht+Rt;case"-":return gt-Ht+Rt;case"*":return gt*Ht+Rt}}var yt=/\s/g;function kn(Oe,We){if(w.col(Oe))return be(Oe);var ot=Te(Oe),Rt=ot?Oe.substr(0,Oe.length-ot.length):Oe;return We&&!yt.test(Oe)?Rt+We:Rt}function qn(Oe,We){return Math.sqrt(Math.pow(We.x-Oe.x,2)+Math.pow(We.y-Oe.y,2))}function Gt(Oe){return Math.PI*2*vt(Oe,"r")}function bt(Oe){return vt(Oe,"width")*2+vt(Oe,"height")*2}function ye(Oe){return qn({x:vt(Oe,"x1"),y:vt(Oe,"y1")},{x:vt(Oe,"x2"),y:vt(Oe,"y2")})}function _e(Oe){for(var We=Oe.points,ot=0,Rt,gt=0;gt<We.numberOfItems;gt++){var Ht=We.getItem(gt);gt>0&&(ot+=qn(Rt,Ht)),Rt=Ht}return ot}function Ue(Oe){var We=Oe.points;return _e(Oe)+qn(We.getItem(We.numberOfItems-1),We.getItem(0))}function Re(Oe){if(Oe.getTotalLength)return Oe.getTotalLength();switch(Oe.tagName.toLowerCase()){case"circle":return Gt(Oe);case"rect":return bt(Oe);case"line":return ye(Oe);case"polyline":return _e(Oe);case"polygon":return Ue(Oe)}}function Ce(Oe){var We=Re(Oe);return Oe.setAttribute("stroke-dasharray",We),We}function Ne(Oe){for(var We=Oe.parentNode;w.svg(We)&&(We=We.parentNode,!!w.svg(We.parentNode)););return We}function le(Oe,We){var ot=We||{},Rt=ot.el||Ne(Oe),gt=Rt.getBoundingClientRect(),Ht=vt(Rt,"viewBox"),an=gt.width,jn=gt.height,Bn=ot.viewBox||(Ht?Ht.split(" "):[0,0,an,jn]);return{el:Rt,viewBox:Bn,x:Bn[0]/1,y:Bn[1]/1,w:an/Bn[2],h:jn/Bn[3]}}function j(Oe,We){var ot=w.str(Oe)?W(Oe)[0]:Oe,Rt=We||100;return function(gt){return{property:gt,el:ot,svg:le(ot),totalLength:Re(ot)*(Rt/100)}}}function Z(Oe,We){function ot(jn){jn===void 0&&(jn=0);var Bn=We+jn>=1?We+jn:0;return Oe.el.getPointAtLength(Bn)}var Rt=le(Oe.el,Oe.svg),gt=ot(),Ht=ot(-1),an=ot(1);switch(Oe.property){case"x":return(gt.x-Rt.x)*Rt.w;case"y":return(gt.y-Rt.y)*Rt.h;case"angle":return Math.atan2(an.y-Ht.y,an.x-Ht.x)*180/Math.PI}}var pe=/-?\d*\.?\d+/g;function Ee(Oe,We){var ot=kn(w.pth(Oe)?Oe.totalLength:Oe,We)+"";return{original:ot,numbers:ot.match(pe)?ot.match(pe).map(Number):[0],strings:w.str(Oe)||We?ot.split(pe):[]}}function Qe(Oe){var We=Oe?H(w.arr(Oe)?Oe.map(Y):Y(Oe)):[];return $(We,function(ot,Rt,gt){return gt.indexOf(ot)===Rt})}function He(Oe){var We=Qe(Oe);return We.map(function(ot,Rt){return{target:ot,id:Rt,total:We.length,transforms:{list:ct(ot)}}})}var Pt=/^spring/;function rn(Oe,We){var ot=G(We);if(Pt.test(ot.easing)&&(ot.duration=L(ot.easing)),w.arr(Oe)){var Rt=Oe.length,gt=Rt===2&&!w.obj(Oe[0]);gt?Oe={value:Oe}:w.fnc(We.duration)||(ot.duration=We.duration/Rt)}var Ht=w.arr(Oe)?Oe:[Oe];return Ht.map(function(an,jn){var Bn=w.obj(an)&&!w.pth(an)?an:{value:an};return w.und(Bn.delay)&&(Bn.delay=jn?0:We.delay),w.und(Bn.endDelay)&&(Bn.endDelay=jn===Ht.length-1?We.endDelay:0),Bn}).map(function(an){return K(an,ot)})}function Xt(Oe){for(var We=$(H(Oe.map(function(Ht){return Object.keys(Ht)})),function(Ht){return w.key(Ht)}).reduce(function(Ht,an){return Ht.indexOf(an)<0&&Ht.push(an),Ht},[]),ot={},Rt=function(Ht){var an=We[Ht];ot[an]=Oe.map(function(jn){var Bn={};for(var zt in jn)w.key(zt)?zt==an&&(Bn.value=jn[zt]):Bn[zt]=jn[zt];return Bn})},gt=0;gt<We.length;gt++)Rt(gt);return ot}function st(Oe,We){var ot=[],Rt=We.keyframes;Rt&&(We=K(Xt(Rt),We));for(var gt in We)w.key(gt)&&ot.push({name:gt,tweens:rn(We[gt],Oe)});return ot}function An(Oe,We){var ot={};for(var Rt in Oe){var gt=mt(Oe[Rt],We);w.arr(gt)&&(gt=gt.map(function(Ht){return mt(Ht,We)}),gt.length===1&&(gt=gt[0])),ot[Rt]=gt}return ot.duration=parseFloat(ot.duration),ot.delay=parseFloat(ot.delay),ot}function Vt(Oe,We){var ot;return Oe.tweens.map(function(Rt){var gt=An(Rt,We),Ht=gt.value,an=w.arr(Ht)?Ht[1]:Ht,jn=Te(an),Bn=Tt(We.target,Oe.name,jn,We),zt=ot?ot.to.original:Bn,Zn=w.arr(Ht)?Ht[0]:zt,oi=Te(Zn)||Te(Bn),hi=jn||oi;return w.und(an)&&(an=zt),gt.from=Ee(Zn,hi),gt.to=Ee(pn(an,Zn),hi),gt.start=ot?ot.end:0,gt.end=gt.start+gt.delay+gt.duration+gt.endDelay,gt.easing=O(gt.easing,gt.duration),gt.isPath=w.pth(Ht),gt.isColor=w.col(gt.from.original),gt.isColor&&(gt.round=1),ot=gt,gt})}var Dn={css:function(Oe,We,ot){return Oe.style[We]=ot},attribute:function(Oe,We,ot){return Oe.setAttribute(We,ot)},object:function(Oe,We,ot){return Oe[We]=ot},transform:function(Oe,We,ot,Rt,gt){if(Rt.list.set(We,ot),We===Rt.last||gt){var Ht="";Rt.list.forEach(function(an,jn){Ht+=jn+"("+an+") "}),Oe.style.transform=Ht}}};function Qr(Oe,We){for(var ot=He(Oe),Rt=0,gt=ot.length;Rt<gt;Rt++){var Ht=ot[Rt];for(var an in We){var jn=mt(We[an],Ht),Bn=Ht.target,zt=Te(jn),Zn=Tt(Bn,an,zt,Ht),oi=zt||Te(Zn),hi=pn(kn(jn,oi),Zn),wr=St(Bn,an);Dn[wr](Bn,an,hi,Ht.transforms,!0)}}}function nr(Oe,We){var ot=St(Oe.target,We.name);if(ot){var Rt=Vt(We,Oe),gt=Rt[Rt.length-1];return{type:ot,property:We.name,animatable:Oe,tweens:Rt,duration:gt.end,delay:Rt[0].delay,endDelay:gt.endDelay}}}function _r(Oe,We){return $(H(Oe.map(function(ot){return We.map(function(Rt){return nr(ot,Rt)})})),function(ot){return!w.und(ot)})}function Po(Oe,We){var ot=Oe.length,Rt=function(Ht){return Ht.timelineOffset?Ht.timelineOffset:0},gt={};return gt.duration=ot?Math.max.apply(Math,Oe.map(function(Ht){return Rt(Ht)+Ht.duration})):We.duration,gt.delay=ot?Math.min.apply(Math,Oe.map(function(Ht){return Rt(Ht)+Ht.delay})):We.delay,gt.endDelay=ot?gt.duration-Math.max.apply(Math,Oe.map(function(Ht){return Rt(Ht)+Ht.duration-Ht.endDelay})):We.endDelay,gt}var Hr=0;function fa(Oe){var We=J(f,Oe),ot=J(g,Oe),Rt=st(ot,Oe),gt=He(Oe.targets),Ht=_r(gt,Rt),an=Po(Ht,ot),jn=Hr;return Hr++,K(We,{id:jn,children:[],animatables:gt,animations:Ht,duration:an.duration,delay:an.delay,endDelay:an.endDelay})}var ds=[],go=[],da,Js=function(){function Oe(){da=requestAnimationFrame(We)}function We(ot){var Rt=ds.length;if(Rt){for(var gt=0;gt<Rt;){var Ht=ds[gt];if(!Ht.paused)Ht.tick(ot);else{var an=ds.indexOf(Ht);an>-1&&(ds.splice(an,1),Rt=ds.length)}gt++}Oe()}else da=cancelAnimationFrame(da)}return Oe}();function zr(){if(document.hidden){for(var Oe=0,We=ds.length;Oe<We;Oe++)activeInstance[Oe].pause();go=ds.slice(0),ds=[]}else for(var ot=0,Rt=go.length;ot<Rt;ot++)go[ot].play()}document.addEventListener("visibilitychange",zr);function Er(Oe){Oe===void 0&&(Oe={});var We=0,ot=0,Rt=0,gt,Ht=0,an=null;function jn(){return window.Promise&&new Promise(function(Rn){return an=Rn})}var Bn=jn(),zt=fa(Oe);function Zn(){zt.reversed=!zt.reversed;for(var Rn=0,Ii=gt.length;Rn<Ii;Rn++)gt[Rn].reversed=zt.reversed}function oi(Rn){return zt.reversed?zt.duration-Rn:Rn}function hi(){We=0,ot=oi(zt.currentTime)*(1/Er.speed)}function wr(Rn,Ii){Ii&&Ii.seek(Rn-Ii.timelineOffset)}function Ti(Rn){if(zt.reversePlayback)for(var es=Ht;es--;)wr(Rn,gt[es]);else for(var Ii=0;Ii<Ht;Ii++)wr(Rn,gt[Ii])}function bi(Rn){for(var Ii=0,es=zt.animations,Zi=es.length;Ii<Zi;){var ne=es[Ii],ae=ne.animatable,me=ne.tweens,xe=me.length-1,Fe=me[xe];xe&&(Fe=$(me,function(jr){return Rn<jr.end})[0]||Fe);for(var Je=A(Rn-Fe.start-Fe.delay,0,Fe.duration)/Fe.duration,nt=isNaN(Je)?1:Fe.easing(Je),qt=Fe.to.strings,Kt=Fe.round,dt=[],Lt=Fe.to.numbers.length,on=void 0,Nn=0;Nn<Lt;Nn++){var $n=void 0,ai=Fe.to.numbers[Nn],wi=Fe.from.numbers[Nn]||0;Fe.isPath?$n=Z(Fe.value,nt*ai):$n=wi+nt*(ai-wi),Kt&&(Fe.isColor&&Nn>2||($n=Math.round($n*Kt)/Kt)),dt.push($n)}var Ai=qt.length;if(!Ai)on=dt[0];else{on=qt[0];for(var ui=0;ui<Ai;ui++){qt[ui];var ir=qt[ui+1],Cr=dt[ui];isNaN(Cr)||(ir?on+=Cr+ir:on+=Cr+" ")}}Dn[ne.type](ae.target,ne.property,on,ae.transforms),ne.currentValue=on,Ii++}}function Wi(Rn){zt[Rn]&&!zt.passThrough&&zt[Rn](zt)}function Or(){zt.remaining&&zt.remaining!==!0&&zt.remaining--}function ms(Rn){var Ii=zt.duration,es=zt.delay,Zi=Ii-zt.endDelay,ne=oi(Rn);zt.progress=A(ne/Ii*100,0,100),zt.reversePlayback=ne<zt.currentTime,gt&&Ti(ne),!zt.began&&zt.currentTime>0&&(zt.began=!0,Wi("begin"),Wi("loopBegin")),ne<=es&&zt.currentTime!==0&&bi(0),(ne>=Zi&&zt.currentTime!==Ii||!Ii)&&bi(Ii),ne>es&&ne<Zi?(zt.changeBegan||(zt.changeBegan=!0,zt.changeCompleted=!1,Wi("changeBegin")),Wi("change"),bi(ne)):zt.changeBegan&&(zt.changeCompleted=!0,zt.changeBegan=!1,Wi("changeComplete")),zt.currentTime=A(ne,0,Ii),zt.began&&Wi("update"),Rn>=Ii&&(ot=0,Or(),zt.remaining?(We=Rt,Wi("loopComplete"),Wi("loopBegin"),zt.direction==="alternate"&&Zn()):(zt.paused=!0,zt.completed||(zt.completed=!0,Wi("loopComplete"),Wi("complete"),"Promise"in window&&(an(),Bn=jn()))))}return zt.reset=function(){var Rn=zt.direction;zt.passThrough=!1,zt.currentTime=0,zt.progress=0,zt.paused=!0,zt.began=!1,zt.changeBegan=!1,zt.completed=!1,zt.changeCompleted=!1,zt.reversePlayback=!1,zt.reversed=Rn==="reverse",zt.remaining=zt.loop,gt=zt.children,Ht=gt.length;for(var Ii=Ht;Ii--;)zt.children[Ii].reset();(zt.reversed&&zt.loop!==!0||Rn==="alternate"&&zt.loop===1)&&zt.remaining++,bi(0)},zt.set=function(Rn,Ii){return Qr(Rn,Ii),zt},zt.tick=function(Rn){Rt=Rn,We||(We=Rt),ms((Rt+(ot-We))*Er.speed)},zt.seek=function(Rn){ms(oi(Rn))},zt.pause=function(){zt.paused=!0,hi()},zt.play=function(){zt.paused&&(zt.paused=!1,ds.push(zt),hi(),da||Js())},zt.reverse=function(){Zn(),hi()},zt.restart=function(){zt.reset(),zt.play()},zt.finished=Bn,zt.reset(),zt.autoplay&&zt.play(),zt}function ps(Oe,We){for(var ot=We.length;ot--;)Q(Oe,We[ot].animatable.target)&&We.splice(ot,1)}function Rl(Oe){for(var We=Qe(Oe),ot=ds.length;ot--;){var Rt=ds[ot],gt=Rt.animations,Ht=Rt.children;ps(We,gt);for(var an=Ht.length;an--;){var jn=Ht[an],Bn=jn.animations;ps(We,Bn),!Bn.length&&!jn.children.length&&Ht.splice(an,1)}!gt.length&&!Ht.length&&Rt.pause()}}function Yo(Oe,We){We===void 0&&(We={});var ot=We.direction||"normal",Rt=We.easing?O(We.easing):null,gt=We.grid,Ht=We.axis,an=We.from||0,jn=an==="first",Bn=an==="center",zt=an==="last",Zn=w.arr(Oe),oi=parseFloat(Zn?Oe[0]:Oe),hi=Zn?parseFloat(Oe[1]):0,wr=Te(Zn?Oe[1]:Oe)||0,Ti=We.start||0+(Zn?oi:0),bi=[],Wi=0;return function(Or,ms,Rn){if(jn&&(an=0),Bn&&(an=(Rn-1)/2),zt&&(an=Rn-1),!bi.length){for(var Ii=0;Ii<Rn;Ii++){if(!gt)bi.push(Math.abs(an-Ii));else{var es=Bn?(gt[0]-1)/2:an%gt[0],Zi=Bn?(gt[1]-1)/2:Math.floor(an/gt[0]),ne=Ii%gt[0],ae=Math.floor(Ii/gt[0]),me=es-ne,xe=Zi-ae,Fe=Math.sqrt(me*me+xe*xe);Ht==="x"&&(Fe=-me),Ht==="y"&&(Fe=-xe),bi.push(Fe)}Wi=Math.max.apply(Math,bi)}Rt&&(bi=bi.map(function(nt){return Rt(nt/Wi)*Wi})),ot==="reverse"&&(bi=bi.map(function(nt){return Ht?nt<0?nt*-1:-nt:Math.abs(Wi-nt)}))}var Je=Zn?(hi-oi)/Wi:oi;return Ti+Je*(Math.round(bi[ms]*100)/100)+wr}}function yc(Oe){Oe===void 0&&(Oe={});var We=Er(Oe);return We.duration=0,We.add=function(ot,Rt){var gt=ds.indexOf(We),Ht=We.children;gt>-1&&ds.splice(gt,1);function an(hi){hi.passThrough=!0}for(var jn=0;jn<Ht.length;jn++)an(Ht[jn]);var Bn=K(ot,J(g,Oe));Bn.targets=Bn.targets||Oe.targets;var zt=We.duration;Bn.autoplay=!1,Bn.direction=We.direction,Bn.timelineOffset=w.und(Rt)?zt:pn(Rt,zt),an(We),We.seek(Bn.timelineOffset);var Zn=Er(Bn);an(Zn),Ht.push(Zn);var oi=Po(Ht,Oe);return We.delay=oi.delay,We.endDelay=oi.endDelay,We.duration=oi.duration,We.seek(0),We.reset(),We.autoplay&&We.play(),We},We}Er.version="3.0.0",Er.speed=1,Er.running=ds,Er.remove=Rl,Er.get=Tt,Er.set=Qr,Er.convertPx=ft,Er.path=j,Er.setDashoffset=Ce,Er.stagger=Yo,Er.timeline=yc,Er.easing=O,Er.penner=F,Er.random=function(Oe,We){return Math.floor(Math.random()*(We-Oe+1))+Oe};const nl=Er},"./node_modules/three-bmfont-text/index.js":(u,p,c)=>{var f=c("./node_modules/layout-bmfont-text/index.js"),g=c("./node_modules/quad-indices/index.js"),m=c("./node_modules/three-bmfont-text/lib/vertices.js"),v=c("./node_modules/three-bmfont-text/lib/utils.js");u.exports=function(C){return new A(C)};class A extends THREE.BufferGeometry{constructor(C){super(),typeof C=="string"&&(C={text:C}),this._opt=Object.assign({},C),C&&this.update(C)}update(C){if(typeof C=="string"&&(C={text:C}),C=Object.assign({},this._opt,C),!C.font)throw new TypeError("must specify a { font } in options");this.layout=f(C);var E=C.flipY!==!1,x=C.font,M=x.common.scaleW,w=x.common.scaleH,S=this.layout.glyphs.filter(function(P){var F=P.data;return F.width*F.height>0});this.visibleGlyphs=S;var I=m.positions(S),L=m.uvs(S,M,w,E),R=g([],{clockwise:!0,type:"uint16",count:S.length});if(this.setIndex(R),this.setAttribute("position",new THREE.BufferAttribute(I,2)),this.setAttribute("uv",new THREE.BufferAttribute(L,2)),!C.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(C.multipage){var k=m.pages(S);this.setAttribute("page",new THREE.BufferAttribute(k,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var C=this.attributes.position.array,E=this.attributes.position.itemSize;if(!C||!E||C.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}v.computeSphere(C,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var C=this.boundingBox,E=this.attributes.position.array,x=this.attributes.position.itemSize;if(!E||!x||E.length<2){C.makeEmpty();return}v.computeBox(E,C)}}},"./node_modules/three-bmfont-text/lib/utils.js":u=>{var p=2,c={min:[0,0],max:[0,0]};function f(g){var m=g.length/p;c.min[0]=g[0],c.min[1]=g[1],c.max[0]=g[0],c.max[1]=g[1];for(var v=0;v<m;v++){var A=g[v*p+0],y=g[v*p+1];c.min[0]=Math.min(A,c.min[0]),c.min[1]=Math.min(y,c.min[1]),c.max[0]=Math.max(A,c.max[0]),c.max[1]=Math.max(y,c.max[1])}}u.exports.computeBox=function(g,m){f(g),m.min.set(c.min[0],c.min[1],0),m.max.set(c.max[0],c.max[1],0)},u.exports.computeSphere=function(g,m){f(g);var v=c.min[0],A=c.min[1],y=c.max[0],C=c.max[1],E=y-v,x=C-A,M=Math.sqrt(E*E+x*x);m.center.set(v+E/2,A+x/2,0),m.radius=M/2}},"./node_modules/three-bmfont-text/lib/vertices.js":u=>{u.exports.pages=function(c){var f=new Float32Array(c.length*4*1),g=0;return c.forEach(function(m){var v=m.data.page||0;f[g++]=v,f[g++]=v,f[g++]=v,f[g++]=v}),f},u.exports.uvs=function(c,f,g,m){var v=new Float32Array(c.length*4*2),A=0;return c.forEach(function(y){var C=y.data,E=C.x+C.width,x=C.y+C.height,M=C.x/f,w=C.y/g,S=E/f,I=x/g;m&&(w=(g-C.y)/g,I=(g-x)/g),v[A++]=M,v[A++]=w,v[A++]=M,v[A++]=I,v[A++]=S,v[A++]=I,v[A++]=S,v[A++]=w}),v},u.exports.positions=function(c){var f=new Float32Array(c.length*4*2),g=0;return c.forEach(function(m){var v=m.data,A=m.position[0]+v.xoffset,y=m.position[1]+v.yoffset,C=v.width,E=v.height;f[g++]=A,f[g++]=y,f[g++]=A,f[g++]=y+E,f[g++]=A+C,f[g++]=y+E,f[g++]=A+C,f[g++]=y}),f}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(u,p,c){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(f,g){u.exports=g()})(this,function(){var f=typeof window<"u"?window:typeof c.g<"u"?c.g:typeof self<"u"?self:{};function g(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}function m(R,k){return k={exports:{}},R(k,k.exports),k.exports}var v=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},A=function(k,P){for(var F=0,O=k.length;F<O;F++)P[F]=k[F]},y=function(k,P){for(var F in P)P.hasOwnProperty(F)&&(k[F]=P[F]);return k},C=m(function(R,k){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(P,F){R.exports=F()})(f,function(){var P=function(ne,ae){if(!(ne instanceof ae))throw new TypeError("Cannot call a class as a function")},F=function(){function ne(ae,me){for(var xe=0;xe<me.length;xe++){var Fe=me[xe];Fe.enumerable=Fe.enumerable||!1,Fe.configurable=!0,"value"in Fe&&(Fe.writable=!0),Object.defineProperty(ae,Fe.key,Fe)}}return function(ae,me,xe){return me&&ne(ae.prototype,me),xe&&ne(ae,xe),ae}}(),O=function(){function ne(ae,me){var xe=[],Fe=!0,Je=!1,nt=void 0;try{for(var qt=ae[Symbol.iterator](),Kt;!(Fe=(Kt=qt.next()).done)&&(xe.push(Kt.value),!(me&&xe.length===me));Fe=!0);}catch(dt){Je=!0,nt=dt}finally{try{!Fe&&qt.return&&qt.return()}finally{if(Je)throw nt}}return xe}return function(ae,me){if(Array.isArray(ae))return ae;if(Symbol.iterator in Object(ae))return ne(ae,me);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),W=.001,V=1,$=function(ae,me){return"data:"+ae+","+encodeURIComponent(me)},H=function(ae,me,xe){return ae+(me-ae)*xe},Y=function(){var ne=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return ne}}(),Q=function(){var ne=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return ne}}(),G=function(){var ne=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return ne}}(),J=function(){var ne=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return ne}}(),K=function(){var ne=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),ae=ne?parseInt(ne[1],10):null;return function(){return ae}}(),se=function(){var ne=!1;return ne=Y()&&G()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return ne}}(),ue=function(){var ne=!1;if(K()===65){var ae=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(ae){var me=ae[1].split("."),xe=O(me,4);xe[0],xe[1];var Fe=xe[2],Je=xe[3];ne=parseInt(Fe,10)===3325&&parseInt(Je,10)<148}}return function(){return ne}}(),he=function(){var ne=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return ne}}(),Me=function(){var ae=window.orientation==90||window.orientation==-90;return he()?!ae:ae},de=function(ae){return!(isNaN(ae)||ae<=W||ae>V)},Pe=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Se=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Le=function(ae){if(Q())return!1;if(ae.requestFullscreen)ae.requestFullscreen();else if(ae.webkitRequestFullscreen)ae.webkitRequestFullscreen();else if(ae.mozRequestFullScreen)ae.mozRequestFullScreen();else if(ae.msRequestFullscreen)ae.msRequestFullscreen();else return!1;return!0},be=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},je=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Te=function(ae,me,xe,Fe){var Je=ae.createShader(ae.VERTEX_SHADER);ae.shaderSource(Je,me),ae.compileShader(Je);var nt=ae.createShader(ae.FRAGMENT_SHADER);ae.shaderSource(nt,xe),ae.compileShader(nt);var qt=ae.createProgram();ae.attachShader(qt,Je),ae.attachShader(qt,nt);for(var Kt in Fe)ae.bindAttribLocation(qt,Fe[Kt],Kt);return ae.linkProgram(qt),ae.deleteShader(Je),ae.deleteShader(nt),qt},rt=function(ae,me){for(var xe={},Fe=ae.getProgramParameter(me,ae.ACTIVE_UNIFORMS),Je="",nt=0;nt<Fe;nt++){var qt=ae.getActiveUniform(me,nt);Je=qt.name.replace("[0]",""),xe[Je]=ae.getUniformLocation(me,Je)}return xe},mt=function(ae,me,xe,Fe,Je,nt,qt){var Kt=1/(me-xe),dt=1/(Fe-Je),Lt=1/(nt-qt);return ae[0]=-2*Kt,ae[1]=0,ae[2]=0,ae[3]=0,ae[4]=0,ae[5]=-2*dt,ae[6]=0,ae[7]=0,ae[8]=0,ae[9]=0,ae[10]=2*Lt,ae[11]=0,ae[12]=(me+xe)*Kt,ae[13]=(Je+Fe)*dt,ae[14]=(qt+nt)*Lt,ae[15]=1,ae},vt=function(){var ae=!1;return function(me){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(me)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(me.substr(0,4)))&&(ae=!0)}(navigator.userAgent||navigator.vendor||window.opera),ae},ft=function(ae,me){for(var xe in me)me.hasOwnProperty(xe)&&(ae[xe]=me[xe]);return ae},Ze=function(ae){if(Y()){var me=ae.style.width,xe=ae.style.height;ae.style.width=parseInt(me)+1+"px",ae.style.height=parseInt(xe)+"px",setTimeout(function(){ae.style.width=me,ae.style.height=xe},100)}window.canvas=ae},St=function(){var ne=Math.PI/180,ae=Math.PI*.25;function me(dt,Lt,on,Nn){var $n=Math.tan(Lt?Lt.upDegrees*ne:ae),ai=Math.tan(Lt?Lt.downDegrees*ne:ae),wi=Math.tan(Lt?Lt.leftDegrees*ne:ae),Ai=Math.tan(Lt?Lt.rightDegrees*ne:ae),ui=2/(wi+Ai),ir=2/($n+ai);return dt[0]=ui,dt[1]=0,dt[2]=0,dt[3]=0,dt[4]=0,dt[5]=ir,dt[6]=0,dt[7]=0,dt[8]=-((wi-Ai)*ui*.5),dt[9]=($n-ai)*ir*.5,dt[10]=Nn/(on-Nn),dt[11]=-1,dt[12]=0,dt[13]=0,dt[14]=Nn*on/(on-Nn),dt[15]=0,dt}function xe(dt,Lt,on){var Nn=Lt[0],$n=Lt[1],ai=Lt[2],wi=Lt[3],Ai=Nn+Nn,ui=$n+$n,ir=ai+ai,Cr=Nn*Ai,jr=Nn*ui,Fr=Nn*ir,As=$n*ui,gs=$n*ir,vs=ai*ir,_s=wi*Ai,ts=wi*ui,Us=wi*ir;return dt[0]=1-(As+vs),dt[1]=jr+Us,dt[2]=Fr-ts,dt[3]=0,dt[4]=jr-Us,dt[5]=1-(Cr+vs),dt[6]=gs+_s,dt[7]=0,dt[8]=Fr+ts,dt[9]=gs-_s,dt[10]=1-(Cr+As),dt[11]=0,dt[12]=on[0],dt[13]=on[1],dt[14]=on[2],dt[15]=1,dt}function Fe(dt,Lt,on){var Nn=on[0],$n=on[1],ai=on[2],wi,Ai,ui,ir,Cr,jr,Fr,As,gs,vs,_s,ts;return Lt===dt?(dt[12]=Lt[0]*Nn+Lt[4]*$n+Lt[8]*ai+Lt[12],dt[13]=Lt[1]*Nn+Lt[5]*$n+Lt[9]*ai+Lt[13],dt[14]=Lt[2]*Nn+Lt[6]*$n+Lt[10]*ai+Lt[14],dt[15]=Lt[3]*Nn+Lt[7]*$n+Lt[11]*ai+Lt[15]):(wi=Lt[0],Ai=Lt[1],ui=Lt[2],ir=Lt[3],Cr=Lt[4],jr=Lt[5],Fr=Lt[6],As=Lt[7],gs=Lt[8],vs=Lt[9],_s=Lt[10],ts=Lt[11],dt[0]=wi,dt[1]=Ai,dt[2]=ui,dt[3]=ir,dt[4]=Cr,dt[5]=jr,dt[6]=Fr,dt[7]=As,dt[8]=gs,dt[9]=vs,dt[10]=_s,dt[11]=ts,dt[12]=wi*Nn+Cr*$n+gs*ai+Lt[12],dt[13]=Ai*Nn+jr*$n+vs*ai+Lt[13],dt[14]=ui*Nn+Fr*$n+_s*ai+Lt[14],dt[15]=ir*Nn+As*$n+ts*ai+Lt[15]),dt}function Je(dt,Lt){var on=Lt[0],Nn=Lt[1],$n=Lt[2],ai=Lt[3],wi=Lt[4],Ai=Lt[5],ui=Lt[6],ir=Lt[7],Cr=Lt[8],jr=Lt[9],Fr=Lt[10],As=Lt[11],gs=Lt[12],vs=Lt[13],_s=Lt[14],ts=Lt[15],Us=on*Ai-Nn*wi,qo=on*ui-$n*wi,pa=on*ir-ai*wi,Da=Nn*ui-$n*Ai,Ll=Nn*ir-ai*Ai,Pl=$n*ir-ai*ui,Dl=Cr*vs-jr*gs,il=Cr*_s-Fr*gs,rl=Cr*ts-As*gs,ro=jr*_s-Fr*vs,sl=jr*ts-As*vs,Zs=Fr*ts-As*_s,rr=Us*Zs-qo*sl+pa*ro+Da*rl-Ll*il+Pl*Dl;return rr?(rr=1/rr,dt[0]=(Ai*Zs-ui*sl+ir*ro)*rr,dt[1]=($n*sl-Nn*Zs-ai*ro)*rr,dt[2]=(vs*Pl-_s*Ll+ts*Da)*rr,dt[3]=(Fr*Ll-jr*Pl-As*Da)*rr,dt[4]=(ui*rl-wi*Zs-ir*il)*rr,dt[5]=(on*Zs-$n*rl+ai*il)*rr,dt[6]=(_s*pa-gs*Pl-ts*qo)*rr,dt[7]=(Cr*Pl-Fr*pa+As*qo)*rr,dt[8]=(wi*sl-Ai*rl+ir*Dl)*rr,dt[9]=(Nn*rl-on*sl-ai*Dl)*rr,dt[10]=(gs*Ll-vs*pa+ts*Us)*rr,dt[11]=(jr*pa-Cr*Ll-As*Us)*rr,dt[12]=(Ai*il-wi*ro-ui*Dl)*rr,dt[13]=(on*ro-Nn*il+$n*Dl)*rr,dt[14]=(vs*qo-gs*Da-_s*Us)*rr,dt[15]=(Cr*Da-jr*qo+Fr*Us)*rr,dt):null}var nt=new Float32Array([0,0,0,1]),qt=new Float32Array([0,0,0]);function Kt(dt,Lt,on,Nn,$n,ai){me(dt,Nn||null,ai.depthNear,ai.depthFar);var wi=on.orientation||nt,Ai=on.position||qt;xe(Lt,wi,Ai),$n&&Fe(Lt,Lt,$n),Je(Lt,Lt)}return function(dt,Lt,on){return!dt||!Lt?!1:(dt.pose=Lt,dt.timestamp=Lt.timestamp,Kt(dt.leftProjectionMatrix,dt.leftViewMatrix,Lt,on._getFieldOfView("left"),on._getEyeOffset("left"),on),Kt(dt.rightProjectionMatrix,dt.rightViewMatrix,Lt,on._getFieldOfView("right"),on._getEyeOffset("right"),on),!0)}}(),$t=function(){var ae=window.self!==window.top,me=ct(document.referrer),xe=ct(window.location.href);return ae&&me!==xe},ct=function(ae){var me,xe=ae.indexOf("://");xe!==-1?me=xe+3:me=0;var Fe=ae.indexOf("/",me);return Fe===-1&&(Fe=ae.length),ae.substring(0,Fe)},Ct=function(ae){if(ae.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var me=2*Math.acos(ae.w);return me},Tt=function(){var ne={};return function(ae,me){ne[ae]===void 0&&(console.warn("webvr-polyfill: "+me),ne[ae]=!0)}}(),At=function(ae,me){var xe=me?"Please use "+me+" instead.":"";Tt(ae,ae+" has been deprecated. This may not work on native WebVR displays. "+xe)};function pn(ne,ae,me){if(!ae){me(ne);return}for(var xe=[],Fe=null,Je=0;Je<ae.length;++Je){var nt=ae[Je];switch(nt){case ne.TEXTURE_BINDING_2D:case ne.TEXTURE_BINDING_CUBE_MAP:var qt=ae[++Je];if(qt<ne.TEXTURE0||qt>ne.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),xe.push(null,null);break}Fe||(Fe=ne.getParameter(ne.ACTIVE_TEXTURE)),ne.activeTexture(qt),xe.push(ne.getParameter(nt),null);break;case ne.ACTIVE_TEXTURE:Fe=ne.getParameter(ne.ACTIVE_TEXTURE),xe.push(null);break;default:xe.push(ne.getParameter(nt));break}}me(ne);for(var Je=0;Je<ae.length;++Je){var nt=ae[Je],Kt=xe[Je];switch(nt){case ne.ACTIVE_TEXTURE:break;case ne.ARRAY_BUFFER_BINDING:ne.bindBuffer(ne.ARRAY_BUFFER,Kt);break;case ne.COLOR_CLEAR_VALUE:ne.clearColor(Kt[0],Kt[1],Kt[2],Kt[3]);break;case ne.COLOR_WRITEMASK:ne.colorMask(Kt[0],Kt[1],Kt[2],Kt[3]);break;case ne.CURRENT_PROGRAM:ne.useProgram(Kt);break;case ne.ELEMENT_ARRAY_BUFFER_BINDING:ne.bindBuffer(ne.ELEMENT_ARRAY_BUFFER,Kt);break;case ne.FRAMEBUFFER_BINDING:ne.bindFramebuffer(ne.FRAMEBUFFER,Kt);break;case ne.RENDERBUFFER_BINDING:ne.bindRenderbuffer(ne.RENDERBUFFER,Kt);break;case ne.TEXTURE_BINDING_2D:var qt=ae[++Je];if(qt<ne.TEXTURE0||qt>ne.TEXTURE31)break;ne.activeTexture(qt),ne.bindTexture(ne.TEXTURE_2D,Kt);break;case ne.TEXTURE_BINDING_CUBE_MAP:var qt=ae[++Je];if(qt<ne.TEXTURE0||qt>ne.TEXTURE31)break;ne.activeTexture(qt),ne.bindTexture(ne.TEXTURE_CUBE_MAP,Kt);break;case ne.VIEWPORT:ne.viewport(Kt[0],Kt[1],Kt[2],Kt[3]);break;case ne.BLEND:case ne.CULL_FACE:case ne.DEPTH_TEST:case ne.SCISSOR_TEST:case ne.STENCIL_TEST:Kt?ne.enable(nt):ne.disable(nt);break;default:console.log("No GL restore behavior for 0x"+nt.toString(16));break}Fe&&ne.activeTexture(Fe)}}var yt=pn,kn=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),qn=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function Gt(ne,ae,me,xe){this.gl=ne,this.cardboardUI=ae,this.bufferScale=me,this.dirtySubmitFrameBindings=xe,this.ctxAttribs=ne.getContextAttributes(),this.instanceExt=ne.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=ne.drawingBufferWidth,this.bufferHeight=ne.drawingBufferHeight,this.realBindFramebuffer=ne.bindFramebuffer,this.realEnable=ne.enable,this.realDisable=ne.disable,this.realColorMask=ne.colorMask,this.realClearColor=ne.clearColor,this.realViewport=ne.viewport,Y()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(ne.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(ne.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Te(ne,kn,qn,this.attribs),this.uniforms=rt(ne,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=ne.createBuffer(),this.indexBuffer=ne.createBuffer(),this.indexCount=0,this.renderTarget=ne.createTexture(),this.framebuffer=ne.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=ne.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=ne.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=ne.createRenderbuffer()),this.patch(),this.onResize()}Gt.prototype.destroy=function(){var ne=this.gl;this.unpatch(),ne.deleteProgram(this.program),ne.deleteBuffer(this.vertexBuffer),ne.deleteBuffer(this.indexBuffer),ne.deleteTexture(this.renderTarget),ne.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&ne.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&ne.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&ne.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},Gt.prototype.onResize=function(){var ne=this.gl,ae=this,me=[ne.RENDERBUFFER_BINDING,ne.TEXTURE_BINDING_2D,ne.TEXTURE0];yt(ne,me,function(xe){ae.realBindFramebuffer.call(xe,xe.FRAMEBUFFER,null),ae.scissorTest&&ae.realDisable.call(xe,xe.SCISSOR_TEST),ae.realColorMask.call(xe,!0,!0,!0,!0),ae.realViewport.call(xe,0,0,xe.drawingBufferWidth,xe.drawingBufferHeight),ae.realClearColor.call(xe,0,0,0,1),xe.clear(xe.COLOR_BUFFER_BIT),ae.realBindFramebuffer.call(xe,xe.FRAMEBUFFER,ae.framebuffer),xe.bindTexture(xe.TEXTURE_2D,ae.renderTarget),xe.texImage2D(xe.TEXTURE_2D,0,ae.ctxAttribs.alpha?xe.RGBA:xe.RGB,ae.bufferWidth,ae.bufferHeight,0,ae.ctxAttribs.alpha?xe.RGBA:xe.RGB,xe.UNSIGNED_BYTE,null),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.framebufferTexture2D(xe.FRAMEBUFFER,xe.COLOR_ATTACHMENT0,xe.TEXTURE_2D,ae.renderTarget,0),ae.ctxAttribs.depth&&ae.ctxAttribs.stencil?(xe.bindRenderbuffer(xe.RENDERBUFFER,ae.depthStencilBuffer),xe.renderbufferStorage(xe.RENDERBUFFER,xe.DEPTH_STENCIL,ae.bufferWidth,ae.bufferHeight),xe.framebufferRenderbuffer(xe.FRAMEBUFFER,xe.DEPTH_STENCIL_ATTACHMENT,xe.RENDERBUFFER,ae.depthStencilBuffer)):ae.ctxAttribs.depth?(xe.bindRenderbuffer(xe.RENDERBUFFER,ae.depthBuffer),xe.renderbufferStorage(xe.RENDERBUFFER,xe.DEPTH_COMPONENT16,ae.bufferWidth,ae.bufferHeight),xe.framebufferRenderbuffer(xe.FRAMEBUFFER,xe.DEPTH_ATTACHMENT,xe.RENDERBUFFER,ae.depthBuffer)):ae.ctxAttribs.stencil&&(xe.bindRenderbuffer(xe.RENDERBUFFER,ae.stencilBuffer),xe.renderbufferStorage(xe.RENDERBUFFER,xe.STENCIL_INDEX8,ae.bufferWidth,ae.bufferHeight),xe.framebufferRenderbuffer(xe.FRAMEBUFFER,xe.STENCIL_ATTACHMENT,xe.RENDERBUFFER,ae.stencilBuffer)),!xe.checkFramebufferStatus(xe.FRAMEBUFFER)===xe.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),ae.realBindFramebuffer.call(xe,xe.FRAMEBUFFER,ae.lastBoundFramebuffer),ae.scissorTest&&ae.realEnable.call(xe,xe.SCISSOR_TEST),ae.realColorMask.apply(xe,ae.colorMask),ae.realViewport.apply(xe,ae.viewport),ae.realClearColor.apply(xe,ae.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},Gt.prototype.patch=function(){if(!this.isPatched){var ne=this,ae=this.gl.canvas,me=this.gl;Y()||(ae.width=Pe()*this.bufferScale,ae.height=Se()*this.bufferScale,Object.defineProperty(ae,"width",{configurable:!0,enumerable:!0,get:function(){return ne.bufferWidth},set:function(Fe){ne.bufferWidth=Fe,ne.realCanvasWidth.set.call(ae,Fe),ne.onResize()}}),Object.defineProperty(ae,"height",{configurable:!0,enumerable:!0,get:function(){return ne.bufferHeight},set:function(Fe){ne.bufferHeight=Fe,ne.realCanvasHeight.set.call(ae,Fe),ne.onResize()}})),this.lastBoundFramebuffer=me.getParameter(me.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(me.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(xe,Fe){ne.lastBoundFramebuffer=Fe||ne.framebuffer,ne.realBindFramebuffer.call(me,xe,ne.lastBoundFramebuffer)},this.cullFace=me.getParameter(me.CULL_FACE),this.depthTest=me.getParameter(me.DEPTH_TEST),this.blend=me.getParameter(me.BLEND),this.scissorTest=me.getParameter(me.SCISSOR_TEST),this.stencilTest=me.getParameter(me.STENCIL_TEST),me.enable=function(xe){switch(xe){case me.CULL_FACE:ne.cullFace=!0;break;case me.DEPTH_TEST:ne.depthTest=!0;break;case me.BLEND:ne.blend=!0;break;case me.SCISSOR_TEST:ne.scissorTest=!0;break;case me.STENCIL_TEST:ne.stencilTest=!0;break}ne.realEnable.call(me,xe)},me.disable=function(xe){switch(xe){case me.CULL_FACE:ne.cullFace=!1;break;case me.DEPTH_TEST:ne.depthTest=!1;break;case me.BLEND:ne.blend=!1;break;case me.SCISSOR_TEST:ne.scissorTest=!1;break;case me.STENCIL_TEST:ne.stencilTest=!1;break}ne.realDisable.call(me,xe)},this.colorMask=me.getParameter(me.COLOR_WRITEMASK),me.colorMask=function(xe,Fe,Je,nt){ne.colorMask[0]=xe,ne.colorMask[1]=Fe,ne.colorMask[2]=Je,ne.colorMask[3]=nt,ne.realColorMask.call(me,xe,Fe,Je,nt)},this.clearColor=me.getParameter(me.COLOR_CLEAR_VALUE),me.clearColor=function(xe,Fe,Je,nt){ne.clearColor[0]=xe,ne.clearColor[1]=Fe,ne.clearColor[2]=Je,ne.clearColor[3]=nt,ne.realClearColor.call(me,xe,Fe,Je,nt)},this.viewport=me.getParameter(me.VIEWPORT),me.viewport=function(xe,Fe,Je,nt){ne.viewport[0]=xe,ne.viewport[1]=Fe,ne.viewport[2]=Je,ne.viewport[3]=nt,ne.realViewport.call(me,xe,Fe,Je,nt)},this.isPatched=!0,Ze(ae)}},Gt.prototype.unpatch=function(){if(this.isPatched){var ne=this.gl,ae=this.gl.canvas;Y()||(Object.defineProperty(ae,"width",this.realCanvasWidth),Object.defineProperty(ae,"height",this.realCanvasHeight)),ae.width=this.bufferWidth,ae.height=this.bufferHeight,ne.bindFramebuffer=this.realBindFramebuffer,ne.enable=this.realEnable,ne.disable=this.realDisable,ne.colorMask=this.realColorMask,ne.clearColor=this.realClearColor,ne.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&ne.bindFramebuffer(ne.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){Ze(ae)},1)}},Gt.prototype.setTextureBounds=function(ne,ae){ne||(ne=[0,0,.5,1]),ae||(ae=[.5,0,.5,1]),this.viewportOffsetScale[0]=ne[0],this.viewportOffsetScale[1]=ne[1],this.viewportOffsetScale[2]=ne[2],this.viewportOffsetScale[3]=ne[3],this.viewportOffsetScale[4]=ae[0],this.viewportOffsetScale[5]=ae[1],this.viewportOffsetScale[6]=ae[2],this.viewportOffsetScale[7]=ae[3]},Gt.prototype.submitFrame=function(){var ne=this.gl,ae=this,me=[];if(this.dirtySubmitFrameBindings||me.push(ne.CURRENT_PROGRAM,ne.ARRAY_BUFFER_BINDING,ne.ELEMENT_ARRAY_BUFFER_BINDING,ne.TEXTURE_BINDING_2D,ne.TEXTURE0),yt(ne,me,function(Fe){ae.realBindFramebuffer.call(Fe,Fe.FRAMEBUFFER,null);var Je=0,nt=0;ae.instanceExt&&(Je=Fe.getVertexAttrib(ae.attribs.position,ae.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),nt=Fe.getVertexAttrib(ae.attribs.texCoord,ae.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),ae.cullFace&&ae.realDisable.call(Fe,Fe.CULL_FACE),ae.depthTest&&ae.realDisable.call(Fe,Fe.DEPTH_TEST),ae.blend&&ae.realDisable.call(Fe,Fe.BLEND),ae.scissorTest&&ae.realDisable.call(Fe,Fe.SCISSOR_TEST),ae.stencilTest&&ae.realDisable.call(Fe,Fe.STENCIL_TEST),ae.realColorMask.call(Fe,!0,!0,!0,!0),ae.realViewport.call(Fe,0,0,Fe.drawingBufferWidth,Fe.drawingBufferHeight),(ae.ctxAttribs.alpha||Y())&&(ae.realClearColor.call(Fe,0,0,0,1),Fe.clear(Fe.COLOR_BUFFER_BIT)),Fe.useProgram(ae.program),Fe.bindBuffer(Fe.ELEMENT_ARRAY_BUFFER,ae.indexBuffer),Fe.bindBuffer(Fe.ARRAY_BUFFER,ae.vertexBuffer),Fe.enableVertexAttribArray(ae.attribs.position),Fe.enableVertexAttribArray(ae.attribs.texCoord),Fe.vertexAttribPointer(ae.attribs.position,2,Fe.FLOAT,!1,20,0),Fe.vertexAttribPointer(ae.attribs.texCoord,3,Fe.FLOAT,!1,20,8),ae.instanceExt&&(Je!=0&&ae.instanceExt.vertexAttribDivisorANGLE(ae.attribs.position,0),nt!=0&&ae.instanceExt.vertexAttribDivisorANGLE(ae.attribs.texCoord,0)),Fe.activeTexture(Fe.TEXTURE0),Fe.uniform1i(ae.uniforms.diffuse,0),Fe.bindTexture(Fe.TEXTURE_2D,ae.renderTarget),Fe.uniform4fv(ae.uniforms.viewportOffsetScale,ae.viewportOffsetScale),Fe.drawElements(Fe.TRIANGLES,ae.indexCount,Fe.UNSIGNED_SHORT,0),ae.cardboardUI&&ae.cardboardUI.renderNoState(),ae.realBindFramebuffer.call(ae.gl,Fe.FRAMEBUFFER,ae.framebuffer),ae.ctxAttribs.preserveDrawingBuffer||(ae.realClearColor.call(Fe,0,0,0,0),Fe.clear(Fe.COLOR_BUFFER_BIT)),ae.dirtySubmitFrameBindings||ae.realBindFramebuffer.call(Fe,Fe.FRAMEBUFFER,ae.lastBoundFramebuffer),ae.cullFace&&ae.realEnable.call(Fe,Fe.CULL_FACE),ae.depthTest&&ae.realEnable.call(Fe,Fe.DEPTH_TEST),ae.blend&&ae.realEnable.call(Fe,Fe.BLEND),ae.scissorTest&&ae.realEnable.call(Fe,Fe.SCISSOR_TEST),ae.stencilTest&&ae.realEnable.call(Fe,Fe.STENCIL_TEST),ae.realColorMask.apply(Fe,ae.colorMask),ae.realViewport.apply(Fe,ae.viewport),(ae.ctxAttribs.alpha||!ae.ctxAttribs.preserveDrawingBuffer)&&ae.realClearColor.apply(Fe,ae.clearColor),ae.instanceExt&&(Je!=0&&ae.instanceExt.vertexAttribDivisorANGLE(ae.attribs.position,Je),nt!=0&&ae.instanceExt.vertexAttribDivisorANGLE(ae.attribs.texCoord,nt))}),Y()){var xe=ne.canvas;(xe.width!=ae.bufferWidth||xe.height!=ae.bufferHeight)&&(ae.bufferWidth=xe.width,ae.bufferHeight=xe.height,ae.onResize())}},Gt.prototype.updateDeviceInfo=function(ne){var ae=this.gl,me=this,xe=[ae.ARRAY_BUFFER_BINDING,ae.ELEMENT_ARRAY_BUFFER_BINDING];yt(ae,xe,function(Fe){var Je=me.computeMeshVertices_(me.meshWidth,me.meshHeight,ne);if(Fe.bindBuffer(Fe.ARRAY_BUFFER,me.vertexBuffer),Fe.bufferData(Fe.ARRAY_BUFFER,Je,Fe.STATIC_DRAW),!me.indexCount){var nt=me.computeMeshIndices_(me.meshWidth,me.meshHeight);Fe.bindBuffer(Fe.ELEMENT_ARRAY_BUFFER,me.indexBuffer),Fe.bufferData(Fe.ELEMENT_ARRAY_BUFFER,nt,Fe.STATIC_DRAW),me.indexCount=nt.length}})},Gt.prototype.computeMeshVertices_=function(ne,ae,me){for(var xe=new Float32Array(2*ne*ae*5),Fe=me.getLeftEyeVisibleTanAngles(),Je=me.getLeftEyeNoLensTanAngles(),nt=me.getLeftEyeVisibleScreenRect(Je),qt=0,Kt=0;Kt<2;Kt++){for(var dt=0;dt<ae;dt++)for(var Lt=0;Lt<ne;Lt++,qt++){var on=Lt/(ne-1),Nn=dt/(ae-1),$n=on,ai=Nn,wi=H(Fe[0],Fe[2],on),Ai=H(Fe[3],Fe[1],Nn),ui=Math.sqrt(wi*wi+Ai*Ai),ir=me.distortion.distortInverse(ui),Cr=wi*ir/ui,jr=Ai*ir/ui;on=(Cr-Je[0])/(Je[2]-Je[0]),Nn=(jr-Je[3])/(Je[1]-Je[3]),on=(nt.x+on*nt.width-.5)*2,Nn=(nt.y+Nn*nt.height-.5)*2,xe[qt*5+0]=on,xe[qt*5+1]=Nn,xe[qt*5+2]=$n,xe[qt*5+3]=ai,xe[qt*5+4]=Kt}var Fr=Fe[2]-Fe[0];Fe[0]=-(Fr+Fe[0]),Fe[2]=Fr-Fe[2],Fr=Je[2]-Je[0],Je[0]=-(Fr+Je[0]),Je[2]=Fr-Je[2],nt.x=1-(nt.x+nt.width)}return xe},Gt.prototype.computeMeshIndices_=function(ne,ae){for(var me=new Uint16Array(2*(ne-1)*(ae-1)*6),xe=ne/2,Fe=ae/2,Je=0,nt=0,qt=0;qt<2;qt++)for(var Kt=0;Kt<ae;Kt++)for(var dt=0;dt<ne;dt++,Je++)dt==0||Kt==0||(dt<=xe==Kt<=Fe?(me[nt++]=Je,me[nt++]=Je-ne-1,me[nt++]=Je-ne,me[nt++]=Je-ne-1,me[nt++]=Je,me[nt++]=Je-1):(me[nt++]=Je-1,me[nt++]=Je-ne,me[nt++]=Je,me[nt++]=Je-ne,me[nt++]=Je-1,me[nt++]=Je-ne-1));return me},Gt.prototype.getOwnPropertyDescriptor_=function(ne,ae){var me=Object.getOwnPropertyDescriptor(ne,ae);return(me.get===void 0||me.set===void 0)&&(me.configurable=!0,me.enumerable=!0,me.get=function(){return this.getAttribute(ae)},me.set=function(xe){this.setAttribute(ae,xe)}),me};var bt=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),ye=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),_e=Math.PI/180,Ue=60,Re=12,Ce=20,Ne=1,le=.75,j=.3125,Z=4,pe=28,Ee=1.5;function Qe(ne){this.gl=ne,this.attribs={position:0},this.program=Te(ne,bt,ye,this.attribs),this.uniforms=rt(ne,this.program),this.vertexBuffer=ne.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Qe.prototype.destroy=function(){var ne=this.gl;this.listener&&ne.canvas.removeEventListener("click",this.listener,!1),ne.deleteProgram(this.program),ne.deleteBuffer(this.vertexBuffer)},Qe.prototype.listen=function(ne,ae){var me=this.gl.canvas;this.listener=function(xe){var Fe=me.clientWidth/2,Je=pe*Ee;xe.clientX>Fe-Je&&xe.clientX<Fe+Je&&xe.clientY>me.clientHeight-Je?ne(xe):xe.clientX<Je&&xe.clientY<Je&&ae(xe)},me.addEventListener("click",this.listener,!1)},Qe.prototype.onResize=function(){var ne=this.gl,ae=this,me=[ne.ARRAY_BUFFER_BINDING];yt(ne,me,function(xe){var Fe=[],Je=xe.drawingBufferWidth/2,nt=Math.max(screen.width,screen.height)*window.devicePixelRatio,qt=xe.drawingBufferWidth/nt,Kt=qt*window.devicePixelRatio,dt=Z*Kt/2,Lt=pe*Ee*Kt,on=pe*Kt/2,Nn=(pe*Ee-pe)*Kt;Fe.push(Je-dt,Lt),Fe.push(Je-dt,xe.drawingBufferHeight),Fe.push(Je+dt,Lt),Fe.push(Je+dt,xe.drawingBufferHeight),ae.gearOffset=Fe.length/2;function $n(ir,Cr){var jr=(90-ir)*_e,Fr=Math.cos(jr),As=Math.sin(jr);Fe.push(j*Fr*on+Je,j*As*on+on),Fe.push(Cr*Fr*on+Je,Cr*As*on+on)}for(var ai=0;ai<=6;ai++){var wi=ai*Ue;$n(wi,Ne),$n(wi+Re,Ne),$n(wi+Ce,le),$n(wi+(Ue-Ce),le),$n(wi+(Ue-Re),Ne)}ae.gearVertexCount=Fe.length/2-ae.gearOffset,ae.arrowOffset=Fe.length/2;function Ai(ir,Cr){Fe.push(Nn+ir,xe.drawingBufferHeight-Nn-Cr)}var ui=dt/Math.sin(45*_e);Ai(0,on),Ai(on,0),Ai(on+ui,ui),Ai(ui,on+ui),Ai(ui,on-ui),Ai(0,on),Ai(on,on*2),Ai(on+ui,on*2-ui),Ai(ui,on-ui),Ai(0,on),Ai(ui,on-dt),Ai(pe*Kt,on-dt),Ai(ui,on+dt),Ai(pe*Kt,on+dt),ae.arrowVertexCount=Fe.length/2-ae.arrowOffset,xe.bindBuffer(xe.ARRAY_BUFFER,ae.vertexBuffer),xe.bufferData(xe.ARRAY_BUFFER,new Float32Array(Fe),xe.STATIC_DRAW)})},Qe.prototype.render=function(){var ne=this.gl,ae=this,me=[ne.CULL_FACE,ne.DEPTH_TEST,ne.BLEND,ne.SCISSOR_TEST,ne.STENCIL_TEST,ne.COLOR_WRITEMASK,ne.VIEWPORT,ne.CURRENT_PROGRAM,ne.ARRAY_BUFFER_BINDING];yt(ne,me,function(xe){xe.disable(xe.CULL_FACE),xe.disable(xe.DEPTH_TEST),xe.disable(xe.BLEND),xe.disable(xe.SCISSOR_TEST),xe.disable(xe.STENCIL_TEST),xe.colorMask(!0,!0,!0,!0),xe.viewport(0,0,xe.drawingBufferWidth,xe.drawingBufferHeight),ae.renderNoState()})},Qe.prototype.renderNoState=function(){var ne=this.gl;ne.useProgram(this.program),ne.bindBuffer(ne.ARRAY_BUFFER,this.vertexBuffer),ne.enableVertexAttribArray(this.attribs.position),ne.vertexAttribPointer(this.attribs.position,2,ne.FLOAT,!1,8,0),ne.uniform4f(this.uniforms.color,1,1,1,1),mt(this.projMat,0,ne.drawingBufferWidth,0,ne.drawingBufferHeight,.1,1024),ne.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),ne.drawArrays(ne.TRIANGLE_STRIP,0,4),ne.drawArrays(ne.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),ne.drawArrays(ne.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function He(ne){this.coefficients=ne}He.prototype.distortInverse=function(ne){for(var ae=0,me=1,xe=ne-this.distort(ae);Math.abs(me-ae)>1e-4;){var Fe=ne-this.distort(me),Je=me-Fe*((me-ae)/(Fe-xe));ae=me,me=Je,xe=Fe}return me},He.prototype.distort=function(ne){for(var ae=ne*ne,me=0,xe=0;xe<this.coefficients.length;xe++)me=ae*(me+this.coefficients[xe]);return(me+1)*ne};var Pt=Math.PI/180,rn=180/Math.PI,Xt=function(ae,me,xe){this.x=ae||0,this.y=me||0,this.z=xe||0};Xt.prototype={constructor:Xt,set:function(ae,me,xe){return this.x=ae,this.y=me,this.z=xe,this},copy:function(ae){return this.x=ae.x,this.y=ae.y,this.z=ae.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var ae=this.length();if(ae!==0){var me=1/ae;this.multiplyScalar(me)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(ae){this.x*=ae,this.y*=ae,this.z*=ae},applyQuaternion:function(ae){var me=this.x,xe=this.y,Fe=this.z,Je=ae.x,nt=ae.y,qt=ae.z,Kt=ae.w,dt=Kt*me+nt*Fe-qt*xe,Lt=Kt*xe+qt*me-Je*Fe,on=Kt*Fe+Je*xe-nt*me,Nn=-Je*me-nt*xe-qt*Fe;return this.x=dt*Kt+Nn*-Je+Lt*-qt-on*-nt,this.y=Lt*Kt+Nn*-nt+on*-Je-dt*-qt,this.z=on*Kt+Nn*-qt+dt*-nt-Lt*-Je,this},dot:function(ae){return this.x*ae.x+this.y*ae.y+this.z*ae.z},crossVectors:function(ae,me){var xe=ae.x,Fe=ae.y,Je=ae.z,nt=me.x,qt=me.y,Kt=me.z;return this.x=Fe*Kt-Je*qt,this.y=Je*nt-xe*Kt,this.z=xe*qt-Fe*nt,this}};var st=function(ae,me,xe,Fe){this.x=ae||0,this.y=me||0,this.z=xe||0,this.w=Fe!==void 0?Fe:1};st.prototype={constructor:st,set:function(ae,me,xe,Fe){return this.x=ae,this.y=me,this.z=xe,this.w=Fe,this},copy:function(ae){return this.x=ae.x,this.y=ae.y,this.z=ae.z,this.w=ae.w,this},setFromEulerXYZ:function(ae,me,xe){var Fe=Math.cos(ae/2),Je=Math.cos(me/2),nt=Math.cos(xe/2),qt=Math.sin(ae/2),Kt=Math.sin(me/2),dt=Math.sin(xe/2);return this.x=qt*Je*nt+Fe*Kt*dt,this.y=Fe*Kt*nt-qt*Je*dt,this.z=Fe*Je*dt+qt*Kt*nt,this.w=Fe*Je*nt-qt*Kt*dt,this},setFromEulerYXZ:function(ae,me,xe){var Fe=Math.cos(ae/2),Je=Math.cos(me/2),nt=Math.cos(xe/2),qt=Math.sin(ae/2),Kt=Math.sin(me/2),dt=Math.sin(xe/2);return this.x=qt*Je*nt+Fe*Kt*dt,this.y=Fe*Kt*nt-qt*Je*dt,this.z=Fe*Je*dt-qt*Kt*nt,this.w=Fe*Je*nt+qt*Kt*dt,this},setFromAxisAngle:function(ae,me){var xe=me/2,Fe=Math.sin(xe);return this.x=ae.x*Fe,this.y=ae.y*Fe,this.z=ae.z*Fe,this.w=Math.cos(xe),this},multiply:function(ae){return this.multiplyQuaternions(this,ae)},multiplyQuaternions:function(ae,me){var xe=ae.x,Fe=ae.y,Je=ae.z,nt=ae.w,qt=me.x,Kt=me.y,dt=me.z,Lt=me.w;return this.x=xe*Lt+nt*qt+Fe*dt-Je*Kt,this.y=Fe*Lt+nt*Kt+Je*qt-xe*dt,this.z=Je*Lt+nt*dt+xe*Kt-Fe*qt,this.w=nt*Lt-xe*qt-Fe*Kt-Je*dt,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var ae=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return ae===0?(this.x=0,this.y=0,this.z=0,this.w=1):(ae=1/ae,this.x=this.x*ae,this.y=this.y*ae,this.z=this.z*ae,this.w=this.w*ae),this},slerp:function(ae,me){if(me===0)return this;if(me===1)return this.copy(ae);var xe=this.x,Fe=this.y,Je=this.z,nt=this.w,qt=nt*ae.w+xe*ae.x+Fe*ae.y+Je*ae.z;if(qt<0?(this.w=-ae.w,this.x=-ae.x,this.y=-ae.y,this.z=-ae.z,qt=-qt):this.copy(ae),qt>=1)return this.w=nt,this.x=xe,this.y=Fe,this.z=Je,this;var Kt=Math.acos(qt),dt=Math.sqrt(1-qt*qt);if(Math.abs(dt)<.001)return this.w=.5*(nt+this.w),this.x=.5*(xe+this.x),this.y=.5*(Fe+this.y),this.z=.5*(Je+this.z),this;var Lt=Math.sin((1-me)*Kt)/dt,on=Math.sin(me*Kt)/dt;return this.w=nt*Lt+this.w*on,this.x=xe*Lt+this.x*on,this.y=Fe*Lt+this.y*on,this.z=Je*Lt+this.z*on,this},setFromUnitVectors:function(){var ne,ae,me=1e-6;return function(xe,Fe){return ne===void 0&&(ne=new Xt),ae=xe.dot(Fe)+1,ae<me?(ae=0,Math.abs(xe.x)>Math.abs(xe.z)?ne.set(-xe.y,xe.x,0):ne.set(0,-xe.z,xe.y)):ne.crossVectors(xe,Fe),this.x=ne.x,this.y=ne.y,this.z=ne.z,this.w=ae,this.normalize(),this}}()};function An(ne){this.width=ne.width||Pe(),this.height=ne.height||Se(),this.widthMeters=ne.widthMeters,this.heightMeters=ne.heightMeters,this.bevelMeters=ne.bevelMeters}var Vt=new An({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),Dn=new An({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Qr={CardboardV1:new _r({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new _r({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function nr(ne,ae){this.viewer=Qr.CardboardV2,this.updateDeviceParams(ne),this.distortion=new He(this.viewer.distortionCoefficients);for(var me=0;me<ae.length;me++){var xe=ae[me];Qr[xe.id]=new _r(xe)}}nr.prototype.updateDeviceParams=function(ne){this.device=this.determineDevice_(ne)||this.device},nr.prototype.getDevice=function(){return this.device},nr.prototype.setViewer=function(ne){this.viewer=ne,this.distortion=new He(this.viewer.distortionCoefficients)},nr.prototype.determineDevice_=function(ne){if(!ne)return Y()?(console.warn("Using fallback iOS device measurements."),Dn):(console.warn("Using fallback Android device measurements."),Vt);var ae=.0254,me=ae/ne.xdpi,xe=ae/ne.ydpi,Fe=Pe(),Je=Se();return new An({widthMeters:me*Fe,heightMeters:xe*Je,bevelMeters:ne.bevelMm*.001})},nr.prototype.getDistortedFieldOfViewLeftEye=function(){var ne=this.viewer,ae=this.device,me=this.distortion,xe=ne.screenLensDistance,Fe=(ae.widthMeters-ne.interLensDistance)/2,Je=ne.interLensDistance/2,nt=ne.baselineLensDistance-ae.bevelMeters,qt=ae.heightMeters-nt,Kt=rn*Math.atan(me.distort(Fe/xe)),dt=rn*Math.atan(me.distort(Je/xe)),Lt=rn*Math.atan(me.distort(nt/xe)),on=rn*Math.atan(me.distort(qt/xe));return{leftDegrees:Math.min(Kt,ne.fov),rightDegrees:Math.min(dt,ne.fov),downDegrees:Math.min(Lt,ne.fov),upDegrees:Math.min(on,ne.fov)}},nr.prototype.getLeftEyeVisibleTanAngles=function(){var ne=this.viewer,ae=this.device,me=this.distortion,xe=Math.tan(-Pt*ne.fov),Fe=Math.tan(Pt*ne.fov),Je=Math.tan(Pt*ne.fov),nt=Math.tan(-Pt*ne.fov),qt=ae.widthMeters/4,Kt=ae.heightMeters/2,dt=ne.baselineLensDistance-ae.bevelMeters-Kt,Lt=ne.interLensDistance/2-qt,on=-dt,Nn=ne.screenLensDistance,$n=me.distort((Lt-qt)/Nn),ai=me.distort((on+Kt)/Nn),wi=me.distort((Lt+qt)/Nn),Ai=me.distort((on-Kt)/Nn),ui=new Float32Array(4);return ui[0]=Math.max(xe,$n),ui[1]=Math.min(Fe,ai),ui[2]=Math.min(Je,wi),ui[3]=Math.max(nt,Ai),ui},nr.prototype.getLeftEyeNoLensTanAngles=function(){var ne=this.viewer,ae=this.device,me=this.distortion,xe=new Float32Array(4),Fe=me.distortInverse(Math.tan(-Pt*ne.fov)),Je=me.distortInverse(Math.tan(Pt*ne.fov)),nt=me.distortInverse(Math.tan(Pt*ne.fov)),qt=me.distortInverse(Math.tan(-Pt*ne.fov)),Kt=ae.widthMeters/4,dt=ae.heightMeters/2,Lt=ne.baselineLensDistance-ae.bevelMeters-dt,on=ne.interLensDistance/2-Kt,Nn=-Lt,$n=ne.screenLensDistance,ai=(on-Kt)/$n,wi=(Nn+dt)/$n,Ai=(on+Kt)/$n,ui=(Nn-dt)/$n;return xe[0]=Math.max(Fe,ai),xe[1]=Math.min(Je,wi),xe[2]=Math.min(nt,Ai),xe[3]=Math.max(qt,ui),xe},nr.prototype.getLeftEyeVisibleScreenRect=function(ne){var ae=this.viewer,me=this.device,xe=ae.screenLensDistance,Fe=(me.widthMeters-ae.interLensDistance)/2,Je=ae.baselineLensDistance-me.bevelMeters,nt=(ne[0]*xe+Fe)/me.widthMeters,qt=(ne[1]*xe+Je)/me.heightMeters,Kt=(ne[2]*xe+Fe)/me.widthMeters,dt=(ne[3]*xe+Je)/me.heightMeters;return{x:nt,y:dt,width:Kt-nt,height:qt-dt}},nr.prototype.getFieldOfViewLeftEye=function(ne){return ne?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},nr.prototype.getFieldOfViewRightEye=function(ne){var ae=this.getFieldOfViewLeftEye(ne);return{leftDegrees:ae.rightDegrees,rightDegrees:ae.leftDegrees,upDegrees:ae.upDegrees,downDegrees:ae.downDegrees}},nr.prototype.getUndistortedFieldOfViewLeftEye=function(){var ne=this.getUndistortedParams_();return{leftDegrees:rn*Math.atan(ne.outerDist),rightDegrees:rn*Math.atan(ne.innerDist),downDegrees:rn*Math.atan(ne.bottomDist),upDegrees:rn*Math.atan(ne.topDist)}},nr.prototype.getUndistortedViewportLeftEye=function(){var ne=this.getUndistortedParams_(),ae=this.viewer,me=this.device,xe=ae.screenLensDistance,Fe=me.widthMeters/xe,Je=me.heightMeters/xe,nt=me.width/Fe,qt=me.height/Je,Kt=Math.round((ne.eyePosX-ne.outerDist)*nt),dt=Math.round((ne.eyePosY-ne.bottomDist)*qt);return{x:Kt,y:dt,width:Math.round((ne.eyePosX+ne.innerDist)*nt)-Kt,height:Math.round((ne.eyePosY+ne.topDist)*qt)-dt}},nr.prototype.getUndistortedParams_=function(){var ne=this.viewer,ae=this.device,me=this.distortion,xe=ne.screenLensDistance,Fe=ne.interLensDistance/2/xe,Je=ae.widthMeters/xe,nt=ae.heightMeters/xe,qt=Je/2-Fe,Kt=(ne.baselineLensDistance-ae.bevelMeters)/xe,dt=ne.fov,Lt=me.distortInverse(Math.tan(Pt*dt)),on=Math.min(qt,Lt),Nn=Math.min(Fe,Lt),$n=Math.min(Kt,Lt),ai=Math.min(nt-Kt,Lt);return{outerDist:on,innerDist:Nn,topDist:ai,bottomDist:$n,eyePosX:qt,eyePosY:Kt}};function _r(ne){this.id=ne.id,this.label=ne.label,this.fov=ne.fov,this.interLensDistance=ne.interLensDistance,this.baselineLensDistance=ne.baselineLensDistance,this.screenLensDistance=ne.screenLensDistance,this.distortionCoefficients=ne.distortionCoefficients,this.inverseCoefficients=ne.inverseCoefficients}nr.Viewers=Qr;var Po=1,Hr="2019-11-09T17:36:14Z",fa=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],ds={format:Po,last_updated:Hr,devices:fa};function go(ne,ae){if(this.dpdb=ds,this.recalculateDeviceParams_(),ne){this.onDeviceParamsUpdated=ae;var me=new XMLHttpRequest,xe=this;me.open("GET",ne,!0),me.addEventListener("load",function(){xe.loading=!1,me.status>=200&&me.status<=299?(xe.dpdb=JSON.parse(me.response),xe.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),me.send()}}go.prototype.getDeviceParams=function(){return this.deviceParams},go.prototype.recalculateDeviceParams_=function(){var ne=this.calcDeviceParams_();ne?(this.deviceParams=ne,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},go.prototype.calcDeviceParams_=function(){var ne=this.dpdb;if(!ne)return console.error("DPDB not available."),null;if(ne.format!=1)return console.error("DPDB has unexpected format version."),null;if(!ne.devices||!ne.devices.length)return console.error("DPDB does not have a devices section."),null;var ae=navigator.userAgent||navigator.vendor||window.opera,me=Pe(),xe=Se();if(!ne.devices)return console.error("DPDB has no devices section."),null;for(var Fe=0;Fe<ne.devices.length;Fe++){var Je=ne.devices[Fe];if(!Je.rules){console.warn("Device["+Fe+"] has no rules section.");continue}if(Je.type!="ios"&&Je.type!="android"){console.warn("Device["+Fe+"] has invalid type.");continue}if(Y()==(Je.type=="ios")){for(var nt=!1,qt=0;qt<Je.rules.length;qt++){var Kt=Je.rules[qt];if(this.ruleMatches_(Kt,ae,me,xe)){nt=!0;break}}if(nt){var dt=Je.dpi[0]||Je.dpi,Lt=Je.dpi[1]||Je.dpi;return new da({xdpi:dt,ydpi:Lt,bevelMm:Je.bw})}}}return console.warn("No DPDB device match."),null},go.prototype.ruleMatches_=function(ne,ae,me,xe){if(!ne.ua&&!ne.res||(ne.ua&&ne.ua.substring(0,2)==="SM"&&(ne.ua=ne.ua.substring(0,7)),ne.ua&&ae.indexOf(ne.ua)<0))return!1;if(ne.res){if(!ne.res[0]||!ne.res[1])return!1;var Fe=ne.res[0],Je=ne.res[1];if(Math.min(me,xe)!=Math.min(Fe,Je)||Math.max(me,xe)!=Math.max(Fe,Je))return!1}return!0};function da(ne){this.xdpi=ne.xdpi,this.ydpi=ne.ydpi,this.bevelMm=ne.bevelMm}function Js(ne,ae){this.set(ne,ae)}Js.prototype.set=function(ne,ae){this.sample=ne,this.timestampS=ae},Js.prototype.copy=function(ne){this.set(ne.sample,ne.timestampS)};function zr(ne,ae){this.kFilter=ne,this.isDebug=ae,this.currentAccelMeasurement=new Js,this.currentGyroMeasurement=new Js,this.previousGyroMeasurement=new Js,Y()?this.filterQ=new st(-1,0,0,1):this.filterQ=new st(1,0,0,1),this.previousFilterQ=new st,this.previousFilterQ.copy(this.filterQ),this.accelQ=new st,this.isOrientationInitialized=!1,this.estimatedGravity=new Xt,this.measuredGravity=new Xt,this.gyroIntegralQ=new st}zr.prototype.addAccelMeasurement=function(ne,ae){this.currentAccelMeasurement.set(ne,ae)},zr.prototype.addGyroMeasurement=function(ne,ae){this.currentGyroMeasurement.set(ne,ae);var me=ae-this.previousGyroMeasurement.timestampS;de(me)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},zr.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var ne=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,ae=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,ne);this.gyroIntegralQ.multiply(ae),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(ae);var me=new st;me.copy(this.filterQ),me.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(me),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var xe=new st;xe.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),xe.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",rn*Ct(xe),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Fe=new st;Fe.copy(this.filterQ),Fe.multiply(xe),this.filterQ.slerp(Fe,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},zr.prototype.getOrientation=function(){return this.filterQ},zr.prototype.accelToQuaternion_=function(ne){var ae=new Xt;ae.copy(ne),ae.normalize();var me=new st;return me.setFromUnitVectors(new Xt(0,0,-1),ae),me.inverse(),me},zr.prototype.gyroToQuaternionDelta_=function(ne,ae){var me=new st,xe=new Xt;return xe.copy(ne),xe.normalize(),me.setFromAxisAngle(xe,ne.length()*ae),me};function Er(ne,ae){this.predictionTimeS=ne,this.isDebug=ae,this.previousQ=new st,this.previousTimestampS=null,this.deltaQ=new st,this.outQ=new st}Er.prototype.getPrediction=function(ne,ae,me){if(!this.previousTimestampS)return this.previousQ.copy(ne),this.previousTimestampS=me,ne;var xe=new Xt;xe.copy(ae),xe.normalize();var Fe=ae.length();if(Fe<Pt*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(rn*Fe).toFixed(1)),this.outQ.copy(ne),this.previousQ.copy(ne),this.outQ;var Je=Fe*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(xe,Je),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(ne),this.previousTimestampS=me,this.outQ};function ps(ne,ae,me,xe){this.yawOnly=me,this.accelerometer=new Xt,this.gyroscope=new Xt,this.filter=new zr(ne,xe),this.posePredictor=new Er(ae,xe),this.isFirefoxAndroid=J(),this.isIOS=Y();var Fe=K();this.isDeviceMotionInRadians=!this.isIOS&&Fe&&Fe<66,this.isWithoutDeviceMotion=ue()||se(),this.filterToWorldQ=new st,Y()?this.filterToWorldQ.setFromAxisAngle(new Xt(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Xt(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new st,this.worldToScreenQ=new st,this.originalPoseAdjustQ=new st,this.originalPoseAdjustQ.setFromAxisAngle(new Xt(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),Me()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new st,this.orientationOut_=new Float32Array(4),this.start()}ps.prototype.getPosition=function(){return null},ps.prototype.getOrientation=function(){var ne=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Fe=new st().setFromAxisAngle(new Xt(0,0,-1),0),Je=new st;return window.orientation===-90?Je.setFromAxisAngle(new Xt(0,1,0),Math.PI/-2):Je.setFromAxisAngle(new Xt(0,1,0),Math.PI/2),Fe.multiply(Je)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Fe=new st;return Fe.setFromAxisAngle(new Xt(1,0,0),-Math.PI/2),Fe}(),ne=this._deviceOrientationQ;var me=new st;return me.copy(ne),me.multiply(this.deviceOrientationFilterToWorldQ),me.multiply(this.resetQ),me.multiply(this.worldToScreenQ),me.multiplyQuaternions(this.deviceOrientationFixQ,me),this.yawOnly&&(me.x=0,me.z=0,me.normalize()),this.orientationOut_[0]=me.x,this.orientationOut_[1]=me.y,this.orientationOut_[2]=me.z,this.orientationOut_[3]=me.w,this.orientationOut_}else{var ae=this.filter.getOrientation();ne=this.posePredictor.getPrediction(ae,this.gyroscope,this.previousTimestampS)}var me=new st;return me.copy(this.filterToWorldQ),me.multiply(this.resetQ),me.multiply(ne),me.multiply(this.worldToScreenQ),this.yawOnly&&(me.x=0,me.z=0,me.normalize()),this.orientationOut_[0]=me.x,this.orientationOut_[1]=me.y,this.orientationOut_[2]=me.z,this.orientationOut_[3]=me.w,this.orientationOut_},ps.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),Me()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},ps.prototype.onDeviceOrientation_=function(ne){this._deviceOrientationQ=this._deviceOrientationQ||new st;var ae=ne.alpha,me=ne.beta,xe=ne.gamma;ae=(ae||0)*Math.PI/180,me=(me||0)*Math.PI/180,xe=(xe||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(me,ae,-xe)},ps.prototype.onDeviceMotion_=function(ne){this.updateDeviceMotion_(ne)},ps.prototype.updateDeviceMotion_=function(ne){var ae=ne.accelerationIncludingGravity,me=ne.rotationRate,xe=ne.timeStamp/1e3,Fe=xe-this.previousTimestampS;if(Fe<0){Tt("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=xe;return}else if(Fe<=W||Fe>V){Tt("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=xe;return}this.accelerometer.set(-ae.x,-ae.y,-ae.z),me&&(he()?this.gyroscope.set(-me.beta,me.alpha,me.gamma):this.gyroscope.set(me.alpha,me.beta,me.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,xe)),this.filter.addAccelMeasurement(this.accelerometer,xe),this.previousTimestampS=xe},ps.prototype.onOrientationChange_=function(ne){this.setScreenTransform_()},ps.prototype.onMessage_=function(ne){var ae=ne.data;if(!(!ae||!ae.type)){var me=ae.type.toLowerCase();me==="devicemotion"&&this.updateDeviceMotion_(ae.deviceMotionEvent)}},ps.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Xt(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Xt(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},ps.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),Y()&&$t()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},ps.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var Rl=60,Yo=new Xt(1,0,0),yc=new Xt(0,0,1),nl=new st;nl.setFromAxisAngle(Yo,-Math.PI/2),nl.multiply(new st().setFromAxisAngle(yc,Math.PI/2));var Oe=function(){function ne(ae){P(this,ne),this.config=ae,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new st,this._outQ=new st,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return F(ne,[{key:"init",value:function(){var me=null;try{me=new RelativeOrientationSensor({frequency:Rl,referenceFrame:"screen"}),me.addEventListener("error",this._onSensorError)}catch(xe){this.errors.push(xe),xe.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):xe.name==="ReferenceError"?this.useDeviceMotion():console.error(xe)}me&&(this.api="sensor",this.sensor=me,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new ps(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var me=this.sensor.quaternion;this._sensorQ.set(me[0],me[1],me[2],me[3]);var xe=this._outQ;return xe.copy(nl),xe.multiply(this._sensorQ),this.config.YAW_ONLY&&(xe.x=xe.z=0,xe.normalize()),this._out[0]=xe.x,this._out[1]=xe.y,this._out[2]=xe.z,this._out[3]=xe.w,this._out}},{key:"_onSensorError",value:function(me){this.errors.push(me.error),me.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):me.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(me.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),ne}(),We="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function ot(){this.loadIcon_();var ne=document.createElement("div"),nt=ne.style;nt.position="fixed",nt.top=0,nt.right=0,nt.bottom=0,nt.left=0,nt.backgroundColor="gray",nt.fontFamily="sans-serif",nt.zIndex=1e6;var ae=document.createElement("img");ae.src=this.icon;var nt=ae.style;nt.marginLeft="25%",nt.marginTop="25%",nt.width="50%",ne.appendChild(ae);var me=document.createElement("div"),nt=me.style;nt.textAlign="center",nt.fontSize="16px",nt.lineHeight="24px",nt.margin="24px 25%",nt.width="50%",me.innerHTML="Place your phone into your Cardboard viewer.",ne.appendChild(me);var xe=document.createElement("div"),nt=xe.style;nt.backgroundColor="#CFD8DC",nt.position="fixed",nt.bottom=0,nt.width="100%",nt.height="48px",nt.padding="14px 24px",nt.boxSizing="border-box",nt.color="#656A6B",ne.appendChild(xe);var Fe=document.createElement("div");Fe.style.float="left",Fe.innerHTML="No Cardboard viewer?";var Je=document.createElement("a");Je.href="https://www.google.com/get/cardboard/get-cardboard/",Je.innerHTML="get one",Je.target="_blank";var nt=Je.style;nt.float="right",nt.fontWeight=600,nt.textTransform="uppercase",nt.borderLeft="1px solid gray",nt.paddingLeft="24px",nt.textDecoration="none",nt.color="#656A6B",xe.appendChild(Fe),xe.appendChild(Je),this.overlay=ne,this.text=me,this.hide()}ot.prototype.show=function(ne){!ne&&!this.overlay.parentElement?document.body.appendChild(this.overlay):ne&&(this.overlay.parentElement&&this.overlay.parentElement!=ne&&this.overlay.parentElement.removeChild(this.overlay),ne.appendChild(this.overlay)),this.overlay.style.display="block";var ae=this.overlay.querySelector("img"),me=ae.style;Me()?(me.width="20%",me.marginLeft="40%",me.marginTop="3%"):(me.width="50%",me.marginLeft="25%",me.marginTop="25%")},ot.prototype.hide=function(){this.overlay.style.display="none"},ot.prototype.showTemporarily=function(ne,ae){this.show(ae),this.timer=setTimeout(this.hide.bind(this),ne)},ot.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},ot.prototype.update=function(){this.disableShowTemporarily(),!Me()&&vt()?this.show():this.hide()},ot.prototype.loadIcon_=function(){this.icon=$("image/svg+xml",We)};var Rt="CardboardV1",gt="WEBVR_CARDBOARD_VIEWER",Ht="webvr-polyfill-viewer-selector";function an(ne){try{this.selectedKey=localStorage.getItem(gt)}catch(ae){console.error("Failed to load viewer profile: %s",ae)}this.selectedKey||(this.selectedKey=ne||Rt),this.dialog=this.createDialog_(nr.Viewers),this.root=null,this.onChangeCallbacks_=[]}an.prototype.show=function(ne){this.root=ne,ne.appendChild(this.dialog);var ae=this.dialog.querySelector("#"+this.selectedKey);ae.checked=!0,this.dialog.style.display="block"},an.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},an.prototype.getCurrentViewer=function(){return nr.Viewers[this.selectedKey]},an.prototype.getSelectedKey_=function(){var ne=this.dialog.querySelector("input[name=field]:checked");return ne?ne.id:null},an.prototype.onChange=function(ne){this.onChangeCallbacks_.push(ne)},an.prototype.fireOnChange_=function(ne){for(var ae=0;ae<this.onChangeCallbacks_.length;ae++)this.onChangeCallbacks_[ae](ne)},an.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!nr.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(nr.Viewers[this.selectedKey]);try{localStorage.setItem(gt,this.selectedKey)}catch(ne){console.error("Failed to save viewer profile: %s",ne)}this.hide()},an.prototype.createDialog_=function(ne){var ae=document.createElement("div");ae.classList.add(Ht),ae.style.display="none";var me=document.createElement("div"),Je=me.style;Je.position="fixed",Je.left=0,Je.top=0,Je.width="100%",Je.height="100%",Je.background="rgba(0, 0, 0, 0.3)",me.addEventListener("click",this.hide.bind(this));var xe=280,Fe=document.createElement("div"),Je=Fe.style;Je.boxSizing="border-box",Je.position="fixed",Je.top="24px",Je.left="50%",Je.marginLeft=-xe/2+"px",Je.width=xe+"px",Je.padding="24px",Je.overflow="hidden",Je.background="#fafafa",Je.fontFamily="'Roboto', sans-serif",Je.boxShadow="0px 5px 20px #666",Fe.appendChild(this.createH1_("Select your viewer"));for(var nt in ne)Fe.appendChild(this.createChoice_(nt,ne[nt].label));return Fe.appendChild(this.createButton_("Save",this.onSave_.bind(this))),ae.appendChild(me),ae.appendChild(Fe),ae},an.prototype.createH1_=function(ne){var ae=document.createElement("h1"),me=ae.style;return me.color="black",me.fontSize="20px",me.fontWeight="bold",me.marginTop=0,me.marginBottom="24px",ae.innerHTML=ne,ae},an.prototype.createChoice_=function(ne,ae){var me=document.createElement("div");me.style.marginTop="8px",me.style.color="black";var xe=document.createElement("input");xe.style.fontSize="30px",xe.setAttribute("id",ne),xe.setAttribute("type","radio"),xe.setAttribute("value",ne),xe.setAttribute("name","field");var Fe=document.createElement("label");return Fe.style.marginLeft="4px",Fe.setAttribute("for",ne),Fe.innerHTML=ae,me.appendChild(xe),me.appendChild(Fe),me},an.prototype.createButton_=function(ne,ae){var me=document.createElement("button");me.innerHTML=ne;var xe=me.style;return xe.float="right",xe.textTransform="uppercase",xe.color="#1094f7",xe.fontSize="14px",xe.letterSpacing=0,xe.border=0,xe.background="none",xe.marginTop="16px",me.addEventListener("click",ae),me};var jn=typeof window<"u"?window:typeof f<"u"?f:typeof self<"u"?self:{};function Bn(ne){return ne&&ne.__esModule&&Object.prototype.hasOwnProperty.call(ne,"default")?ne.default:ne}function zt(ne,ae){return ae={exports:{}},ne(ae,ae.exports),ae.exports}var Zn=zt(function(ne,ae){(function(xe,Fe){ne.exports=Fe()})(jn,function(){return function(me){var xe={};function Fe(Je){if(xe[Je])return xe[Je].exports;var nt=xe[Je]={i:Je,l:!1,exports:{}};return me[Je].call(nt.exports,nt,nt.exports,Fe),nt.l=!0,nt.exports}return Fe.m=me,Fe.c=xe,Fe.d=function(Je,nt,qt){Fe.o(Je,nt)||Object.defineProperty(Je,nt,{configurable:!1,enumerable:!0,get:qt})},Fe.n=function(Je){var nt=Je&&Je.__esModule?function(){return Je.default}:function(){return Je};return Fe.d(nt,"a",nt),nt},Fe.o=function(Je,nt){return Object.prototype.hasOwnProperty.call(Je,nt)},Fe.p="",Fe(Fe.s=0)}([function(me,xe,Fe){var Je=function(){function Lt(on,Nn){for(var $n=0;$n<Nn.length;$n++){var ai=Nn[$n];ai.enumerable=ai.enumerable||!1,ai.configurable=!0,"value"in ai&&(ai.writable=!0),Object.defineProperty(on,ai.key,ai)}}return function(on,Nn,$n){return Nn&&Lt(on.prototype,Nn),$n&&Lt(on,$n),on}}();function nt(Lt,on){if(!(Lt instanceof on))throw new TypeError("Cannot call a class as a function")}var qt=Fe(1),Kt=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,dt=function(){function Lt(){nt(this,Lt),Kt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",qt),this.noSleepVideo.addEventListener("timeupdate",(function(on){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}).bind(this)))}return Je(Lt,[{key:"enable",value:function(){Kt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){Kt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),Lt}();me.exports=dt},function(me,xe,Fe){me.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),oi=Bn(Zn),hi=1e3,wr=[0,0,.5,1],Ti=[.5,0,.5,1],bi=window.requestAnimationFrame,Wi=window.cancelAnimationFrame;function Or(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function ms(ne){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:ne.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:ne.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:ne.canPresent},maxLayers:{writable:!1,enumerable:!0,value:ne.maxLayers},hasOrientation:{enumerable:!0,get:function(){return At("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),ne.hasOrientation}}})}function Rn(ne){ne=ne||{};var ae="wakelock"in ne?ne.wakelock:!0;this.isPolyfilled=!0,this.displayId=hi++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return At("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new ms({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,ae&&vt()&&(this.wakelock_=new oi)}Rn.prototype.getFrameData=function(ne){return St(ne,this._getPose(),this)},Rn.prototype.getPose=function(){return At("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Rn.prototype.resetPose=function(){return At("VRDisplay.prototype.resetPose"),this._resetPose()},Rn.prototype.getImmediatePose=function(){return At("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Rn.prototype.requestAnimationFrame=function(ne){return bi(ne)},Rn.prototype.cancelAnimationFrame=function(ne){return Wi(ne)},Rn.prototype.wrapForFullscreen=function(ne){if(Y())return ne;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var ae=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",ae.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==ne)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=ne,this.originalParent_=ne.parentElement,this.originalParent_||document.body.appendChild(ne),!this.fullscreenWrapper_.parentElement){var me=this.fullscreenElement_.parentElement;me.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),me.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var xe=this;function Fe(){if(xe.fullscreenElement_){var Je=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];xe.fullscreenElement_.setAttribute("style",Je.join("; ")+";")}}return Fe(),this.fullscreenWrapper_},Rn.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var ne=this.fullscreenElement_;this.fullscreenElementCachedStyle_?ne.setAttribute("style",this.fullscreenElementCachedStyle_):ne.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var ae=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(ne),this.originalParent_===ae?ae.insertBefore(ne,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(ne),ae.removeChild(this.fullscreenWrapper_),ne}},Rn.prototype.requestPresent=function(ne){var ae=this.isPresenting,me=this;return ne instanceof Array||(At("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),ne=[ne]),new Promise(function(xe,Fe){if(!me.capabilities.canPresent){Fe(new Error("VRDisplay is not capable of presenting."));return}if(ne.length==0||ne.length>me.capabilities.maxLayers){Fe(new Error("Invalid number of layers."));return}var Je=ne[0];if(!Je.source){xe();return}var nt=Je.leftBounds||wr,qt=Je.rightBounds||Ti;if(ae){var Kt=me.layer_;Kt.source!==Je.source&&(Kt.source=Je.source);for(var dt=0;dt<4;dt++)Kt.leftBounds[dt]=nt[dt],Kt.rightBounds[dt]=qt[dt];me.wrapForFullscreen(me.layer_.source),me.updatePresent_(),xe();return}if(me.layer_={predistorted:Je.predistorted,source:Je.source,leftBounds:nt.slice(0),rightBounds:qt.slice(0)},me.waitingForPresent_=!1,me.layer_&&me.layer_.source){var Lt=me.wrapForFullscreen(me.layer_.source),on=function(){var ai=je();me.isPresenting=Lt===ai,me.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(wi){console.error("screen.orientation.lock() failed due to",wi.message)}),me.waitingForPresent_=!1,me.beginPresent_(),xe()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),me.removeFullscreenWrapper(),me.disableWakeLock(),me.endPresent_(),me.removeFullscreenListeners_()),me.fireVRDisplayPresentChange_()},Nn=function(){me.waitingForPresent_&&(me.removeFullscreenWrapper(),me.removeFullscreenListeners_(),me.disableWakeLock(),me.waitingForPresent_=!1,me.isPresenting=!1,Fe(new Error("Unable to present.")))};me.addFullscreenListeners_(Lt,on,Nn),Le(Lt)?(me.enableWakeLock(),me.waitingForPresent_=!0):(Y()||Q())&&(me.enableWakeLock(),me.isPresenting=!0,me.beginPresent_(),me.fireVRDisplayPresentChange_(),xe())}!me.waitingForPresent_&&!Y()&&(be(),Fe(new Error("Unable to present.")))})},Rn.prototype.exitPresent=function(){var ne=this.isPresenting,ae=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(me,xe){ne?(!be()&&Y()&&(ae.endPresent_(),ae.fireVRDisplayPresentChange_()),Q()&&(ae.removeFullscreenWrapper(),ae.removeFullscreenListeners_(),ae.endPresent_(),ae.fireVRDisplayPresentChange_()),me()):xe(new Error("Was not presenting to VRDisplay."))})},Rn.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Rn.prototype.fireVRDisplayPresentChange_=function(){var ne=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(ne)},Rn.prototype.fireVRDisplayConnect_=function(){var ne=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(ne)},Rn.prototype.addFullscreenListeners_=function(ne,ae,me){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=ne,this.fullscreenChangeHandler_=ae,this.fullscreenErrorHandler_=me,ae&&(document.fullscreenEnabled?ne.addEventListener("fullscreenchange",ae,!1):document.webkitFullscreenEnabled?ne.addEventListener("webkitfullscreenchange",ae,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",ae,!1):document.msFullscreenEnabled&&ne.addEventListener("msfullscreenchange",ae,!1)),me&&(document.fullscreenEnabled?ne.addEventListener("fullscreenerror",me,!1):document.webkitFullscreenEnabled?ne.addEventListener("webkitfullscreenerror",me,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",me,!1):document.msFullscreenEnabled&&ne.addEventListener("msfullscreenerror",me,!1))},Rn.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var ne=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var ae=this.fullscreenChangeHandler_;ne.removeEventListener("fullscreenchange",ae,!1),ne.removeEventListener("webkitfullscreenchange",ae,!1),document.removeEventListener("mozfullscreenchange",ae,!1),ne.removeEventListener("msfullscreenchange",ae,!1)}if(this.fullscreenErrorHandler_){var me=this.fullscreenErrorHandler_;ne.removeEventListener("fullscreenerror",me,!1),ne.removeEventListener("webkitfullscreenerror",me,!1),document.removeEventListener("mozfullscreenerror",me,!1),ne.removeEventListener("msfullscreenerror",me,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Rn.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Rn.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Rn.prototype.beginPresent_=function(){},Rn.prototype.endPresent_=function(){},Rn.prototype.submitFrame=function(ne){},Rn.prototype.getEyeParameters=function(ne){return null};var Ii={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},es={LEFT:"left",RIGHT:"right"};function Zi(ne){var ae=ft({},Ii);ne=ft(ae,ne||{}),Rn.call(this,{wakelock:ne.MOBILE_WAKE_LOCK}),this.config=ne,this.displayName="Cardboard VRDisplay",this.capabilities=new ms({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Oe(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new go(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new nr(this.dpdb_.getDeviceParams(),ne.ADDITIONAL_VIEWERS),this.viewerSelector_=new an(ne.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new ot),Y()&&window.addEventListener("resize",this.onResize_.bind(this))}return Zi.prototype=Object.create(Rn.prototype),Zi.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Zi.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Zi.prototype._getFieldOfView=function(ne){var ae;if(ne==es.LEFT)ae=this.deviceInfo_.getFieldOfViewLeftEye();else if(ne==es.RIGHT)ae=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",ne),null;return ae},Zi.prototype._getEyeOffset=function(ne){var ae;if(ne==es.LEFT)ae=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(ne==es.RIGHT)ae=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",ne),null;return ae},Zi.prototype.getEyeParameters=function(ne){var ae=this._getEyeOffset(ne),me=this._getFieldOfView(ne),xe={offset:ae,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(xe,"fieldOfView",{enumerable:!0,get:function(){return At("VRFieldOfView","VRFrameData's projection matrices"),me}}),xe},Zi.prototype.onDeviceParamsUpdated_=function(ne){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(ne),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Zi.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Zi.prototype.beginPresent_=function(){var ne=this.layer_.source.getContext("webgl");ne||(ne=this.layer_.source.getContext("experimental-webgl")),ne||(ne=this.layer_.source.getContext("webgl2")),ne&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(ne.canvas.width=Pe()*this.bufferScale_,ne.canvas.height=Se()*this.bufferScale_,this.cardboardUI_=new Qe(ne)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Qe(ne)),this.distorter_=new Gt(ne,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen((function(ae){this.viewerSelector_.show(this.layer_.source.parentElement),ae.stopPropagation(),ae.preventDefault()}).bind(this),(function(ae){this.exitPresent(),ae.stopPropagation(),ae.preventDefault()}).bind(this)),this.rotateInstructions_&&(Me()&&vt()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Zi.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Zi.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Zi.prototype.submitFrame=function(ne){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var ae=this.layer_.source.getContext("webgl");ae||(ae=this.layer_.source.getContext("experimental-webgl")),ae||(ae=this.layer_.source.getContext("webgl2"));var me=ae.canvas;(me.width!=this.lastWidth||me.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=me.width,this.lastHeight=me.height,this.cardboardUI_.render()}},Zi.prototype.onOrientationChange_=function(ne){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Zi.prototype.onResize_=function(ne){if(this.layer_){var ae=this.layer_.source.getContext("webgl");ae||(ae=this.layer_.source.getContext("experimental-webgl")),ae||(ae=this.layer_.source.getContext("webgl2"));var me=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];ae.canvas.setAttribute("style",me.join("; ")+";"),Ze(ae.canvas)}},Zi.prototype.onViewerChanged_=function(ne){this.deviceInfo_.setViewer(ne),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Zi.prototype.fireVRDisplayDeviceParamsChange_=function(){var ne=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(ne)},Zi.VRFrameData=Or,Zi.VRDisplay=Rn,Zi})}),E=g(C),x="0.10.12",M={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function w(R){this.config=y(y({},M),R),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&v())&&(this.enable(),this.getVRDisplays().then(function(k){k&&k[0]&&k[0].fireVRDisplayConnect_&&k[0].fireVRDisplayConnect_()}))}w.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(v()){var R=new E({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(R)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},w.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var R=this.native.VRFrameData,k=new this.native.VRFrameData,P=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(F){if(F instanceof R){P.call(this,F);return}P.call(this,k),F.pose=k.pose,A(k.leftProjectionMatrix,F.leftProjectionMatrix),A(k.rightProjectionMatrix,F.rightProjectionMatrix),A(k.leftViewMatrix,F.leftViewMatrix),A(k.rightViewMatrix,F.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=E.VRDisplay,window.VRFrameData=E.VRFrameData},w.prototype.getVRDisplays=function(){var R=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(k){return k.length>0?k:R.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},w.version=x,w.VRFrameData=E.VRFrameData,w.VRDisplay=E.VRDisplay;var S=Object.freeze({default:w}),I=S&&w||S;typeof f<"u"&&f.window&&(f.document||(f.document=f.window.document),f.navigator||(f.navigator=f.window.navigator));var L=I;return L})},"./node_modules/word-wrapper/index.js":u=>{var p=/\n/,c=`
`,f=/\s/;u.exports=function(C,E){var x=u.exports.lines(C,E);return x.map(function(M){return C.substring(M.start,M.end)}).join(`
`)},u.exports.lines=function(E,x){if(x=x||{},x.width===0&&x.mode!=="nowrap")return[];E=E||"";var M=typeof x.width=="number"?x.width:Number.MAX_VALUE,w=Math.max(0,x.start||0),S=typeof x.end=="number"?x.end:E.length,I=x.mode,L=x.measure||y;return I==="pre"?v(L,E,w,S,M):A(L,E,w,S,M,I)};function g(C,E,x,M){var w=C.indexOf(E,x);return w===-1||w>M?M:w}function m(C){return f.test(C)}function v(C,E,x,M,w){for(var S=[],I=x,L=x;L<M&&L<E.length;L++){var R=E.charAt(L),k=p.test(R);if(k||L===M-1){var P=k?L:L+1,F=C(E,I,P,w);S.push(F),I=L+1}}return S}function A(C,E,x,M,w,S){var I=[],L=w;for(S==="nowrap"&&(L=Number.MAX_VALUE);x<M&&x<E.length;){for(var R=g(E,c,x,M);x<R&&m(E.charAt(x));)x++;var k=C(E,x,R,L),P=x+(k.end-k.start),F=P+c.length;if(P<R){for(;P>x&&!m(E.charAt(P));)P--;if(P===x)F>x+c.length&&F--,P=F;else for(F=P;P>x&&m(E.charAt(P-c.length));)P--}if(P>=x){var O=C(E,x,P,L);I.push(O)}x=F}return I}function y(C,E,x,M){var w=Math.min(M,x-E);return{start:E,end:E+w}}},"./node_modules/xhr/index.js":(u,p,c)=>{var f=c("./node_modules/global/window.js"),g=c("./node_modules/is-function/index.js"),m=c("./node_modules/parse-headers/parse-headers.js"),v=c("./node_modules/xtend/immutable.js");u.exports=E,u.exports.default=E,E.XMLHttpRequest=f.XMLHttpRequest||w,E.XDomainRequest="withCredentials"in new E.XMLHttpRequest?E.XMLHttpRequest:f.XDomainRequest,A(["get","put","post","patch","head","delete"],function(S){E[S==="delete"?"del":S]=function(I,L,R){return L=C(I,L,R),L.method=S.toUpperCase(),x(L)}});function A(S,I){for(var L=0;L<S.length;L++)I(S[L])}function y(S){for(var I in S)if(S.hasOwnProperty(I))return!1;return!0}function C(S,I,L){var R=S;return g(I)?(L=I,typeof S=="string"&&(R={uri:S})):R=v(I,{uri:S}),R.callback=L,R}function E(S,I,L){return I=C(S,I,L),x(I)}function x(S){if(typeof S.callback>"u")throw new Error("callback argument missing");var I=!1,L=function(he,Me,de){I||(I=!0,S.callback(he,Me,de))};function R(){O.readyState===4&&setTimeout(F,0)}function k(){var ue=void 0;if(O.response?ue=O.response:ue=O.responseText||M(O),J)try{ue=JSON.parse(ue)}catch{}return ue}function P(ue){return clearTimeout(K),ue instanceof Error||(ue=new Error(""+(ue||"Unknown XMLHttpRequest Error"))),ue.statusCode=0,L(ue,se)}function F(){if(!V){var ue;clearTimeout(K),S.useXDR&&O.status===void 0?ue=200:ue=O.status===1223?204:O.status;var he=se,Me=null;return ue!==0?(he={body:k(),statusCode:ue,method:H,headers:{},url:$,rawRequest:O},O.getAllResponseHeaders&&(he.headers=m(O.getAllResponseHeaders()))):Me=new Error("Internal XMLHttpRequest Error"),L(Me,he,he.body)}}var O=S.xhr||null;O||(S.cors||S.useXDR?O=new E.XDomainRequest:O=new E.XMLHttpRequest);var W,V,$=O.url=S.uri||S.url,H=O.method=S.method||"GET",Y=S.body||S.data,Q=O.headers=S.headers||{},G=!!S.sync,J=!1,K,se={body:void 0,headers:{},statusCode:0,method:H,url:$,rawRequest:O};if("json"in S&&S.json!==!1&&(J=!0,Q.accept||Q.Accept||(Q.Accept="application/json"),H!=="GET"&&H!=="HEAD"&&(Q["content-type"]||Q["Content-Type"]||(Q["Content-Type"]="application/json"),Y=JSON.stringify(S.json===!0?Y:S.json))),O.onreadystatechange=R,O.onload=F,O.onerror=P,O.onprogress=function(){},O.onabort=function(){V=!0},O.ontimeout=P,O.open(H,$,!G,S.username,S.password),G||(O.withCredentials=!!S.withCredentials),!G&&S.timeout>0&&(K=setTimeout(function(){if(!V){V=!0,O.abort("timeout");var ue=new Error("XMLHttpRequest timeout");ue.code="ETIMEDOUT",P(ue)}},S.timeout)),O.setRequestHeader)for(W in Q)Q.hasOwnProperty(W)&&O.setRequestHeader(W,Q[W]);else if(S.headers&&!y(S.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in S&&(O.responseType=S.responseType),"beforeSend"in S&&typeof S.beforeSend=="function"&&S.beforeSend(O),O.send(Y||null),O}function M(S){try{if(S.responseType==="document")return S.responseXML;var I=S.responseXML&&S.responseXML.documentElement.nodeName==="parsererror";if(S.responseType===""&&!I)return S.responseXML}catch{}return null}function w(){}},"./node_modules/xml-parse-from-string/index.js":u=>{u.exports=function(){return typeof self.DOMParser<"u"?function(c){var f=new self.DOMParser;return f.parseFromString(c,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(c){var f=new self.ActiveXObject("Microsoft.XMLDOM");return f.async="false",f.loadXML(c),f}:function(c){var f=document.createElement("div");return f.innerHTML=c,f}}()},"./node_modules/xtend/immutable.js":u=>{u.exports=c;var p=Object.prototype.hasOwnProperty;function c(){for(var f={},g=0;g<arguments.length;g++){var m=arguments[g];for(var v in m)p.call(m,v)&&(f[v]=m[v])}return f}},"./src/components/anchored.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/index.js"),m=g.debug("components:anchored:warn");u.exports.Component=f("anchored",{schema:{persistent:{default:!1}},init:function(){var A=this.el.sceneEl,y=A.getAttribute("webxr"),C=y.optionalFeatures;C.indexOf("anchors")===-1&&(C.push("anchors"),this.el.sceneEl.setAttribute("webxr",y)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var A=this.el.sceneEl,y=A.renderer.xr,C,E,x,M=this.el.object3D;!A.is("ar-mode")&&!A.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),this.anchor&&(C=A.frame,E=y.getReferenceSpace(),x=C.getPose(this.anchor.anchorSpace,E),M.matrix.elements=x.transform.matrix,M.matrix.decompose(M.position,M.rotation,M.scale)))},createAnchor:async function(y,C){var E=this.el.sceneEl,x=E.renderer.xr,M,w,S,I,L=this.el.object3D;if(y=y||L.position,C=C||this.auxQuaternion.setFromEuler(L.rotation),!v(E)){m("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),M=E.frame,w=x.getReferenceSpace(),S=new XRRigidTransform({x:y.x,y:y.y,z:y.z},{x:C.x,y:C.y,z:C.z,w:C.w}),this.requestAnchorPending=!1,I=await M.createAnchor(S,w),this.data.persistent&&(this.el.id?(this.persistentHandle=await I.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):m("The anchor won't be persisted because the entity has no assigned id.")),E.object3D.attach(this.el.object3D),this.anchor=I},restorePersistentAnchor:async function(){var y=this.el.sceneEl.renderer.xr,C=y.getSession(),E=C.persistentAnchors,x;if(this.requestPersistentAnchorPending=!1,!this.el.id){m("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(E){x=localStorage.getItem(this.el.id);for(var M=0;M<E.length;++M)if(x===E[M]){this.anchor=await C.restorePersistentAnchor(E[M]),this.anchor&&(this.persistentHandle=E[M]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var A,y,C=this.anchor;C&&(A=this.el.sceneEl.renderer.xr,y=A.getSession(),C.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&y.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function v(A){var y=A.renderer.xr,C=y.getSession();return C&&C.restorePersistentAnchor}},"./src/components/animation.js":(u,p,c)=>{var f=c("./node_modules/super-animejs/lib/anime.es.js").default,g=c("./src/core/component.js").components,m=c("./src/core/component.js").registerComponent,v=c("./src/lib/three.js"),A=c("./src/utils/index.js"),y=new v.Color,C=new v.Color,E=A.entity.getComponentProperty,x=A.entity.setComponentProperty,M={},w="color",S="position",I="rotation",L="scale",R="components",k="object3D";u.exports.Component=m("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(Q){return Q===!0||Q==="true"?!0:Q===!1||Q==="false"?!1:parseInt(Q,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var Q=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){Q.animationIsPlaying=!1,Q.el.emit("animationcomplete",Q.eventDetail,!1),Q.id&&Q.el.emit("animationcomplete__"+Q.id,Q.eventDetail,!1)}}},update:function(Q){var G=this.config,J=this.data;this.animationIsPlaying=!1,this.data.enabled&&J.property&&(G.autoplay=!1,G.direction=J.dir,G.duration=J.dur,G.easing=J.easing,G.elasticity=J.elasticity,G.loop=J.loop,G.round=J.round,this.createAndStartAnimation())},tick:function(Q,G){this.animationIsPlaying&&(this.time+=G,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){this.paused&&(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var Q=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=f(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!Q.autoplay||Q.startEvents&&Q.startEvents.length)){if(Q.delay){setTimeout(this.beginAnimation,Q.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=f(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var Q=this.config,G=this.data,J=this.el,K,se,ue;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){K=G.from===""?V(J,G.property):G.from,ue=G.to,this.setColorConfig(K,ue),K=this.fromColor,ue=this.toColor,this.targetsArray.length=0,this.targetsArray.push(K),Q.targets=this.targetsArray;for(se in ue)Q[se]=ue[se];Q.update=function(){var he={};return function(Me){var de;de=Me.animatables[0].target,!(de.r===he.r&&de.g===he.g&&de.b===he.b)&&$(J,G.property,de,G.type)}}()}},updateConfigForDefault:function(){var Q=this.config,G=this.data,J=this.el,K,se,ue,he;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(G.from===""?K=Y(G)?V(J,G.property):E(J,G.property):K=G.from,he=G.to,ue=!isNaN(K||he),ue?(K=parseFloat(K),he=parseFloat(he)):(K=K&&K.toString(),he=he&&he.toString()),se=G.to==="true"||G.to==="false"||G.to===!0||G.to===!1,se&&(K=G.from==="true"||G.from===!0?1:0,he=G.to==="true"||G.to===!0?1:0),this.targets.aframeProperty=K,Q.targets=this.targets,Q.aframeProperty=he,Q.update=function(){var Me;return function(de){var Pe;Pe=de.animatables[0].target.aframeProperty,Pe!==Me&&(Me=Pe,se&&(Pe=Pe>=1),Y(G)?$(J,G.property,Pe,G.type):x(J,G.property,Pe))}}())},updateConfigForVector:function(){var Q=this.config,G=this.data,J=this.el,K,se,ue;se=G.from!==""?A.coordinates.parse(G.from):E(J,G.property),ue=A.coordinates.parse(G.to),G.property===I&&(F(se),F(ue)),this.targetsArray.length=0,this.targetsArray.push(se),Q.targets=this.targetsArray;for(K in ue)Q[K]=ue[K];if(G.property===S||G.property===I||G.property===L){Q.update=function(){var he={};return function(Me){var de=Me.animatables[0].target;de.x===he.x&&de.y===he.y&&de.z===he.z||(he.x=de.x,he.y=de.y,he.z=de.z,J.object3D[G.property].set(de.x,de.y,de.z))}}();return}Q.update=function(){var he={};return function(Me){var de=Me.animatables[0].target;de.x===he.x&&de.y===he.y&&de.z===he.z||(he.x=de.x,he.y=de.y,he.z=de.z,x(J,G.property,de))}}()},updateConfig:function(){var Q;Q=P(this.el,this.data.property),Y(this.data)&&this.data.type===w?this.updateConfigForRawColor():Q==="vec2"||Q==="vec3"||Q==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(Q){var G,J=this.data,K=this.el,se=this;return J.from!==""||!J.property.startsWith(R)||(G=H(J.property)[1],K.components[G])?!1:(K.addEventListener("componentinitialized",function ue(he){he.detail.name===G&&(Q(),se.animation=f(se.config),K.removeEventListener("componentinitialized",ue))}),!0)},stopRelatedAnimations:function(){var Q,G;for(G in this.el.components)Q=this.el.components[G],G!==this.attrName&&Q.name==="animation"&&Q.animationIsPlaying&&Q.data.property===this.data.property&&(Q.animationIsPlaying=!1)},addEventListeners:function(){var Q=this.data,G=this.el;O(G,Q.startEvents,this.onStartEvent),O(G,Q.pauseEvents,this.pauseAnimation),O(G,Q.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var Q=this.data,G=this.el;W(G,Q.startEvents,this.onStartEvent),W(G,Q.pauseEvents,this.pauseAnimation),W(G,Q.resumeEvents,this.resumeAnimation)},setColorConfig:function(Q,G){y.set(Q),C.set(G),Q=this.fromColor,G=this.toColor,Q.r=y.r,Q.g=y.g,Q.b=y.b,G.r=C.r,G.g=C.g,G.b=C.b}});function P(Q,G){var J,K,se,ue;return se=G.split("."),K=se[0],ue=se[1],J=Q.components[K]||g[K],!J||ue&&!J.schema[ue]?null:ue?J.schema[ue].type:J.schema.type}function F(Q){Q.x=v.MathUtils.degToRad(Q.x),Q.y=v.MathUtils.degToRad(Q.y),Q.z=v.MathUtils.degToRad(Q.z)}function O(Q,G,J){var K;for(K=0;K<G.length;K++)Q.addEventListener(G[K],J)}function W(Q,G,J){var K;for(K=0;K<G.length;K++)Q.removeEventListener(G[K],J)}function V(Q,G){var J,K,se;for(K=H(G),se=Q,J=0;J<K.length;J++)se=se[K[J]];if(se===void 0)throw console.log(Q),new Error("[animation] property ("+G+") could not be found");return se}function $(Q,G,J,K){var se,ue,he,Me;for(G.startsWith("object3D.rotation")&&(J=v.MathUtils.degToRad(J)),ue=H(G),Me=Q,se=0;se<ue.length-1;se++)Me=Me[ue[se]];if(he=ue[ue.length-1],K===w){"r"in Me[he]?(Me[he].r=J.r,Me[he].g=J.g,Me[he].b=J.b):(Me[he].x=J.r,Me[he].y=J.g,Me[he].z=J.b);return}Me[he]=J}function H(Q){return Q in M||(M[Q]=Q.split(".")),M[Q]}function Y(Q){return Q.isRawProperty||Q.property.startsWith(R)||Q.property.startsWith(k)}},"./src/components/camera.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js");u.exports.Component=f("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var m,v=this.el;m=this.camera=new g.PerspectiveCamera,v.setObject3D("camera",m)},update:function(m){var v=this.data,A=this.camera;A.aspect=v.aspect||window.innerWidth/window.innerHeight,A.far=v.far,A.fov=v.fov,A.near=v.near,A.zoom=v.zoom,A.updateProjectionMatrix(),this.updateActiveCamera(m),this.updateSpectatorCamera(m)},updateActiveCamera:function(m){var v=this.data,A=this.el,y=this.system;m&&m.active===v.active||v.spectator||(v.active&&y.activeCameraEl!==A?y.setActiveCamera(A):!v.active&&y.activeCameraEl===A&&y.disableActiveCamera())},updateSpectatorCamera:function(m){var v=this.data,A=this.el,y=this.system;m&&m.spectator===v.spectator||(v.spectator&&y.spectatorCameraEl!==A?y.setSpectatorCamera(A):!v.spectator&&y.spectatorCameraEl===A&&y.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/index.js"),m={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},v={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},A={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},y={DOWN:["selectstart"],UP:["selectend"]},C="a-mouse-cursor-hover";u.exports.Component=f("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:g.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:!0,init:function(){var E=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=g.debounce(function(){E.canvasBounds=E.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=this.onCursorDown.bind(this),this.onCursorUp=this.onCursorUp.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},update:function(E){this.data.rayOrigin!==E.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var E=this.el.sceneEl.frame,x=this.activeXRInput;this.data.rayOrigin==="xrselect"&&E&&x&&this.onMouseMove({frame:E,inputSource:x,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var E=this.el;E.removeState(v.HOVERING),E.removeState(v.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(v.HOVERED),this.removeEventListeners()},addEventListeners:function(){var E,x=this.data,M=this.el,w=this;function S(){E=M.sceneEl.canvas,!(x.downEvents.length||x.upEvents.length)&&(A.DOWN.forEach(function(I){E.addEventListener(I,w.onCursorDown,{passive:!1})}),A.UP.forEach(function(I){E.addEventListener(I,w.onCursorUp,{passive:!1})}))}E=M.sceneEl.canvas,E?S():M.sceneEl.addEventListener("render-target-loaded",S),x.downEvents.forEach(function(I){M.addEventListener(I,w.onCursorDown)}),x.upEvents.forEach(function(I){M.addEventListener(I,w.onCursorUp)}),M.addEventListener("raycaster-intersection",this.onIntersection),M.addEventListener("raycaster-closest-entity-changed",this.onIntersection),M.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),M.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),M.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var E,x=this.data,M=this.el,w=this;E=M.sceneEl.canvas,E&&!x.downEvents.length&&!x.upEvents.length&&(A.DOWN.forEach(function(S){E.removeEventListener(S,w.onCursorDown)}),A.UP.forEach(function(S){E.removeEventListener(S,w.onCursorUp)})),x.downEvents.forEach(function(S){M.removeEventListener(S,w.onCursorDown)}),x.upEvents.forEach(function(S){M.removeEventListener(S,w.onCursorUp)}),M.removeEventListener("raycaster-intersection",this.onIntersection),M.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),E.removeEventListener("mousemove",this.onMouseMove),E.removeEventListener("touchstart",this.onMouseMove),E.removeEventListener("touchmove",this.onMouseMove),M.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),M.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var E,x=this.el;E=x.sceneEl.canvas,E.removeEventListener("mousemove",this.onMouseMove),E.removeEventListener("touchmove",this.onMouseMove),x.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(E.addEventListener("mousemove",this.onMouseMove),E.addEventListener("touchmove",this.onMouseMove,{passive:!1}),x.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var E=new THREE.Vector3,x=new THREE.Vector2,M=new THREE.Vector3,w={origin:M,direction:E};return function(S){var I=this.canvasBounds,L=this.el.sceneEl.camera,R,k,P,F,O,W,V,$;L.parent.updateMatrixWorld(),S.type==="touchmove"||S.type==="touchstart"?k=S.touches.item(0):k=S,R=k.clientX-I.left,P=k.clientY-I.top,x.x=R/I.width*2-1,x.y=-(P/I.height)*2+1,this.data.rayOrigin==="xrselect"&&(S.type==="selectstart"||S.type==="fakeselectevent")?(F=S.frame,O=S.inputSource,W=this.el.renderer.xr.getReferenceSpace(),V=F.getPose(O.targetRaySpace,W),$=V.transform,E.set(0,0,-1),E.applyQuaternion($.orientation),M.copy($.position)):S.type==="fakeselectout"?(E.set(0,1,0),M.set(0,9999,0)):L&&L.isPerspectiveCamera?(M.setFromMatrixPosition(L.matrixWorld),E.set(x.x,x.y,.5).unproject(L).sub(M).normalize()):L&&L.isOrthographicCamera?(M.set(x.x,x.y,(L.near+L.far)/(L.near-L.far)).unproject(L),E.set(0,0,-1).transformDirection(L.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+L.type),this.el.setAttribute("raycaster",w),S.type==="touchmove"&&S.preventDefault()}}(),onCursorDown:function(E){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&E.type==="touchstart"&&(this.onMouseMove(E),this.el.components.raycaster.checkIntersections(),E.preventDefault()),this.data.rayOrigin==="xrselect"&&E.type==="selectstart"&&(this.activeXRInput=E.inputSource,this.onMouseMove(E),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(m.MOUSEDOWN,E),this.cursorDownEl=this.intersectedEl},onCursorUp:function(E){if(this.isCursorDown){this.isCursorDown=!1;var x=this.data;this.twoWayEmit(m.MOUSEUP,E),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(m.MOUSEUP,this.intersectedEventDetail)),(!x.fuse||x.rayOrigin==="mouse"||x.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(m.CLICK,E),x.rayOrigin==="xrselect"&&this.activeXRInput===E.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,E.type==="touchend"&&E.preventDefault()}},onIntersection:function(E){var x,M=this.el,w,S,I;w=E.detail.els[0]===M?1:0,I=E.detail.intersections[w],S=E.detail.els[w],S&&this.intersectedEl!==S&&(this.intersectedEl&&(x=this.el.components.raycaster.getIntersection(this.intersectedEl),x&&x.distance<=I.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(S,I)))},onIntersectionCleared:function(E){var x=E.detail.clearedEls;x.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var E=this.el.sceneEl.xrSession,x=this;E&&this.data.rayOrigin!=="mouse"&&(y.DOWN.forEach(function(M){E.addEventListener(M,x.onCursorDown)}),y.UP.forEach(function(M){E.addEventListener(M,x.onCursorUp)}))},setIntersection:function(E,x){var M=this.el,w=this.data,S=this;this.intersectedEl!==E&&(this.intersectedEl=E,M.addState(v.HOVERING),E.addState(v.HOVERED),this.twoWayEmit(m.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(C),!(w.fuseTimeout===0||!w.fuse||w.rayOrigin==="xrselect"||w.rayOrigin==="mouse")&&(M.addState(v.FUSING),this.twoWayEmit(m.FUSING),this.fuseTimeout=setTimeout(function(){M.removeState(v.FUSING),S.twoWayEmit(m.CLICK)},w.fuseTimeout)))},clearCurrentIntersection:function(E){var x,M,w,S=this.el;this.intersectedEl&&(this.intersectedEl.removeState(v.HOVERED),S.removeState(v.HOVERING),S.removeState(v.FUSING),this.twoWayEmit(m.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(C),this.intersectedEl=null,clearTimeout(this.fuseTimeout),E!==!0&&(w=this.el.components.raycaster.intersections,w.length!==0&&(x=w[0].object.el===S?1:0,M=w[x],M&&this.setIntersection(M.object.el,M))))},twoWayEmit:function(E,x){var M=this.el,w=this.intersectedEl,S;function I(L,R){x instanceof MouseEvent?L.mouseEvent=x:typeof TouchEvent<"u"&&x instanceof TouchEvent&&(L.touchEvent=x)}S=this.el.components.raycaster.getIntersection(w),this.eventDetail.intersectedEl=w,this.eventDetail.intersection=S,I(this.eventDetail),M.emit(E,this.eventDetail),w&&(this.intersectedEventDetail.intersection=S,I(this.intersectedEventDetail),w.emit(E,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=g.checkControllerPresentAndSetup,v=g.emitIfAxesChanged,A=g.onButtonEvent,y="generic",C={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};u.exports.Component=f("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},after:["tracked-controls"],mapping:C,bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var E=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(x){A(x.detail.id,"down",E)},this.onButtonUp=function(x){A(x.detail.id,"up",E)},this.onButtonTouchStart=function(x){A(x.detail.id,"touchstart",E)},this.onButtonTouchEnd=function(x){A(x.detail.id,"touchend",E)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(x){x.detail.name!==E.name&&(E.wasControllerConnected=!0,E.removeEventListeners(),E.removeControllersUpdateListener())})},addEventListeners:function(){var E=this.el;E.addEventListener("buttonchanged",this.onButtonChanged),E.addEventListener("buttondown",this.onButtonDown),E.addEventListener("buttonup",this.onButtonUp),E.addEventListener("touchstart",this.onButtonTouchStart),E.addEventListener("touchend",this.onButtonTouchEnd),E.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var E=this.el;E.removeEventListener("buttonchanged",this.onButtonChanged),E.removeEventListener("buttondown",this.onButtonDown),E.removeEventListener("buttonup",this.onButtonUp),E.removeEventListener("touchstart",this.onButtonTouchStart),E.removeEventListener("touchend",this.onButtonTouchEnd),E.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var E=this.data,x=E.hand?E.hand:void 0;m(this,y,{hand:x,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var E=this.el,x=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}E.setAttribute("tracked-controls",{hand:x.hand,idPrefix:y,orientationOffset:x.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.wasControllerConnected&&this.checkIfControllerPresent()},onButtonChanged:function(E){var x=this.mapping.buttons[E.detail.id];x&&this.el.emit(x+"changed",E.detail.state)},onAxisMoved:function(E){v(this,this.mapping.axes,E)},initDefaultModel:function(){var E=this.modelEl=document.createElement("a-entity");E.setAttribute("geometry",{primitive:"sphere",radius:.03}),E.setAttribute("material",{color:this.data.color}),this.el.appendChild(E),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(u,p,c)=>{var f=c("./src/core/geometry.js").geometries,g=c("./src/core/geometry.js").geometryNames,m=c("./src/core/component.js").registerComponent,v=c("./src/lib/three.js"),A=new v.BufferGeometry;u.exports.Component=m("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:g,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(y){var C=this.data,E=this.el,x,M=this.system;this.geometry&&(M.unuseGeometry(y),this.geometry=null),this.geometry=M.getOrCreateGeometry(C),x=E.getObject3D("mesh"),x?x.geometry=this.geometry:(x=new v.Mesh,x.geometry=this.geometry,this.el.getAttribute("material")||(x.material=new v.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),E.setObject3D("mesh",x))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=A,this.geometry=null},updateSchema:function(y){var C=this.oldData&&this.oldData.primitive,E=y.primitive,x=f[E]&&f[E].schema;if(!x)throw new Error("Unknown geometry schema `"+E+"`");C&&C===E||this.extendSchema(x)}})},"./src/components/gltf-model.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/index.js"),v=m.debug("components:gltf-model:warn");u.exports.Component=f("gltf-model",{schema:{type:"model"},init:function(){var A=this,y=this.system.getDRACOLoader(),C=this.system.getMeshoptDecoder(),E=this.system.getKTX2Loader();this.model=null,this.loader=new g.GLTFLoader,y&&this.loader.setDRACOLoader(y),C?this.ready=C.then(function(x){A.loader.setMeshoptDecoder(x)}):this.ready=Promise.resolve(),E&&this.loader.setKTX2Loader(E)},update:function(){var A=this,y=this.el,C=this.data;C&&(this.remove(),this.ready.then(function(){A.loader.load(C,function(x){A.model=x.scene||x.scenes[0],A.model.animations=x.animations,y.setObject3D("mesh",A.model),y.emit("model-loaded",{format:"gltf",model:A.model})},void 0,function(x){var M=x&&x.message?x.message:"Failed to load glTF model";v(M),y.emit("model-error",{format:"gltf",src:C})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;f("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/constants/index.js").AFRAME_CDN_ROOT,m={toonLeft:g+"controllers/hands/leftHand.glb",toonRight:g+"controllers/hands/rightHand.glb",lowPolyLeft:g+"controllers/hands/leftHandLow.glb",lowPolyRight:g+"controllers/hands/rightHandLow.glb",highPolyLeft:g+"controllers/hands/leftHandHigh.glb",highPolyRight:g+"controllers/hands/rightHandHigh.glb"},v={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},A={};A[v.fist]="grip",A[v.thumbUp]="pistol",A[v.point]="pointing",u.exports.Component=f("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var E=this,x=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){E.handleButton("grip","down")},this.onGripUp=function(){E.handleButton("grip","up")},this.onTrackpadDown=function(){E.handleButton("trackpad","down")},this.onTrackpadUp=function(){E.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){E.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){E.handleButton("trackpad","touchend")},this.onTriggerDown=function(){E.handleButton("trigger","down")},this.onTriggerUp=function(){E.handleButton("trigger","up")},this.onTriggerTouchStart=function(){E.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){E.handleButton("trigger","touchend")},this.onGripTouchStart=function(){E.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){E.handleButton("grip","touchend")},this.onThumbstickDown=function(){E.handleButton("thumbstick","down")},this.onThumbstickUp=function(){E.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){E.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){E.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){E.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){E.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){E.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){E.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),x.addEventListener("controllerconnected",this.onControllerConnected),x.addEventListener("controllerdisconnected",this.onControllerDisconnected),x.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(E,x){var M=this.el.getObject3D("mesh");!M||!M.mixer||M.mixer.update(x/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var E=this.el;E.addEventListener("gripdown",this.onGripDown),E.addEventListener("gripup",this.onGripUp),E.addEventListener("trackpaddown",this.onTrackpadDown),E.addEventListener("trackpadup",this.onTrackpadUp),E.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),E.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),E.addEventListener("triggerdown",this.onTriggerDown),E.addEventListener("triggerup",this.onTriggerUp),E.addEventListener("triggertouchstart",this.onTriggerTouchStart),E.addEventListener("triggertouchend",this.onTriggerTouchEnd),E.addEventListener("griptouchstart",this.onGripTouchStart),E.addEventListener("griptouchend",this.onGripTouchEnd),E.addEventListener("thumbstickdown",this.onThumbstickDown),E.addEventListener("thumbstickup",this.onThumbstickUp),E.addEventListener("abuttontouchstart",this.onAorXTouchStart),E.addEventListener("abuttontouchend",this.onAorXTouchEnd),E.addEventListener("bbuttontouchstart",this.onBorYTouchStart),E.addEventListener("bbuttontouchend",this.onBorYTouchEnd),E.addEventListener("xbuttontouchstart",this.onAorXTouchStart),E.addEventListener("xbuttontouchend",this.onAorXTouchEnd),E.addEventListener("ybuttontouchstart",this.onBorYTouchStart),E.addEventListener("ybuttontouchend",this.onBorYTouchEnd),E.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),E.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var E=this.el;E.removeEventListener("gripdown",this.onGripDown),E.removeEventListener("gripup",this.onGripUp),E.removeEventListener("trackpaddown",this.onTrackpadDown),E.removeEventListener("trackpadup",this.onTrackpadUp),E.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),E.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),E.removeEventListener("triggerdown",this.onTriggerDown),E.removeEventListener("triggerup",this.onTriggerUp),E.removeEventListener("triggertouchstart",this.onTriggerTouchStart),E.removeEventListener("triggertouchend",this.onTriggerTouchEnd),E.removeEventListener("griptouchstart",this.onGripTouchStart),E.removeEventListener("griptouchend",this.onGripTouchEnd),E.removeEventListener("thumbstickdown",this.onThumbstickDown),E.removeEventListener("thumbstickup",this.onThumbstickUp),E.removeEventListener("abuttontouchstart",this.onAorXTouchStart),E.removeEventListener("abuttontouchend",this.onAorXTouchEnd),E.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),E.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),E.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),E.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),E.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),E.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),E.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),E.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(E){var x,M=this.el,w=this.data.hand,S=this.data.handModelStyle,I=this.data.color,L=this;if(x={hand:w,model:!1},w!==E){var R=m[S+w.charAt(0).toUpperCase()+w.slice(1)];this.loader.load(R,function(k){var P=k.scene.children[0],F=w==="left"?Math.PI/2:-Math.PI/2,O=M.sceneEl.hasWebXR?-Math.PI/2:0;P.mixer=new THREE.AnimationMixer(P),L.clips=k.animations,M.setObject3D("mesh",P),P.traverse(function(W){W.isMesh&&(W.material.color=new THREE.Color(I))}),P.position.set(0,0,0),P.rotation.set(O,0,F),M.setAttribute("magicleap-controls",x),M.setAttribute("vive-controls",x),M.setAttribute("oculus-touch-controls",x),M.setAttribute("pico-controls",x),M.setAttribute("windows-motion-controls",x),M.setAttribute("hp-mixed-reality-controls",x)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(E,x){var M,w=x==="down",S=x==="touchstart";if(x.indexOf("touch")===0){if(S===this.touchedButtons[E])return;this.touchedButtons[E]=S}else{if(w===this.pressedButtons[E])return;this.pressedButtons[E]=w}M=this.gesture,this.gesture=this.determineGesture(),this.gesture!==M&&(this.animateGesture(this.gesture,M),this.emitGestureEvents(this.gesture,M))},determineGesture:function(){var E,x=this.pressedButtons.grip,M=this.pressedButtons.surface||this.touchedButtons.surface,w=this.pressedButtons.trackpad||this.touchedButtons.trackpad,S=this.pressedButtons.trigger||this.touchedButtons.trigger,I=this.touchedButtons.AorX||this.touchedButtons.BorY,L=C(this.el.components["tracked-controls"]);return L?x||S?E=v.fist:w&&(E=v.point):x?M||I||w?E=S?v.fist:v.point:E=S?v.thumbUp:v.pointThumb:S&&(E=v.hold),E},getClip:function(E){var x,M;for(M=0;M<this.clips.length;M++)if(x=this.clips[M],x.name===E)return x},animateGesture:function(E,x){if(E){this.playAnimation(E||v.open,x,!1);return}this.playAnimation(x,x,!0)},emitGestureEvents:function(E,x){var M=this.el,w;x!==E&&(w=y(x,!1),w&&M.emit(w),w=y(E,!0),w&&M.emit(w))},playAnimation:function(E,x,M){var w,S,I=this.el.getObject3D("mesh"),L;if(I){if(w=this.getClip(E),L=I.mixer.clipAction(w),M){L.paused=!1,L.timeScale=-1;return}if(L.clampWhenFinished=!0,L.loop=THREE.LoopOnce,L.repetitions=0,L.timeScale=1,L.time=0,L.weight=1,!x){I.mixer.stopAllAction(),L.play();return}w=this.getClip(x),L.reset(),L.play(),S=I.mixer.clipAction(w),S.crossFadeTo(L,.15,!0)}}});function y(E,x){var M;if(E){if(M=A[E],M==="grip")return M+(x?"close":"open");if(M==="point")return M+(x?"up":"down");if(M==="pointing"||M==="pistol")return M+(x?"start":"end")}}function C(E){var x=E&&E.controller,M=x&&(x.id&&x.id.indexOf("OpenVR ")===0||x.profiles&&x.profiles[0]&&x.profiles[0]==="htc-vive");return M}},"./src/components/hand-tracking-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/core/a-entity.js").AEntity,m=c("./src/utils/tracked-controls.js"),v=m.checkControllerPresentAndSetup,A=c("./src/constants/index.js").AFRAME_CDN_ROOT,y=A+"controllers/oculus-hands/v4/left.glb",C=A+"controllers/oculus-hands/v4/right.glb",E=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],x=0,M=4,w=9,S=.015,I=.1;u.exports.Component=f("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var L=0;L<this.jointEls.length;++L)this.jointEls[L].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var L=0;L<this.jointEls.length;++L)this.jointEls[L].object3D.visible=!1},init:function(){var L=this.el.sceneEl,R=L.getAttribute("webxr"),k=R.optionalFeatures;k.indexOf("hand-tracking")===-1&&(k.push("hand-tracking"),L.setAttribute("webxr",R)),this.wristObject3D=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wristObject3D),this.onModelLoaded=this.onModelLoaded.bind(this),this.onChildAttached=this.onChildAttached.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*E.length),this.jointRadii=new Float32Array(E.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace),this.el.addEventListener("child-attached",this.onChildAttached),this.el.object3D.visible=!1,this.wristObject3D.visible=!1},onChildAttached:function(L){this.addChildEntity(L.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var L=this.jointEls,R=this.skinnedMesh,k=this.data.modelOpacity!==1;R&&(this.skinnedMesh.material.color.set(this.data.modelColor),this.skinnedMesh.material.transparent=k,this.skinnedMesh.material.opacity=this.data.modelOpacity);for(var P=0;P<L.length;P++)L[P].setAttribute("material",{color:this.data.modelColor,transparent:k,opacity:this.data.modelOpacity})},updateReferenceSpace:function(){var L=this,R=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!R){var k=L.el.sceneEl.systems.webxr.sessionReferenceSpaceType;R.requestReferenceSpace(k).then(function(P){L.referenceSpace=P}).catch(function(P){throw L.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(k,"tracked-controls-webxr uses reference space "+k),P})}},checkIfControllerPresent:function(){var L=this.data,R=L.hand?L.hand:void 0;v(this,"",{hand:R,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var L=this.el.sceneEl,R=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,k=L.frame,P=this.el.components["tracked-controls-webxr"],F=this.referenceSpace;!R||!k||!F||!P||(this.hasPoses=!1,R.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=k.fillPoses(R.hand.values(),F,this.jointPoses)&&k.fillJointRadii(R.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture(),this.updateWristObject()))},updateWristObject:function(){var L=new THREE.Matrix4;return function(){var R=this.wristObject3D;!R||!this.hasPoses||(L.fromArray(this.jointPoses,x*16),R.position.setFromMatrixPosition(L),R.quaternion.setFromRotationMatrix(L))}}(),updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(L){for(var R=this.bones,k=0;k<R.length;k++)if(R[k].name===L)return R[k];return null},updateHandMeshModel:function(){var L=new THREE.Matrix4;return function(){var R=0,k=this.jointPoses,P=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!P||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var F of P.hand.values()){var O=this.getBone(F.jointName);O!=null&&(this.mesh.visible=!0,L.fromArray(k,R*16),O.position.setFromMatrixPosition(L),O.quaternion.setFromRotationMatrix(L)),R++}}}(),updateHandDotsModel:function(){for(var L=this.jointPoses,R=this.jointRadii,k=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,P,F,O=0;O<k.hand.size;O++)P=this.jointEls[O],F=P.object3D,P.object3D.visible=this.hasPoses,this.hasPoses&&(F.matrix.fromArray(L,O*16),F.matrix.decompose(F.position,F.rotation,F.scale),P.setAttribute("scale",{x:R[O],y:R[O],z:R[O]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var L=new THREE.Vector3,R=new THREE.Matrix4;return function(){var k=this.indexTipPosition,P=this.pinchEventDetail;if(this.hasPoses){L.setFromMatrixPosition(R.fromArray(this.jointPoses,M*16)),k.setFromMatrixPosition(R.fromArray(this.jointPoses,w*16)),P.wristRotation.setFromRotationMatrix(R.fromArray(this.jointPoses,x*16));var F=k.distanceTo(L);F<S&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=F,P.position.copy(k).add(L).multiplyScalar(.5),this.el.emit("pinchstarted",P)),F>this.pinchDistance+this.pinchDistance*I&&this.isPinched===!0&&(this.isPinched=!1,P.position.copy(k).add(L).multiplyScalar(.5),this.el.emit("pinchended",P)),this.isPinched&&(P.position.copy(k).add(L).multiplyScalar(.5),this.el.emit("pinchmoved",P))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var L=this.el,R=this.data;if(L.setAttribute("tracked-controls",{id:"",hand:R.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==L.getObject3D("mesh")&&L.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var L=this.el,R;this.checkIfControllerPresent(),R=L.components["tracked-controls"]&&L.components["tracked-controls"].controller,this.mesh&&R&&R.hand&&R.hand instanceof XRHand&&L.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var L=this.data;L.modelStyle==="dots"&&this.initDotsModel(),L.modelStyle==="mesh"&&this.initMeshHandModel(),this.el.object3D.visible=!0,this.wristObject3D.visible=!0},initDotsModel:function(){if(this.jointEls.length===0){for(var L=0;L<E.length;++L){var R=this.jointEl=document.createElement("a-entity");R.setAttribute("geometry",{primitive:"sphere",radius:1}),R.object3D.visible=!1,this.el.appendChild(R),this.jointEls.push(R)}this.updateModelMaterial()}},initMeshHandModel:function(){var L=this.data.hand==="left"?y:C;this.el.setAttribute("gltf-model",L)},onModelLoaded:function(){var L=this.mesh=this.el.getObject3D("mesh").children[0],R=this.skinnedMesh=L.getObjectByProperty("type","SkinnedMesh");this.skinnedMesh&&(this.bones=R.skeleton.bones,this.el.removeObject3D("mesh"),L.position.set(0,0,0),L.rotation.set(0,0,0),R.frustumCulled=!1,R.material=new THREE.MeshStandardMaterial,this.updateModelMaterial(),this.setupChildrenEntities(),this.el.setObject3D("mesh",L))},setupChildrenEntities:function(){for(var L=this.el.children,R=0;R<L.length;++R)L[R]instanceof g&&this.addChildEntity(L[R])},addChildEntity:function(L){L instanceof g&&this.wristObject3D.add(L.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js");f("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var m=this.el,v=this.data,A;v.hand==="right"?A="components.hand-tracking-controls.bones.3":A="components.hand-tracking-controls.bones.21",m.setAttribute("hand-tracking-controls",{hand:v.hand}),m.setAttribute("obb-collider",{trackedObject3D:A,size:.04}),this.auxMatrix=new g.Matrix4,this.auxQuaternion=new g.Quaternion,this.auxQuaternion2=new g.Quaternion,this.auxVector=new g.Vector3,this.auxVector2=new g.Vector3,this.grabbingObjectPosition=new g.Vector3,this.grabbedObjectPosition=new g.Vector3,this.grabbedObjectPositionDelta=new g.Vector3,this.grabDeltaPosition=new g.Vector3,this.grabInitialRotation=new g.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var m,v=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),A=0;A<v.length;++A)m=v[A].components["hand-tracking-grab-controls"],m!==this&&this.grabbedEl&&this.grabbedEl===m.grabbedEl&&m.releaseGrabbedEntity();return!1},onCollisionStarted:function(m){var v=m.detail.withEl;this.collidedEl||v.getAttribute("grabbable")&&(this.collidedEl=v,this.grabbingObject3D=m.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(m){this.collidedEl&&(this.pinchPosition=m.detail.position,this.wristRotation=m.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(m){this.wristRotation=m.detail.wristRotation},releaseGrabbedEntity:function(){var m=this.grabbedEl;m&&(m.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,m.object3D.matrixAutoUpdate=!0,m.object3D.matrixWorldAutoUpdate=!0,m.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),m.object3D.position.copy(this.auxVector),m.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:m}),this.grabbedEl=void 0)},grab:function(){var m=this.grabbedEl,v;v=m.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(v).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=m.object3D.updateMatrixWorld,m.object3D.updateMatrixWorld=function(){},m.object3D.updateMatrixWorldChildren=function(A){for(var y=this.children,C=0,E=y.length;C<E;C++){var x=y[C];(x.matrixWorldAutoUpdate===!0||A===!0)&&x.updateMatrixWorld(!0)}},m.object3D.matrixAutoUpdate=!1,m.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:m})},tock:function(){var m=this.auxMatrix,v=this.auxQuaternion,A=this.auxQuaternion2,y,C=this.grabbedEl;C&&(y=C.object3D,y.getWorldQuaternion(A),y.matrixWorld.identity(),m.identity(),m.makeTranslation(this.pinchPosition),y.matrixWorld.multiply(m),m.identity(),m.makeRotationFromQuaternion(v.copy(this.wristRotation).multiply(this.grabInitialRotation)),y.matrixWorld.multiply(m),m.identity(),m.makeTranslation(this.grabDeltaPosition),y.matrixWorld.multiply(m),m.identity(),m.makeRotationFromQuaternion(A),y.matrixWorld.multiply(m),m.makeScale(C.object3D.scale.x,C.object3D.scale.y,C.object3D.scale.z),y.matrixWorld.multiply(m),y.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("hide-on-enter-ar",{init:function(){var g=this;this.el.sceneEl.addEventListener("enter-vr",function(){g.el.sceneEl.is("ar-mode")&&(g.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){g.el.object3D.visible=!0})}})},"./src/components/hide-on-enter-vr.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("hide-on-enter-vr",{init:function(){var g=this;this.el.sceneEl.addEventListener("enter-vr",function(){g.el.sceneEl.is("vr-mode")&&(g.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){g.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/tracked-controls.js"),v=m.checkControllerPresentAndSetup,A=m.emitIfAxesChanged,y=m.onButtonEvent,C="hp-mixed-reality",E=c("./src/constants/index.js").AFRAME_CDN_ROOT,x=E+"controllers/hp/mixed-reality/",M={x:0,y:0,z:.06},w={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},S={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};u.exports.Component=f("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:S,init:function(){var I=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){y(L.detail.id,"down",I,I.data.hand)},this.onButtonUp=function(L){y(L.detail.id,"up",I,I.data.hand)},this.onButtonTouchEnd=function(L){y(L.detail.id,"touchend",I,I.data.hand)},this.onButtonTouchStart=function(L){y(L.detail.id,"touchstart",I,I.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var I=this.data;this.controllerIndex=I.hand==="right"?0:I.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var I=this.el;I.addEventListener("buttonchanged",this.onButtonChanged),I.addEventListener("buttondown",this.onButtonDown),I.addEventListener("buttonup",this.onButtonUp),I.addEventListener("touchstart",this.onButtonTouchStart),I.addEventListener("touchend",this.onButtonTouchEnd),I.addEventListener("axismove",this.onAxisMoved),I.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var I=this.el;I.removeEventListener("buttonchanged",this.onButtonChanged),I.removeEventListener("buttondown",this.onButtonDown),I.removeEventListener("buttonup",this.onButtonUp),I.removeEventListener("touchstart",this.onButtonTouchStart),I.removeEventListener("touchend",this.onButtonTouchEnd),I.removeEventListener("axismove",this.onAxisMoved),I.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var I=this.data;v(this,C,{index:this.controllerIndex,hand:I.hand})},injectTrackedControls:function(){var I=this.el,L=this.data;I.setAttribute("tracked-controls",{idPrefix:C,hand:L.hand,controller:this.controllerIndex,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",x+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(I){var L=this.mapping[this.data.hand].buttons[I.detail.id],R;L&&(L==="trigger"&&(R=I.detail.state.value,console.log("analog value of trigger press: "+R)),this.el.emit(L+"changed",I.detail.state))},onModelLoaded:function(I){var L=I.detail.model;this.data.model&&(L.position.copy(M),L.rotation.copy(w),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new g.Vector3(0,0,0)}))},onAxisMoved:function(I){A(this,this.mapping.axes,I)}})},"./src/components/index.js":(u,p,c)=>{c("./src/components/animation.js"),c("./src/components/anchored.js"),c("./src/components/camera.js"),c("./src/components/cursor.js"),c("./src/components/geometry.js"),c("./src/components/generic-tracked-controller-controls.js"),c("./src/components/gltf-model.js"),c("./src/components/grabbable.js"),c("./src/components/hand-tracking-controls.js"),c("./src/components/hand-tracking-grab-controls.js"),c("./src/components/hand-controls.js"),c("./src/components/hide-on-enter-ar.js"),c("./src/components/hide-on-enter-vr.js"),c("./src/components/hp-mixed-reality-controls.js"),c("./src/components/layer.js"),c("./src/components/laser-controls.js"),c("./src/components/light.js"),c("./src/components/line.js"),c("./src/components/link.js"),c("./src/components/look-controls.js"),c("./src/components/magicleap-controls.js"),c("./src/components/material.js"),c("./src/components/obb-collider.js"),c("./src/components/obj-model.js"),c("./src/components/oculus-go-controls.js"),c("./src/components/oculus-touch-controls.js"),c("./src/components/pico-controls.js"),c("./src/components/position.js"),c("./src/components/raycaster.js"),c("./src/components/rotation.js"),c("./src/components/scale.js"),c("./src/components/shadow.js"),c("./src/components/sound.js"),c("./src/components/text.js"),c("./src/components/tracked-controls.js"),c("./src/components/tracked-controls-webvr.js"),c("./src/components/tracked-controls-webxr.js"),c("./src/components/visible.js"),c("./src/components/valve-index-controls.js"),c("./src/components/vive-controls.js"),c("./src/components/vive-focus-controls.js"),c("./src/components/wasd-controls.js"),c("./src/components/windows-motion-controls.js"),c("./src/components/scene/ar-hit-test.js"),c("./src/components/scene/background.js"),c("./src/components/scene/debug.js"),c("./src/components/scene/device-orientation-permission-ui.js"),c("./src/components/scene/embedded.js"),c("./src/components/scene/inspector.js"),c("./src/components/scene/fog.js"),c("./src/components/scene/keyboard-shortcuts.js"),c("./src/components/scene/pool.js"),c("./src/components/scene/real-world-meshing.js"),c("./src/components/scene/reflection.js"),c("./src/components/scene/screenshot.js"),c("./src/components/scene/stats.js"),c("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/index.js");f("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var m=this.config,v=this.data,A=this.el,y=this,C={hand:v.hand,model:v.model};A.setAttribute("hp-mixed-reality-controls",C),A.setAttribute("magicleap-controls",C),A.setAttribute("oculus-go-controls",C),A.setAttribute("oculus-touch-controls",C),A.setAttribute("pico-controls",C),A.setAttribute("valve-index-controls",C),A.setAttribute("vive-controls",C),A.setAttribute("vive-focus-controls",C),A.setAttribute("windows-motion-controls",C),A.setAttribute("generic-tracked-controller-controls",{hand:C.hand}),A.addEventListener("controllerconnected",E),A.addEventListener("controllerdisconnected",x),A.addEventListener("controllermodelready",function(M){E(M),y.modelReady=!0});function E(M){var w=m[M.detail.name];if(w){var S=g.extend({showLine:!0},w.raycaster||{});M.detail.rayOrigin&&(S.origin=M.detail.rayOrigin.origin,S.direction=M.detail.rayOrigin.direction,S.showLine=!0),M.detail.rayOrigin||!y.modelReady?A.setAttribute("raycaster",S):A.setAttribute("raycaster","showLine",!0),A.setAttribute("cursor",g.extend({fuse:!1},w.cursor))}}function x(M){var w=m[M.detail.name];w&&A.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/index.js"),m=g.debug("components:layer:warn");u.exports.Component=f("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var A=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=A.createFramebuffer();var y=this.el.sceneEl.getAttribute("webxr"),C=y.requiredFeatures;C.indexOf("layers")===-1&&(C.push("layers"),this.el.sceneEl.setAttribute("webxr",y)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(A){this.data.src!==A.src&&this.updateSrc()},updateSrc:function(){var A=this.data.type;if(this.texture=void 0,A==="quad"){this.loadQuadImage();return}if(A==="monocubemap"||A==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var A,y=this.xrGLFactory,C=this.el.sceneEl.frame,E=this.data.src,x=this.data.type;this.visibilityChanged=!1,this.layer&&(x!=="monocubemap"&&x!=="stereocubemap"||(E.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,x==="monocubemap"?(A=y.getSubImage(this.layer,C),this.loadCubeMapImage(A.colorTexture,E,0)):(A=y.getSubImage(this.layer,C,"left"),this.loadCubeMapImage(A.colorTexture,E,0),A=y.getSubImage(this.layer,C,"right"),this.loadCubeMapImage(A.colorTexture,E,6))))},loadQuadImage:function(){var A=this.data.src,y=this;this.el.sceneEl.systems.material.loadTexture(A,{src:A},function(E){y.el.sceneEl.renderer.initTexture(E),y.texture=E,A.tagName==="VIDEO"&&setTimeout(function(){y.textureIsVideo=!0},1e3),y.layer&&(y.layer.height=y.data.height/2||y.texture.image.height/1e3,y.layer.width=y.data.width/2||y.texture.image.width/1e3,y.needsRedraw=!0),y.updateQuadPanel()})},preGenerateCubeMapTextures:function(A,y){this.data.type==="monocubemap"?this.generateCubeMapTextures(A,0,y):(this.generateCubeMapTextures(A,0,y),this.generateCubeMapTextures(A,6,y))},generateCubeMapTextures:function(A,y,C){for(var E=this.data,x=this.cubeFaceSize,M=Math.min(A.width,A.height),w=[],S,I,L=0;L<6;L++){var R=document.createElement("CANVAS");R.width=R.height=x;var k=R.getContext("2d");E.rotateCubemap&&(L===2||L===3)&&(k.save(),k.translate(x,x),k.rotate(Math.PI)),k.drawImage(A,(L+y)*M,0,M,M,0,0,x,x),k.restore(),C&&C(),w.push(R)}return E.rotateCubemap&&(S=w[0],I=w[1],w[0]=I,w[1]=S,S=w[4],I=w[5],w[4]=I,w[5]=S),C&&C(),w},loadCubeMapImage:function(A,y,C){var E=this.el.sceneEl.renderer.getContext(),x;E.pixelStorei(E.UNPACK_FLIP_Y_WEBGL,!1),E.bindTexture(E.TEXTURE_CUBE_MAP,A),!y.complete||this.loadingScreen?x=this.loadingScreenImages:x=this.generateCubeMapTextures(y,C);var M=0;x.forEach(function(w,S){E.texSubImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,E.RGBA,E.UNSIGNED_BYTE,w),M=E.getError()}),M!==0&&console.log("renderingError, WebGL Error Code: "+M),E.bindTexture(E.TEXTURE_CUBE_MAP,null)},tick:function(){this.el.sceneEl.xrSession&&(!this.layer&&(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var A=this,y=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(C){A.visibilityChanged=C.session.visibilityState!=="hidden"},y==="quad"){this.initQuadLayer();return}if(y==="monocubemap"||y==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var A=this.el.sceneEl,y=A.renderer.getContext(),C=this.xrGLFactory=new XRWebGLBinding(A.xrSession,y);this.texture&&(this.layer=C.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),A.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var A=this.data.src,y=this.el.sceneEl,C=y.renderer.getContext(),E=C.getParameter(C.MAX_CUBE_MAP_TEXTURE_SIZE),x=this.cubeFaceSize=Math.min(E,Math.min(A.width,A.height)),M=this.xrGLFactory=new XRWebGLBinding(y.xrSession,C);this.layer=M.createCubeLayer({space:this.referenceSpace,viewPixelWidth:x,viewPixelHeight:x,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),y.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var A=this.cubeFaceSize,y=this.loadingScreenImages=[],C=0;C<6;C++){var E=document.createElement("CANVAS");E.width=E.height=A;var x=E.getContext("2d");E.width=E.height=A,x.fillStyle="black",x.fillRect(0,0,A,A),C!==2&&C!==3&&(x.translate(A,0),x.scale(-1,1),x.fillStyle="white",x.font="30px Arial",x.fillText("Loading",A/2,A/2)),y.push(E)}},destroyLayer:function(){this.layer&&(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(A){this.layerEnabled=A,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var A=this.quadPanelEl;this.quadPanelEl||(A=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(A)),A.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),A.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var A=this.el.sceneEl,y=this.el.sceneEl.renderer.getContext(),C=this.xrGLFactory.getSubImage(this.layer,A.frame),E=A.renderer.properties.get(this.texture).__webglTexture,x=y.getParameter(y.FRAMEBUFFER_BINDING);y.viewport(C.viewport.x,C.viewport.y,C.viewport.width,C.viewport.height),y.bindFramebuffer(y.FRAMEBUFFER,this.frameBuffer),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,C.colorTexture,0),v(y,E,C,this.data.src),y.bindFramebuffer(y.FRAMEBUFFER,x)},updateTransform:function(){var A=this.el,y=this.position,C=this.quaternion;A.object3D.updateMatrixWorld(),y.setFromMatrixPosition(A.object3D.matrixWorld),C.setFromRotationMatrix(A.object3D.matrixWorld),this.layerEnabled||y.set(0,0,1e8),this.layer.transform=new XRRigidTransform(y,C)},onEnterVR:function(){var A=this.el.sceneEl,y=A.xrSession;if(!A.hasWebXR||!XRWebGLBinding||!y){m("The layer component requires WebXR and the layers API enabled");return}y.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(A){this.referenceSpace=A}});function v(A,y,C,E){var x=A.createFramebuffer(),M=C.viewport.x,w=C.viewport.y,S=C.viewport.x+C.viewport.width,I=C.viewport.y+C.viewport.height;E.tagName==="VIDEO"&&(A.bindTexture(A.TEXTURE_2D,y),A.texSubImage2D(A.TEXTURE_2D,0,0,0,E.width,E.height,A.RGB,A.UNSIGNED_BYTE,E)),A.bindFramebuffer(A.READ_FRAMEBUFFER,x),A.framebufferTexture2D(A.READ_FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,y,0),A.readBuffer(A.COLOR_ATTACHMENT0),A.blitFramebuffer(0,0,E.width,E.height,M,w,S,I,A.COLOR_BUFFER_BIT,A.NEAREST),A.bindFramebuffer(A.READ_FRAMEBUFFER,null),A.deleteFramebuffer(x)}},"./src/components/light.js":(u,p,c)=>{var f=c("./src/utils/index.js"),g=f.diff,m=c("./src/utils/debug.js"),v=c("./src/core/component.js").registerComponent,A=c("./src/lib/three.js"),y=c("./src/utils/math.js"),C=A.MathUtils.degToRad,E=m("components:light:warn"),x=new A.CubeTextureLoader,M={};u.exports.Component=v("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var w=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(w)},update:function(w){var S=this.data,I=g(S,w),L=this.light,R=this;if(L&&!("type"in I)){var k=!1;Object.keys(I).forEach(function(P){var F=S[P];switch(P){case"color":{L.color.set(F);break}case"groundColor":{L.groundColor.set(F);break}case"angle":{L.angle=C(F);break}case"target":{F===null?(S.type==="spot"||S.type==="directional")&&(L.target=R.defaultTarget):F.hasLoaded?R.onSetTarget(F,L):F.addEventListener("loaded",R.onSetTarget.bind(R,F,L));break}case"envMap":R.updateProbeMap(S,L);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":k||(R.updateShadow(),k=!0);break;case"shadowCameraAutomatic":S.shadowCameraAutomatic?R.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(S.shadowCameraAutomatic)):R.shadowCameraAutomaticEls=[];break;default:L[P]=F}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var w=new A.Box3,S=new A.Vector3,I=new A.Vector3,L=new A.Matrix4,R=new A.Sphere,k=new A.Vector3;return function(){if(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof A.OrthographicCamera&&this.shadowCameraAutomaticEls.length){var P=this.light.shadow.camera;P.getWorldDirection(S),P.getWorldPosition(I),L.copy(P.matrixWorld),L.invert(),P.near=1,P.left=1e5,P.right=-1e5,P.top=-1e5,P.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(F){w.setFromObject(F.object3D),w.getBoundingSphere(R);var O=y.distanceOfPointFromPlane(I,S,R.center),W=y.nearestPointInPlane(I,S,R.center,k),V=W.applyMatrix4(L);P.near=Math.min(-O-R.radius-1,P.near),P.left=Math.min(-R.radius+V.x,P.left),P.right=Math.max(R.radius+V.x,P.right),P.top=Math.max(R.radius+V.y,P.top),P.bottom=Math.min(-R.radius+V.y,P.bottom)}),P.updateProjectionMatrix()}}}(),setLight:function(w){var S=this.el,I=this.getLight(w);I&&(this.light&&S.removeObject3D("light"),this.light=I,this.light.el=S,S.setObject3D("light",this.light),(w.type==="spot"||w.type==="directional"||w.type==="hemisphere")&&S.getObject3D("light").translateY(-1),w.type==="spot"&&(S.setObject3D("light-target",this.defaultTarget),S.getObject3D("light-target").position.set(0,0,-1)),w.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(w.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var w=this.el,S=this.data,I=this.light;I.castShadow=S.castShadow;var L=w.getObject3D("cameraHelper");if(S.shadowCameraVisible&&!L?w.setObject3D("cameraHelper",new A.CameraHelper(I.shadow.camera)):!S.shadowCameraVisible&&L&&w.removeObject3D("cameraHelper"),!S.castShadow)return I;I.shadow.bias=S.shadowBias,I.shadow.radius=S.shadowRadius,I.shadow.mapSize.height=S.shadowMapHeight,I.shadow.mapSize.width=S.shadowMapWidth,I.shadow.camera.near=S.shadowCameraNear,I.shadow.camera.far=S.shadowCameraFar,I.shadow.camera instanceof A.OrthographicCamera?(I.shadow.camera.top=S.shadowCameraTop,I.shadow.camera.right=S.shadowCameraRight,I.shadow.camera.bottom=S.shadowCameraBottom,I.shadow.camera.left=S.shadowCameraLeft):I.shadow.camera.fov=S.shadowCameraFov,I.shadow.camera.updateProjectionMatrix(),L&&L.update()},getLight:function(w){var S=w.angle,I=new A.Color(w.color);I=I.getHex();var L=w.decay,R=w.distance,k=new A.Color(w.groundColor);k=k.getHex();var P=w.intensity,F=w.type,O=w.target,W=null;switch(F.toLowerCase()){case"ambient":return new A.AmbientLight(I,P);case"directional":return W=new A.DirectionalLight(I,P),this.defaultTarget=W.target,O&&(O.hasLoaded?this.onSetTarget(O,W):O.addEventListener("loaded",this.onSetTarget.bind(this,O,W))),W;case"hemisphere":return new A.HemisphereLight(I,k,P);case"point":return new A.PointLight(I,P,R,L);case"spot":return W=new A.SpotLight(I,P,R,C(S),w.penumbra,L),this.defaultTarget=W.target,O&&(O.hasLoaded?this.onSetTarget(O,W):O.addEventListener("loaded",this.onSetTarget.bind(this,O,W))),W;case"probe":return W=new A.LightProbe,this.updateProbeMap(w,W),W;default:E("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",F)}},updateProbeMap:function(w,S){w.envMap||S.copy(new A.LightProbe),M[w.envMap]instanceof window.Promise&&M[w.envMap].then(function(I){S.copy(I)}),M[w.envMap]instanceof A.LightProbe&&S.copy(M[w.envMap]),M[w.envMap]=new window.Promise(function(I){f.srcLoader.validateCubemapSrc(w.envMap,function(R){x.load(R,function(k){var P=A.LightProbeGenerator.fromCubeTexture(k);M[w.envMap]=P,S.copy(P)})})})},onSetTarget:function(w,S){S.target=w.object3D},remove:function(){var w=this.el;w.removeObject3D("light"),w.getObject3D("cameraHelper")&&w.removeObject3D("cameraHelper")}})},"./src/components/line.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var m=this.data,v,A;A=this.material=new THREE.LineBasicMaterial({color:m.color,opacity:m.opacity,transparent:m.opacity<1,visible:m.visible}),v=this.geometry=new THREE.BufferGeometry,v.setAttribute("position",new THREE.BufferAttribute(new Float32Array(6),3)),this.line=new THREE.Line(v,A),this.el.setObject3D(this.attrName,this.line)},update:function(m){var v=this.data,A=this.geometry,y=!1,C=this.material,E=A.attributes.position.array;g(v.start,m.start)||(E[0]=v.start.x,E[1]=v.start.y,E[2]=v.start.z,y=!0),g(v.end,m.end)||(E[3]=v.end.x,E[4]=v.end.y,E[5]=v.end.z,y=!0),y&&(A.attributes.position.needsUpdate=!0,A.computeBoundingSphere()),C.color.setStyle(v.color),C.opacity=v.opacity,C.transparent=v.opacity<1,C.visible=v.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function g(m,v){return!m||!v?!1:m.x===v.x&&m.y===v.y&&m.z===v.z}},"./src/components/link.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/core/shader.js").registerShader,m=c("./src/lib/three.js");u.exports.Component=f("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new m.Quaternion,this.hiddenEls=[]},update:function(v){var A=this.data,y=this.el,C,E;A.visualAspectEnabled&&(this.initVisualAspect(),C=A.highlighted?A.highlightedColor:A.backgroundColor,E=A.highlighted?A.highlightedColor:A.borderColor,y.setAttribute("material","backgroundColor",C),y.setAttribute("material","strokeColor",E),A.on!==v.on&&this.updateEventListener(),v.peekMode!==void 0&&A.peekMode!==v.peekMode&&this.updatePeekMode(),!(!A.image||v.image===A.image)&&y.setAttribute("material","pano",typeof A.image=="string"?A.image:A.image.src))},updatePeekMode:function(){var v=this.el,A=this.sphereEl;this.data.peekMode?(this.hideAll(),v.getObject3D("mesh").visible=!1,A.setAttribute("visible",!0)):(this.showAll(),v.getObject3D("mesh").visible=!0,A.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var v=this.el;v.isPlaying&&(this.removeEventListener(),v.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var v=this.data.on;v&&this.el.removeEventListener(v,this.navigate)},initVisualAspect:function(){var v=this.el,A,y,C;!this.data.visualAspectEnabled||this.visualAspectInitialized||(C=this.textEl=this.textEl||document.createElement("a-entity"),y=this.sphereEl=this.sphereEl||document.createElement("a-entity"),A=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),v.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),v.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),C.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),C.setAttribute("position","0 1.5 0"),v.appendChild(C),A.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),A.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),A.setAttribute("rotation","0 180 0"),A.setAttribute("position","0 0 0"),A.setAttribute("visible",!1),v.appendChild(A),y.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),y.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),y.setAttribute("visible",!1),v.appendChild(y),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var v=new m.Vector3,A=new m.Vector3,y=new m.Quaternion,C=new m.Vector3;return function(){var E=this.el,x=E.object3D,M=E.sceneEl.camera,w,S,I=this.textEl;if(this.data.visualAspectEnabled)if(x.updateMatrixWorld(),M.parent.updateMatrixWorld(),M.updateMatrixWorld(),x.matrix.decompose(A,y,C),A.setFromMatrixPosition(x.matrixWorld),v.setFromMatrixPosition(M.matrixWorld),S=A.distanceTo(v),S>20)this.previousQuaternion||(this.quaternionClone.copy(y),this.previousQuaternion=this.quaternionClone),x.lookAt(v);else{if(w=this.calculateCameraPortalOrientation(),S<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;I.setAttribute("text","width",1.5),w<=0?(I.setAttribute("position","0 0 0.75"),I.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(I.setAttribute("position","0 0 -0.75"),I.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),E.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=w}else w<=0?I.setAttribute("rotation","0 180 0"):I.setAttribute("rotation","0 0 0"),I.setAttribute("text","width",5),I.setAttribute("position","0 1.5 0"),E.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(x.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var v=this.el,A=this.hiddenEls,y=this;A.length>0||v.sceneEl.object3D.traverse(function(C){C&&C.el&&C.el.hasAttribute("link-controls")||!C.el||C===v.sceneEl.object3D||C.el===v||C.el===y.sphereEl||C.el===v.sceneEl.cameraEl||C.el.getAttribute("visible")===!1||C.el===y.textEl||C.el===y.semiSphereEl||(C.el.setAttribute("visible",!1),A.push(C.el))})},showAll:function(){this.hiddenEls.forEach(function(v){v.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var v=new m.Matrix4,A=new m.Vector3,y=new m.Vector3(0,0,1),C=new m.Vector3(0,0,0);return function(){var E=this.el,x=E.sceneEl.camera;return A.set(0,0,0),y.set(0,0,1),C.set(0,0,0),E.object3D.matrixWorld.extractRotation(v),y.applyMatrix4(v),E.object3D.updateMatrixWorld(),E.object3D.localToWorld(C),x.parent.parent.updateMatrixWorld(),x.parent.updateMatrixWorld(),x.updateMatrixWorld(),x.localToWorld(A),A.sub(C).normalize(),y.normalize(),Math.sign(y.dot(A))}}(),remove:function(){this.removeEventListener()}}),g("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/index.js"),v=Math.PI/2;u.exports.Component=f("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new g.Vector3,this.hmdQuaternion=new g.Quaternion,this.magicWindowAbsoluteEuler=new g.Euler,this.magicWindowDeltaEuler=new g.Euler,this.position=new g.Vector3,this.magicWindowObject=new g.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new g.Vector3,rotation:new g.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var A,y=this.data;(m.device.isMobile()||m.device.isMobileDeviceRequestingDesktopSite())&&(A=this.magicWindowControls=new g.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(A.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?A.enabled=y.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){A.enabled=y.magicWindowTrackingEnabled})))},update:function(A){var y=this.data;y.enabled!==A.enabled&&this.updateGrabCursor(y.enabled),A&&!y.magicWindowTrackingEnabled&&A.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=y.magicWindowTrackingEnabled),A&&!y.pointerLockEnabled!==A.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(A){var y=this.data;y.enabled&&this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockError=this.onPointerLockError.bind(this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new g.Object3D,this.yawObject=new g.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var A=this.el.sceneEl,y=A.canvas;if(!y){A.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}y.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),y.addEventListener("touchstart",this.onTouchStart,{passive:!0}),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),window.addEventListener("touchend",this.onTouchEnd,{passive:!0}),A.addEventListener("enter-vr",this.onEnterVR),A.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var A=this.el.sceneEl,y=A&&A.canvas;y&&(y.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),y.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),A.removeEventListener("enter-vr",this.onEnterVR),A.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var A=this.el.object3D,y=this.pitchObject,C=this.yawObject,E=this.el.sceneEl;(E.is("vr-mode")||E.is("ar-mode"))&&E.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),A.rotation.x=this.magicWindowDeltaEuler.x+y.rotation.x,A.rotation.y=this.magicWindowDeltaEuler.y+C.rotation.y,A.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var A=this.magicWindowAbsoluteEuler,y=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),A.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&A.y!==0&&(this.previousMagicWindowYaw=A.y),this.previousMagicWindowYaw&&(y.x=A.x,y.y+=A.y-this.previousMagicWindowYaw,y.z=A.z,this.previousMagicWindowYaw=A.y))},onMouseMove:function(A){var y,C,E,x=this.pitchObject,M=this.previousMouseEvent,w=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(C=A.movementX||A.mozMovementX||0,E=A.movementY||A.mozMovementY||0):(C=A.screenX-M.screenX,E=A.screenY-M.screenY),this.previousMouseEvent.screenX=A.screenX,this.previousMouseEvent.screenY=A.screenY,y=this.data.reverseMouseDrag?1:-1,w.rotation.y+=C*.002*y,x.rotation.x+=E*.002*y,x.rotation.x=Math.max(-v,Math.min(v,x.rotation.x)))},onMouseDown:function(A){var y=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(y.is("vr-mode")||y.is("ar-mode"))&&y.checkHeadsetConnected())&&A.button===0){var C=y&&y.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=A.screenX,this.previousMouseEvent.screenY=A.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(C.requestPointerLock?C.requestPointerLock():C.mozRequestPointerLock&&C.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(A){A.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:A.touches[0].pageX,y:A.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(A){var y,C=this.el.sceneEl.canvas,E,x=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(E=2*Math.PI*(A.touches[0].pageX-this.touchStart.x)/C.clientWidth,y=this.data.reverseTouchDrag?1:-1,x.rotation.y-=E*.5*y,this.touchStart={x:A.touches[0].pageX,y:A.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var A=this.el.sceneEl;A.checkHeadsetConnected()&&(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),A.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){this.el.sceneEl.checkHeadsetConnected()&&(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(A){var y=this.el.sceneEl;function C(){y.canvas.classList.add("a-grab-cursor")}function E(){y.canvas.classList.remove("a-grab-cursor")}if(!y.canvas){A?y.addEventListener("render-target-loaded",C):y.addEventListener("render-target-loaded",E);return}if(A){C();return}E()},saveCameraPose:function(){var A=this.el;this.savedPose.position.copy(A.object3D.position),this.savedPose.rotation.copy(A.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var A=this.el,y=this.savedPose;this.hasSavedPose&&(A.object3D.position.copy(y.position),A.object3D.rotation.copy(y.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=g.checkControllerPresentAndSetup,v=g.emitIfAxesChanged,A=g.onButtonEvent,y="magicleap",C="-one",E=y+C,x=c("./src/constants/index.js").AFRAME_CDN_ROOT,M=x+"controllers/magicleap/magicleap-one-controller.glb",w={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};u.exports.Component=f("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:w,init:function(){var S=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(I){A(I.detail.id,"down",S)},this.onButtonUp=function(I){A(I.detail.id,"up",S)},this.onButtonTouchEnd=function(I){A(I.detail.id,"touchend",S)},this.onButtonTouchStart=function(I){A(I.detail.id,"touchstart",S)},this.previousButtonValues={},this.bindMethods()},update:function(){var S=this.data;this.controllerIndex=S.hand==="right"?0:S.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var S=this.el;S.addEventListener("buttonchanged",this.onButtonChanged),S.addEventListener("buttondown",this.onButtonDown),S.addEventListener("buttonup",this.onButtonUp),S.addEventListener("touchstart",this.onButtonTouchStart),S.addEventListener("touchend",this.onButtonTouchEnd),S.addEventListener("axismove",this.onAxisMoved),S.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var S=this.el;S.removeEventListener("buttonchanged",this.onButtonChanged),S.removeEventListener("buttondown",this.onButtonDown),S.removeEventListener("buttonup",this.onButtonUp),S.removeEventListener("touchstart",this.onButtonTouchStart),S.removeEventListener("touchend",this.onButtonTouchEnd),S.removeEventListener("axismove",this.onAxisMoved),S.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var S=this.data;m(this,E,{index:this.controllerIndex,hand:S.hand})},injectTrackedControls:function(){var S=this.el,I=this.data;S.setAttribute("tracked-controls",{idPrefix:E,hand:I.hand,controller:this.controllerIndex,orientationOffset:I.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",M)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(S){var I=this.mapping.buttons[S.detail.id],L;I&&(I==="trigger"&&(L=S.detail.state.value,console.log("analog value of trigger press: "+L)),this.el.emit(I+"changed",S.detail.state))},onModelLoaded:function(S){var I=S.detail.model;I.scale.set(.01,.01,.01)},onAxisMoved:function(S){v(this,this.mapping.axes,S)},updateModel:function(S,I){},setButtonColor:function(S,I){}})},"./src/components/material.js":(u,p,c)=>{var f=c("./src/utils/index.js"),g=c("./src/core/component.js"),m=c("./src/lib/three.js"),v=c("./src/core/shader.js"),A=f.debug("components:material:error"),y=g.registerComponent,C=v.shaders,E=v.shaderNames;u.exports.Component=y("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:E,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(S){var I=this.data;(!this.shader||I.shader!==S.shader)&&this.updateShader(I.shader),this.shader.update(this.data),this.updateMaterial(S)},updateSchema:function(S){var I,L,R,k;L=S&&S.shader,I=this.oldData&&this.oldData.shader,k=L||I,R=C[k]&&C[k].schema,R||A("Unknown shader schema "+k),!(I&&L===I)&&(this.extendSchema(R),this.updateBehavior())},updateBehavior:function(){var S,I=this.el.sceneEl,L=this.schema,R=this,k;function P(F,O){var W;for(W in k)k[W]=F;R.shader.update(k)}this.tick=void 0,k={};for(S in L)L[S].type==="time"&&(this.tick=P,k[S]=!0);I&&(this.tick?I.addBehavior(this):I.removeBehavior(this))},updateShader:function(S){var I=this.data,L=C[S]&&C[S].Shader,R;if(!L)throw new Error("Unknown shader "+S);R=this.shader=new L,R.el=this.el,R.init(I),this.setMaterial(R.material),this.updateSchema(I)},updateMaterial:function(S){var I=this.data,L=this.material,R;L.alphaTest=I.alphaTest,L.depthTest=I.depthTest!==!1,L.depthWrite=I.depthWrite!==!1,L.opacity=I.opacity,L.flatShading=I.flatShading,L.side=x(I.side),L.transparent=I.transparent!==!1||I.opacity<1,L.vertexColors=I.vertexColorsEnabled,L.visible=I.visible,L.blending=M(I.blending),L.dithering=I.dithering;for(R in S)break;R&&(S.alphaTest!==I.alphaTest||S.side!==I.side||S.vertexColorsEnabled!==I.vertexColorsEnabled)&&(L.needsUpdate=!0)},remove:function(){var S=new m.MeshBasicMaterial,I=this.material,L=this.el.getObject3D("mesh");L&&(L.material=S),w(I,this.system)},setMaterial:function(S){var I=this.el,L,R=this.system;this.material&&w(this.material,R),this.material=S,R.registerMaterial(S),L=I.getObject3D("mesh"),L?L.material=S:I.addEventListener("object3dset",function k(P){P.detail.type!=="mesh"||P.target!==I||(I.getObject3D("mesh").material=S,I.removeEventListener("object3dset",k))})}});function x(S){switch(S){case"back":return m.BackSide;case"double":return m.DoubleSide;default:return m.FrontSide}}function M(S){switch(S){case"none":return m.NoBlending;case"additive":return m.AdditiveBlending;case"subtractive":return m.SubtractiveBlending;case"multiply":return m.MultiplyBlending;default:return m.NormalBlending}}function w(S,I){S.dispose(),I.unregisterMaterial(S),Object.keys(S).filter(function(L){return S[L]&&S[L].isTexture}).forEach(function(L){S[L].dispose()})}},"./src/components/obb-collider.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js");f("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new g.Vector3().copy(this.el.object3D.scale),this.auxEuler=new g.Euler,this.boundingBox=new g.Box3,this.boundingBoxSize=new g.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var m=this.el,v=m.components["gltf-model"]&&m.components["gltf-model"].model,A,y;v&&(this.el.removeObject3D("mesh"),A=new g.Box3().setFromObject(v),y=A.getCenter(new g.Vector3),v.position.x+=v.position.x-y.x,v.position.y+=v.position.y-y.y,v.position.z+=v.position.z-y.z,this.el.setObject3D("mesh",v))},updateCollider:function(){var m=this.el,v=this.boundingBoxSize,A=this.aabb=this.aabb||new g.OBB;if(this.obb=this.obb||new g.OBB,!m.hasLoaded){m.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),A.halfSize.copy(v).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var m=this.renderColliderMesh,v=this.boundingBoxSize;if(!m){this.initColliderMesh();return}m.geometry.dispose(),m.geometry=new g.BoxGeometry(v.x,v.y,v.z)},hideCollider:function(){this.renderColliderMesh&&(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var m,v,A;m=this.boundingBoxSize,v=this.renderColliderGeometry=new g.BoxGeometry(m.x,m.y,m.z),A=this.renderColliderMesh=new g.Mesh(v,new g.MeshLambertMaterial({color:65280,side:g.DoubleSide})),A.matrixAutoUpdate=!1,A.matrixWorldAutoUpdate=!1,A.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(A)},updateBoundingBox:function(){var m=new g.Vector3,v=new g.Vector3,A=new g.Quaternion,y=new g.Quaternion,C=new g.Matrix4;return function(){var E=this.auxEuler,x=this.boundingBox,M=this.data.size,w=this.trackedObject3D||this.el.object3D,S=this.boundingBoxSize,I=this.data.minimumColliderDimension;if(M){this.boundingBoxSize.x=M,this.boundingBoxSize.y=M,this.boundingBoxSize.z=M;return}E.copy(w.rotation),w.rotation.set(0,0,0),w.parent.matrixWorld.decompose(m,A,v),C.compose(m,y,v),w.parent.matrixWorld.copy(C),x.setFromObject(w,!0),x.getSize(S),S.x=S.x<I?I:S.x,S.y=S.y<I?I:S.y,S.z=S.z<I?I:S.z,w.parent.matrixWorld.compose(m,A,v),this.el.object3D.rotation.copy(E)}}(),checkTrackedObject:function(){var m=this.trackedObject3DPath,v;if(m&&m.length&&!this.trackedObject3D){v=this.el;for(var A=0;A<m.length&&(v=v[m[A]],!!v);A++);v&&(this.trackedObject3D=v,this.updateCollider())}return this.trackedObject3D},tick:function(){var m=new g.Vector3,v=new g.Vector3,A=new g.Quaternion,y=new g.Matrix4;return function(){var C=this.obb,E=this.renderColliderMesh,x=this.checkTrackedObject()||this.el.object3D;x&&(x.updateMatrix(),x.updateMatrixWorld(!0),x.matrixWorld.decompose(m,A,v),(Math.abs(v.x-this.previousScale.x)>1e-4||Math.abs(v.y-this.previousScale.y)>1e-4||Math.abs(v.z-this.previousScale.z)>1e-4)&&this.updateCollider(),this.previousScale.copy(v),v.set(1,1,1),y.compose(m,A,v),E&&E.matrixWorld.copy(y),C.copy(this.aabb),C.applyMatrix4(y))}}()})},"./src/components/obj-model.js":(u,p,c)=>{var f=c("./src/utils/debug.js"),g=c("./src/core/component.js").registerComponent,m=c("./src/lib/three.js"),v=f("components:obj-model:warn");u.exports.Component=g("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var A=this;this.model=null,this.objLoader=new m.OBJLoader,this.mtlLoader=new m.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(y){A.model&&y.detail.name==="material"&&A.applyMaterial()})},update:function(){var A=this.data;A.obj&&(this.resetMesh(),this.loadObj(A.obj,A.mtl))},remove:function(){this.resetMesh()},resetMesh:function(){this.model&&this.el.removeObject3D("mesh")},loadObj:function(A,y){var C=this,E=this.el,x=this.mtlLoader,M=this.objLoader,w=this.el.sceneEl.systems.renderer,S=y.substr(0,y.lastIndexOf("/")+1);if(y){E.hasAttribute("material")&&v("Material component properties are ignored when a .MTL is provided"),x.setResourcePath(S),x.load(y,function(I){I.preload(),M.setMaterials(I),M.load(A,function(L){C.model=L,C.model.traverse(function(R){if(R.isMesh){var k=R.material;k.map&&w.applyColorCorrection(k.map),k.emissiveMap&&w.applyColorCorrection(k.emissiveMap)}}),E.setObject3D("mesh",L),E.emit("model-loaded",{format:"obj",model:L})})});return}M.load(A,function(L){C.model=L,C.applyMaterial(),E.setObject3D("mesh",L),E.emit("model-loaded",{format:"obj",model:L})})},applyMaterial:function(){var A=this.el.components.material;A&&this.model.traverse(function(y){y instanceof m.Mesh&&(y.material=A.material)})}})},"./src/components/oculus-go-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=g.checkControllerPresentAndSetup,v=g.emitIfAxesChanged,A=g.onButtonEvent,y=c("./src/utils/index.js").device.isWebXRAvailable,C="oculus-go",E="Oculus Go",x=c("./src/constants/index.js").AFRAME_CDN_ROOT,M=x+"controllers/oculus/go/oculus-go-controller.gltf",w=y?C:E,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},I={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},L=y?I:S;u.exports.Component=f("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:L,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var R=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(k){A(k.detail.id,"down",R)},this.onButtonUp=function(k){A(k.detail.id,"up",R)},this.onButtonTouchStart=function(k){A(k.detail.id,"touchstart",R)},this.onButtonTouchEnd=function(k){A(k.detail.id,"touchend",R)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("model-loaded",this.onModelLoaded),R.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("model-loaded",this.onModelLoaded),R.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){m(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var R=this.el,k=this.data;R.setAttribute("tracked-controls",{armModel:k.armModel,hand:k.hand,idPrefix:w,orientationOffset:k.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",M)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(R){var k=R.detail.model,P;R.target!==this.el||!this.data.model||(P=this.buttonMeshes={},P.trigger=k.getObjectByName("oculus_go_button_trigger"),P.trackpad=k.getObjectByName("oculus_go_touchpad"),P.touchpad=k.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(R){var k=this.mapping.buttons[R.detail.id];k&&this.el.emit(k+"changed",R.detail.state)},onAxisMoved:function(R){v(this,this.mapping.axes,R)},updateModel:function(R,k){this.data.model&&this.updateButtonModel(R,k)},updateButtonModel:function(R,k){var P=this.buttonMeshes;if(!(!P||!P[R])){var F,O;switch(k){case"down":F=this.data.buttonHighlightColor;break;case"touchstart":F=this.data.buttonTouchedColor;break;default:F=this.data.buttonColor}O=P[R],O.material.color.set(F)}}})},"./src/components/oculus-touch-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/tracked-controls.js"),v=m.checkControllerPresentAndSetup,A=m.emitIfAxesChanged,y=m.onButtonEvent,C=c("./src/utils/index.js").device.isWebXRAvailable,E="oculus-touch",x="Oculus Touch",M=C?E:x,w=c("./src/constants/index.js").AFRAME_CDN_ROOT,S=w+"controllers/oculus/oculus-touch-controller-",I=w+"controllers/meta/",L={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new g.Vector3(-.005,.003,-.055),modelPivotRotation:new g.Euler(0,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new g.Vector3(.005,.003,-.055),modelPivotRotation:new g.Euler(0,0,0)}},R={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new g.Vector3(-.005,.036,-.037),modelPivotRotation:new g.Euler(Math.PI/4.5,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new g.Vector3(.005,.036,-.037),modelPivotRotation:new g.Euler(Math.PI/4.5,0,0)}},k=C?R:L,P="oculus-touch",F={"oculus-touch":k,"oculus-touch-v2":{left:{modelUrl:S+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new g.Vector3(0,-.007,-.021),modelPivotRotation:new g.Euler(-Math.PI/4,0,0)},right:{modelUrl:S+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new g.Vector3(0,-.007,-.021),modelPivotRotation:new g.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:S+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new g.Vector3(0,0,0),modelPivotRotation:new g.Euler(0,0,0)},right:{modelUrl:S+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new g.Vector3(0,0,0),modelPivotRotation:new g.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:I+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new g.Vector3(0,0,0),modelPivotRotation:new g.Euler(0,0,0)},right:{modelUrl:I+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new g.Vector3(0,0,0),modelPivotRotation:new g.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:I+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new g.Vector3(0,0,0),modelPivotRotation:new g.Euler(0,0,0)},right:{modelUrl:I+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new g.Vector3(0,0,0),modelPivotRotation:new g.Euler(0,0,0)}}},O={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},W={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},V=C?W:O;u.exports.Component=f("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},after:["tracked-controls"],mapping:V,bindMethods:function(){this.onButtonChanged=this.onButtonChanged.bind(this),this.onThumbstickMoved=this.onThumbstickMoved.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var H=this;this.onButtonDown=function(Y){y(Y.detail.id,"down",H,H.data.hand)},this.onButtonUp=function(Y){y(Y.detail.id,"up",H,H.data.hand)},this.onButtonTouchStart=function(Y){y(Y.detail.id,"touchstart",H,H.data.hand)},this.onButtonTouchEnd=function(Y){y(Y.detail.id,"touchend",H,H.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new g.Euler},addEventListeners:function(){var H=this.el;H.addEventListener("buttonchanged",this.onButtonChanged),H.addEventListener("buttondown",this.onButtonDown),H.addEventListener("buttonup",this.onButtonUp),H.addEventListener("touchstart",this.onButtonTouchStart),H.addEventListener("touchend",this.onButtonTouchEnd),H.addEventListener("axismove",this.onAxisMoved),H.addEventListener("model-loaded",this.onModelLoaded),H.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var H=this.el;H.removeEventListener("buttonchanged",this.onButtonChanged),H.removeEventListener("buttondown",this.onButtonDown),H.removeEventListener("buttonup",this.onButtonUp),H.removeEventListener("touchstart",this.onButtonTouchStart),H.removeEventListener("touchend",this.onButtonTouchEnd),H.removeEventListener("axismove",this.onAxisMoved),H.removeEventListener("model-loaded",this.onModelLoaded),H.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,M,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(H){var Y=this.data,Q;if(Y.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=F[Y.controllerType]||F[P],Y.controllerType==="auto"){var G=this.el.sceneEl.systems["tracked-controls-webvr"];if(G&&G.vrDisplay){var J=G.vrDisplay.displayName;/^Oculus Quest$/.test(J)&&(this.displayModel=F["oculus-touch-v2"])}else{Q=P;for(var K=Object.keys(F),se=0;se<H.profiles.length;se++)if(K.indexOf(H.profiles[se])!==-1){Q=H.profiles[se];break}this.displayModel=F[Q]}}var ue=this.displayModel[Y.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===F["oculus-touch-v3"]||this.displayModel===F["meta-quest-touch-pro"]||this.displayModel===F["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",ue)}},injectTrackedControls:function(H){var Y=this.data,Q=E,G=Y.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",J=C?Q:G;this.el.setAttribute("tracked-controls",{id:J,hand:Y.hand,orientationOffset:Y.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(H)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(H){var Y=this.mapping[this.data.hand].buttons[H.detail.id];if(Y){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(H);else{var Q=this.buttonMeshes,G;(Y==="trigger"||Y==="grip")&&(G=H.detail.state.value),Q&&(Y==="trigger"&&Q.trigger&&(Q.trigger.rotation.x=this.originalXRotationTrigger-G*(Math.PI/26)),Y==="grip"&&Q.grip&&(G*=this.data.hand==="left"?-1:1,Q.grip.position.x=this.originalXPositionGrip+G*.004))}this.el.emit(Y+"changed",H.detail.state)}},onButtonChangedV3orPROorPlus:function(H){var Y=this.mapping[this.data.hand].buttons[H.detail.id],Q=this.buttonObjects,G;!Q||!Q[Y]||(G=H.detail.state.value,Q[Y].quaternion.slerpQuaternions(this.buttonRanges[Y].min.quaternion,this.buttonRanges[Y].max.quaternion,G),Q[Y].position.lerpVectors(this.buttonRanges[Y].min.position,this.buttonRanges[Y].max.position,G))},onModelLoaded:function(H){if(!(H.target!==this.el||!this.data.model)){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(H);else{var Y=this.controllerObject3D=H.detail.model,Q;Q=this.buttonMeshes={},Q.grip=Y.getObjectByName("buttonHand"),this.originalXPositionGrip=Q.grip&&Q.grip.position.x,Q.trigger=Y.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=Q.trigger&&Q.trigger.rotation.x,Q.thumbstick=Y.getObjectByName("stick"),Q.xbutton=Y.getObjectByName("buttonX"),Q.abutton=Y.getObjectByName("buttonA"),Q.ybutton=Y.getObjectByName("buttonY"),Q.bbutton=Y.getObjectByName("buttonB")}for(var G in this.buttonMeshes)this.buttonMeshes[G]&&$(this.buttonMeshes[G]);this.applyOffset(H.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(H){H.position.copy(this.displayModel[this.data.hand].modelPivotOffset),H.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(H){var Y=this.controllerObject3D=H.detail.model,Q=this.buttonObjects={},G=this.buttonMeshes={},J=this.buttonRanges={};G.grip=Y.getObjectByName("squeeze"),Q.grip=Y.getObjectByName("xr_standard_squeeze_pressed_value"),J.grip={min:Y.getObjectByName("xr_standard_squeeze_pressed_min"),max:Y.getObjectByName("xr_standard_squeeze_pressed_max")},Q.grip.minX=Q.grip.position.x,G.thumbstick=Y.getObjectByName("thumbstick"),Q.thumbstick=Y.getObjectByName("xr_standard_thumbstick_pressed_value"),J.thumbstick={min:Y.getObjectByName("xr_standard_thumbstick_pressed_min"),max:Y.getObjectByName("xr_standard_thumbstick_pressed_max")},Q.thumbstickXAxis=Y.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),J.thumbstickXAxis={min:Y.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:Y.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},Q.thumbstickYAxis=Y.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),J.thumbstickYAxis={min:Y.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:Y.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},G.trigger=Y.getObjectByName("trigger"),Q.trigger=Y.getObjectByName("xr_standard_trigger_pressed_value"),J.trigger={min:Y.getObjectByName("xr_standard_trigger_pressed_min"),max:Y.getObjectByName("xr_standard_trigger_pressed_max")},J.trigger.diff={x:Math.abs(J.trigger.max.rotation.x)-Math.abs(J.trigger.min.rotation.x),y:Math.abs(J.trigger.max.rotation.y)-Math.abs(J.trigger.min.rotation.y),z:Math.abs(J.trigger.max.rotation.z)-Math.abs(J.trigger.min.rotation.z)};var K=this.data.hand==="left"?"x":"a",se=this.data.hand==="left"?"y":"b",ue=K+"button",he=se+"button";G[ue]=Y.getObjectByName(K+"_button"),Q[ue]=Y.getObjectByName(K+"_button_pressed_value"),J[ue]={min:Y.getObjectByName(K+"_button_pressed_min"),max:Y.getObjectByName(K+"_button_pressed_max")},G[he]=Y.getObjectByName(se+"_button"),Q[he]=Y.getObjectByName(se+"_button_pressed_value"),J[he]={min:Y.getObjectByName(se+"_button_pressed_min"),max:Y.getObjectByName(se+"_button_pressed_max")}},onAxisMoved:function(H){A(this,this.mapping[this.data.hand].axes,H)},onThumbstickMoved:function(H){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(H);return}for(var Y in H.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[Y]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[Y]]-Math.PI/8*H.detail[Y]*(Y==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(H){var Y=(H.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,Y);var Q=(H.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,Q)},updateModel:function(H,Y){this.data.model&&this.updateButtonModel(H,Y)},updateButtonModel:function(H,Y){var Q=this.buttonMeshes,G,J;Q&&Q[H]&&(J=Y==="up"||Y==="touchend"?Q[H].originalColor||this.data.buttonColor:Y==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,G=Q[H],G.material.color.set(J))}});function $(H){H.traverse(function(Y){var Q;Y.type==="Mesh"&&(Q=Y.material.clone(),H.originalColor=Y.material.color,Y.material.dispose(),Y.material=Q)})}},"./src/components/pico-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/tracked-controls.js"),v=m.checkControllerPresentAndSetup,A=m.emitIfAxesChanged,y=m.onButtonEvent,C="pico-4",E=c("./src/constants/index.js").AFRAME_CDN_ROOT,x=E+"controllers/pico/pico4/",M={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};u.exports.Component=f("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:M,init:function(){var w=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(S){y(S.detail.id,"down",w,w.data.hand)},this.onButtonUp=function(S){y(S.detail.id,"up",w,w.data.hand)},this.onButtonTouchEnd=function(S){y(S.detail.id,"touchend",w,w.data.hand)},this.onButtonTouchStart=function(S){y(S.detail.id,"touchstart",w,w.data.hand)},this.bindMethods()},update:function(){var w=this.data;this.controllerIndex=w.hand==="right"?0:w.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("axismove",this.onAxisMoved),w.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("axismove",this.onAxisMoved),w.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var w=this.data;v(this,C,{index:this.controllerIndex,hand:w.hand})},injectTrackedControls:function(){var w=this.el,S=this.data;w.setAttribute("tracked-controls",{idPrefix:C,hand:S.hand,controller:this.controllerIndex,orientationOffset:S.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",x+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(w){var S=this.mapping[this.data.hand].buttons[w.detail.id],I;S&&(S==="trigger"&&(I=w.detail.state.value,console.log("analog value of trigger press: "+I)),this.el.emit(S+"changed",w.detail.state))},onModelLoaded:function(w){w.target!==this.el||!this.data.model||this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new g.Vector3(0,0,0)})},onAxisMoved:function(w){A(this,this.mapping.axes,w)}})},"./src/components/position.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("position",{schema:{type:"vec3"},update:function(){var g=this.el.object3D,m=this.data;g.position.set(m.x,m.y,m.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/index.js"),v=m.debug("components:raycaster:warn"),A=/^[\w\s-.,[\]#]*$/,y={childList:!0,attributes:!0,subtree:!0},C={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};u.exports.Component=f("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new g.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new g.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new g.Vector3,this.otherLineEndVec3=new g.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(x){var M=this.data,w=this.el,S=this.raycaster;S.far=M.far,S.near=M.near,M.showLine&&(M.far!==x.far||M.origin!==x.origin||M.direction!==x.direction||!x.showLine)&&(this.unitLineEndVec3.copy(M.direction).normalize(),this.drawLine()),!M.showLine&&x.showLine&&w.removeAttribute("line"),M.objects!==x.objects&&!A.test(M.objects)&&v('[raycaster] Selector "'+M.objects+'" may not update automatically with DOM changes.'),M.objects||v('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),M.autoRefresh!==x.autoRefresh&&w.isPlaying&&(M.autoRefresh?this.addEventListeners():this.removeEventListeners()),x.enabled&&!M.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){this.data.autoRefresh&&(this.observer.observe(this.el.sceneEl,y),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var x=this.data,M;M=x.objects?this.el.sceneEl.querySelectorAll(x.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(M),this.dirty=!1},tock:function(x){var M=this.data,w=this.prevCheckTime;M.enabled&&(w&&x-w<M.interval||(this.prevCheckTime=x,this.checkIntersections()))},checkIntersections:function(){var x=this.clearedIntersectedEls,M=this.el,w=this.data,S,I=this.intersectedEls,L,R=this.intersections,k=this.newIntersectedEls,P=this.newIntersections,F=this.prevIntersectedEls,O=this.rawIntersections;for(this.dirty&&this.refreshObjects(),E(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),O.length=0,this.raycaster.intersectObjects(this.objects,!0,O),R.length=0,I.length=0,S=0;S<O.length;S++)L=O[S],!(w.showLine&&L.object===M.getObject3D("line"))&&L.object.el&&(R.push(L),I.push(L.object.el));for(P.length=0,k.length=0,S=0;S<R.length;S++)F.indexOf(R[S].object.el)===-1&&(P.push(R[S]),k.push(R[S].object.el));for(x.length=0,S=0;S<F.length;S++)I.indexOf(F[S])===-1&&(F[S].emit(C.INTERSECT_CLEAR,this.intersectedClearedDetail),x.push(F[S]));for(x.length&&M.emit(C.INTERSECTION_CLEAR,this.intersectionClearedDetail),S=0;S<k.length;S++)k[S].emit(C.INTERSECT,this.intersectedDetail);P.length&&(this.intersectionDetail.els=k,this.intersectionDetail.intersections=P,M.emit(C.INTERSECTION,this.intersectionDetail)),(F.length===0&&R.length>0||F.length>0&&R.length===0||F.length&&R.length&&F[0]!==R[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=R,M.emit(C.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),w.showLine&&setTimeout(this.updateLine)},updateLine:function(){var x=this.el,M=this.intersections,w;M.length&&(M[0].object.el===x&&M[1]?w=M[1].distance:w=M[0].distance),this.drawLine(w)},getIntersection:function(x){var M,w;for(M=0;M<this.intersections.length;M++)if(w=this.intersections[M],w.object.el===x)return w;return null},updateOriginDirection:function(){var x=new g.Vector3,M=new g.Vector3;return function(){var S=this.el,I=this.data;if(I.useWorldCoordinates){this.raycaster.set(I.origin,I.direction);return}S.object3D.updateMatrixWorld(),M.setFromMatrixPosition(S.object3D.matrixWorld),(I.origin.x!==0||I.origin.y!==0||I.origin.z!==0)&&(M=S.object3D.localToWorld(M.copy(I.origin))),x.copy(I.direction).transformDirection(S.object3D.matrixWorld).normalize(),this.raycaster.set(M,x)}}(),drawLine:function(x){var M=this.data,w=this.el,S;S=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,x===void 0&&(x=M.far===1/0?1e3:M.far),this.lineData.start=M.origin,this.lineData.end=S.copy(this.unitLineEndVec3).multiplyScalar(x).add(M.origin),this.lineData.color=M.lineColor,this.lineData.opacity=M.lineOpacity,w.setAttribute("line",this.lineData)},flattenObject3DMaps:function(x){var M,w,S=this.objects,I=this.el.sceneEl.object3D;function L(k){return k.parent?L(k.parent):k===I}for(S.length=0,w=0;w<x.length;w++){var R=x[w];if(R.isEntity&&R.object3D&&L(R.object3D))for(M in R.object3DMap)S.push(R.getObject3D(M))}return S},clearAllIntersections:function(){var x;for(x=0;x<this.intersectedEls.length;x++)this.intersectedEls[x].emit(C.INTERSECT_CLEAR,this.intersectedClearedDetail);E(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(C.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function E(x,M){var w;for(x.length=M.length,w=0;w<M.length;w++)x[w]=M[w]}},"./src/components/rotation.js":(u,p,c)=>{var f=c("./src/lib/three.js").MathUtils.degToRad,g=c("./src/core/component.js").registerComponent;u.exports.Component=g("rotation",{schema:{type:"vec3"},update:function(){var m=this.data,v=this.el.object3D;v.rotation.set(f(m.x),f(m.y),f(m.z),"YXZ")},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var g=this.data,m=this.el.object3D;m.scale.set(g.x,g.y,g.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(u,p,c)=>{var f="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",g=c("./src/core/component.js").registerComponent,m=c("./src/lib/three.js"),v=21,A=function(){var x=new m.Quaternion,M=new m.Vector3;function w(S,I,L){I.position.copy(S.transform.position),I.quaternion.copy(S.transform.orientation),M.copy(L),x.copy(S.transform.orientation),M.applyQuaternion(x),I.position.sub(M)}return w}();A.tempFakePose={transform:{orientation:new m.Quaternion,position:new m.Vector3}};function y(x,M){this.renderer=x,this.xrHitTestSource=null,x.xr.addEventListener("sessionend",(function(){this.xrHitTestSource=null}).bind(this)),x.xr.addEventListener("sessionstart",(function(){this.sessionStart(M)}).bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(M)}y.prototype.previousFrameAnchors=new Set,y.prototype.anchorToObject3D=new Map;function C(x){console.warn(x.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}y.prototype.sessionStart=function(M){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){C({message:"No requestHitTestSource on the session."});return}M.space?this.session.requestHitTestSource(M).then((function(w){this.xrHitTestSource=w}).bind(this)).catch(C):M.profile&&this.session.requestHitTestSourceForTransientInput(M).then((function(w){this.xrHitTestSource=w,this.transient=!0}).bind(this)).catch(C)},y.prototype.anchorFromLastHitTestResult=function(x,M){var w=this.lastHitTest;if(w){var S={object3D:x,offset:M};Array.from(this.anchorToObject3D.entries()).forEach((function(I){var L=I[1].object3D,R=I[0];L===x&&(this.anchorToObject3D.delete(R),R.delete())}).bind(this)),w.createAnchor&&w.createAnchor().then((function(I){this.anchorToObject3D.set(I,S)}).bind(this)).catch(function(I){console.warn(I.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},y.prototype.doHit=function(M){if(this.renderer.xr.isPresenting){var w=this.renderer.xr.getReferenceSpace(),S=M.getViewerPose(w),I,L;if(this.xrHitTestSource&&S)return this.transient?(I=M.getHitTestResultsForTransientInput(this.xrHitTestSource),I.length>0?(L=I[0].results,L.length>0?(this.lastHitTest=L[0],L[0].getPose(w)):!1):!1):(I=M.getHitTestResults(this.xrHitTestSource),I.length>0?(this.lastHitTest=I[0],I[0].getPose(w)):!1)}},y.updateAnchorPoses=function(x,M){var w=x.trackedAnchors||y.prototype.previousFrameAnchors;y.prototype.previousFrameAnchors.forEach(function(S){w.has(S)||y.prototype.anchorToObject3D.delete(S)}),w.forEach(function(S){var I,L,R,k;try{I=x.getPose(S.anchorSpace,M)}catch{}if(I){if(L=y.prototype.anchorToObject3D.get(S),!L)return;R=L.offset,k=L.object3D,A(I,k,R)}})};var E;u.exports.Component=g("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:f,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:!0,init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(1048576),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new m.OrthographicCamera,this.orthoCam.layers.set(v),this.textureTarget=new m.WebGLRenderTarget(512,512,{}),this.basicMaterial=new m.MeshBasicMaterial({color:0,side:m.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new m.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var x=this.el.getAttribute("webxr"),M=x.optionalFeatures;(!M.includes("hit-test")||!M.includes("anchors"))&&(M.push("hit-test"),M.push("anchors"),this.el.setAttribute("webxr",x)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",(function(){this.hitTest=null}).bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",(function(){if(this.el.is("ar-mode")){var w=this.el.sceneEl.renderer,S=this.session=w.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,E||(E=new Map),S.requestReferenceSpace("viewer").then((function(R){this.hitTest=new y(w,{space:R}),E.set(R,this.hitTest),this.el.emit("ar-hit-test-start")}).bind(this));var I="generic-touchscreen",L=new y(w,{profile:I});S.addEventListener("selectstart",(function(R){if(this.data.enabled===!0){var k=R.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:k,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),k.profiles[0]===I?this.hitTest=L:(this.hitTest=E.get(k)||new y(w,{space:k.targetRaySpace}),E.set(k,this.hitTest)))}}).bind(this)),S.addEventListener("selectend",(function(R){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var k=R.inputSource,P;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(P=this.data.target.object3D,P&&(A.tempFakePose.transform.position.copy(this.bboxMesh.position),A.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),A(A.tempFakePose,P,this.bboxOffset),P.visible=!0,this.hitTest.anchorFromLastHitTestResult(P,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:k,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}).bind(this))}}).bind(this)),this.bboxOffset=new m.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(v),this.data.target.object3D.traverse(function(x){x.layers.enable(v)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var x=new m.PlaneGeometry(1,1),M=new m.MeshBasicMaterial({transparent:!0,color:16777215});x.rotateX(-Math.PI/2),x.rotateY(-Math.PI/2),this.bbox=new m.Box3,this.bboxMesh=new m.Mesh(x,M),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var x,M=this.el.sceneEl.renderer,w,S,I=M.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),w=M.getRenderTarget(),M.setRenderTarget(this.textureTarget),M.xr.enabled=!1,S=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,M.render(this.el.object3D,this.orthoCam),this.el.object3D.background=S,this.el.object3D.overrideMaterial=null,M.xr.enabled=I,M.setRenderTarget(w),M.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),x=this.context.getImageData(0,0,512,512);for(var L=0;L<262144;L++)x.data[L*4+3]!==0&&x.data[L*4+3]!==255&&(x.data[L*4+3]=128);this.context.putImageData(x,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var x,M=this.el.sceneEl.frame,w=this.el.sceneEl.renderer;if(M&&y.updateAnchorPoses(M,w.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var S;this.textureCache.has(this.data.src)?S=this.textureCache.get(this.data.src):(S=new m.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,S)),this.bboxMesh.material.map=S,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(x=this.hitTest.doHit(M),x&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(x.transform.position),this.bboxMesh.quaternion.copy(x.transform.orientation)))}})},"./src/components/scene/background.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},sceneOnly:!0,update:function(){var g=this.data,m=this.el.object3D;g.transparent?m.background=null:m.background=new THREE.Color(g.color)},remove:function(){var g=this.el.object3D;g.background=null}})},"./src/components/scene/debug.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("debug",{schema:{default:!0},sceneOnly:!0})},"./src/components/scene/device-orientation-permission-ui.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/constants/index.js"),m="a-modal",v="a-dialog",A="a-dialog-text",y="a-dialog-text-container",C="a-dialog-buttons-container",E="a-dialog-button",x="a-dialog-allow-button",M="a-dialog-deny-button",w="a-dialog-ok-button";u.exports.Component=f("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:!0,init:function(){var R=this;if(this.data.enabled){if(window.isSecureContext||this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=this.onDeviceMotionDialogAllowClicked.bind(this),this.onDeviceMotionDialogDenyClicked=this.onDeviceMotionDialogDenyClicked.bind(this),DeviceOrientationEvent.requestPermission().then(function(){R.el.emit("deviceorientationpermissiongranted"),R.permissionGranted=!0}).catch(function(){R.devicePermissionDialogEl=S(R.data.denyButtonText,R.data.allowButtonText,R.data.deviceMotionMessage,R.onDeviceMotionDialogAllowClicked,R.onDeviceMotionDialogDenyClicked),R.el.appendChild(R.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var R=this,k=I(R.data.cancelButtonText,R.data.httpsMessage,function(){R.el.removeChild(k)});this.el.appendChild(k)},onDeviceMotionDialogAllowClicked:function(){var R=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(k){k==="granted"?(R.el.emit("deviceorientationpermissiongranted"),R.permissionGranted=!0):R.el.emit("deviceorientationpermissionrejected"),R.remove()}).catch(console.error)}});function S(R,k,P,F,O){var W,V,$;return W=document.createElement("div"),W.classList.add(C),V=document.createElement("button"),V.classList.add(E,M),V.setAttribute(g.AFRAME_INJECTED,""),V.innerHTML=R,W.appendChild(V),$=document.createElement("button"),$.classList.add(E,x),$.setAttribute(g.AFRAME_INJECTED,""),$.innerHTML=k,W.appendChild($),$.addEventListener("click",function(H){H.stopPropagation(),F()}),V.addEventListener("click",function(H){H.stopPropagation(),O()}),L(P,W)}function I(R,k,P){var F,O;return F=document.createElement("div"),F.classList.add(C),O=document.createElement("button"),O.classList.add(E,w),O.setAttribute(g.AFRAME_INJECTED,""),O.innerHTML=R,F.appendChild(O),O.addEventListener("click",function(W){W.stopPropagation(),P()}),L(k,F)}function L(R,k){var P,F,O,W;return P=document.createElement("div"),P.classList.add(m),P.setAttribute(g.AFRAME_INJECTED,""),F=document.createElement("div"),F.className=v,F.setAttribute(g.AFRAME_INJECTED,""),P.appendChild(F),O=document.createElement("div"),O.classList.add(y),F.appendChild(O),W=document.createElement("div"),W.classList.add(A),W.innerHTML=R,O.appendChild(W),F.appendChild(k),P}},"./src/components/scene/embedded.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},sceneOnly:!0,update:function(){var g=this.el,m=g.querySelector(".a-enter-vr");this.data===!0?(m&&m.classList.add("embedded"),g.removeFullScreenStyles()):(m&&m.classList.remove("embedded"),g.addFullScreenStyles())}})},"./src/components/scene/fog.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/debug.js");m("components:fog:warn"),u.exports.Component=f("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:!0,update:function(){var A=this.data,y=this.el,C=this.el.object3D.fog;if(!C||A.type!==C.name){y.object3D.fog=v(A);return}Object.keys(this.schema).forEach(function(E){var x=A[E];E==="color"&&(x=new g.Color(x)),C[E]=x})},remove:function(){var A=this.el,y=this.el.object3D.fog;y&&(A.object3D.fog=null)}});function v(A){var y;return A.type==="exponential"?y=new g.FogExp2(A.color,A.density):y=new g.Fog(A.color,A.near,A.far),y.name=A.type,y}},"./src/components/scene/inspector.js":(u,p,c)=>{var f=c("./src/constants/index.js").AFRAME_INJECTED,g=c("./package.json"),m=c("./src/core/component.js").registerComponent,v=c("./src/utils/index.js");function A(M){var w=M.split(".");return w[2]="x",w.join(".")}var y="https://unpkg.com/aframe-inspector@"+A(g.version)+"/dist/aframe-inspector.min.js",C=y,E="Loading Inspector",x="Error loading Inspector";u.exports.Component=m("inspector",{schema:{url:{default:C}},sceneOnly:!0,init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var M;this.firstPlay&&(M=v.getUrlParameter("inspector"),M!=="false"&&M&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var M='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=E+M},remove:function(){this.removeEventListeners()},onKeydown:function(M){var w=M.keyCode===73&&(M.ctrlKey&&M.altKey||M.getModifierState("AltGraph"));w&&this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(M){M.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(M){var w=this,S;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(M);return}this.showLoader(),S=document.createElement("script"),S.src=this.data.url,S.setAttribute("data-name","aframe-inspector"),S.setAttribute(f,""),S.onload=function(){AFRAME.INSPECTOR.open(M),w.hideLoader(),w.removeEventListeners()},S.onerror=function(){w.loadingMessageEl.innerHTML=x},document.head.appendChild(S),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/index.js").shouldCaptureKeyEvent;u.exports.Component=f("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},sceneOnly:!0,init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(m){var v=this.data;this.enterVREnabled=v.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(m){var v=this.el;g(m)&&(this.enterVREnabled&&m.keyCode===70&&v.enterVR(),this.enterVREnabled&&m.keyCode===27&&v.exitVR())}})},"./src/components/scene/pool.js":(u,p,c)=>{var f=c("./src/utils/debug.js"),g=c("./src/core/component.js").registerComponent,m=f("components:pool:warn");u.exports.Component=g("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},sceneOnly:!0,multiple:!0,initPool:function(){var v;for(this.availableEls=[],this.usedEls=[],this.data.mixin||m("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||m("Container "+this.data.container+" not found.")),this.container=this.container||this.el,v=0;v<this.data.size;++v)this.createEntity()},update:function(v){var A=this.data;(v.mixin!==A.mixin||v.size!==A.size)&&this.initPool()},createEntity:function(){var v;v=document.createElement("a-entity"),v.play=this.wrapPlay(v.play),v.setAttribute("mixin",this.data.mixin),v.object3D.visible=!1,v.pause(),this.container.appendChild(v),this.availableEls.push(v);var A=this.usedEls;v.addEventListener("loaded",function(){A.indexOf(v)===-1&&(v.object3DParent=v.object3D.parent,v.object3D.parent.remove(v.object3D))})},wrapPlay:function(v){var A=this.usedEls;return function(){A.indexOf(this)!==-1&&v.call(this)}},requestEntity:function(){var v;if(this.availableEls.length===0){if(this.data.dynamic===!1){m("Requested entity from empty pool: "+this.attrName);return}else m("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return v=this.availableEls.shift(),this.usedEls.push(v),v.object3DParent&&(v.object3DParent.add(v.object3D),this.updateRaycasters()),v.object3D.visible=!0,v},returnEntity:function(v){var A=this.usedEls.indexOf(v);if(A===-1){m("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(A,1),this.availableEls.push(v),v.object3DParent=v.object3D.parent,v.object3D.parent.remove(v.object3D),this.updateRaycasters(),v.object3D.visible=!1,v.pause(),v},updateRaycasters:function(){var v=document.querySelectorAll("[raycaster]");v.forEach(function(A){A.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js");u.exports.Component=f("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},sceneOnly:!0,init:function(){var m=this.el.getAttribute("webxr"),v=m.requiredFeatures;v.indexOf("mesh-detection")===-1&&(v.push("mesh-detection"),this.el.setAttribute("webxr",m)),v.indexOf("plane-detection")===-1&&(v.push("plane-detection"),this.el.setAttribute("webxr",m)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){this.el.is("ar-mode")&&(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var m=this.data,v,A,y=this.el;y.renderer.xr;var C,E=this.meshEntities,x=!1,M=[],w=this.data.filterLabels;C=y.frame,v=C.detectedMeshes,A=C.detectedPlanes;for(var S=0;S<E.length;S++)E[S].present=!1;if(m.meshesEnabled){for(var I of v.values())if(!(w.length&&w.indexOf(I.semanticLabel)===-1)){for(S=0;S<E.length;S++)if(I===E[S].mesh){x=!0,E[S].present=!0,E[S].lastChangedTime<I.lastChangedTime&&this.updateMeshGeometry(E[S].el,I),E[S].lastChangedTime=I.lastChangedTime;break}x||M.push(I),x=!1}}if(m.planesEnabled){for(I of A.values())if(!(w.length&&w.indexOf(I.semanticLabel)===-1)){for(S=0;S<E.length;S++)if(I===E[S].mesh){x=!0,E[S].present=!0,E[S].lastChangedTime<I.lastChangedTime&&this.updateMeshGeometry(E[S].el,I),E[S].lastChangedTime=I.lastChangedTime;break}x||M.push(I),x=!1}}this.deleteMeshes(),this.createNewMeshes(M)},updateMeshes:function(){var m=new g.Matrix4;return function(){for(var v,A=this.el,y,C=A.frame,E=this.meshEntities,x=A.renderer.xr.getReferenceSpace(),M,w=0;w<E.length;w++)M=E[w].mesh.meshSpace||E[w].mesh.planeSpace,v=C.getPose(M,x),y=E[w].el,y.hasLoaded&&(m.fromArray(v.transform.matrix),m.decompose(y.object3D.position,y.object3D.quaternion,y.object3D.scale))}}(),deleteMeshes:function(){for(var m=this.meshEntities,v=[],A=0;A<m.length;A++)m[A].present?v.push(m[A]):this.el.removeChild(m[A]);this.meshEntities=v},createNewMeshes:function(m){for(var v,A=0;A<m.length;A++)v=document.createElement("a-entity"),this.meshEntities.push({mesh:m[A],el:v}),v.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(v)},initMeshGeometry:function(m){var v,A,y;if(m instanceof XRPlane){A=new g.Shape,y=m.polygon;for(var C=0;C<y.length;++C)C===0?A.moveTo(y[C].x,y[C].z):A.lineTo(y[C].x,y[C].z);return v=new g.ShapeGeometry(A),v.rotateX(Math.PI/2),v}return v=new g.BufferGeometry,v.setAttribute("position",new g.BufferAttribute(m.vertices,3)),v.setIndex(new g.BufferAttribute(m.indices,1)),v},initWorldMeshEntity:function(m){for(var v=m.target,A,y,C,E=this.meshEntities,x=0;x<E.length;x++)if(E[x].el===v){C=E[x];break}A=this.initMeshGeometry(C.mesh),y=new g.Mesh(A,new g.MeshBasicMaterial({color:Math.random()*16777215,side:g.DoubleSide})),v.setObject3D("mesh",y),C.mesh instanceof XRPlane&&this.data.planeMixin?v.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&v.setAttribute("mixin",this.data.meshMixin),v.setAttribute("data-world-mesh",C.mesh.semanticLabel)},updateMeshGeometry:function(m,v){var A=m.getObject3D("mesh");A.geometry.dispose(),A.geometry=this.initMeshGeometry(v)}})},"./src/components/scene/reflection.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;function g(m,v,A,y){var C=Math.max(m.primaryLightIntensity.x,Math.max(m.primaryLightIntensity.y,m.primaryLightIntensity.z));v.sh.fromArray(m.sphericalHarmonicsCoefficients),v.intensity=1,A&&(A.color.setRGB(m.primaryLightIntensity.x/C,m.primaryLightIntensity.y/C,m.primaryLightIntensity.z/C),A.intensity=C,y.copy(m.primaryLightDirection))}u.exports.Component=f("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:!0,init:function(){var m=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var v=this.el.getAttribute("webxr"),A=v.optionalFeatures;A.includes("light-estimation")||(A.push("light-estimation"),this.el.setAttribute("webxr",v)),this.el.addEventListener("enter-vr",function(){if(m.el.is("ar-mode")){var y=m.el.renderer,C=y.xr.getSession();C.requestLightProbe&&m.startLightProbe()}}),this.el.addEventListener("exit-vr",function(){m.xrLightProbe&&m.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var m=this.el.renderer,v=m.xr.getSession(),A=this,y=m.getContext();if(!this.probeLight){var C=document.createElement("a-light");C.setAttribute("type","probe"),C.setAttribute("intensity",0),this.el.appendChild(C),this.probeLight=C}switch(v.preferredReflectionFormat){case"srgba8":y.getExtension("EXT_sRGB");break;case"rgba16f":y.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(v,y),y.getExtension("EXT_sRGB"),y.getExtension("OES_texture_half_float"),v.requestLightProbe().then(function(E){A.xrLightProbe=E,E.addEventListener("reflectionchange",A.updateXRCubeMap.bind(A))}).catch(function(E){console.warn("Lighting estimation not supported: "+E.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var m=this.el.renderer,v=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(v){var A=m.properties.get(this.lightingEstimationTexture);A.__webglTexture=v,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var m=this.el.object3D,v=this.el.renderer,A=this.el.frame;if(A&&this.xrLightProbe){var y=A.getLightEstimate(this.xrLightProbe);y&&g(y,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(m.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(v,m),m.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&A&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),v=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);u.exports.Component=f("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:!0,setup:function(){var A=this.el;if(!this.canvas){var y=A.renderer.getContext();y&&(this.cubeMapSize=y.getParameter(y.MAX_CUBE_MAP_TEXTURE_SIZE),this.material=new g.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:m,fragmentShader:v,side:g.DoubleSide}),this.quad=new g.Mesh(new g.PlaneGeometry(1,1),this.material),this.quad.visible=!1,this.camera=new g.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),A.object3D.add(this.quad),this.onKeyDown=this.onKeyDown.bind(this))}},getRenderTarget:function(A,y){return new g.WebGLRenderTarget(A,y,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:g.LinearFilter,magFilter:g.LinearFilter,wrapS:g.ClampToEdgeWrapping,wrapT:g.ClampToEdgeWrapping,format:g.RGBAFormat,type:g.UnsignedByteType})},resize:function(A,y){this.quad.scale.set(A,y,1),this.camera.left=-1*A/2,this.camera.right=A/2,this.camera.top=y/2,this.camera.bottom=-1*y/2,this.camera.updateProjectionMatrix(),this.canvas.width=A,this.canvas.height=y},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(A){var y=A.keyCode===83&&A.ctrlKey&&A.altKey;if(!(!this.data||!y)){var C=A.shiftKey?"equirectangular":"perspective";this.capture(C)}},setCapture:function(A){var y=this.el,C,E,x,M;return A==="perspective"?(this.quad.visible=!1,E=this.data.camera&&this.data.camera.components.camera.camera||y.camera,C={width:this.data.width,height:this.data.height}):(E=this.camera,M=new g.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:g.RGBFormat,generateMipmaps:!0,minFilter:g.LinearMipmapLinearFilter,colorSpace:g.SRGBColorSpace}),x=new g.CubeCamera(y.camera.near,y.camera.far,M),y.camera.getWorldPosition(x.position),y.camera.getWorldQuaternion(x.quaternion),x.update(y.renderer,y.object3D),this.quad.material.uniforms.map.value=x.renderTarget.texture,C={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:E,size:C,projection:A}},capture:function(A){var y=this.el.renderer.xr.enabled,C=this.el.renderer,E;this.setup(),C.xr.enabled=!1,E=this.setCapture(A),this.renderCapture(E.camera,E.size,E.projection),this.saveCapture(),C.xr.enabled=y},getCanvas:function(A){var y=this.el.renderer.xr.enabled,C=this.el.renderer;this.setup();var E=this.setCapture(A);return C.xr.enabled=!1,this.renderCapture(E.camera,E.size,E.projection),C.xr.enabled=y,this.canvas},renderCapture:function(A,y,C){var E=this.el.renderer.autoClear,x=this.el,M,w,S,I=x.renderer;w=this.getRenderTarget(y.width,y.height),S=new Uint8Array(4*y.width*y.height),this.resize(y.width,y.height),I.autoClear=!0,I.clear(),I.setRenderTarget(w),I.render(x.object3D,A),I.autoClear=E,I.readRenderTargetPixels(w,0,0,y.width,y.height,S),I.setRenderTarget(null),C==="perspective"&&(S=this.flipPixelsVertically(S,y.width,y.height)),M=new ImageData(new Uint8ClampedArray(S),y.width,y.height),this.quad.visible=!1,this.ctx.putImageData(M,0,0)},flipPixelsVertically:function(A,y,C){for(var E=A.slice(0),x=0;x<y;++x)for(var M=0;M<C;++M)E[x*4+M*y*4]=A[x*4+(C-M)*y*4],E[x*4+1+M*y*4]=A[x*4+1+(C-M)*y*4],E[x*4+2+M*y*4]=A[x*4+2+(C-M)*y*4],E[x*4+3+M*y*4]=A[x*4+3+(C-M)*y*4];return E},saveCapture:function(){this.canvas.toBlob(function(A){var y="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",C=document.createElement("a"),E=URL.createObjectURL(A);C.href=E,C.setAttribute("download",y),C.innerHTML="downloading...",C.style.display="none",document.body.appendChild(C),setTimeout(function(){C.click(),document.body.removeChild(C)},1)},"image/png")}})},"./src/components/scene/stats.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./vendor/rStats.js"),m=c("./src/utils/index.js");c("./vendor/rStats.extras.js"),c("./src/lib/rStatsAframe.js");var v=window.aframeStats,A="a-hidden",y=window.threeStats;u.exports.Component=f("stats",{schema:{default:!0},sceneOnly:!0,init:function(){var E=this.el;m.getUrlParameter("stats")!=="false"&&(this.stats=C(E),this.statsEl=document.querySelector(".rs-base"),this.hideBound=this.hide.bind(this),this.showBound=this.show.bind(this),E.addEventListener("enter-vr",this.hideBound),E.addEventListener("exit-vr",this.showBound))},update:function(){if(this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var E=this.stats;E&&(E("rAF").tick(),E("FPS").frame(),E().update())},hide:function(){this.statsEl.classList.add(A)},show:function(){this.statsEl.classList.remove(A)}});function C(E){var x=new y(E.renderer),M=new v(E),w=E.isMobile?[]:[x,M];return new g({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:w})}},"./src/components/scene/xr-mode-ui.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/constants/index.js"),m=c("./src/utils/index.js"),v="a-enter-vr",A="a-enter-ar",y="a-enter-vr-button",C="a-enter-ar-button",E="a-hidden",x="a-orientation-modal";u.exports.Component=f("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:!0,init:function(){var L=this,R=this.el;m.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),R.addEventListener("enter-vr",this.updateEnterInterfaces),R.addEventListener("exit-vr",this.updateEnterInterfaces),R.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(k){k.data.type==="loaderReady"&&(L.insideLoader=!0,L.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=this.onEnterVRButtonClick.bind(this),this.onEnterARButtonClick=this.onEnterARButtonClick.bind(this),this.onModalClick=this.onModalClick.bind(this),this.toggleOrientationModalIfNeeded=this.toggleOrientationModalIfNeeded.bind(this),this.updateEnterInterfaces=this.updateEnterInterfaces.bind(this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var L=this.data,R=this.el;if(!L.enabled||this.insideLoader||m.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&L.enterVREnabled&&(L.XRMode==="xr"||L.XRMode==="vr")&&(L.enterVRButton?(this.enterVREl=document.querySelector(L.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=M(this.onEnterVRButtonClick),R.appendChild(this.enterVREl))),!this.enterAREl&&L.enterAREnabled&&(L.XRMode==="xr"||L.XRMode==="ar")&&(L.enterARButton?(this.enterAREl=document.querySelector(L.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=w(this.onEnterARButtonClick,L.XRMode==="xr"),R.appendChild(this.enterAREl))),this.orientationModalEl=S(this.onModalClick),R.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(L){L&&L.parentNode&&L.parentNode.removeChild(L)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var L=this.el;this.enterVREl&&(L.is("vr-mode")||(L.isMobile||m.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!m.device.checkVRSupport()?this.enterVREl.classList.add(E):(m.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(E),L.enterVR(!1,!0)))},toggleEnterARButtonIfNeeded:function(){var L=this.el;this.enterAREl&&(L.is("vr-mode")||!m.device.checkARSupport()?this.enterAREl.classList.add(E):(this.enterAREl.classList.remove(E),L.enterVR(!0,!0)))},toggleOrientationModalIfNeeded:function(){var L=this.el,R=this.orientationModalEl;!R||!L.isMobile||(!m.device.isLandscape()&&L.is("vr-mode")?R.classList.remove(E):R.classList.add(E))}});function M(L){var R,k;return k=document.createElement("div"),k.classList.add(v),k.setAttribute(g.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=y,R.setAttribute("title","Enter VR mode with a headset or fullscreen without"),R.setAttribute(g.AFRAME_INJECTED,""),m.device.isMobile()&&I(R),k.appendChild(R),R.addEventListener("click",function(P){L(),P.stopPropagation()}),k}function w(L,R){var k,P;return P=document.createElement("div"),P.classList.add(A),R&&P.classList.add("xr"),P.setAttribute(g.AFRAME_INJECTED,""),k=document.createElement("button"),k.className=C,k.setAttribute("title","Enter AR mode with a headset or handheld device."),k.setAttribute(g.AFRAME_INJECTED,""),m.device.isMobile()&&I(k),P.appendChild(k),k.addEventListener("click",function(F){L(),F.stopPropagation()}),P}function S(L){var R=document.createElement("div");R.className=x,R.classList.add(E),R.setAttribute(g.AFRAME_INJECTED,"");var k=document.createElement("button");return k.setAttribute(g.AFRAME_INJECTED,""),k.innerHTML="Exit VR",k.addEventListener("click",L),R.appendChild(k),R}function I(L){L.addEventListener("touchstart",function(){L.classList.remove("resethover")},{passive:!0}),L.addEventListener("touchend",function(){L.classList.add("resethover")},{passive:!0})}},"./src/components/shadow.js":(u,p,c)=>{var f=c("./src/core/component.js"),g=c("./src/lib/three.js"),m=f.registerComponent;u.exports.Component=m("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=this.update.bind(this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var v=this.data;this.updateDescendants(v.cast,v.receive)},remove:function(){var v=this.el;v.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(v,A){var y=this.el.sceneEl;this.el.object3D.traverse(function(C){if(C instanceof g.Mesh&&(C.castShadow=v,C.receiveShadow=A,y.hasLoaded&&C.material))for(var E=Array.isArray(C.material)?C.material:[C.material],x=0;x<E.length;x++)E[x].needsUpdate=!0})}})},"./src/components/sound.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/debug.js"),m=c("./src/lib/three.js"),v=g("components:sound:warn");u.exports.Component=f("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var A=this;this.listener=null,this.audioLoader=new m.AudioLoader,this.pool=new m.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){A.playSound()}},update:function(A){var y=this.data,C,E,x=y.src!==A.src;if(x){if(!y.src)return;this.setupSound()}for(C=0;C<this.pool.children.length;C++)E=this.pool.children[C],y.positional&&(E.setDistanceModel(y.distanceModel),E.setMaxDistance(y.maxDistance),E.setRefDistance(y.refDistance),E.setRolloffFactor(y.rolloffFactor)),E.setLoop(y.loop),E.setLoopStart(y.loopStart),y.loopStart!==0&&y.loopEnd===0?E.setLoopEnd(E.buffer.duration):E.setLoopEnd(y.loopEnd),E.setVolume(y.volume),E.isPaused=!1;if(y.on!==A.on&&this.updateEventListener(A.on),x){var M=this;this.loaded=!1,this.audioLoader.load(y.src,function(w){for(C=0;C<M.pool.children.length;C++)E=M.pool.children[C],E.setBuffer(w);M.loaded=!0,m.Cache.remove(y.src),(M.data.autoplay||M.mustPlay)&&M.playSound(M.processSound),M.el.emit("sound-loaded",M.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var A,y;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(A=0;A<this.pool.children.length;A++)y=this.pool.children[A],y.disconnect()}catch{v("Audio source not properly disconnected")}},updateEventListener:function(A){var y=this.el;A&&y.removeEventListener(A,this.playSoundBound),y.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var A=this.el,y,C=A.sceneEl,E=this,x;this.pool.children.length>0&&(this.stopSound(),A.removeObject3D("sound"));var M=this.listener=C.audioListener||new m.AudioListener;for(C.audioListener=M,C.camera&&C.camera.add(M),C.addEventListener("camera-set-active",function(w){w.detail.cameraEl.getObject3D("camera").add(M)}),this.pool=new m.Group,y=0;y<this.data.poolSize;y++)x=this.data.positional?new m.PositionalAudio(M):new m.Audio(M),this.pool.add(x);for(A.setObject3D(this.attrName,this.pool),y=0;y<this.pool.children.length;y++)x=this.pool.children[y],x.onEnded=function(){this.isPlaying=!1,E.el.emit("sound-ended",E.evtDetail,!1)}},pauseSound:function(){var A,y;for(this.isPlaying=!1,A=0;A<this.pool.children.length;A++)y=this.pool.children[A],!(!y.source||!y.source.buffer||!y.isPlaying||y.isPaused)&&(y.isPaused=!0,y.pause())},playSound:function(A){var y,C,E;if(!this.loaded){v("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=A;return}for(y=!1,this.isPlaying=!0,C=0;C<this.pool.children.length;C++)if(E=this.pool.children[C],!E.isPlaying&&E.buffer&&!y){A&&A(E),E.play(),E.isPaused=!1,y=!0;continue}if(!y){v("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var A,y;for(this.isPlaying=!1,A=0;A<this.pool.children.length;A++){if(y=this.pool.children[A],!y.source||!y.source.buffer)return;y.stop()}}})},"./src/components/text.js":(u,p,c)=>{var f=c("./node_modules/three-bmfont-text/index.js"),g=c("./node_modules/load-bmfont/browser.js"),m=c("./src/core/component.js").registerComponent,v=c("./src/core/shader.js"),A=c("./src/lib/three.js"),y=c("./src/utils/index.js"),C=y.debug("components:text:error"),E=v.shaders,x=y.debug("components:text:warn"),M=1,w=16,S=c("./src/constants/index.js").AFRAME_CDN_ROOT,I=S+"fonts/",L={aileronsemibold:I+"Aileron-Semibold.fnt",dejavu:I+"DejaVu-sdf.fnt",exo2bold:I+"Exo2Bold.fnt",exo2semibold:I+"Exo2SemiBold.fnt",kelsonsans:I+"KelsonSans.fnt",monoid:I+"Monoid.fnt",mozillavr:I+"mozillavr.fnt",roboto:I+"Roboto-msdf.json",sourcecodepro:I+"SourceCodePro.fnt"},R=["roboto"],k="roboto";u.exports.FONTS=L;var P=new J,F={},O={},W=/^\w+:/;u.exports.Component=m("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:k},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:E},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=f(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(K){var se=this.data,ue=this.currentFont;if(O[se.font]?this.texture=O[se.font]:(this.texture=O[se.font]=new A.Texture,this.texture.anisotropy=w),this.createOrUpdateMaterial(),K.font!==se.font){this.updateFont();return}ue&&(this.updateGeometry(this.geometry,ue),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var K=this.data,se,ue=this.material,he,Me=this.shaderData,de;if(de=K.shader,R.indexOf(K.font)!==-1||K.font.indexOf("-msdf.")>=0?de="msdf":K.font in L&&R.indexOf(K.font)===-1&&(de="sdf"),se=(this.shaderObject&&this.shaderObject.name)!==de,Me.alphaTest=K.alphaTest,Me.color=K.color,Me.map=this.texture,Me.opacity=K.opacity,Me.side=V(K.side),Me.transparent=K.transparent,Me.negate=K.negate,!se){this.shaderObject.update(Me),ue.transparent=Me.transparent,ue.side=Me.side;return}he=Y(this.el,de,Me),this.material=he.material,this.shaderObject=he.shader,this.material.side=Me.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var K=this.data,se=this.el,ue,he=this.geometry,Me=this;K.font||x("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),ue=this.lookupFont(K.font||k)||K.font,P.get(ue,function(){return $(ue,K.yOffset)}).then(function(Pe){var Se;if(Pe.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");F[ue]||(Pe.widthFactor=F[Pe]=G(Pe)),Me.currentFont=Pe,Se=Me.getFontImageSrc(),P.get(Se,function(){return H(Se)}).then(function(Le){var be=Me.texture;be&&(be.image=Le,be.needsUpdate=!0,O[K.font]=be,Me.texture=be,Me.initMesh(),Me.currentFont=Pe,Me.updateGeometry(he,Pe),Me.updateLayout(),Me.mesh.visible=!0,se.emit("textfontset",{font:K.font,fontObj:Pe}))}).catch(function(Le){C(Le.message),C(Le.stack)})}).catch(function(de){C(de.message),C(de.stack)})},initMesh:function(){this.mesh||(this.mesh=new A.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var K=this.lookupFont(this.data.font||k)||this.data.font,se=this.currentFont.pages[0];return se.match(W)&&se.indexOf("http")!==0?K.replace(/(\.fnt)|(\.json)/,".png"):A.LoaderUtils.extractUrlBase(K)+se},updateLayout:function(){var K,se,ue=this.el,he=this.data,Me=this.geometry,de,Pe,Se,Le=this.mesh,be,je,Te,rt,mt;if(!(!Le||!Me.layout)){if(de=ue.getAttribute("geometry"),Te=he.width||de&&de.width||M,be=Q(he.wrapPixels,he.wrapCount,this.currentFont.widthFactor),je=Te/be,Se=Me.layout,Pe=je*(Se.height+Se.descender),de&&de.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!de.width,this.hasExplicitGeoHeight=!!de.height),this.hasExplicitGeoWidth||ue.setAttribute("geometry","width",Te),this.hasExplicitGeoHeight||ue.setAttribute("geometry","height",Pe)),K=he.anchor==="align"?he.align:he.anchor,K==="left")rt=0;else if(K==="right")rt=-1*Se.width;else if(K==="center")rt=-1*Se.width/2;else throw new TypeError("Invalid text.anchor property value",K);if(se=he.baseline,se==="bottom")mt=0;else if(se==="top")mt=-1*Se.height+Se.ascender;else if(se==="center")mt=-1*Se.height/2;else throw new TypeError("Invalid text.baseline property value",se);Le.position.x=rt*je+he.xOffset,Le.position.y=mt*je,Le.position.z=he.zOffset,Le.scale.set(je,-1*je,je)}},lookupFont:function(K){return L[K]},updateGeometry:function(){var K={},se={},ue=/\\n/g,he=/\\t/g;return function(Me,de){var Pe=this.data;se.font=de,se.lineHeight=Pe.lineHeight&&isFinite(Pe.lineHeight)?Pe.lineHeight:de.common.lineHeight,se.text=Pe.value.toString().replace(ue,`
`).replace(he,"	"),se.width=Q(Pe.wrapPixels,Pe.wrapCount,de.widthFactor),Me.update(y.extend(K,Pe,se))}}()});function V(K){switch(K){case"back":return A.FrontSide;case"double":return A.DoubleSide;default:return A.BackSide}}function $(K,se){return new Promise(function(ue,he){g(K,function(Me,de){if(Me){C("Error loading font",K),he(Me);return}K.indexOf("/Roboto-msdf.json")>=0&&(se=30),se&&de.chars.map(function(Se){Se.yoffset+=se}),ue(de)})})}function H(K){return new Promise(function(se,ue){new A.ImageLoader().load(K,function(he){se(he)},void 0,function(){C("Error loading font image",K),ue(null)})})}function Y(K,se,ue){var he,Me;return Me=new E[se].Shader,Me.el=K,Me.init(ue),Me.update(ue),he=Me.material,he.transparent=ue.transparent,{material:he,shader:Me}}function Q(K,se,ue){return K||(.5+se)*ue}function G(K){var se=0,ue=0,he=0;return K.chars.map(function(Me){se+=Me.xadvance,Me.id>=48&&Me.id<=57&&(he++,ue+=Me.xadvance)}),he?ue/he:se/K.chars.length}function J(){var K=this.cache={};this.get=function(se,ue){return se in K||(K[se]=ue()),K[se]}}},"./src/components/tracked-controls-webvr.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=c("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,v=c("./src/lib/three.js"),A=c("./src/constants/index.js").DEFAULT_HANDEDNESS,y={x:.175,y:-.3,z:-.03},C={x:0,y:0,z:-.175},E={touches:[]},x={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};u.exports.Component=f("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new v.Vector3,this.controllerQuaternion=new v.Quaternion,this.controllerEuler=new v.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(M,w){var S=this.el.getObject3D("mesh");S&&S.update&&S.update(w/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return m},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var M=this.data,w=g.findMatchingControllerWebVR(this.system.controllers,M.id,M.idPrefix,M.hand,M.controller);this.controller=w,this.el.components["tracked-controls"].controller=w,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(M){var w=this.controller,S=this.controllerEuler,I=this.controllerQuaternion,L=this.deltaControllerPosition,R,k,P,F,O;k=this.getHeadElement(),P=k.object3D,O=this.defaultUserHeight(),F=w.pose,R=(w?w.hand:void 0)||A,M.copy(P.position),L.set(y.x*(R==="left"?-1:R==="right"?1:0),y.y,y.z),L.multiplyScalar(O),L.applyAxisAngle(P.up,P.rotation.y),M.add(L),L.set(C.x,C.y,C.z),L.multiplyScalar(O),F.orientation?I.fromArray(F.orientation):I.copy(P.quaternion),S.setFromQuaternion(I),S.set(S.x,S.y,0),L.applyEuler(S),M.add(L)},updatePose:function(){var M=this.controller,w=this.data,S=this.el.object3D,I,L=this.system.vrDisplay,R;M&&(I=M.pose,I.position?S.position.fromArray(I.position):w.armModel&&this.applyArmModel(S.position),I.orientation&&S.quaternion.fromArray(I.orientation),L&&I.position&&(R=this.el.sceneEl.renderer.xr.getStandingMatrix(),S.matrix.compose(S.position,S.quaternion,S.scale),S.matrix.multiplyMatrices(R,S.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),S.rotateX(this.data.orientationOffset.x*v.MathUtils.DEG2RAD),S.rotateY(this.data.orientationOffset.y*v.MathUtils.DEG2RAD),S.rotateZ(this.data.orientationOffset.z*v.MathUtils.DEG2RAD))},updateButtons:function(){var M,w=this.controller,S;if(w){for(S=0;S<w.buttons.length;++S)this.buttonStates[S]||(this.buttonStates[S]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[S]||(this.buttonEventDetails[S]={id:S,state:this.buttonStates[S]}),M=w.buttons[S],this.handleButton(S,M);this.handleAxes()}},handleButton:function(M,w){var S;return S=this.handlePress(M,w)|this.handleTouch(M,w)|this.handleValue(M,w),S?(this.el.emit(x.BUTTONCHANGED,this.buttonEventDetails[M],!1),!0):!1},handleAxes:function(){var M=!1,w=this.controller.axes,S,I=this.axis,L=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),S=0;S<w.length;++S)L.push(I[S]!==w[S]),L[S]&&(M=!0);if(!M)return!1;for(this.axis.splice(0,this.axis.length),S=0;S<w.length;S++)this.axis.push(w[S]);return this.el.emit(x.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(M,w){var S,I=this.buttonStates[M];return w.pressed===I.pressed?!1:(S=w.pressed?x.BUTTONDOWN:x.BUTTONUP,this.el.emit(S,this.buttonEventDetails[M],!1),I.pressed=w.pressed,!0)},handleTouch:function(M,w){var S,I=this.buttonStates[M];return w.touched===I.touched?!1:(S=w.touched?x.TOUCHSTART:x.TOUCHEND,this.el.emit(S,this.buttonEventDetails[M],!1,E),I.touched=w.touched,!0)},handleValue:function(M,w){var S=this.buttonStates[M];return w.value===S.value?!1:(S.value=w.value,!0)}})},"./src/components/tracked-controls-webxr.js":(u,p,c)=>{var f=c("./src/utils/tracked-controls.js"),g=c("./src/core/component.js").registerComponent,m={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};u.exports.Component=g("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var v=this.el.sceneEl;this.updateController(),v.addEventListener("controllersupdated",this.updateController)},pause:function(){var v=this.el.sceneEl;v.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(v){return!(!this.controller||this.controller.gamepad||v.inputSource.handedness!=="none"&&v.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=f.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var v=this.el.sceneEl,A=this.controller,y=v.frame;!A||!v.frame||!this.system.referenceSpace||A.hand||(this.pose=y.getPose(A[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var v=this.el.object3D,A=this.pose;A&&(v.matrix.elements=A.transform.matrix,v.matrix.decompose(v.position,v.rotation,v.scale))},updateButtons:function(){var v,A,y=this.controller,C;if(!(!y||!y.gamepad)){for(C=y.gamepad,A=0;A<C.buttons.length;++A)this.buttonStates[A]||(this.buttonStates[A]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[A]||(this.buttonEventDetails[A]={id:A,state:this.buttonStates[A]}),v=C.buttons[A],this.handleButton(A,v);this.handleAxes()}},handleButton:function(v,A){var y;return y=this.handlePress(v,A)|this.handleTouch(v,A)|this.handleValue(v,A),y?(this.el.emit(m.BUTTONCHANGED,this.buttonEventDetails[v],!1),!0):!1},handleAxes:function(){var v=!1,A=this.controller.gamepad.axes,y,C=this.axis,E=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),y=0;y<A.length;++y)E.push(C[y]!==A[y]),E[y]&&(v=!0);if(!v)return!1;for(this.axis.splice(0,this.axis.length),y=0;y<A.length;y++)this.axis.push(A[y]);return this.el.emit(m.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(v,A){var y,C=this.buttonStates[v];return A.pressed===C.pressed?!1:(y=A.pressed?m.BUTTONDOWN:m.BUTTONUP,this.el.emit(y,this.buttonEventDetails[v],!1),C.pressed=A.pressed,!0)},handleTouch:function(v,A){var y,C=this.buttonStates[v];return A.touched===C.touched?!1:(y=A.touched?m.TOUCHSTART:m.TOUCHEND,this.el.emit(y,this.buttonEventDetails[v],!1),C.touched=A.touched,!0)},handleValue:function(v,A){var y=this.buttonStates[v];return A.value===y.value?!1:(y.value=A.value,!0)}})},"./src/components/tracked-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},after:["tracked-controls-webvr","tracked-controls-webxr"],update:function(){var g=this.data,m=this.el;m.sceneEl.hasWebXR?m.setAttribute("tracked-controls-webxr",{id:g.id,hand:g.hand,index:g.controller,iterateControllerProfiles:g.iterateControllerProfiles,handTrackingEnabled:g.handTrackingEnabled,space:g.space}):m.setAttribute("tracked-controls-webvr",g)}})},"./src/components/valve-index-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=c("./src/utils/tracked-controls.js"),v=m.checkControllerPresentAndSetup,A=m.emitIfAxesChanged,y=m.onButtonEvent,C=c("./src/constants/index.js").AFRAME_CDN_ROOT,E=C+"controllers/valve/index/valve-index-",x={left:E+"left.glb",right:E+"right.glb"},M="valve",w=c("./src/utils/index.js").device.isWebXRAvailable,S={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},I={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},L={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},R={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},k=w?R:L,P=w?I:S;u.exports.Component=f("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var F=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(O){y(O.detail.id,"down",F)},this.onButtonUp=function(O){y(O.detail.id,"up",F)},this.onButtonTouchEnd=function(O){y(O.detail.id,"touchend",F)},this.onButtonTouchStart=function(O){y(O.detail.id,"touchstart",F)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var F=this.el;F.addEventListener("buttonchanged",this.onButtonChanged),F.addEventListener("buttondown",this.onButtonDown),F.addEventListener("buttonup",this.onButtonUp),F.addEventListener("touchend",this.onButtonTouchEnd),F.addEventListener("touchstart",this.onButtonTouchStart),F.addEventListener("model-loaded",this.onModelLoaded),F.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var F=this.el;F.removeEventListener("buttonchanged",this.onButtonChanged),F.removeEventListener("buttondown",this.onButtonDown),F.removeEventListener("buttonup",this.onButtonUp),F.removeEventListener("touchend",this.onButtonTouchEnd),F.removeEventListener("touchstart",this.onButtonTouchStart),F.removeEventListener("model-loaded",this.onModelLoaded),F.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var F=this.data,O=F.hand==="right"?0:F.hand==="left"?1:2;v(this,M,{index:O,iterateControllerProfiles:!0,hand:F.hand})},injectTrackedControls:function(){var F=this.el,O=this.data;F.setAttribute("tracked-controls",{idPrefix:M,controller:O.hand==="right"?1:O.hand==="left"?0:2,hand:O.hand,orientationOffset:O.orientationOffset}),this.loadModel()},loadModel:function(){var F=this.data;F.model&&this.el.setAttribute("gltf-model",""+x[F.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(F){var O=this.mapping.buttons[F.detail.id],W=this.buttonMeshes,V;O&&(O==="trigger"&&(V=F.detail.state.value,W&&W.trigger&&(W.trigger.rotation.x=this.triggerOriginalRotationX-V*(Math.PI/40))),this.el.emit(O+"changed",F.detail.state))},onModelLoaded:function(F){var O,W=F.detail.model,V=this;F.target!==this.el||!this.data.model||(O=this.buttonMeshes={},O.grip={left:W.getObjectByName("leftgrip"),right:W.getObjectByName("rightgrip")},O.menu=W.getObjectByName("menubutton"),O.system=W.getObjectByName("systembutton"),O.trackpad=W.getObjectByName("touchpad"),O.trigger=W.getObjectByName("trigger"),this.triggerOriginalRotationX=O.trigger.rotation.x,Object.keys(O).forEach(function($){V.setButtonColor($,V.data.buttonColor)}),W.position.copy(P[this.data.hand]),W.rotation.copy(k[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controls",model:this.data.model,rayOrigin:new g.Vector3(0,0,0)}))},onAxisMoved:function(F){A(this,this.mapping.axes,F)},updateModel:function(F,O){var W,V;this.data.model&&(V=O.indexOf("touch")!==-1,!V&&(W=O==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(F,W)))},setButtonColor:function(F,O){}})},"./src/components/visible.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent;u.exports.Component=f("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=g.checkControllerPresentAndSetup,v=g.emitIfAxesChanged,A=g.onButtonEvent,y=c("./src/constants/index.js").AFRAME_CDN_ROOT,C=y+"controllers/vive/vr_controller_vive.obj",E=y+"controllers/vive/vr_controller_vive.mtl",x=c("./src/utils/index.js").device.isWebXRAvailable,M="htc-vive",w="OpenVR ",S=x?M:w,I={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},L={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]},R=x?L:I;u.exports.Component=f("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:R,init:function(){var k=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(P){A(P.detail.id,"down",k)},this.onButtonUp=function(P){A(P.detail.id,"up",k)},this.onButtonTouchEnd=function(P){A(P.detail.id,"touchend",k)},this.onButtonTouchStart=function(P){A(P.detail.id,"touchstart",k)},this.previousButtonValues={},this.bindMethods()},update:function(){var k=this.data;this.controllerIndex=k.hand==="right"?0:k.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var k=this.el;k.addEventListener("buttonchanged",this.onButtonChanged),k.addEventListener("buttondown",this.onButtonDown),k.addEventListener("buttonup",this.onButtonUp),k.addEventListener("touchend",this.onButtonTouchEnd),k.addEventListener("touchstart",this.onButtonTouchStart),k.addEventListener("model-loaded",this.onModelLoaded),k.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var k=this.el;k.removeEventListener("buttonchanged",this.onButtonChanged),k.removeEventListener("buttondown",this.onButtonDown),k.removeEventListener("buttonup",this.onButtonUp),k.removeEventListener("touchend",this.onButtonTouchEnd),k.removeEventListener("touchstart",this.onButtonTouchStart),k.removeEventListener("model-loaded",this.onModelLoaded),k.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var k=this.data;m(this,S,{index:this.controllerIndex,hand:k.hand})},injectTrackedControls:function(){var k=this.el,P=this.data;k.setAttribute("tracked-controls",{idPrefix:S,hand:P.hand,controller:this.controllerIndex,orientationOffset:P.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:C,mtl:E})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(k){var P=this.mapping.buttons[k.detail.id],F=this.buttonMeshes,O;P&&(P==="trigger"&&(O=k.detail.state.value,F&&F.trigger&&(F.trigger.rotation.x=-O*(Math.PI/12))),this.el.emit(P+"changed",k.detail.state))},onModelLoaded:function(k){var P,F=k.detail.model,O=this;k.target!==this.el||!this.data.model||(P=this.buttonMeshes={},P.grip={left:F.getObjectByName("leftgrip"),right:F.getObjectByName("rightgrip")},P.menu=F.getObjectByName("menubutton"),P.system=F.getObjectByName("systembutton"),P.trackpad=F.getObjectByName("touchpad"),P.touchpad=F.getObjectByName("touchpad"),P.trigger=F.getObjectByName("trigger"),Object.keys(P).forEach(function(W){O.setButtonColor(W,O.data.buttonColor)}),F.position.set(0,-.015,.04))},onAxisMoved:function(k){v(this,this.mapping.axes,k)},updateModel:function(k,P){var F,O;this.data.model&&(O=P.indexOf("touch")!==-1,!O&&(F=P==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(k,F)))},setButtonColor:function(k,P){var F=this.buttonMeshes;if(F){if(k==="grip"){F.grip.left.material.color.set(P),F.grip.right.material.color.set(P);return}F[k].material.color.set(P)}}})},"./src/components/vive-focus-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=g.checkControllerPresentAndSetup,v=g.emitIfAxesChanged,A=g.onButtonEvent,y=c("./src/constants/index.js").AFRAME_CDN_ROOT,C=y+"controllers/vive/focus-controller/focus-controller.gltf",E=c("./src/utils/index.js").device.isWebXRAvailable,x="htc-vive-focus",M="HTC Vive Focus ",w=E?x:M,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},I={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},L=E?I:S;u.exports.Component=f("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},after:["tracked-controls"],mapping:L,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var R=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(k){A(k.detail.id,"down",R)},this.onButtonUp=function(k){A(k.detail.id,"up",R)},this.onButtonTouchStart=function(k){A(k.detail.id,"touchstart",R)},this.onButtonTouchEnd=function(k){A(k.detail.id,"touchend",R)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("model-loaded",this.onModelLoaded),R.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("model-loaded",this.onModelLoaded),R.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){m(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var R=this.el,k=this.data;R.setAttribute("tracked-controls",{armModel:k.armModel,idPrefix:w,orientationOffset:k.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",C)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(R){var k=R.detail.model,P;R.target!==this.el||!this.data.model||(P=this.buttonMeshes={},P.trigger=k.getObjectByName("BumperKey"),P.triggerPressed=k.getObjectByName("BumperKey_Press"),P.triggerPressed&&(P.triggerPressed.visible=!1),P.trackpad=k.getObjectByName("TouchPad"),P.trackpadPressed=k.getObjectByName("TouchPad_Press"),P.trackpadPressed&&(P.trackpadPressed.visible=!1))},onButtonChanged:function(R){var k=this.mapping.buttons[R.detail.id];k&&this.el.emit(k+"changed",R.detail.state)},onAxisMoved:function(R){v(this,this.mapping.axes,R)},updateModel:function(R,k){this.data.model&&this.updateButtonModel(R,k)},updateButtonModel:function(R,k){var P=this.buttonMeshes,F=R+"Pressed";if(!(!P||!P[R]||!P[F])){var O;switch(k){case"down":O=this.data.buttonHighlightColor;break;case"touchstart":O=this.data.buttonTouchedColor;break}O&&P[F].material.color.set(O),P[F].visible=!!O,P[R].visible=!O}}})},"./src/components/wasd-controls.js":(u,p,c)=>{var f=c("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,g=c("./src/core/component.js").registerComponent,m=c("./src/lib/three.js"),v=c("./src/utils/index.js"),A=v.shouldCaptureKeyEvent,y=1e-5,C=.2,E=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];u.exports.Component=g("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},after:["look-controls"],init:function(){this.keys={},this.easing=1.1,this.velocity=new m.Vector3,this.onBlur=this.onBlur.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.attachVisibilityEventListeners()},tick:function(M,w){var S=this.data,I=this.el,L=this.velocity;!L[S.adAxis]&&!L[S.wsAxis]&&x(this.keys)||(w=w/1e3,this.updateVelocity(w),!(!L[S.adAxis]&&!L[S.wsAxis])&&I.object3D.position.add(this.getMovementVector(w)))},update:function(M){M.adAxis!==this.data.adAxis&&(this.velocity[M.adAxis]=0),M.wsAxis!==this.data.wsAxis&&(this.velocity[M.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(M){var w,S,I,L=this.data,R=this.keys,k=this.velocity,P,F;if(S=L.adAxis,P=L.wsAxis,M>C){k[S]=0,k[P]=0;return}var O=Math.pow(1/this.easing,M*60);k[S]!==0&&(k[S]=k[S]*O),k[P]!==0&&(k[P]=k[P]*O),Math.abs(k[S])<y&&(k[S]=0),Math.abs(k[P])<y&&(k[P]=0),L.enabled&&(w=L.acceleration,L.adEnabled&&(I=L.adInverted?-1:1,(R.KeyA||R.ArrowLeft)&&(k[S]-=I*w*M),(R.KeyD||R.ArrowRight)&&(k[S]+=I*w*M)),L.wsEnabled&&(F=L.wsInverted?-1:1,(R.KeyW||R.ArrowUp)&&(k[P]-=F*w*M),(R.KeyS||R.ArrowDown)&&(k[P]+=F*w*M)))},getMovementVector:function(){var M=new m.Vector3(0,0,0),w=new m.Euler(0,0,0,"YXZ");return function(S){var I=this.el.getAttribute("rotation"),L=this.velocity,R;return M.copy(L),M.multiplyScalar(S),I&&(R=this.data.fly?I.x:0,w.set(m.MathUtils.degToRad(R),m.MathUtils.degToRad(I.y),0),M.applyEuler(w)),M}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var M=Object.keys(this.keys),w=0;w<M.length;w++)delete this.keys[M[w]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(M){var w;A(M)&&(w=M.code||f[M.keyCode],E.indexOf(w)!==-1&&(this.keys[w]=!0))},onKeyUp:function(M){var w;w=M.code||f[M.keyCode],delete this.keys[w]}});function x(M){var w;for(w in M)return!1;return!0}},"./src/components/windows-motion-controls.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/utils/tracked-controls.js"),m=g.checkControllerPresentAndSetup,v=g.emitIfAxesChanged,A=g.onButtonEvent,y=c("./src/utils/index.js"),C=y.debug("components:windows-motion-controls:debug"),E=y.debug("components:windows-motion-controls:warn"),x=c("./src/constants/index.js").DEFAULT_HANDEDNESS,M=c("./src/constants/index.js").AFRAME_CDN_ROOT,w=M+"controllers/microsoft/",S={left:"left.glb",right:"right.glb",default:"universal.glb"},I=c("./src/utils/index.js").device.isWebXRAvailable,L="windows-mixed-reality",R="Spatial Controller (Spatial Interaction Source) ",k=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,P=I?L:R,F={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},O={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},W=I?O:F;u.exports.Component=f("windows-motion-controls",{schema:{hand:{default:x},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},after:["tracked-controls"],mapping:W,bindMethods:function(){this.onModelError=this.onModelError.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var V=this,$=this.el;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(H){A(H.detail.id,"down",V)},this.onButtonUp=function(H){A(H.detail.id,"up",V)},this.onButtonTouchStart=function(H){A(H.detail.id,"touchstart",V)},this.onButtonTouchEnd=function(H){A(H.detail.id,"touchend",V)},this.onControllerConnected=function(){V.setModelVisibility(!0)},this.onControllerDisconnected=function(){V.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},$.addEventListener("controllerconnected",this.onControllerConnected),$.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var V=this.el;V.addEventListener("buttonchanged",this.onButtonChanged),V.addEventListener("buttondown",this.onButtonDown),V.addEventListener("buttonup",this.onButtonUp),V.addEventListener("touchstart",this.onButtonTouchStart),V.addEventListener("touchend",this.onButtonTouchEnd),V.addEventListener("axismove",this.onAxisMoved),V.addEventListener("model-error",this.onModelError),V.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var V=this.el;V.removeEventListener("buttonchanged",this.onButtonChanged),V.removeEventListener("buttondown",this.onButtonDown),V.removeEventListener("buttonup",this.onButtonUp),V.removeEventListener("touchstart",this.onButtonTouchStart),V.removeEventListener("touchend",this.onButtonTouchEnd),V.removeEventListener("axismove",this.onAxisMoved),V.removeEventListener("model-error",this.onModelError),V.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){m(this,P,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var V=this.createControllerModelUrl();this.loadModel(V)},createControllerModelUrl:function(V){var $=this.el.components["tracked-controls"],H=$?$.controller:null,Y="default",Q=this.data.hand,G;if(H&&!window.hasNativeWebXRImplementation&&(Q=H.hand,!V)){var J=H.id.match(k);Y=J&&J[0]||Y}return G=S[Q]||S.default,w+Y+"/"+G},injectTrackedControls:function(){var V=this.data;this.el.setAttribute("tracked-controls",{idPrefix:P,controller:V.pair,hand:V.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(V){var $=this.createControllerModelUrl(!0);V.detail.src!==$?(E("Failed to load controller model for device, attempting to load default."),this.loadModel($)):E("Failed to load default controller model.")},loadModel:function(V){this.el.setAttribute("gltf-model","url("+V+")")},onModelLoaded:function(V){var $=this.controllerModel=V.detail.model,H=this.loadedMeshInfo,Y,Q,G,J;if(V.target!==this.el)return;if(C("Processing model"),H.buttonMeshes={},H.axisMeshes={},$){for(Y=0;Y<this.mapping.buttons.length;Y++){if(Q=this.mapping.buttonMeshNames[this.mapping.buttons[Y]],!Q){C("Skipping unknown button at index: "+Y+" with mapped name: "+this.mapping.buttons[Y]);continue}if(G=$.getObjectByName(Q),!G){E("Missing button mesh with name: "+Q);continue}J={index:Y,value:K(G,"VALUE"),pressed:K(G,"PRESSED"),unpressed:K(G,"UNPRESSED")},J.value&&J.pressed&&J.unpressed?H.buttonMeshes[this.mapping.buttons[Y]]=J:E("Missing button submesh under mesh with name: "+Q+"(VALUE: "+!!J.value+", PRESSED: "+!!J.pressed+", UNPRESSED:"+!!J.unpressed+")")}for(Y=0;Y<this.mapping.axisMeshNames.length;Y++){if(Q=this.mapping.axisMeshNames[Y],!Q){C("Skipping unknown axis at index: "+Y);continue}if(G=$.getObjectByName(Q),!G){E("Missing axis mesh with name: "+Q);continue}J={index:Y,value:K(G,"VALUE"),min:K(G,"MIN"),max:K(G,"MAX")},J.value&&J.min&&J.max?H.axisMeshes[Y]=J:E("Missing axis submesh under mesh with name: "+Q+"(VALUE: "+!!J.value+", MIN: "+!!J.min+", MAX:"+!!J.max+")")}this.calculateRayOriginFromMesh($),this.setModelVisibility()}C("Model load complete.");function K(se,ue){for(var he=0,Me=se.children.length;he<Me;he++){var de=se.children[he];if(de&&de.name===ue)return de}}},calculateRayOriginFromMesh:function(){var V=new THREE.Quaternion;return function($){var H;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,H=$.getObjectByName(this.mapping.pointingPoseMeshName),H){var Y=$.parent;Y&&($.parent=null,$.updateMatrixWorld(!0),$.parent=Y),H.getWorldPosition(this.rayOrigin.origin),H.getWorldQuaternion(V),this.rayOrigin.direction.applyQuaternion(V),Y&&$.updateMatrixWorld(!0)}else C("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var V=new THREE.Quaternion;return function($,H){var Y=this.loadedMeshInfo.axisMeshes[$];if(Y){var Q=Y.min,G=Y.max,J=Y.value,K=H*.5+.5;J.setRotationFromQuaternion(V.copy(Q.quaternion).slerp(G.quaternion,K)),J.position.lerpVectors(Q.position,G.position,K)}}}(),lerpButtonTransform:function(){var V=new THREE.Quaternion;return function($,H){var Y=this.loadedMeshInfo.buttonMeshes[$];if(Y){var Q=Y.unpressed,G=Y.pressed,J=Y.value;J.setRotationFromQuaternion(V.copy(Q.quaternion).slerp(G.quaternion,H)),J.position.lerpVectors(Q.position,G.position,H)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(V){var $=this.mapping.buttons[V.detail.id];$&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform($,V.detail.state.value),this.el.emit($+"changed",V.detail.state))},onAxisMoved:function(V){var $=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var H=0;H<$;H++)this.lerpAxisTransform(H,V.detail.axis[H]||0);v(this,this.mapping.axes,V)},setModelVisibility:function(V){var $=this.el.getObject3D("mesh");this.controllerPresent&&(V=V!==void 0?V:this.modelVisible,this.modelVisible=V,$&&($.visible=V))}})},"./src/constants/index.js":(u,p,c)=>{u.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:c("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":u=>{u.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},"./src/core/a-assets.js":(u,p,c)=>{var f=c("./src/core/a-node.js").ANode,g=c("./src/utils/debug.js"),m=c("./src/lib/three.js"),v=new m.FileLoader,A=g("core:a-assets:warn");class y extends f{constructor(){super(),this.isAssets=!0,this.fileLoader=v,this.timeout=null}doConnectedCallback(){var R=this,k,P=[],F,O,W,V,$,H;if(super.doConnectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(V=this.querySelectorAll("img"),k=0;k<V.length;k++)W=x(V[k]),P.push(new Promise(function(Y,Q){if(m.Cache.add(V[k].getAttribute("src"),W),W.complete){Y();return}W.onload=Y,W.onerror=Q}));for(O=this.querySelectorAll("audio, video"),k=0;k<O.length;k++)F=x(O[k]),!F.src&&!F.srcObject&&A("Audio/video asset has neither `src` nor `srcObject` attributes."),P.push(E(F));H=this.getChildren(),H.forEach(function(Y){!Y.isAssetItem||!Y.hasAttribute("src")||P.push(new Promise(function(G,J){if(Y.hasLoaded)return G();Y.addEventListener("loaded",G),Y.addEventListener("error",J)}))}),Promise.allSettled(P).then(function(){R.timeout!==null&&R.load()}),$=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){R.hasLoaded||(A("Asset loading timed out in",$,"ms"),R.timeout=null,R.emit("timeout"),R.load())},$)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(){return!1})}}customElements.define("a-assets",y);class C extends f{constructor(){super(),this.data=null,this.isAssetItem=!0}connectedCallback(){var R=this,k=this.getAttribute("src");v.setResponseType(this.getAttribute("response-type")||S(k)),v.load(k,function(F){R.data=F,f.prototype.load.call(R)},function(F){R.emit("progress",{loadedBytes:F.loaded,totalBytes:F.total,xhr:F})},function(F){R.emit("error",{xhr:F})})}}customElements.define("a-asset-item",C);function E(L){if(!(!L.hasAttribute("autoplay")&&L.getAttribute("preload")!=="auto"))return new Promise(function(R,k){if(L.readyState===4)return R();if(L.error)return k();L.addEventListener("loadeddata",P,!1),L.addEventListener("progress",P,!1),L.addEventListener("error",k,!1);function P(){for(var F=0,O=0;O<L.buffered.length;O++)F+=L.buffered.end(O)-L.buffered.start(O);F>=L.duration&&(L.tagName==="VIDEO"&&m.Cache.add(L.getAttribute("src"),L),R())}})}function x(L){var R=M(L);return R.tagName&&R.tagName.toLowerCase()==="video"&&(R.setAttribute("playsinline",""),R.setAttribute("webkit-playsinline","")),R!==L&&(L.parentNode.appendChild(R),L.parentNode.removeChild(L)),R}function M(L){var R,k;return L.hasAttribute("crossorigin")||(k=L.getAttribute("src"),k!==null&&(k.indexOf("://")===-1||w(k)===window.location.host))?L:(A('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',k),L.crossOrigin="anonymous",R=L.cloneNode(!0),R)}function w(L){var R=L.indexOf("://")>-1?L.split("/")[2]:L.split("/")[0];return R.substring(0,R.indexOf(":"))}function S(L){var R=I(L),k=R.lastIndexOf(".");if(k>=0){var P=R.slice(k,L.search(/\?|#|$/));if(P===".glb")return"arraybuffer"}return"text"}u.exports.inferResponseType=S;function I(L){var R=document.createElement("a");R.href=L;var k=R.search.replace(/^\?/,""),P=L.replace(k,"").replace("?","");return P.substring(P.lastIndexOf("/")+1)}u.exports.getFileNameFromURL=I},"./src/core/a-cubemap.js":(u,p,c)=>{var f=c("./src/utils/debug.js"),g=f("core:cubemap:warn");class m extends HTMLElement{constructor(A){return A=super(A),A}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}m.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var A=this.querySelectorAll("[src]"),y,C=[];if(A.length===6){for(y=0;y<A.length;y++)A[y].tagName==="IMG"?C.push(A[y]):C.push(A[y].getAttribute("src"));return C}g("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",m)},"./src/core/a-entity.js":(u,p,c)=>{var f=c("./src/core/a-node.js").ANode,g=c("./src/core/component.js").components,m=c("./src/lib/three.js"),v=c("./src/utils/index.js"),A=v.debug("core:a-entity:debug"),y=v.debug("core:a-entity:warn"),C="__",E=["position","rotation","scale","visible"],x={once:!0};class M extends f{constructor(){super(),this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new m.Group,this.object3D.rotation.order="YXZ",this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(P,F,O){var W=this.components[P];if(super.attributeChangedCallback(),W&&W.justInitialized&&O===""){delete W.justInitialized;return}!W&&O===null||this.setEntityAttribute(P,F,O)}doConnectedCallback(){var P=this,F,O;if(super.doConnectedCallback(),O=this.sceneEl,this.addToParent(),!this.isScene){if(!O){this.load();return}if(F=O.querySelector("a-assets"),F&&!F.hasLoaded){F.addEventListener("loaded",function(){P.load()});return}this.load()}}disconnectedCallback(){var P;if(this.parentEl){for(P in this.components)this.removeComponent(P,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(P){return this.object3DMap[P]}setObject3D(P,F){var O,W=this;if(!(F instanceof m.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");O=this.getObject3D(P),O&&this.object3D.remove(O),F.el=this,F.children.length&&F.traverse(function($){$.el=W}),this.object3D.add(F),this.object3DMap[P]=F,this.emit("object3dset",{object:F,type:P})}removeObject3D(P){var F=this.getObject3D(P);if(!F){y("Tried to remove `Object3D` of type:",P,"which was not defined.");return}this.object3D.remove(F),delete this.object3DMap[P],this.emit("object3dremove",{type:P})}getOrCreateObject3D(P,F){var O=this.getObject3D(P);return!O&&F&&(O=new F,this.setObject3D(P,O)),y("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),O}add(P){if(!P.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(P.object3D),this.emit("child-attached",{el:P})}addToParent(){var P=this.parentEl=this.parentNode;!P||!P.add||this.attachedToParent||(P.add(this),this.attachedToParent=!0)}removeFromParent(){var P=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,P.emit("child-detached",{el:this})}load(){var P=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){P.parentEl&&(P.updateComponents(),(P.isScene||P.parentEl.isPlaying)&&P.play())})}remove(P){P?this.object3D.remove(P.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var P=this.children,F=[],O=0;O<P.length;O++){var W=P[O];W instanceof M&&F.push(W)}return F}initComponent(P,F,O){var W,V,$,H,Y;$=v.split(P,C),H=$[0],V=$.length>2?$.slice(1).join("__"):$[1],g[H]&&(Y=w(this,P)||F!==void 0,!(!Y&&!O)&&(P in this.components||(this.initComponentDependencies(H),W=new g[H].Component(this,F,V),this.isPlaying&&W.play(),this.hasAttribute(P)||(W.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,P,"")),A("Component initialized: %s",P))))}initComponentDependencies(P){var F=this,O=g[P],W,V;if(O&&(W=g[P].dependencies,!!W))for(V=0;V<W.length;V++)F.initComponent(W[V],window.HTMLElement.prototype.getAttribute.call(F,W[V])||void 0,!0)}removeComponent(P,F){var O;if(O=this.components[P],!!O){if(!O.initialized){this.addEventListener("componentinitialized",function W(V){V.detail.name===P&&(this.removeComponent(P,F),this.removeEventListener("componentinitialized",W))});return}O.pause(),O.remove(),F&&(O.destroy(),delete this.components[P],this.hasAttribute(P)&&window.HTMLElement.prototype.removeAttribute.call(this,P)),this.emit("componentremoved",O.evtDetail,!1)}}updateComponents(){var P,F,O,W,V=this.componentsToUpdate;if(!(!this.hasLoaded&&!this.isLoading)){for(O=0;O<this.mixinEls.length;O++)for(W in this.mixinEls[O].componentCache)L(W)&&(V[W]=!0);if(this.getExtraComponents){F=this.getExtraComponents();for(W in F)L(W)&&(V[W]=!0)}for(O=0;O<this.attributes.length;++O)W=this.attributes[O].name,E.indexOf(W)===-1&&L(W)&&(V[W]=!0);for(O=0;O<E.length;O++)W=E[O],this.hasAttribute(W)&&this.updateComponent(W,this.getDOMAttribute(W));for(W in V)P=I(this.getDOMAttribute(W),F&&F[W]),this.updateComponent(W,P),delete V[W]}}updateComponent(P,F,O){var W=this.components[P];if(W){if(F===null&&!w(this,P)){this.removeComponent(P,!0);return}W.updateProperties(F,O);return}this.initComponent(P,F,!1)}removeAttribute(P,F){var O=this.components[P];if(O&&F===void 0&&this.removeComponent(P,!0),O&&F!==void 0){O.resetProperty(F);return}P==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,P)}play(){var P,F,O;if(!(this.isPlaying||!this.hasLoaded&&!this.isLoading)){this.isPlaying=!0;for(O in this.components)this.components[O].play();for(P=this.getChildEntities(),F=0;F<P.length;F++)P[F].play();this.emit("play")}}pause(){var P,F,O;if(this.isPlaying){this.isPlaying=!1;for(O in this.components)this.components[O].pause();for(P=this.getChildEntities(),F=0;F<P.length;F++)P[F].pause();this.emit("pause")}}setEntityAttribute(P,F,O){if(g[P]||this.components[P]){this.updateComponent(P,O);return}if(P==="mixin"){if(O===this.computedMixinStr)return;this.mixinUpdate(O,F)}}mixinUpdate(P,F,O){var W=M.componentsUpdated,V,$,H,Y,Q=this;if(O||(F=F||this.getAttribute("mixin")),!this.hasLoaded){this.addEventListener("loaded-private",function(){Q.mixinUpdate(P,F,!0)},x);return}for(H=this.updateMixins(P,F),W.length=0,Y=0;Y<this.mixinEls.length;Y++)for(V in this.mixinEls[Y].componentCache)W.indexOf(V)===-1&&(this.components[V]?this.components[V].handleMixinUpdate():this.initComponent(V,null),W.push(V));for(Y=0;Y<H.oldMixinIds.length;Y++)if($=document.getElementById(H.oldMixinIds[Y]),!!$)for(V in $.componentCache)W.indexOf(V)===-1&&this.components[V]&&(this.getDOMAttribute(V)?this.components[V].handleMixinUpdate():this.removeComponent(V,!0))}setAttribute(P,F,O){var W=M.singlePropUpdate,V,$,H,Y,Q,G;if(Y=P.indexOf(C),H=Y>0?P.substring(0,Y):P,!g[H]){P==="mixin"&&this.mixinUpdate(F),super.setAttribute.call(this,P,F);return}if(!this.components[P]&&this.hasAttribute(P)&&this.updateComponent(P,window.HTMLElement.prototype.getAttribute.call(this,P)),typeof O<"u"&&typeof F=="string"&&F.length>0&&typeof v.styleParser.parse(F)=="string"){for(G in W)delete W[G];V=W,V[F]=O,$=!1}else V=F,$=O===!0;this.updateComponent(P,V,$),Q=this.sceneEl&&this.sceneEl.getAttribute("debug"),Q&&this.components[P].flushToDOM()}flushToDOM(P){var F=this.components,O,W=this.children,V,$;for($ in F)F[$].flushToDOM();if(P)for(V=0;V<W.length;++V)O=W[V],O.flushToDOM&&O.flushToDOM(P)}getAttribute(P){var F;return P==="position"?this.object3D.position:P==="rotation"?R(this):P==="scale"?this.object3D.scale:P==="visible"?this.object3D.visible:(F=this.components[P],F?F.data:window.HTMLElement.prototype.getAttribute.call(this,P))}getDOMAttribute(P){var F=this.components[P];return F?F.attrValue:window.HTMLElement.prototype.getAttribute.call(this,P)}addState(P){this.is(P)||(this.states.push(P),this.emit("stateadded",P))}removeState(P){var F=this.states.indexOf(P);F!==-1&&(this.states.splice(F,1),this.emit("stateremoved",P))}is(P){return this.states.indexOf(P)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var P;if(this.parentNode){y("Entity can only be destroyed if detached from scenegraph.");return}for(P in this.components)this.components[P].destroy()}}function w(k,P){return k.components[P]&&k.components[P].attrValue?!0:S(P,k.mixinEls)}function S(k,P){var F,O=!1;for(F=0;F<P.length&&(O=P[F].hasAttribute(k),!O);++F);return O}function I(k,P){return P?P.constructor===Object?v.extend(P,v.styleParser.parse(k||{})):k||P:k}function L(k){return k.indexOf(C)!==-1&&(k=v.split(k,C)[0]),!!g[k]}function R(k){var P=m.MathUtils.radToDeg,F=k.object3D.rotation,O=k.rotationObj;return O.x=P(F.x),O.y=P(F.y),O.z=P(F.z),O}M.componentsUpdated=[],M.singlePropUpdate={},customElements.define("a-entity",M),u.exports.AEntity=M},"./src/core/a-mixin.js":(u,p,c)=>{var f=c("./src/core/a-node.js").ANode,g=c("./src/core/component.js").components,m=c("./src/utils/index.js"),v=m.styleParser,A="__";class y extends f{constructor(){super(),this.componentCache={},this.rawAttributeCache={},this.isMixin=!0}doConnectedCallback(){super.doConnectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(E,x,M){super.attributeChangedCallback(),this.cacheAttribute(E,M),this.updateEntities()}setAttribute(E,x){window.HTMLElement.prototype.setAttribute.call(this,E,x),this.cacheAttribute(E,x)}cacheAttribute(E,x){var M,w;w=m.split(E,A)[0],M=g[w],x===void 0&&(x=window.HTMLElement.prototype.getAttribute.call(this,E)),this.rawAttributeCache[E]=x,M&&(this.componentCache[E]=this.parseComponentAttrValue(M,x))}parseComponentAttrValue(E,x){var M;return typeof x!="string"?x:(E.isSingleProperty?(M=E.schema.parse(x),typeof M=="string"&&(M=x)):M=v.parse(x),M)}getAttribute(E){return this.componentCache[E]||window.HTMLElement.prototype.getAttribute.call(this,E)}cacheAttributes(){var E=this.attributes,x,M;for(M=0;M<E.length;M++)x=E[M].name,this.cacheAttribute(x)}updateEntities(){var E,x,M;if(this.sceneEl)for(x=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),M=0;M<x.length;M++)E=x[M],!(!E.hasLoaded||E.isMixin)&&E.mixinUpdate(this.id)}}customElements.define("a-mixin",y)},"./src/core/a-node.js":(u,p,c)=>{var f=c("./src/utils/index.js"),g=c("./src/core/readyState.js"),m=f.debug("core:a-node:warn"),v={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function A(C){return C.tagName.toLowerCase()in v||C.isNode}class y extends HTMLElement{constructor(){super(),this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}connectedCallback(){if(!g.canInitializeElements){document.addEventListener("aframeready",this.connectedCallback.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var E;this.sceneEl=this.closestScene(),this.sceneEl||m("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(E=this.getAttribute("mixin"),E&&this.updateMixins(E))}attributeChangedCallback(E,x,M){M!==this.computedMixinStr&&E==="mixin"&&!this.isMixin&&this.updateMixins(M,x)}closestScene(){for(var E=this;E&&!E.isScene;)E=E.parentElement;return E}closest(E){for(var x=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,M=this;M&&!x.call(M,E);)M=M.parentElement;return M}disconnectedCallback(){this.hasLoaded=!1}load(E,x){var M,w,S=this;this.hasLoaded||(x=x||A,M=this.getChildren(),w=M.filter(x).map(function(I){return new Promise(function(R,k){if(I.hasLoaded)return R();I.addEventListener("loaded",R),I.addEventListener("error",k)})}),Promise.allSettled(w).then(function(L){L.forEach(function(k){k.status==="rejected"&&m("Rendering scene with errors on node: ",k.reason.target)}),S.isLoading=!0,S.setupMutationObserver(),E&&E(),S.isLoading=!1,S.hasLoaded=!0,S.emit("loaded-private",void 0,!1),S.emit("loaded",void 0,!1)}))}setupMutationObserver(){var E=this,x={attributes:!0,attributeOldValue:!0},M=new MutationObserver(function(S){var I;for(I=0;I<S.length;I++)if(S[I].type==="attributes"){var L=S[I].attributeName,R=window.HTMLElement.prototype.getAttribute.call(E,L),k=S[I].oldValue;E.attributeChangedCallback(L,k,R)}});M.observe(this,x)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(E,x){var M=y.newMixinIdArray,w=y.oldMixinIdArray,S=y.mixinIds,I,L,R;for(M.length=0,w.length=0,L=E?f.split(E.trim(),/\s+/):M,R=x?f.split(x.trim(),/\s+/):w,S.newMixinIds=L,S.oldMixinIds=R,I=0;I<R.length;I++)L.indexOf(R[I])===-1&&this.unregisterMixin(R[I]);for(this.computedMixinStr="",this.mixinEls.length=0,I=0;I<L.length;I++)this.registerMixin(L[I]);return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),L.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin"),S}registerMixin(E){var x,M,w,S=document.getElementById(E);if(!S){m("No mixin was found with id `%s`",E);return}if(w=S.getAttribute("mixin"),w)for(x=f.split(w.trim(),/\s+/),M=0;M<x.length;M++)this.registerMixin(x[M]);this.computedMixinStr=this.computedMixinStr+" "+S.id,this.mixinEls.push(S)}setAttribute(E,x){E==="mixin"&&this.updateMixins(x),window.HTMLElement.prototype.setAttribute.call(this,E,x)}unregisterMixin(E){var x,M=this.mixinEls,w;for(x=0;x<M.length;++x)if(w=M[x],E===w.id){M.splice(x,1);break}}emit(E,x,M,w){var S=y.evtData;M===void 0&&(M=!0),S.bubbles=!!M,S.detail=x,w&&(S=f.extend({},w,S)),this.dispatchEvent(new CustomEvent(E,S))}}y.evtData={},y.newMixinIdArray=[],y.oldMixinIdArray=[],y.mixinIds={},customElements.define("a-node",y),u.exports.ANode=y,u.exports.knownTags=v},"./src/core/component.js":(u,p,c)=>{var f=c("./src/core/schema.js"),g=c("./src/core/scene/scenes.js"),m=c("./src/core/system.js"),v=c("./src/utils/index.js"),A=u.exports.components={},y=f.parseProperty,C=f.process,E=f.isSingleProperty,x=f.stringifyProperties,M=f.stringifyProperty,w=v.styleParser,S=v.debug("core:component:warn"),I=document.currentScript,L=new RegExp("[A-Z]+"),R={},k=Object.freeze({}),P=[],F={get:function(G,J){return G.getComputedPropertyValue(J)},set:function(G,J,K){return J in G.schema?G.recomputeProperty(J,K):K!==void 0&&G.handleUnknownProperty(J,K),!0}},O=u.exports.Component=function(G,J,K){var se=this;if(this.sceneOnly&&!G.isScene)throw new Error("Component `"+this.name+"` can only be applied to <a-scene>");if(K&&!this.multiple)throw new Error("Trying to initialize multiple components of type `"+this.name+"`. There can only be one component of this type per entity.");this.el=G,this.id=K,this.attrName=this.name+(K?"__"+K:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=R[this.name];var ue=this.events;this.events={},W(this,ue),this.attrValue=void 0,this.isObjectBased?(this.data=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.data,this.schema),this.oldData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.oldData,this.schema),this.attrValueProxy=new Proxy(this,F)):(this.data=void 0,this.oldData=void 0,this.attrValueProxy=void 0),this.deferUnknownPropertyWarnings=!!this.updateSchema,this.silenceUnknownPropertyWarnings=!1,this.throttledEmitComponentChanged=v.throttleLeadingAndTrailing(function(){G.emit("componentchanged",se.evtDetail,!1)},200),this.updateProperties(J,!0)};O.prototype={schema:{},init:function(){},events:{},update:function(G){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},stringify:function(G){var J=this.schema;return typeof G=="string"?G:this.isSingleProperty?M(G,J):(G=x(G,J),w.stringify(G))},flushToDOM:function(G){var J=G?this.data:this.attrValue;J!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(J))},updateProperties:function(G,J){var K=this.el;this.updateData(G,J),!(!K.hasLoaded&&!K.isLoading)&&(this.initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var G=this.el,J;G.initializingComponents[this.name]||(G.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete G.initializingComponents[this.name],J=this.isObjectBased?k:void 0,this.dataChanged=!1,this.storeOldData(),this.update(J),G.isPlaying&&this.play(),G.emit("componentinitialized",this.evtDetail,!1))},updateData:function(G,J){if(this.isSingleProperty){this.recomputeProperty(void 0,G);return}J?(v.objectPool.clearObject(this.attrValue),this.recomputeData(G),this.schemaChangeRequired=!!this.updateSchema):typeof G=="string"?w.parse(G,this.attrValueProxy):v.extend(this.attrValueProxy,G),this.updateSchemaIfNeeded(G)},updateSchemaIfNeeded:function(G){if(!this.schemaChangeRequired||!this.updateSchema){for(var J=0;J<P.length;J++)S("Unknown property `"+P[J]+"` for component `"+this.name+"`.");P.length=0;return}P.length=0,this.updateSchema(this.data),v.objectPool.removeUnusedKeys(this.data,this.schema),this.silenceUnknownPropertyWarnings=!0,this.recomputeData(G),this.silenceUnknownPropertyWarnings=!1,this.schemaChangeRequired=!1},callUpdateHandler:function(){if(!(!this.isPositionRotationScale&&!this.dataChanged)){this.dataChanged=!1;var G=this.oldData;this.oldDataInUse=!0,this.update(G),G!==this.oldData&&this.objectPool.recycle(G),this.oldDataInUse=!1,this.storeOldData(),this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData(),this.updateSchemaIfNeeded(),this.callUpdateHandler()},resetProperty:function(G){!this.isSingleProperty&&!(G in this.schema)||(G?this.attrValue[G]=void 0:(this.isObjectBased&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0),this.recomputeProperty(G,void 0),this.updateSchemaIfNeeded(),this.callUpdateHandler())},extendSchema:function(G){var J;J=v.extend({},A[this.name].schema),v.extend(J,G),this.schema=C(J),this.el.emit("schemachanged",this.evtDetail)},getComputedPropertyValue:function(G){var J=this.el.mixinEls,K=this.attrValue&&G?this.attrValue[G]:this.attrValue;if(K!==void 0)return K;for(var se=J.length-1;se>=0;se--){var ue=J[se].getAttribute(this.attrName);if(!(ue===null||G&&!(G in ue)))return G?ue[G]:ue}var he=G?this.schema[G].default:this.schema.default;return he},recomputeProperty:function(G,J){var K=G?this.schema[G]:this.schema;if(J!=null){this.attrValue===void 0&&this.isObjectBased&&(this.attrValue=this.objectPool.use());var se=G?this.attrValue[G]:this.attrValue;se=K.isCacheable?y(J,K,se):J,typeof se=="string"&&(se=J===""?void 0:J),G?this.attrValue[G]=se:this.attrValue=se}this.oldDataInUse&&(this.oldData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.oldData,this.schema),this.storeOldData(),this.oldDataInUse=!1);var ue=G?this.oldData[G]:this.oldData,he=G?this.data[G]:this.data,Me=y(this.getComputedPropertyValue(G),K,he);return K.type==="array"&&!G&&(Me=v.clone(Me)),K.equals(Me,ue)||(this.dataChanged=!0,K.schemaChange&&(this.schemaChangeRequired=!0)),G?this.data[G]=Me:this.data=Me,Me},handleUnknownProperty:function(G,J){this.attrValue===void 0&&(this.attrValue=this.objectPool.use()),this.attrValue[G]=J,this.silenceUnknownPropertyWarnings||(this.deferUnknownPropertyWarnings?P.push(G):this.silenceUnknownPropertyWarnings||S("Unknown property `"+G+"` for component `"+this.name+"`."))},storeOldData:function(){if(!this.isObjectBased){this.oldData=this.data;return}if(this.isSingleProperty){this.oldData=y(this.data,this.schema,this.oldData);return}var G;for(G in this.schema)this.data[G]!==void 0&&(this.data[G]&&typeof this.data[G]=="object"?this.oldData[G]=y(this.data[G],this.schema[G],this.oldData[G]):this.oldData[G]=this.data[G])},recomputeData:function(G){var J;if(this.isSingleProperty){this.recomputeProperty(void 0,G);return}if(G&&typeof G=="object")for(J in this.schema)this.attrValueProxy[J]=G[J];else for(J in this.schema)this.attrValueProxy[J]=void 0;typeof G=="string"&&w.parse(G,this.attrValueProxy);for(J in this.attrValue)this.attrValue[J]!==void 0&&P.indexOf(J)!==-1&&(J in this.schema||S("Unknown property `"+J+"` for component `"+this.name+"`."))},eventsAttach:function(){var G;this.eventsDetach();for(G in this.events)this.el.addEventListener(G,this.events[G])},eventsDetach:function(){var G;for(G in this.events)this.el.removeEventListener(G,this.events[G])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.data),this.objectPool.recycle(this.oldData),this.attrValue=this.data=this.oldData=this.attrValueProxy=void 0}};function W(G,J){var K;for(K in J)G.events[K]=J[K].bind(G)}if(window.debug)var V=u.exports.registrationOrderWarnings={};u.exports.registerComponent=function(G,J){var K,se={},ue,he;if(document.currentScript&&document.currentScript!==I&&g.forEach(function(Pe){Pe.hasLoaded||document.currentScript.compareDocumentPosition(Pe)!==Node.DOCUMENT_POSITION_FOLLOWING&&(S("The component `"+G+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(V[G]=!0))}),L.test(G)===!0&&S("The component name `"+G+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+G.toLowerCase()+"`"),G.indexOf("__")!==-1)throw new Error("The component name `"+G+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(J).forEach(function(de){se[de]={value:J[de],writable:!0}}),A[G])throw new Error("The component `"+G+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");K=function(de,Pe,Se){O.call(this,de,Pe,Se)},K.prototype=Object.create(O.prototype,se),K.prototype.name=G,K.prototype.isPositionRotationScale=G==="position"||G==="rotation"||G==="scale",K.prototype.constructor=K,K.prototype.system=m&&m.systems[G],K.prototype.play=Y(K.prototype.play),K.prototype.pause=H(K.prototype.pause),ue=v.extend(C(K.prototype.schema,K.prototype.name)),K.prototype.isSingleProperty=he=E(K.prototype.schema),K.prototype.isObjectBased=!he||he&&(Q(ue.default)||Q(y(void 0,ue))),R[G]=v.objectPool.createPool(),A[G]={Component:K,dependencies:K.prototype.dependencies,before:K.prototype.before,after:K.prototype.after,isSingleProperty:K.prototype.isSingleProperty,isObjectBased:K.prototype.isObjectBased,multiple:K.prototype.multiple,sceneOnly:K.prototype.sceneOnly,name:G,schema:ue,stringify:K.prototype.stringify};for(var Me=0;Me<g.length;Me++)g[Me].emit("componentregistered",{name:G},!1);return K};function $(G){return G.tick||G.tock}function H(G){return function(){var K=this.el.sceneEl;this.isPlaying&&(G.call(this),this.isPlaying=!1,this.eventsDetach(),$(this)&&K.removeBehavior(this))}}function Y(G){return function(){var K=this.el.sceneEl,se=this.el.isPlaying&&!this.isPlaying;!this.initialized||!se||(G.call(this),this.isPlaying=!0,this.eventsAttach(),$(this)&&K.addBehavior(this))}}function Q(G){return G&&G.constructor===Object&&!(G instanceof window.HTMLElement)}},"./src/core/geometry.js":(u,p,c)=>{var f=c("./src/core/schema.js"),g=f.process,m=u.exports.geometries={},v=u.exports.geometryNames=[],A=c("./src/lib/three.js"),y=u.exports.Geometry=function(){};y.prototype={schema:{},init:function(C){return this.geometry=new A.BufferGeometry,this.geometry},update:function(C){}},u.exports.registerGeometry=function(C,E){var x,M={};if(Object.keys(E).forEach(function(S){M[S]={value:E[S],writable:!0}}),m[C])throw new Error("The geometry `"+C+"` has been already registered");return x=function(){y.call(this)},x.prototype=Object.create(y.prototype,M),x.prototype.name=C,x.prototype.constructor=x,m[C]={Geometry:x,schema:g(x.prototype.schema)},v.push(C),x}},"./src/core/propertyTypes.js":(u,p,c)=>{var f=c("./src/utils/coordinates.js"),g=c("./node_modules/debug/src/browser.js"),m=g("core:propertyTypes:warn"),v=u.exports.propertyTypes={},A=/[,> .[\]:]/,y=/url\((.+)\)/;C("audio","",w),C("array",[],E,x,M),C("asset","",w),C("boolean",!1,R),C("color","#FFF"),C("int",0,k),C("number",0,P),C("map","",w),C("model","",w),C("selector",null,F,W,L,!1),C("selectorAll",null,O,V,M,!1),C("src","",$),C("string",""),C("time",0,k),C("vec2",{x:0,y:0},H,f.stringify,f.equals),C("vec3",{x:0,y:0,z:0},H,f.stringify,f.equals),C("vec4",{x:0,y:0,z:0,w:1},H,f.stringify,f.equals);function C(G,J,K,se,ue,he){if(G in v)throw new Error("Property type "+G+" is already registered.");v[G]={default:J,parse:K||S,stringify:se||I,equals:ue||L,isCacheable:he!==!1}}u.exports.registerPropertyType=C;function E(G){if(Array.isArray(G))return G;if(!G||typeof G!="string")return[];return G.split(",").map(J);function J(K){return K.trim()}}function x(G){return G.join(", ")}function M(G,J){if(!Array.isArray(G)||!Array.isArray(J))return G===J;if(G.length!==J.length)return!1;for(var K=0;K<G.length;K++)if(G[K]!==J[K])return!1;return!0}function w(G){var J,K;if(typeof G!="string")return G;if(K=G.match(y),K)return K[1];if(G.charAt(0)==="#"){if(J=document.getElementById(G.substring(1)),J)return J.tagName==="CANVAS"||J.tagName==="VIDEO"||J.tagName==="IMG"?J:J.getAttribute("src");m('"'+G+'" asset not found.');return}return G}function S(G){return G}function I(G){return G===null?"null":G.toString()}function L(G,J){return G===J}function R(G){return G!=="false"&&G!==!1}function k(G){return parseInt(G,10)}function P(G){return parseFloat(G,10)}function F(G){return G?typeof G!="string"?G:G[0]==="#"&&!A.test(G)?document.getElementById(G.substring(1)):document.querySelector(G):null}function O(G){return G?typeof G!="string"?G:Array.prototype.slice.call(document.querySelectorAll(G),0):null}function W(G){return G.getAttribute?"#"+G.getAttribute("id"):I(G)}function V(G){return G instanceof Array?G.map(function(J){return"#"+J.getAttribute("id")}).join(", "):I(G)}function $(G){return m("`src` property type is deprecated. Use `asset` instead."),w(G)}function H(G,J,K){return f.parse(G,J,K)}function Y(G,J){return G==="audio"&&typeof J!="string"||G==="array"&&!Array.isArray(J)||G==="asset"&&typeof J!="string"||G==="boolean"&&typeof J!="boolean"||G==="color"&&typeof J!="string"||G==="int"&&typeof J!="number"||G==="number"&&typeof J!="number"||G==="map"&&typeof J!="string"||G==="model"&&typeof J!="string"||G==="selector"&&typeof J!="string"&&J!==null||G==="selectorAll"&&typeof J!="string"&&J!==null||G==="src"&&typeof J!="string"||G==="string"&&typeof J!="string"||G==="time"&&typeof J!="number"?!1:G==="vec2"?Q(J,2):G==="vec3"?Q(J,3):G==="vec4"?Q(J,4):!0}u.exports.isValidDefaultValue=Y;function Q(G,J){if(G===null)return!0;if(typeof G!="object"||Object.keys(G).length!==J)return!1;var K=G.x,se=G.y,ue=G.z,he=G.w;return!(typeof K!="number"||typeof se!="number"||J>2&&typeof ue!="number"||J>3&&typeof he!="number")}u.exports.isValidDefaultCoordinate=Q},"./src/core/readyState.js":u=>{u.exports.canInitializeElements=!1;function p(){if(document.readyState==="complete"){c();return}document.addEventListener("readystatechange",function f(){document.readyState==="complete"&&(document.removeEventListener("readystatechange",f),c())})}u.exports.waitForDocumentReadyState=p;function c(){u.exports.canInitializeElements||(u.exports.canInitializeElements=!0,setTimeout(function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}u.exports.emitReady=c},"./src/core/scene/a-scene.js":(u,p,c)=>{var f=c("./src/core/scene/metaTags.js").inject,g=c("./src/core/scene/wakelock.js"),m=c("./src/core/scene/loadingScreen.js"),v=c("./src/core/scene/scenes.js"),A=c("./src/core/system.js").systems,y=c("./src/core/component.js").components,C=c("./src/lib/three.js"),E=c("./src/utils/index.js"),x=E.debug("core:a-scene:warn"),M=c("./src/core/a-entity.js").AEntity,w=c("./src/core/a-node.js").ANode,S=c("./src/core/scene/postMessage.js"),I=E.device.isIOS(),L=E.device.isMobile(),R=E.device.isWebXRAvailable;I&&c("./src/utils/ios-orientationchange-blank-bug.js");class k extends M{constructor(){var Q;super(),Q=this,Q.clock=new C.Clock,Q.isIOS=I,Q.isMobile=L,Q.hasWebXR=R,Q.isAR=!1,Q.isScene=!0,Q.object3D=new C.Scene,Q.object3D.onAfterRender=function(G,J,K){Q.isPlaying&&Q.tock(Q.time,Q.delta,K)},Q.resize=Q.resize.bind(Q),Q.render=Q.render.bind(Q),Q.systems={},Q.systemNames=[],Q.time=Q.delta=0,Q.usedOfferSession=!1,Q.componentOrder=[],Q.behaviors={},Q.hasLoaded=!1,Q.isPlaying=!1,Q.originalHTML=Q.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var Q=this,G=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.doConnectedCallback(),H(this),this.setupRenderer(),m.setup(this,O),this.resize(),G||this.addFullScreenStyles(),S(this),f(this),g(this),this.onVRPresentChangeBound=this.onVRPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){Q.enterVR()},this.exitVRBound=function(){Q.exitVR()},this.exitVRTrueBound=function(){Q.exitVR(!0)},this.pointerRestrictedBound=function(){Q.pointerRestricted()},this.pointerUnrestrictedBound=function(){Q.pointerUnrestricted()},Q.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){Q.attachedCallbackPostCamera()}),this.initSystems(),this.componentOrder=P(y,this.componentOrder),this.addEventListener("componentregistered",function(){Q.componentOrder=P(y,Q.componentOrder)}),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){Q.enterVR()})}attachedCallbackPostCamera(){var Q,G=this;window.addEventListener("load",Q),window.addEventListener("resize",function(){G.isIOS?setTimeout(G.resize,100):G.resize()}),this.play(),v.push(this)}initSystems(){var Q;this.initSystem("camera");for(Q in A)Q!=="camera"&&this.initSystem(Q)}initSystem(Q){this.systems[Q]||(this.systems[Q]=new A[Q](this),this.systemNames.push(Q))}disconnectedCallback(){var Q=v.indexOf(this);super.disconnectedCallback(),v.splice(Q,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(Q){var G,J=this.behaviors[Q.name],K;J||(J=this.behaviors[Q.name]={tick:{inUse:!1,array:[],markedForRemoval:[]},tock:{inUse:!1,array:[],markedForRemoval:[]}});for(K in J)if(Q[K]){if(G=J[K],G.inUse){var se=G.markedForRemoval.indexOf(Q);se!==-1&&G.markedForRemoval.splice(se,1)}G.array.indexOf(Q)===-1&&G.array.push(Q)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return E.device.checkHeadsetConnected()}enterAR(){var Q;if(!this.hasWebXR)throw Q="Failed to enter AR mode, WebXR not supported.",new Error(Q);if(!E.device.checkARSupport())throw Q="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(Q);return this.enterVR(!0)}enterVR(Q,G){var J=this,K,se=J.renderer.xr,ue;if(G&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(J.usedOfferSession&&G)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var he=J.getAttribute("renderer");if(se.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var Me=this.sceneEl.systems.webxr.sessionReferenceSpaceType;se.setReferenceSpaceType(Me);var de=Q?"immersive-ar":"immersive-vr";return ue=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(be,je){var Te=G?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);J.usedOfferSession|=G,Te(de,ue).then(function(mt){G&&(J.usedOfferSession=!1),se.layersEnabled=ue.requiredFeatures.indexOf("layers")!==-1,se.setSession(mt).then(function(){se.setFoveation(he.foveationLevel),J.xrSession=mt,J.systems.renderer.setWebXRFrameRate(mt),mt.addEventListener("end",J.exitVRBound),Se(be)})},function(mt){var vt=de==="immersive-ar",ft=vt?"AR":"VR";je(new Error("Failed to enter "+ft+" mode (`requestSession`)",{cause:mt}))})})}else{if(K=E.device.getVRDisplay(),se.setDevice(K),K.isPresenting&&!window.hasNativeWebVRImplementation)return Se(),Promise.resolve();var Pe={highRefreshRate:he.highRefreshRate};return K.requestPresent([{source:this.canvas,attributes:Pe}]).then(Se,Le)}}return Se(),Promise.resolve();function Se(be){var je;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(je=new CustomEvent("vrdisplaypresentchange",{detail:{display:E.device.getVRDisplay()}}),window.dispatchEvent(je)),Q?J.addState("ar-mode"):J.addState("vr-mode"),J.emit("enter-vr",{target:J}),!J.hasWebXR&&J.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),J.addFullScreenStyles(),!J.isMobile&&!J.checkHeadsetConnected()&&V(J.canvas),J.resize(),be&&be()}function Le(be){throw J.removeState("vr-mode"),be&&be.message?new Error("Failed to enter VR mode (`requestPresent`): "+be.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var Q=this,G,J=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(J.enabled=!1,G=E.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(G.isPresenting)return G.exitPresent().then(K,se)}else $();return K(),Promise.resolve();function K(){Q.removeState("vr-mode"),Q.removeState("ar-mode"),Q.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),Q.hasAttribute("embedded")&&Q.removeFullScreenStyles(),Q.resize(),Q.isIOS&&E.forceCanvasResizeSafariMobile(Q.canvas),Q.renderer.setPixelRatio(window.devicePixelRatio),Q.emit("exit-vr",{target:Q})}function se(ue){throw ue&&ue.message?new Error("Failed to exit VR mode (`exitPresent`): "+ue.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var Q=this.getPointerLockElement();Q&&Q!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var Q=this.getPointerLockElement();Q&&Q===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(Q){var G=Q.display||Q.detail.display;if(G&&G.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(Q){var G=this.systems[Q];return G?G.data:M.prototype.getAttribute.call(this,Q)}getDOMAttribute(Q){var G=this.systems[Q];return G?G.data:M.prototype.getDOMAttribute.call(this,Q)}setAttribute(Q,G,J){if(A[Q]){w.prototype.setAttribute.call(this,Q,G);var K=this.systems[Q];K&&K.updateProperties(G);return}M.prototype.setAttribute.call(this,Q,G,J)}removeBehavior(Q){var G,J,K=this.behaviors[Q.name],se;for(J in K)Q[J]&&(G=K[J],se=G.array.indexOf(Q),se!==-1&&(G.inUse?G.markedForRemoval.indexOf(Q)===-1&&G.markedForRemoval.push(Q):(G.array[se]=G.array[G.array.length-1],G.array.pop())))}resize(){var Q=this.camera,G=this.canvas,J,K,se,ue=this.renderer.xr.isPresenting;K=this.renderer.xr.enabled&&ue,!(!Q||!G||this.is("vr-mode")&&(this.isMobile||K))&&(J=this.getAttribute("embedded")&&!this.is("vr-mode"),se=O(G,J,this.maxCanvasSize,this.is("vr-mode")),Q.aspect=se.width/se.height,Q.updateProjectionMatrix(),this.renderer.setSize(se.width,se.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var Q=this,G,J,K,se;se={alpha:!0,antialias:!L,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:-1,width:-1},this.hasAttribute("renderer")&&(K=this.getAttribute("renderer"),J=E.styleParser.parse(K),J.precision&&(se.precision=J.precision+"p"),J.antialias&&J.antialias!=="auto"&&(se.antialias=J.antialias==="true"),J.logarithmicDepthBuffer&&J.logarithmicDepthBuffer!=="auto"&&(se.logarithmicDepthBuffer=J.logarithmicDepthBuffer==="true"),J.alpha&&(se.alpha=J.alpha==="true"),J.stencil&&(se.stencil=J.stencil==="true"),J.multiviewStereo&&(se.multiviewStereo=J.multiviewStereo==="true"),this.maxCanvasSize={width:J.maxCanvasWidth?parseInt(J.maxCanvasWidth):this.maxCanvasSize.width,height:J.maxCanvasHeight?parseInt(J.maxCanvasHeight):this.maxCanvasSize.height}),G=this.renderer=new C.WebGLRenderer(se),G.setPixelRatio(window.devicePixelRatio),this.camera&&G.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){G.xr.setPoseTarget(Q.camera.el.object3D)})}play(){var Q=this,G=this;if(this.renderStarted){M.prototype.play.call(this);return}this.addEventListener("loaded",function(){var J=this.renderer,K,se=this.renderer.xr;M.prototype.play.call(this),!G.renderStarted&&(G.resize(),G.renderer&&(window.performance&&window.performance.mark("render-started"),m.remove(),K=E.device.getVRDisplay(),K&&K.isPresenting&&(se.setDevice(K),se.enabled=!0,G.enterVR()),J.setAnimationLoop(this.render),G.renderStarted=!0,G.emit("renderstart")))}),setTimeout(function(){M.prototype.load.call(Q)})}updateComponent(Q){Q in A||M.prototype.updateComponent.apply(this,arguments)}tick(Q,G){var J,K=this.systems;for(this.callComponentBehaviors("tick",Q,G),J=0;J<this.systemNames.length;J++)K[this.systemNames[J]].tick&&K[this.systemNames[J]].tick(Q,G)}tock(Q,G,J){var K,se=this.systems;for(this.callComponentBehaviors("tock",Q,G),K=0;K<this.systemNames.length;K++)se[this.systemNames[K]].tock&&se[this.systemNames[K]].tock(Q,G,J)}render(Q,G){var J=this.renderer;this.frame=G,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var K=null;this.is("ar-mode")&&(K=this.object3D.background,this.object3D.background=null),J.render(this.object3D,this.camera),K&&(this.object3D.background=K)}callComponentBehaviors(Q,G,J){for(var K,se=0;se<this.componentOrder.length;se++){var ue=this.behaviors[this.componentOrder[se]];if(ue){var he=ue[Q];for(he.inUse=!0,K=0;K<he.array.length;K++)he.array[K].isPlaying&&he.array[K][Q](G,J);for(he.inUse=!1,K=0;K<he.markedForRemoval.length;K++)this.removeBehavior(he.markedForRemoval[K]);he.markedForRemoval.length=0}}}}function P(Y,Q){var G={},J,K,se=Q||[];se.length=0;for(K in Y){var ue=Y[K];if(ue!==void 0){var he=ue.before?ue.before.slice(0):[],Me=ue.after?ue.after.slice(0):[];G[K]={before:he,after:Me,visited:!1,done:!1}}}for(K in G)for(J=0;J<G[K].before.length;J++){var de=G[K].before[J];if(!(de in G)){x("Invalid ordering constraint, no component named `"+de+"` referenced by `"+K+"`");continue}G[de].after.push(K)}function Pe(Se){if(!(!(Se in G)||G[Se].done)){if(G[Se].visited){x("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");return}G[Se].visited=!0;for(var Le=0;Le<G[Se].after.length;Le++){var be=G[Se].after[Le];be in G||x("Invalid before/after constraint, no component named `"+be+"` referenced in `"+Se+"`"),Pe(be)}G[Se].done=!0,se.push(Se)}}for(K in G)G[K].done||Pe(K);return se}u.exports.determineComponentBehaviorOrder=P;function F(Y,Q){var G,J=window.devicePixelRatio;return!Q||Q.width===-1&&Q.height===-1||Y.width*J<Q.width&&Y.height*J<Q.height||(G=Y.width/Y.height,Y.width*J>Q.width&&Q.width!==-1&&(Y.width=Math.round(Q.width/J),Y.height=Math.round(Q.width/G/J)),Y.height*J>Q.height&&Q.height!==-1&&(Y.height=Math.round(Q.height/J),Y.width=Math.round(Q.height*G/J))),Y}customElements.define("a-scene",k);function O(Y,Q,G,J){if(!Y.parentElement)return{height:0,width:0};if(Q){var K;return K={height:Y.parentElement.offsetHeight,width:Y.parentElement.offsetWidth},F(K,G)}return W(G,J)}function W(Y,Q){var G;return G={height:document.body.offsetHeight,width:document.body.offsetWidth},Q?G:F(G,Y)}function V(Y){var Q=Y.requestFullscreen||Y.webkitRequestFullscreen||Y.mozRequestFullScreen||Y.msRequestFullscreen;Q.apply(Y,[{navigationUI:"hide"}])}function $(){var Y=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;Y&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function H(Y){var Q;Q=document.createElement("canvas"),Q.classList.add("a-canvas"),Q.dataset.aframeCanvas=!0,Y.appendChild(Q),document.addEventListener("fullscreenchange",G),document.addEventListener("mozfullscreenchange",G),document.addEventListener("webkitfullscreenchange",G),document.addEventListener("MSFullscreenChange",G),Q.addEventListener("touchmove",function(J){J.preventDefault()},{passive:!1}),Y.canvas=Q,Y.emit("render-target-loaded",{target:Q}),setTimeout(Y.resize.bind(Y),0);function G(){var J=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;J||Y.exitVR(),document.activeElement.blur(),document.body.focus()}}u.exports.setupCanvas=H,u.exports.AScene=k},"./src/core/scene/loadingScreen.js":(u,p,c)=>{var f=c("./src/utils/index.js"),g=f.styleParser,m,v,A,y="loading-screen",C="a-loader-title";u.exports.setup=function(w,S){m=w,A=S;var I=m.hasAttribute(y)?g.parse(m.getAttribute(y)):void 0,L=I&&I.dotsColor||"white",R=I&&I.backgroundColor||"#24CAFF",k=I===void 0||I.enabled==="true"||I.enabled===void 0,P,F,O,W,V,$,H,Y,Q,G;k&&(P=new THREE.Scene,F=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),O=new THREE.MeshBasicMaterial({color:L}),W=new THREE.Mesh(F,O),V=W.clone(),$=W.clone(),H=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),Y=new THREE.Clock,Q=0,G=function(){m.renderer.render(P,H),Q=Y.getElapsedTime()%4,W.visible=Q>=1,V.visible=Q>=2,$.visible=Q>=3},P.background=new THREE.Color(R),P.add(H),W.position.set(-1,0,-15),V.position.set(0,0,-15),$.position.set(1,0,-15),H.add(W),H.add(V),H.add($),x(),setTimeout(function(){m.hasLoaded||(E(H),v.style.display="block",window.addEventListener("resize",function(){E(H)}),m.renderer.setAnimationLoop(G))},200))},u.exports.remove=function(){window.removeEventListener("resize",E),v&&(v.style.display="none")};function E(M){var w=m.hasAttribute("embedded"),S=A(m.canvas,w,m.maxCanvasSize,m.is("vr-mode"));M.aspect=S.width/S.height,M.updateProjectionMatrix(),m.renderer.setSize(S.width,S.height,!1)}function x(){v=document.createElement("div"),v.className=C,v.innerHTML=document.title,v.style.display="none",m.appendChild(v)}},"./src/core/scene/metaTags.js":(u,p,c)=>{var f=c("./src/constants/index.js"),g=c("./src/utils/index.js").extend,m=u.exports.MOBILE_HEAD_TAGS=[A({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),A({name:"mobile-web-app-capable",content:"yes"}),A({name:"theme-color",content:"black"})],v=[A({name:"apple-mobile-web-app-capable",content:"yes"}),A({name:"apple-mobile-web-app-status-bar-style",content:"black"}),y({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function A(E){return{tagName:"meta",attributes:E,exists:function(){return document.querySelector('meta[name="'+E.name+'"]')}}}function y(E){return{tagName:"link",attributes:E,exists:function(){return document.querySelector('link[rel="'+E.rel+'"]')}}}u.exports.inject=function(x){var M=document.head,w=M.querySelector("script"),S,I=[];return m.forEach(L),x.isIOS&&v.forEach(L),I;function L(R){!R||R.exists()||(S=C(R),S&&(w?w.parentNode.insertBefore(S,w):M.appendChild(S),I.push(S)))}};function C(E){if(!(!E||!E.tagName)){var x=document.createElement(E.tagName);return x.setAttribute(f.AFRAME_INJECTED,""),g(x,E.attributes)}}},"./src/core/scene/postMessage.js":(u,p,c)=>{var f=c("./src/utils/index.js").isIframed;u.exports=function(v){f()&&window.addEventListener("message",g.bind(v))};function g(m){var v=this;if(m.data)switch(m.data.type){case"vr":switch(m.data.data){case"enter":v.enterVR();break;case"exit":v.exitVR();break}}}},"./src/core/scene/scenes.js":u=>{u.exports=[]},"./src/core/scene/wakelock.js":(u,p,c)=>{var f=c("./vendor/wakelock/wakelock.js");u.exports=function(m){if(m.isMobile){var v=m.wakelock=new f;m.addEventListener("enter-vr",function(){v.request()}),m.addEventListener("exit-vr",function(){v.release()})}}},"./src/core/schema.js":(u,p,c)=>{var f=c("./src/utils/index.js"),g=c("./src/core/propertyTypes.js"),m=f.debug,v=g.isValidDefaultValue,A=g.propertyTypes,y=m("core:schema:warn");function C(w){return"type"in w?typeof w.type=="string":"default"in w}u.exports.isSingleProperty=C,u.exports.process=function(w,S){var I;if(C(w))return E(w,S);for(I in w)w[I]=E(w[I],S);return w};function E(w,S){var I=w.default,L,R,k=w.type;return w.type?w.type==="bool"?k="boolean":w.type==="float"&&(k="number"):I!==void 0&&(typeof I=="boolean"||typeof I=="number")?k=typeof I:Array.isArray(I)?k="array":k="string",R=A[k],R||y("Unknown property type for component `"+S+"`: "+k),L=!!w.parse,w.parse=w.parse||R.parse,w.stringify=w.stringify||R.stringify,w.equals=w.equals||R.equals,w.isCacheable=w.isCacheable===!0||R.isCacheable,w.type=k,"default"in w?!L&&!v(k,I)&&y("Default value `"+I+"` does not match type `"+k+"` in component `"+S+"`"):w.default=R.default,w}u.exports.processPropertyDefinition=E,u.exports.parseProperties=function(){var w=[];return function(S,I,L,R,k){var P,F,O,W;w.length=0;for(F in L?S:I)L&&S[F]===void 0||w.push(F);if(S===null||typeof S!="object")return S;for(F in S)S[F]!==void 0&&!I[F]&&!k&&y("Unknown property `"+F+"` for component/system `"+R+"`.");for(P=0;P<w.length;P++){if(F=w[P],O=I[F],W=S[F],!I[F])return;S[F]=x(W,O)}return S}}();function x(w,S,I){return(w==null||w==="")&&(w=S.default,Array.isArray(w)&&(w=w.slice())),S.parse(w,S.default,I)}u.exports.parseProperty=x,u.exports.stringifyProperties=function(w,S){var I,L,R,k={},P;for(I in w)L=S[I],R=w[I],P=R,typeof P=="object"&&(P=M(R,L),L||y("Unknown component property: "+I)),k[I]=P;return k};function M(w,S){return typeof w!="object"?w:!S||w===null?JSON.stringify(w):S.stringify(w)}u.exports.stringifyProperty=M},"./src/core/shader.js":(u,p,c)=>{var f=c("./src/core/schema.js"),g=f.process,m=u.exports.shaders={},v=u.exports.shaderNames=[],A=c("./src/lib/three.js"),y=c("./src/utils/index.js"),C={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},E=u.exports.Shader=function(){};E.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(x){return this.uniforms=this.initUniforms(),this.material=new(this.raw?A.RawShaderMaterial:A.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw||this.glsl3?A.GLSL3:null,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initUniforms:function(){var x,M=this.schema,w={},S;for(x in M)M[x].is==="uniform"&&(S=C[M[x].type],w[x]={type:S,value:void 0});return w},update:function(x){var M,w,S=this.schema,I=this.uniforms;for(M in x)if(!(!S[M]||S[M].is!=="uniform")){if(S[M].type==="map"){if(!I[M]||I[M].value===x[M])continue;w="_texture_"+M,this.setMapOnTextureLoad(I,M,w),y.material.updateMapMaterialFromData(w,M,this,x);continue}I[M].value=this.parseValue(S[M].type,x[M]),I[M].needsUpdate=!0}},parseValue:function(x,M){var w;switch(x){case"vec2":return new A.Vector2(M.x,M.y);case"vec3":return new A.Vector3(M.x,M.y,M.z);case"vec4":return new A.Vector4(M.x,M.y,M.z,M.w);case"color":return w=new A.Color(M),new A.Vector3(w.r,w.g,w.b);default:return M}},setMapOnTextureLoad:function(x,M,w){var S=this;this.el.addEventListener("materialtextureloaded",function(){x[M].value=S.material[w],x[M].needsUpdate=!0})}},u.exports.registerShader=function(x,M){var w,S={};if(Object.keys(M).forEach(function(I){S[I]={value:M[I],writable:!0}}),m[x])throw new Error("The shader "+x+" has already been registered");return w=function(){E.call(this)},w.prototype=Object.create(E.prototype,S),w.prototype.name=x,w.prototype.constructor=w,m[x]={Shader:w,schema:g(w.prototype.schema)},v.push(x),w}},"./src/core/system.js":(u,p,c)=>{var f=c("./src/core/component.js"),g=c("./src/core/schema.js"),m=c("./src/utils/index.js"),v=c("./src/core/readyState.js"),A=g.parseProperties,y=g.parseProperty,C=g.process,E=g.isSingleProperty,x=m.styleParser,M=u.exports.systems={},w=u.exports.System=function(S){var I=f&&f.components[this.name];this.el=S,this.sceneEl=S,I&&(I.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};w.prototype={schema:{},init:function(){},update:function(S){},updateProperties:function(S){var I=this.data;Object.keys(g).length&&(this.buildData(S),this.update(I))},buildData:function(S){var I=this.schema;Object.keys(I).length&&(S=S||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),E(I)?this.data=y(S,I):this.data=A(x.parse(S)||{},I,!1,this.name))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},u.exports.registerSystem=function(S,I){var L,R,k={},P=m.findAllScenes(document);if(Object.keys(I).forEach(function(F){k[F]={value:I[F],writable:!0}}),M[S])throw new Error("The system `"+S+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");if(R=function(F){w.call(this,F)},R.prototype=Object.create(w.prototype,k),R.prototype.name=S,R.prototype.constructor=R,R.prototype.schema=m.extend(C(R.prototype.schema)),M[S]=R,v.canInitializeElements)for(L=0;L<P.length;L++)P[L].initSystem(S)}},"./src/extras/components/index.js":(u,p,c)=>{c("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(u,p,c)=>{var f=c("./src/core/component.js").registerComponent,g=c("./src/lib/three.js"),m=new g.Vector3,v=new g.Vector3;f("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var A=this.data,y=this.el,C=y.object3D.parent,E=y.object3D,x=new g.Group;m.copy(E.position),v.copy(E.rotation),C.remove(E),x.add(E),C.add(x),y.object3D=x,E.position.set(-1*A.x,-1*A.y,-1*A.z),x.position.set(A.x+m.x,A.y+m.y,A.z+m.z),x.rotation.copy(E.rotation),E.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(u,p,c)=>{var f=c("./src/core/component.js").components,g=c("./src/core/shader.js").shaders,m=c("./src/utils/index.js"),v={};Object.keys(f.material.schema).forEach(A),Object.keys(g.standard.schema).forEach(A);function A(y){var C=y.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();y==="fog"&&(C="material-fog"),y==="visible"&&(C="material-visible"),v[C]="material."+y}u.exports=function(){return{defaultComponents:{material:{}},mappings:m.extend({},v)}}},"./src/extras/primitives/index.js":(u,p,c)=>{c("./src/extras/primitives/primitives/a-camera.js"),c("./src/extras/primitives/primitives/a-cursor.js"),c("./src/extras/primitives/primitives/a-curvedimage.js"),c("./src/extras/primitives/primitives/a-gltf-model.js"),c("./src/extras/primitives/primitives/a-image.js"),c("./src/extras/primitives/primitives/a-light.js"),c("./src/extras/primitives/primitives/a-link.js"),c("./src/extras/primitives/primitives/a-obj-model.js"),c("./src/extras/primitives/primitives/a-sky.js"),c("./src/extras/primitives/primitives/a-sound.js"),c("./src/extras/primitives/primitives/a-text.js"),c("./src/extras/primitives/primitives/a-video.js"),c("./src/extras/primitives/primitives/a-videosphere.js"),c("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(u,p,c)=>{var f=c("./src/core/a-node.js").knownTags,g=c("./src/core/a-entity.js").AEntity,m=c("./src/core/component.js").components,v=c("./src/utils/index.js"),A=v.debug,y=v.entity.setComponentProperty,C=A("extras:primitives:debug"),E=A("extras:primitives:warn"),x=A("extras:primitives:error"),M=u.exports.primitives={};u.exports.registerPrimitive=function(R,k){if(R=R.toLowerCase(),f[R]){x("Trying to register primitive "+R+" that has been already previously registered");return}f[R]=!0,C("Registering <%s>",R),k.defaultAttributes&&E("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var P=k.mappings||{},F=class extends g{constructor(){super(),this.defaultComponentsFromPrimitive=k.defaultComponents||k.defaultAttributes||{},this.deprecated=k.deprecated||null,this.deprecatedMappings=k.deprecatedMappings||{},this.mappings=P,k.deprecated&&console.warn(k.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var O=this.mappings,W=this;Object.keys(O).forEach(function($){var H;$!==$.toLowerCase()&&E("Mapping keys should be specified in lower case. The mapping key "+$+" may not be recognized"),m[$]&&(H=O[$].replace(".","-"),O[H]=O[$],delete O[$],console.warn("The primitive "+W.tagName.toLowerCase()+" has a mapping collision. The attribute "+$+" has the same name as a registered component and has been renamed to "+H))})}getExtraComponents(){var O,W,V,$,H,Y=this;for(W=v.clone(this.defaultComponentsFromPrimitive),H=this.getAttribute("mixin"),H&&(H=v.split(H.trim(),/\s+/),H.forEach(function(ue){var he=document.getElementById(ue);if(he){var Me=he.rawAttributeCache,de=he.componentCache;for(var Pe in Me){if($=Y.mappings[Pe],$){w($,Me[Pe],W);return}Pe in de&&(W[Pe]=Q(W[Pe],de[Pe]))}}})),V=0;V<this.attributes.length;V++)O=this.attributes[V],$=this.mappings[O.name],$&&w($,O.value,W);return W;function Q(se,ue){return G(se)?J(ue):G(ue)?J(se):K(se)&&K(ue)?v.extendDeep(se,ue):J(ue)}function G(se){return typeof se>"u"}function J(se){return K(se)?v.extendDeep({},se):se}function K(se){return se!==null&&se.constructor===Object}}attributeChangedCallback(O,W,V){var $=this.mappings[O];if(O in this.deprecatedMappings&&console.warn(this.deprecatedMappings[O]),!O||!$){super.attributeChangedCallback(O,W,V);return}y(this,$,V)}};return customElements.define(R,F),F.mappings=P,M[R]=F,F};function w(L,R,k){var P=v.entity.getComponentPropertyPath(L);P.constructor===Array?(k[P[0]]=k[P[0]]||{},k[P[0]][P[1]]=R.trim()):k[P]=R.trim()}function S(L,R){var k=m[L].schema;Object.keys(k).map(function(P){var F=P.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();R[F]!==void 0&&(F=L+"-"+P),R[F]=L+"."+P})}function I(L,R,k){k=k||{},Object.keys(R).map(function(F){S(F,k)}),u.exports.registerPrimitive(L,v.extendDeep({},null,{defaultComponents:R,mappings:k}))}u.exports.definePrimitive=I},"./src/extras/primitives/primitives/a-camera.js":(u,p,c)=>{var f=c("./src/extras/primitives/primitives.js").registerPrimitive;f("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js");g("a-cursor",m.extendDeep({},f(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js");g("a-curvedimage",m.extendDeep({},f(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(u,p,c)=>{var f=c("./src/extras/primitives/primitives.js").registerPrimitive;f("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js");g("a-image",m.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(u,p,c)=>{var f=c("./src/extras/primitives/primitives.js").registerPrimitive;f("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(u,p,c)=>{var f=c("./src/extras/primitives/primitives.js").registerPrimitive;f("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js")(),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js");g("a-obj-model",m.extendDeep({},f,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js"),v=c("./src/extras/primitives/primitives/meshPrimitives.js");g("a-sky",m.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:m.extendDeep({},v["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(u,p,c)=>{var f=c("./src/extras/primitives/primitives.js").registerPrimitive;f("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(u,p,c)=>{var f=c("./src/extras/primitives/primitives.js").definePrimitive;f("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js");g("a-video",m.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/extras/primitives/primitives.js").registerPrimitive,m=c("./src/utils/index.js");g("a-videosphere",m.extendDeep({},f(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(u,p,c)=>{var f=c("./src/extras/primitives/getMeshMixin.js"),g=c("./src/core/geometry.js").geometries,m=c("./src/core/geometry.js").geometryNames,v=c("./src/extras/primitives/primitives.js").registerPrimitive,A=c("./src/utils/index.js"),y=u.exports={};m.forEach(function(x){var M=g[x],w=C(x),S={};Object.keys(M.schema).forEach(function(k){S[C(k)]="geometry."+k});var I="a-"+w,L=v(I,A.extendDeep({},f(),{defaultComponents:{geometry:{primitive:x}},mappings:S}));y[I]=L});function C(E){return E.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(m){this.geometry=new g.BoxGeometry(m.width,m.height,m.depth,m.segmentsWidth,m.segmentsHeight,m.segmentsDepth)}})},"./src/geometries/circle.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=g.MathUtils.degToRad;f("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new g.CircleGeometry(v.radius,v.segments,m(v.thetaStart),m(v.thetaLength))}})},"./src/geometries/cone.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=g.MathUtils.degToRad;f("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new g.CylinderGeometry(v.radiusTop,v.radiusBottom,v.height,v.segmentsRadial,v.segmentsHeight,v.openEnded,m(v.thetaStart),m(v.thetaLength))}})},"./src/geometries/cylinder.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=g.MathUtils.degToRad;f("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new g.CylinderGeometry(v.radius,v.radius,v.height,v.segmentsRadial,v.segmentsHeight,v.openEnded,m(v.thetaStart),m(v.thetaLength))}})},"./src/geometries/dodecahedron.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(m){this.geometry=new g.DodecahedronGeometry(m.radius,m.detail)}})},"./src/geometries/icosahedron.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(m){this.geometry=new g.IcosahedronGeometry(m.radius,m.detail)}})},"./src/geometries/index.js":(u,p,c)=>{c("./src/geometries/box.js"),c("./src/geometries/circle.js"),c("./src/geometries/cone.js"),c("./src/geometries/cylinder.js"),c("./src/geometries/dodecahedron.js"),c("./src/geometries/icosahedron.js"),c("./src/geometries/octahedron.js"),c("./src/geometries/plane.js"),c("./src/geometries/ring.js"),c("./src/geometries/sphere.js"),c("./src/geometries/tetrahedron.js"),c("./src/geometries/torus.js"),c("./src/geometries/torusKnot.js"),c("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(m){this.geometry=new g.OctahedronGeometry(m.radius,m.detail)}})},"./src/geometries/plane.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(m){this.geometry=new g.PlaneGeometry(m.width,m.height,m.segmentsWidth,m.segmentsHeight)}})},"./src/geometries/ring.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=g.MathUtils.degToRad;f("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new g.RingGeometry(v.radiusInner,v.radiusOuter,v.segmentsTheta,v.segmentsPhi,m(v.thetaStart),m(v.thetaLength))}})},"./src/geometries/sphere.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=g.MathUtils.degToRad;f("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(v){this.geometry=new g.SphereGeometry(v.radius,v.segmentsWidth,v.segmentsHeight,m(v.phiStart),m(v.phiLength),m(v.thetaStart),m(v.thetaLength))}})},"./src/geometries/tetrahedron.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(m){this.geometry=new g.TetrahedronGeometry(m.radius,m.detail)}})},"./src/geometries/torus.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=g.MathUtils.degToRad;f("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(v){this.geometry=new g.TorusGeometry(v.radius,v.radiusTubular*2,v.segmentsRadial,v.segmentsTubular,m(v.arc))}})},"./src/geometries/torusKnot.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js");f("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(m){this.geometry=new g.TorusKnotGeometry(m.radius,m.radiusTubular*2,m.segmentsTubular,m.segmentsRadial,m.p,m.q)}})},"./src/geometries/triangle.js":(u,p,c)=>{var f=c("./src/core/geometry.js").registerGeometry,g=c("./src/lib/three.js"),m=new g.Quaternion,v=new g.Vector3(0,0,1),A=new g.Vector2,y=new g.Vector2,C=new g.Vector2;f("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(E){var x,M,w,S,I,L,R,k,P;w=new g.Triangle,w.a.set(E.vertexA.x,E.vertexA.y,E.vertexA.z),w.b.set(E.vertexB.x,E.vertexB.y,E.vertexB.z),w.c.set(E.vertexC.x,E.vertexC.y,E.vertexC.z),M=w.getNormal(new g.Vector3),m.setFromUnitVectors(M,v),S=w.a.clone().applyQuaternion(m),I=w.b.clone().applyQuaternion(m),L=w.c.clone().applyQuaternion(m),A.set(Math.min(S.x,I.x,L.x),Math.min(S.y,I.y,L.y)),y.set(Math.max(S.x,I.x,L.x),Math.max(S.y,I.y,L.y)),C.set(0,0).subVectors(y,A),S=new g.Vector2().subVectors(S,A).divide(C),I=new g.Vector2().subVectors(I,A).divide(C),L=new g.Vector2().subVectors(L,A).divide(C),x=this.geometry=new g.BufferGeometry,R=[w.a.x,w.a.y,w.a.z,w.b.x,w.b.y,w.b.z,w.c.x,w.c.y,w.c.z],k=[M.x,M.y,M.z,M.x,M.y,M.z,M.x,M.y,M.z],P=[S.x,S.y,I.x,I.y,L.x,L.y],x.setAttribute("position",new g.Float32BufferAttribute(R,3)),x.setAttribute("normal",new g.Float32BufferAttribute(k,3)),x.setAttribute("uv",new g.Float32BufferAttribute(P,2))}})},"./src/index.js":(u,p,c)=>{if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var f=c("./src/utils/isIOSOlderThan10.js"),g=f(window.navigator.userAgent)?1/window.devicePixelRatio:1,m=c("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),v={BUFFER_SCALE:g,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new m(v)}var A=c("./src/utils/index.js"),y=A.debug,C=y("A-Frame:error"),E=y("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&E("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&C("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),A.device.isBrowserEnvironment&&(c("./src/style/aframe.css"),c("./src/style/rStats.css"));var x=c("./src/core/scene/a-scene.js").AScene,M=c("./src/core/component.js").components,w=c("./src/core/component.js").registerComponent,S=c("./src/core/geometry.js").registerGeometry,I=c("./src/extras/primitives/primitives.js").registerPrimitive,L=c("./src/core/shader.js").registerShader,R=c("./src/core/system.js").registerSystem,k=c("./src/core/shader.js").shaders,P=c("./src/core/system.js").systems,F=window.THREE=c("./src/lib/three.js"),O=c("./src/core/readyState.js"),W=c("./package.json");c("./src/components/index.js"),c("./src/geometries/index.js"),c("./src/shaders/index.js"),c("./src/systems/index.js");var V=c("./src/core/a-node.js").ANode,$=c("./src/core/a-entity.js").AEntity;c("./src/core/a-assets.js"),c("./src/core/a-cubemap.js"),c("./src/core/a-mixin.js"),c("./src/extras/components/index.js"),c("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.6.0 (Date 2024-05-23, Commit #e6c47761)"),console.log("THREE Version (https://github.com/supermedium/three.js):",F.REVISION),console.log("WebVR Polyfill Version:",W.dependencies["webvr-polyfill"]),window.AFRAME_ASYNC||O.waitForDocumentReadyState(),u.exports=window.AFRAME={AComponent:c("./src/core/component.js").Component,AEntity:$,ANode:V,ANIME:c("./node_modules/super-animejs/lib/anime.es.js").default,AScene:x,components:M,coreComponents:Object.keys(M),geometries:c("./src/core/geometry.js").geometries,registerComponent:w,registerGeometry:S,registerPrimitive:I,registerShader:L,registerSystem:R,primitives:{getMeshMixin:c("./src/extras/primitives/getMeshMixin.js"),primitives:c("./src/extras/primitives/primitives.js").primitives},scenes:c("./src/core/scene/scenes.js"),schema:c("./src/core/schema.js"),shaders:k,systems:P,emitReady:O.emitReady,THREE:F,utils:A,version:W.version}},"./src/lib/rStatsAframe.js":u=>{window.aframeStats=function(p){var c=null,f=p,g={te:{caption:"Entities"},lt:{caption:"Load Time"}},m=[{caption:"A-Frame",values:["te","lt"]}];function v(){c("te").set(A()),window.performance.getEntriesByName&&c("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function A(){var x=f.querySelectorAll("*");return Array.prototype.slice.call(x).filter(function(M){return M.isEntity}),x.length}function y(){}function C(){}function E(x){c=x}return{update:v,start:y,end:C,attach:E,values:g,groups:m,fractions:[]}},u.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(u,p,c)=>{var f=c("./src/lib/three.mjs").default;c.g.THREE=f,c("./vendor/DeviceOrientationControls.js"),f.Cache&&(f.Cache.enabled=!0),u.exports=f},"./src/shaders/flat.js":(u,p,c)=>{var f=c("./src/core/shader.js").registerShader,g=c("./src/lib/three.js"),m=c("./src/utils/index.js");u.exports.Shader=f("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(A){this.materialData={color:new g.Color},v(A,this.materialData),this.material=new g.MeshBasicMaterial(this.materialData)},update:function(A){this.updateMaterial(A),m.material.updateMap(this,A)},updateMaterial:function(A){var y;v(A,this.materialData);for(y in this.materialData)this.material[y]=this.materialData[y]}});function v(A,y){return y.color.set(A.color),y.fog=A.fog,y.wireframe=A.wireframe,y.toneMapped=A.toneMapped,y.wireframeLinewidth=A.wireframeLinewidth,y}},"./src/shaders/index.js":(u,p,c)=>{c("./src/shaders/flat.js"),c("./src/shaders/standard.js"),c("./src/shaders/phong.js"),c("./src/shaders/sdf.js"),c("./src/shaders/msdf.js"),c("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(u,p,c)=>{var f=c("./src/core/shader.js").registerShader,g=c("./src/lib/three.js"),m=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),v=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);u.exports.Shader=f("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},vertexShader:m,fragmentShader:v,init:function(){return this.uniforms=g.UniformsUtils.merge([g.UniformsLib.fog,this.initUniforms()]),this.material=new g.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/phong.js":(u,p,c)=>{var f=c("./src/core/shader.js").registerShader,g=c("./src/lib/three.js"),m=c("./src/utils/index.js");u.exports.Shader=f("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(A){this.materialData={color:new g.Color,specular:new g.Color,emissive:new g.Color},v(A,this.materialData),this.material=new g.MeshPhongMaterial(this.materialData);var y=this.el.sceneEl;Object.defineProperty(this.material,"envMap",{get:function(){return this._envMap||y.object3D.environment},set:function(C){this._envMap=C}})},update:function(A){this.updateMaterial(A),m.material.updateMap(this,A),m.material.updateDistortionMap("normal",this,A),m.material.updateDistortionMap("displacement",this,A),m.material.updateDistortionMap("ambientOcclusion",this,A),m.material.updateDistortionMap("bump",this,A),m.material.updateEnvMap(this,A)},updateMaterial:function(A){var y;v(A,this.materialData);for(y in this.materialData)this.material[y]=this.materialData[y]}});function v(A,y){switch(y.color.set(A.color),y.specular.set(A.specular),y.emissive.set(A.emissive),y.emissiveIntensity=A.emissiveIntensity,y.fog=A.fog,y.transparent=A.transparent,y.wireframe=A.wireframe,y.wireframeLinewidth=A.wireframeLinewidth,y.shininess=A.shininess,y.flatShading=A.flatShading,y.wireframe=A.wireframe,y.wireframeLinewidth=A.wireframeLinewidth,y.reflectivity=A.reflectivity,y.refractionRatio=A.refractionRatio,A.combine){case"mix":y.combine=g.MixOperation;break;case"multiply":y.combine=g.MultiplyOperation;break;case"add":y.combine=g.AddOperation;break}return A.normalMap&&(y.normalScale=A.normalScale),A.ambientOcclusionMap&&(y.aoMapIntensity=A.ambientOcclusionMapIntensity),A.bumpMap&&(y.bumpScale=A.bumpMapScale),A.displacementMap&&(y.displacementScale=A.displacementScale,y.displacementBias=A.displacementBias),y}},"./src/shaders/sdf.js":(u,p,c)=>{var f=c("./src/core/shader.js").registerShader,g=c("./src/lib/three.js"),m=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),v=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);u.exports.Shader=f("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:m,fragmentShader:v,init:function(){return this.uniforms=g.UniformsUtils.merge([g.UniformsLib.fog,this.initUniforms()]),this.material=new g.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/shadow.js":(u,p,c)=>{var f=c("./src/core/shader.js").registerShader,g=c("./src/lib/three.js");u.exports.Shader=f("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(m){this.material=new g.ShadowMaterial},update:function(m){this.material.opacity=m.opacity,this.material.alphaToCoverage=m.alphaToCoverage,this.material.transparent=m.transparent}})},"./src/shaders/standard.js":(u,p,c)=>{var f=c("./src/core/shader.js").registerShader,g=c("./src/lib/three.js"),m=c("./src/utils/index.js");u.exports.Shader=f("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(A){this.materialData={color:new g.Color,emissive:new g.Color},v(A,this.materialData),this.material=new g.MeshStandardMaterial(this.materialData)},update:function(A){this.updateMaterial(A),m.material.updateMap(this,A),m.material.updateDistortionMap("normal",this,A),m.material.updateDistortionMap("displacement",this,A),m.material.updateDistortionMap("ambientOcclusion",this,A),m.material.updateDistortionMap("metalness",this,A),m.material.updateDistortionMap("roughness",this,A),m.material.updateEnvMap(this,A)},updateMaterial:function(A){var y,C=this.material;v(A,this.materialData);for(y in this.materialData)C[y]=this.materialData[y]}});function v(A,y){return y.color.set(A.color),y.emissive.set(A.emissive),y.emissiveIntensity=A.emissiveIntensity,y.fog=A.fog,y.metalness=A.metalness,y.roughness=A.roughness,y.wireframe=A.wireframe,y.wireframeLinewidth=A.wireframeLinewidth,A.normalMap&&(y.normalScale=A.normalScale),A.ambientOcclusionMap&&(y.aoMapIntensity=A.ambientOcclusionMapIntensity),A.displacementMap&&(y.displacementScale=A.displacementScale,y.displacementBias=A.displacementBias),y}},"./src/systems/camera.js":(u,p,c)=>{var f=c("./src/constants/index.js"),g=c("./src/core/system.js").registerSystem,m="data-aframe-default-camera";u.exports.System=g("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var A,y,C=this.sceneEl,E=this;if(C.camera&&!C.camera.el.getAttribute("camera").spectator){C.emit("cameraready",{cameraEl:C.camera.el});return}if(A=C.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!A.length){this.createDefaultCamera();return}for(this.numUserCameras=A.length,y=0;y<A.length;y++)A[y].addEventListener("object3dset",function(x){x.detail.type==="camera"&&E.checkUserCamera(this)}),A[y].isNode?A[y].load():A[y].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(A){var y,C=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(y=A.getAttribute("camera"),!y.active||y.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,C.camera=A.getObject3D("camera"),C.emit("cameraready",{cameraEl:A})}},createDefaultCamera:function(){var A,y=this.sceneEl;A=document.createElement("a-entity"),A.setAttribute("camera",{active:!0}),A.setAttribute("position",{x:0,y:f.DEFAULT_CAMERA_HEIGHT,z:0}),A.setAttribute("wasd-controls",""),A.setAttribute("look-controls",""),A.setAttribute(f.AFRAME_INJECTED,""),A.addEventListener("object3dset",function(C){C.detail.type==="camera"&&(y.camera=C.detail.object,y.emit("cameraready",{cameraEl:A}))}),y.appendChild(A)},disableActiveCamera:function(){var A,y;A=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),y=A[A.length-1],y.setAttribute("camera","active",!0)},setActiveCamera:function(A){var y,C,E,x,M=this.activeCameraEl,w=this.sceneEl;if(x=A.getObject3D("camera"),!(!x||A===this.activeCameraEl)){var S=w.querySelector("["+m+"]"),I=S&&S.querySelector(":not(a-mixin)[camera]");for(A!==I&&v(w),this.activeCameraEl=A,this.activeCameraEl.play(),w.camera=x,M&&M.setAttribute("camera","active",!1),C=w.querySelectorAll(":not(a-mixin)[camera]"),E=0;E<C.length;E++)y=C[E],!(!y.isEntity||A===y)&&(y.setAttribute("camera","active",!1),y.pause());w.emit("camera-set-active",{cameraEl:A})}},setSpectatorCamera:function(A){var y,C=this.spectatorCameraEl,E=this.sceneEl,x;y=A.getObject3D("camera"),!(!y||A===this.spectatorCameraEl)&&(C&&C.setAttribute("camera","spectator",!1),x=this.spectatorCameraEl=A,E.addEventListener("enter-vr",this.wrapRender),E.addEventListener("exit-vr",this.unwrapRender),x.setAttribute("camera","active",!1),x.play(),E.emit("camera-set-spectator",{cameraEl:A}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){this.originalRender&&(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(A,y){var C,E=this.sceneEl,x;C=E.renderer.xr.enabled,this.originalRender.call(E.renderer,A,y),!(!this.spectatorCameraEl||E.isMobile||!C)&&(x=this.spectatorCameraEl.components.camera.camera,E.renderer.xr.enabled=!1,this.originalRender.call(E.renderer,A,x),E.renderer.xr.enabled=C)}});function v(A){var y,C=A.camera;C&&(y=A.querySelector("["+m+"]"),y&&A.removeChild(y))}},"./src/systems/geometry.js":(u,p,c)=>{var f=c("./src/core/geometry.js").geometries,g=c("./src/core/system.js").registerSystem;u.exports.System=g("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(y){var C=this.cache,E,x;return y.skipCache?m(y):(x=this.hash(y),E=C[x],A(this.cacheCount,x),E||(E=m(y),C[x]=E,E))},unuseGeometry:function(y){var C=this.cache,E=this.cacheCount,x,M;y.skipCache||(M=this.hash(y),C[M]&&(v(E,M),!(E[M]>0)&&(x=C[M],x.dispose(),delete C[M],delete E[M])))},hash:function(y){return JSON.stringify(y)}});function m(y){var C=y.primitive,E=f[C]&&f[C].Geometry,x=new E;if(!E)throw new Error("Unknown geometry `"+C+"`");return x.init(y),x.geometry}function v(y,C){y[C]--}function A(y,C){y[C]=y[C]===void 0?1:y[C]+1}},"./src/systems/gltf-model.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/lib/three.js");function m(v){return new Promise(function(A,y){var C=document.createElement("script");document.body.appendChild(C),C.onload=A,C.onerror=y,C.async=!0,C.src=v})}u.exports.System=f("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var v=this.data.dracoDecoderPath,A=this.data.basisTranscoderPath,y=this.data.meshoptDecoderPath;!this.dracoLoader&&v&&(this.dracoLoader=new g.DRACOLoader,this.dracoLoader.setDecoderPath(v)),!this.ktx2Loader&&A&&(this.ktx2Loader=new g.KTX2Loader,this.ktx2Loader.setTranscoderPath(A).detectSupport(this.el.renderer)),!this.meshoptDecoder&&y&&(this.meshoptDecoder=m(y).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(u,p,c)=>{c("./src/systems/camera.js"),c("./src/systems/geometry.js"),c("./src/systems/gltf-model.js"),c("./src/systems/light.js"),c("./src/systems/material.js"),c("./src/systems/obb-collider.js"),c("./src/systems/renderer.js"),c("./src/systems/shadow.js"),c("./src/systems/tracked-controls-webvr.js"),c("./src/systems/tracked-controls-webxr.js"),c("./src/systems/webxr.js")},"./src/systems/light.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/constants/index.js"),m="data-aframe-default-light";u.exports.System=f("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",this.setupDefaultLights.bind(this))},registerLight:function(v){v.hasAttribute(m)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var v,A=this.sceneEl;if(this.defaultLights){v=document.querySelectorAll("["+m+"]");for(var y=0;y<v.length;y++)A.removeChild(v[y]);this.defaultLights=!1}},setupDefaultLights:function(){var v=this.sceneEl,A,y;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(A=document.createElement("a-entity"),A.setAttribute("light",{color:"#BBB",type:"ambient"}),A.setAttribute(m,""),A.setAttribute(g.AFRAME_INJECTED,""),v.appendChild(A),y=document.createElement("a-entity"),y.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),y.setAttribute("position",{x:-.5,y:1,z:1}),y.setAttribute(m,""),y.setAttribute(g.AFRAME_INJECTED,""),v.appendChild(y),this.defaultLights=!0)}})},"./src/systems/material.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/lib/three.js"),m=c("./src/utils/index.js"),v=c("./src/utils/material.js").setTextureProperties,A=c("./src/utils/material.js").createCompatibleTexture,y=m.debug,C=y("components:texture:error"),E=y("components:texture:warn"),x=new g.ImageLoader;u.exports.System=f("material",{init:function(){this.materials={},this.sourceCache={}},clearTextureSourceCache:function(){this.sourceCache={}},loadTexture:function(I,L,R){this.loadTextureSource(I,function(P){var F=A(P);v(F,L),R(F)})},loadTextureSource:function(I,L){var R=this,k=this.sourceCache,P=this.hash(I);if(k[P]){k[P].then(L);return}if(I.tagName==="CANVAS"){O(new g.Source(I));return}O(new Promise(F));function F(W,V){m.srcLoader.validateSrc(I,$,H);function $(Y){R.loadImage(Y,W)}function H(Y){R.loadVideo(Y,W)}}function O(W){k[P]=Promise.resolve(W),k[P].then(L)}},loadCubeMapTexture:function(I,L){var R=this,k=0,P=new g.CubeTexture;P.colorSpace=g.SRGBColorSpace;function F(W){R.loadTextureSource(I[W],function(V){P.images[W]=V,k++,k===6&&(P.needsUpdate=!0,L(P))})}if(I.length!==6){E("Cube map texture requires exactly 6 sources, got only %s sources",I.length);return}for(var O=0;O<I.length;O++)F(O)},loadImage:function(I,L){if(typeof I!="string"){L(new g.Source(I));return}L(M(I))},loadVideo:function(I,L){var R;typeof I!="string"&&(R=I,S(R)),R=R||w(I),L(new g.Source(R))},hash:function(I){return I.tagName&&(I.id||I.src)||I},registerMaterial:function(I){this.materials[I.uuid]=I},unregisterMaterial:function(I){delete this.materials[I.uuid]}});function M(I){return new Promise(L);function L(R,k){x.load(I,P,function(){},function(F){C("`$s` could not be fetched (Error code: %s; Response: %s)",F.status,F.statusText)});function P(F){R(new g.Source(F))}}}function w(I){var L=document.createElement("video");return L.setAttribute("playsinline",""),L.setAttribute("webkit-playsinline",""),L.autoplay=!0,L.loop=!0,L.crossOrigin="anonymous",L.addEventListener("error",function(){E("`%s` is not a valid video",I)},!0),L.src=I,L}function S(I){return I.autoplay=I.hasAttribute("autoplay")&&I.getAttribute("autoplay")!=="false",I.controls=I.hasAttribute("controls")&&I.getAttribute("controls")!=="false",I.getAttribute("loop")==="false"&&I.removeAttribute("loop"),I.getAttribute("preload")==="false"&&(I.preload="none"),I.crossOrigin=I.crossOrigin||"anonymous",I.setAttribute("playsinline",""),I.setAttribute("webkit-playsinline",""),I}},"./src/systems/obb-collider.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem;f("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(g){this.colliderEls.push(g),this.data.showColliders?g.components["obb-collider"].showCollider():g.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(g){var m=this.colliderEls,v=m.indexOf(g);g.components["obb-collider"].hideCollider(),v>-1&&m.splice(v,1),m.length===0&&(this.tick=void 0)},registerCollision:function(g,m){var v=this.collisions,A=!1,y=g.obb,C=m.obb,E=g.renderColliderMesh,x=m.renderColliderMesh;E&&E.material.color.set(16711680),x&&x.material.color.set(16711680);for(var M=0;M<v.length;M++)if(v[M].componentA.obb===y&&v[M].componentB.obb===C||v[M].componentA.obb===C&&v[M].componentB.obb===y){A=!0,v[M].detected=!0;break}A||(v.push({componentA:g,componentB:m,detected:!0}),g.el.emit("obbcollisionstarted",{trackedObject3D:g.trackedObject3D,withEl:m.el}),m.el.emit("obbcollisionstarted",{trackedObject3D:m.trackedObject3D,withEl:g.el}))},resetCollisions:function(){for(var g=this.collisions,m=0;m<g.length;m++)g[m].detected=!1},clearCollisions:function(){for(var g=this.collisions,m=[],v,A,y,C,E=0;E<g.length;E++)g[E].detected?m.push(g[E]):(v=g[E].componentA,A=g[E].componentB,y=v.renderColliderMesh,C=A.renderColliderMesh,y&&y.material.color.set(65280),v.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:A.el}),C&&C.material.color.set(65280),A.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:v.el}));this.collisions=m},detectCollisions:function(){var g,m,v,A,y=this.colliderEls;if(!(y.length<2)){this.resetCollisions();for(var C=0;C<y.length;C++)if(v=y[C].components["obb-collider"],g=y[C].components["obb-collider"].obb,!(g.halfSize.x===0||g.halfSize.y===0||g.halfSize.z===0))for(var E=C+1;E<y.length;E++)A=y[E].components["obb-collider"],m=A.obb,!(m.halfSize.x===0||m.halfSize.y===0||m.halfSize.z===0)&&g.intersectsOBB(m)&&this.registerCollision(v,A);this.clearCollisions()}}})},"./src/systems/renderer.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/utils/index.js"),m=c("./src/lib/three.js"),v=g.debug,A=v("components:renderer:warn");u.exports.System=f("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:g.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},stencil:{default:!1},foveationLevel:{default:1}},init:function(){var x=this.data,M=this.el,w=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),S=M.renderer;x.physicallyCorrectLights||(S.useLegacyLights=!x.physicallyCorrectLights),S.toneMapping=m[w+"ToneMapping"],m.Texture.DEFAULT_ANISOTROPY=x.anisotropy,m.ColorManagement.enabled=x.colorManagement,S.outputColorSpace=x.colorManagement?m.SRGBColorSpace:m.LinearSRGBColorSpace,M.hasAttribute("antialias")&&A('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),M.hasAttribute("logarithmicDepthBuffer")&&A('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),S.sortObjects=!0,S.setOpaqueSort(y)},update:function(){var x=this.data,M=this.el,w=M.renderer,S=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);w.toneMapping=m[S+"ToneMapping"],w.toneMappingExposure=x.exposure,w.xr.setFoveation(x.foveationLevel),x.sortObjects&&A('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),x.sortTransparentObjects?w.setTransparentSort(E):w.setTransparentSort(C)},applyColorCorrection:function(x){!this.data.colorManagement||!x||x.isTexture&&x.colorSpace!==m.SRGBColorSpace&&(x.colorSpace=m.SRGBColorSpace,x.needsUpdate=!0)},setWebXRFrameRate:function(x){var M=this.data,w=x.supportedFrameRates;if(w&&x.updateTargetFrameRate){var S;w.includes(90)?S=M.highRefreshRate?90:72:S=M.highRefreshRate?72:60,x.updateTargetFrameRate(S).catch(function(I){console.warn("failed to set target frame rate of "+S+". Error info: "+I)})}}});function y(x,M){return x.groupOrder!==M.groupOrder?x.groupOrder-M.groupOrder:x.renderOrder!==M.renderOrder?x.renderOrder-M.renderOrder:x.z-M.z}function C(x,M){return x.groupOrder!==M.groupOrder?x.groupOrder-M.groupOrder:x.renderOrder-M.renderOrder}function E(x,M){return x.groupOrder!==M.groupOrder?x.groupOrder-M.groupOrder:x.renderOrder!==M.renderOrder?x.renderOrder-M.renderOrder:M.z-x.z}u.exports.sortFrontToBack=y,u.exports.sortRenderOrderOnly=C,u.exports.sortBackToFront=E},"./src/systems/shadow.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/lib/three.js"),m={basic:g.BasicShadowMap,pcf:g.PCFShadowMap,pcfsoft:g.PCFSoftShadowMap};u.exports.System=f("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var A=this.sceneEl,y=this.data;this.shadowMapEnabled=!1,A.renderer.shadowMap.type=m[y.type],A.renderer.shadowMap.autoUpdate=y.autoUpdate},update:function(A){A.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(A){var y=this.sceneEl,C=this.sceneEl.renderer;this.shadowMapEnabled=A;var E=this.data.enabled&&this.shadowMapEnabled;C&&E!==C.shadowMap.enabled&&(C.shadowMap.enabled=E,v(y))}});function v(A){A.hasLoaded&&A.object3D.traverse(function(y){if(y.material)for(var C=Array.isArray(y.material)?y.material:[y.material],E=0;E<C.length;E++)C[E].needsUpdate=!0})}},"./src/systems/tracked-controls-webvr.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/utils/index.js"),m=g.device.isWebXRAvailable;u.exports.System=f("tracked-controls-webvr",{init:function(){var v=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=g.throttle(this.updateControllerList,500,this),!m&&navigator.getVRDisplays&&this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(A){A.length&&(v.vrDisplay=A[0])})})},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var v=this.controllers,A,y,C,E;if(y=navigator.getGamepads&&navigator.getGamepads(),!!y){for(E=v.length,v.length=0,C=0;C<y.length;++C)A=y[C],A&&A.pose&&v.push(A);v.length!==E&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/utils/index.js");u.exports.System=f("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=g.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var m=this,v=this.el.xrSession;if(!v){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var A=m.el.sceneEl.systems.webxr.sessionReferenceSpaceType;v.requestReferenceSpace(A).then(function(y){m.referenceSpace=y}).catch(function(y){throw m.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(A,'tracked-controls-webxr uses reference space "'+A+'".'),y})},updateControllerList:function(){var m=this.el.xrSession,v=this.oldControllers,A;if(!m){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(m.inputSources){if(this.controllers=m.inputSources,this.oldControllersLength===this.controllers.length){var y=!0;for(A=0;A<this.controllers.length;++A)if(!(this.controllers[A]===v[A]&&this.controllers[A].gamepad===v[A].gamepad)){y=!1;break}if(y)return}for(v.length=0,A=0;A<this.controllers.length;A++)v.push(this.controllers[A]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(u,p,c)=>{var f=c("./src/core/system.js").registerSystem,g=c("./src/utils/index.js"),m=g.debug("systems:webxr:warn");u.exports.System=f("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var v=this.data;this.sessionConfiguration={requiredFeatures:v.requiredFeatures,optionalFeatures:v.optionalFeatures},this.sessionReferenceSpaceType=v.referenceSpaceType,v.overlayElement&&(v.overlayElement.classList.remove("a-dom-overlay"),v.optionalFeatures.includes("dom-overlay")||(v.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",v)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:v.overlayElement},v.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(v){return!!(v==="viewer"||v==="local"||this.sessionConfiguration.requiredFeatures.includes(v)||this.sessionConfiguration.optionalFeatures.includes(v))},warnIfFeatureNotRequested:function(v,A){if(!this.wasFeatureRequested(v)){var y='Please add the feature "'+v+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;m((A?A+" ":"")+y)}}})},"./src/utils/coordinates.js":(u,p,c)=>{var f=c("./src/utils/debug.js"),g=f("utils:coordinates:warn"),m=["x","y","z","w"],v=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;u.exports.regex=v;var A=/\s+/g;function y(w,S,I){var L,R,k,P,F=I&&typeof I=="object"?I:{},O,W,V,$;if(w&&w instanceof Object)return O=w.x===void 0?S&&S.x:w.x,W=w.y===void 0?S&&S.y:w.y,V=w.z===void 0?S&&S.z:w.z,$=w.w===void 0?S&&S.w:w.w,O!=null&&(F.x=M(O)),W!=null&&(F.y=M(W)),V!=null&&(F.z=M(V)),$!=null&&(F.w=M($)),F;if(w==null)return typeof S=="object"?Object.assign(F,S):S;for(L=w.trim().split(A),P=0;P<m.length;P++)if(k=m[P],L[P])F[k]=parseFloat(L[P],10);else{if(R=S&&S[k],R===void 0)continue;F[k]=M(R)}return F}u.exports.parse=y;function C(w){var S;return typeof w!="object"?w:(S=w.x+" "+w.y,w.z!=null&&(S+=" "+w.z),w.w!=null&&(S+=" "+w.w),S)}u.exports.stringify=C;function E(w,S){return typeof w!="object"||typeof S!="object"?w===S:w.x===S.x&&w.y===S.y&&w.z===S.z&&w.w===S.w}u.exports.equals=E;function x(w){return v.test(w)}u.exports.isCoordinates=x,u.exports.isCoordinate=function(w){return g("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),x(w)};function M(w){return w!=null&&w.constructor===String?parseFloat(w,10):w}u.exports.toVector3=function(w){return new THREE.Vector3(w.x,w.y,w.z)}},"./src/utils/debug.js":(u,p,c)=>{var f=c("./node_modules/debug/src/browser.js"),g=c("./src/utils/device.js").isBrowserEnvironment,m={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};f.formatArgs=v;function v(x){if(x[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+x[0]+(this.useColors?"%c ":" "),!!this.useColors){this.color=y(this.namespace);var M="color: "+this.color;x.splice(1,0,M,"color: inherit");var w=0,S=0;x[0].replace(/%[a-zA-Z%]/g,function(I){I!=="%%"&&(w++,I==="%c"&&(S=w))}),x.splice(S,0,M)}}function A(x){var M=x.split(":");return M[M.length-1]}function y(x){var M=A(x),w=m.colors&&m.colors[M];return w||null}function C(){try{return window.localStorage}catch{}}var E=C();E&&(parseInt(E.logs,10)||E.logs==="true")?f.enable("*"):f.enable("*:error,*:info,*:warn"),g&&(window.logs=f),u.exports=f},"./src/utils/device.js":(u,p,c)=>{var f=c("./node_modules/debug/src/browser.js")("device:error"),g,m=!1,v=!1,A=u.exports.isWebXRAvailable=navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(V){var $;A||($=document.createElement("canvas"),g=V.display,$.getContext("webgl",{}),g.requestPresent([{source:$}]).then(function(){},function(){}))}),A){var y=function(){var V=document.querySelector("a-scene");if(!V){window.addEventListener("DOMContentLoaded",y);return}V.hasLoaded?V.components["xr-mode-ui"].updateEnterInterfaces():V.addEventListener("loaded",y)},C=function(V){f("WebXR session support error: "+V.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(V){m=V,y()}).catch(C),navigator.xr.isSessionSupported("immersive-ar").then(function(V){v=V,y()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){m=!0,y()}).catch(C),navigator.xr.supportsSession("immersive-ar").then(function(){v=!0,y()}).catch(function(){})):f("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(V){var $=document.querySelector("a-scene");g=V.length&&V[0],$&&$.emit("displayconnected",{vrDisplay:g})});function E(){return g}u.exports.getVRDisplay=E;function x(){return m||v||!!E()}u.exports.checkHeadsetConnected=x;function M(){return v}u.exports.checkARSupport=M;function w(){return m}u.exports.checkVRSupport=w;var S=function(){var V=!1;return function($){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test($)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test($.substr(0,4)))&&(V=!0),(R()||I()||W())&&(V=!0),O()&&(V=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return V}}();u.exports.isMobile=S;function I(V){var $=V||window.navigator.userAgent,H=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test($);return H||L()}u.exports.isTablet=I;function L(V,$,H){var Y=V||window.navigator.userAgent,Q=$||window.navigator.platform,G=H||window.navigator.maxTouchPoints||0;return(Q==="iPad"||Q==="MacIntel")&&G>0&&/Macintosh|Intel|iPad|ipad/i.test(Y)&&!window.MSStream}u.exports.isIpad=L;function R(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}u.exports.isIOS=R;function k(){return!S()&&!O()&&window.orientation!==void 0}u.exports.isMobileDeviceRequestingDesktopSite=k;function P(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}u.exports.isOculusBrowser=P;function F(){return/(Mobile VR)/i.test(window.navigator.userAgent)}u.exports.isFirefoxReality=F;function O(){return P()||F()}u.exports.isMobileVR=O;function W(){return/R7 Build/.test(window.navigator.userAgent)}u.exports.isR7=W,u.exports.isLandscape=function(){var V=window.orientation;return W()&&(V+=90),V===90||V===-90},u.exports.isBrowserEnvironment=typeof process>"u"||process.browser===!0,u.exports.isNodeEnvironment=!u.exports.isBrowserEnvironment},"./src/utils/entity.js":(u,p,c)=>{var f=c("./src/utils/split.js").split;function g(m,v){v=v||".";var A=f(m,v);return A.length===1?A[0]:A}u.exports.getComponentPropertyPath=g,u.exports.getComponentProperty=function(m,v,A){var y;return A=A||".",v.indexOf(A)!==-1?(y=g(v,A),y.constructor===String?m.getAttribute(y):m.getAttribute(y[0])[y[1]]):m.getAttribute(v)},u.exports.setComponentProperty=function(m,v,A,y){var C;if(y=y||".",v.indexOf(y)!==-1){C=g(v,y),C.constructor===String?m.setAttribute(C,A):m.setAttribute(C[0],C[1],A);return}m.setAttribute(v,A)}},"./src/utils/forceCanvasResizeSafariMobile.js":u=>{u.exports=function(c){var f=c.style.width,g=c.style.height;c.style.width=parseInt(f,10)+1+"px",c.style.height=parseInt(g,10)+1+"px",setTimeout(function(){c.style.width=f,c.style.height=g},200)}},"./src/utils/index.js":(u,p,c)=>{var f=c("./src/utils/debug.js"),g=c("./node_modules/deep-assign/index.js"),m=c("./src/utils/device.js"),v=c("./src/utils/object-pool.js"),A=f("utils:warn");u.exports.bind=function(C){return C.bind.apply(C,Array.prototype.slice.call(arguments,1))},u.exports.coordinates=c("./src/utils/coordinates.js"),u.exports.debug=f,u.exports.device=m,u.exports.entity=c("./src/utils/entity.js"),u.exports.forceCanvasResizeSafariMobile=c("./src/utils/forceCanvasResizeSafariMobile.js"),u.exports.material=c("./src/utils/material.js"),u.exports.objectPool=v,u.exports.split=c("./src/utils/split.js").split,u.exports.styleParser=c("./src/utils/styleParser.js"),u.exports.trackedControls=c("./src/utils/tracked-controls.js"),u.exports.checkHeadsetConnected=function(){return A("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),m.checkHeadsetConnected(arguments)},u.exports.isGearVR=u.exports.device.isGearVR=function(){A("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},u.exports.isIOS=function(){return A("`utils.isIOS` has moved to `utils.device.isIOS`"),m.isIOS(arguments)},u.exports.isOculusGo=u.exports.device.isOculusGo=function(){A("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},u.exports.isMobile=function(){return A("`utils.isMobile has moved to `utils.device.isMobile`"),m.isMobile(arguments)},u.exports.throttle=function(C,E,x){var M;return x&&(C=C.bind(x)),function(){var w=Date.now(),S=typeof M>"u"?E:w-M;(typeof M>"u"||S>=E)&&(M=w,C.apply(null,arguments))}},u.exports.throttleLeadingAndTrailing=function(C,E,x){var M,w;x&&(C=C.bind(x));var S,I=function(){M=Date.now(),C.apply(this,S),w=void 0};return function(){var L=Date.now(),R=typeof M>"u"?E:L-M;R>=E?(clearTimeout(w),w=void 0,M=L,C.apply(null,arguments)):(w=w||setTimeout(I,E-R),S=arguments)}},u.exports.throttleTick=function(C,E,x){var M;return x&&(C=C.bind(x)),function(w,S){var I=typeof M>"u"?S:w-M;(typeof M>"u"||I>=E)&&(M=w,C(w,I))}},u.exports.debounce=function(C,E,x){var M;return function(){var w=this,S=arguments,I=function(){M=null,x||C.apply(w,S)},L=x&&!M;clearTimeout(M),M=setTimeout(I,E),L&&C.apply(w,S)}},u.exports.extend=Object.assign,u.exports.extendDeep=g,u.exports.clone=function(C){return JSON.parse(JSON.stringify(C))};var y=function(){var C=v.createPool(function(){return[]});return function(E,x){var M,w,S,I,L,R;if(E===void 0||x===void 0||E===null||x===null||!(E&&x&&E.constructor===Object&&x.constructor===Object||E.constructor===Array&&x.constructor===Array))return E===x;w=C.use(),S=C.use(),w.length=0,S.length=0;for(M in E)w.push(M);for(M in x)S.push(M);if(w.length!==S.length)return C.recycle(w),C.recycle(S),!1;for(I=0;I<w.length;++I)if(L=E[w[I]],R=x[w[I]],typeof L=="object"||typeof R=="object"||Array.isArray(L)&&Array.isArray(R)){if(L===R)continue;if(!y(L,R))return C.recycle(w),C.recycle(S),!1}else if(L!==R)return C.recycle(w),C.recycle(S),!1;return C.recycle(w),C.recycle(S),!0}}();u.exports.deepEqual=y,u.exports.diff=function(){var C=[];return function(E,x,M){var w,S,I,L,R,k,P;L=M||{},C.length=0;for(R in E)C.push(R);if(!x)return L;for(I in x)C.indexOf(I)===-1&&C.push(I);for(k=0;k<C.length;k++)R=C[k],w=E[R],S=x[R],P=w&&S&&w.constructor===Object&&S.constructor===Object,(P&&!y(w,S)||!P&&w!==S)&&(L[R]=S);return L}}(),u.exports.shouldCaptureKeyEvent=function(C){return C.metaKey?!1:document.activeElement===document.body},u.exports.splitString=function(C,E){typeof E>"u"&&(E=" ");var x=new RegExp(E,"g");return C=(C||"").replace(x,E),C.split(E)},u.exports.getElData=function(C,E){E=E||{};var x={};Object.keys(E).forEach(M);function M(w){C.hasAttribute(w)&&(x[w]=C.getAttribute(w))}return x},u.exports.getUrlParameter=function(C){C=C.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var E=new RegExp("[\\?&]"+C+"=([^&#]*)"),x=E.exec(location.search);return x===null?"":decodeURIComponent(x[1].replace(/\+/g," "))},u.exports.isIframed=function(){return window.top!==window.self},u.exports.findAllScenes=function(C){for(var E=[],x=C.getElementsByTagName("*"),M=0,w=x.length;M<w;M++)x[M].isScene&&E.push(x[M]);return E},u.exports.srcLoader=c("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/isIOSOlderThan10.js":u=>{u.exports=function(c){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(c)}},"./src/utils/material.js":(u,p,c)=>{var f=c("./src/lib/three.js"),g=c("./src/utils/src-loader.js"),m=c("./src/utils/debug.js"),v=m("utils:material:warn"),A=new Set(["emissiveMap","envMap","map","specularMap"]);function y(w,S){var I=S.offset||{x:0,y:0},L=S.repeat||{x:1,y:1},R=S.npot||!1,k=S.anisotropy||f.Texture.DEFAULT_ANISOTROPY,P=w.wrapS,F=w.wrapT,O=w.magFilter,W=w.minFilter;R&&(P=f.ClampToEdgeWrapping,F=f.ClampToEdgeWrapping,O=f.LinearFilter,W=f.LinearFilter),(L.x!==1||L.y!==1)&&(P=f.RepeatWrapping,F=f.RepeatWrapping),w.offset.set(I.x,I.y),w.repeat.set(L.x,L.y),(w.wrapS!==P||w.wrapT!==F||w.magFilter!==O||w.minFilter!==W||w.anisotropy!==k)&&(w.wrapS=P,w.wrapT=F,w.magFilter=O,w.minFilter=W,w.anisotropy=k,w.needsUpdate=!0)}u.exports.setTextureProperties=y,u.exports.updateMapMaterialFromData=function(w,S,I,L){var R=I.el,k=I.material,P=R.sceneEl.systems.renderer,F=L[S];if(I.materialSrcs||(I.materialSrcs={}),!F){delete I.materialSrcs[w],W(null);return}if(F===I.materialSrcs[w]&&k[w]){y(k[w],L);return}I.materialSrcs[w]=F,F instanceof f.Texture?W(F):R.sceneEl.systems.material.loadTextureSource(F,O);function O(V){if(I.materialSrcs[w]===F){var $=k[w];$&&(V===null||!x($,V))&&($=null),!$&&V&&($=M(V)),$&&($.source!==V&&($.source=V,$.needsUpdate=!0),A.has(w)&&P.applyColorCorrection($),y($,L)),W($)}}function W(V){k[w]!==V&&(k[w]&&k[w].dispose(),k[w]=V,k.needsUpdate=!0,E(R,V))}},u.exports.updateMap=function(w,S){return u.exports.updateMapMaterialFromData("map","src",w,S)},u.exports.updateDistortionMap=function(w,S,I){var L=w;w==="ambientOcclusion"&&(L="ao");var R={};return R.src=I[w+"Map"],R.offset=I[w+"TextureOffset"],R.repeat=I[w+"TextureRepeat"],R.wrap=I[w+"TextureWrap"],u.exports.updateMapMaterialFromData(L+"Map","src",S,R)};var C={};u.exports.updateEnvMap=function(w,S){var I=w.material,L=w.el,R="envMap",k=S.envMap,P=S.sphericalEnvMap,F=S.refract;if(P&&(k=P,v("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")),w.materialSrcs||(w.materialSrcs={}),!k){delete w.materialSrcs[R],I.envMap=null,I.needsUpdate=!0;return}if(w.materialSrcs[R]=k,C[k]){C[k].then(O);return}C[k]=new Promise(function(W){g.validateEnvMapSrc(k,function($){L.sceneEl.systems.material.loadCubeMapTexture($,function(H){H.mapping=F?f.CubeRefractionMapping:f.CubeReflectionMapping,O(H),W(H)})},function($){L.sceneEl.systems.material.loadTexture($,{src:$},function(H){H.mapping=F?f.EquirectangularRefractionMapping:f.EquirectangularReflectionMapping,O(H),W(H)})})});function O(W){w.materialSrcs[R]===k&&(I.envMap=W,I.needsUpdate=!0,E(L,W))}};function E(w,S){if(!S||(w.emit("materialtextureloaded",{src:S.image,texture:S}),!S.image||S.image.tagName!=="VIDEO"))return;S.image.addEventListener("loadeddata",I),S.image.addEventListener("ended",L);function I(){w.emit("materialvideoloadeddata",{src:S.image,texture:S})}function L(){w.emit("materialvideoended",{src:S.image,texture:S})}S.addEventListener("dispose",function(){S.image.removeEventListener("loadeddata",I),S.image.removeEventListener("ended",L)})}u.exports.handleTextureEvents=E;function x(w,S){return S.data instanceof HTMLCanvasElement?w.isCanvasTexture:S.data instanceof HTMLVideoElement?w.isVideoTexture&&w.source===S:w.isTexture&&!w.isCanvasTexture&&!w.isVideoTexture}u.exports.isCompatibleTexture=x;function M(w){var S;return w.data instanceof HTMLCanvasElement?S=new f.CanvasTexture:w.data instanceof HTMLVideoElement?S=new f.VideoTexture(w.data):S=new f.Texture,S.source=w,S.needsUpdate=!0,S}u.exports.createCompatibleTexture=M},"./src/utils/math.js":u=>{function p(f,g,m){var v=g.dot(f);return(v-g.dot(m))/g.length()}function c(f,g,m,v){var A=p(f,g,m);return v.copy(g),v.multiplyScalar(A),v.add(m),v}u.exports.distanceOfPointFromPlane=p,u.exports.nearestPointInPlane=c},"./src/utils/object-pool.js":u=>{var p=Object.freeze(Object.create(null));function c(){return{}}u.exports.createPool=function(v){var A=[],y=null;v=v||c;function C(){var w;return(y===null||y===A.length)&&x(A.length||5),w=A[y],A[y++]=p,f(w),w}function E(w){if(w instanceof Object){if(y===null||y===-1){A[A.length]=w;return}A[--y]=w}}function x(w){var S,I;if(w=w===void 0?A.length:w,w>0&&y==null&&(y=0),w>0)for(S=A.length,A.length+=Number(w),I=S;I<A.length;I++)A[I]=v();return A.length}function M(){return A.length}return{grow:x,pool:A,recycle:E,size:M,use:C}};function f(m){var v;if(!(!m||m.constructor!==Object))for(v in m)m[v]=void 0}u.exports.clearObject=f;function g(m,v){var A;if(!(!m||m.constructor!==Object))for(A in m)A in v||delete m[A]}u.exports.removeUnusedKeys=g},"./src/utils/split.js":u=>{u.exports.split=function(){var p={};return function(c,f){return f in p||(p[f]={}),c in p[f]||(p[f][c]=c.split(f)),p[f][c]}}()},"./src/utils/src-loader.js":(u,p,c)=>{var f=c("./src/utils/debug.js"),g=f("utils:src-loader:warn");function m(M,w,S){C(M,function(L){if(L){w(M);return}S(M)})}function v(M,w,S){var I,L="",R,k,P=[];if(typeof M=="string"){let O=function(W){P.push(W),P.length===6&&w(P)};for(R=0;R<5;R++)L+="(url\\((?:[^\\)]+)\\),\\s*)";if(L+="(url\\((?:[^\\)]+)\\)\\s*)",k=M.match(new RegExp(L)),k){for(R=1;R<7;R++)m(y(k[R]),O);return}if(!M.startsWith("#")){var F=y(M);m(F||M,S);return}}if(M.tagName?I=M:I=x(M),!!I){if(I.tagName==="A-CUBEMAP"&&I.srcs)return w(I.srcs);if(I.tagName==="IMG")return S(I);g('Selector "%s" does not point to <a-cubemap> or <img>',M)}}function A(M,w){return v(M,w,function(){g("Expected cubemap but got image")})}function y(M){var w=M.match(/url\((.+)\)/);if(w)return w[1]}function C(M,w){var S;if(M.tagName){w(M.tagName==="IMG");return}S=new XMLHttpRequest,S.open("HEAD",M),S.addEventListener("load",function(I){var L;S.status>=200&&S.status<300?(L=S.getResponseHeader("Content-Type"),L==null?E(M,w):L.startsWith("image")?w(!0):w(!1)):E(M,w),S.abort()}),S.send()}function E(M,w){var S=new Image;S.addEventListener("load",I);function I(){w(!0)}S.addEventListener("error",L);function L(){w(!1)}S.src=M}function x(M){try{var w=document.querySelector(M);return w||g('No element was found matching the selector: "%s"',M),w}catch{g('"%s" is not a valid selector',M);return}}u.exports={parseUrl:y,validateSrc:m,validateCubemapSrc:A,validateEnvMapSrc:v}},"./src/utils/styleParser.js":u=>{var p=/-([a-z])/g;u.exports.parse=function(A,y){var C;return typeof A!="string"||(C=g(A,y),C[""])?A:C},u.exports.stringify=function(A){return typeof A=="string"?A:m(A)};function c(A){return A.replace(p,v)}u.exports.toCamelCase=c;var f=function(){var A=[],y=/url\([^)]+$/;return function(E){var x="",M,w=0,S=";";for(A.length=0;w<E.length;){if(M=E.indexOf(S,w),M===-1&&(M=E.length),x+=E.substring(w,M),y.test(x)){x+=";",w=M+1;continue}A.push(x.trim()),x="",w=M+1}return A}}();function g(A,y){var C,E,x,M,w,S;for(y=y||{},C=f(A),E=0;E<C.length;E++)x=C[E],x&&(M=x.indexOf(":"),w=x.substr(0,M).trim(),S=x.substr(M+1).trim(),y[c(w)]=S);return y}function m(A){var y,C=0,E=0,x="";for(y in A)C++;for(y in A)x+=y+": "+A[y],E<C-1&&(x+="; "),E++;return x}function v(A){return A[1].toUpperCase()}},"./src/utils/tracked-controls.js":(u,p,c)=>{var f=c("./src/constants/index.js").DEFAULT_HANDEDNESS,g=["x","y","z","w"],m=2;u.exports.checkControllerPresentAndSetup=function(E,x,M){var w=E.el,S,I=w.sceneEl.hasWebXR,L=I?A:v,R;if(S=L(E,x,M),R=!!S,E.controllerPresent&&!E.controllerEventsActive&&!I&&E.addEventListeners(),R===E.controllerPresent)return R;E.controllerPresent=R,R?(E.addEventListeners(),E.injectTrackedControls(S),w.emit("controllerconnected",{name:E.name,component:E})):(E.removeEventListeners(),w.emit("controllerdisconnected",{name:E.name,component:E}))};function v(E,x,M){var w,S=E.el.sceneEl,I,L=M.index||0;return!x||(I=S&&S.systems["tracked-controls-webvr"],!I)||(w=I.controllers,!w.length)?!1:!!y(w,null,x,M.hand,L)}function A(E,x,M){var w,S=E.el.sceneEl,I=S&&S.systems["tracked-controls-webxr"];return!I||(w=I.controllers,!w||!w.length)?!1:C(w,x,M.hand,M.index,M.iterateControllerProfiles,M.handTracking)}u.exports.isControllerPresentWebVR=v,u.exports.isControllerPresentWebXR=A;function y(E,x,M,w,S){var I,L,R=0,k=S>=0?S:0;for(L=0;L<E.length;L++)if(I=E[L],!(M&&!I.id.startsWith(M))&&!(!M&&I.id!==x)&&!(w&&I.hand&&w!==I.hand)){if(w&&!I.hand)k=m*S+(w===f?0:1);else return I;if(R===k)return I;++R}}function C(E,x,M,w,S,I){var L,R,k,P=!1,F,O;for(L=0;L<E.length;L++){if(k=E[L],O=k.profiles,I)P=k.hand;else if(S)for(R=0;R<O.length&&(P=O[R].startsWith(x),!P);R++);else P=O.length>0&&O[0].startsWith(x);if(P){if(F=k.handedness==="right"||k.handedness==="left",F){if(k.handedness===M)return E[L]}else if(L===w)return E[L]}}}u.exports.findMatchingControllerWebVR=y,u.exports.findMatchingControllerWebXR=C,u.exports.emitIfAxesChanged=function(E,x,M){var w,S,I,L,R;for(S in x){for(w=x[S],I=!1,R=0;R<w.length;R++)M.detail.changed[w[R]]&&(I=!0);if(I){for(L={},R=0;R<w.length;R++)L[g[R]]=M.detail.axis[w[R]];E.el.emit(S+"moved",L)}}},u.exports.onButtonEvent=function(E,x,M,w){var S=w?M.mapping[w]:M.mapping,I=S.buttons[E];M.el.emit(I+x),M.updateModel&&M.updateModel(I,x)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(u){var p=this;this.object=u,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var c=function(m){p.deviceOrientation=m},f=function(){p.screenOrientation=window.orientation||0},g=function(){var m=new THREE.Vector3(0,0,1),v=new THREE.Euler,A=new THREE.Quaternion,y=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(C,E,x,M,w){v.set(x,E,-M,"YXZ"),C.setFromEuler(v),C.multiply(y),C.multiply(A.setFromAxisAngle(m,-w))}}();this.connect=function(){f(),window.addEventListener("orientationchange",f,!1),window.addEventListener("deviceorientation",c,!1),p.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",f,!1),window.removeEventListener("deviceorientation",c,!1),p.enabled=!1},this.update=function(){if(p.enabled!==!1){var m=p.deviceOrientation;if(m){var v=m.alpha?THREE.MathUtils.degToRad(m.alpha)+p.alphaOffset:0,A=m.beta?THREE.MathUtils.degToRad(m.beta):0,y=m.gamma?THREE.MathUtils.degToRad(m.gamma):0,C=p.screenOrientation?THREE.MathUtils.degToRad(p.screenOrientation):0;g(p.object.quaternion,v,A,y,C)}}},this.dispose=function(){p.disconnect()},this.connect()}},"./vendor/rStats.extras.js":u=>{window.glStats=function(){var p=null,c=0,f=0,g=0,m=0,v=0,A=0,y=0;function C(R,k){return function(){k.apply(this,arguments),R.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=C(WebGLRenderingContext.prototype.drawArrays,function(){c++,arguments[0]==this.POINTS?A+=arguments[2]:v+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=C(WebGLRenderingContext.prototype.drawElements,function(){f++,m+=arguments[1]/3,v+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=C(WebGLRenderingContext.prototype.useProgram,function(){g++}),WebGLRenderingContext.prototype.bindTexture=C(WebGLRenderingContext.prototype.bindTexture,function(){y++});var E={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},x=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],M=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function w(){p("allcalls").set(c+f),p("drawElements").set(f),p("drawArrays").set(c),p("bindTexture").set(y),p("useProgram").set(g),p("glfaces").set(m),p("glvertices").set(v),p("glpoints").set(A)}function S(){c=0,f=0,g=0,m=0,v=0,A=0,y=0}function I(){}function L(R){p=R}return{update:w,start:S,end:I,attach:L,values:E,groups:x,fractions:M}},window.threeStats=function(p){var c=null,f={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},g=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],m=[];function v(){c("renderer.info.memory.geometries").set(p.info.memory.geometries),c("renderer.info.programs").set(p.info.programs.length),c("renderer.info.memory.textures").set(p.info.memory.textures),c("renderer.info.render.calls").set(p.info.render.calls),c("renderer.info.render.triangles").set(p.info.render.triangles),c("renderer.info.render.points").set(p.info.render.points)}function A(){}function y(){}function C(E){c=E}return{update:v,start:A,end:y,attach:C,values:f,groups:g,fractions:m}},window.BrowserStats=function(){var p=null,c=0,f=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var g={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},m=[{caption:"Browser",values:["memory","total"]}],v=[{base:"total",steps:["memory"]}],A=Math.log(1024);function y(w){var S=100,I=Math.floor(Math.log(w)/A);return Math.round(w*S/Math.pow(1024,I))/S}function C(){c=y(performance.memory.usedJSHeapSize),f=y(performance.memory.totalJSHeapSize),p("memory").set(c),p("total").set(f)}function E(){c=0}function x(){}function M(w){p=w}return{update:C,start:E,end:x,attach:M,values:g,groups:m,fractions:v}},u.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":u=>{(function(){"performance"in window||(window.performance={});var p=window.performance;if(!("now"in p)){var c=Date.now();p.timing&&p.timing.navigationStart&&(c=p.timing.navigationStart),p.now=function(){return Date.now()-c}}p.mark||(p.mark=function(){}),p.measure||(p.measure=function(){})})(),window.rStats=function(c){function f(O,W){for(var V=Object.keys(O),$=0,H=V.length;$<H;$++)W(V[$])}function g(O){var W=document.createElement("link");W.href=O,W.rel="stylesheet",W.type="text/css",document.getElementsByTagName("head")[0].appendChild(W)}var m=c||{},v=m.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],A="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",y=(m.CSSPath?m.CSSPath:"")+"rStats.css",C=m.css||[A,y];C.forEach(function(O){g(O)}),m.values||(m.values={});var E,x,M=10,w=200,S={};function I(O,W,V){var $=V||{},H=document.createElement("canvas"),Y=H.getContext("2d"),Q=0,G=0,J=$.color?$.color:"#666666",K=document.createElement("canvas"),se=K.getContext("2d");K.width=1,K.height=2*M,se.fillStyle="#444444",se.fillRect(0,0,1,2*M),se.fillStyle=J,se.fillRect(0,M,1,M),se.fillStyle="#ffffff",se.globalAlpha=.5,se.fillRect(0,M,1,1),se.globalAlpha=1;var ue=document.createElement("canvas"),he=ue.getContext("2d");ue.width=1,ue.height=2*M,he.fillStyle="#444444",he.fillRect(0,0,1,2*M),he.fillStyle="#b70000",he.fillRect(0,M,1,M),he.globalAlpha=.5,he.fillStyle="#ffffff",he.fillRect(0,M,1,1),he.globalAlpha=1;function Me(){H.width=w,H.height=M,H.style.width=H.width+"px",H.style.height=H.height+"px",H.className="rs-canvas",O.appendChild(H),Y.fillStyle="#444444",Y.fillRect(0,0,H.width,H.height)}function de(Pe,Se){G+=(Pe-G)*.1,Q*=.99,G>Q&&(Q=G),Y.drawImage(H,1,0,H.width-1,H.height,0,0,H.width-1,H.height),Se?Y.drawImage(ue,H.width-1,H.height-G*H.height/Q-M):Y.drawImage(K,H.width-1,H.height-G*H.height/Q-M)}return Me(),{draw:de}}function L(O,W){var V=document.createElement("canvas"),$=V.getContext("2d");function H(){V.width=w,V.height=M*W,V.style.width=V.width+"px",V.style.height=V.height+"px",V.className="rs-canvas",O.appendChild(V),$.fillStyle="#444444",$.fillRect(0,0,V.width,V.height)}function Y(Q){$.drawImage(V,1,0,V.width-1,V.height,0,0,V.width-1,V.height);var G=0;f(Q,function(J){var K=Q[J]*V.height;$.fillStyle=v[J],$.fillRect(V.width-1,G,1,K),G+=K})}return H(),{draw:Y}}function R(O,W){var V=O,$,H=0,Y=0,Q=0,G=0,J=performance.now(),K=0,se=document.createElement("div"),ue=document.createElement("span"),he=document.createElement("div"),Me=document.createTextNode(""),de=m?m.values[V.toLowerCase()]:null,Pe=new I(se,V,de),Se=!1;ue.className="rs-counter-id",ue.textContent=de&&de.caption?de.caption:V,he.className="rs-counter-value",he.appendChild(Me),se.appendChild(ue),se.appendChild(he),W?W.div.appendChild(se):x.appendChild(se),$=performance.now();function Le(ft){if(de&&de.average){G+=ft,K++;var Ze=performance.now();Ze-J>=(de.avgMs||1e3)&&(Q=G/K,G=0,J=Ze,K=0)}}function be(){$=performance.now(),m.userTimingAPI&&performance.mark(V+"-start"),Se=!0}function je(){H=performance.now()-$,m.userTimingAPI&&(performance.mark(V+"-end"),Se&&performance.measure(V,V+"-start",V+"-end")),Le(H)}function Te(){je(),be()}function rt(){var ft=de&&de.average?Q:H;Me.nodeValue=Math.round(ft*100)/100;var Ze=de&&(de.below&&H<de.below||de.over&&H>de.over);Pe.draw(H,Ze),se.className=Ze?"rs-counter-base alarm":"rs-counter-base"}function mt(){var ft=performance.now(),Ze=ft-$;Y++,Ze>1e3&&(de&&de.interpolate===!1?H=Y:H=Y*1e3/Ze,Y=0,$=ft,Le(H))}function vt(ft){H=ft,Le(H)}return{set:vt,start:be,tick:Te,end:je,frame:mt,value:function(){return H},draw:rt}}function k(O){var W=O.toLowerCase();if(W===void 0&&(W="default"),S[W])return S[W];var V=null;m&&m.groups&&f(m.groups,function(H){var Y=m.groups[parseInt(H,10)];!V&&Y.values.indexOf(W.toLowerCase())!==-1&&(V=Y)});var $=new R(W,V);return S[W]=$,$}function P(){if(m.plugins){m.values||(m.values={}),m.groups||(m.groups=[]),m.fractions||(m.fractions=[]);for(var O=0;O<m.plugins.length;O++)m.plugins[O].attach(k),f(m.plugins[O].values,function(W){m.values[W]=m.plugins[O].values[W]}),m.groups=m.groups.concat(m.plugins[O].groups),m.fractions=m.fractions.concat(m.plugins[O].fractions)}else m.plugins={};E=document.createElement("div"),E.className="rs-base",x=document.createElement("div"),x.className="rs-container",x.style.height="auto",E.appendChild(x),document.body.appendChild(E),m&&(m.groups&&f(m.groups,function(W){var V=m.groups[parseInt(W,10)],$=document.createElement("div");$.className="rs-group",V.div=$;var H=document.createElement("h1");H.textContent=V.caption,H.addEventListener("click",(function(Y){this.classList.toggle("hidden"),Y.preventDefault()}).bind($)),x.appendChild(H),x.appendChild($)}),m.fractions&&f(m.fractions,function(W){var V=m.fractions[parseInt(W,10)],$=document.createElement("div");$.className="rs-fraction";var H=document.createElement("div");H.className="rs-legend";var Y=0;f(m.fractions[W].steps,function(G){var J=document.createElement("p");J.textContent=m.fractions[W].steps[G],J.style.color=v[Y],H.appendChild(J),Y++}),$.appendChild(H),$.style.height=Y*M+"px",V.div=$;var Q=new L($,Y);V.graph=Q,x.appendChild($)}))}function F(){f(m.plugins,function(O){m.plugins[O].update()}),f(S,function(O){S[O].draw()}),m&&m.fractions&&f(m.fractions,function(O){var W=m.fractions[parseInt(O,10)],V=[],$=S[W.base.toLowerCase()];$&&($=$.value(),f(m.fractions[O].steps,function(H){var Y=m.fractions[O].steps[parseInt(H,10)].toLowerCase(),Q=S[Y];Q&&V.push(Q.value()/$)})),W.graph.draw(V)})}return P(),function(O){return O?k(O):{element:E,update:F}}},u.exports=window.rStats},"./vendor/wakelock/util.js":u=>{var p={};p.base64=function(c,f){return"data:"+c+";base64,"+f},p.isMobile=function(){var c=!1;return function(f){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(f)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(f.substr(0,4)))&&(c=!0)}(navigator.userAgent||navigator.vendor||window.opera),c},p.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},p.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},p.appendQueryParameter=function(c,f,g){var m=c.indexOf("?")<0?"?":"&";return c+=m+f+"="+g,c},p.getQueryParameter=function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var f=new RegExp("[\\?&]"+c+"=([^&#]*)"),g=f.exec(location.search);return g===null?"":decodeURIComponent(g[1].replace(/\+/g," "))},p.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},u.exports=p},"./vendor/wakelock/wakelock.js":(u,p,c)=>{var f=c("./vendor/wakelock/util.js");function g(){var A=document.createElement("video");A.addEventListener("ended",function(){A.play()}),this.request=function(){A.paused&&(A.src=f.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),A.play())},this.release=function(){A.pause(),A.src=""}}function m(){var A=null;this.request=function(){A||(A=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){A&&(clearInterval(A),A=null)}}function v(){var A=navigator.userAgent||navigator.vendor||window.opera;return A.match(/iPhone/i)||A.match(/iPod/i)?m:g}u.exports=v()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(u,p,c)=>{c.r(p),c.d(p,{default:()=>F});var f=c("./node_modules/css-loader/dist/runtime/sourceMaps.js"),g=c.n(f),m=c("./node_modules/css-loader/dist/runtime/api.js"),v=c.n(m),A=c("./node_modules/css-loader/dist/runtime/getUrl.js"),y=c.n(A),C=new URL(c("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),c.b),E=new URL(c("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),c.b),x=new URL(c("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),c.b),M=new URL(c("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),c.b),w=new URL(c("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),c.b),S=v()(g()),I=y()(C),L=y()(E),R=y()(x),k=y()(M),P=y()(w);S.push([u.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+I+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+L+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+R+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+k+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+P+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);const F=S},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(u,p,c)=>{c.r(p),c.d(p,{default:()=>y});var f=c("./node_modules/css-loader/dist/runtime/sourceMaps.js"),g=c.n(f),m=c("./node_modules/css-loader/dist/runtime/api.js"),v=c.n(m),A=v()(g());A.push([u.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);const y=A},"./src/style/aframe.css":(u,p,c)=>{c.r(p),c.d(p,{default:()=>R});var f=c("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),g=c.n(f),m=c("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),v=c.n(m),A=c("./node_modules/style-loader/dist/runtime/insertBySelector.js"),y=c.n(A),C=c("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),E=c.n(C),x=c("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),M=c.n(x),w=c("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),S=c.n(w),I=c("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),L={};L.styleTagTransform=S(),L.setAttributes=E(),L.insert=y().bind(null,"head"),L.domAPI=v(),L.insertStyleElement=M(),g()(I.default,L);const R=I.default&&I.default.locals?I.default.locals:void 0},"./src/style/rStats.css":(u,p,c)=>{c.r(p),c.d(p,{default:()=>R});var f=c("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),g=c.n(f),m=c("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),v=c.n(m),A=c("./node_modules/style-loader/dist/runtime/insertBySelector.js"),y=c.n(A),C=c("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),E=c.n(C),x=c("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),M=c.n(x),w=c("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),S=c.n(w),I=c("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),L={};L.styleTagTransform=S(),L.setAttributes=E(),L.insert=y().bind(null,"head"),L.domAPI=v(),L.insertStyleElement=M(),g()(I.default,L);const R=I.default&&I.default.locals?I.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":u=>{var p=[];function c(m){for(var v=-1,A=0;A<p.length;A++)if(p[A].identifier===m){v=A;break}return v}function f(m,v){for(var A={},y=[],C=0;C<m.length;C++){var E=m[C],x=v.base?E[0]+v.base:E[0],M=A[x]||0,w="".concat(x," ").concat(M);A[x]=M+1;var S=c(w),I={css:E[1],media:E[2],sourceMap:E[3],supports:E[4],layer:E[5]};if(S!==-1)p[S].references++,p[S].updater(I);else{var L=g(I,v);v.byIndex=C,p.splice(C,0,{identifier:w,updater:L,references:1})}y.push(w)}return y}function g(m,v){var A=v.domAPI(v);A.update(m);var y=function(E){if(E){if(E.css===m.css&&E.media===m.media&&E.sourceMap===m.sourceMap&&E.supports===m.supports&&E.layer===m.layer)return;A.update(m=E)}else A.remove()};return y}u.exports=function(m,v){v=v||{},m=m||[];var A=f(m,v);return function(C){C=C||[];for(var E=0;E<A.length;E++){var x=A[E],M=c(x);p[M].references--}for(var w=f(C,v),S=0;S<A.length;S++){var I=A[S],L=c(I);p[L].references===0&&(p[L].updater(),p.splice(L,1))}A=w}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":u=>{var p={};function c(g){if(typeof p[g]>"u"){var m=document.querySelector(g);if(window.HTMLIFrameElement&&m instanceof window.HTMLIFrameElement)try{m=m.contentDocument.head}catch{m=null}p[g]=m}return p[g]}function f(g,m){var v=c(g);if(!v)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");v.appendChild(m)}u.exports=f},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":u=>{function p(c){var f=document.createElement("style");return c.setAttributes(f,c.attributes),c.insert(f,c.options),f}u.exports=p},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(u,p,c)=>{function f(g){var m=c.nc;m&&g.setAttribute("nonce",m)}u.exports=f},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":u=>{function p(g,m,v){var A="";v.supports&&(A+="@supports (".concat(v.supports,") {")),v.media&&(A+="@media ".concat(v.media," {"));var y=typeof v.layer<"u";y&&(A+="@layer".concat(v.layer.length>0?" ".concat(v.layer):""," {")),A+=v.css,y&&(A+="}"),v.media&&(A+="}"),v.supports&&(A+="}");var C=v.sourceMap;C&&typeof btoa<"u"&&(A+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(C))))," */")),m.styleTagTransform(A,g,m.options)}function c(g){if(g.parentNode===null)return!1;g.parentNode.removeChild(g)}function f(g){if(typeof document>"u")return{update:function(){},remove:function(){}};var m=g.insertStyleElement(g);return{update:function(A){p(m,g,A)},remove:function(){c(m)}}}u.exports=f},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":u=>{function p(c,f){if(f.styleSheet)f.styleSheet.cssText=c;else{for(;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(document.createTextNode(c))}}u.exports=p},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":u=>{u.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":u=>{u.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":u=>{u.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":u=>{u.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":u=>{u.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.module.js":(u,p,c)=>{c.r(p),c.d(p,{ACESFilmicToneMapping:()=>bt,AddEquation:()=>V,AddOperation:()=>pn,AdditiveAnimationBlendMode:()=>Da,AdditiveBlending:()=>P,AgXToneMapping:()=>_e,AlphaFormat:()=>nl,AlwaysCompare:()=>Zm,AlwaysDepth:()=>vt,AlwaysStencilFunc:()=>ud,AmbientLight:()=>nx,AnimationAction:()=>vx,AnimationClip:()=>Hd,AnimationLoader:()=>xk,AnimationMixer:()=>eU,AnimationObjectGroup:()=>Jk,AnimationUtils:()=>_k,ArcCurve:()=>v3,ArrayCamera:()=>yb,ArrowHelper:()=>EU,AttachedBindMode:()=>Re,Audio:()=>mx,AudioAnalyser:()=>Qk,AudioContext:()=>ey,AudioListener:()=>Uk,AudioLoader:()=>Ok,AxesHelper:()=>wU,BackSide:()=>I,BasicDepthPacking:()=>il,BasicShadowMap:()=>E,BatchedMesh:()=>c3,Bone:()=>Mb,BooleanKeyframeTrack:()=>Bu,Box2:()=>lU,Box3:()=>ns,Box3Helper:()=>yU,BoxGeometry:()=>vu,BoxHelper:()=>bU,BufferAttribute:()=>Tr,BufferGeometry:()=>Ui,BufferGeometryLoader:()=>ax,ByteType:()=>fa,Cache:()=>zl,Camera:()=>E0,CameraHelper:()=>vU,CanvasTexture:()=>jF,CapsuleGeometry:()=>q0,CatmullRomCurve3:()=>b3,CineonToneMapping:()=>Gt,CircleGeometry:()=>J0,ClampToEdgeWrapping:()=>He,Clock:()=>fx,Color:()=>Qn,ColorKeyframeTrack:()=>Xb,ColorManagement:()=>gr,CompressedArrayTexture:()=>HF,CompressedCubeTexture:()=>zF,CompressedTexture:()=>$0,CompressedTextureLoader:()=>Mk,ConeGeometry:()=>Z0,ConstantAlphaFactor:()=>Te,ConstantColorFactor:()=>be,CubeCamera:()=>hC,CubeReflectionMapping:()=>le,CubeRefractionMapping:()=>j,CubeTexture:()=>_d,CubeTextureLoader:()=>Sk,CubeUVReflectionMapping:()=>Ee,CubicBezierCurve:()=>Ob,CubicBezierCurve3:()=>_3,CubicInterpolant:()=>j3,CullFaceBack:()=>A,CullFaceFront:()=>y,CullFaceFrontBack:()=>C,CullFaceNone:()=>v,Curve:()=>Ua,CurvePath:()=>w3,CustomBlending:()=>W,CustomToneMapping:()=>ye,CylinderGeometry:()=>qh,Cylindrical:()=>aU,Data3DTexture:()=>Ei,DataArrayTexture:()=>Ch,DataTexture:()=>Rc,DataTextureLoader:()=>Tk,DataUtils:()=>vD,DecrementStencilOp:()=>hv,DecrementWrapStencilOp:()=>dv,DefaultLoadingManager:()=>X3,DepthFormat:()=>gt,DepthStencilFormat:()=>Ht,DepthTexture:()=>mb,DetachedBindMode:()=>Ce,DirectionalLight:()=>tx,DirectionalLightHelper:()=>gU,DiscreteInterpolant:()=>W3,DisplayP3ColorSpace:()=>yh,DodecahedronGeometry:()=>eA,DoubleSide:()=>L,DstAlphaFactor:()=>Me,DstColorFactor:()=>Pe,DynamicCopyUsage:()=>Tv,DynamicDrawUsage:()=>Ev,DynamicReadUsage:()=>xv,EdgesGeometry:()=>C3,EllipseCurve:()=>X0,EqualCompare:()=>Km,EqualDepth:()=>St,EqualStencilFunc:()=>gv,EquirectangularReflectionMapping:()=>Z,EquirectangularRefractionMapping:()=>pe,Euler:()=>ta,EventDispatcher:()=>vo,ExtrudeGeometry:()=>aA,FileLoader:()=>Wl,Float16BufferAttribute:()=>CD,Float32BufferAttribute:()=>ei,FloatType:()=>zr,Fog:()=>B0,FogExp2:()=>I0,FramebufferTexture:()=>QF,FrontSide:()=>S,Frustum:()=>Ed,GLBufferAttribute:()=>rU,GLSL1:()=>Bv,GLSL3:()=>fd,GreaterCompare:()=>Ym,GreaterDepth:()=>ct,GreaterEqualCompare:()=>Jm,GreaterEqualDepth:()=>$t,GreaterEqualStencilFunc:()=>_v,GreaterStencilFunc:()=>bv,GridHelper:()=>mU,Group:()=>wu,HalfFloatType:()=>Er,HemisphereLight:()=>K3,HemisphereLightHelper:()=>pU,IcosahedronGeometry:()=>lA,ImageBitmapLoader:()=>Nk,ImageLoader:()=>zd,ImageUtils:()=>Cc,IncrementStencilOp:()=>uv,IncrementWrapStencilOp:()=>fv,InstancedBufferAttribute:()=>Xh,InstancedBufferGeometry:()=>ox,InstancedInterleavedBuffer:()=>iU,InstancedMesh:()=>o3,Int16BufferAttribute:()=>ED,Int32BufferAttribute:()=>wD,Int8BufferAttribute:()=>bD,IntType:()=>da,InterleavedBuffer:()=>R0,InterleavedBufferAttribute:()=>xu,Interpolant:()=>Gd,InterpolateDiscrete:()=>gs,InterpolateLinear:()=>vs,InterpolateSmooth:()=>_s,InvertStencilOp:()=>pv,KeepStencilOp:()=>Nl,KeyframeTrack:()=>Ga,LOD:()=>YC,LatheGeometry:()=>Dd,Layers:()=>u0,LessCompare:()=>Xm,LessDepth:()=>ft,LessEqualCompare:()=>hd,LessEqualDepth:()=>Ze,LessEqualStencilFunc:()=>vv,LessStencilFunc:()=>Av,Light:()=>Nc,LightProbe:()=>sx,Line:()=>Pc,Line3:()=>cU,LineBasicMaterial:()=>wo,LineCurve:()=>Fb,LineCurve3:()=>E3,LineDashedMaterial:()=>Q3,LineLoop:()=>p3,LineSegments:()=>ll,LinearDisplayP3ColorSpace:()=>cu,LinearFilter:()=>Dn,LinearInterpolant:()=>$b,LinearMipMapLinearFilter:()=>Po,LinearMipMapNearestFilter:()=>nr,LinearMipmapLinearFilter:()=>_r,LinearMipmapNearestFilter:()=>Qr,LinearSRGBColorSpace:()=>Na,LinearToneMapping:()=>kn,LinearTransfer:()=>uu,Loader:()=>ko,LoaderUtils:()=>Zb,LoadingManager:()=>Kb,LoopOnce:()=>jr,LoopPingPong:()=>As,LoopRepeat:()=>Fr,LuminanceAlphaFormat:()=>Rt,LuminanceFormat:()=>ot,MOUSE:()=>g,Material:()=>ao,MaterialLoader:()=>mA,MathUtils:()=>$v,Matrix3:()=>_i,Matrix4:()=>Kn,MaxEquation:()=>Q,Mesh:()=>ws,MeshBasicMaterial:()=>Tc,MeshDepthMaterial:()=>vb,MeshDistanceMaterial:()=>bb,MeshLambertMaterial:()=>G3,MeshMatcapMaterial:()=>V3,MeshNormalMaterial:()=>U3,MeshPhongMaterial:()=>F3,MeshPhysicalMaterial:()=>O3,MeshStandardMaterial:()=>zb,MeshToonMaterial:()=>k3,MinEquation:()=>Y,MirroredRepeatWrapping:()=>Pt,MixOperation:()=>At,MultiplyBlending:()=>O,MultiplyOperation:()=>Tt,NearestFilter:()=>rn,NearestMipMapLinearFilter:()=>Vt,NearestMipMapNearestFilter:()=>st,NearestMipmapLinearFilter:()=>An,NearestMipmapNearestFilter:()=>Xt,NeutralToneMapping:()=>Ue,NeverCompare:()=>$m,NeverDepth:()=>mt,NeverStencilFunc:()=>mv,NoBlending:()=>R,NoColorSpace:()=>Zs,NoToneMapping:()=>yt,NormalAnimationBlendMode:()=>pa,NormalBlending:()=>k,NotEqualCompare:()=>qm,NotEqualDepth:()=>Ct,NotEqualStencilFunc:()=>yv,NumberKeyframeTrack:()=>Vd,Object3D:()=>hr,ObjectLoader:()=>Pk,ObjectSpaceNormalMap:()=>sl,OctahedronGeometry:()=>kd,OneFactor:()=>J,OneMinusConstantAlphaFactor:()=>rt,OneMinusConstantColorFactor:()=>je,OneMinusDstAlphaFactor:()=>de,OneMinusDstColorFactor:()=>Se,OneMinusSrcAlphaFactor:()=>he,OneMinusSrcColorFactor:()=>se,OrthographicCamera:()=>x0,P3Primaries:()=>fu,PCFShadowMap:()=>x,PCFSoftShadowMap:()=>M,PMREMGenerator:()=>db,Path:()=>Pd,PerspectiveCamera:()=>Bs,Plane:()=>Bc,PlaneGeometry:()=>Gh,PlaneHelper:()=>_U,PointLight:()=>ex,PointLightHelper:()=>fU,Points:()=>A3,PointsMaterial:()=>Bb,PolarGridHelper:()=>AU,PolyhedronGeometry:()=>Dc,PositionalAudio:()=>Vk,PropertyBinding:()=>lr,PropertyMixer:()=>gx,QuadraticBezierCurve:()=>kb,QuadraticBezierCurve3:()=>Ub,Quaternion:()=>ur,QuaternionKeyframeTrack:()=>Zh,QuaternionLinearInterpolant:()=>$3,RED_GREEN_RGTC2_Format:()=>ir,RED_RGTC1_Format:()=>Ai,REVISION:()=>f,RGBADepthPacking:()=>rl,RGBAFormat:()=>We,RGBAIntegerFormat:()=>Zn,RGBA_ASTC_10x10_Format:()=>Lt,RGBA_ASTC_10x5_Format:()=>qt,RGBA_ASTC_10x6_Format:()=>Kt,RGBA_ASTC_10x8_Format:()=>dt,RGBA_ASTC_12x10_Format:()=>on,RGBA_ASTC_12x12_Format:()=>Nn,RGBA_ASTC_4x4_Format:()=>Zi,RGBA_ASTC_5x4_Format:()=>ne,RGBA_ASTC_5x5_Format:()=>ae,RGBA_ASTC_6x5_Format:()=>me,RGBA_ASTC_6x6_Format:()=>xe,RGBA_ASTC_8x5_Format:()=>Fe,RGBA_ASTC_8x6_Format:()=>Je,RGBA_ASTC_8x8_Format:()=>nt,RGBA_BPTC_Format:()=>$n,RGBA_ETC2_EAC_Format:()=>es,RGBA_PVRTC_2BPPV1_Format:()=>ms,RGBA_PVRTC_4BPPV1_Format:()=>Or,RGBA_S3TC_DXT1_Format:()=>hi,RGBA_S3TC_DXT3_Format:()=>wr,RGBA_S3TC_DXT5_Format:()=>Ti,RGBFormat:()=>Oe,RGB_BPTC_SIGNED_Format:()=>ai,RGB_BPTC_UNSIGNED_Format:()=>wi,RGB_ETC1_Format:()=>Rn,RGB_ETC2_Format:()=>Ii,RGB_PVRTC_2BPPV1_Format:()=>Wi,RGB_PVRTC_4BPPV1_Format:()=>bi,RGB_S3TC_DXT1_Format:()=>oi,RGFormat:()=>Bn,RGIntegerFormat:()=>zt,RawShaderMaterial:()=>N3,Ray:()=>Is,Raycaster:()=>sU,Rec709Primaries:()=>hu,RectAreaLight:()=>ix,RedFormat:()=>an,RedIntegerFormat:()=>jn,ReinhardToneMapping:()=>qn,RenderTarget:()=>wh,RepeatWrapping:()=>Qe,ReplaceStencilOp:()=>cv,ReverseSubtractEquation:()=>H,RingGeometry:()=>cA,SIGNED_RED_GREEN_RGTC2_Format:()=>Cr,SIGNED_RED_RGTC1_Format:()=>ui,SRGBColorSpace:()=>rr,SRGBTransfer:()=>Rr,Scene:()=>zC,ShaderChunk:()=>Ni,ShaderLib:()=>ka,ShaderMaterial:()=>Fa,ShadowMaterial:()=>D3,Shape:()=>Su,ShapeGeometry:()=>uA,ShapePath:()=>CU,ShapeUtils:()=>cl,ShortType:()=>ds,Skeleton:()=>F0,SkeletonHelper:()=>hU,SkinnedMesh:()=>n3,Source:()=>Wr,Sphere:()=>Ts,SphereGeometry:()=>Ud,Spherical:()=>oU,SphericalHarmonics3:()=>rx,SplineCurve:()=>Gb,SpotLight:()=>J3,SpotLightHelper:()=>uU,Sprite:()=>XC,SpriteMaterial:()=>Eb,SrcAlphaFactor:()=>ue,SrcAlphaSaturateFactor:()=>Le,SrcColorFactor:()=>K,StaticCopyUsage:()=>Sv,StaticDrawUsage:()=>du,StaticReadUsage:()=>Cv,StereoCamera:()=>Fk,StreamCopyUsage:()=>Iv,StreamDrawUsage:()=>wv,StreamReadUsage:()=>Mv,StringKeyframeTrack:()=>Ru,SubtractEquation:()=>$,SubtractiveBlending:()=>F,TOUCH:()=>m,TangentSpaceNormalMap:()=>ro,TetrahedronGeometry:()=>hA,Texture:()=>kr,TextureLoader:()=>Ik,TorusGeometry:()=>fA,TorusKnotGeometry:()=>dA,Triangle:()=>na,TriangleFanDrawMode:()=>Dl,TriangleStripDrawMode:()=>Pl,TrianglesDrawMode:()=>Ll,TubeGeometry:()=>pA,UVMapping:()=>Ne,Uint16BufferAttribute:()=>nb,Uint32BufferAttribute:()=>ib,Uint8BufferAttribute:()=>yD,Uint8ClampedBufferAttribute:()=>_D,Uniform:()=>iy,UniformsGroup:()=>nU,UniformsLib:()=>Sn,UniformsUtils:()=>lC,UnsignedByteType:()=>Hr,UnsignedInt248Type:()=>Yo,UnsignedInt5999Type:()=>yc,UnsignedIntType:()=>Js,UnsignedShort4444Type:()=>ps,UnsignedShort5551Type:()=>Rl,UnsignedShortType:()=>go,VSMShadowMap:()=>w,Vector2:()=>Jt,Vector3:()=>Ge,Vector4:()=>ar,VectorKeyframeTrack:()=>Qd,VideoTexture:()=>VF,WebGL3DRenderTarget:()=>er,WebGLArrayRenderTarget:()=>Wn,WebGLCoordinateSystem:()=>ma,WebGLCubeRenderTarget:()=>fC,WebGLMultipleRenderTargets:()=>xU,WebGLRenderTarget:()=>Do,WebGLRenderer:()=>LF,WebGLUtils:()=>UC,WebGPUCoordinateSystem:()=>pu,WireframeGeometry:()=>R3,WrapAroundEnding:()=>qo,ZeroCurvatureEnding:()=>ts,ZeroFactor:()=>G,ZeroSlopeEnding:()=>Us,ZeroStencilOp:()=>lv,createCanvasElement:()=>n0});/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const f="164",g={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},m={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},v=0,A=1,y=2,C=3,E=0,x=1,M=2,w=3,S=0,I=1,L=2,R=0,k=1,P=2,F=3,O=4,W=5,V=100,$=101,H=102,Y=103,Q=104,G=200,J=201,K=202,se=203,ue=204,he=205,Me=206,de=207,Pe=208,Se=209,Le=210,be=211,je=212,Te=213,rt=214,mt=0,vt=1,ft=2,Ze=3,St=4,$t=5,ct=6,Ct=7,Tt=0,At=1,pn=2,yt=0,kn=1,qn=2,Gt=3,bt=4,ye=5,_e=6,Ue=7,Re="attached",Ce="detached",Ne=300,le=301,j=302,Z=303,pe=304,Ee=306,Qe=1e3,He=1001,Pt=1002,rn=1003,Xt=1004,st=1004,An=1005,Vt=1005,Dn=1006,Qr=1007,nr=1007,_r=1008,Po=1008,Hr=1009,fa=1010,ds=1011,go=1012,da=1013,Js=1014,zr=1015,Er=1016,ps=1017,Rl=1018,Yo=1020,yc=35902,nl=1021,Oe=1022,We=1023,ot=1024,Rt=1025,gt=1026,Ht=1027,an=1028,jn=1029,Bn=1030,zt=1031,Zn=1033,oi=33776,hi=33777,wr=33778,Ti=33779,bi=35840,Wi=35841,Or=35842,ms=35843,Rn=36196,Ii=37492,es=37496,Zi=37808,ne=37809,ae=37810,me=37811,xe=37812,Fe=37813,Je=37814,nt=37815,qt=37816,Kt=37817,dt=37818,Lt=37819,on=37820,Nn=37821,$n=36492,ai=36494,wi=36495,Ai=36283,ui=36284,ir=36285,Cr=36286,jr=2200,Fr=2201,As=2202,gs=2300,vs=2301,_s=2302,ts=2400,Us=2401,qo=2402,pa=2500,Da=2501,Ll=0,Pl=1,Dl=2,il=3200,rl=3201,ro=0,sl=1,Zs="",rr="srgb",Na="srgb-linear",yh="display-p3",cu="display-p3-linear",uu="linear",Rr="srgb",hu="rec709",fu="p3",lv=0,Nl=7680,cv=7681,uv=7682,hv=7683,fv=34055,dv=34056,pv=5386,mv=512,Av=513,gv=514,vv=515,bv=516,yv=517,_v=518,ud=519,$m=512,Xm=513,Km=514,hd=515,Ym=516,qm=517,Jm=518,Zm=519,du=35044,Ev=35048,wv=35040,Cv=35045,xv=35049,Mv=35041,Sv=35046,Tv=35050,Iv=35042,Bv="100",fd="300 es",ma=2e3,pu=2001;class vo{addEventListener(n,s){this._listeners===void 0&&(this._listeners={});const l=this._listeners;l[n]===void 0&&(l[n]=[]),l[n].indexOf(s)===-1&&l[n].push(s)}hasEventListener(n,s){if(this._listeners===void 0)return!1;const l=this._listeners;return l[n]!==void 0&&l[n].indexOf(s)!==-1}removeEventListener(n,s){if(this._listeners===void 0)return;const d=this._listeners[n];if(d!==void 0){const b=d.indexOf(s);b!==-1&&d.splice(b,1)}}dispatchEvent(n){if(this._listeners===void 0)return;const l=this._listeners[n.type];if(l!==void 0){n.target=this;const d=l.slice(0);for(let b=0,T=d.length;b<T;b++)d[b].call(this,n);n.target=null}}}const Gs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let e0=1234567;const Ol=Math.PI/180,_c=180/Math.PI;function bo(){const _=Math.random()*4294967295|0,n=Math.random()*4294967295|0,s=Math.random()*4294967295|0,l=Math.random()*4294967295|0;return(Gs[_&255]+Gs[_>>8&255]+Gs[_>>16&255]+Gs[_>>24&255]+"-"+Gs[n&255]+Gs[n>>8&255]+"-"+Gs[n>>16&15|64]+Gs[n>>24&255]+"-"+Gs[s&63|128]+Gs[s>>8&255]+"-"+Gs[s>>16&255]+Gs[s>>24&255]+Gs[l&255]+Gs[l>>8&255]+Gs[l>>16&255]+Gs[l>>24&255]).toLowerCase()}function Kr(_,n,s){return Math.max(n,Math.min(s,_))}function dd(_,n){return(_%n+n)%n}function Rv(_,n,s,l,d){return l+(_-n)*(d-l)/(s-n)}function Lv(_,n,s){return _!==n?(s-_)/(n-_):0}function mu(_,n,s){return(1-s)*_+s*n}function Pv(_,n,s,l){return mu(_,n,1-Math.exp(-s*l))}function Dv(_,n=1){return n-Math.abs(dd(_,n*2)-n)}function Nv(_,n,s){return _<=n?0:_>=s?1:(_=(_-n)/(s-n),_*_*(3-2*_))}function Ov(_,n,s){return _<=n?0:_>=s?1:(_=(_-n)/(s-n),_*_*_*(_*(_*6-15)+10))}function Fv(_,n){return _+Math.floor(Math.random()*(n-_+1))}function kv(_,n){return _+Math.random()*(n-_)}function Uv(_){return _*(.5-Math.random())}function Gv(_){_!==void 0&&(e0=_);let n=e0+=1831565813;return n=Math.imul(n^n>>>15,n|1),n^=n+Math.imul(n^n>>>7,n|61),((n^n>>>14)>>>0)/4294967296}function Vv(_){return _*Ol}function Qv(_){return _*_c}function Hv(_){return(_&_-1)===0&&_!==0}function zv(_){return Math.pow(2,Math.ceil(Math.log(_)/Math.LN2))}function jv(_){return Math.pow(2,Math.floor(Math.log(_)/Math.LN2))}function Wv(_,n,s,l,d){const b=Math.cos,T=Math.sin,B=b(s/2),N=T(s/2),U=b((n+l)/2),z=T((n+l)/2),X=b((n-l)/2),q=T((n-l)/2),ee=b((l-n)/2),ie=T((l-n)/2);switch(d){case"XYX":_.set(B*z,N*X,N*q,B*U);break;case"YZY":_.set(N*q,B*z,N*X,B*U);break;case"ZXZ":_.set(N*X,N*q,B*z,B*U);break;case"XZX":_.set(B*z,N*ie,N*ee,B*U);break;case"YXY":_.set(N*ee,B*z,N*ie,B*U);break;case"ZYZ":_.set(N*ie,N*ee,B*z,B*U);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+d)}}function eo(_,n){switch(n.constructor){case Float32Array:return _;case Uint32Array:return _/4294967295;case Uint16Array:return _/65535;case Uint8Array:return _/255;case Int32Array:return Math.max(_/2147483647,-1);case Int16Array:return Math.max(_/32767,-1);case Int8Array:return Math.max(_/127,-1);default:throw new Error("Invalid component type.")}}function Ci(_,n){switch(n.constructor){case Float32Array:return _;case Uint32Array:return Math.round(_*4294967295);case Uint16Array:return Math.round(_*65535);case Uint8Array:return Math.round(_*255);case Int32Array:return Math.round(_*2147483647);case Int16Array:return Math.round(_*32767);case Int8Array:return Math.round(_*127);default:throw new Error("Invalid component type.")}}const $v={DEG2RAD:Ol,RAD2DEG:_c,generateUUID:bo,clamp:Kr,euclideanModulo:dd,mapLinear:Rv,inverseLerp:Lv,lerp:mu,damp:Pv,pingpong:Dv,smoothstep:Nv,smootherstep:Ov,randInt:Fv,randFloat:kv,randFloatSpread:Uv,seededRandom:Gv,degToRad:Vv,radToDeg:Qv,isPowerOfTwo:Hv,ceilPowerOfTwo:zv,floorPowerOfTwo:jv,setQuaternionFromProperEuler:Wv,normalize:Ci,denormalize:eo};class Jt{constructor(n=0,s=0){Jt.prototype.isVector2=!0,this.x=n,this.y=s}get width(){return this.x}set width(n){this.x=n}get height(){return this.y}set height(n){this.y=n}set(n,s){return this.x=n,this.y=s,this}setScalar(n){return this.x=n,this.y=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setComponent(n,s){switch(n){case 0:this.x=s;break;case 1:this.y=s;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y)}copy(n){return this.x=n.x,this.y=n.y,this}add(n){return this.x+=n.x,this.y+=n.y,this}addScalar(n){return this.x+=n,this.y+=n,this}addVectors(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this}addScaledVector(n,s){return this.x+=n.x*s,this.y+=n.y*s,this}sub(n){return this.x-=n.x,this.y-=n.y,this}subScalar(n){return this.x-=n,this.y-=n,this}subVectors(n,s){return this.x=n.x-s.x,this.y=n.y-s.y,this}multiply(n){return this.x*=n.x,this.y*=n.y,this}multiplyScalar(n){return this.x*=n,this.y*=n,this}divide(n){return this.x/=n.x,this.y/=n.y,this}divideScalar(n){return this.multiplyScalar(1/n)}applyMatrix3(n){const s=this.x,l=this.y,d=n.elements;return this.x=d[0]*s+d[3]*l+d[6],this.y=d[1]*s+d[4]*l+d[7],this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this}clamp(n,s){return this.x=Math.max(n.x,Math.min(s.x,this.x)),this.y=Math.max(n.y,Math.min(s.y,this.y)),this}clampScalar(n,s){return this.x=Math.max(n,Math.min(s,this.x)),this.y=Math.max(n,Math.min(s,this.y)),this}clampLength(n,s){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(n,Math.min(s,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(n){return this.x*n.x+this.y*n.y}cross(n){return this.x*n.y-this.y*n.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(n){const s=Math.sqrt(this.lengthSq()*n.lengthSq());if(s===0)return Math.PI/2;const l=this.dot(n)/s;return Math.acos(Kr(l,-1,1))}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const s=this.x-n.x,l=this.y-n.y;return s*s+l*l}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this}lerpVectors(n,s,l){return this.x=n.x+(s.x-n.x)*l,this.y=n.y+(s.y-n.y)*l,this}equals(n){return n.x===this.x&&n.y===this.y}fromArray(n,s=0){return this.x=n[s],this.y=n[s+1],this}toArray(n=[],s=0){return n[s]=this.x,n[s+1]=this.y,n}fromBufferAttribute(n,s){return this.x=n.getX(s),this.y=n.getY(s),this}rotateAround(n,s){const l=Math.cos(s),d=Math.sin(s),b=this.x-n.x,T=this.y-n.y;return this.x=b*l-T*d+n.x,this.y=b*d+T*l+n.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class _i{constructor(n,s,l,d,b,T,B,N,U){_i.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],n!==void 0&&this.set(n,s,l,d,b,T,B,N,U)}set(n,s,l,d,b,T,B,N,U){const z=this.elements;return z[0]=n,z[1]=d,z[2]=B,z[3]=s,z[4]=b,z[5]=N,z[6]=l,z[7]=T,z[8]=U,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(n){const s=this.elements,l=n.elements;return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],this}extractBasis(n,s,l){return n.setFromMatrix3Column(this,0),s.setFromMatrix3Column(this,1),l.setFromMatrix3Column(this,2),this}setFromMatrix4(n){const s=n.elements;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this}multiply(n){return this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,s){const l=n.elements,d=s.elements,b=this.elements,T=l[0],B=l[3],N=l[6],U=l[1],z=l[4],X=l[7],q=l[2],ee=l[5],ie=l[8],ce=d[0],re=d[3],te=d[6],we=d[1],ve=d[4],Ae=d[7],qe=d[2],Ve=d[5],ze=d[8];return b[0]=T*ce+B*we+N*qe,b[3]=T*re+B*ve+N*Ve,b[6]=T*te+B*Ae+N*ze,b[1]=U*ce+z*we+X*qe,b[4]=U*re+z*ve+X*Ve,b[7]=U*te+z*Ae+X*ze,b[2]=q*ce+ee*we+ie*qe,b[5]=q*re+ee*ve+ie*Ve,b[8]=q*te+ee*Ae+ie*ze,this}multiplyScalar(n){const s=this.elements;return s[0]*=n,s[3]*=n,s[6]*=n,s[1]*=n,s[4]*=n,s[7]*=n,s[2]*=n,s[5]*=n,s[8]*=n,this}determinant(){const n=this.elements,s=n[0],l=n[1],d=n[2],b=n[3],T=n[4],B=n[5],N=n[6],U=n[7],z=n[8];return s*T*z-s*B*U-l*b*z+l*B*N+d*b*U-d*T*N}invert(){const n=this.elements,s=n[0],l=n[1],d=n[2],b=n[3],T=n[4],B=n[5],N=n[6],U=n[7],z=n[8],X=z*T-B*U,q=B*N-z*b,ee=U*b-T*N,ie=s*X+l*q+d*ee;if(ie===0)return this.set(0,0,0,0,0,0,0,0,0);const ce=1/ie;return n[0]=X*ce,n[1]=(d*U-z*l)*ce,n[2]=(B*l-d*T)*ce,n[3]=q*ce,n[4]=(z*s-d*N)*ce,n[5]=(d*b-B*s)*ce,n[6]=ee*ce,n[7]=(l*N-U*s)*ce,n[8]=(T*s-l*b)*ce,this}transpose(){let n;const s=this.elements;return n=s[1],s[1]=s[3],s[3]=n,n=s[2],s[2]=s[6],s[6]=n,n=s[5],s[5]=s[7],s[7]=n,this}getNormalMatrix(n){return this.setFromMatrix4(n).invert().transpose()}transposeIntoArray(n){const s=this.elements;return n[0]=s[0],n[1]=s[3],n[2]=s[6],n[3]=s[1],n[4]=s[4],n[5]=s[7],n[6]=s[2],n[7]=s[5],n[8]=s[8],this}setUvTransform(n,s,l,d,b,T,B){const N=Math.cos(b),U=Math.sin(b);return this.set(l*N,l*U,-l*(N*T+U*B)+T+n,-d*U,d*N,-d*(-U*T+N*B)+B+s,0,0,1),this}scale(n,s){return this.premultiply(pd.makeScale(n,s)),this}rotate(n){return this.premultiply(pd.makeRotation(-n)),this}translate(n,s){return this.premultiply(pd.makeTranslation(n,s)),this}makeTranslation(n,s){return n.isVector2?this.set(1,0,n.x,0,1,n.y,0,0,1):this.set(1,0,n,0,1,s,0,0,1),this}makeRotation(n){const s=Math.cos(n),l=Math.sin(n);return this.set(s,-l,0,l,s,0,0,0,1),this}makeScale(n,s){return this.set(n,0,0,0,s,0,0,0,1),this}equals(n){const s=this.elements,l=n.elements;for(let d=0;d<9;d++)if(s[d]!==l[d])return!1;return!0}fromArray(n,s=0){for(let l=0;l<9;l++)this.elements[l]=n[l+s];return this}toArray(n=[],s=0){const l=this.elements;return n[s]=l[0],n[s+1]=l[1],n[s+2]=l[2],n[s+3]=l[3],n[s+4]=l[4],n[s+5]=l[5],n[s+6]=l[6],n[s+7]=l[7],n[s+8]=l[8],n}clone(){return new this.constructor().fromArray(this.elements)}}const pd=new _i;function t0(_){for(let n=_.length-1;n>=0;--n)if(_[n]>=65535)return!0;return!1}const Xv={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ec(_,n){return new Xv[_](n)}function Au(_){return document.createElementNS("http://www.w3.org/1999/xhtml",_)}function n0(){const _=Au("canvas");return _.style.display="block",_}const i0={};function r0(_){_ in i0||(i0[_]=!0,console.warn(_))}const s0=new _i().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),o0=new _i().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),_h={[Na]:{transfer:uu,primaries:hu,toReference:_=>_,fromReference:_=>_},[rr]:{transfer:Rr,primaries:hu,toReference:_=>_.convertSRGBToLinear(),fromReference:_=>_.convertLinearToSRGB()},[cu]:{transfer:uu,primaries:fu,toReference:_=>_.applyMatrix3(o0),fromReference:_=>_.applyMatrix3(s0)},[yh]:{transfer:Rr,primaries:fu,toReference:_=>_.convertSRGBToLinear().applyMatrix3(o0),fromReference:_=>_.applyMatrix3(s0).convertLinearToSRGB()}},Kv=new Set([Na,cu]),gr={enabled:!0,_workingColorSpace:Na,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(_){if(!Kv.has(_))throw new Error(`Unsupported working color space, "${_}".`);this._workingColorSpace=_},convert:function(_,n,s){if(this.enabled===!1||n===s||!n||!s)return _;const l=_h[n].toReference,d=_h[s].fromReference;return d(l(_))},fromWorkingColorSpace:function(_,n){return this.convert(_,this._workingColorSpace,n)},toWorkingColorSpace:function(_,n){return this.convert(_,n,this._workingColorSpace)},getPrimaries:function(_){return _h[_].primaries},getTransfer:function(_){return _===Zs?uu:_h[_].transfer}};function wc(_){return _<.04045?_*.0773993808:Math.pow(_*.9478672986+.0521327014,2.4)}function md(_){return _<.0031308?_*12.92:1.055*Math.pow(_,.41666)-.055}let Fl;class Cc{static getDataURL(n){if(/^data:/i.test(n.src)||typeof HTMLCanvasElement>"u")return n.src;let s;if(n instanceof HTMLCanvasElement)s=n;else{Fl===void 0&&(Fl=Au("canvas")),Fl.width=n.width,Fl.height=n.height;const l=Fl.getContext("2d");n instanceof ImageData?l.putImageData(n,0,0):l.drawImage(n,0,0,n.width,n.height),s=Fl}return s.width>2048||s.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",n),s.toDataURL("image/jpeg",.6)):s.toDataURL("image/png")}static sRGBToLinear(n){if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap){const s=Au("canvas");s.width=n.width,s.height=n.height;const l=s.getContext("2d");l.drawImage(n,0,0,n.width,n.height);const d=l.getImageData(0,0,n.width,n.height),b=d.data;for(let T=0;T<b.length;T++)b[T]=wc(b[T]/255)*255;return l.putImageData(d,0,0),s}else if(n.data){const s=n.data.slice(0);for(let l=0;l<s.length;l++)s instanceof Uint8Array||s instanceof Uint8ClampedArray?s[l]=Math.floor(wc(s[l]/255)*255):s[l]=wc(s[l]);return{data:s,width:n.width,height:n.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),n}}let a0=0;class Wr{constructor(n=null){this.isSource=!0,Object.defineProperty(this,"id",{value:a0++}),this.uuid=bo(),this.data=n,this.dataReady=!0,this.version=0}set needsUpdate(n){n===!0&&this.version++}toJSON(n){const s=n===void 0||typeof n=="string";if(!s&&n.images[this.uuid]!==void 0)return n.images[this.uuid];const l={uuid:this.uuid,url:""},d=this.data;if(d!==null){let b;if(Array.isArray(d)){b=[];for(let T=0,B=d.length;T<B;T++)d[T].isDataTexture?b.push(Eh(d[T].image)):b.push(Eh(d[T]))}else b=Eh(d);l.url=b}return s||(n.images[this.uuid]=l),l}}function Eh(_){return typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap?Cc.getDataURL(_):_.data?{data:Array.from(_.data),width:_.width,height:_.height,type:_.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let l0=0;class kr extends vo{constructor(n=kr.DEFAULT_IMAGE,s=kr.DEFAULT_MAPPING,l=He,d=He,b=Dn,T=_r,B=We,N=Hr,U=kr.DEFAULT_ANISOTROPY,z=Zs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:l0++}),this.uuid=bo(),this.name="",this.source=new Wr(n),this.mipmaps=[],this.mapping=s,this.channel=0,this.wrapS=l,this.wrapT=d,this.magFilter=b,this.minFilter=T,this.anisotropy=U,this.format=B,this.internalFormat=null,this.type=N,this.offset=new Jt(0,0),this.repeat=new Jt(1,1),this.center=new Jt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _i,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=z,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(n=null){this.source.data=n}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(n){return this.name=n.name,this.source=n.source,this.mipmaps=n.mipmaps.slice(0),this.mapping=n.mapping,this.channel=n.channel,this.wrapS=n.wrapS,this.wrapT=n.wrapT,this.magFilter=n.magFilter,this.minFilter=n.minFilter,this.anisotropy=n.anisotropy,this.format=n.format,this.internalFormat=n.internalFormat,this.type=n.type,this.offset.copy(n.offset),this.repeat.copy(n.repeat),this.center.copy(n.center),this.rotation=n.rotation,this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrix.copy(n.matrix),this.generateMipmaps=n.generateMipmaps,this.premultiplyAlpha=n.premultiplyAlpha,this.flipY=n.flipY,this.unpackAlignment=n.unpackAlignment,this.colorSpace=n.colorSpace,this.userData=JSON.parse(JSON.stringify(n.userData)),this.needsUpdate=!0,this}toJSON(n){const s=n===void 0||typeof n=="string";if(!s&&n.textures[this.uuid]!==void 0)return n.textures[this.uuid];const l={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(n).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(l.userData=this.userData),s||(n.textures[this.uuid]=l),l}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(n){if(this.mapping!==Ne)return n;if(n.applyMatrix3(this.matrix),n.x<0||n.x>1)switch(this.wrapS){case Qe:n.x=n.x-Math.floor(n.x);break;case He:n.x=n.x<0?0:1;break;case Pt:Math.abs(Math.floor(n.x)%2)===1?n.x=Math.ceil(n.x)-n.x:n.x=n.x-Math.floor(n.x);break}if(n.y<0||n.y>1)switch(this.wrapT){case Qe:n.y=n.y-Math.floor(n.y);break;case He:n.y=n.y<0?0:1;break;case Pt:Math.abs(Math.floor(n.y)%2)===1?n.y=Math.ceil(n.y)-n.y:n.y=n.y-Math.floor(n.y);break}return this.flipY&&(n.y=1-n.y),n}set needsUpdate(n){n===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(n){n===!0&&this.pmremVersion++}}kr.DEFAULT_IMAGE=null,kr.DEFAULT_MAPPING=Ne,kr.DEFAULT_ANISOTROPY=1;class ar{constructor(n=0,s=0,l=0,d=1){ar.prototype.isVector4=!0,this.x=n,this.y=s,this.z=l,this.w=d}get width(){return this.z}set width(n){this.z=n}get height(){return this.w}set height(n){this.w=n}set(n,s,l,d){return this.x=n,this.y=s,this.z=l,this.w=d,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this.w=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setW(n){return this.w=n,this}setComponent(n,s){switch(n){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;case 3:this.w=s;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w!==void 0?n.w:1,this}add(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this.w+=n.w,this}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this.w+=n,this}addVectors(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this.z=n.z+s.z,this.w=n.w+s.w,this}addScaledVector(n,s){return this.x+=n.x*s,this.y+=n.y*s,this.z+=n.z*s,this.w+=n.w*s,this}sub(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this.w-=n.w,this}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this.w-=n,this}subVectors(n,s){return this.x=n.x-s.x,this.y=n.y-s.y,this.z=n.z-s.z,this.w=n.w-s.w,this}multiply(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this.w*=n.w,this}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this}applyMatrix4(n){const s=this.x,l=this.y,d=this.z,b=this.w,T=n.elements;return this.x=T[0]*s+T[4]*l+T[8]*d+T[12]*b,this.y=T[1]*s+T[5]*l+T[9]*d+T[13]*b,this.z=T[2]*s+T[6]*l+T[10]*d+T[14]*b,this.w=T[3]*s+T[7]*l+T[11]*d+T[15]*b,this}divideScalar(n){return this.multiplyScalar(1/n)}setAxisAngleFromQuaternion(n){this.w=2*Math.acos(n.w);const s=Math.sqrt(1-n.w*n.w);return s<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=n.x/s,this.y=n.y/s,this.z=n.z/s),this}setAxisAngleFromRotationMatrix(n){let s,l,d,b;const N=n.elements,U=N[0],z=N[4],X=N[8],q=N[1],ee=N[5],ie=N[9],ce=N[2],re=N[6],te=N[10];if(Math.abs(z-q)<.01&&Math.abs(X-ce)<.01&&Math.abs(ie-re)<.01){if(Math.abs(z+q)<.1&&Math.abs(X+ce)<.1&&Math.abs(ie+re)<.1&&Math.abs(U+ee+te-3)<.1)return this.set(1,0,0,0),this;s=Math.PI;const ve=(U+1)/2,Ae=(ee+1)/2,qe=(te+1)/2,Ve=(z+q)/4,ze=(X+ce)/4,Ke=(ie+re)/4;return ve>Ae&&ve>qe?ve<.01?(l=0,d=.707106781,b=.707106781):(l=Math.sqrt(ve),d=Ve/l,b=ze/l):Ae>qe?Ae<.01?(l=.707106781,d=0,b=.707106781):(d=Math.sqrt(Ae),l=Ve/d,b=Ke/d):qe<.01?(l=.707106781,d=.707106781,b=0):(b=Math.sqrt(qe),l=ze/b,d=Ke/b),this.set(l,d,b,s),this}let we=Math.sqrt((re-ie)*(re-ie)+(X-ce)*(X-ce)+(q-z)*(q-z));return Math.abs(we)<.001&&(we=1),this.x=(re-ie)/we,this.y=(X-ce)/we,this.z=(q-z)/we,this.w=Math.acos((U+ee+te-1)/2),this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this.w=Math.min(this.w,n.w),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this.w=Math.max(this.w,n.w),this}clamp(n,s){return this.x=Math.max(n.x,Math.min(s.x,this.x)),this.y=Math.max(n.y,Math.min(s.y,this.y)),this.z=Math.max(n.z,Math.min(s.z,this.z)),this.w=Math.max(n.w,Math.min(s.w,this.w)),this}clampScalar(n,s){return this.x=Math.max(n,Math.min(s,this.x)),this.y=Math.max(n,Math.min(s,this.y)),this.z=Math.max(n,Math.min(s,this.z)),this.w=Math.max(n,Math.min(s,this.w)),this}clampLength(n,s){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(n,Math.min(s,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this.z+=(n.z-this.z)*s,this.w+=(n.w-this.w)*s,this}lerpVectors(n,s,l){return this.x=n.x+(s.x-n.x)*l,this.y=n.y+(s.y-n.y)*l,this.z=n.z+(s.z-n.z)*l,this.w=n.w+(s.w-n.w)*l,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z&&n.w===this.w}fromArray(n,s=0){return this.x=n[s],this.y=n[s+1],this.z=n[s+2],this.w=n[s+3],this}toArray(n=[],s=0){return n[s]=this.x,n[s+1]=this.y,n[s+2]=this.z,n[s+3]=this.w,n}fromBufferAttribute(n,s){return this.x=n.getX(s),this.y=n.getY(s),this.z=n.getZ(s),this.w=n.getW(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class wh extends vo{constructor(n=1,s=1,l={}){super(),this.isRenderTarget=!0,this.width=n,this.height=s,this.depth=1,this.scissor=new ar(0,0,n,s),this.scissorTest=!1,this.viewport=new ar(0,0,n,s);const d={width:n,height:s,depth:1};l=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Dn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},l);const b=new kr(d,l.mapping,l.wrapS,l.wrapT,l.magFilter,l.minFilter,l.format,l.type,l.anisotropy,l.colorSpace);b.flipY=!1,b.generateMipmaps=l.generateMipmaps,b.internalFormat=l.internalFormat,this.textures=[];const T=l.count;for(let B=0;B<T;B++)this.textures[B]=b.clone(),this.textures[B].isRenderTargetTexture=!0;this.depthBuffer=l.depthBuffer,this.stencilBuffer=l.stencilBuffer,this.resolveDepthBuffer=l.resolveDepthBuffer,this.resolveStencilBuffer=l.resolveStencilBuffer,this.depthTexture=l.depthTexture,this.samples=l.samples}get texture(){return this.textures[0]}set texture(n){this.textures[0]=n}setSize(n,s,l=1){if(this.width!==n||this.height!==s||this.depth!==l){this.width=n,this.height=s,this.depth=l;for(let d=0,b=this.textures.length;d<b;d++)this.textures[d].image.width=n,this.textures[d].image.height=s,this.textures[d].image.depth=l;this.dispose()}this.viewport.set(0,0,n,s),this.scissor.set(0,0,n,s)}clone(){return new this.constructor().copy(this)}copy(n){this.width=n.width,this.height=n.height,this.depth=n.depth,this.scissor.copy(n.scissor),this.scissorTest=n.scissorTest,this.viewport.copy(n.viewport),this.textures.length=0;for(let l=0,d=n.textures.length;l<d;l++)this.textures[l]=n.textures[l].clone(),this.textures[l].isRenderTargetTexture=!0;const s=Object.assign({},n.texture.image);return this.texture.source=new Wr(s),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,n.depthTexture!==null&&(this.depthTexture=n.depthTexture.clone()),this.samples=n.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Do extends wh{constructor(n=1,s=1,l={}){super(n,s,l),this.isWebGLRenderTarget=!0}}class Ch extends kr{constructor(n=null,s=1,l=1,d=1){super(null),this.isDataArrayTexture=!0,this.image={data:n,width:s,height:l,depth:d},this.magFilter=rn,this.minFilter=rn,this.wrapR=He,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Wn extends Do{constructor(n=1,s=1,l=1,d={}){super(n,s,d),this.isWebGLArrayRenderTarget=!0,this.depth=l,this.texture=new Ch(null,n,s,l),this.texture.isRenderTargetTexture=!0}}class Ei extends kr{constructor(n=null,s=1,l=1,d=1){super(null),this.isData3DTexture=!0,this.image={data:n,width:s,height:l,depth:d},this.magFilter=rn,this.minFilter=rn,this.wrapR=He,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class er extends Do{constructor(n=1,s=1,l=1,d={}){super(n,s,d),this.isWebGL3DRenderTarget=!0,this.depth=l,this.texture=new Ei(null,n,s,l),this.texture.isRenderTargetTexture=!0}}class ur{constructor(n=0,s=0,l=0,d=1){this.isQuaternion=!0,this._x=n,this._y=s,this._z=l,this._w=d}static slerpFlat(n,s,l,d,b,T,B){let N=l[d+0],U=l[d+1],z=l[d+2],X=l[d+3];const q=b[T+0],ee=b[T+1],ie=b[T+2],ce=b[T+3];if(B===0){n[s+0]=N,n[s+1]=U,n[s+2]=z,n[s+3]=X;return}if(B===1){n[s+0]=q,n[s+1]=ee,n[s+2]=ie,n[s+3]=ce;return}if(X!==ce||N!==q||U!==ee||z!==ie){let re=1-B;const te=N*q+U*ee+z*ie+X*ce,we=te>=0?1:-1,ve=1-te*te;if(ve>Number.EPSILON){const qe=Math.sqrt(ve),Ve=Math.atan2(qe,te*we);re=Math.sin(re*Ve)/qe,B=Math.sin(B*Ve)/qe}const Ae=B*we;if(N=N*re+q*Ae,U=U*re+ee*Ae,z=z*re+ie*Ae,X=X*re+ce*Ae,re===1-B){const qe=1/Math.sqrt(N*N+U*U+z*z+X*X);N*=qe,U*=qe,z*=qe,X*=qe}}n[s]=N,n[s+1]=U,n[s+2]=z,n[s+3]=X}static multiplyQuaternionsFlat(n,s,l,d,b,T){const B=l[d],N=l[d+1],U=l[d+2],z=l[d+3],X=b[T],q=b[T+1],ee=b[T+2],ie=b[T+3];return n[s]=B*ie+z*X+N*ee-U*q,n[s+1]=N*ie+z*q+U*X-B*ee,n[s+2]=U*ie+z*ee+B*q-N*X,n[s+3]=z*ie-B*X-N*q-U*ee,n}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get w(){return this._w}set w(n){this._w=n,this._onChangeCallback()}set(n,s,l,d){return this._x=n,this._y=s,this._z=l,this._w=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(n){return this._x=n.x,this._y=n.y,this._z=n.z,this._w=n.w,this._onChangeCallback(),this}setFromEuler(n,s=!0){const l=n._x,d=n._y,b=n._z,T=n._order,B=Math.cos,N=Math.sin,U=B(l/2),z=B(d/2),X=B(b/2),q=N(l/2),ee=N(d/2),ie=N(b/2);switch(T){case"XYZ":this._x=q*z*X+U*ee*ie,this._y=U*ee*X-q*z*ie,this._z=U*z*ie+q*ee*X,this._w=U*z*X-q*ee*ie;break;case"YXZ":this._x=q*z*X+U*ee*ie,this._y=U*ee*X-q*z*ie,this._z=U*z*ie-q*ee*X,this._w=U*z*X+q*ee*ie;break;case"ZXY":this._x=q*z*X-U*ee*ie,this._y=U*ee*X+q*z*ie,this._z=U*z*ie+q*ee*X,this._w=U*z*X-q*ee*ie;break;case"ZYX":this._x=q*z*X-U*ee*ie,this._y=U*ee*X+q*z*ie,this._z=U*z*ie-q*ee*X,this._w=U*z*X+q*ee*ie;break;case"YZX":this._x=q*z*X+U*ee*ie,this._y=U*ee*X+q*z*ie,this._z=U*z*ie-q*ee*X,this._w=U*z*X-q*ee*ie;break;case"XZY":this._x=q*z*X-U*ee*ie,this._y=U*ee*X-q*z*ie,this._z=U*z*ie+q*ee*X,this._w=U*z*X+q*ee*ie;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+T)}return s===!0&&this._onChangeCallback(),this}setFromAxisAngle(n,s){const l=s/2,d=Math.sin(l);return this._x=n.x*d,this._y=n.y*d,this._z=n.z*d,this._w=Math.cos(l),this._onChangeCallback(),this}setFromRotationMatrix(n){const s=n.elements,l=s[0],d=s[4],b=s[8],T=s[1],B=s[5],N=s[9],U=s[2],z=s[6],X=s[10],q=l+B+X;if(q>0){const ee=.5/Math.sqrt(q+1);this._w=.25/ee,this._x=(z-N)*ee,this._y=(b-U)*ee,this._z=(T-d)*ee}else if(l>B&&l>X){const ee=2*Math.sqrt(1+l-B-X);this._w=(z-N)/ee,this._x=.25*ee,this._y=(d+T)/ee,this._z=(b+U)/ee}else if(B>X){const ee=2*Math.sqrt(1+B-l-X);this._w=(b-U)/ee,this._x=(d+T)/ee,this._y=.25*ee,this._z=(N+z)/ee}else{const ee=2*Math.sqrt(1+X-l-B);this._w=(T-d)/ee,this._x=(b+U)/ee,this._y=(N+z)/ee,this._z=.25*ee}return this._onChangeCallback(),this}setFromUnitVectors(n,s){let l=n.dot(s)+1;return l<Number.EPSILON?(l=0,Math.abs(n.x)>Math.abs(n.z)?(this._x=-n.y,this._y=n.x,this._z=0,this._w=l):(this._x=0,this._y=-n.z,this._z=n.y,this._w=l)):(this._x=n.y*s.z-n.z*s.y,this._y=n.z*s.x-n.x*s.z,this._z=n.x*s.y-n.y*s.x,this._w=l),this.normalize()}angleTo(n){return 2*Math.acos(Math.abs(Kr(this.dot(n),-1,1)))}rotateTowards(n,s){const l=this.angleTo(n);if(l===0)return this;const d=Math.min(1,s/l);return this.slerp(n,d),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(n){return this._x*n._x+this._y*n._y+this._z*n._z+this._w*n._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let n=this.length();return n===0?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this._onChangeCallback(),this}multiply(n){return this.multiplyQuaternions(this,n)}premultiply(n){return this.multiplyQuaternions(n,this)}multiplyQuaternions(n,s){const l=n._x,d=n._y,b=n._z,T=n._w,B=s._x,N=s._y,U=s._z,z=s._w;return this._x=l*z+T*B+d*U-b*N,this._y=d*z+T*N+b*B-l*U,this._z=b*z+T*U+l*N-d*B,this._w=T*z-l*B-d*N-b*U,this._onChangeCallback(),this}slerp(n,s){if(s===0)return this;if(s===1)return this.copy(n);const l=this._x,d=this._y,b=this._z,T=this._w;let B=T*n._w+l*n._x+d*n._y+b*n._z;if(B<0?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,B=-B):this.copy(n),B>=1)return this._w=T,this._x=l,this._y=d,this._z=b,this;const N=1-B*B;if(N<=Number.EPSILON){const ee=1-s;return this._w=ee*T+s*this._w,this._x=ee*l+s*this._x,this._y=ee*d+s*this._y,this._z=ee*b+s*this._z,this.normalize(),this}const U=Math.sqrt(N),z=Math.atan2(U,B),X=Math.sin((1-s)*z)/U,q=Math.sin(s*z)/U;return this._w=T*X+this._w*q,this._x=l*X+this._x*q,this._y=d*X+this._y*q,this._z=b*X+this._z*q,this._onChangeCallback(),this}slerpQuaternions(n,s,l){return this.copy(n).slerp(s,l)}random(){const n=2*Math.PI*Math.random(),s=2*Math.PI*Math.random(),l=Math.random(),d=Math.sqrt(1-l),b=Math.sqrt(l);return this.set(d*Math.sin(n),d*Math.cos(n),b*Math.sin(s),b*Math.cos(s))}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._w===this._w}fromArray(n,s=0){return this._x=n[s],this._y=n[s+1],this._z=n[s+2],this._w=n[s+3],this._onChangeCallback(),this}toArray(n=[],s=0){return n[s]=this._x,n[s+1]=this._y,n[s+2]=this._z,n[s+3]=this._w,n}fromBufferAttribute(n,s){return this._x=n.getX(s),this._y=n.getY(s),this._z=n.getZ(s),this._w=n.getW(s),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ge{constructor(n=0,s=0,l=0){Ge.prototype.isVector3=!0,this.x=n,this.y=s,this.z=l}set(n,s,l){return l===void 0&&(l=this.z),this.x=n,this.y=s,this.z=l,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setComponent(n,s){switch(n){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this}add(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this}addVectors(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this.z=n.z+s.z,this}addScaledVector(n,s){return this.x+=n.x*s,this.y+=n.y*s,this.z+=n.z*s,this}sub(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this}subVectors(n,s){return this.x=n.x-s.x,this.y=n.y-s.y,this.z=n.z-s.z,this}multiply(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this}multiplyVectors(n,s){return this.x=n.x*s.x,this.y=n.y*s.y,this.z=n.z*s.z,this}applyEuler(n){return this.applyQuaternion(os.setFromEuler(n))}applyAxisAngle(n,s){return this.applyQuaternion(os.setFromAxisAngle(n,s))}applyMatrix3(n){const s=this.x,l=this.y,d=this.z,b=n.elements;return this.x=b[0]*s+b[3]*l+b[6]*d,this.y=b[1]*s+b[4]*l+b[7]*d,this.z=b[2]*s+b[5]*l+b[8]*d,this}applyNormalMatrix(n){return this.applyMatrix3(n).normalize()}applyMatrix4(n){const s=this.x,l=this.y,d=this.z,b=n.elements,T=1/(b[3]*s+b[7]*l+b[11]*d+b[15]);return this.x=(b[0]*s+b[4]*l+b[8]*d+b[12])*T,this.y=(b[1]*s+b[5]*l+b[9]*d+b[13])*T,this.z=(b[2]*s+b[6]*l+b[10]*d+b[14])*T,this}applyQuaternion(n){const s=this.x,l=this.y,d=this.z,b=n.x,T=n.y,B=n.z,N=n.w,U=2*(T*d-B*l),z=2*(B*s-b*d),X=2*(b*l-T*s);return this.x=s+N*U+T*X-B*z,this.y=l+N*z+B*U-b*X,this.z=d+N*X+b*z-T*U,this}project(n){return this.applyMatrix4(n.matrixWorldInverse).applyMatrix4(n.projectionMatrix)}unproject(n){return this.applyMatrix4(n.projectionMatrixInverse).applyMatrix4(n.matrixWorld)}transformDirection(n){const s=this.x,l=this.y,d=this.z,b=n.elements;return this.x=b[0]*s+b[4]*l+b[8]*d,this.y=b[1]*s+b[5]*l+b[9]*d,this.z=b[2]*s+b[6]*l+b[10]*d,this.normalize()}divide(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z,this}divideScalar(n){return this.multiplyScalar(1/n)}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this}clamp(n,s){return this.x=Math.max(n.x,Math.min(s.x,this.x)),this.y=Math.max(n.y,Math.min(s.y,this.y)),this.z=Math.max(n.z,Math.min(s.z,this.z)),this}clampScalar(n,s){return this.x=Math.max(n,Math.min(s,this.x)),this.y=Math.max(n,Math.min(s,this.y)),this.z=Math.max(n,Math.min(s,this.z)),this}clampLength(n,s){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(n,Math.min(s,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this.z+=(n.z-this.z)*s,this}lerpVectors(n,s,l){return this.x=n.x+(s.x-n.x)*l,this.y=n.y+(s.y-n.y)*l,this.z=n.z+(s.z-n.z)*l,this}cross(n){return this.crossVectors(this,n)}crossVectors(n,s){const l=n.x,d=n.y,b=n.z,T=s.x,B=s.y,N=s.z;return this.x=d*N-b*B,this.y=b*T-l*N,this.z=l*B-d*T,this}projectOnVector(n){const s=n.lengthSq();if(s===0)return this.set(0,0,0);const l=n.dot(this)/s;return this.copy(n).multiplyScalar(l)}projectOnPlane(n){return Jo.copy(this).projectOnVector(n),this.sub(Jo)}reflect(n){return this.sub(Jo.copy(n).multiplyScalar(2*this.dot(n)))}angleTo(n){const s=Math.sqrt(this.lengthSq()*n.lengthSq());if(s===0)return Math.PI/2;const l=this.dot(n)/s;return Math.acos(Kr(l,-1,1))}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const s=this.x-n.x,l=this.y-n.y,d=this.z-n.z;return s*s+l*l+d*d}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)+Math.abs(this.z-n.z)}setFromSpherical(n){return this.setFromSphericalCoords(n.radius,n.phi,n.theta)}setFromSphericalCoords(n,s,l){const d=Math.sin(s)*n;return this.x=d*Math.sin(l),this.y=Math.cos(s)*n,this.z=d*Math.cos(l),this}setFromCylindrical(n){return this.setFromCylindricalCoords(n.radius,n.theta,n.y)}setFromCylindricalCoords(n,s,l){return this.x=n*Math.sin(s),this.y=l,this.z=n*Math.cos(s),this}setFromMatrixPosition(n){const s=n.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(n){const s=this.setFromMatrixColumn(n,0).length(),l=this.setFromMatrixColumn(n,1).length(),d=this.setFromMatrixColumn(n,2).length();return this.x=s,this.y=l,this.z=d,this}setFromMatrixColumn(n,s){return this.fromArray(n.elements,s*4)}setFromMatrix3Column(n,s){return this.fromArray(n.elements,s*3)}setFromEuler(n){return this.x=n._x,this.y=n._y,this.z=n._z,this}setFromColor(n){return this.x=n.r,this.y=n.g,this.z=n.b,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z}fromArray(n,s=0){return this.x=n[s],this.y=n[s+1],this.z=n[s+2],this}toArray(n=[],s=0){return n[s]=this.x,n[s+1]=this.y,n[s+2]=this.z,n}fromBufferAttribute(n,s){return this.x=n.getX(s),this.y=n.getY(s),this.z=n.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const n=Math.random()*Math.PI*2,s=Math.random()*2-1,l=Math.sqrt(1-s*s);return this.x=l*Math.cos(n),this.y=s,this.z=l*Math.sin(n),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Jo=new Ge,os=new ur;class ns{constructor(n=new Ge(1/0,1/0,1/0),s=new Ge(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=n,this.max=s}set(n,s){return this.min.copy(n),this.max.copy(s),this}setFromArray(n){this.makeEmpty();for(let s=0,l=n.length;s<l;s+=3)this.expandByPoint(so.fromArray(n,s));return this}setFromBufferAttribute(n){this.makeEmpty();for(let s=0,l=n.count;s<l;s++)this.expandByPoint(so.fromBufferAttribute(n,s));return this}setFromPoints(n){this.makeEmpty();for(let s=0,l=n.length;s<l;s++)this.expandByPoint(n[s]);return this}setFromCenterAndSize(n,s){const l=so.copy(s).multiplyScalar(.5);return this.min.copy(n).sub(l),this.max.copy(n).add(l),this}setFromObject(n,s=!1){return this.makeEmpty(),this.expandByObject(n,s)}clone(){return new this.constructor().copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(n){return this.isEmpty()?n.set(0,0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}expandByObject(n,s=!1){n.updateWorldMatrix(!1,!1);const l=n.geometry;if(l!==void 0){const b=l.getAttribute("position");if(s===!0&&b!==void 0&&n.isInstancedMesh!==!0)for(let T=0,B=b.count;T<B;T++)n.isMesh===!0?n.getVertexPosition(T,so):so.fromBufferAttribute(b,T),so.applyMatrix4(n.matrixWorld),this.expandByPoint(so);else n.boundingBox!==void 0?(n.boundingBox===null&&n.computeBoundingBox(),ol.copy(n.boundingBox)):(l.boundingBox===null&&l.computeBoundingBox(),ol.copy(l.boundingBox)),ol.applyMatrix4(n.matrixWorld),this.union(ol)}const d=n.children;for(let b=0,T=d.length;b<T;b++)this.expandByObject(d[b],s);return this}containsPoint(n){return!(n.x<this.min.x||n.x>this.max.x||n.y<this.min.y||n.y>this.max.y||n.z<this.min.z||n.z>this.max.z)}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y&&this.min.z<=n.min.z&&n.max.z<=this.max.z}getParameter(n,s){return s.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y),(n.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(n){return!(n.max.x<this.min.x||n.min.x>this.max.x||n.max.y<this.min.y||n.min.y>this.max.y||n.max.z<this.min.z||n.min.z>this.max.z)}intersectsSphere(n){return this.clampPoint(n.center,so),so.distanceToSquared(n.center)<=n.radius*n.radius}intersectsPlane(n){let s,l;return n.normal.x>0?(s=n.normal.x*this.min.x,l=n.normal.x*this.max.x):(s=n.normal.x*this.max.x,l=n.normal.x*this.min.x),n.normal.y>0?(s+=n.normal.y*this.min.y,l+=n.normal.y*this.max.y):(s+=n.normal.y*this.max.y,l+=n.normal.y*this.min.y),n.normal.z>0?(s+=n.normal.z*this.min.z,l+=n.normal.z*this.max.z):(s+=n.normal.z*this.max.z,l+=n.normal.z*this.min.z),s<=-n.constant&&l>=-n.constant}intersectsTriangle(n){if(this.isEmpty())return!1;this.getCenter(sr),Sr.subVectors(this.max,sr),No.subVectors(n.a,sr),Vs.subVectors(n.b,sr),Pi.subVectors(n.c,sr),to.subVectors(Vs,No),Zo.subVectors(Pi,Vs),Qs.subVectors(No,Pi);let s=[0,-to.z,to.y,0,-Zo.z,Zo.y,0,-Qs.z,Qs.y,to.z,0,-to.x,Zo.z,0,-Zo.x,Qs.z,0,-Qs.x,-to.y,to.x,0,-Zo.y,Zo.x,0,-Qs.y,Qs.x,0];return!yo(s,No,Vs,Pi,Sr)||(s=[1,0,0,0,1,0,0,0,1],!yo(s,No,Vs,Pi,Sr))?!1:(Di.crossVectors(to,Zo),s=[Di.x,Di.y,Di.z],yo(s,No,Vs,Pi,Sr))}clampPoint(n,s){return s.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return this.clampPoint(n,so).distanceTo(n)}getBoundingSphere(n){return this.isEmpty()?n.makeEmpty():(this.getCenter(n.center),n.radius=this.getSize(so).length()*.5),n}intersect(n){return this.min.max(n.min),this.max.min(n.max),this.isEmpty()&&this.makeEmpty(),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}applyMatrix4(n){return this.isEmpty()?this:(qi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),qi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),qi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),qi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),qi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),qi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),qi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),qi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(qi),this)}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}}const qi=[new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge],so=new Ge,ol=new ns,No=new Ge,Vs=new Ge,Pi=new Ge,to=new Ge,Zo=new Ge,Qs=new Ge,sr=new Ge,Sr=new Ge,Di=new Ge,or=new Ge;function yo(_,n,s,l,d){for(let b=0,T=_.length-3;b<=T;b+=3){or.fromArray(_,b);const B=d.x*Math.abs(or.x)+d.y*Math.abs(or.y)+d.z*Math.abs(or.z),N=n.dot(or),U=s.dot(or),z=l.dot(or);if(Math.max(-Math.max(N,U,z),Math.min(N,U,z))>B)return!1}return!0}const xc=new ns,kl=new Ge,xh=new Ge;class Ts{constructor(n=new Ge,s=-1){this.isSphere=!0,this.center=n,this.radius=s}set(n,s){return this.center.copy(n),this.radius=s,this}setFromPoints(n,s){const l=this.center;s!==void 0?l.copy(s):xc.setFromPoints(n).getCenter(l);let d=0;for(let b=0,T=n.length;b<T;b++)d=Math.max(d,l.distanceToSquared(n[b]));return this.radius=Math.sqrt(d),this}copy(n){return this.center.copy(n.center),this.radius=n.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(n){return n.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(n){return n.distanceTo(this.center)-this.radius}intersectsSphere(n){const s=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=s*s}intersectsBox(n){return n.intersectsSphere(this)}intersectsPlane(n){return Math.abs(n.distanceToPoint(this.center))<=this.radius}clampPoint(n,s){const l=this.center.distanceToSquared(n);return s.copy(n),l>this.radius*this.radius&&(s.sub(this.center).normalize(),s.multiplyScalar(this.radius).add(this.center)),s}getBoundingBox(n){return this.isEmpty()?(n.makeEmpty(),n):(n.set(this.center,this.center),n.expandByScalar(this.radius),n)}applyMatrix4(n){return this.center.applyMatrix4(n),this.radius=this.radius*n.getMaxScaleOnAxis(),this}translate(n){return this.center.add(n),this}expandByPoint(n){if(this.isEmpty())return this.center.copy(n),this.radius=0,this;kl.subVectors(n,this.center);const s=kl.lengthSq();if(s>this.radius*this.radius){const l=Math.sqrt(s),d=(l-this.radius)*.5;this.center.addScaledVector(kl,d/l),this.radius+=d}return this}union(n){return n.isEmpty()?this:this.isEmpty()?(this.copy(n),this):(this.center.equals(n.center)===!0?this.radius=Math.max(this.radius,n.radius):(xh.subVectors(n.center,this.center).setLength(n.radius),this.expandByPoint(kl.copy(n.center).add(xh)),this.expandByPoint(kl.copy(n.center).sub(xh))),this)}equals(n){return n.center.equals(this.center)&&n.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Aa=new Ge,Mh=new Ge,Sh=new Ge,al=new Ge,Ad=new Ge,Th=new Ge,gd=new Ge;class Is{constructor(n=new Ge,s=new Ge(0,0,-1)){this.origin=n,this.direction=s}set(n,s){return this.origin.copy(n),this.direction.copy(s),this}copy(n){return this.origin.copy(n.origin),this.direction.copy(n.direction),this}at(n,s){return s.copy(this.origin).addScaledVector(this.direction,n)}lookAt(n){return this.direction.copy(n).sub(this.origin).normalize(),this}recast(n){return this.origin.copy(this.at(n,Aa)),this}closestPointToPoint(n,s){s.subVectors(n,this.origin);const l=s.dot(this.direction);return l<0?s.copy(this.origin):s.copy(this.origin).addScaledVector(this.direction,l)}distanceToPoint(n){return Math.sqrt(this.distanceSqToPoint(n))}distanceSqToPoint(n){const s=Aa.subVectors(n,this.origin).dot(this.direction);return s<0?this.origin.distanceToSquared(n):(Aa.copy(this.origin).addScaledVector(this.direction,s),Aa.distanceToSquared(n))}distanceSqToSegment(n,s,l,d){Mh.copy(n).add(s).multiplyScalar(.5),Sh.copy(s).sub(n).normalize(),al.copy(this.origin).sub(Mh);const b=n.distanceTo(s)*.5,T=-this.direction.dot(Sh),B=al.dot(this.direction),N=-al.dot(Sh),U=al.lengthSq(),z=Math.abs(1-T*T);let X,q,ee,ie;if(z>0)if(X=T*N-B,q=T*B-N,ie=b*z,X>=0)if(q>=-ie)if(q<=ie){const ce=1/z;X*=ce,q*=ce,ee=X*(X+T*q+2*B)+q*(T*X+q+2*N)+U}else q=b,X=Math.max(0,-(T*q+B)),ee=-X*X+q*(q+2*N)+U;else q=-b,X=Math.max(0,-(T*q+B)),ee=-X*X+q*(q+2*N)+U;else q<=-ie?(X=Math.max(0,-(-T*b+B)),q=X>0?-b:Math.min(Math.max(-b,-N),b),ee=-X*X+q*(q+2*N)+U):q<=ie?(X=0,q=Math.min(Math.max(-b,-N),b),ee=q*(q+2*N)+U):(X=Math.max(0,-(T*b+B)),q=X>0?b:Math.min(Math.max(-b,-N),b),ee=-X*X+q*(q+2*N)+U);else q=T>0?-b:b,X=Math.max(0,-(T*q+B)),ee=-X*X+q*(q+2*N)+U;return l&&l.copy(this.origin).addScaledVector(this.direction,X),d&&d.copy(Mh).addScaledVector(Sh,q),ee}intersectSphere(n,s){Aa.subVectors(n.center,this.origin);const l=Aa.dot(this.direction),d=Aa.dot(Aa)-l*l,b=n.radius*n.radius;if(d>b)return null;const T=Math.sqrt(b-d),B=l-T,N=l+T;return N<0?null:B<0?this.at(N,s):this.at(B,s)}intersectsSphere(n){return this.distanceSqToPoint(n.center)<=n.radius*n.radius}distanceToPlane(n){const s=n.normal.dot(this.direction);if(s===0)return n.distanceToPoint(this.origin)===0?0:null;const l=-(this.origin.dot(n.normal)+n.constant)/s;return l>=0?l:null}intersectPlane(n,s){const l=this.distanceToPlane(n);return l===null?null:this.at(l,s)}intersectsPlane(n){const s=n.distanceToPoint(this.origin);return s===0||n.normal.dot(this.direction)*s<0}intersectBox(n,s){let l,d,b,T,B,N;const U=1/this.direction.x,z=1/this.direction.y,X=1/this.direction.z,q=this.origin;return U>=0?(l=(n.min.x-q.x)*U,d=(n.max.x-q.x)*U):(l=(n.max.x-q.x)*U,d=(n.min.x-q.x)*U),z>=0?(b=(n.min.y-q.y)*z,T=(n.max.y-q.y)*z):(b=(n.max.y-q.y)*z,T=(n.min.y-q.y)*z),l>T||b>d||((b>l||isNaN(l))&&(l=b),(T<d||isNaN(d))&&(d=T),X>=0?(B=(n.min.z-q.z)*X,N=(n.max.z-q.z)*X):(B=(n.max.z-q.z)*X,N=(n.min.z-q.z)*X),l>N||B>d)||((B>l||l!==l)&&(l=B),(N<d||d!==d)&&(d=N),d<0)?null:this.at(l>=0?l:d,s)}intersectsBox(n){return this.intersectBox(n,Aa)!==null}intersectTriangle(n,s,l,d,b){Ad.subVectors(s,n),Th.subVectors(l,n),gd.crossVectors(Ad,Th);let T=this.direction.dot(gd),B;if(T>0){if(d)return null;B=1}else if(T<0)B=-1,T=-T;else return null;al.subVectors(this.origin,n);const N=B*this.direction.dot(Th.crossVectors(al,Th));if(N<0)return null;const U=B*this.direction.dot(Ad.cross(al));if(U<0||N+U>T)return null;const z=-B*al.dot(gd);return z<0?null:this.at(z/T,b)}applyMatrix4(n){return this.origin.applyMatrix4(n),this.direction.transformDirection(n),this}equals(n){return n.origin.equals(this.origin)&&n.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Kn{constructor(n,s,l,d,b,T,B,N,U,z,X,q,ee,ie,ce,re){Kn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n!==void 0&&this.set(n,s,l,d,b,T,B,N,U,z,X,q,ee,ie,ce,re)}set(n,s,l,d,b,T,B,N,U,z,X,q,ee,ie,ce,re){const te=this.elements;return te[0]=n,te[4]=s,te[8]=l,te[12]=d,te[1]=b,te[5]=T,te[9]=B,te[13]=N,te[2]=U,te[6]=z,te[10]=X,te[14]=q,te[3]=ee,te[7]=ie,te[11]=ce,te[15]=re,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Kn().fromArray(this.elements)}copy(n){const s=this.elements,l=n.elements;return s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],s[4]=l[4],s[5]=l[5],s[6]=l[6],s[7]=l[7],s[8]=l[8],s[9]=l[9],s[10]=l[10],s[11]=l[11],s[12]=l[12],s[13]=l[13],s[14]=l[14],s[15]=l[15],this}copyPosition(n){const s=this.elements,l=n.elements;return s[12]=l[12],s[13]=l[13],s[14]=l[14],this}setFromMatrix3(n){const s=n.elements;return this.set(s[0],s[3],s[6],0,s[1],s[4],s[7],0,s[2],s[5],s[8],0,0,0,0,1),this}extractBasis(n,s,l){return n.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),l.setFromMatrixColumn(this,2),this}makeBasis(n,s,l){return this.set(n.x,s.x,l.x,0,n.y,s.y,l.y,0,n.z,s.z,l.z,0,0,0,0,1),this}extractRotation(n){const s=this.elements,l=n.elements,d=1/Ul.setFromMatrixColumn(n,0).length(),b=1/Ul.setFromMatrixColumn(n,1).length(),T=1/Ul.setFromMatrixColumn(n,2).length();return s[0]=l[0]*d,s[1]=l[1]*d,s[2]=l[2]*d,s[3]=0,s[4]=l[4]*b,s[5]=l[5]*b,s[6]=l[6]*b,s[7]=0,s[8]=l[8]*T,s[9]=l[9]*T,s[10]=l[10]*T,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromEuler(n){const s=this.elements,l=n.x,d=n.y,b=n.z,T=Math.cos(l),B=Math.sin(l),N=Math.cos(d),U=Math.sin(d),z=Math.cos(b),X=Math.sin(b);if(n.order==="XYZ"){const q=T*z,ee=T*X,ie=B*z,ce=B*X;s[0]=N*z,s[4]=-N*X,s[8]=U,s[1]=ee+ie*U,s[5]=q-ce*U,s[9]=-B*N,s[2]=ce-q*U,s[6]=ie+ee*U,s[10]=T*N}else if(n.order==="YXZ"){const q=N*z,ee=N*X,ie=U*z,ce=U*X;s[0]=q+ce*B,s[4]=ie*B-ee,s[8]=T*U,s[1]=T*X,s[5]=T*z,s[9]=-B,s[2]=ee*B-ie,s[6]=ce+q*B,s[10]=T*N}else if(n.order==="ZXY"){const q=N*z,ee=N*X,ie=U*z,ce=U*X;s[0]=q-ce*B,s[4]=-T*X,s[8]=ie+ee*B,s[1]=ee+ie*B,s[5]=T*z,s[9]=ce-q*B,s[2]=-T*U,s[6]=B,s[10]=T*N}else if(n.order==="ZYX"){const q=T*z,ee=T*X,ie=B*z,ce=B*X;s[0]=N*z,s[4]=ie*U-ee,s[8]=q*U+ce,s[1]=N*X,s[5]=ce*U+q,s[9]=ee*U-ie,s[2]=-U,s[6]=B*N,s[10]=T*N}else if(n.order==="YZX"){const q=T*N,ee=T*U,ie=B*N,ce=B*U;s[0]=N*z,s[4]=ce-q*X,s[8]=ie*X+ee,s[1]=X,s[5]=T*z,s[9]=-B*z,s[2]=-U*z,s[6]=ee*X+ie,s[10]=q-ce*X}else if(n.order==="XZY"){const q=T*N,ee=T*U,ie=B*N,ce=B*U;s[0]=N*z,s[4]=-X,s[8]=U*z,s[1]=q*X+ce,s[5]=T*z,s[9]=ee*X-ie,s[2]=ie*X-ee,s[6]=B*z,s[10]=ce*X+q}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromQuaternion(n){return this.compose(uD,n,hD)}lookAt(n,s,l){const d=this.elements;return ea.subVectors(n,s),ea.lengthSq()===0&&(ea.z=1),ea.normalize(),Mc.crossVectors(l,ea),Mc.lengthSq()===0&&(Math.abs(l.z)===1?ea.x+=1e-4:ea.z+=1e-4,ea.normalize(),Mc.crossVectors(l,ea)),Mc.normalize(),c0.crossVectors(ea,Mc),d[0]=Mc.x,d[4]=c0.x,d[8]=ea.x,d[1]=Mc.y,d[5]=c0.y,d[9]=ea.y,d[2]=Mc.z,d[6]=c0.z,d[10]=ea.z,this}multiply(n){return this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,s){const l=n.elements,d=s.elements,b=this.elements,T=l[0],B=l[4],N=l[8],U=l[12],z=l[1],X=l[5],q=l[9],ee=l[13],ie=l[2],ce=l[6],re=l[10],te=l[14],we=l[3],ve=l[7],Ae=l[11],qe=l[15],Ve=d[0],ze=d[4],Ke=d[8],De=d[12],Ie=d[1],Ye=d[5],at=d[9],tt=d[13],ut=d[2],wt=d[6],Yt=d[10],_n=d[14],Mt=d[3],mn=d[7],vn=d[11],Xn=d[15];return b[0]=T*Ve+B*Ie+N*ut+U*Mt,b[4]=T*ze+B*Ye+N*wt+U*mn,b[8]=T*Ke+B*at+N*Yt+U*vn,b[12]=T*De+B*tt+N*_n+U*Xn,b[1]=z*Ve+X*Ie+q*ut+ee*Mt,b[5]=z*ze+X*Ye+q*wt+ee*mn,b[9]=z*Ke+X*at+q*Yt+ee*vn,b[13]=z*De+X*tt+q*_n+ee*Xn,b[2]=ie*Ve+ce*Ie+re*ut+te*Mt,b[6]=ie*ze+ce*Ye+re*wt+te*mn,b[10]=ie*Ke+ce*at+re*Yt+te*vn,b[14]=ie*De+ce*tt+re*_n+te*Xn,b[3]=we*Ve+ve*Ie+Ae*ut+qe*Mt,b[7]=we*ze+ve*Ye+Ae*wt+qe*mn,b[11]=we*Ke+ve*at+Ae*Yt+qe*vn,b[15]=we*De+ve*tt+Ae*_n+qe*Xn,this}multiplyScalar(n){const s=this.elements;return s[0]*=n,s[4]*=n,s[8]*=n,s[12]*=n,s[1]*=n,s[5]*=n,s[9]*=n,s[13]*=n,s[2]*=n,s[6]*=n,s[10]*=n,s[14]*=n,s[3]*=n,s[7]*=n,s[11]*=n,s[15]*=n,this}determinant(){const n=this.elements,s=n[0],l=n[4],d=n[8],b=n[12],T=n[1],B=n[5],N=n[9],U=n[13],z=n[2],X=n[6],q=n[10],ee=n[14],ie=n[3],ce=n[7],re=n[11],te=n[15];return ie*(+b*N*X-d*U*X-b*B*q+l*U*q+d*B*ee-l*N*ee)+ce*(+s*N*ee-s*U*q+b*T*q-d*T*ee+d*U*z-b*N*z)+re*(+s*U*X-s*B*ee-b*T*X+l*T*ee+b*B*z-l*U*z)+te*(-d*B*z-s*N*X+s*B*q+d*T*X-l*T*q+l*N*z)}transpose(){const n=this.elements;let s;return s=n[1],n[1]=n[4],n[4]=s,s=n[2],n[2]=n[8],n[8]=s,s=n[6],n[6]=n[9],n[9]=s,s=n[3],n[3]=n[12],n[12]=s,s=n[7],n[7]=n[13],n[13]=s,s=n[11],n[11]=n[14],n[14]=s,this}setPosition(n,s,l){const d=this.elements;return n.isVector3?(d[12]=n.x,d[13]=n.y,d[14]=n.z):(d[12]=n,d[13]=s,d[14]=l),this}invert(){const n=this.elements,s=n[0],l=n[1],d=n[2],b=n[3],T=n[4],B=n[5],N=n[6],U=n[7],z=n[8],X=n[9],q=n[10],ee=n[11],ie=n[12],ce=n[13],re=n[14],te=n[15],we=X*re*U-ce*q*U+ce*N*ee-B*re*ee-X*N*te+B*q*te,ve=ie*q*U-z*re*U-ie*N*ee+T*re*ee+z*N*te-T*q*te,Ae=z*ce*U-ie*X*U+ie*B*ee-T*ce*ee-z*B*te+T*X*te,qe=ie*X*N-z*ce*N-ie*B*q+T*ce*q+z*B*re-T*X*re,Ve=s*we+l*ve+d*Ae+b*qe;if(Ve===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ze=1/Ve;return n[0]=we*ze,n[1]=(ce*q*b-X*re*b-ce*d*ee+l*re*ee+X*d*te-l*q*te)*ze,n[2]=(B*re*b-ce*N*b+ce*d*U-l*re*U-B*d*te+l*N*te)*ze,n[3]=(X*N*b-B*q*b-X*d*U+l*q*U+B*d*ee-l*N*ee)*ze,n[4]=ve*ze,n[5]=(z*re*b-ie*q*b+ie*d*ee-s*re*ee-z*d*te+s*q*te)*ze,n[6]=(ie*N*b-T*re*b-ie*d*U+s*re*U+T*d*te-s*N*te)*ze,n[7]=(T*q*b-z*N*b+z*d*U-s*q*U-T*d*ee+s*N*ee)*ze,n[8]=Ae*ze,n[9]=(ie*X*b-z*ce*b-ie*l*ee+s*ce*ee+z*l*te-s*X*te)*ze,n[10]=(T*ce*b-ie*B*b+ie*l*U-s*ce*U-T*l*te+s*B*te)*ze,n[11]=(z*B*b-T*X*b-z*l*U+s*X*U+T*l*ee-s*B*ee)*ze,n[12]=qe*ze,n[13]=(z*ce*d-ie*X*d+ie*l*q-s*ce*q-z*l*re+s*X*re)*ze,n[14]=(ie*B*d-T*ce*d-ie*l*N+s*ce*N+T*l*re-s*B*re)*ze,n[15]=(T*X*d-z*B*d+z*l*N-s*X*N-T*l*q+s*B*q)*ze,this}scale(n){const s=this.elements,l=n.x,d=n.y,b=n.z;return s[0]*=l,s[4]*=d,s[8]*=b,s[1]*=l,s[5]*=d,s[9]*=b,s[2]*=l,s[6]*=d,s[10]*=b,s[3]*=l,s[7]*=d,s[11]*=b,this}getMaxScaleOnAxis(){const n=this.elements,s=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],l=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],d=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(s,l,d))}makeTranslation(n,s,l){return n.isVector3?this.set(1,0,0,n.x,0,1,0,n.y,0,0,1,n.z,0,0,0,1):this.set(1,0,0,n,0,1,0,s,0,0,1,l,0,0,0,1),this}makeRotationX(n){const s=Math.cos(n),l=Math.sin(n);return this.set(1,0,0,0,0,s,-l,0,0,l,s,0,0,0,0,1),this}makeRotationY(n){const s=Math.cos(n),l=Math.sin(n);return this.set(s,0,l,0,0,1,0,0,-l,0,s,0,0,0,0,1),this}makeRotationZ(n){const s=Math.cos(n),l=Math.sin(n);return this.set(s,-l,0,0,l,s,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(n,s){const l=Math.cos(s),d=Math.sin(s),b=1-l,T=n.x,B=n.y,N=n.z,U=b*T,z=b*B;return this.set(U*T+l,U*B-d*N,U*N+d*B,0,U*B+d*N,z*B+l,z*N-d*T,0,U*N-d*B,z*N+d*T,b*N*N+l,0,0,0,0,1),this}makeScale(n,s,l){return this.set(n,0,0,0,0,s,0,0,0,0,l,0,0,0,0,1),this}makeShear(n,s,l,d,b,T){return this.set(1,l,b,0,n,1,T,0,s,d,1,0,0,0,0,1),this}compose(n,s,l){const d=this.elements,b=s._x,T=s._y,B=s._z,N=s._w,U=b+b,z=T+T,X=B+B,q=b*U,ee=b*z,ie=b*X,ce=T*z,re=T*X,te=B*X,we=N*U,ve=N*z,Ae=N*X,qe=l.x,Ve=l.y,ze=l.z;return d[0]=(1-(ce+te))*qe,d[1]=(ee+Ae)*qe,d[2]=(ie-ve)*qe,d[3]=0,d[4]=(ee-Ae)*Ve,d[5]=(1-(q+te))*Ve,d[6]=(re+we)*Ve,d[7]=0,d[8]=(ie+ve)*ze,d[9]=(re-we)*ze,d[10]=(1-(q+ce))*ze,d[11]=0,d[12]=n.x,d[13]=n.y,d[14]=n.z,d[15]=1,this}decompose(n,s,l){const d=this.elements;let b=Ul.set(d[0],d[1],d[2]).length();const T=Ul.set(d[4],d[5],d[6]).length(),B=Ul.set(d[8],d[9],d[10]).length();this.determinant()<0&&(b=-b),n.x=d[12],n.y=d[13],n.z=d[14],Oo.copy(this);const U=1/b,z=1/T,X=1/B;return Oo.elements[0]*=U,Oo.elements[1]*=U,Oo.elements[2]*=U,Oo.elements[4]*=z,Oo.elements[5]*=z,Oo.elements[6]*=z,Oo.elements[8]*=X,Oo.elements[9]*=X,Oo.elements[10]*=X,s.setFromRotationMatrix(Oo),l.x=b,l.y=T,l.z=B,this}makePerspective(n,s,l,d,b,T,B=ma){const N=this.elements,U=2*b/(s-n),z=2*b/(l-d),X=(s+n)/(s-n),q=(l+d)/(l-d);let ee,ie;if(B===ma)ee=-(T+b)/(T-b),ie=-2*T*b/(T-b);else if(B===pu)ee=-T/(T-b),ie=-T*b/(T-b);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+B);return N[0]=U,N[4]=0,N[8]=X,N[12]=0,N[1]=0,N[5]=z,N[9]=q,N[13]=0,N[2]=0,N[6]=0,N[10]=ee,N[14]=ie,N[3]=0,N[7]=0,N[11]=-1,N[15]=0,this}makeOrthographic(n,s,l,d,b,T,B=ma){const N=this.elements,U=1/(s-n),z=1/(l-d),X=1/(T-b),q=(s+n)*U,ee=(l+d)*z;let ie,ce;if(B===ma)ie=(T+b)*X,ce=-2*X;else if(B===pu)ie=b*X,ce=-1*X;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+B);return N[0]=2*U,N[4]=0,N[8]=0,N[12]=-q,N[1]=0,N[5]=2*z,N[9]=0,N[13]=-ee,N[2]=0,N[6]=0,N[10]=ce,N[14]=-ie,N[3]=0,N[7]=0,N[11]=0,N[15]=1,this}equals(n){const s=this.elements,l=n.elements;for(let d=0;d<16;d++)if(s[d]!==l[d])return!1;return!0}fromArray(n,s=0){for(let l=0;l<16;l++)this.elements[l]=n[l+s];return this}toArray(n=[],s=0){const l=this.elements;return n[s]=l[0],n[s+1]=l[1],n[s+2]=l[2],n[s+3]=l[3],n[s+4]=l[4],n[s+5]=l[5],n[s+6]=l[6],n[s+7]=l[7],n[s+8]=l[8],n[s+9]=l[9],n[s+10]=l[10],n[s+11]=l[11],n[s+12]=l[12],n[s+13]=l[13],n[s+14]=l[14],n[s+15]=l[15],n}}const Ul=new Ge,Oo=new Kn,uD=new Ge(0,0,0),hD=new Ge(1,1,1),Mc=new Ge,c0=new Ge,ea=new Ge,$w=new Kn,Xw=new ur;class ta{constructor(n=0,s=0,l=0,d=ta.DEFAULT_ORDER){this.isEuler=!0,this._x=n,this._y=s,this._z=l,this._order=d}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get order(){return this._order}set order(n){this._order=n,this._onChangeCallback()}set(n,s,l,d=this._order){return this._x=n,this._y=s,this._z=l,this._order=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(n){return this._x=n._x,this._y=n._y,this._z=n._z,this._order=n._order,this._onChangeCallback(),this}setFromRotationMatrix(n,s=this._order,l=!0){const d=n.elements,b=d[0],T=d[4],B=d[8],N=d[1],U=d[5],z=d[9],X=d[2],q=d[6],ee=d[10];switch(s){case"XYZ":this._y=Math.asin(Kr(B,-1,1)),Math.abs(B)<.9999999?(this._x=Math.atan2(-z,ee),this._z=Math.atan2(-T,b)):(this._x=Math.atan2(q,U),this._z=0);break;case"YXZ":this._x=Math.asin(-Kr(z,-1,1)),Math.abs(z)<.9999999?(this._y=Math.atan2(B,ee),this._z=Math.atan2(N,U)):(this._y=Math.atan2(-X,b),this._z=0);break;case"ZXY":this._x=Math.asin(Kr(q,-1,1)),Math.abs(q)<.9999999?(this._y=Math.atan2(-X,ee),this._z=Math.atan2(-T,U)):(this._y=0,this._z=Math.atan2(N,b));break;case"ZYX":this._y=Math.asin(-Kr(X,-1,1)),Math.abs(X)<.9999999?(this._x=Math.atan2(q,ee),this._z=Math.atan2(N,b)):(this._x=0,this._z=Math.atan2(-T,U));break;case"YZX":this._z=Math.asin(Kr(N,-1,1)),Math.abs(N)<.9999999?(this._x=Math.atan2(-z,U),this._y=Math.atan2(-X,b)):(this._x=0,this._y=Math.atan2(B,ee));break;case"XZY":this._z=Math.asin(-Kr(T,-1,1)),Math.abs(T)<.9999999?(this._x=Math.atan2(q,U),this._y=Math.atan2(B,b)):(this._x=Math.atan2(-z,ee),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,l===!0&&this._onChangeCallback(),this}setFromQuaternion(n,s,l){return $w.makeRotationFromQuaternion(n),this.setFromRotationMatrix($w,s,l)}setFromVector3(n,s=this._order){return this.set(n.x,n.y,n.z,s)}reorder(n){return Xw.setFromEuler(this),this.setFromQuaternion(Xw,n)}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._order===this._order}fromArray(n){return this._x=n[0],this._y=n[1],this._z=n[2],n[3]!==void 0&&(this._order=n[3]),this._onChangeCallback(),this}toArray(n=[],s=0){return n[s]=this._x,n[s+1]=this._y,n[s+2]=this._z,n[s+3]=this._order,n}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ta.DEFAULT_ORDER="XYZ";class u0{constructor(){this.mask=1}set(n){this.mask=(1<<n|0)>>>0}enable(n){this.mask|=1<<n|0}enableAll(){this.mask=-1}toggle(n){this.mask^=1<<n|0}disable(n){this.mask&=~(1<<n|0)}disableAll(){this.mask=0}test(n){return(this.mask&n.mask)!==0}isEnabled(n){return(this.mask&(1<<n|0))!==0}}let fD=0;const Kw=new Ge,Ih=new ur,Gl=new Kn,h0=new Ge,vd=new Ge,dD=new Ge,pD=new ur,Yw=new Ge(1,0,0),qw=new Ge(0,1,0),Jw=new Ge(0,0,1),Zw={type:"added"},mD={type:"removed"},Bh={type:"childadded",child:null},Yv={type:"childremoved",child:null};class hr extends vo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:fD++}),this.uuid=bo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=hr.DEFAULT_UP.clone();const n=new Ge,s=new ta,l=new ur,d=new Ge(1,1,1);function b(){l.setFromEuler(s,!1)}function T(){s.setFromQuaternion(l,void 0,!1)}s._onChange(b),l._onChange(T),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:l},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new Kn},normalMatrix:{value:new _i}}),this.matrix=new Kn,this.matrixWorld=new Kn,this.matrixAutoUpdate=hr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=hr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new u0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(n){return this.quaternion.premultiply(n),this}setRotationFromAxisAngle(n,s){this.quaternion.setFromAxisAngle(n,s)}setRotationFromEuler(n){this.quaternion.setFromEuler(n,!0)}setRotationFromMatrix(n){this.quaternion.setFromRotationMatrix(n)}setRotationFromQuaternion(n){this.quaternion.copy(n)}rotateOnAxis(n,s){return Ih.setFromAxisAngle(n,s),this.quaternion.multiply(Ih),this}rotateOnWorldAxis(n,s){return Ih.setFromAxisAngle(n,s),this.quaternion.premultiply(Ih),this}rotateX(n){return this.rotateOnAxis(Yw,n)}rotateY(n){return this.rotateOnAxis(qw,n)}rotateZ(n){return this.rotateOnAxis(Jw,n)}translateOnAxis(n,s){return Kw.copy(n).applyQuaternion(this.quaternion),this.position.add(Kw.multiplyScalar(s)),this}translateX(n){return this.translateOnAxis(Yw,n)}translateY(n){return this.translateOnAxis(qw,n)}translateZ(n){return this.translateOnAxis(Jw,n)}localToWorld(n){return this.updateWorldMatrix(!0,!1),n.applyMatrix4(this.matrixWorld)}worldToLocal(n){return this.updateWorldMatrix(!0,!1),n.applyMatrix4(Gl.copy(this.matrixWorld).invert())}lookAt(n,s,l){n.isVector3?h0.copy(n):h0.set(n,s,l);const d=this.parent;this.updateWorldMatrix(!0,!1),vd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gl.lookAt(vd,h0,this.up):Gl.lookAt(h0,vd,this.up),this.quaternion.setFromRotationMatrix(Gl),d&&(Gl.extractRotation(d.matrixWorld),Ih.setFromRotationMatrix(Gl),this.quaternion.premultiply(Ih.invert()))}add(n){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(n.removeFromParent(),n.parent=this,this.children.push(n),n.dispatchEvent(Zw),Bh.child=n,this.dispatchEvent(Bh),Bh.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)}remove(n){if(arguments.length>1){for(let l=0;l<arguments.length;l++)this.remove(arguments[l]);return this}const s=this.children.indexOf(n);return s!==-1&&(n.parent=null,this.children.splice(s,1),n.dispatchEvent(mD),Yv.child=n,this.dispatchEvent(Yv),Yv.child=null),this}removeFromParent(){const n=this.parent;return n!==null&&n.remove(this),this}clear(){return this.remove(...this.children)}attach(n){return this.updateWorldMatrix(!0,!1),Gl.copy(this.matrixWorld).invert(),n.parent!==null&&(n.parent.updateWorldMatrix(!0,!1),Gl.multiply(n.parent.matrixWorld)),n.applyMatrix4(Gl),n.removeFromParent(),n.parent=this,this.children.push(n),n.updateWorldMatrix(!1,!0),n.dispatchEvent(Zw),Bh.child=n,this.dispatchEvent(Bh),Bh.child=null,this}getObjectById(n){return this.getObjectByProperty("id",n)}getObjectByName(n){return this.getObjectByProperty("name",n)}getObjectByProperty(n,s){if(this[n]===s)return this;for(let l=0,d=this.children.length;l<d;l++){const T=this.children[l].getObjectByProperty(n,s);if(T!==void 0)return T}}getObjectsByProperty(n,s,l=[]){this[n]===s&&l.push(this);const d=this.children;for(let b=0,T=d.length;b<T;b++)d[b].getObjectsByProperty(n,s,l);return l}getWorldPosition(n){return this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vd,n,dD),n}getWorldScale(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vd,pD,n),n}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return n.set(s[8],s[9],s[10]).normalize()}raycast(){}traverse(n){n(this);const s=this.children;for(let l=0,d=s.length;l<d;l++)s[l].traverse(n)}traverseVisible(n){if(this.visible===!1)return;n(this);const s=this.children;for(let l=0,d=s.length;l<d;l++)s[l].traverseVisible(n)}traverseAncestors(n){const s=this.parent;s!==null&&(n(s),s.traverseAncestors(n))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);const s=this.children;for(let l=0,d=s.length;l<d;l++){const b=s[l];(b.matrixWorldAutoUpdate===!0||n===!0)&&b.updateMatrixWorld(n)}}updateWorldMatrix(n,s){const l=this.parent;if(n===!0&&l!==null&&l.matrixWorldAutoUpdate===!0&&l.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),s===!0){const d=this.children;for(let b=0,T=d.length;b<T;b++){const B=d[b];B.matrixWorldAutoUpdate===!0&&B.updateWorldMatrix(!1,!0)}}}toJSON(n){const s=n===void 0||typeof n=="string",l={};s&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},l.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const d={};d.uuid=this.uuid,d.type=this.type,this.name!==""&&(d.name=this.name),this.castShadow===!0&&(d.castShadow=!0),this.receiveShadow===!0&&(d.receiveShadow=!0),this.visible===!1&&(d.visible=!1),this.frustumCulled===!1&&(d.frustumCulled=!1),this.renderOrder!==0&&(d.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(d.userData=this.userData),d.layers=this.layers.mask,d.matrix=this.matrix.toArray(),d.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(d.matrixAutoUpdate=!1),this.isInstancedMesh&&(d.type="InstancedMesh",d.count=this.count,d.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(d.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(d.type="BatchedMesh",d.perObjectFrustumCulled=this.perObjectFrustumCulled,d.sortObjects=this.sortObjects,d.drawRanges=this._drawRanges,d.reservedRanges=this._reservedRanges,d.visibility=this._visibility,d.active=this._active,d.bounds=this._bounds.map(B=>({boxInitialized:B.boxInitialized,boxMin:B.box.min.toArray(),boxMax:B.box.max.toArray(),sphereInitialized:B.sphereInitialized,sphereRadius:B.sphere.radius,sphereCenter:B.sphere.center.toArray()})),d.maxGeometryCount=this._maxGeometryCount,d.maxVertexCount=this._maxVertexCount,d.maxIndexCount=this._maxIndexCount,d.geometryInitialized=this._geometryInitialized,d.geometryCount=this._geometryCount,d.matricesTexture=this._matricesTexture.toJSON(n),this.boundingSphere!==null&&(d.boundingSphere={center:d.boundingSphere.center.toArray(),radius:d.boundingSphere.radius}),this.boundingBox!==null&&(d.boundingBox={min:d.boundingBox.min.toArray(),max:d.boundingBox.max.toArray()}));function b(B,N){return B[N.uuid]===void 0&&(B[N.uuid]=N.toJSON(n)),N.uuid}if(this.isScene)this.background&&(this.background.isColor?d.background=this.background.toJSON():this.background.isTexture&&(d.background=this.background.toJSON(n).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(d.environment=this.environment.toJSON(n).uuid);else if(this.isMesh||this.isLine||this.isPoints){d.geometry=b(n.geometries,this.geometry);const B=this.geometry.parameters;if(B!==void 0&&B.shapes!==void 0){const N=B.shapes;if(Array.isArray(N))for(let U=0,z=N.length;U<z;U++){const X=N[U];b(n.shapes,X)}else b(n.shapes,N)}}if(this.isSkinnedMesh&&(d.bindMode=this.bindMode,d.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(b(n.skeletons,this.skeleton),d.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const B=[];for(let N=0,U=this.material.length;N<U;N++)B.push(b(n.materials,this.material[N]));d.material=B}else d.material=b(n.materials,this.material);if(this.children.length>0){d.children=[];for(let B=0;B<this.children.length;B++)d.children.push(this.children[B].toJSON(n).object)}if(this.animations.length>0){d.animations=[];for(let B=0;B<this.animations.length;B++){const N=this.animations[B];d.animations.push(b(n.animations,N))}}if(s){const B=T(n.geometries),N=T(n.materials),U=T(n.textures),z=T(n.images),X=T(n.shapes),q=T(n.skeletons),ee=T(n.animations),ie=T(n.nodes);B.length>0&&(l.geometries=B),N.length>0&&(l.materials=N),U.length>0&&(l.textures=U),z.length>0&&(l.images=z),X.length>0&&(l.shapes=X),q.length>0&&(l.skeletons=q),ee.length>0&&(l.animations=ee),ie.length>0&&(l.nodes=ie)}return l.object=d,l;function T(B){const N=[];for(const U in B){const z=B[U];delete z.metadata,N.push(z)}return N}}clone(n){return new this.constructor().copy(this,n)}copy(n,s=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldAutoUpdate=n.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.animations=n.animations.slice(),this.userData=JSON.parse(JSON.stringify(n.userData)),s===!0)for(let l=0;l<n.children.length;l++){const d=n.children[l];this.add(d.clone())}return this}}hr.DEFAULT_UP=new Ge(0,1,0),hr.DEFAULT_MATRIX_AUTO_UPDATE=!0,hr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Oa=new Ge,Vl=new Ge,qv=new Ge,Ql=new Ge,Rh=new Ge,Lh=new Ge,eC=new Ge,Jv=new Ge,Zv=new Ge,eb=new Ge;class na{constructor(n=new Ge,s=new Ge,l=new Ge){this.a=n,this.b=s,this.c=l}static getNormal(n,s,l,d){d.subVectors(l,s),Oa.subVectors(n,s),d.cross(Oa);const b=d.lengthSq();return b>0?d.multiplyScalar(1/Math.sqrt(b)):d.set(0,0,0)}static getBarycoord(n,s,l,d,b){Oa.subVectors(d,s),Vl.subVectors(l,s),qv.subVectors(n,s);const T=Oa.dot(Oa),B=Oa.dot(Vl),N=Oa.dot(qv),U=Vl.dot(Vl),z=Vl.dot(qv),X=T*U-B*B;if(X===0)return b.set(0,0,0),null;const q=1/X,ee=(U*N-B*z)*q,ie=(T*z-B*N)*q;return b.set(1-ee-ie,ie,ee)}static containsPoint(n,s,l,d){return this.getBarycoord(n,s,l,d,Ql)===null?!1:Ql.x>=0&&Ql.y>=0&&Ql.x+Ql.y<=1}static getInterpolation(n,s,l,d,b,T,B,N){return this.getBarycoord(n,s,l,d,Ql)===null?(N.x=0,N.y=0,"z"in N&&(N.z=0),"w"in N&&(N.w=0),null):(N.setScalar(0),N.addScaledVector(b,Ql.x),N.addScaledVector(T,Ql.y),N.addScaledVector(B,Ql.z),N)}static isFrontFacing(n,s,l,d){return Oa.subVectors(l,s),Vl.subVectors(n,s),Oa.cross(Vl).dot(d)<0}set(n,s,l){return this.a.copy(n),this.b.copy(s),this.c.copy(l),this}setFromPointsAndIndices(n,s,l,d){return this.a.copy(n[s]),this.b.copy(n[l]),this.c.copy(n[d]),this}setFromAttributeAndIndices(n,s,l,d){return this.a.fromBufferAttribute(n,s),this.b.fromBufferAttribute(n,l),this.c.fromBufferAttribute(n,d),this}clone(){return new this.constructor().copy(this)}copy(n){return this.a.copy(n.a),this.b.copy(n.b),this.c.copy(n.c),this}getArea(){return Oa.subVectors(this.c,this.b),Vl.subVectors(this.a,this.b),Oa.cross(Vl).length()*.5}getMidpoint(n){return n.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(n){return na.getNormal(this.a,this.b,this.c,n)}getPlane(n){return n.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(n,s){return na.getBarycoord(n,this.a,this.b,this.c,s)}getInterpolation(n,s,l,d,b){return na.getInterpolation(n,this.a,this.b,this.c,s,l,d,b)}containsPoint(n){return na.containsPoint(n,this.a,this.b,this.c)}isFrontFacing(n){return na.isFrontFacing(this.a,this.b,this.c,n)}intersectsBox(n){return n.intersectsTriangle(this)}closestPointToPoint(n,s){const l=this.a,d=this.b,b=this.c;let T,B;Rh.subVectors(d,l),Lh.subVectors(b,l),Jv.subVectors(n,l);const N=Rh.dot(Jv),U=Lh.dot(Jv);if(N<=0&&U<=0)return s.copy(l);Zv.subVectors(n,d);const z=Rh.dot(Zv),X=Lh.dot(Zv);if(z>=0&&X<=z)return s.copy(d);const q=N*X-z*U;if(q<=0&&N>=0&&z<=0)return T=N/(N-z),s.copy(l).addScaledVector(Rh,T);eb.subVectors(n,b);const ee=Rh.dot(eb),ie=Lh.dot(eb);if(ie>=0&&ee<=ie)return s.copy(b);const ce=ee*U-N*ie;if(ce<=0&&U>=0&&ie<=0)return B=U/(U-ie),s.copy(l).addScaledVector(Lh,B);const re=z*ie-ee*X;if(re<=0&&X-z>=0&&ee-ie>=0)return eC.subVectors(b,d),B=(X-z)/(X-z+(ee-ie)),s.copy(d).addScaledVector(eC,B);const te=1/(re+ce+q);return T=ce*te,B=q*te,s.copy(l).addScaledVector(Rh,T).addScaledVector(Lh,B)}equals(n){return n.a.equals(this.a)&&n.b.equals(this.b)&&n.c.equals(this.c)}}const tC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Sc={h:0,s:0,l:0},f0={h:0,s:0,l:0};function tb(_,n,s){return s<0&&(s+=1),s>1&&(s-=1),s<.16666666666666666?_+(n-_)*6*s:s<.5?n:s<.6666666666666666?_+(n-_)*6*(.6666666666666666-s):_}class Qn{constructor(n,s,l){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(n,s,l)}set(n,s,l){if(s===void 0&&l===void 0){const d=n;d&&d.isColor?this.copy(d):typeof d=="number"?this.setHex(d):typeof d=="string"&&this.setStyle(d)}else this.setRGB(n,s,l);return this}setScalar(n){return this.r=n,this.g=n,this.b=n,this}setHex(n,s=rr){return n=Math.floor(n),this.r=(n>>16&255)/255,this.g=(n>>8&255)/255,this.b=(n&255)/255,gr.toWorkingColorSpace(this,s),this}setRGB(n,s,l,d=gr.workingColorSpace){return this.r=n,this.g=s,this.b=l,gr.toWorkingColorSpace(this,d),this}setHSL(n,s,l,d=gr.workingColorSpace){if(n=dd(n,1),s=Kr(s,0,1),l=Kr(l,0,1),s===0)this.r=this.g=this.b=l;else{const b=l<=.5?l*(1+s):l+s-l*s,T=2*l-b;this.r=tb(T,b,n+.3333333333333333),this.g=tb(T,b,n),this.b=tb(T,b,n-.3333333333333333)}return gr.toWorkingColorSpace(this,d),this}setStyle(n,s=rr){function l(b){b!==void 0&&parseFloat(b)<1&&console.warn("THREE.Color: Alpha component of "+n+" will be ignored.")}let d;if(d=/^(\w+)\(([^\)]*)\)/.exec(n)){let b;const T=d[1],B=d[2];switch(T){case"rgb":case"rgba":if(b=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(B))return l(b[4]),this.setRGB(Math.min(255,parseInt(b[1],10))/255,Math.min(255,parseInt(b[2],10))/255,Math.min(255,parseInt(b[3],10))/255,s);if(b=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(B))return l(b[4]),this.setRGB(Math.min(100,parseInt(b[1],10))/100,Math.min(100,parseInt(b[2],10))/100,Math.min(100,parseInt(b[3],10))/100,s);break;case"hsl":case"hsla":if(b=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(B))return l(b[4]),this.setHSL(parseFloat(b[1])/360,parseFloat(b[2])/100,parseFloat(b[3])/100,s);break;default:console.warn("THREE.Color: Unknown color model "+n)}}else if(d=/^\#([A-Fa-f\d]+)$/.exec(n)){const b=d[1],T=b.length;if(T===3)return this.setRGB(parseInt(b.charAt(0),16)/15,parseInt(b.charAt(1),16)/15,parseInt(b.charAt(2),16)/15,s);if(T===6)return this.setHex(parseInt(b,16),s);console.warn("THREE.Color: Invalid hex color "+n)}else if(n&&n.length>0)return this.setColorName(n,s);return this}setColorName(n,s=rr){const l=tC[n.toLowerCase()];return l!==void 0?this.setHex(l,s):console.warn("THREE.Color: Unknown color "+n),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(n){return this.r=n.r,this.g=n.g,this.b=n.b,this}copySRGBToLinear(n){return this.r=wc(n.r),this.g=wc(n.g),this.b=wc(n.b),this}copyLinearToSRGB(n){return this.r=md(n.r),this.g=md(n.g),this.b=md(n.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(n=rr){return gr.fromWorkingColorSpace(oo.copy(this),n),Math.round(Kr(oo.r*255,0,255))*65536+Math.round(Kr(oo.g*255,0,255))*256+Math.round(Kr(oo.b*255,0,255))}getHexString(n=rr){return("000000"+this.getHex(n).toString(16)).slice(-6)}getHSL(n,s=gr.workingColorSpace){gr.fromWorkingColorSpace(oo.copy(this),s);const l=oo.r,d=oo.g,b=oo.b,T=Math.max(l,d,b),B=Math.min(l,d,b);let N,U;const z=(B+T)/2;if(B===T)N=0,U=0;else{const X=T-B;switch(U=z<=.5?X/(T+B):X/(2-T-B),T){case l:N=(d-b)/X+(d<b?6:0);break;case d:N=(b-l)/X+2;break;case b:N=(l-d)/X+4;break}N/=6}return n.h=N,n.s=U,n.l=z,n}getRGB(n,s=gr.workingColorSpace){return gr.fromWorkingColorSpace(oo.copy(this),s),n.r=oo.r,n.g=oo.g,n.b=oo.b,n}getStyle(n=rr){gr.fromWorkingColorSpace(oo.copy(this),n);const s=oo.r,l=oo.g,d=oo.b;return n!==rr?`color(${n} ${s.toFixed(3)} ${l.toFixed(3)} ${d.toFixed(3)})`:`rgb(${Math.round(s*255)},${Math.round(l*255)},${Math.round(d*255)})`}offsetHSL(n,s,l){return this.getHSL(Sc),this.setHSL(Sc.h+n,Sc.s+s,Sc.l+l)}add(n){return this.r+=n.r,this.g+=n.g,this.b+=n.b,this}addColors(n,s){return this.r=n.r+s.r,this.g=n.g+s.g,this.b=n.b+s.b,this}addScalar(n){return this.r+=n,this.g+=n,this.b+=n,this}sub(n){return this.r=Math.max(0,this.r-n.r),this.g=Math.max(0,this.g-n.g),this.b=Math.max(0,this.b-n.b),this}multiply(n){return this.r*=n.r,this.g*=n.g,this.b*=n.b,this}multiplyScalar(n){return this.r*=n,this.g*=n,this.b*=n,this}lerp(n,s){return this.r+=(n.r-this.r)*s,this.g+=(n.g-this.g)*s,this.b+=(n.b-this.b)*s,this}lerpColors(n,s,l){return this.r=n.r+(s.r-n.r)*l,this.g=n.g+(s.g-n.g)*l,this.b=n.b+(s.b-n.b)*l,this}lerpHSL(n,s){this.getHSL(Sc),n.getHSL(f0);const l=mu(Sc.h,f0.h,s),d=mu(Sc.s,f0.s,s),b=mu(Sc.l,f0.l,s);return this.setHSL(l,d,b),this}setFromVector3(n){return this.r=n.x,this.g=n.y,this.b=n.z,this}applyMatrix3(n){const s=this.r,l=this.g,d=this.b,b=n.elements;return this.r=b[0]*s+b[3]*l+b[6]*d,this.g=b[1]*s+b[4]*l+b[7]*d,this.b=b[2]*s+b[5]*l+b[8]*d,this}equals(n){return n.r===this.r&&n.g===this.g&&n.b===this.b}fromArray(n,s=0){return this.r=n[s],this.g=n[s+1],this.b=n[s+2],this}toArray(n=[],s=0){return n[s]=this.r,n[s+1]=this.g,n[s+2]=this.b,n}fromBufferAttribute(n,s){return this.r=n.getX(s),this.g=n.getY(s),this.b=n.getZ(s),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const oo=new Qn;Qn.NAMES=tC;let AD=0;class ao extends vo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:AD++}),this.uuid=bo(),this.name="",this.type="Material",this.blending=k,this.side=S,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=ue,this.blendDst=he,this.blendEquation=V,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Qn(0,0,0),this.blendAlpha=0,this.depthFunc=Ze,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ud,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nl,this.stencilZFail=Nl,this.stencilZPass=Nl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(n){this._alphaTest>0!=n>0&&this.version++,this._alphaTest=n}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(n){if(n!==void 0)for(const s in n){const l=n[s];if(l===void 0){console.warn(`THREE.Material: parameter '${s}' has value of undefined.`);continue}const d=this[s];if(d===void 0){console.warn(`THREE.Material: '${s}' is not a property of THREE.${this.type}.`);continue}d&&d.isColor?d.set(l):d&&d.isVector3&&l&&l.isVector3?d.copy(l):this[s]=l}}toJSON(n){const s=n===void 0||typeof n=="string";s&&(n={textures:{},images:{}});const l={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),this.color&&this.color.isColor&&(l.color=this.color.getHex()),this.roughness!==void 0&&(l.roughness=this.roughness),this.metalness!==void 0&&(l.metalness=this.metalness),this.sheen!==void 0&&(l.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(l.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(l.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(l.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(l.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(l.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(l.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(l.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(l.shininess=this.shininess),this.clearcoat!==void 0&&(l.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(l.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(l.clearcoatMap=this.clearcoatMap.toJSON(n).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(l.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(n).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(l.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(n).uuid,l.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(l.dispersion=this.dispersion),this.iridescence!==void 0&&(l.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(l.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(l.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(l.iridescenceMap=this.iridescenceMap.toJSON(n).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(l.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(n).uuid),this.anisotropy!==void 0&&(l.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(l.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(l.anisotropyMap=this.anisotropyMap.toJSON(n).uuid),this.map&&this.map.isTexture&&(l.map=this.map.toJSON(n).uuid),this.matcap&&this.matcap.isTexture&&(l.matcap=this.matcap.toJSON(n).uuid),this.alphaMap&&this.alphaMap.isTexture&&(l.alphaMap=this.alphaMap.toJSON(n).uuid),this.lightMap&&this.lightMap.isTexture&&(l.lightMap=this.lightMap.toJSON(n).uuid,l.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(l.aoMap=this.aoMap.toJSON(n).uuid,l.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(l.bumpMap=this.bumpMap.toJSON(n).uuid,l.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(l.normalMap=this.normalMap.toJSON(n).uuid,l.normalMapType=this.normalMapType,l.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(l.displacementMap=this.displacementMap.toJSON(n).uuid,l.displacementScale=this.displacementScale,l.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(l.roughnessMap=this.roughnessMap.toJSON(n).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(l.metalnessMap=this.metalnessMap.toJSON(n).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(l.emissiveMap=this.emissiveMap.toJSON(n).uuid),this.specularMap&&this.specularMap.isTexture&&(l.specularMap=this.specularMap.toJSON(n).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(l.specularIntensityMap=this.specularIntensityMap.toJSON(n).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(l.specularColorMap=this.specularColorMap.toJSON(n).uuid),this.envMap&&this.envMap.isTexture&&(l.envMap=this.envMap.toJSON(n).uuid,this.combine!==void 0&&(l.combine=this.combine)),this.envMapRotation!==void 0&&(l.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(l.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(l.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(l.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(l.gradientMap=this.gradientMap.toJSON(n).uuid),this.transmission!==void 0&&(l.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(l.transmissionMap=this.transmissionMap.toJSON(n).uuid),this.thickness!==void 0&&(l.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(l.thicknessMap=this.thicknessMap.toJSON(n).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(l.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(l.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(l.size=this.size),this.shadowSide!==null&&(l.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(l.sizeAttenuation=this.sizeAttenuation),this.blending!==k&&(l.blending=this.blending),this.side!==S&&(l.side=this.side),this.vertexColors===!0&&(l.vertexColors=!0),this.opacity<1&&(l.opacity=this.opacity),this.transparent===!0&&(l.transparent=!0),this.blendSrc!==ue&&(l.blendSrc=this.blendSrc),this.blendDst!==he&&(l.blendDst=this.blendDst),this.blendEquation!==V&&(l.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(l.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(l.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(l.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(l.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(l.blendAlpha=this.blendAlpha),this.depthFunc!==Ze&&(l.depthFunc=this.depthFunc),this.depthTest===!1&&(l.depthTest=this.depthTest),this.depthWrite===!1&&(l.depthWrite=this.depthWrite),this.colorWrite===!1&&(l.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(l.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==ud&&(l.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(l.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(l.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Nl&&(l.stencilFail=this.stencilFail),this.stencilZFail!==Nl&&(l.stencilZFail=this.stencilZFail),this.stencilZPass!==Nl&&(l.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(l.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(l.rotation=this.rotation),this.polygonOffset===!0&&(l.polygonOffset=!0),this.polygonOffsetFactor!==0&&(l.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(l.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(l.linewidth=this.linewidth),this.dashSize!==void 0&&(l.dashSize=this.dashSize),this.gapSize!==void 0&&(l.gapSize=this.gapSize),this.scale!==void 0&&(l.scale=this.scale),this.dithering===!0&&(l.dithering=!0),this.alphaTest>0&&(l.alphaTest=this.alphaTest),this.alphaHash===!0&&(l.alphaHash=!0),this.alphaToCoverage===!0&&(l.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(l.premultipliedAlpha=!0),this.forceSinglePass===!0&&(l.forceSinglePass=!0),this.wireframe===!0&&(l.wireframe=!0),this.wireframeLinewidth>1&&(l.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(l.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(l.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(l.flatShading=!0),this.visible===!1&&(l.visible=!1),this.toneMapped===!1&&(l.toneMapped=!1),this.fog===!1&&(l.fog=!1),Object.keys(this.userData).length>0&&(l.userData=this.userData);function d(b){const T=[];for(const B in b){const N=b[B];delete N.metadata,T.push(N)}return T}if(s){const b=d(n.textures),T=d(n.images);b.length>0&&(l.textures=b),T.length>0&&(l.images=T)}return l}clone(){return new this.constructor().copy(this)}copy(n){this.name=n.name,this.blending=n.blending,this.side=n.side,this.vertexColors=n.vertexColors,this.opacity=n.opacity,this.transparent=n.transparent,this.blendSrc=n.blendSrc,this.blendDst=n.blendDst,this.blendEquation=n.blendEquation,this.blendSrcAlpha=n.blendSrcAlpha,this.blendDstAlpha=n.blendDstAlpha,this.blendEquationAlpha=n.blendEquationAlpha,this.blendColor.copy(n.blendColor),this.blendAlpha=n.blendAlpha,this.depthFunc=n.depthFunc,this.depthTest=n.depthTest,this.depthWrite=n.depthWrite,this.stencilWriteMask=n.stencilWriteMask,this.stencilFunc=n.stencilFunc,this.stencilRef=n.stencilRef,this.stencilFuncMask=n.stencilFuncMask,this.stencilFail=n.stencilFail,this.stencilZFail=n.stencilZFail,this.stencilZPass=n.stencilZPass,this.stencilWrite=n.stencilWrite;const s=n.clippingPlanes;let l=null;if(s!==null){const d=s.length;l=new Array(d);for(let b=0;b!==d;++b)l[b]=s[b].clone()}return this.clippingPlanes=l,this.clipIntersection=n.clipIntersection,this.clipShadows=n.clipShadows,this.shadowSide=n.shadowSide,this.colorWrite=n.colorWrite,this.precision=n.precision,this.polygonOffset=n.polygonOffset,this.polygonOffsetFactor=n.polygonOffsetFactor,this.polygonOffsetUnits=n.polygonOffsetUnits,this.dithering=n.dithering,this.alphaTest=n.alphaTest,this.alphaHash=n.alphaHash,this.alphaToCoverage=n.alphaToCoverage,this.premultipliedAlpha=n.premultipliedAlpha,this.forceSinglePass=n.forceSinglePass,this.visible=n.visible,this.toneMapped=n.toneMapped,this.userData=JSON.parse(JSON.stringify(n.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(n){n===!0&&this.version++}}class Tc extends ao{constructor(n){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ta,this.combine=Tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapRotation.copy(n.envMapRotation),this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.fog=n.fog,this}}const Hl=gD();function gD(){const _=new ArrayBuffer(4),n=new Float32Array(_),s=new Uint32Array(_),l=new Uint32Array(512),d=new Uint32Array(512);for(let N=0;N<256;++N){const U=N-127;U<-27?(l[N]=0,l[N|256]=32768,d[N]=24,d[N|256]=24):U<-14?(l[N]=1024>>-U-14,l[N|256]=1024>>-U-14|32768,d[N]=-U-1,d[N|256]=-U-1):U<=15?(l[N]=U+15<<10,l[N|256]=U+15<<10|32768,d[N]=13,d[N|256]=13):U<128?(l[N]=31744,l[N|256]=64512,d[N]=24,d[N|256]=24):(l[N]=31744,l[N|256]=64512,d[N]=13,d[N|256]=13)}const b=new Uint32Array(2048),T=new Uint32Array(64),B=new Uint32Array(64);for(let N=1;N<1024;++N){let U=N<<13,z=0;for(;!(U&8388608);)U<<=1,z-=8388608;U&=-8388609,z+=947912704,b[N]=U|z}for(let N=1024;N<2048;++N)b[N]=939524096+(N-1024<<13);for(let N=1;N<31;++N)T[N]=N<<23;T[31]=1199570944,T[32]=2147483648;for(let N=33;N<63;++N)T[N]=2147483648+(N-32<<23);T[63]=3347054592;for(let N=1;N<64;++N)N!==32&&(B[N]=1024);return{floatView:n,uint32View:s,baseTable:l,shiftTable:d,mantissaTable:b,exponentTable:T,offsetTable:B}}function Fo(_){Math.abs(_)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),_=Kr(_,-65504,65504),Hl.floatView[0]=_;const n=Hl.uint32View[0],s=n>>23&511;return Hl.baseTable[s]+((n&8388607)>>Hl.shiftTable[s])}function bd(_){const n=_>>10;return Hl.uint32View[0]=Hl.mantissaTable[Hl.offsetTable[n]+(_&1023)]+Hl.exponentTable[n],Hl.floatView[0]}const vD={toHalfFloat:Fo,fromHalfFloat:bd},Es=new Ge,d0=new Jt;class Tr{constructor(n,s,l=!1){if(Array.isArray(n))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=n,this.itemSize=s,this.count=n!==void 0?n.length/s:0,this.normalized=l,this.usage=du,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=zr,this.version=0}onUploadCallback(){}set needsUpdate(n){n===!0&&this.version++}get updateRange(){return r0("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(n){return this.usage=n,this}addUpdateRange(n,s){this.updateRanges.push({start:n,count:s})}clearUpdateRanges(){this.updateRanges.length=0}copy(n){return this.name=n.name,this.array=new n.array.constructor(n.array),this.itemSize=n.itemSize,this.count=n.count,this.normalized=n.normalized,this.usage=n.usage,this.gpuType=n.gpuType,this}copyAt(n,s,l){n*=this.itemSize,l*=s.itemSize;for(let d=0,b=this.itemSize;d<b;d++)this.array[n+d]=s.array[l+d];return this}copyArray(n){return this.array.set(n),this}applyMatrix3(n){if(this.itemSize===2)for(let s=0,l=this.count;s<l;s++)d0.fromBufferAttribute(this,s),d0.applyMatrix3(n),this.setXY(s,d0.x,d0.y);else if(this.itemSize===3)for(let s=0,l=this.count;s<l;s++)Es.fromBufferAttribute(this,s),Es.applyMatrix3(n),this.setXYZ(s,Es.x,Es.y,Es.z);return this}applyMatrix4(n){for(let s=0,l=this.count;s<l;s++)Es.fromBufferAttribute(this,s),Es.applyMatrix4(n),this.setXYZ(s,Es.x,Es.y,Es.z);return this}applyNormalMatrix(n){for(let s=0,l=this.count;s<l;s++)Es.fromBufferAttribute(this,s),Es.applyNormalMatrix(n),this.setXYZ(s,Es.x,Es.y,Es.z);return this}transformDirection(n){for(let s=0,l=this.count;s<l;s++)Es.fromBufferAttribute(this,s),Es.transformDirection(n),this.setXYZ(s,Es.x,Es.y,Es.z);return this}set(n,s=0){return this.array.set(n,s),this}getComponent(n,s){let l=this.array[n*this.itemSize+s];return this.normalized&&(l=eo(l,this.array)),l}setComponent(n,s,l){return this.normalized&&(l=Ci(l,this.array)),this.array[n*this.itemSize+s]=l,this}getX(n){let s=this.array[n*this.itemSize];return this.normalized&&(s=eo(s,this.array)),s}setX(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize]=s,this}getY(n){let s=this.array[n*this.itemSize+1];return this.normalized&&(s=eo(s,this.array)),s}setY(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize+1]=s,this}getZ(n){let s=this.array[n*this.itemSize+2];return this.normalized&&(s=eo(s,this.array)),s}setZ(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize+2]=s,this}getW(n){let s=this.array[n*this.itemSize+3];return this.normalized&&(s=eo(s,this.array)),s}setW(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize+3]=s,this}setXY(n,s,l){return n*=this.itemSize,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array)),this.array[n+0]=s,this.array[n+1]=l,this}setXYZ(n,s,l,d){return n*=this.itemSize,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array),d=Ci(d,this.array)),this.array[n+0]=s,this.array[n+1]=l,this.array[n+2]=d,this}setXYZW(n,s,l,d,b){return n*=this.itemSize,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array),d=Ci(d,this.array),b=Ci(b,this.array)),this.array[n+0]=s,this.array[n+1]=l,this.array[n+2]=d,this.array[n+3]=b,this}onUpload(n){return this.onUploadCallback=n,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const n={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(n.name=this.name),this.usage!==du&&(n.usage=this.usage),n}}class bD extends Tr{constructor(n,s,l){super(new Int8Array(n),s,l)}}class yD extends Tr{constructor(n,s,l){super(new Uint8Array(n),s,l)}}class _D extends Tr{constructor(n,s,l){super(new Uint8ClampedArray(n),s,l)}}class ED extends Tr{constructor(n,s,l){super(new Int16Array(n),s,l)}}class nb extends Tr{constructor(n,s,l){super(new Uint16Array(n),s,l)}}class wD extends Tr{constructor(n,s,l){super(new Int32Array(n),s,l)}}class ib extends Tr{constructor(n,s,l){super(new Uint32Array(n),s,l)}}class CD extends Tr{constructor(n,s,l){super(new Uint16Array(n),s,l),this.isFloat16BufferAttribute=!0}getX(n){let s=bd(this.array[n*this.itemSize]);return this.normalized&&(s=eo(s,this.array)),s}setX(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize]=Fo(s),this}getY(n){let s=bd(this.array[n*this.itemSize+1]);return this.normalized&&(s=eo(s,this.array)),s}setY(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize+1]=Fo(s),this}getZ(n){let s=bd(this.array[n*this.itemSize+2]);return this.normalized&&(s=eo(s,this.array)),s}setZ(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize+2]=Fo(s),this}getW(n){let s=bd(this.array[n*this.itemSize+3]);return this.normalized&&(s=eo(s,this.array)),s}setW(n,s){return this.normalized&&(s=Ci(s,this.array)),this.array[n*this.itemSize+3]=Fo(s),this}setXY(n,s,l){return n*=this.itemSize,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array)),this.array[n+0]=Fo(s),this.array[n+1]=Fo(l),this}setXYZ(n,s,l,d){return n*=this.itemSize,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array),d=Ci(d,this.array)),this.array[n+0]=Fo(s),this.array[n+1]=Fo(l),this.array[n+2]=Fo(d),this}setXYZW(n,s,l,d,b){return n*=this.itemSize,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array),d=Ci(d,this.array),b=Ci(b,this.array)),this.array[n+0]=Fo(s),this.array[n+1]=Fo(l),this.array[n+2]=Fo(d),this.array[n+3]=Fo(b),this}}class ei extends Tr{constructor(n,s,l){super(new Float32Array(n),s,l)}}let xD=0;const ga=new Kn,rb=new hr,Ph=new Ge,ia=new ns,yd=new ns,Hs=new Ge;class Ui extends vo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xD++}),this.uuid=bo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(n){return Array.isArray(n)?this.index=new(t0(n)?ib:nb)(n,1):this.index=n,this}getAttribute(n){return this.attributes[n]}setAttribute(n,s){return this.attributes[n]=s,this}deleteAttribute(n){return delete this.attributes[n],this}hasAttribute(n){return this.attributes[n]!==void 0}addGroup(n,s,l=0){this.groups.push({start:n,count:s,materialIndex:l})}clearGroups(){this.groups=[]}setDrawRange(n,s){this.drawRange.start=n,this.drawRange.count=s}applyMatrix4(n){const s=this.attributes.position;s!==void 0&&(s.applyMatrix4(n),s.needsUpdate=!0);const l=this.attributes.normal;if(l!==void 0){const b=new _i().getNormalMatrix(n);l.applyNormalMatrix(b),l.needsUpdate=!0}const d=this.attributes.tangent;return d!==void 0&&(d.transformDirection(n),d.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(n){return ga.makeRotationFromQuaternion(n),this.applyMatrix4(ga),this}rotateX(n){return ga.makeRotationX(n),this.applyMatrix4(ga),this}rotateY(n){return ga.makeRotationY(n),this.applyMatrix4(ga),this}rotateZ(n){return ga.makeRotationZ(n),this.applyMatrix4(ga),this}translate(n,s,l){return ga.makeTranslation(n,s,l),this.applyMatrix4(ga),this}scale(n,s,l){return ga.makeScale(n,s,l),this.applyMatrix4(ga),this}lookAt(n){return rb.lookAt(n),rb.updateMatrix(),this.applyMatrix4(rb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ph).negate(),this.translate(Ph.x,Ph.y,Ph.z),this}setFromPoints(n){const s=[];for(let l=0,d=n.length;l<d;l++){const b=n[l];s.push(b.x,b.y,b.z||0)}return this.setAttribute("position",new ei(s,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ns);const n=this.attributes.position,s=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ge(-1/0,-1/0,-1/0),new Ge(1/0,1/0,1/0));return}if(n!==void 0){if(this.boundingBox.setFromBufferAttribute(n),s)for(let l=0,d=s.length;l<d;l++){const b=s[l];ia.setFromBufferAttribute(b),this.morphTargetsRelative?(Hs.addVectors(this.boundingBox.min,ia.min),this.boundingBox.expandByPoint(Hs),Hs.addVectors(this.boundingBox.max,ia.max),this.boundingBox.expandByPoint(Hs)):(this.boundingBox.expandByPoint(ia.min),this.boundingBox.expandByPoint(ia.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ts);const n=this.attributes.position,s=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ge,1/0);return}if(n){const l=this.boundingSphere.center;if(ia.setFromBufferAttribute(n),s)for(let b=0,T=s.length;b<T;b++){const B=s[b];yd.setFromBufferAttribute(B),this.morphTargetsRelative?(Hs.addVectors(ia.min,yd.min),ia.expandByPoint(Hs),Hs.addVectors(ia.max,yd.max),ia.expandByPoint(Hs)):(ia.expandByPoint(yd.min),ia.expandByPoint(yd.max))}ia.getCenter(l);let d=0;for(let b=0,T=n.count;b<T;b++)Hs.fromBufferAttribute(n,b),d=Math.max(d,l.distanceToSquared(Hs));if(s)for(let b=0,T=s.length;b<T;b++){const B=s[b],N=this.morphTargetsRelative;for(let U=0,z=B.count;U<z;U++)Hs.fromBufferAttribute(B,U),N&&(Ph.fromBufferAttribute(n,U),Hs.add(Ph)),d=Math.max(d,l.distanceToSquared(Hs))}this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const n=this.index,s=this.attributes;if(n===null||s.position===void 0||s.normal===void 0||s.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const l=s.position,d=s.normal,b=s.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Tr(new Float32Array(4*l.count),4));const T=this.getAttribute("tangent"),B=[],N=[];for(let Ke=0;Ke<l.count;Ke++)B[Ke]=new Ge,N[Ke]=new Ge;const U=new Ge,z=new Ge,X=new Ge,q=new Jt,ee=new Jt,ie=new Jt,ce=new Ge,re=new Ge;function te(Ke,De,Ie){U.fromBufferAttribute(l,Ke),z.fromBufferAttribute(l,De),X.fromBufferAttribute(l,Ie),q.fromBufferAttribute(b,Ke),ee.fromBufferAttribute(b,De),ie.fromBufferAttribute(b,Ie),z.sub(U),X.sub(U),ee.sub(q),ie.sub(q);const Ye=1/(ee.x*ie.y-ie.x*ee.y);isFinite(Ye)&&(ce.copy(z).multiplyScalar(ie.y).addScaledVector(X,-ee.y).multiplyScalar(Ye),re.copy(X).multiplyScalar(ee.x).addScaledVector(z,-ie.x).multiplyScalar(Ye),B[Ke].add(ce),B[De].add(ce),B[Ie].add(ce),N[Ke].add(re),N[De].add(re),N[Ie].add(re))}let we=this.groups;we.length===0&&(we=[{start:0,count:n.count}]);for(let Ke=0,De=we.length;Ke<De;++Ke){const Ie=we[Ke],Ye=Ie.start,at=Ie.count;for(let tt=Ye,ut=Ye+at;tt<ut;tt+=3)te(n.getX(tt+0),n.getX(tt+1),n.getX(tt+2))}const ve=new Ge,Ae=new Ge,qe=new Ge,Ve=new Ge;function ze(Ke){qe.fromBufferAttribute(d,Ke),Ve.copy(qe);const De=B[Ke];ve.copy(De),ve.sub(qe.multiplyScalar(qe.dot(De))).normalize(),Ae.crossVectors(Ve,De);const Ye=Ae.dot(N[Ke])<0?-1:1;T.setXYZW(Ke,ve.x,ve.y,ve.z,Ye)}for(let Ke=0,De=we.length;Ke<De;++Ke){const Ie=we[Ke],Ye=Ie.start,at=Ie.count;for(let tt=Ye,ut=Ye+at;tt<ut;tt+=3)ze(n.getX(tt+0)),ze(n.getX(tt+1)),ze(n.getX(tt+2))}}computeVertexNormals(){const n=this.index,s=this.getAttribute("position");if(s!==void 0){let l=this.getAttribute("normal");if(l===void 0)l=new Tr(new Float32Array(s.count*3),3),this.setAttribute("normal",l);else for(let q=0,ee=l.count;q<ee;q++)l.setXYZ(q,0,0,0);const d=new Ge,b=new Ge,T=new Ge,B=new Ge,N=new Ge,U=new Ge,z=new Ge,X=new Ge;if(n)for(let q=0,ee=n.count;q<ee;q+=3){const ie=n.getX(q+0),ce=n.getX(q+1),re=n.getX(q+2);d.fromBufferAttribute(s,ie),b.fromBufferAttribute(s,ce),T.fromBufferAttribute(s,re),z.subVectors(T,b),X.subVectors(d,b),z.cross(X),B.fromBufferAttribute(l,ie),N.fromBufferAttribute(l,ce),U.fromBufferAttribute(l,re),B.add(z),N.add(z),U.add(z),l.setXYZ(ie,B.x,B.y,B.z),l.setXYZ(ce,N.x,N.y,N.z),l.setXYZ(re,U.x,U.y,U.z)}else for(let q=0,ee=s.count;q<ee;q+=3)d.fromBufferAttribute(s,q+0),b.fromBufferAttribute(s,q+1),T.fromBufferAttribute(s,q+2),z.subVectors(T,b),X.subVectors(d,b),z.cross(X),l.setXYZ(q+0,z.x,z.y,z.z),l.setXYZ(q+1,z.x,z.y,z.z),l.setXYZ(q+2,z.x,z.y,z.z);this.normalizeNormals(),l.needsUpdate=!0}}normalizeNormals(){const n=this.attributes.normal;for(let s=0,l=n.count;s<l;s++)Hs.fromBufferAttribute(n,s),Hs.normalize(),n.setXYZ(s,Hs.x,Hs.y,Hs.z)}toNonIndexed(){function n(B,N){const U=B.array,z=B.itemSize,X=B.normalized,q=new U.constructor(N.length*z);let ee=0,ie=0;for(let ce=0,re=N.length;ce<re;ce++){B.isInterleavedBufferAttribute?ee=N[ce]*B.data.stride+B.offset:ee=N[ce]*z;for(let te=0;te<z;te++)q[ie++]=U[ee++]}return new Tr(q,z,X)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const s=new Ui,l=this.index.array,d=this.attributes;for(const B in d){const N=d[B],U=n(N,l);s.setAttribute(B,U)}const b=this.morphAttributes;for(const B in b){const N=[],U=b[B];for(let z=0,X=U.length;z<X;z++){const q=U[z],ee=n(q,l);N.push(ee)}s.morphAttributes[B]=N}s.morphTargetsRelative=this.morphTargetsRelative;const T=this.groups;for(let B=0,N=T.length;B<N;B++){const U=T[B];s.addGroup(U.start,U.count,U.materialIndex)}return s}toJSON(){const n={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),Object.keys(this.userData).length>0&&(n.userData=this.userData),this.parameters!==void 0){const N=this.parameters;for(const U in N)N[U]!==void 0&&(n[U]=N[U]);return n}n.data={attributes:{}};const s=this.index;s!==null&&(n.data.index={type:s.array.constructor.name,array:Array.prototype.slice.call(s.array)});const l=this.attributes;for(const N in l){const U=l[N];n.data.attributes[N]=U.toJSON(n.data)}const d={};let b=!1;for(const N in this.morphAttributes){const U=this.morphAttributes[N],z=[];for(let X=0,q=U.length;X<q;X++){const ee=U[X];z.push(ee.toJSON(n.data))}z.length>0&&(d[N]=z,b=!0)}b&&(n.data.morphAttributes=d,n.data.morphTargetsRelative=this.morphTargetsRelative);const T=this.groups;T.length>0&&(n.data.groups=JSON.parse(JSON.stringify(T)));const B=this.boundingSphere;return B!==null&&(n.data.boundingSphere={center:B.center.toArray(),radius:B.radius}),n}clone(){return new this.constructor().copy(this)}copy(n){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const s={};this.name=n.name;const l=n.index;l!==null&&this.setIndex(l.clone(s));const d=n.attributes;for(const U in d){const z=d[U];this.setAttribute(U,z.clone(s))}const b=n.morphAttributes;for(const U in b){const z=[],X=b[U];for(let q=0,ee=X.length;q<ee;q++)z.push(X[q].clone(s));this.morphAttributes[U]=z}this.morphTargetsRelative=n.morphTargetsRelative;const T=n.groups;for(let U=0,z=T.length;U<z;U++){const X=T[U];this.addGroup(X.start,X.count,X.materialIndex)}const B=n.boundingBox;B!==null&&(this.boundingBox=B.clone());const N=n.boundingSphere;return N!==null&&(this.boundingSphere=N.clone()),this.drawRange.start=n.drawRange.start,this.drawRange.count=n.drawRange.count,this.userData=n.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const nC=new Kn,gu=new Is,p0=new Ts,iC=new Ge,Dh=new Ge,Nh=new Ge,Oh=new Ge,sb=new Ge,m0=new Ge,A0=new Jt,g0=new Jt,v0=new Jt,rC=new Ge,sC=new Ge,oC=new Ge,b0=new Ge,y0=new Ge;class ws extends hr{constructor(n=new Ui,s=new Tc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=n,this.material=s,this.updateMorphTargets()}copy(n,s){return super.copy(n,s),n.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=n.morphTargetInfluences.slice()),n.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},n.morphTargetDictionary)),this.material=Array.isArray(n.material)?n.material.slice():n.material,this.geometry=n.geometry,this}updateMorphTargets(){const s=this.geometry.morphAttributes,l=Object.keys(s);if(l.length>0){const d=s[l[0]];if(d!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let b=0,T=d.length;b<T;b++){const B=d[b].name||String(b);this.morphTargetInfluences.push(0),this.morphTargetDictionary[B]=b}}}}getVertexPosition(n,s){const l=this.geometry,d=l.attributes.position,b=l.morphAttributes.position,T=l.morphTargetsRelative;s.fromBufferAttribute(d,n);const B=this.morphTargetInfluences;if(b&&B){m0.set(0,0,0);for(let N=0,U=b.length;N<U;N++){const z=B[N],X=b[N];z!==0&&(sb.fromBufferAttribute(X,n),T?m0.addScaledVector(sb,z):m0.addScaledVector(sb.sub(s),z))}s.add(m0)}return s}raycast(n,s){const l=this.geometry,d=this.material,b=this.matrixWorld;d!==void 0&&(l.boundingSphere===null&&l.computeBoundingSphere(),p0.copy(l.boundingSphere),p0.applyMatrix4(b),gu.copy(n.ray).recast(n.near),!(p0.containsPoint(gu.origin)===!1&&(gu.intersectSphere(p0,iC)===null||gu.origin.distanceToSquared(iC)>(n.far-n.near)**2))&&(nC.copy(b).invert(),gu.copy(n.ray).applyMatrix4(nC),!(l.boundingBox!==null&&gu.intersectsBox(l.boundingBox)===!1)&&this._computeIntersections(n,s,gu)))}_computeIntersections(n,s,l){let d;const b=this.geometry,T=this.material,B=b.index,N=b.attributes.position,U=b.attributes.uv,z=b.attributes.uv1,X=b.attributes.normal,q=b.groups,ee=b.drawRange;if(B!==null)if(Array.isArray(T))for(let ie=0,ce=q.length;ie<ce;ie++){const re=q[ie],te=T[re.materialIndex],we=Math.max(re.start,ee.start),ve=Math.min(B.count,Math.min(re.start+re.count,ee.start+ee.count));for(let Ae=we,qe=ve;Ae<qe;Ae+=3){const Ve=B.getX(Ae),ze=B.getX(Ae+1),Ke=B.getX(Ae+2);d=_0(this,te,n,l,U,z,X,Ve,ze,Ke),d&&(d.faceIndex=Math.floor(Ae/3),d.face.materialIndex=re.materialIndex,s.push(d))}}else{const ie=Math.max(0,ee.start),ce=Math.min(B.count,ee.start+ee.count);for(let re=ie,te=ce;re<te;re+=3){const we=B.getX(re),ve=B.getX(re+1),Ae=B.getX(re+2);d=_0(this,T,n,l,U,z,X,we,ve,Ae),d&&(d.faceIndex=Math.floor(re/3),s.push(d))}}else if(N!==void 0)if(Array.isArray(T))for(let ie=0,ce=q.length;ie<ce;ie++){const re=q[ie],te=T[re.materialIndex],we=Math.max(re.start,ee.start),ve=Math.min(N.count,Math.min(re.start+re.count,ee.start+ee.count));for(let Ae=we,qe=ve;Ae<qe;Ae+=3){const Ve=Ae,ze=Ae+1,Ke=Ae+2;d=_0(this,te,n,l,U,z,X,Ve,ze,Ke),d&&(d.faceIndex=Math.floor(Ae/3),d.face.materialIndex=re.materialIndex,s.push(d))}}else{const ie=Math.max(0,ee.start),ce=Math.min(N.count,ee.start+ee.count);for(let re=ie,te=ce;re<te;re+=3){const we=re,ve=re+1,Ae=re+2;d=_0(this,T,n,l,U,z,X,we,ve,Ae),d&&(d.faceIndex=Math.floor(re/3),s.push(d))}}}}function MD(_,n,s,l,d,b,T,B){let N;if(n.side===I?N=l.intersectTriangle(T,b,d,!0,B):N=l.intersectTriangle(d,b,T,n.side===S,B),N===null)return null;y0.copy(B),y0.applyMatrix4(_.matrixWorld);const U=s.ray.origin.distanceTo(y0);return U<s.near||U>s.far?null:{distance:U,point:y0.clone(),object:_}}function _0(_,n,s,l,d,b,T,B,N,U){_.getVertexPosition(B,Dh),_.getVertexPosition(N,Nh),_.getVertexPosition(U,Oh);const z=MD(_,n,s,l,Dh,Nh,Oh,b0);if(z){d&&(A0.fromBufferAttribute(d,B),g0.fromBufferAttribute(d,N),v0.fromBufferAttribute(d,U),z.uv=na.getInterpolation(b0,Dh,Nh,Oh,A0,g0,v0,new Jt)),b&&(A0.fromBufferAttribute(b,B),g0.fromBufferAttribute(b,N),v0.fromBufferAttribute(b,U),z.uv1=na.getInterpolation(b0,Dh,Nh,Oh,A0,g0,v0,new Jt)),T&&(rC.fromBufferAttribute(T,B),sC.fromBufferAttribute(T,N),oC.fromBufferAttribute(T,U),z.normal=na.getInterpolation(b0,Dh,Nh,Oh,rC,sC,oC,new Ge),z.normal.dot(l.direction)>0&&z.normal.multiplyScalar(-1));const X={a:B,b:N,c:U,normal:new Ge,materialIndex:0};na.getNormal(Dh,Nh,Oh,X.normal),z.face=X}return z}class vu extends Ui{constructor(n=1,s=1,l=1,d=1,b=1,T=1){super(),this.type="BoxGeometry",this.parameters={width:n,height:s,depth:l,widthSegments:d,heightSegments:b,depthSegments:T};const B=this;d=Math.floor(d),b=Math.floor(b),T=Math.floor(T);const N=[],U=[],z=[],X=[];let q=0,ee=0;ie("z","y","x",-1,-1,l,s,n,T,b,0),ie("z","y","x",1,-1,l,s,-n,T,b,1),ie("x","z","y",1,1,n,l,s,d,T,2),ie("x","z","y",1,-1,n,l,-s,d,T,3),ie("x","y","z",1,-1,n,s,l,d,b,4),ie("x","y","z",-1,-1,n,s,-l,d,b,5),this.setIndex(N),this.setAttribute("position",new ei(U,3)),this.setAttribute("normal",new ei(z,3)),this.setAttribute("uv",new ei(X,2));function ie(ce,re,te,we,ve,Ae,qe,Ve,ze,Ke,De){const Ie=Ae/ze,Ye=qe/Ke,at=Ae/2,tt=qe/2,ut=Ve/2,wt=ze+1,Yt=Ke+1;let _n=0,Mt=0;const mn=new Ge;for(let vn=0;vn<Yt;vn++){const Xn=vn*Ye-tt;for(let Gi=0;Gi<wt;Gi++){const vr=Gi*Ie-at;mn[ce]=vr*we,mn[re]=Xn*ve,mn[te]=ut,U.push(mn.x,mn.y,mn.z),mn[ce]=0,mn[re]=0,mn[te]=Ve>0?1:-1,z.push(mn.x,mn.y,mn.z),X.push(Gi/ze),X.push(1-vn/Ke),_n+=1}}for(let vn=0;vn<Ke;vn++)for(let Xn=0;Xn<ze;Xn++){const Gi=q+Xn+wt*vn,vr=q+Xn+wt*(vn+1),Gr=q+(Xn+1)+wt*(vn+1),fr=q+(Xn+1)+wt*vn;N.push(Gi,vr,fr),N.push(vr,Gr,fr),Mt+=6}B.addGroup(ee,Mt,De),ee+=Mt,q+=_n}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new vu(n.width,n.height,n.depth,n.widthSegments,n.heightSegments,n.depthSegments)}}function Fh(_){const n={};for(const s in _){n[s]={};for(const l in _[s]){const d=_[s][l];d&&(d.isColor||d.isMatrix3||d.isMatrix4||d.isVector2||d.isVector3||d.isVector4||d.isTexture||d.isQuaternion)?d.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),n[s][l]=null):n[s][l]=d.clone():Array.isArray(d)?n[s][l]=d.slice():n[s][l]=d}}return n}function _o(_){const n={};for(let s=0;s<_.length;s++){const l=Fh(_[s]);for(const d in l)n[d]=l[d]}return n}function SD(_){const n=[];for(let s=0;s<_.length;s++)n.push(_[s].clone());return n}function aC(_){const n=_.getRenderTarget();return n===null?_.outputColorSpace:n.isXRRenderTarget===!0?n.texture.colorSpace:gr.workingColorSpace}const lC={clone:Fh,merge:_o};var TD=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ID=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Fa extends ao{constructor(n){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=TD,this.fragmentShader=ID,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,n!==void 0&&this.setValues(n)}copy(n){return super.copy(n),this.fragmentShader=n.fragmentShader,this.vertexShader=n.vertexShader,this.uniforms=Fh(n.uniforms),this.uniformsGroups=SD(n.uniformsGroups),this.defines=Object.assign({},n.defines),this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.fog=n.fog,this.lights=n.lights,this.clipping=n.clipping,this.extensions=Object.assign({},n.extensions),this.glslVersion=n.glslVersion,this}toJSON(n){const s=super.toJSON(n);s.glslVersion=this.glslVersion,s.uniforms={};for(const d in this.uniforms){const T=this.uniforms[d].value;T&&T.isTexture?s.uniforms[d]={type:"t",value:T.toJSON(n).uuid}:T&&T.isColor?s.uniforms[d]={type:"c",value:T.getHex()}:T&&T.isVector2?s.uniforms[d]={type:"v2",value:T.toArray()}:T&&T.isVector3?s.uniforms[d]={type:"v3",value:T.toArray()}:T&&T.isVector4?s.uniforms[d]={type:"v4",value:T.toArray()}:T&&T.isMatrix3?s.uniforms[d]={type:"m3",value:T.toArray()}:T&&T.isMatrix4?s.uniforms[d]={type:"m4",value:T.toArray()}:s.uniforms[d]={value:T}}Object.keys(this.defines).length>0&&(s.defines=this.defines),s.vertexShader=this.vertexShader,s.fragmentShader=this.fragmentShader,s.lights=this.lights,s.clipping=this.clipping;const l={};for(const d in this.extensions)this.extensions[d]===!0&&(l[d]=!0);return Object.keys(l).length>0&&(s.extensions=l),s}}class E0 extends hr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Kn,this.projectionMatrix=new Kn,this.projectionMatrixInverse=new Kn,this.coordinateSystem=ma}copy(n,s){return super.copy(n,s),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this.coordinateSystem=n.coordinateSystem,this}getWorldDirection(n){return super.getWorldDirection(n).negate()}updateMatrixWorld(n){super.updateMatrixWorld(n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(n,s){super.updateWorldMatrix(n,s),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ic=new Ge,cC=new Jt,uC=new Jt;class Bs extends E0{constructor(n=50,s=1,l=.1,d=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=n,this.zoom=1,this.near=l,this.far=d,this.focus=10,this.aspect=s,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(n,s){return super.copy(n,s),this.fov=n.fov,this.zoom=n.zoom,this.near=n.near,this.far=n.far,this.focus=n.focus,this.aspect=n.aspect,this.view=n.view===null?null:Object.assign({},n.view),this.filmGauge=n.filmGauge,this.filmOffset=n.filmOffset,this}setFocalLength(n){const s=.5*this.getFilmHeight()/n;this.fov=_c*2*Math.atan(s),this.updateProjectionMatrix()}getFocalLength(){const n=Math.tan(Ol*.5*this.fov);return .5*this.getFilmHeight()/n}getEffectiveFOV(){return _c*2*Math.atan(Math.tan(Ol*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(n,s,l){Ic.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),s.set(Ic.x,Ic.y).multiplyScalar(-n/Ic.z),Ic.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),l.set(Ic.x,Ic.y).multiplyScalar(-n/Ic.z)}getViewSize(n,s){return this.getViewBounds(n,cC,uC),s.subVectors(uC,cC)}setViewOffset(n,s,l,d,b,T){this.aspect=n/s,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=s,this.view.offsetX=l,this.view.offsetY=d,this.view.width=b,this.view.height=T,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=this.near;let s=n*Math.tan(Ol*.5*this.fov)/this.zoom,l=2*s,d=this.aspect*l,b=-.5*d;const T=this.view;if(this.view!==null&&this.view.enabled){const N=T.fullWidth,U=T.fullHeight;b+=T.offsetX*d/N,s-=T.offsetY*l/U,d*=T.width/N,l*=T.height/U}const B=this.filmOffset;B!==0&&(b+=n*B/this.getFilmWidth()),this.projectionMatrix.makePerspective(b,b+d,s,s-l,n,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const s=super.toJSON(n);return s.object.fov=this.fov,s.object.zoom=this.zoom,s.object.near=this.near,s.object.far=this.far,s.object.focus=this.focus,s.object.aspect=this.aspect,this.view!==null&&(s.object.view=Object.assign({},this.view)),s.object.filmGauge=this.filmGauge,s.object.filmOffset=this.filmOffset,s}}const kh=-90,Uh=1;class hC extends hr{constructor(n,s,l){super(),this.type="CubeCamera",this.renderTarget=l,this.coordinateSystem=null,this.activeMipmapLevel=0;const d=new Bs(kh,Uh,n,s);d.layers=this.layers,this.add(d);const b=new Bs(kh,Uh,n,s);b.layers=this.layers,this.add(b);const T=new Bs(kh,Uh,n,s);T.layers=this.layers,this.add(T);const B=new Bs(kh,Uh,n,s);B.layers=this.layers,this.add(B);const N=new Bs(kh,Uh,n,s);N.layers=this.layers,this.add(N);const U=new Bs(kh,Uh,n,s);U.layers=this.layers,this.add(U)}updateCoordinateSystem(){const n=this.coordinateSystem,s=this.children.concat(),[l,d,b,T,B,N]=s;for(const U of s)this.remove(U);if(n===ma)l.up.set(0,1,0),l.lookAt(1,0,0),d.up.set(0,1,0),d.lookAt(-1,0,0),b.up.set(0,0,-1),b.lookAt(0,1,0),T.up.set(0,0,1),T.lookAt(0,-1,0),B.up.set(0,1,0),B.lookAt(0,0,1),N.up.set(0,1,0),N.lookAt(0,0,-1);else if(n===pu)l.up.set(0,-1,0),l.lookAt(-1,0,0),d.up.set(0,-1,0),d.lookAt(1,0,0),b.up.set(0,0,1),b.lookAt(0,1,0),T.up.set(0,0,-1),T.lookAt(0,-1,0),B.up.set(0,-1,0),B.lookAt(0,0,1),N.up.set(0,-1,0),N.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+n);for(const U of s)this.add(U),U.updateMatrixWorld()}update(n,s){this.parent===null&&this.updateMatrixWorld();const{renderTarget:l,activeMipmapLevel:d}=this;this.coordinateSystem!==n.coordinateSystem&&(this.coordinateSystem=n.coordinateSystem,this.updateCoordinateSystem());const[b,T,B,N,U,z]=this.children,X=n.getRenderTarget(),q=n.getActiveCubeFace(),ee=n.getActiveMipmapLevel(),ie=n.xr.enabled;n.xr.enabled=!1;const ce=l.texture.generateMipmaps;l.texture.generateMipmaps=!1,n.setRenderTarget(l,0,d),n.render(s,b),n.setRenderTarget(l,1,d),n.render(s,T),n.setRenderTarget(l,2,d),n.render(s,B),n.setRenderTarget(l,3,d),n.render(s,N),n.setRenderTarget(l,4,d),n.render(s,U),l.texture.generateMipmaps=ce,n.setRenderTarget(l,5,d),n.render(s,z),n.setRenderTarget(X,q,ee),n.xr.enabled=ie,l.texture.needsPMREMUpdate=!0}}class _d extends kr{constructor(n,s,l,d,b,T,B,N,U,z){n=n!==void 0?n:[],s=s!==void 0?s:le,super(n,s,l,d,b,T,B,N,U,z),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(n){this.image=n}}class fC extends Do{constructor(n=1,s={}){super(n,n,s),this.isWebGLCubeRenderTarget=!0;const l={width:n,height:n,depth:1},d=[l,l,l,l,l,l];this.texture=new _d(d,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=s.generateMipmaps!==void 0?s.generateMipmaps:!1,this.texture.minFilter=s.minFilter!==void 0?s.minFilter:Dn}fromEquirectangularTexture(n,s){this.texture.type=s.type,this.texture.colorSpace=s.colorSpace,this.texture.generateMipmaps=s.generateMipmaps,this.texture.minFilter=s.minFilter,this.texture.magFilter=s.magFilter;const l={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},d=new vu(5,5,5),b=new Fa({name:"CubemapFromEquirect",uniforms:Fh(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,side:I,blending:R});b.uniforms.tEquirect.value=s;const T=new ws(d,b),B=s.minFilter;return s.minFilter===_r&&(s.minFilter=Dn),new hC(1,10,this).update(n,T),s.minFilter=B,T.geometry.dispose(),T.material.dispose(),this}clear(n,s,l,d){const b=n.getRenderTarget();for(let T=0;T<6;T++)n.setRenderTarget(this,T),n.clear(s,l,d);n.setRenderTarget(b)}}const ob=new Ge,BD=new Ge,RD=new _i;class Bc{constructor(n=new Ge(1,0,0),s=0){this.isPlane=!0,this.normal=n,this.constant=s}set(n,s){return this.normal.copy(n),this.constant=s,this}setComponents(n,s,l,d){return this.normal.set(n,s,l),this.constant=d,this}setFromNormalAndCoplanarPoint(n,s){return this.normal.copy(n),this.constant=-s.dot(this.normal),this}setFromCoplanarPoints(n,s,l){const d=ob.subVectors(l,s).cross(BD.subVectors(n,s)).normalize();return this.setFromNormalAndCoplanarPoint(d,n),this}copy(n){return this.normal.copy(n.normal),this.constant=n.constant,this}normalize(){const n=1/this.normal.length();return this.normal.multiplyScalar(n),this.constant*=n,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(n){return this.normal.dot(n)+this.constant}distanceToSphere(n){return this.distanceToPoint(n.center)-n.radius}projectPoint(n,s){return s.copy(n).addScaledVector(this.normal,-this.distanceToPoint(n))}intersectLine(n,s){const l=n.delta(ob),d=this.normal.dot(l);if(d===0)return this.distanceToPoint(n.start)===0?s.copy(n.start):null;const b=-(n.start.dot(this.normal)+this.constant)/d;return b<0||b>1?null:s.copy(n.start).addScaledVector(l,b)}intersectsLine(n){const s=this.distanceToPoint(n.start),l=this.distanceToPoint(n.end);return s<0&&l>0||l<0&&s>0}intersectsBox(n){return n.intersectsPlane(this)}intersectsSphere(n){return n.intersectsPlane(this)}coplanarPoint(n){return n.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(n,s){const l=s||RD.getNormalMatrix(n),d=this.coplanarPoint(ob).applyMatrix4(n),b=this.normal.applyMatrix3(l).normalize();return this.constant=-d.dot(b),this}translate(n){return this.constant-=n.dot(this.normal),this}equals(n){return n.normal.equals(this.normal)&&n.constant===this.constant}clone(){return new this.constructor().copy(this)}}const bu=new Ts,w0=new Ge;class Ed{constructor(n=new Bc,s=new Bc,l=new Bc,d=new Bc,b=new Bc,T=new Bc){this.planes=[n,s,l,d,b,T]}set(n,s,l,d,b,T){const B=this.planes;return B[0].copy(n),B[1].copy(s),B[2].copy(l),B[3].copy(d),B[4].copy(b),B[5].copy(T),this}copy(n){const s=this.planes;for(let l=0;l<6;l++)s[l].copy(n.planes[l]);return this}setFromProjectionMatrix(n,s=ma){const l=this.planes,d=n.elements,b=d[0],T=d[1],B=d[2],N=d[3],U=d[4],z=d[5],X=d[6],q=d[7],ee=d[8],ie=d[9],ce=d[10],re=d[11],te=d[12],we=d[13],ve=d[14],Ae=d[15];if(l[0].setComponents(N-b,q-U,re-ee,Ae-te).normalize(),l[1].setComponents(N+b,q+U,re+ee,Ae+te).normalize(),l[2].setComponents(N+T,q+z,re+ie,Ae+we).normalize(),l[3].setComponents(N-T,q-z,re-ie,Ae-we).normalize(),l[4].setComponents(N-B,q-X,re-ce,Ae-ve).normalize(),s===ma)l[5].setComponents(N+B,q+X,re+ce,Ae+ve).normalize();else if(s===pu)l[5].setComponents(B,X,ce,ve).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+s);return this}intersectsObject(n){if(n.boundingSphere!==void 0)n.boundingSphere===null&&n.computeBoundingSphere(),bu.copy(n.boundingSphere).applyMatrix4(n.matrixWorld);else{const s=n.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),bu.copy(s.boundingSphere).applyMatrix4(n.matrixWorld)}return this.intersectsSphere(bu)}intersectsSprite(n){return bu.center.set(0,0,0),bu.radius=.7071067811865476,bu.applyMatrix4(n.matrixWorld),this.intersectsSphere(bu)}intersectsSphere(n){const s=this.planes,l=n.center,d=-n.radius;for(let b=0;b<6;b++)if(s[b].distanceToPoint(l)<d)return!1;return!0}intersectsBox(n){const s=this.planes;for(let l=0;l<6;l++){const d=s[l];if(w0.x=d.normal.x>0?n.max.x:n.min.x,w0.y=d.normal.y>0?n.max.y:n.min.y,w0.z=d.normal.z>0?n.max.z:n.min.z,d.distanceToPoint(w0)<0)return!1}return!0}containsPoint(n){const s=this.planes;for(let l=0;l<6;l++)if(s[l].distanceToPoint(n)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function ab(){let _=null,n=!1,s=null,l=null;function d(b,T){s(b,T),l=_.requestAnimationFrame(d)}return{start:function(){n!==!0&&s!==null&&(l=_.requestAnimationFrame(d),n=!0)},stop:function(){_.cancelAnimationFrame(l),n=!1},setAnimationLoop:function(b){s=b},setContext:function(b){_=b}}}function LD(_){const n=new WeakMap;function s(B,N){const U=B.array,z=B.usage,X=U.byteLength,q=_.createBuffer();_.bindBuffer(N,q),_.bufferData(N,U,z),B.onUploadCallback();let ee;if(U instanceof Float32Array)ee=_.FLOAT;else if(U instanceof Uint16Array)B.isFloat16BufferAttribute?ee=_.HALF_FLOAT:ee=_.UNSIGNED_SHORT;else if(U instanceof Int16Array)ee=_.SHORT;else if(U instanceof Uint32Array)ee=_.UNSIGNED_INT;else if(U instanceof Int32Array)ee=_.INT;else if(U instanceof Int8Array)ee=_.BYTE;else if(U instanceof Uint8Array)ee=_.UNSIGNED_BYTE;else if(U instanceof Uint8ClampedArray)ee=_.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+U);return{buffer:q,type:ee,bytesPerElement:U.BYTES_PER_ELEMENT,version:B.version,size:X}}function l(B,N,U){const z=N.array,X=N._updateRange,q=N.updateRanges;if(_.bindBuffer(U,B),X.count===-1&&q.length===0&&_.bufferSubData(U,0,z),q.length!==0){for(let ee=0,ie=q.length;ee<ie;ee++){const ce=q[ee];_.bufferSubData(U,ce.start*z.BYTES_PER_ELEMENT,z,ce.start,ce.count)}N.clearUpdateRanges()}X.count!==-1&&(_.bufferSubData(U,X.offset*z.BYTES_PER_ELEMENT,z,X.offset,X.count),X.count=-1),N.onUploadCallback()}function d(B){return B.isInterleavedBufferAttribute&&(B=B.data),n.get(B)}function b(B){B.isInterleavedBufferAttribute&&(B=B.data);const N=n.get(B);N&&(_.deleteBuffer(N.buffer),n.delete(B))}function T(B,N){if(B.isGLBufferAttribute){const z=n.get(B);(!z||z.version<B.version)&&n.set(B,{buffer:B.buffer,type:B.type,bytesPerElement:B.elementSize,version:B.version});return}B.isInterleavedBufferAttribute&&(B=B.data);const U=n.get(B);if(U===void 0)n.set(B,s(B,N));else if(U.version<B.version){if(U.size!==B.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");l(U.buffer,B,N),U.version=B.version}}return{get:d,remove:b,update:T}}class Gh extends Ui{constructor(n=1,s=1,l=1,d=1){super(),this.type="PlaneGeometry",this.parameters={width:n,height:s,widthSegments:l,heightSegments:d};const b=n/2,T=s/2,B=Math.floor(l),N=Math.floor(d),U=B+1,z=N+1,X=n/B,q=s/N,ee=[],ie=[],ce=[],re=[];for(let te=0;te<z;te++){const we=te*q-T;for(let ve=0;ve<U;ve++){const Ae=ve*X-b;ie.push(Ae,-we,0),ce.push(0,0,1),re.push(ve/B),re.push(1-te/N)}}for(let te=0;te<N;te++)for(let we=0;we<B;we++){const ve=we+U*te,Ae=we+U*(te+1),qe=we+1+U*(te+1),Ve=we+1+U*te;ee.push(ve,Ae,Ve),ee.push(Ae,qe,Ve)}this.setIndex(ee),this.setAttribute("position",new ei(ie,3)),this.setAttribute("normal",new ei(ce,3)),this.setAttribute("uv",new ei(re,2))}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new Gh(n.width,n.height,n.widthSegments,n.heightSegments)}}var PD=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,DD=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,ND=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,OD=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,FD=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,kD=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,UD=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,GD=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,VD=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,QD=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,HD=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zD=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,jD=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,WD=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,$D=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,XD=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,KD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,YD=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,qD=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,JD=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ZD=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,e9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,t9=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,n9=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,i9=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,r9=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,s9=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,o9=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,a9=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,l9=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,c9="gl_FragColor = linearToOutputTexel( gl_FragColor );",u9=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,h9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,f9=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,d9=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,p9=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,m9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,A9=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,g9=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,v9=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,b9=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,y9=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,_9=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,E9=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,w9=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,C9=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,x9=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,M9=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,S9=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,T9=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,I9=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,B9=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,R9=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,L9=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,P9=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,D9=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,N9=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,O9=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,F9=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,k9=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,U9=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,G9=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,V9=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Q9=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,H9=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,z9=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,j9=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,W9=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,$9=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,X9=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,K9=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Y9=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,q9=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,J9=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Z9=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,eN=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,tN=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,nN=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,iN=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,rN=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,sN=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,oN=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,aN=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,lN=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,cN=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,uN=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,hN=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,fN=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,dN=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,pN=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,mN=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,AN=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,gN=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,vN=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,bN=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,yN=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,_N=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,EN=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,wN=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,CN=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,xN=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,MN=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,SN=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,TN=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,IN=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,BN=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,RN=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Ni={alphahash_fragment:PD,alphahash_pars_fragment:DD,alphamap_fragment:ND,alphamap_pars_fragment:OD,alphatest_fragment:FD,alphatest_pars_fragment:kD,aomap_fragment:UD,aomap_pars_fragment:GD,batching_pars_vertex:VD,batching_vertex:QD,begin_vertex:HD,beginnormal_vertex:zD,bsdfs:jD,iridescence_fragment:WD,bumpmap_pars_fragment:$D,clipping_planes_fragment:XD,clipping_planes_pars_fragment:KD,clipping_planes_pars_vertex:YD,clipping_planes_vertex:qD,color_fragment:JD,color_pars_fragment:ZD,color_pars_vertex:e9,color_vertex:t9,common:n9,cube_uv_reflection_fragment:i9,defaultnormal_vertex:r9,displacementmap_pars_vertex:s9,displacementmap_vertex:o9,emissivemap_fragment:a9,emissivemap_pars_fragment:l9,colorspace_fragment:c9,colorspace_pars_fragment:u9,envmap_fragment:h9,envmap_common_pars_fragment:f9,envmap_pars_fragment:d9,envmap_pars_vertex:p9,envmap_physical_pars_fragment:x9,envmap_vertex:m9,fog_vertex:A9,fog_pars_vertex:g9,fog_fragment:v9,fog_pars_fragment:b9,gradientmap_pars_fragment:y9,lightmap_pars_fragment:_9,lights_lambert_fragment:E9,lights_lambert_pars_fragment:w9,lights_pars_begin:C9,lights_toon_fragment:M9,lights_toon_pars_fragment:S9,lights_phong_fragment:T9,lights_phong_pars_fragment:I9,lights_physical_fragment:B9,lights_physical_pars_fragment:R9,lights_fragment_begin:L9,lights_fragment_maps:P9,lights_fragment_end:D9,logdepthbuf_fragment:N9,logdepthbuf_pars_fragment:O9,logdepthbuf_pars_vertex:F9,logdepthbuf_vertex:k9,map_fragment:U9,map_pars_fragment:G9,map_particle_fragment:V9,map_particle_pars_fragment:Q9,metalnessmap_fragment:H9,metalnessmap_pars_fragment:z9,morphinstance_vertex:j9,morphcolor_vertex:W9,morphnormal_vertex:$9,morphtarget_pars_vertex:X9,morphtarget_vertex:K9,normal_fragment_begin:Y9,normal_fragment_maps:q9,normal_pars_fragment:J9,normal_pars_vertex:Z9,normal_vertex:eN,normalmap_pars_fragment:tN,clearcoat_normal_fragment_begin:nN,clearcoat_normal_fragment_maps:iN,clearcoat_pars_fragment:rN,iridescence_pars_fragment:sN,opaque_fragment:oN,packing:aN,premultiplied_alpha_fragment:lN,project_vertex:cN,dithering_fragment:uN,dithering_pars_fragment:hN,roughnessmap_fragment:fN,roughnessmap_pars_fragment:dN,shadowmap_pars_fragment:pN,shadowmap_pars_vertex:mN,shadowmap_vertex:AN,shadowmask_pars_fragment:gN,skinbase_vertex:vN,skinning_pars_vertex:bN,skinning_vertex:yN,skinnormal_vertex:_N,specularmap_fragment:EN,specularmap_pars_fragment:wN,tonemapping_fragment:CN,tonemapping_pars_fragment:xN,transmission_fragment:MN,transmission_pars_fragment:SN,uv_pars_fragment:TN,uv_pars_vertex:IN,uv_vertex:BN,worldpos_vertex:RN,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Sn={common:{diffuse:{value:new Qn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new _i},alphaMap:{value:null},alphaMapTransform:{value:new _i},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new _i}},envmap:{envMap:{value:null},envMapRotation:{value:new _i},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new _i}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new _i}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new _i},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new _i},normalScale:{value:new Jt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new _i},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new _i}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new _i}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new _i}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Qn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Qn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new _i},alphaTest:{value:0},uvTransform:{value:new _i}},sprite:{diffuse:{value:new Qn(16777215)},opacity:{value:1},center:{value:new Jt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new _i},alphaMap:{value:null},alphaMapTransform:{value:new _i},alphaTest:{value:0}}},ka={basic:{uniforms:_o([Sn.common,Sn.specularmap,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.fog]),vertexShader:Ni.meshbasic_vert,fragmentShader:Ni.meshbasic_frag},lambert:{uniforms:_o([Sn.common,Sn.specularmap,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.fog,Sn.lights,{emissive:{value:new Qn(0)}}]),vertexShader:Ni.meshlambert_vert,fragmentShader:Ni.meshlambert_frag},phong:{uniforms:_o([Sn.common,Sn.specularmap,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.fog,Sn.lights,{emissive:{value:new Qn(0)},specular:{value:new Qn(1118481)},shininess:{value:30}}]),vertexShader:Ni.meshphong_vert,fragmentShader:Ni.meshphong_frag},standard:{uniforms:_o([Sn.common,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.roughnessmap,Sn.metalnessmap,Sn.fog,Sn.lights,{emissive:{value:new Qn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ni.meshphysical_vert,fragmentShader:Ni.meshphysical_frag},toon:{uniforms:_o([Sn.common,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.gradientmap,Sn.fog,Sn.lights,{emissive:{value:new Qn(0)}}]),vertexShader:Ni.meshtoon_vert,fragmentShader:Ni.meshtoon_frag},matcap:{uniforms:_o([Sn.common,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.fog,{matcap:{value:null}}]),vertexShader:Ni.meshmatcap_vert,fragmentShader:Ni.meshmatcap_frag},points:{uniforms:_o([Sn.points,Sn.fog]),vertexShader:Ni.points_vert,fragmentShader:Ni.points_frag},dashed:{uniforms:_o([Sn.common,Sn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ni.linedashed_vert,fragmentShader:Ni.linedashed_frag},depth:{uniforms:_o([Sn.common,Sn.displacementmap]),vertexShader:Ni.depth_vert,fragmentShader:Ni.depth_frag},normal:{uniforms:_o([Sn.common,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,{opacity:{value:1}}]),vertexShader:Ni.meshnormal_vert,fragmentShader:Ni.meshnormal_frag},sprite:{uniforms:_o([Sn.sprite,Sn.fog]),vertexShader:Ni.sprite_vert,fragmentShader:Ni.sprite_frag},background:{uniforms:{uvTransform:{value:new _i},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ni.background_vert,fragmentShader:Ni.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new _i}},vertexShader:Ni.backgroundCube_vert,fragmentShader:Ni.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ni.cube_vert,fragmentShader:Ni.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ni.equirect_vert,fragmentShader:Ni.equirect_frag},distanceRGBA:{uniforms:_o([Sn.common,Sn.displacementmap,{referencePosition:{value:new Ge},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ni.distanceRGBA_vert,fragmentShader:Ni.distanceRGBA_frag},shadow:{uniforms:_o([Sn.lights,Sn.fog,{color:{value:new Qn(0)},opacity:{value:1}}]),vertexShader:Ni.shadow_vert,fragmentShader:Ni.shadow_frag}};ka.physical={uniforms:_o([ka.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new _i},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new _i},clearcoatNormalScale:{value:new Jt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new _i},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new _i},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new _i},sheen:{value:0},sheenColor:{value:new Qn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new _i},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new _i},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new _i},transmissionSamplerSize:{value:new Jt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new _i},attenuationDistance:{value:0},attenuationColor:{value:new Qn(0)},specularColor:{value:new Qn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new _i},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new _i},anisotropyVector:{value:new Jt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new _i}}]),vertexShader:Ni.meshphysical_vert,fragmentShader:Ni.meshphysical_frag};const C0={r:0,b:0,g:0},yu=new ta,LN=new Kn;function PN(_,n,s,l,d,b,T){const B=new Qn(0);let N=b===!0?0:1,U,z,X=null,q=0,ee=null;function ie(we){let ve=we.isScene===!0?we.background:null;return ve&&ve.isTexture&&(ve=(we.backgroundBlurriness>0?s:n).get(ve)),ve}function ce(we){let ve=!1;const Ae=ie(we);Ae===null?te(B,N):Ae&&Ae.isColor&&(te(Ae,1),ve=!0);const qe=_.xr.getEnvironmentBlendMode();qe==="additive"?l.buffers.color.setClear(0,0,0,1,T):qe==="alpha-blend"&&l.buffers.color.setClear(0,0,0,0,T),(_.autoClear||ve)&&_.clear(_.autoClearColor,_.autoClearDepth,_.autoClearStencil)}function re(we,ve){const Ae=ie(ve);Ae&&(Ae.isCubeTexture||Ae.mapping===Ee)?(z===void 0&&(z=new ws(new vu(1e4,1e4,1e4),new Fa({name:"BackgroundCubeMaterial",uniforms:Fh(ka.backgroundCube.uniforms),vertexShader:ka.backgroundCube.vertexShader,fragmentShader:ka.backgroundCube.fragmentShader,side:I,depthTest:!1,depthWrite:!1,fog:!1})),z.geometry.deleteAttribute("normal"),z.geometry.deleteAttribute("uv"),z.onBeforeRender=function(qe,Ve,ze){this.matrixWorld.copyPosition(ze.matrixWorld)},Object.defineProperty(z.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),d.update(z)),yu.copy(ve.backgroundRotation),yu.x*=-1,yu.y*=-1,yu.z*=-1,Ae.isCubeTexture&&Ae.isRenderTargetTexture===!1&&(yu.y*=-1,yu.z*=-1),z.material.uniforms.envMap.value=Ae,z.material.uniforms.flipEnvMap.value=Ae.isCubeTexture&&Ae.isRenderTargetTexture===!1?-1:1,z.material.uniforms.backgroundBlurriness.value=ve.backgroundBlurriness,z.material.uniforms.backgroundIntensity.value=ve.backgroundIntensity,z.material.uniforms.backgroundRotation.value.setFromMatrix4(LN.makeRotationFromEuler(yu)),z.material.toneMapped=gr.getTransfer(Ae.colorSpace)!==Rr,(X!==Ae||q!==Ae.version||ee!==_.toneMapping)&&(z.material.needsUpdate=!0,X=Ae,q=Ae.version,ee=_.toneMapping),z.layers.enableAll(),we.unshift(z,z.geometry,z.material,0,0,null)):Ae&&Ae.isTexture&&(U===void 0&&(U=new ws(new Gh(2,2),new Fa({name:"BackgroundMaterial",uniforms:Fh(ka.background.uniforms),vertexShader:ka.background.vertexShader,fragmentShader:ka.background.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1})),U.geometry.deleteAttribute("normal"),Object.defineProperty(U.material,"map",{get:function(){return this.uniforms.t2D.value}}),d.update(U)),U.material.uniforms.t2D.value=Ae,U.material.uniforms.backgroundIntensity.value=ve.backgroundIntensity,U.material.toneMapped=gr.getTransfer(Ae.colorSpace)!==Rr,Ae.matrixAutoUpdate===!0&&Ae.updateMatrix(),U.material.uniforms.uvTransform.value.copy(Ae.matrix),(X!==Ae||q!==Ae.version||ee!==_.toneMapping)&&(U.material.needsUpdate=!0,X=Ae,q=Ae.version,ee=_.toneMapping),U.layers.enableAll(),we.unshift(U,U.geometry,U.material,0,0,null))}function te(we,ve){we.getRGB(C0,aC(_)),l.buffers.color.setClear(C0.r,C0.g,C0.b,ve,T)}return{getClearColor:function(){return B},setClearColor:function(we,ve=1){B.set(we),N=ve,te(B,N)},getClearAlpha:function(){return N},setClearAlpha:function(we){N=we,te(B,N)},render:ce,addToRenderList:re}}function DN(_,n){const s=_.getParameter(_.MAX_VERTEX_ATTRIBS),l={},d=q(null);let b=d,T=!1;function B(Ie,Ye,at,tt,ut){let wt=!1;const Yt=X(tt,at,Ye);b!==Yt&&(b=Yt,U(b.object)),wt=ee(Ie,tt,at,ut),wt&&ie(Ie,tt,at,ut),ut!==null&&n.update(ut,_.ELEMENT_ARRAY_BUFFER),(wt||T)&&(T=!1,Ae(Ie,Ye,at,tt),ut!==null&&_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,n.get(ut).buffer))}function N(){return _.createVertexArray()}function U(Ie){return _.bindVertexArray(Ie)}function z(Ie){return _.deleteVertexArray(Ie)}function X(Ie,Ye,at){const tt=at.wireframe===!0;let ut=l[Ie.id];ut===void 0&&(ut={},l[Ie.id]=ut);let wt=ut[Ye.id];wt===void 0&&(wt={},ut[Ye.id]=wt);let Yt=wt[tt];return Yt===void 0&&(Yt=q(N()),wt[tt]=Yt),Yt}function q(Ie){const Ye=[],at=[],tt=[];for(let ut=0;ut<s;ut++)Ye[ut]=0,at[ut]=0,tt[ut]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ye,enabledAttributes:at,attributeDivisors:tt,object:Ie,attributes:{},index:null}}function ee(Ie,Ye,at,tt){const ut=b.attributes,wt=Ye.attributes;let Yt=0;const _n=at.getAttributes();for(const Mt in _n)if(_n[Mt].location>=0){const vn=ut[Mt];let Xn=wt[Mt];if(Xn===void 0&&(Mt==="instanceMatrix"&&Ie.instanceMatrix&&(Xn=Ie.instanceMatrix),Mt==="instanceColor"&&Ie.instanceColor&&(Xn=Ie.instanceColor)),vn===void 0||vn.attribute!==Xn||Xn&&vn.data!==Xn.data)return!0;Yt++}return b.attributesNum!==Yt||b.index!==tt}function ie(Ie,Ye,at,tt){const ut={},wt=Ye.attributes;let Yt=0;const _n=at.getAttributes();for(const Mt in _n)if(_n[Mt].location>=0){let vn=wt[Mt];vn===void 0&&(Mt==="instanceMatrix"&&Ie.instanceMatrix&&(vn=Ie.instanceMatrix),Mt==="instanceColor"&&Ie.instanceColor&&(vn=Ie.instanceColor));const Xn={};Xn.attribute=vn,vn&&vn.data&&(Xn.data=vn.data),ut[Mt]=Xn,Yt++}b.attributes=ut,b.attributesNum=Yt,b.index=tt}function ce(){const Ie=b.newAttributes;for(let Ye=0,at=Ie.length;Ye<at;Ye++)Ie[Ye]=0}function re(Ie){te(Ie,0)}function te(Ie,Ye){const at=b.newAttributes,tt=b.enabledAttributes,ut=b.attributeDivisors;at[Ie]=1,tt[Ie]===0&&(_.enableVertexAttribArray(Ie),tt[Ie]=1),ut[Ie]!==Ye&&(_.vertexAttribDivisor(Ie,Ye),ut[Ie]=Ye)}function we(){const Ie=b.newAttributes,Ye=b.enabledAttributes;for(let at=0,tt=Ye.length;at<tt;at++)Ye[at]!==Ie[at]&&(_.disableVertexAttribArray(at),Ye[at]=0)}function ve(Ie,Ye,at,tt,ut,wt,Yt){Yt===!0?_.vertexAttribIPointer(Ie,Ye,at,ut,wt):_.vertexAttribPointer(Ie,Ye,at,tt,ut,wt)}function Ae(Ie,Ye,at,tt){ce();const ut=tt.attributes,wt=at.getAttributes(),Yt=Ye.defaultAttributeValues;for(const _n in wt){const Mt=wt[_n];if(Mt.location>=0){let mn=ut[_n];if(mn===void 0&&(_n==="instanceMatrix"&&Ie.instanceMatrix&&(mn=Ie.instanceMatrix),_n==="instanceColor"&&Ie.instanceColor&&(mn=Ie.instanceColor)),mn!==void 0){const vn=mn.normalized,Xn=mn.itemSize,Gi=n.get(mn);if(Gi===void 0)continue;const vr=Gi.buffer,Gr=Gi.type,fr=Gi.bytesPerElement,Lr=Gr===_.INT||Gr===_.UNSIGNED_INT||mn.gpuType===da;if(mn.isInterleavedBufferAttribute){const Jn=mn.data,en=Jn.stride,Cn=mn.offset;if(Jn.isInstancedInterleavedBuffer){for(let Tn=0;Tn<Mt.locationSize;Tn++)te(Mt.location+Tn,Jn.meshPerAttribute);Ie.isInstancedMesh!==!0&&tt._maxInstanceCount===void 0&&(tt._maxInstanceCount=Jn.meshPerAttribute*Jn.count)}else for(let Tn=0;Tn<Mt.locationSize;Tn++)re(Mt.location+Tn);_.bindBuffer(_.ARRAY_BUFFER,vr);for(let Tn=0;Tn<Mt.locationSize;Tn++)ve(Mt.location+Tn,Xn/Mt.locationSize,Gr,vn,en*fr,(Cn+Xn/Mt.locationSize*Tn)*fr,Lr)}else{if(mn.isInstancedBufferAttribute){for(let Jn=0;Jn<Mt.locationSize;Jn++)te(Mt.location+Jn,mn.meshPerAttribute);Ie.isInstancedMesh!==!0&&tt._maxInstanceCount===void 0&&(tt._maxInstanceCount=mn.meshPerAttribute*mn.count)}else for(let Jn=0;Jn<Mt.locationSize;Jn++)re(Mt.location+Jn);_.bindBuffer(_.ARRAY_BUFFER,vr);for(let Jn=0;Jn<Mt.locationSize;Jn++)ve(Mt.location+Jn,Xn/Mt.locationSize,Gr,vn,Xn*fr,Xn/Mt.locationSize*Jn*fr,Lr)}}else if(Yt!==void 0){const vn=Yt[_n];if(vn!==void 0)switch(vn.length){case 2:_.vertexAttrib2fv(Mt.location,vn);break;case 3:_.vertexAttrib3fv(Mt.location,vn);break;case 4:_.vertexAttrib4fv(Mt.location,vn);break;default:_.vertexAttrib1fv(Mt.location,vn)}}}}we()}function qe(){Ke();for(const Ie in l){const Ye=l[Ie];for(const at in Ye){const tt=Ye[at];for(const ut in tt)z(tt[ut].object),delete tt[ut];delete Ye[at]}delete l[Ie]}}function Ve(Ie){if(l[Ie.id]===void 0)return;const Ye=l[Ie.id];for(const at in Ye){const tt=Ye[at];for(const ut in tt)z(tt[ut].object),delete tt[ut];delete Ye[at]}delete l[Ie.id]}function ze(Ie){for(const Ye in l){const at=l[Ye];if(at[Ie.id]===void 0)continue;const tt=at[Ie.id];for(const ut in tt)z(tt[ut].object),delete tt[ut];delete at[Ie.id]}}function Ke(){De(),T=!0,b!==d&&(b=d,U(b.object))}function De(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:B,reset:Ke,resetDefaultState:De,dispose:qe,releaseStatesOfGeometry:Ve,releaseStatesOfProgram:ze,initAttributes:ce,enableAttribute:re,disableUnusedAttributes:we}}function NN(_,n,s){let l;function d(U){l=U}function b(U,z){_.drawArrays(l,U,z),s.update(z,l,1)}function T(U,z,X){X!==0&&(_.drawArraysInstanced(l,U,z,X),s.update(z,l,X))}function B(U,z,X){if(X===0)return;const q=n.get("WEBGL_multi_draw");if(q===null)for(let ee=0;ee<X;ee++)this.render(U[ee],z[ee]);else{q.multiDrawArraysWEBGL(l,U,0,z,0,X);let ee=0;for(let ie=0;ie<X;ie++)ee+=z[ie];s.update(ee,l,1)}}function N(U,z,X,q){if(X===0)return;const ee=n.get("WEBGL_multi_draw");if(ee===null)for(let ie=0;ie<U.length;ie++)T(U[ie],z[ie],q[ie]);else{ee.multiDrawArraysInstancedWEBGL(l,U,0,z,0,q,0,X);let ie=0;for(let ce=0;ce<X;ce++)ie+=z[ce];for(let ce=0;ce<q.length;ce++)s.update(ie,l,q[ce])}}this.setMode=d,this.render=b,this.renderInstances=T,this.renderMultiDraw=B,this.renderMultiDrawInstances=N}function ON(_,n,s,l){let d;function b(){if(d!==void 0)return d;if(n.has("EXT_texture_filter_anisotropic")===!0){const Ve=n.get("EXT_texture_filter_anisotropic");d=_.getParameter(Ve.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d}function T(Ve){return!(Ve!==We&&l.convert(Ve)!==_.getParameter(_.IMPLEMENTATION_COLOR_READ_FORMAT))}function B(Ve){const ze=Ve===Er&&(n.has("EXT_color_buffer_half_float")||n.has("EXT_color_buffer_float"));return!(Ve!==Hr&&l.convert(Ve)!==_.getParameter(_.IMPLEMENTATION_COLOR_READ_TYPE)&&Ve!==zr&&!ze)}function N(Ve){if(Ve==="highp"){if(_.getShaderPrecisionFormat(_.VERTEX_SHADER,_.HIGH_FLOAT).precision>0&&_.getShaderPrecisionFormat(_.FRAGMENT_SHADER,_.HIGH_FLOAT).precision>0)return"highp";Ve="mediump"}return Ve==="mediump"&&_.getShaderPrecisionFormat(_.VERTEX_SHADER,_.MEDIUM_FLOAT).precision>0&&_.getShaderPrecisionFormat(_.FRAGMENT_SHADER,_.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let U=s.precision!==void 0?s.precision:"highp";const z=N(U);z!==U&&(console.warn("THREE.WebGLRenderer:",U,"not supported, using",z,"instead."),U=z);const X=s.logarithmicDepthBuffer===!0,q=_.getParameter(_.MAX_TEXTURE_IMAGE_UNITS),ee=_.getParameter(_.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ie=_.getParameter(_.MAX_TEXTURE_SIZE),ce=_.getParameter(_.MAX_CUBE_MAP_TEXTURE_SIZE),re=_.getParameter(_.MAX_VERTEX_ATTRIBS),te=_.getParameter(_.MAX_VERTEX_UNIFORM_VECTORS),we=_.getParameter(_.MAX_VARYING_VECTORS),ve=_.getParameter(_.MAX_FRAGMENT_UNIFORM_VECTORS),Ae=ee>0,qe=_.getParameter(_.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:b,getMaxPrecision:N,textureFormatReadable:T,textureTypeReadable:B,precision:U,logarithmicDepthBuffer:X,maxTextures:q,maxVertexTextures:ee,maxTextureSize:ie,maxCubemapSize:ce,maxAttributes:re,maxVertexUniforms:te,maxVaryings:we,maxFragmentUniforms:ve,vertexTextures:Ae,maxSamples:qe}}function FN(_){const n=this;let s=null,l=0,d=!1,b=!1;const T=new Bc,B=new _i,N={value:null,needsUpdate:!1};this.uniform=N,this.numPlanes=0,this.numIntersection=0,this.init=function(X,q){const ee=X.length!==0||q||l!==0||d;return d=q,l=X.length,ee},this.beginShadows=function(){b=!0,z(null)},this.endShadows=function(){b=!1},this.setGlobalState=function(X,q){s=z(X,q,0)},this.setState=function(X,q,ee){const ie=X.clippingPlanes,ce=X.clipIntersection,re=X.clipShadows,te=_.get(X);if(!d||ie===null||ie.length===0||b&&!re)b?z(null):U();else{const we=b?0:l,ve=we*4;let Ae=te.clippingState||null;N.value=Ae,Ae=z(ie,q,ve,ee);for(let qe=0;qe!==ve;++qe)Ae[qe]=s[qe];te.clippingState=Ae,this.numIntersection=ce?this.numPlanes:0,this.numPlanes+=we}};function U(){N.value!==s&&(N.value=s,N.needsUpdate=l>0),n.numPlanes=l,n.numIntersection=0}function z(X,q,ee,ie){const ce=X!==null?X.length:0;let re=null;if(ce!==0){if(re=N.value,ie!==!0||re===null){const te=ee+ce*4,we=q.matrixWorldInverse;B.getNormalMatrix(we),(re===null||re.length<te)&&(re=new Float32Array(te));for(let ve=0,Ae=ee;ve!==ce;++ve,Ae+=4)T.copy(X[ve]).applyMatrix4(we,B),T.normal.toArray(re,Ae),re[Ae+3]=T.constant}N.value=re,N.needsUpdate=!0}return n.numPlanes=ce,n.numIntersection=0,re}}function kN(_){let n=new WeakMap;function s(T,B){return B===Z?T.mapping=le:B===pe&&(T.mapping=j),T}function l(T){if(T&&T.isTexture){const B=T.mapping;if(B===Z||B===pe)if(n.has(T)){const N=n.get(T).texture;return s(N,T.mapping)}else{const N=T.image;if(N&&N.height>0){const U=new fC(N.height);return U.fromEquirectangularTexture(_,T),n.set(T,U),T.addEventListener("dispose",d),s(U.texture,T.mapping)}else return null}}return T}function d(T){const B=T.target;B.removeEventListener("dispose",d);const N=n.get(B);N!==void 0&&(n.delete(B),N.dispose())}function b(){n=new WeakMap}return{get:l,dispose:b}}class x0 extends E0{constructor(n=-1,s=1,l=1,d=-1,b=.1,T=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=n,this.right=s,this.top=l,this.bottom=d,this.near=b,this.far=T,this.updateProjectionMatrix()}copy(n,s){return super.copy(n,s),this.left=n.left,this.right=n.right,this.top=n.top,this.bottom=n.bottom,this.near=n.near,this.far=n.far,this.zoom=n.zoom,this.view=n.view===null?null:Object.assign({},n.view),this}setViewOffset(n,s,l,d,b,T){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=s,this.view.offsetX=l,this.view.offsetY=d,this.view.width=b,this.view.height=T,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=(this.right-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),l=(this.right+this.left)/2,d=(this.top+this.bottom)/2;let b=l-n,T=l+n,B=d+s,N=d-s;if(this.view!==null&&this.view.enabled){const U=(this.right-this.left)/this.view.fullWidth/this.zoom,z=(this.top-this.bottom)/this.view.fullHeight/this.zoom;b+=U*this.view.offsetX,T=b+U*this.view.width,B-=z*this.view.offsetY,N=B-z*this.view.height}this.projectionMatrix.makeOrthographic(b,T,B,N,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const s=super.toJSON(n);return s.object.zoom=this.zoom,s.object.left=this.left,s.object.right=this.right,s.object.top=this.top,s.object.bottom=this.bottom,s.object.near=this.near,s.object.far=this.far,this.view!==null&&(s.object.view=Object.assign({},this.view)),s}}const Vh=4,dC=[.125,.215,.35,.446,.526,.582],_u=20,lb=new x0,pC=new Qn;let cb=null,ub=0,hb=0,fb=!1;const Eu=(1+Math.sqrt(5))/2,Qh=1/Eu,mC=[new Ge(-Eu,Qh,0),new Ge(Eu,Qh,0),new Ge(-Qh,0,Eu),new Ge(Qh,0,Eu),new Ge(0,Eu,-Qh),new Ge(0,Eu,Qh),new Ge(-1,1,-1),new Ge(1,1,-1),new Ge(-1,1,1),new Ge(1,1,1)];class db{constructor(n){this._renderer=n,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(n,s=0,l=.1,d=100){cb=this._renderer.getRenderTarget(),ub=this._renderer.getActiveCubeFace(),hb=this._renderer.getActiveMipmapLevel(),fb=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const b=this._allocateTargets();return b.depthBuffer=!0,this._sceneToCubeUV(n,l,d,b),s>0&&this._blur(b,0,0,s),this._applyPMREM(b),this._cleanup(b),b}fromEquirectangular(n,s=null){return this._fromTexture(n,s)}fromCubemap(n,s=null){return this._fromTexture(n,s)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=vC(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=gC(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(n){this._lodMax=Math.floor(Math.log2(n)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let n=0;n<this._lodPlanes.length;n++)this._lodPlanes[n].dispose()}_cleanup(n){this._renderer.setRenderTarget(cb,ub,hb),this._renderer.xr.enabled=fb,n.scissorTest=!1,M0(n,0,0,n.width,n.height)}_fromTexture(n,s){n.mapping===le||n.mapping===j?this._setSize(n.image.length===0?16:n.image[0].width||n.image[0].image.width):this._setSize(n.image.width/4),cb=this._renderer.getRenderTarget(),ub=this._renderer.getActiveCubeFace(),hb=this._renderer.getActiveMipmapLevel(),fb=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const l=s||this._allocateTargets();return this._textureToCubeUV(n,l),this._applyPMREM(l),this._cleanup(l),l}_allocateTargets(){const n=3*Math.max(this._cubeSize,112),s=4*this._cubeSize,l={magFilter:Dn,minFilter:Dn,generateMipmaps:!1,type:Er,format:We,colorSpace:Na,depthBuffer:!1},d=AC(n,s,l);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==n||this._pingPongRenderTarget.height!==s){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=AC(n,s,l);const{_lodMax:b}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=UN(b)),this._blurMaterial=GN(b,n,s)}return d}_compileMaterial(n){const s=new ws(this._lodPlanes[0],n);this._renderer.compile(s,lb)}_sceneToCubeUV(n,s,l,d){const B=new Bs(90,1,s,l),N=[1,-1,1,1,1,1],U=[1,1,1,-1,-1,-1],z=this._renderer,X=z.autoClear,q=z.toneMapping;z.getClearColor(pC),z.toneMapping=yt,z.autoClear=!1;const ee=new Tc({name:"PMREM.Background",side:I,depthWrite:!1,depthTest:!1}),ie=new ws(new vu,ee);let ce=!1;const re=n.background;re?re.isColor&&(ee.color.copy(re),n.background=null,ce=!0):(ee.color.copy(pC),ce=!0);for(let te=0;te<6;te++){const we=te%3;we===0?(B.up.set(0,N[te],0),B.lookAt(U[te],0,0)):we===1?(B.up.set(0,0,N[te]),B.lookAt(0,U[te],0)):(B.up.set(0,N[te],0),B.lookAt(0,0,U[te]));const ve=this._cubeSize;M0(d,we*ve,te>2?ve:0,ve,ve),z.setRenderTarget(d),ce&&z.render(ie,B),z.render(n,B)}ie.geometry.dispose(),ie.material.dispose(),z.toneMapping=q,z.autoClear=X,n.background=re}_textureToCubeUV(n,s){const l=this._renderer,d=n.mapping===le||n.mapping===j;d?(this._cubemapMaterial===null&&(this._cubemapMaterial=vC()),this._cubemapMaterial.uniforms.flipEnvMap.value=n.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=gC());const b=d?this._cubemapMaterial:this._equirectMaterial,T=new ws(this._lodPlanes[0],b),B=b.uniforms;B.envMap.value=n;const N=this._cubeSize;M0(s,0,0,3*N,2*N),l.setRenderTarget(s),l.render(T,lb)}_applyPMREM(n){const s=this._renderer,l=s.autoClear;s.autoClear=!1;const d=this._lodPlanes.length;for(let b=1;b<d;b++){const T=Math.sqrt(this._sigmas[b]*this._sigmas[b]-this._sigmas[b-1]*this._sigmas[b-1]),B=mC[(d-b-1)%mC.length];this._blur(n,b-1,b,T,B)}s.autoClear=l}_blur(n,s,l,d,b){const T=this._pingPongRenderTarget;this._halfBlur(n,T,s,l,d,"latitudinal",b),this._halfBlur(T,n,l,l,d,"longitudinal",b)}_halfBlur(n,s,l,d,b,T,B){const N=this._renderer,U=this._blurMaterial;T!=="latitudinal"&&T!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const z=3,X=new ws(this._lodPlanes[d],U),q=U.uniforms,ee=this._sizeLods[l]-1,ie=isFinite(b)?Math.PI/(2*ee):2*Math.PI/(2*_u-1),ce=b/ie,re=isFinite(b)?1+Math.floor(z*ce):_u;re>_u&&console.warn(`sigmaRadians, ${b}, is too large and will clip, as it requested ${re} samples when the maximum is set to ${_u}`);const te=[];let we=0;for(let ze=0;ze<_u;++ze){const Ke=ze/ce,De=Math.exp(-Ke*Ke/2);te.push(De),ze===0?we+=De:ze<re&&(we+=2*De)}for(let ze=0;ze<te.length;ze++)te[ze]=te[ze]/we;q.envMap.value=n.texture,q.samples.value=re,q.weights.value=te,q.latitudinal.value=T==="latitudinal",B&&(q.poleAxis.value=B);const{_lodMax:ve}=this;q.dTheta.value=ie,q.mipInt.value=ve-l;const Ae=this._sizeLods[d],qe=3*Ae*(d>ve-Vh?d-ve+Vh:0),Ve=4*(this._cubeSize-Ae);M0(s,qe,Ve,3*Ae,2*Ae),N.setRenderTarget(s),N.render(X,lb)}}function UN(_){const n=[],s=[],l=[];let d=_;const b=_-Vh+1+dC.length;for(let T=0;T<b;T++){const B=Math.pow(2,d);s.push(B);let N=1/B;T>_-Vh?N=dC[T-_+Vh-1]:T===0&&(N=0),l.push(N);const U=1/(B-2),z=-U,X=1+U,q=[z,z,X,z,X,X,z,z,X,X,z,X],ee=6,ie=6,ce=3,re=2,te=1,we=new Float32Array(ce*ie*ee),ve=new Float32Array(re*ie*ee),Ae=new Float32Array(te*ie*ee);for(let Ve=0;Ve<ee;Ve++){const ze=Ve%3*2/3-1,Ke=Ve>2?0:-1,De=[ze,Ke,0,ze+2/3,Ke,0,ze+2/3,Ke+1,0,ze,Ke,0,ze+2/3,Ke+1,0,ze,Ke+1,0];we.set(De,ce*ie*Ve),ve.set(q,re*ie*Ve);const Ie=[Ve,Ve,Ve,Ve,Ve,Ve];Ae.set(Ie,te*ie*Ve)}const qe=new Ui;qe.setAttribute("position",new Tr(we,ce)),qe.setAttribute("uv",new Tr(ve,re)),qe.setAttribute("faceIndex",new Tr(Ae,te)),n.push(qe),d>Vh&&d--}return{lodPlanes:n,sizeLods:s,sigmas:l}}function AC(_,n,s){const l=new Do(_,n,s);return l.texture.mapping=Ee,l.texture.name="PMREM.cubeUv",l.scissorTest=!0,l}function M0(_,n,s,l,d){_.viewport.set(n,s,l,d),_.scissor.set(n,s,l,d)}function GN(_,n,s){const l=new Float32Array(_u),d=new Ge(0,1,0);return new Fa({name:"SphericalGaussianBlur",defines:{n:_u,CUBEUV_TEXEL_WIDTH:1/n,CUBEUV_TEXEL_HEIGHT:1/s,CUBEUV_MAX_MIP:`${_}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:l},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:d}},vertexShader:pb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:R,depthTest:!1,depthWrite:!1})}function gC(){return new Fa({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:pb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:R,depthTest:!1,depthWrite:!1})}function vC(){return new Fa({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:pb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:R,depthTest:!1,depthWrite:!1})}function pb(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function VN(_){let n=new WeakMap,s=null;function l(B){if(B&&B.isTexture){const N=B.mapping,U=N===Z||N===pe,z=N===le||N===j;if(U||z){let X=n.get(B);const q=X!==void 0?X.texture.pmremVersion:0;if(B.isRenderTargetTexture&&B.pmremVersion!==q)return s===null&&(s=new db(_)),X=U?s.fromEquirectangular(B,X):s.fromCubemap(B,X),X.texture.pmremVersion=B.pmremVersion,n.set(B,X),X.texture;if(X!==void 0)return X.texture;{const ee=B.image;return U&&ee&&ee.height>0||z&&ee&&d(ee)?(s===null&&(s=new db(_)),X=U?s.fromEquirectangular(B):s.fromCubemap(B),X.texture.pmremVersion=B.pmremVersion,n.set(B,X),B.addEventListener("dispose",b),X.texture):null}}}return B}function d(B){let N=0;const U=6;for(let z=0;z<U;z++)B[z]!==void 0&&N++;return N===U}function b(B){const N=B.target;N.removeEventListener("dispose",b);const U=n.get(N);U!==void 0&&(n.delete(N),U.dispose())}function T(){n=new WeakMap,s!==null&&(s.dispose(),s=null)}return{get:l,dispose:T}}function QN(_){const n={};function s(l){if(n[l]!==void 0)return n[l];let d;switch(l){case"WEBGL_depth_texture":d=_.getExtension("WEBGL_depth_texture")||_.getExtension("MOZ_WEBGL_depth_texture")||_.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":d=_.getExtension("EXT_texture_filter_anisotropic")||_.getExtension("MOZ_EXT_texture_filter_anisotropic")||_.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":d=_.getExtension("WEBGL_compressed_texture_s3tc")||_.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||_.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":d=_.getExtension("WEBGL_compressed_texture_pvrtc")||_.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=_.getExtension(l)}return n[l]=d,d}return{has:function(l){return s(l)!==null},init:function(){s("EXT_color_buffer_float"),s("WEBGL_clip_cull_distance"),s("OES_texture_float_linear"),s("EXT_color_buffer_half_float"),s("WEBGL_multisampled_render_to_texture"),s("WEBGL_render_shared_exponent")},get:function(l){const d=s(l);return d===null&&console.warn("THREE.WebGLRenderer: "+l+" extension not supported."),d}}}function HN(_,n,s,l){const d={},b=new WeakMap;function T(X){const q=X.target;q.index!==null&&n.remove(q.index);for(const ie in q.attributes)n.remove(q.attributes[ie]);for(const ie in q.morphAttributes){const ce=q.morphAttributes[ie];for(let re=0,te=ce.length;re<te;re++)n.remove(ce[re])}q.removeEventListener("dispose",T),delete d[q.id];const ee=b.get(q);ee&&(n.remove(ee),b.delete(q)),l.releaseStatesOfGeometry(q),q.isInstancedBufferGeometry===!0&&delete q._maxInstanceCount,s.memory.geometries--}function B(X,q){return d[q.id]===!0||(q.addEventListener("dispose",T),d[q.id]=!0,s.memory.geometries++),q}function N(X){const q=X.attributes;for(const ie in q)n.update(q[ie],_.ARRAY_BUFFER);const ee=X.morphAttributes;for(const ie in ee){const ce=ee[ie];for(let re=0,te=ce.length;re<te;re++)n.update(ce[re],_.ARRAY_BUFFER)}}function U(X){const q=[],ee=X.index,ie=X.attributes.position;let ce=0;if(ee!==null){const we=ee.array;ce=ee.version;for(let ve=0,Ae=we.length;ve<Ae;ve+=3){const qe=we[ve+0],Ve=we[ve+1],ze=we[ve+2];q.push(qe,Ve,Ve,ze,ze,qe)}}else if(ie!==void 0){const we=ie.array;ce=ie.version;for(let ve=0,Ae=we.length/3-1;ve<Ae;ve+=3){const qe=ve+0,Ve=ve+1,ze=ve+2;q.push(qe,Ve,Ve,ze,ze,qe)}}else return;const re=new(t0(q)?ib:nb)(q,1);re.version=ce;const te=b.get(X);te&&n.remove(te),b.set(X,re)}function z(X){const q=b.get(X);if(q){const ee=X.index;ee!==null&&q.version<ee.version&&U(X)}else U(X);return b.get(X)}return{get:B,update:N,getWireframeAttribute:z}}function zN(_,n,s){let l;function d(q){l=q}let b,T;function B(q){b=q.type,T=q.bytesPerElement}function N(q,ee){_.drawElements(l,ee,b,q*T),s.update(ee,l,1)}function U(q,ee,ie){ie!==0&&(_.drawElementsInstanced(l,ee,b,q*T,ie),s.update(ee,l,ie))}function z(q,ee,ie){if(ie===0)return;const ce=n.get("WEBGL_multi_draw");if(ce===null)for(let re=0;re<ie;re++)this.render(q[re]/T,ee[re]);else{ce.multiDrawElementsWEBGL(l,ee,0,b,q,0,ie);let re=0;for(let te=0;te<ie;te++)re+=ee[te];s.update(re,l,1)}}function X(q,ee,ie,ce){if(ie===0)return;const re=n.get("WEBGL_multi_draw");if(re===null)for(let te=0;te<q.length;te++)U(q[te]/T,ee[te],ce[te]);else{re.multiDrawElementsInstancedWEBGL(l,ee,0,b,q,0,ce,0,ie);let te=0;for(let we=0;we<ie;we++)te+=ee[we];for(let we=0;we<ce.length;we++)s.update(te,l,ce[we])}}this.setMode=d,this.setIndex=B,this.render=N,this.renderInstances=U,this.renderMultiDraw=z,this.renderMultiDrawInstances=X}function jN(_){const n={geometries:0,textures:0},s={frame:0,calls:0,triangles:0,points:0,lines:0};function l(b,T,B){switch(s.calls++,T){case _.TRIANGLES:s.triangles+=B*(b/3);break;case _.LINES:s.lines+=B*(b/2);break;case _.LINE_STRIP:s.lines+=B*(b-1);break;case _.LINE_LOOP:s.lines+=B*b;break;case _.POINTS:s.points+=B*b;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",T);break}}function d(){s.calls=0,s.triangles=0,s.points=0,s.lines=0}return{memory:n,render:s,programs:null,autoReset:!0,reset:d,update:l}}function WN(_,n,s){const l=new WeakMap,d=new ar;function b(T,B,N){const U=T.morphTargetInfluences,z=B.morphAttributes.position||B.morphAttributes.normal||B.morphAttributes.color,X=z!==void 0?z.length:0;let q=l.get(B);if(q===void 0||q.count!==X){let ee=function(){Ke.dispose(),l.delete(B),B.removeEventListener("dispose",ee)};q!==void 0&&q.texture.dispose();const ie=B.morphAttributes.position!==void 0,ce=B.morphAttributes.normal!==void 0,re=B.morphAttributes.color!==void 0,te=B.morphAttributes.position||[],we=B.morphAttributes.normal||[],ve=B.morphAttributes.color||[];let Ae=0;ie===!0&&(Ae=1),ce===!0&&(Ae=2),re===!0&&(Ae=3);let qe=B.attributes.position.count*Ae,Ve=1;qe>n.maxTextureSize&&(Ve=Math.ceil(qe/n.maxTextureSize),qe=n.maxTextureSize);const ze=new Float32Array(qe*Ve*4*X),Ke=new Ch(ze,qe,Ve,X);Ke.type=zr,Ke.needsUpdate=!0;const De=Ae*4;for(let Ie=0;Ie<X;Ie++){const Ye=te[Ie],at=we[Ie],tt=ve[Ie],ut=qe*Ve*4*Ie;for(let wt=0;wt<Ye.count;wt++){const Yt=wt*De;ie===!0&&(d.fromBufferAttribute(Ye,wt),ze[ut+Yt+0]=d.x,ze[ut+Yt+1]=d.y,ze[ut+Yt+2]=d.z,ze[ut+Yt+3]=0),ce===!0&&(d.fromBufferAttribute(at,wt),ze[ut+Yt+4]=d.x,ze[ut+Yt+5]=d.y,ze[ut+Yt+6]=d.z,ze[ut+Yt+7]=0),re===!0&&(d.fromBufferAttribute(tt,wt),ze[ut+Yt+8]=d.x,ze[ut+Yt+9]=d.y,ze[ut+Yt+10]=d.z,ze[ut+Yt+11]=tt.itemSize===4?d.w:1)}}q={count:X,texture:Ke,size:new Jt(qe,Ve)},l.set(B,q),B.addEventListener("dispose",ee)}if(T.isInstancedMesh===!0&&T.morphTexture!==null)N.getUniforms().setValue(_,"morphTexture",T.morphTexture,s);else{let ee=0;for(let ce=0;ce<U.length;ce++)ee+=U[ce];const ie=B.morphTargetsRelative?1:1-ee;N.getUniforms().setValue(_,"morphTargetBaseInfluence",ie),N.getUniforms().setValue(_,"morphTargetInfluences",U)}N.getUniforms().setValue(_,"morphTargetsTexture",q.texture,s),N.getUniforms().setValue(_,"morphTargetsTextureSize",q.size)}return{update:b}}class $N{constructor(n,s,l){if(this.renderer=n,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=l,this.extensions=s,this.available=this.extensions.has("OCULUS_multiview"),this.available){const b=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(b.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var d=0;d<this.maxNumViews;d++)this.mat4[d]=new Kn,this.mat3[d]=new _i}}getCameraArray(n){return n.isArrayCamera?n.cameras:(this.cameraArray[0]=n,this.cameraArray)}updateCameraProjectionMatricesUniform(n,s){for(var l=this.getCameraArray(n),d=0;d<l.length;d++)this.mat4[d].copy(l[d].projectionMatrix);s.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(n,s){for(var l=this.getCameraArray(n),d=0;d<l.length;d++)this.mat4[d].copy(l[d].matrixWorldInverse);s.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(n,s,l){for(var d=this.getCameraArray(s),b=0;b<d.length;b++)this.mat4[b].multiplyMatrices(d[b].matrixWorldInverse,n.matrixWorld),this.mat3[b].getNormalMatrix(this.mat4[b]);l.setValue(this.gl,"modelViewMatrices",this.mat4),l.setValue(this.gl,"normalMatrices",this.mat3)}}function XN(_,n,s,l){let d=new WeakMap;function b(N){const U=l.render.frame,z=N.geometry,X=n.get(N,z);if(d.get(X)!==U&&(n.update(X),d.set(X,U)),N.isInstancedMesh&&(N.hasEventListener("dispose",B)===!1&&N.addEventListener("dispose",B),d.get(N)!==U&&(s.update(N.instanceMatrix,_.ARRAY_BUFFER),N.instanceColor!==null&&s.update(N.instanceColor,_.ARRAY_BUFFER),d.set(N,U))),N.isSkinnedMesh){const q=N.skeleton;d.get(q)!==U&&(q.update(),d.set(q,U))}return X}function T(){d=new WeakMap}function B(N){const U=N.target;U.removeEventListener("dispose",B),s.remove(U.instanceMatrix),U.instanceColor!==null&&s.remove(U.instanceColor)}return{update:b,dispose:T}}class mb extends kr{constructor(n,s,l,d,b,T,B,N,U,z){if(z=z!==void 0?z:gt,z!==gt&&z!==Ht)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");l===void 0&&z===gt&&(l=Js),l===void 0&&z===Ht&&(l=Yo),super(null,d,b,T,B,N,z,l,U),this.isDepthTexture=!0,this.image={width:n,height:s},this.magFilter=B!==void 0?B:rn,this.minFilter=N!==void 0?N:rn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(n){return super.copy(n),this.compareFunction=n.compareFunction,this}toJSON(n){const s=super.toJSON(n);return this.compareFunction!==null&&(s.compareFunction=this.compareFunction),s}}const bC=new kr,yC=new mb(1,1);yC.compareFunction=hd;const _C=new Ch,EC=new Ei,wC=new _d,CC=[],xC=[],MC=new Float32Array(16),SC=new Float32Array(9),TC=new Float32Array(4);function Hh(_,n,s){const l=_[0];if(l<=0||l>0)return _;const d=n*s;let b=CC[d];if(b===void 0&&(b=new Float32Array(d),CC[d]=b),n!==0){l.toArray(b,0);for(let T=1,B=0;T!==n;++T)B+=s,_[T].toArray(b,B)}return b}function Rs(_,n){if(_.length!==n.length)return!1;for(let s=0,l=_.length;s<l;s++)if(_[s]!==n[s])return!1;return!0}function Ls(_,n){for(let s=0,l=n.length;s<l;s++)_[s]=n[s]}function S0(_,n){let s=xC[n];s===void 0&&(s=new Int32Array(n),xC[n]=s);for(let l=0;l!==n;++l)s[l]=_.allocateTextureUnit();return s}function KN(_,n){const s=this.cache;s[0]!==n&&(_.uniform1f(this.addr,n),s[0]=n)}function YN(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y)&&(_.uniform2f(this.addr,n.x,n.y),s[0]=n.x,s[1]=n.y);else{if(Rs(s,n))return;_.uniform2fv(this.addr,n),Ls(s,n)}}function qN(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z)&&(_.uniform3f(this.addr,n.x,n.y,n.z),s[0]=n.x,s[1]=n.y,s[2]=n.z);else if(n.r!==void 0)(s[0]!==n.r||s[1]!==n.g||s[2]!==n.b)&&(_.uniform3f(this.addr,n.r,n.g,n.b),s[0]=n.r,s[1]=n.g,s[2]=n.b);else{if(Rs(s,n))return;_.uniform3fv(this.addr,n),Ls(s,n)}}function JN(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z||s[3]!==n.w)&&(_.uniform4f(this.addr,n.x,n.y,n.z,n.w),s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=n.w);else{if(Rs(s,n))return;_.uniform4fv(this.addr,n),Ls(s,n)}}function ZN(_,n){const s=this.cache,l=n.elements;if(l===void 0){if(Rs(s,n))return;_.uniformMatrix2fv(this.addr,!1,n),Ls(s,n)}else{if(Rs(s,l))return;TC.set(l),_.uniformMatrix2fv(this.addr,!1,TC),Ls(s,l)}}function eO(_,n){const s=this.cache,l=n.elements;if(l===void 0){if(Rs(s,n))return;_.uniformMatrix3fv(this.addr,!1,n),Ls(s,n)}else{if(Rs(s,l))return;SC.set(l),_.uniformMatrix3fv(this.addr,!1,SC),Ls(s,l)}}function tO(_,n){const s=this.cache,l=n.elements;if(l===void 0){if(Rs(s,n))return;_.uniformMatrix4fv(this.addr,!1,n),Ls(s,n)}else{if(Rs(s,l))return;MC.set(l),_.uniformMatrix4fv(this.addr,!1,MC),Ls(s,l)}}function nO(_,n){const s=this.cache;s[0]!==n&&(_.uniform1i(this.addr,n),s[0]=n)}function iO(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y)&&(_.uniform2i(this.addr,n.x,n.y),s[0]=n.x,s[1]=n.y);else{if(Rs(s,n))return;_.uniform2iv(this.addr,n),Ls(s,n)}}function rO(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z)&&(_.uniform3i(this.addr,n.x,n.y,n.z),s[0]=n.x,s[1]=n.y,s[2]=n.z);else{if(Rs(s,n))return;_.uniform3iv(this.addr,n),Ls(s,n)}}function sO(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z||s[3]!==n.w)&&(_.uniform4i(this.addr,n.x,n.y,n.z,n.w),s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=n.w);else{if(Rs(s,n))return;_.uniform4iv(this.addr,n),Ls(s,n)}}function oO(_,n){const s=this.cache;s[0]!==n&&(_.uniform1ui(this.addr,n),s[0]=n)}function aO(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y)&&(_.uniform2ui(this.addr,n.x,n.y),s[0]=n.x,s[1]=n.y);else{if(Rs(s,n))return;_.uniform2uiv(this.addr,n),Ls(s,n)}}function lO(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z)&&(_.uniform3ui(this.addr,n.x,n.y,n.z),s[0]=n.x,s[1]=n.y,s[2]=n.z);else{if(Rs(s,n))return;_.uniform3uiv(this.addr,n),Ls(s,n)}}function cO(_,n){const s=this.cache;if(n.x!==void 0)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z||s[3]!==n.w)&&(_.uniform4ui(this.addr,n.x,n.y,n.z,n.w),s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=n.w);else{if(Rs(s,n))return;_.uniform4uiv(this.addr,n),Ls(s,n)}}function uO(_,n,s){const l=this.cache,d=s.allocateTextureUnit();l[0]!==d&&(_.uniform1i(this.addr,d),l[0]=d);const b=this.type===_.SAMPLER_2D_SHADOW?yC:bC;s.setTexture2D(n||b,d)}function hO(_,n,s){const l=this.cache,d=s.allocateTextureUnit();l[0]!==d&&(_.uniform1i(this.addr,d),l[0]=d),s.setTexture3D(n||EC,d)}function fO(_,n,s){const l=this.cache,d=s.allocateTextureUnit();l[0]!==d&&(_.uniform1i(this.addr,d),l[0]=d),s.setTextureCube(n||wC,d)}function dO(_,n,s){const l=this.cache,d=s.allocateTextureUnit();l[0]!==d&&(_.uniform1i(this.addr,d),l[0]=d),s.setTexture2DArray(n||_C,d)}function pO(_){switch(_){case 5126:return KN;case 35664:return YN;case 35665:return qN;case 35666:return JN;case 35674:return ZN;case 35675:return eO;case 35676:return tO;case 5124:case 35670:return nO;case 35667:case 35671:return iO;case 35668:case 35672:return rO;case 35669:case 35673:return sO;case 5125:return oO;case 36294:return aO;case 36295:return lO;case 36296:return cO;case 35678:case 36198:case 36298:case 36306:case 35682:return uO;case 35679:case 36299:case 36307:return hO;case 35680:case 36300:case 36308:case 36293:return fO;case 36289:case 36303:case 36311:case 36292:return dO}}function mO(_,n){_.uniform1fv(this.addr,n)}function AO(_,n){const s=Hh(n,this.size,2);_.uniform2fv(this.addr,s)}function gO(_,n){const s=Hh(n,this.size,3);_.uniform3fv(this.addr,s)}function vO(_,n){const s=Hh(n,this.size,4);_.uniform4fv(this.addr,s)}function bO(_,n){const s=Hh(n,this.size,4);_.uniformMatrix2fv(this.addr,!1,s)}function yO(_,n){const s=Hh(n,this.size,9);_.uniformMatrix3fv(this.addr,!1,s)}function _O(_,n){const s=Hh(n,this.size,16);_.uniformMatrix4fv(this.addr,!1,s)}function EO(_,n){_.uniform1iv(this.addr,n)}function wO(_,n){_.uniform2iv(this.addr,n)}function CO(_,n){_.uniform3iv(this.addr,n)}function xO(_,n){_.uniform4iv(this.addr,n)}function MO(_,n){_.uniform1uiv(this.addr,n)}function SO(_,n){_.uniform2uiv(this.addr,n)}function TO(_,n){_.uniform3uiv(this.addr,n)}function IO(_,n){_.uniform4uiv(this.addr,n)}function BO(_,n,s){const l=this.cache,d=n.length,b=S0(s,d);Rs(l,b)||(_.uniform1iv(this.addr,b),Ls(l,b));for(let T=0;T!==d;++T)s.setTexture2D(n[T]||bC,b[T])}function RO(_,n,s){const l=this.cache,d=n.length,b=S0(s,d);Rs(l,b)||(_.uniform1iv(this.addr,b),Ls(l,b));for(let T=0;T!==d;++T)s.setTexture3D(n[T]||EC,b[T])}function LO(_,n,s){const l=this.cache,d=n.length,b=S0(s,d);Rs(l,b)||(_.uniform1iv(this.addr,b),Ls(l,b));for(let T=0;T!==d;++T)s.setTextureCube(n[T]||wC,b[T])}function PO(_,n,s){const l=this.cache,d=n.length,b=S0(s,d);Rs(l,b)||(_.uniform1iv(this.addr,b),Ls(l,b));for(let T=0;T!==d;++T)s.setTexture2DArray(n[T]||_C,b[T])}function DO(_){switch(_){case 5126:return mO;case 35664:return AO;case 35665:return gO;case 35666:return vO;case 35674:return bO;case 35675:return yO;case 35676:return _O;case 5124:case 35670:return EO;case 35667:case 35671:return wO;case 35668:case 35672:return CO;case 35669:case 35673:return xO;case 5125:return MO;case 36294:return SO;case 36295:return TO;case 36296:return IO;case 35678:case 36198:case 36298:case 36306:case 35682:return BO;case 35679:case 36299:case 36307:return RO;case 35680:case 36300:case 36308:case 36293:return LO;case 36289:case 36303:case 36311:case 36292:return PO}}class NO{constructor(n,s,l){this.id=n,this.addr=l,this.cache=[],this.type=s.type,this.setValue=pO(s.type)}}class OO{constructor(n,s,l){this.id=n,this.addr=l,this.cache=[],this.type=s.type,this.size=s.size,this.setValue=DO(s.type)}}class FO{constructor(n){this.id=n,this.seq=[],this.map={}}setValue(n,s,l){const d=this.seq;for(let b=0,T=d.length;b!==T;++b){const B=d[b];B.setValue(n,s[B.id],l)}}}const Ab=/(\w+)(\])?(\[|\.)?/g;function IC(_,n){_.seq.push(n),_.map[n.id]=n}function kO(_,n,s){const l=_.name,d=l.length;for(Ab.lastIndex=0;;){const b=Ab.exec(l),T=Ab.lastIndex;let B=b[1];const N=b[2]==="]",U=b[3];if(N&&(B=B|0),U===void 0||U==="["&&T+2===d){IC(s,U===void 0?new NO(B,_,n):new OO(B,_,n));break}else{let X=s.map[B];X===void 0&&(X=new FO(B),IC(s,X)),s=X}}}class T0{constructor(n,s){this.seq=[],this.map={};const l=n.getProgramParameter(s,n.ACTIVE_UNIFORMS);for(let d=0;d<l;++d){const b=n.getActiveUniform(s,d),T=n.getUniformLocation(s,b.name);kO(b,T,this)}}setValue(n,s,l,d){const b=this.map[s];b!==void 0&&b.setValue(n,l,d)}setOptional(n,s,l){const d=s[l];d!==void 0&&this.setValue(n,l,d)}static upload(n,s,l,d){for(let b=0,T=s.length;b!==T;++b){const B=s[b],N=l[B.id];N.needsUpdate!==!1&&B.setValue(n,N.value,d)}}static seqWithValue(n,s){const l=[];for(let d=0,b=n.length;d!==b;++d){const T=n[d];T.id in s&&l.push(T)}return l}}function BC(_,n,s){const l=_.createShader(n);return _.shaderSource(l,s),_.compileShader(l),l}const UO=37297;let GO=0;function VO(_,n){const s=_.split(`
`),l=[],d=Math.max(n-6,0),b=Math.min(n+6,s.length);for(let T=d;T<b;T++){const B=T+1;l.push(`${B===n?">":" "} ${B}: ${s[T]}`)}return l.join(`
`)}function QO(_){const n=gr.getPrimaries(gr.workingColorSpace),s=gr.getPrimaries(_);let l;switch(n===s?l="":n===fu&&s===hu?l="LinearDisplayP3ToLinearSRGB":n===hu&&s===fu&&(l="LinearSRGBToLinearDisplayP3"),_){case Na:case cu:return[l,"LinearTransferOETF"];case rr:case yh:return[l,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",_),[l,"LinearTransferOETF"]}}function RC(_,n,s){const l=_.getShaderParameter(n,_.COMPILE_STATUS),d=_.getShaderInfoLog(n).trim();if(l&&d==="")return"";const b=/ERROR: 0:(\d+)/.exec(d);if(b){const T=parseInt(b[1]);return s.toUpperCase()+`

`+d+`

`+VO(_.getShaderSource(n),T)}else return d}function HO(_,n){const s=QO(n);return`vec4 ${_}( vec4 value ) { return ${s[0]}( ${s[1]}( value ) ); }`}function zO(_,n){let s;switch(n){case kn:s="Linear";break;case qn:s="Reinhard";break;case Gt:s="OptimizedCineon";break;case bt:s="ACESFilmic";break;case _e:s="AgX";break;case Ue:s="Neutral";break;case ye:s="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",n),s="Linear"}return"vec3 "+_+"( vec3 color ) { return "+s+"ToneMapping( color ); }"}function jO(_){return[_.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",_.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(wd).join(`
`)}function WO(_){const n=[];for(const s in _){const l=_[s];l!==!1&&n.push("#define "+s+" "+l)}return n.join(`
`)}function $O(_,n){const s={},l=_.getProgramParameter(n,_.ACTIVE_ATTRIBUTES);for(let d=0;d<l;d++){const b=_.getActiveAttrib(n,d),T=b.name;let B=1;b.type===_.FLOAT_MAT2&&(B=2),b.type===_.FLOAT_MAT3&&(B=3),b.type===_.FLOAT_MAT4&&(B=4),s[T]={type:b.type,location:_.getAttribLocation(n,T),locationSize:B}}return s}function wd(_){return _!==""}function LC(_,n){const s=n.numSpotLightShadows+n.numSpotLightMaps-n.numSpotLightShadowsWithMaps;return _.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,n.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,s).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,n.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function PC(_,n){return _.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}const XO=/^[ \t]*#include +<([\w\d./]+)>/gm;function gb(_){return _.replace(XO,YO)}const KO=new Map;function YO(_,n){let s=Ni[n];if(s===void 0){const l=KO.get(n);if(l!==void 0)s=Ni[l],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',n,l);else throw new Error("Can not resolve #include <"+n+">")}return gb(s)}const qO=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function DC(_){return _.replace(qO,JO)}function JO(_,n,s,l){let d="";for(let b=parseInt(n);b<parseInt(s);b++)d+=l.replace(/\[\s*i\s*\]/g,"[ "+b+" ]").replace(/UNROLLED_LOOP_INDEX/g,b);return d}function NC(_){let n=`precision ${_.precision} float;
	precision ${_.precision} int;
	precision ${_.precision} sampler2D;
	precision ${_.precision} samplerCube;
	precision ${_.precision} sampler3D;
	precision ${_.precision} sampler2DArray;
	precision ${_.precision} sampler2DShadow;
	precision ${_.precision} samplerCubeShadow;
	precision ${_.precision} sampler2DArrayShadow;
	precision ${_.precision} isampler2D;
	precision ${_.precision} isampler3D;
	precision ${_.precision} isamplerCube;
	precision ${_.precision} isampler2DArray;
	precision ${_.precision} usampler2D;
	precision ${_.precision} usampler3D;
	precision ${_.precision} usamplerCube;
	precision ${_.precision} usampler2DArray;
	`;return _.precision==="highp"?n+=`
#define HIGH_PRECISION`:_.precision==="mediump"?n+=`
#define MEDIUM_PRECISION`:_.precision==="lowp"&&(n+=`
#define LOW_PRECISION`),n}function ZO(_){let n="SHADOWMAP_TYPE_BASIC";return _.shadowMapType===x?n="SHADOWMAP_TYPE_PCF":_.shadowMapType===M?n="SHADOWMAP_TYPE_PCF_SOFT":_.shadowMapType===w&&(n="SHADOWMAP_TYPE_VSM"),n}function eF(_){let n="ENVMAP_TYPE_CUBE";if(_.envMap)switch(_.envMapMode){case le:case j:n="ENVMAP_TYPE_CUBE";break;case Ee:n="ENVMAP_TYPE_CUBE_UV";break}return n}function tF(_){let n="ENVMAP_MODE_REFLECTION";if(_.envMap)switch(_.envMapMode){case j:n="ENVMAP_MODE_REFRACTION";break}return n}function nF(_){let n="ENVMAP_BLENDING_NONE";if(_.envMap)switch(_.combine){case Tt:n="ENVMAP_BLENDING_MULTIPLY";break;case At:n="ENVMAP_BLENDING_MIX";break;case pn:n="ENVMAP_BLENDING_ADD";break}return n}function iF(_){const n=_.envMapCubeUVHeight;if(n===null)return null;const s=Math.log2(n)-2,l=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,s),7*16)),texelHeight:l,maxMip:s}}function rF(_,n,s,l){const d=_.getContext(),b=s.defines;let T=s.vertexShader,B=s.fragmentShader;const N=ZO(s),U=eF(s),z=tF(s),X=nF(s),q=iF(s),ee=jO(s),ie=WO(b),ce=d.createProgram();let re,te,we=s.glslVersion?"#version "+s.glslVersion+`
`:"";const ve=s.numMultiviewViews;s.isRawShaderMaterial?(re=["#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ie].filter(wd).join(`
`),re.length>0&&(re+=`
`),te=["#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ie].filter(wd).join(`
`),te.length>0&&(te+=`
`)):(re=[NC(s),"#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ie,s.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",s.batching?"#define USE_BATCHING":"",s.instancing?"#define USE_INSTANCING":"",s.instancingColor?"#define USE_INSTANCING_COLOR":"",s.instancingMorph?"#define USE_INSTANCING_MORPH":"",s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp2?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+z:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",s.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",s.displacementMap?"#define USE_DISPLACEMENTMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.anisotropy?"#define USE_ANISOTROPY":"",s.anisotropyMap?"#define USE_ANISOTROPYMAP":"",s.clearcoatMap?"#define USE_CLEARCOATMAP":"",s.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",s.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",s.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",s.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",s.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.alphaHash?"#define USE_ALPHAHASH":"",s.transmission?"#define USE_TRANSMISSION":"",s.transmissionMap?"#define USE_TRANSMISSIONMAP":"",s.thicknessMap?"#define USE_THICKNESSMAP":"",s.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",s.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",s.mapUv?"#define MAP_UV "+s.mapUv:"",s.alphaMapUv?"#define ALPHAMAP_UV "+s.alphaMapUv:"",s.lightMapUv?"#define LIGHTMAP_UV "+s.lightMapUv:"",s.aoMapUv?"#define AOMAP_UV "+s.aoMapUv:"",s.emissiveMapUv?"#define EMISSIVEMAP_UV "+s.emissiveMapUv:"",s.bumpMapUv?"#define BUMPMAP_UV "+s.bumpMapUv:"",s.normalMapUv?"#define NORMALMAP_UV "+s.normalMapUv:"",s.displacementMapUv?"#define DISPLACEMENTMAP_UV "+s.displacementMapUv:"",s.metalnessMapUv?"#define METALNESSMAP_UV "+s.metalnessMapUv:"",s.roughnessMapUv?"#define ROUGHNESSMAP_UV "+s.roughnessMapUv:"",s.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+s.anisotropyMapUv:"",s.clearcoatMapUv?"#define CLEARCOATMAP_UV "+s.clearcoatMapUv:"",s.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+s.clearcoatNormalMapUv:"",s.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+s.clearcoatRoughnessMapUv:"",s.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+s.iridescenceMapUv:"",s.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+s.iridescenceThicknessMapUv:"",s.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+s.sheenColorMapUv:"",s.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+s.sheenRoughnessMapUv:"",s.specularMapUv?"#define SPECULARMAP_UV "+s.specularMapUv:"",s.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+s.specularColorMapUv:"",s.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+s.specularIntensityMapUv:"",s.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+s.transmissionMapUv:"",s.thicknessMapUv?"#define THICKNESSMAP_UV "+s.thicknessMapUv:"",s.vertexTangents&&s.flatShading===!1?"#define USE_TANGENT":"",s.vertexColors?"#define USE_COLOR":"",s.vertexAlphas?"#define USE_COLOR_ALPHA":"",s.vertexUv1s?"#define USE_UV1":"",s.vertexUv2s?"#define USE_UV2":"",s.vertexUv3s?"#define USE_UV3":"",s.pointsUvs?"#define USE_POINTS_UV":"",s.flatShading?"#define FLAT_SHADED":"",s.skinning?"#define USE_SKINNING":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals&&s.flatShading===!1?"#define USE_MORPHNORMALS":"",s.morphColors?"#define USE_MORPHCOLORS":"",s.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",s.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+s.morphTextureStride:"",s.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+s.morphTargetsCount:"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+N:"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.numLightProbes>0?"#define USE_LIGHT_PROBES":"",s.useLegacyLights?"#define LEGACY_LIGHTS":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(wd).join(`
`),te=[NC(s),"#define SHADER_TYPE "+s.shaderType,"#define SHADER_NAME "+s.shaderName,ie,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp2?"#define FOG_EXP2":"",s.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",s.map?"#define USE_MAP":"",s.matcap?"#define USE_MATCAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+U:"",s.envMap?"#define "+z:"",s.envMap?"#define "+X:"",q?"#define CUBEUV_TEXEL_WIDTH "+q.texelWidth:"",q?"#define CUBEUV_TEXEL_HEIGHT "+q.texelHeight:"",q?"#define CUBEUV_MAX_MIP "+q.maxMip+".0":"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",s.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.anisotropy?"#define USE_ANISOTROPY":"",s.anisotropyMap?"#define USE_ANISOTROPYMAP":"",s.clearcoat?"#define USE_CLEARCOAT":"",s.clearcoatMap?"#define USE_CLEARCOATMAP":"",s.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",s.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",s.dispersion?"#define USE_DISPERSION":"",s.iridescence?"#define USE_IRIDESCENCE":"",s.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",s.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",s.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.alphaTest?"#define USE_ALPHATEST":"",s.alphaHash?"#define USE_ALPHAHASH":"",s.sheen?"#define USE_SHEEN":"",s.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",s.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",s.transmission?"#define USE_TRANSMISSION":"",s.transmissionMap?"#define USE_TRANSMISSIONMAP":"",s.thicknessMap?"#define USE_THICKNESSMAP":"",s.vertexTangents&&s.flatShading===!1?"#define USE_TANGENT":"",s.vertexColors||s.instancingColor?"#define USE_COLOR":"",s.vertexAlphas?"#define USE_COLOR_ALPHA":"",s.vertexUv1s?"#define USE_UV1":"",s.vertexUv2s?"#define USE_UV2":"",s.vertexUv3s?"#define USE_UV3":"",s.pointsUvs?"#define USE_POINTS_UV":"",s.gradientMap?"#define USE_GRADIENTMAP":"",s.flatShading?"#define FLAT_SHADED":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+N:"",s.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",s.numLightProbes>0?"#define USE_LIGHT_PROBES":"",s.useLegacyLights?"#define LEGACY_LIGHTS":"",s.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",s.toneMapping!==yt?"#define TONE_MAPPING":"",s.toneMapping!==yt?Ni.tonemapping_pars_fragment:"",s.toneMapping!==yt?zO("toneMapping",s.toneMapping):"",s.dithering?"#define DITHERING":"",s.opaque?"#define OPAQUE":"",Ni.colorspace_pars_fragment,HO("linearToOutputTexel",s.outputColorSpace),s.useDepthPacking?"#define DEPTH_PACKING "+s.depthPacking:"",`
`].filter(wd).join(`
`)),T=gb(T),T=LC(T,s),T=PC(T,s),B=gb(B),B=LC(B,s),B=PC(B,s),T=DC(T),B=DC(B),s.isRawShaderMaterial!==!0&&(we=`#version 300 es
`,re=[ee,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+re,te=["#define varying in",s.glslVersion===fd?"":"layout(location = 0) out highp vec4 pc_fragColor;",s.glslVersion===fd?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+te,ve>0&&(re=["#extension GL_OVR_multiview : require","layout(num_views = "+ve+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+re,re=re.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+ve+"];","uniform mat4 projectionMatrices["+ve+"];","uniform mat4 viewMatrices["+ve+"];","uniform mat3 normalMatrices["+ve+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),te=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+te,te=te.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+ve+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));const Ae=we+re+T,qe=we+te+B,Ve=BC(d,d.VERTEX_SHADER,Ae),ze=BC(d,d.FRAGMENT_SHADER,qe);d.attachShader(ce,Ve),d.attachShader(ce,ze),s.index0AttributeName!==void 0?d.bindAttribLocation(ce,0,s.index0AttributeName):s.morphTargets===!0&&d.bindAttribLocation(ce,0,"position"),d.linkProgram(ce);function Ke(at){if(_.debug.checkShaderErrors){const tt=d.getProgramInfoLog(ce).trim(),ut=d.getShaderInfoLog(Ve).trim(),wt=d.getShaderInfoLog(ze).trim();let Yt=!0,_n=!0;if(d.getProgramParameter(ce,d.LINK_STATUS)===!1)if(Yt=!1,typeof _.debug.onShaderError=="function")_.debug.onShaderError(d,ce,Ve,ze);else{const Mt=RC(d,Ve,"vertex"),mn=RC(d,ze,"fragment");console.error("THREE.WebGLProgram: Shader Error "+d.getError()+" - VALIDATE_STATUS "+d.getProgramParameter(ce,d.VALIDATE_STATUS)+`

Material Name: `+at.name+`
Material Type: `+at.type+`

Program Info Log: `+tt+`
`+Mt+`
`+mn)}else tt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",tt):(ut===""||wt==="")&&(_n=!1);_n&&(at.diagnostics={runnable:Yt,programLog:tt,vertexShader:{log:ut,prefix:re},fragmentShader:{log:wt,prefix:te}})}d.deleteShader(Ve),d.deleteShader(ze),De=new T0(d,ce),Ie=$O(d,ce)}let De;this.getUniforms=function(){return De===void 0&&Ke(this),De};let Ie;this.getAttributes=function(){return Ie===void 0&&Ke(this),Ie};let Ye=s.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Ye===!1&&(Ye=d.getProgramParameter(ce,UO)),Ye},this.destroy=function(){l.releaseStatesOfProgram(this),d.deleteProgram(ce),this.program=void 0},this.type=s.shaderType,this.name=s.shaderName,this.id=GO++,this.cacheKey=n,this.usedTimes=1,this.program=ce,this.vertexShader=Ve,this.fragmentShader=ze,this.numMultiviewViews=ve,this}let sF=0;class oF{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(n){const s=n.vertexShader,l=n.fragmentShader,d=this._getShaderStage(s),b=this._getShaderStage(l),T=this._getShaderCacheForMaterial(n);return T.has(d)===!1&&(T.add(d),d.usedTimes++),T.has(b)===!1&&(T.add(b),b.usedTimes++),this}remove(n){const s=this.materialCache.get(n);for(const l of s)l.usedTimes--,l.usedTimes===0&&this.shaderCache.delete(l.code);return this.materialCache.delete(n),this}getVertexShaderID(n){return this._getShaderStage(n.vertexShader).id}getFragmentShaderID(n){return this._getShaderStage(n.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(n){const s=this.materialCache;let l=s.get(n);return l===void 0&&(l=new Set,s.set(n,l)),l}_getShaderStage(n){const s=this.shaderCache;let l=s.get(n);return l===void 0&&(l=new aF(n),s.set(n,l)),l}}class aF{constructor(n){this.id=sF++,this.code=n,this.usedTimes=0}}function lF(_,n,s,l,d,b,T){const B=new u0,N=new oF,U=new Set,z=[],X=d.logarithmicDepthBuffer,q=d.vertexTextures;let ee=d.precision;const ie={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function ce(De){return U.add(De),De===0?"uv":`uv${De}`}function re(De,Ie,Ye,at,tt){const ut=at.fog,wt=tt.geometry,Yt=De.isMeshStandardMaterial?at.environment:null,_n=(De.isMeshStandardMaterial?s:n).get(De.envMap||Yt),Mt=_n&&_n.mapping===Ee?_n.image.height:null,mn=ie[De.type];De.precision!==null&&(ee=d.getMaxPrecision(De.precision),ee!==De.precision&&console.warn("THREE.WebGLProgram.getParameters:",De.precision,"not supported, using",ee,"instead."));const vn=wt.morphAttributes.position||wt.morphAttributes.normal||wt.morphAttributes.color,Xn=vn!==void 0?vn.length:0;let Gi=0;wt.morphAttributes.position!==void 0&&(Gi=1),wt.morphAttributes.normal!==void 0&&(Gi=2),wt.morphAttributes.color!==void 0&&(Gi=3);let vr,Gr,fr,Lr;if(mn){const Ps=ka[mn];vr=Ps.vertexShader,Gr=Ps.fragmentShader}else vr=De.vertexShader,Gr=De.fragmentShader,N.update(De),fr=N.getVertexShaderID(De),Lr=N.getFragmentShaderID(De);const Jn=_.getRenderTarget(),en=Jn&&Jn.isWebGLMultiviewRenderTarget?Jn.numViews:0,Cn=tt.isInstancedMesh===!0,Tn=tt.isBatchedMesh===!0,ht=!!De.map,tn=!!De.matcap,Qt=!!_n,dn=!!De.aoMap,hn=!!De.lightMap,cn=!!De.bumpMap,Ln=!!De.normalMap,Vn=!!De.displacementMap,yi=!!De.emissiveMap,xi=!!De.metalnessMap,dr=!!De.roughnessMap,rs=De.anisotropy>0,Vr=De.clearcoat>0,Xe=De.dispersion>0,Be=De.iridescence>0,Dt=De.sheen>0,Zt=De.transmission>0,sn=rs&&!!De.anisotropyMap,nn=Vr&&!!De.clearcoatMap,ni=Vr&&!!De.clearcoatNormalMap,En=Vr&&!!De.clearcoatRoughnessMap,Hn=Be&&!!De.iridescenceMap,xr=Be&&!!De.iridescenceThicknessMap,zn=Dt&&!!De.sheenColorMap,ri=Dt&&!!De.sheenRoughnessMap,Oi=!!De.specularMap,mi=!!De.specularColorMap,et=!!De.specularIntensityMap,un=Zt&&!!De.transmissionMap,bn=Zt&&!!De.thicknessMap,ii=!!De.gradientMap,Un=!!De.alphaMap,Fi=De.alphaTest>0,Gn=!!De.alphaHash,Pn=!!De.extensions;let Qi=yt;De.toneMapped&&(Jn===null||Jn.isXRRenderTarget===!0)&&(Qi=_.toneMapping);const gi={shaderID:mn,shaderType:De.type,shaderName:De.name,vertexShader:vr,fragmentShader:Gr,defines:De.defines,customVertexShaderID:fr,customFragmentShaderID:Lr,isRawShaderMaterial:De.isRawShaderMaterial===!0,glslVersion:De.glslVersion,precision:ee,batching:Tn,instancing:Cn,instancingColor:Cn&&tt.instanceColor!==null,instancingMorph:Cn&&tt.morphTexture!==null,supportsVertexTextures:q,numMultiviewViews:en,outputColorSpace:Jn===null?_.outputColorSpace:Jn.isXRRenderTarget===!0?Jn.texture.colorSpace:Na,alphaToCoverage:!!De.alphaToCoverage,map:ht,matcap:tn,envMap:Qt,envMapMode:Qt&&_n.mapping,envMapCubeUVHeight:Mt,aoMap:dn,lightMap:hn,bumpMap:cn,normalMap:Ln,displacementMap:q&&Vn,emissiveMap:yi,normalMapObjectSpace:Ln&&De.normalMapType===sl,normalMapTangentSpace:Ln&&De.normalMapType===ro,metalnessMap:xi,roughnessMap:dr,anisotropy:rs,anisotropyMap:sn,clearcoat:Vr,clearcoatMap:nn,clearcoatNormalMap:ni,clearcoatRoughnessMap:En,dispersion:Xe,iridescence:Be,iridescenceMap:Hn,iridescenceThicknessMap:xr,sheen:Dt,sheenColorMap:zn,sheenRoughnessMap:ri,specularMap:Oi,specularColorMap:mi,specularIntensityMap:et,transmission:Zt,transmissionMap:un,thicknessMap:bn,gradientMap:ii,opaque:De.transparent===!1&&De.blending===k&&De.alphaToCoverage===!1,alphaMap:Un,alphaTest:Fi,alphaHash:Gn,combine:De.combine,mapUv:ht&&ce(De.map.channel),aoMapUv:dn&&ce(De.aoMap.channel),lightMapUv:hn&&ce(De.lightMap.channel),bumpMapUv:cn&&ce(De.bumpMap.channel),normalMapUv:Ln&&ce(De.normalMap.channel),displacementMapUv:Vn&&ce(De.displacementMap.channel),emissiveMapUv:yi&&ce(De.emissiveMap.channel),metalnessMapUv:xi&&ce(De.metalnessMap.channel),roughnessMapUv:dr&&ce(De.roughnessMap.channel),anisotropyMapUv:sn&&ce(De.anisotropyMap.channel),clearcoatMapUv:nn&&ce(De.clearcoatMap.channel),clearcoatNormalMapUv:ni&&ce(De.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:En&&ce(De.clearcoatRoughnessMap.channel),iridescenceMapUv:Hn&&ce(De.iridescenceMap.channel),iridescenceThicknessMapUv:xr&&ce(De.iridescenceThicknessMap.channel),sheenColorMapUv:zn&&ce(De.sheenColorMap.channel),sheenRoughnessMapUv:ri&&ce(De.sheenRoughnessMap.channel),specularMapUv:Oi&&ce(De.specularMap.channel),specularColorMapUv:mi&&ce(De.specularColorMap.channel),specularIntensityMapUv:et&&ce(De.specularIntensityMap.channel),transmissionMapUv:un&&ce(De.transmissionMap.channel),thicknessMapUv:bn&&ce(De.thicknessMap.channel),alphaMapUv:Un&&ce(De.alphaMap.channel),vertexTangents:!!wt.attributes.tangent&&(Ln||rs),vertexColors:De.vertexColors,vertexAlphas:De.vertexColors===!0&&!!wt.attributes.color&&wt.attributes.color.itemSize===4,pointsUvs:tt.isPoints===!0&&!!wt.attributes.uv&&(ht||Un),fog:!!ut,useFog:De.fog===!0,fogExp2:!!ut&&ut.isFogExp2,flatShading:De.flatShading===!0,sizeAttenuation:De.sizeAttenuation===!0,logarithmicDepthBuffer:X,skinning:tt.isSkinnedMesh===!0,morphTargets:wt.morphAttributes.position!==void 0,morphNormals:wt.morphAttributes.normal!==void 0,morphColors:wt.morphAttributes.color!==void 0,morphTargetsCount:Xn,morphTextureStride:Gi,numDirLights:Ie.directional.length,numPointLights:Ie.point.length,numSpotLights:Ie.spot.length,numSpotLightMaps:Ie.spotLightMap.length,numRectAreaLights:Ie.rectArea.length,numHemiLights:Ie.hemi.length,numDirLightShadows:Ie.directionalShadowMap.length,numPointLightShadows:Ie.pointShadowMap.length,numSpotLightShadows:Ie.spotShadowMap.length,numSpotLightShadowsWithMaps:Ie.numSpotLightShadowsWithMaps,numLightProbes:Ie.numLightProbes,numClippingPlanes:T.numPlanes,numClipIntersection:T.numIntersection,dithering:De.dithering,shadowMapEnabled:_.shadowMap.enabled&&Ye.length>0,shadowMapType:_.shadowMap.type,toneMapping:Qi,useLegacyLights:_._useLegacyLights,decodeVideoTexture:ht&&De.map.isVideoTexture===!0&&gr.getTransfer(De.map.colorSpace)===Rr,premultipliedAlpha:De.premultipliedAlpha,doubleSided:De.side===L,flipSided:De.side===I,useDepthPacking:De.depthPacking>=0,depthPacking:De.depthPacking||0,index0AttributeName:De.index0AttributeName,extensionClipCullDistance:Pn&&De.extensions.clipCullDistance===!0&&l.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Pn&&De.extensions.multiDraw===!0&&l.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:l.has("KHR_parallel_shader_compile"),customProgramCacheKey:De.customProgramCacheKey()};return gi.vertexUv1s=U.has(1),gi.vertexUv2s=U.has(2),gi.vertexUv3s=U.has(3),U.clear(),gi}function te(De){const Ie=[];if(De.shaderID?Ie.push(De.shaderID):(Ie.push(De.customVertexShaderID),Ie.push(De.customFragmentShaderID)),De.defines!==void 0)for(const Ye in De.defines)Ie.push(Ye),Ie.push(De.defines[Ye]);return De.isRawShaderMaterial===!1&&(we(Ie,De),ve(Ie,De),Ie.push(_.outputColorSpace)),Ie.push(De.customProgramCacheKey),Ie.join()}function we(De,Ie){De.push(Ie.precision),De.push(Ie.outputColorSpace),De.push(Ie.envMapMode),De.push(Ie.envMapCubeUVHeight),De.push(Ie.mapUv),De.push(Ie.alphaMapUv),De.push(Ie.lightMapUv),De.push(Ie.aoMapUv),De.push(Ie.bumpMapUv),De.push(Ie.normalMapUv),De.push(Ie.displacementMapUv),De.push(Ie.emissiveMapUv),De.push(Ie.metalnessMapUv),De.push(Ie.roughnessMapUv),De.push(Ie.anisotropyMapUv),De.push(Ie.clearcoatMapUv),De.push(Ie.clearcoatNormalMapUv),De.push(Ie.clearcoatRoughnessMapUv),De.push(Ie.iridescenceMapUv),De.push(Ie.iridescenceThicknessMapUv),De.push(Ie.sheenColorMapUv),De.push(Ie.sheenRoughnessMapUv),De.push(Ie.specularMapUv),De.push(Ie.specularColorMapUv),De.push(Ie.specularIntensityMapUv),De.push(Ie.transmissionMapUv),De.push(Ie.thicknessMapUv),De.push(Ie.combine),De.push(Ie.fogExp2),De.push(Ie.sizeAttenuation),De.push(Ie.morphTargetsCount),De.push(Ie.morphAttributeCount),De.push(Ie.numDirLights),De.push(Ie.numPointLights),De.push(Ie.numSpotLights),De.push(Ie.numSpotLightMaps),De.push(Ie.numHemiLights),De.push(Ie.numRectAreaLights),De.push(Ie.numDirLightShadows),De.push(Ie.numPointLightShadows),De.push(Ie.numSpotLightShadows),De.push(Ie.numSpotLightShadowsWithMaps),De.push(Ie.numLightProbes),De.push(Ie.shadowMapType),De.push(Ie.toneMapping),De.push(Ie.numClippingPlanes),De.push(Ie.numClipIntersection),De.push(Ie.depthPacking)}function ve(De,Ie){B.disableAll(),Ie.supportsVertexTextures&&B.enable(0),Ie.instancing&&B.enable(1),Ie.instancingColor&&B.enable(2),Ie.instancingMorph&&B.enable(3),Ie.matcap&&B.enable(4),Ie.envMap&&B.enable(5),Ie.normalMapObjectSpace&&B.enable(6),Ie.normalMapTangentSpace&&B.enable(7),Ie.clearcoat&&B.enable(8),Ie.iridescence&&B.enable(9),Ie.alphaTest&&B.enable(10),Ie.vertexColors&&B.enable(11),Ie.vertexAlphas&&B.enable(12),Ie.vertexUv1s&&B.enable(13),Ie.vertexUv2s&&B.enable(14),Ie.vertexUv3s&&B.enable(15),Ie.vertexTangents&&B.enable(16),Ie.anisotropy&&B.enable(17),Ie.alphaHash&&B.enable(18),Ie.batching&&B.enable(19),Ie.dispersion&&B.enable(20),De.push(B.mask),B.disableAll(),Ie.fog&&B.enable(0),Ie.useFog&&B.enable(1),Ie.flatShading&&B.enable(2),Ie.logarithmicDepthBuffer&&B.enable(3),Ie.skinning&&B.enable(4),Ie.morphTargets&&B.enable(5),Ie.morphNormals&&B.enable(6),Ie.morphColors&&B.enable(7),Ie.premultipliedAlpha&&B.enable(8),Ie.shadowMapEnabled&&B.enable(9),Ie.useLegacyLights&&B.enable(10),Ie.doubleSided&&B.enable(11),Ie.flipSided&&B.enable(12),Ie.useDepthPacking&&B.enable(13),Ie.dithering&&B.enable(14),Ie.transmission&&B.enable(15),Ie.sheen&&B.enable(16),Ie.opaque&&B.enable(17),Ie.pointsUvs&&B.enable(18),Ie.decodeVideoTexture&&B.enable(19),Ie.alphaToCoverage&&B.enable(20),Ie.numMultiviewViews&&B.enable(21),De.push(B.mask)}function Ae(De){const Ie=ie[De.type];let Ye;if(Ie){const at=ka[Ie];Ye=lC.clone(at.uniforms)}else Ye=De.uniforms;return Ye}function qe(De,Ie){let Ye;for(let at=0,tt=z.length;at<tt;at++){const ut=z[at];if(ut.cacheKey===Ie){Ye=ut,++Ye.usedTimes;break}}return Ye===void 0&&(Ye=new rF(_,Ie,De,b),z.push(Ye)),Ye}function Ve(De){if(--De.usedTimes===0){const Ie=z.indexOf(De);z[Ie]=z[z.length-1],z.pop(),De.destroy()}}function ze(De){N.remove(De)}function Ke(){N.dispose()}return{getParameters:re,getProgramCacheKey:te,getUniforms:Ae,acquireProgram:qe,releaseProgram:Ve,releaseShaderCache:ze,programs:z,dispose:Ke}}function cF(){let _=new WeakMap;function n(b){let T=_.get(b);return T===void 0&&(T={},_.set(b,T)),T}function s(b){_.delete(b)}function l(b,T,B){_.get(b)[T]=B}function d(){_=new WeakMap}return{get:n,remove:s,update:l,dispose:d}}function uF(_,n){return _.groupOrder!==n.groupOrder?_.groupOrder-n.groupOrder:_.renderOrder!==n.renderOrder?_.renderOrder-n.renderOrder:_.material.id!==n.material.id?_.material.id-n.material.id:_.z!==n.z?_.z-n.z:_.id-n.id}function OC(_,n){return _.groupOrder!==n.groupOrder?_.groupOrder-n.groupOrder:_.renderOrder!==n.renderOrder?_.renderOrder-n.renderOrder:_.z!==n.z?n.z-_.z:_.id-n.id}function FC(){const _=[];let n=0;const s=[],l=[],d=[];function b(){n=0,s.length=0,l.length=0,d.length=0}function T(X,q,ee,ie,ce,re){let te=_[n];return te===void 0?(te={id:X.id,object:X,geometry:q,material:ee,groupOrder:ie,renderOrder:X.renderOrder,z:ce,group:re},_[n]=te):(te.id=X.id,te.object=X,te.geometry=q,te.material=ee,te.groupOrder=ie,te.renderOrder=X.renderOrder,te.z=ce,te.group=re),n++,te}function B(X,q,ee,ie,ce,re){const te=T(X,q,ee,ie,ce,re);ee.transmission>0?l.push(te):ee.transparent===!0?d.push(te):s.push(te)}function N(X,q,ee,ie,ce,re){const te=T(X,q,ee,ie,ce,re);ee.transmission>0?l.unshift(te):ee.transparent===!0?d.unshift(te):s.unshift(te)}function U(X,q){s.length>1&&s.sort(X||uF),l.length>1&&l.sort(q||OC),d.length>1&&d.sort(q||OC)}function z(){for(let X=n,q=_.length;X<q;X++){const ee=_[X];if(ee.id===null)break;ee.id=null,ee.object=null,ee.geometry=null,ee.material=null,ee.group=null}}return{opaque:s,transmissive:l,transparent:d,init:b,push:B,unshift:N,finish:z,sort:U}}function hF(){let _=new WeakMap;function n(l,d){const b=_.get(l);let T;return b===void 0?(T=new FC,_.set(l,[T])):d>=b.length?(T=new FC,b.push(T)):T=b[d],T}function s(){_=new WeakMap}return{get:n,dispose:s}}function fF(){const _={};return{get:function(n){if(_[n.id]!==void 0)return _[n.id];let s;switch(n.type){case"DirectionalLight":s={direction:new Ge,color:new Qn};break;case"SpotLight":s={position:new Ge,direction:new Ge,color:new Qn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":s={position:new Ge,color:new Qn,distance:0,decay:0};break;case"HemisphereLight":s={direction:new Ge,skyColor:new Qn,groundColor:new Qn};break;case"RectAreaLight":s={color:new Qn,position:new Ge,halfWidth:new Ge,halfHeight:new Ge};break}return _[n.id]=s,s}}}function dF(){const _={};return{get:function(n){if(_[n.id]!==void 0)return _[n.id];let s;switch(n.type){case"DirectionalLight":s={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"SpotLight":s={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt};break;case"PointLight":s={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Jt,shadowCameraNear:1,shadowCameraFar:1e3};break}return _[n.id]=s,s}}}let pF=0;function mF(_,n){return(n.castShadow?2:0)-(_.castShadow?2:0)+(n.map?1:0)-(_.map?1:0)}function AF(_){const n=new fF,s=dF(),l={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let U=0;U<9;U++)l.probe.push(new Ge);const d=new Ge,b=new Kn,T=new Kn;function B(U,z){let X=0,q=0,ee=0;for(let Ye=0;Ye<9;Ye++)l.probe[Ye].set(0,0,0);let ie=0,ce=0,re=0,te=0,we=0,ve=0,Ae=0,qe=0,Ve=0,ze=0,Ke=0;U.sort(mF);const De=z===!0?Math.PI:1;for(let Ye=0,at=U.length;Ye<at;Ye++){const tt=U[Ye],ut=tt.color,wt=tt.intensity,Yt=tt.distance,_n=tt.shadow&&tt.shadow.map?tt.shadow.map.texture:null;if(tt.isAmbientLight)X+=ut.r*wt*De,q+=ut.g*wt*De,ee+=ut.b*wt*De;else if(tt.isLightProbe){for(let Mt=0;Mt<9;Mt++)l.probe[Mt].addScaledVector(tt.sh.coefficients[Mt],wt);Ke++}else if(tt.isDirectionalLight){const Mt=n.get(tt);if(Mt.color.copy(tt.color).multiplyScalar(tt.intensity*De),tt.castShadow){const mn=tt.shadow,vn=s.get(tt);vn.shadowBias=mn.bias,vn.shadowNormalBias=mn.normalBias,vn.shadowRadius=mn.radius,vn.shadowMapSize=mn.mapSize,l.directionalShadow[ie]=vn,l.directionalShadowMap[ie]=_n,l.directionalShadowMatrix[ie]=tt.shadow.matrix,ve++}l.directional[ie]=Mt,ie++}else if(tt.isSpotLight){const Mt=n.get(tt);Mt.position.setFromMatrixPosition(tt.matrixWorld),Mt.color.copy(ut).multiplyScalar(wt*De),Mt.distance=Yt,Mt.coneCos=Math.cos(tt.angle),Mt.penumbraCos=Math.cos(tt.angle*(1-tt.penumbra)),Mt.decay=tt.decay,l.spot[re]=Mt;const mn=tt.shadow;if(tt.map&&(l.spotLightMap[Ve]=tt.map,Ve++,mn.updateMatrices(tt),tt.castShadow&&ze++),l.spotLightMatrix[re]=mn.matrix,tt.castShadow){const vn=s.get(tt);vn.shadowBias=mn.bias,vn.shadowNormalBias=mn.normalBias,vn.shadowRadius=mn.radius,vn.shadowMapSize=mn.mapSize,l.spotShadow[re]=vn,l.spotShadowMap[re]=_n,qe++}re++}else if(tt.isRectAreaLight){const Mt=n.get(tt);Mt.color.copy(ut).multiplyScalar(wt),Mt.halfWidth.set(tt.width*.5,0,0),Mt.halfHeight.set(0,tt.height*.5,0),l.rectArea[te]=Mt,te++}else if(tt.isPointLight){const Mt=n.get(tt);if(Mt.color.copy(tt.color).multiplyScalar(tt.intensity*De),Mt.distance=tt.distance,Mt.decay=tt.decay,tt.castShadow){const mn=tt.shadow,vn=s.get(tt);vn.shadowBias=mn.bias,vn.shadowNormalBias=mn.normalBias,vn.shadowRadius=mn.radius,vn.shadowMapSize=mn.mapSize,vn.shadowCameraNear=mn.camera.near,vn.shadowCameraFar=mn.camera.far,l.pointShadow[ce]=vn,l.pointShadowMap[ce]=_n,l.pointShadowMatrix[ce]=tt.shadow.matrix,Ae++}l.point[ce]=Mt,ce++}else if(tt.isHemisphereLight){const Mt=n.get(tt);Mt.skyColor.copy(tt.color).multiplyScalar(wt*De),Mt.groundColor.copy(tt.groundColor).multiplyScalar(wt*De),l.hemi[we]=Mt,we++}}te>0&&(_.has("OES_texture_float_linear")===!0?(l.rectAreaLTC1=Sn.LTC_FLOAT_1,l.rectAreaLTC2=Sn.LTC_FLOAT_2):(l.rectAreaLTC1=Sn.LTC_HALF_1,l.rectAreaLTC2=Sn.LTC_HALF_2)),l.ambient[0]=X,l.ambient[1]=q,l.ambient[2]=ee;const Ie=l.hash;(Ie.directionalLength!==ie||Ie.pointLength!==ce||Ie.spotLength!==re||Ie.rectAreaLength!==te||Ie.hemiLength!==we||Ie.numDirectionalShadows!==ve||Ie.numPointShadows!==Ae||Ie.numSpotShadows!==qe||Ie.numSpotMaps!==Ve||Ie.numLightProbes!==Ke)&&(l.directional.length=ie,l.spot.length=re,l.rectArea.length=te,l.point.length=ce,l.hemi.length=we,l.directionalShadow.length=ve,l.directionalShadowMap.length=ve,l.pointShadow.length=Ae,l.pointShadowMap.length=Ae,l.spotShadow.length=qe,l.spotShadowMap.length=qe,l.directionalShadowMatrix.length=ve,l.pointShadowMatrix.length=Ae,l.spotLightMatrix.length=qe+Ve-ze,l.spotLightMap.length=Ve,l.numSpotLightShadowsWithMaps=ze,l.numLightProbes=Ke,Ie.directionalLength=ie,Ie.pointLength=ce,Ie.spotLength=re,Ie.rectAreaLength=te,Ie.hemiLength=we,Ie.numDirectionalShadows=ve,Ie.numPointShadows=Ae,Ie.numSpotShadows=qe,Ie.numSpotMaps=Ve,Ie.numLightProbes=Ke,l.version=pF++)}function N(U,z){let X=0,q=0,ee=0,ie=0,ce=0;const re=z.matrixWorldInverse;for(let te=0,we=U.length;te<we;te++){const ve=U[te];if(ve.isDirectionalLight){const Ae=l.directional[X];Ae.direction.setFromMatrixPosition(ve.matrixWorld),d.setFromMatrixPosition(ve.target.matrixWorld),Ae.direction.sub(d),Ae.direction.transformDirection(re),X++}else if(ve.isSpotLight){const Ae=l.spot[ee];Ae.position.setFromMatrixPosition(ve.matrixWorld),Ae.position.applyMatrix4(re),Ae.direction.setFromMatrixPosition(ve.matrixWorld),d.setFromMatrixPosition(ve.target.matrixWorld),Ae.direction.sub(d),Ae.direction.transformDirection(re),ee++}else if(ve.isRectAreaLight){const Ae=l.rectArea[ie];Ae.position.setFromMatrixPosition(ve.matrixWorld),Ae.position.applyMatrix4(re),T.identity(),b.copy(ve.matrixWorld),b.premultiply(re),T.extractRotation(b),Ae.halfWidth.set(ve.width*.5,0,0),Ae.halfHeight.set(0,ve.height*.5,0),Ae.halfWidth.applyMatrix4(T),Ae.halfHeight.applyMatrix4(T),ie++}else if(ve.isPointLight){const Ae=l.point[q];Ae.position.setFromMatrixPosition(ve.matrixWorld),Ae.position.applyMatrix4(re),q++}else if(ve.isHemisphereLight){const Ae=l.hemi[ce];Ae.direction.setFromMatrixPosition(ve.matrixWorld),Ae.direction.transformDirection(re),ce++}}}return{setup:B,setupView:N,state:l}}function kC(_){const n=new AF(_),s=[],l=[];function d(z){U.camera=z,s.length=0,l.length=0}function b(z){s.push(z)}function T(z){l.push(z)}function B(z){n.setup(s,z)}function N(z){n.setupView(s,z)}const U={lightsArray:s,shadowsArray:l,camera:null,lights:n,transmissionRenderTarget:{}};return{init:d,state:U,setupLights:B,setupLightsView:N,pushLight:b,pushShadow:T}}function gF(_){let n=new WeakMap;function s(d,b=0){const T=n.get(d);let B;return T===void 0?(B=new kC(_),n.set(d,[B])):b>=T.length?(B=new kC(_),T.push(B)):B=T[b],B}function l(){n=new WeakMap}return{get:s,dispose:l}}class vb extends ao{constructor(n){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=il,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(n)}copy(n){return super.copy(n),this.depthPacking=n.depthPacking,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this}}class bb extends ao{constructor(n){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(n)}copy(n){return super.copy(n),this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this}}const vF=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,bF=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function yF(_,n,s){let l=new Ed;const d=new Jt,b=new Jt,T=new ar,B=new vb({depthPacking:rl}),N=new bb,U={},z=s.maxTextureSize,X={[S]:I,[I]:S,[L]:L},q=new Fa({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Jt},radius:{value:4}},vertexShader:vF,fragmentShader:bF}),ee=q.clone();ee.defines.HORIZONTAL_PASS=1;const ie=new Ui;ie.setAttribute("position",new Tr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const ce=new ws(ie,q),re=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=x;let te=this.type;this.render=function(Ve,ze,Ke){if(re.enabled===!1||re.autoUpdate===!1&&re.needsUpdate===!1||Ve.length===0)return;const De=_.getRenderTarget(),Ie=_.getActiveCubeFace(),Ye=_.getActiveMipmapLevel(),at=_.state;at.setBlending(R),at.buffers.color.setClear(1,1,1,1),at.buffers.depth.setTest(!0),at.setScissorTest(!1);const tt=te!==w&&this.type===w,ut=te===w&&this.type!==w;for(let wt=0,Yt=Ve.length;wt<Yt;wt++){const _n=Ve[wt],Mt=_n.shadow;if(Mt===void 0){console.warn("THREE.WebGLShadowMap:",_n,"has no shadow.");continue}if(Mt.autoUpdate===!1&&Mt.needsUpdate===!1)continue;d.copy(Mt.mapSize);const mn=Mt.getFrameExtents();if(d.multiply(mn),b.copy(Mt.mapSize),(d.x>z||d.y>z)&&(d.x>z&&(b.x=Math.floor(z/mn.x),d.x=b.x*mn.x,Mt.mapSize.x=b.x),d.y>z&&(b.y=Math.floor(z/mn.y),d.y=b.y*mn.y,Mt.mapSize.y=b.y)),Mt.map===null||tt===!0||ut===!0){const Xn=this.type!==w?{minFilter:rn,magFilter:rn}:{};Mt.map!==null&&Mt.map.dispose(),Mt.map=new Do(d.x,d.y,Xn),Mt.map.texture.name=_n.name+".shadowMap",Mt.camera.updateProjectionMatrix()}_.setRenderTarget(Mt.map),_.clear();const vn=Mt.getViewportCount();for(let Xn=0;Xn<vn;Xn++){const Gi=Mt.getViewport(Xn);T.set(b.x*Gi.x,b.y*Gi.y,b.x*Gi.z,b.y*Gi.w),at.viewport(T),Mt.updateMatrices(_n,Xn),l=Mt.getFrustum(),Ae(ze,Ke,Mt.camera,_n,this.type)}Mt.isPointLightShadow!==!0&&this.type===w&&we(Mt,Ke),Mt.needsUpdate=!1}te=this.type,re.needsUpdate=!1,_.setRenderTarget(De,Ie,Ye)};function we(Ve,ze){const Ke=n.update(ce);q.defines.VSM_SAMPLES!==Ve.blurSamples&&(q.defines.VSM_SAMPLES=Ve.blurSamples,ee.defines.VSM_SAMPLES=Ve.blurSamples,q.needsUpdate=!0,ee.needsUpdate=!0),Ve.mapPass===null&&(Ve.mapPass=new Do(d.x,d.y)),q.uniforms.shadow_pass.value=Ve.map.texture,q.uniforms.resolution.value=Ve.mapSize,q.uniforms.radius.value=Ve.radius,_.setRenderTarget(Ve.mapPass),_.clear(),_.renderBufferDirect(ze,null,Ke,q,ce,null),ee.uniforms.shadow_pass.value=Ve.mapPass.texture,ee.uniforms.resolution.value=Ve.mapSize,ee.uniforms.radius.value=Ve.radius,_.setRenderTarget(Ve.map),_.clear(),_.renderBufferDirect(ze,null,Ke,ee,ce,null)}function ve(Ve,ze,Ke,De){let Ie=null;const Ye=Ke.isPointLight===!0?Ve.customDistanceMaterial:Ve.customDepthMaterial;if(Ye!==void 0)Ie=Ye;else if(Ie=Ke.isPointLight===!0?N:B,_.localClippingEnabled&&ze.clipShadows===!0&&Array.isArray(ze.clippingPlanes)&&ze.clippingPlanes.length!==0||ze.displacementMap&&ze.displacementScale!==0||ze.alphaMap&&ze.alphaTest>0||ze.map&&ze.alphaTest>0){const at=Ie.uuid,tt=ze.uuid;let ut=U[at];ut===void 0&&(ut={},U[at]=ut);let wt=ut[tt];wt===void 0&&(wt=Ie.clone(),ut[tt]=wt,ze.addEventListener("dispose",qe)),Ie=wt}if(Ie.visible=ze.visible,Ie.wireframe=ze.wireframe,De===w?Ie.side=ze.shadowSide!==null?ze.shadowSide:ze.side:Ie.side=ze.shadowSide!==null?ze.shadowSide:X[ze.side],Ie.alphaMap=ze.alphaMap,Ie.alphaTest=ze.alphaTest,Ie.map=ze.map,Ie.clipShadows=ze.clipShadows,Ie.clippingPlanes=ze.clippingPlanes,Ie.clipIntersection=ze.clipIntersection,Ie.displacementMap=ze.displacementMap,Ie.displacementScale=ze.displacementScale,Ie.displacementBias=ze.displacementBias,Ie.wireframeLinewidth=ze.wireframeLinewidth,Ie.linewidth=ze.linewidth,Ke.isPointLight===!0&&Ie.isMeshDistanceMaterial===!0){const at=_.properties.get(Ie);at.light=Ke}return Ie}function Ae(Ve,ze,Ke,De,Ie){if(Ve.visible===!1)return;if(Ve.layers.test(ze.layers)&&(Ve.isMesh||Ve.isLine||Ve.isPoints)&&(Ve.castShadow||Ve.receiveShadow&&Ie===w)&&(!Ve.frustumCulled||l.intersectsObject(Ve))){Ve.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,Ve.matrixWorld);const tt=n.update(Ve),ut=Ve.material;if(Array.isArray(ut)){const wt=tt.groups;for(let Yt=0,_n=wt.length;Yt<_n;Yt++){const Mt=wt[Yt],mn=ut[Mt.materialIndex];if(mn&&mn.visible){const vn=ve(Ve,mn,De,Ie);Ve.onBeforeShadow(_,Ve,ze,Ke,tt,vn,Mt),_.renderBufferDirect(Ke,null,tt,vn,Ve,Mt),Ve.onAfterShadow(_,Ve,ze,Ke,tt,vn,Mt)}}}else if(ut.visible){const wt=ve(Ve,ut,De,Ie);Ve.onBeforeShadow(_,Ve,ze,Ke,tt,wt,null),_.renderBufferDirect(Ke,null,tt,wt,Ve,null),Ve.onAfterShadow(_,Ve,ze,Ke,tt,wt,null)}}const at=Ve.children;for(let tt=0,ut=at.length;tt<ut;tt++)Ae(at[tt],ze,Ke,De,Ie)}function qe(Ve){Ve.target.removeEventListener("dispose",qe);for(const Ke in U){const De=U[Ke],Ie=Ve.target.uuid;Ie in De&&(De[Ie].dispose(),delete De[Ie])}}}function _F(_){function n(){let et=!1;const un=new ar;let bn=null;const ii=new ar(0,0,0,0);return{setMask:function(Un){bn!==Un&&!et&&(_.colorMask(Un,Un,Un,Un),bn=Un)},setLocked:function(Un){et=Un},setClear:function(Un,Fi,Gn,Pn,Qi){Qi===!0&&(Un*=Pn,Fi*=Pn,Gn*=Pn),un.set(Un,Fi,Gn,Pn),ii.equals(un)===!1&&(_.clearColor(Un,Fi,Gn,Pn),ii.copy(un))},reset:function(){et=!1,bn=null,ii.set(-1,0,0,0)}}}function s(){let et=!1,un=null,bn=null,ii=null;return{setTest:function(Un){Un?Lr(_.DEPTH_TEST):Jn(_.DEPTH_TEST)},setMask:function(Un){un!==Un&&!et&&(_.depthMask(Un),un=Un)},setFunc:function(Un){if(bn!==Un){switch(Un){case mt:_.depthFunc(_.NEVER);break;case vt:_.depthFunc(_.ALWAYS);break;case ft:_.depthFunc(_.LESS);break;case Ze:_.depthFunc(_.LEQUAL);break;case St:_.depthFunc(_.EQUAL);break;case $t:_.depthFunc(_.GEQUAL);break;case ct:_.depthFunc(_.GREATER);break;case Ct:_.depthFunc(_.NOTEQUAL);break;default:_.depthFunc(_.LEQUAL)}bn=Un}},setLocked:function(Un){et=Un},setClear:function(Un){ii!==Un&&(_.clearDepth(Un),ii=Un)},reset:function(){et=!1,un=null,bn=null,ii=null}}}function l(){let et=!1,un=null,bn=null,ii=null,Un=null,Fi=null,Gn=null,Pn=null,Qi=null;return{setTest:function(gi){et||(gi?Lr(_.STENCIL_TEST):Jn(_.STENCIL_TEST))},setMask:function(gi){un!==gi&&!et&&(_.stencilMask(gi),un=gi)},setFunc:function(gi,Ps,ul){(bn!==gi||ii!==Ps||Un!==ul)&&(_.stencilFunc(gi,Ps,ul),bn=gi,ii=Ps,Un=ul)},setOp:function(gi,Ps,ul){(Fi!==gi||Gn!==Ps||Pn!==ul)&&(_.stencilOp(gi,Ps,ul),Fi=gi,Gn=Ps,Pn=ul)},setLocked:function(gi){et=gi},setClear:function(gi){Qi!==gi&&(_.clearStencil(gi),Qi=gi)},reset:function(){et=!1,un=null,bn=null,ii=null,Un=null,Fi=null,Gn=null,Pn=null,Qi=null}}}const d=new n,b=new s,T=new l,B=new WeakMap,N=new WeakMap;let U={},z={},X=new WeakMap,q=[],ee=null,ie=!1,ce=null,re=null,te=null,we=null,ve=null,Ae=null,qe=null,Ve=new Qn(0,0,0),ze=0,Ke=!1,De=null,Ie=null,Ye=null,at=null,tt=null;const ut=_.getParameter(_.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let wt=!1,Yt=0;const _n=_.getParameter(_.VERSION);_n.indexOf("WebGL")!==-1?(Yt=parseFloat(/^WebGL (\d)/.exec(_n)[1]),wt=Yt>=1):_n.indexOf("OpenGL ES")!==-1&&(Yt=parseFloat(/^OpenGL ES (\d)/.exec(_n)[1]),wt=Yt>=2);let Mt=null,mn={};const vn=_.getParameter(_.SCISSOR_BOX),Xn=_.getParameter(_.VIEWPORT),Gi=new ar().fromArray(vn),vr=new ar().fromArray(Xn);function Gr(et,un,bn,ii){const Un=new Uint8Array(4),Fi=_.createTexture();_.bindTexture(et,Fi),_.texParameteri(et,_.TEXTURE_MIN_FILTER,_.NEAREST),_.texParameteri(et,_.TEXTURE_MAG_FILTER,_.NEAREST);for(let Gn=0;Gn<bn;Gn++)et===_.TEXTURE_3D||et===_.TEXTURE_2D_ARRAY?_.texImage3D(un,0,_.RGBA,1,1,ii,0,_.RGBA,_.UNSIGNED_BYTE,Un):_.texImage2D(un+Gn,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,Un);return Fi}const fr={};fr[_.TEXTURE_2D]=Gr(_.TEXTURE_2D,_.TEXTURE_2D,1),fr[_.TEXTURE_CUBE_MAP]=Gr(_.TEXTURE_CUBE_MAP,_.TEXTURE_CUBE_MAP_POSITIVE_X,6),fr[_.TEXTURE_2D_ARRAY]=Gr(_.TEXTURE_2D_ARRAY,_.TEXTURE_2D_ARRAY,1,1),fr[_.TEXTURE_3D]=Gr(_.TEXTURE_3D,_.TEXTURE_3D,1,1),d.setClear(0,0,0,1),b.setClear(1),T.setClear(0),Lr(_.DEPTH_TEST),b.setFunc(Ze),hn(!1),cn(A),Lr(_.CULL_FACE),Qt(R);function Lr(et){U[et]!==!0&&(_.enable(et),U[et]=!0)}function Jn(et){U[et]!==!1&&(_.disable(et),U[et]=!1)}function en(et,un){return z[et]!==un?(_.bindFramebuffer(et,un),z[et]=un,et===_.DRAW_FRAMEBUFFER&&(z[_.FRAMEBUFFER]=un),et===_.FRAMEBUFFER&&(z[_.DRAW_FRAMEBUFFER]=un),!0):!1}function Cn(et,un){let bn=q,ii=!1;if(et){bn=X.get(un),bn===void 0&&(bn=[],X.set(un,bn));const Un=et.textures;if(bn.length!==Un.length||bn[0]!==_.COLOR_ATTACHMENT0){for(let Fi=0,Gn=Un.length;Fi<Gn;Fi++)bn[Fi]=_.COLOR_ATTACHMENT0+Fi;bn.length=Un.length,ii=!0}}else bn[0]!==_.BACK&&(bn[0]=_.BACK,ii=!0);ii&&_.drawBuffers(bn)}function Tn(et){return ee!==et?(_.useProgram(et),ee=et,!0):!1}const ht={[V]:_.FUNC_ADD,[$]:_.FUNC_SUBTRACT,[H]:_.FUNC_REVERSE_SUBTRACT};ht[Y]=_.MIN,ht[Q]=_.MAX;const tn={[G]:_.ZERO,[J]:_.ONE,[K]:_.SRC_COLOR,[ue]:_.SRC_ALPHA,[Le]:_.SRC_ALPHA_SATURATE,[Pe]:_.DST_COLOR,[Me]:_.DST_ALPHA,[se]:_.ONE_MINUS_SRC_COLOR,[he]:_.ONE_MINUS_SRC_ALPHA,[Se]:_.ONE_MINUS_DST_COLOR,[de]:_.ONE_MINUS_DST_ALPHA,[be]:_.CONSTANT_COLOR,[je]:_.ONE_MINUS_CONSTANT_COLOR,[Te]:_.CONSTANT_ALPHA,[rt]:_.ONE_MINUS_CONSTANT_ALPHA};function Qt(et,un,bn,ii,Un,Fi,Gn,Pn,Qi,gi){if(et===R){ie===!0&&(Jn(_.BLEND),ie=!1);return}if(ie===!1&&(Lr(_.BLEND),ie=!0),et!==W){if(et!==ce||gi!==Ke){if((re!==V||ve!==V)&&(_.blendEquation(_.FUNC_ADD),re=V,ve=V),gi)switch(et){case k:_.blendFuncSeparate(_.ONE,_.ONE_MINUS_SRC_ALPHA,_.ONE,_.ONE_MINUS_SRC_ALPHA);break;case P:_.blendFunc(_.ONE,_.ONE);break;case F:_.blendFuncSeparate(_.ZERO,_.ONE_MINUS_SRC_COLOR,_.ZERO,_.ONE);break;case O:_.blendFuncSeparate(_.ZERO,_.SRC_COLOR,_.ZERO,_.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",et);break}else switch(et){case k:_.blendFuncSeparate(_.SRC_ALPHA,_.ONE_MINUS_SRC_ALPHA,_.ONE,_.ONE_MINUS_SRC_ALPHA);break;case P:_.blendFunc(_.SRC_ALPHA,_.ONE);break;case F:_.blendFuncSeparate(_.ZERO,_.ONE_MINUS_SRC_COLOR,_.ZERO,_.ONE);break;case O:_.blendFunc(_.ZERO,_.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",et);break}te=null,we=null,Ae=null,qe=null,Ve.set(0,0,0),ze=0,ce=et,Ke=gi}return}Un=Un||un,Fi=Fi||bn,Gn=Gn||ii,(un!==re||Un!==ve)&&(_.blendEquationSeparate(ht[un],ht[Un]),re=un,ve=Un),(bn!==te||ii!==we||Fi!==Ae||Gn!==qe)&&(_.blendFuncSeparate(tn[bn],tn[ii],tn[Fi],tn[Gn]),te=bn,we=ii,Ae=Fi,qe=Gn),(Pn.equals(Ve)===!1||Qi!==ze)&&(_.blendColor(Pn.r,Pn.g,Pn.b,Qi),Ve.copy(Pn),ze=Qi),ce=et,Ke=!1}function dn(et,un){et.side===L?Jn(_.CULL_FACE):Lr(_.CULL_FACE);let bn=et.side===I;un&&(bn=!bn),hn(bn),et.blending===k&&et.transparent===!1?Qt(R):Qt(et.blending,et.blendEquation,et.blendSrc,et.blendDst,et.blendEquationAlpha,et.blendSrcAlpha,et.blendDstAlpha,et.blendColor,et.blendAlpha,et.premultipliedAlpha),b.setFunc(et.depthFunc),b.setTest(et.depthTest),b.setMask(et.depthWrite),d.setMask(et.colorWrite);const ii=et.stencilWrite;T.setTest(ii),ii&&(T.setMask(et.stencilWriteMask),T.setFunc(et.stencilFunc,et.stencilRef,et.stencilFuncMask),T.setOp(et.stencilFail,et.stencilZFail,et.stencilZPass)),Vn(et.polygonOffset,et.polygonOffsetFactor,et.polygonOffsetUnits),et.alphaToCoverage===!0?Lr(_.SAMPLE_ALPHA_TO_COVERAGE):Jn(_.SAMPLE_ALPHA_TO_COVERAGE)}function hn(et){De!==et&&(et?_.frontFace(_.CW):_.frontFace(_.CCW),De=et)}function cn(et){et!==v?(Lr(_.CULL_FACE),et!==Ie&&(et===A?_.cullFace(_.BACK):et===y?_.cullFace(_.FRONT):_.cullFace(_.FRONT_AND_BACK))):Jn(_.CULL_FACE),Ie=et}function Ln(et){et!==Ye&&(wt&&_.lineWidth(et),Ye=et)}function Vn(et,un,bn){et?(Lr(_.POLYGON_OFFSET_FILL),(at!==un||tt!==bn)&&(_.polygonOffset(un,bn),at=un,tt=bn)):Jn(_.POLYGON_OFFSET_FILL)}function yi(et){et?Lr(_.SCISSOR_TEST):Jn(_.SCISSOR_TEST)}function xi(et){et===void 0&&(et=_.TEXTURE0+ut-1),Mt!==et&&(_.activeTexture(et),Mt=et)}function dr(et,un,bn){bn===void 0&&(Mt===null?bn=_.TEXTURE0+ut-1:bn=Mt);let ii=mn[bn];ii===void 0&&(ii={type:void 0,texture:void 0},mn[bn]=ii),(ii.type!==et||ii.texture!==un)&&(Mt!==bn&&(_.activeTexture(bn),Mt=bn),_.bindTexture(et,un||fr[et]),ii.type=et,ii.texture=un)}function rs(){const et=mn[Mt];et!==void 0&&et.type!==void 0&&(_.bindTexture(et.type,null),et.type=void 0,et.texture=void 0)}function Vr(){try{_.compressedTexImage2D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function Xe(){try{_.compressedTexImage3D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function Be(){try{_.texSubImage2D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function Dt(){try{_.texSubImage3D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function Zt(){try{_.compressedTexSubImage2D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function sn(){try{_.compressedTexSubImage3D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function nn(){try{_.texStorage2D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function ni(){try{_.texStorage3D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function En(){try{_.texImage2D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function Hn(){try{_.texImage3D.apply(_,arguments)}catch(et){console.error("THREE.WebGLState:",et)}}function xr(et){Gi.equals(et)===!1&&(_.scissor(et.x,et.y,et.z,et.w),Gi.copy(et))}function zn(et){vr.equals(et)===!1&&(_.viewport(et.x,et.y,et.z,et.w),vr.copy(et))}function ri(et,un){let bn=N.get(un);bn===void 0&&(bn=new WeakMap,N.set(un,bn));let ii=bn.get(et);ii===void 0&&(ii=_.getUniformBlockIndex(un,et.name),bn.set(et,ii))}function Oi(et,un){const ii=N.get(un).get(et);B.get(un)!==ii&&(_.uniformBlockBinding(un,ii,et.__bindingPointIndex),B.set(un,ii))}function mi(){_.disable(_.BLEND),_.disable(_.CULL_FACE),_.disable(_.DEPTH_TEST),_.disable(_.POLYGON_OFFSET_FILL),_.disable(_.SCISSOR_TEST),_.disable(_.STENCIL_TEST),_.disable(_.SAMPLE_ALPHA_TO_COVERAGE),_.blendEquation(_.FUNC_ADD),_.blendFunc(_.ONE,_.ZERO),_.blendFuncSeparate(_.ONE,_.ZERO,_.ONE,_.ZERO),_.blendColor(0,0,0,0),_.colorMask(!0,!0,!0,!0),_.clearColor(0,0,0,0),_.depthMask(!0),_.depthFunc(_.LESS),_.clearDepth(1),_.stencilMask(4294967295),_.stencilFunc(_.ALWAYS,0,4294967295),_.stencilOp(_.KEEP,_.KEEP,_.KEEP),_.clearStencil(0),_.cullFace(_.BACK),_.frontFace(_.CCW),_.polygonOffset(0,0),_.activeTexture(_.TEXTURE0),_.bindFramebuffer(_.FRAMEBUFFER,null),_.bindFramebuffer(_.DRAW_FRAMEBUFFER,null),_.bindFramebuffer(_.READ_FRAMEBUFFER,null),_.useProgram(null),_.lineWidth(1),_.scissor(0,0,_.canvas.width,_.canvas.height),_.viewport(0,0,_.canvas.width,_.canvas.height),U={},Mt=null,mn={},z={},X=new WeakMap,q=[],ee=null,ie=!1,ce=null,re=null,te=null,we=null,ve=null,Ae=null,qe=null,Ve=new Qn(0,0,0),ze=0,Ke=!1,De=null,Ie=null,Ye=null,at=null,tt=null,Gi.set(0,0,_.canvas.width,_.canvas.height),vr.set(0,0,_.canvas.width,_.canvas.height),d.reset(),b.reset(),T.reset()}return{buffers:{color:d,depth:b,stencil:T},enable:Lr,disable:Jn,bindFramebuffer:en,drawBuffers:Cn,useProgram:Tn,setBlending:Qt,setMaterial:dn,setFlipSided:hn,setCullFace:cn,setLineWidth:Ln,setPolygonOffset:Vn,setScissorTest:yi,activeTexture:xi,bindTexture:dr,unbindTexture:rs,compressedTexImage2D:Vr,compressedTexImage3D:Xe,texImage2D:En,texImage3D:Hn,updateUBOMapping:ri,uniformBlockBinding:Oi,texStorage2D:nn,texStorage3D:ni,texSubImage2D:Be,texSubImage3D:Dt,compressedTexSubImage2D:Zt,compressedTexSubImage3D:sn,scissor:xr,viewport:zn,reset:mi}}function EF(_,n,s,l,d,b,T){const B=n.has("WEBGL_multisampled_render_to_texture")?n.get("WEBGL_multisampled_render_to_texture"):null,N=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),U=n.has("OCULUS_multiview")?n.get("OCULUS_multiview"):null,z=new Jt,X=new WeakMap;let q;const ee=new WeakMap;let ie=[],ce=!1,re=!1;try{re=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function te(Xe,Be){return re?new OffscreenCanvas(Xe,Be):Au("canvas")}function we(Xe,Be,Dt){let Zt=1;const sn=Vr(Xe);if((sn.width>Dt||sn.height>Dt)&&(Zt=Dt/Math.max(sn.width,sn.height)),Zt<1)if(typeof HTMLImageElement<"u"&&Xe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Xe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Xe instanceof ImageBitmap||typeof VideoFrame<"u"&&Xe instanceof VideoFrame){const nn=Math.floor(Zt*sn.width),ni=Math.floor(Zt*sn.height);q===void 0&&(q=te(nn,ni));const En=Be?te(nn,ni):q;return En.width=nn,En.height=ni,En.getContext("2d").drawImage(Xe,0,0,nn,ni),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+sn.width+"x"+sn.height+") to ("+nn+"x"+ni+")."),En}else return"data"in Xe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+sn.width+"x"+sn.height+")."),Xe;return Xe}function ve(Xe){return Xe.generateMipmaps&&Xe.minFilter!==rn&&Xe.minFilter!==Dn}function Ae(Xe){_.generateMipmap(Xe)}function qe(Xe,Be,Dt,Zt,sn=!1){if(Xe!==null){if(_[Xe]!==void 0)return _[Xe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Xe+"'")}let nn=Be;if(Be===_.RED&&(Dt===_.FLOAT&&(nn=_.R32F),Dt===_.HALF_FLOAT&&(nn=_.R16F),Dt===_.UNSIGNED_BYTE&&(nn=_.R8)),Be===_.RED_INTEGER&&(Dt===_.UNSIGNED_BYTE&&(nn=_.R8UI),Dt===_.UNSIGNED_SHORT&&(nn=_.R16UI),Dt===_.UNSIGNED_INT&&(nn=_.R32UI),Dt===_.BYTE&&(nn=_.R8I),Dt===_.SHORT&&(nn=_.R16I),Dt===_.INT&&(nn=_.R32I)),Be===_.RG&&(Dt===_.FLOAT&&(nn=_.RG32F),Dt===_.HALF_FLOAT&&(nn=_.RG16F),Dt===_.UNSIGNED_BYTE&&(nn=_.RG8)),Be===_.RG_INTEGER&&(Dt===_.UNSIGNED_BYTE&&(nn=_.RG8UI),Dt===_.UNSIGNED_SHORT&&(nn=_.RG16UI),Dt===_.UNSIGNED_INT&&(nn=_.RG32UI),Dt===_.BYTE&&(nn=_.RG8I),Dt===_.SHORT&&(nn=_.RG16I),Dt===_.INT&&(nn=_.RG32I)),Be===_.RGB&&Dt===_.UNSIGNED_INT_5_9_9_9_REV&&(nn=_.RGB9_E5),Be===_.RGBA){const ni=sn?uu:gr.getTransfer(Zt);Dt===_.FLOAT&&(nn=_.RGBA32F),Dt===_.HALF_FLOAT&&(nn=_.RGBA16F),Dt===_.UNSIGNED_BYTE&&(nn=ni===Rr?_.SRGB8_ALPHA8:_.RGBA8),Dt===_.UNSIGNED_SHORT_4_4_4_4&&(nn=_.RGBA4),Dt===_.UNSIGNED_SHORT_5_5_5_1&&(nn=_.RGB5_A1)}return(nn===_.R16F||nn===_.R32F||nn===_.RG16F||nn===_.RG32F||nn===_.RGBA16F||nn===_.RGBA32F)&&n.get("EXT_color_buffer_float"),nn}function Ve(Xe,Be){return ve(Xe)===!0||Xe.isFramebufferTexture&&Xe.minFilter!==rn&&Xe.minFilter!==Dn?Math.log2(Math.max(Be.width,Be.height))+1:Xe.mipmaps!==void 0&&Xe.mipmaps.length>0?Xe.mipmaps.length:Xe.isCompressedTexture&&Array.isArray(Xe.image)?Be.mipmaps.length:1}function ze(Xe){const Be=Xe.target;Be.removeEventListener("dispose",ze),De(Be),Be.isVideoTexture&&X.delete(Be)}function Ke(Xe){const Be=Xe.target;Be.removeEventListener("dispose",Ke),Ye(Be)}function De(Xe){const Be=l.get(Xe);if(Be.__webglInit===void 0)return;const Dt=Xe.source,Zt=ee.get(Dt);if(Zt){const sn=Zt[Be.__cacheKey];sn.usedTimes--,sn.usedTimes===0&&Ie(Xe),Object.keys(Zt).length===0&&ee.delete(Dt)}l.remove(Xe)}function Ie(Xe){const Be=l.get(Xe);_.deleteTexture(Be.__webglTexture);const Dt=Xe.source,Zt=ee.get(Dt);delete Zt[Be.__cacheKey],T.memory.textures--}function Ye(Xe){const Be=l.get(Xe);if(Xe.depthTexture&&Xe.depthTexture.dispose(),Xe.isWebGLCubeRenderTarget)for(let Zt=0;Zt<6;Zt++){if(Array.isArray(Be.__webglFramebuffer[Zt]))for(let sn=0;sn<Be.__webglFramebuffer[Zt].length;sn++)_.deleteFramebuffer(Be.__webglFramebuffer[Zt][sn]);else _.deleteFramebuffer(Be.__webglFramebuffer[Zt]);Be.__webglDepthbuffer&&_.deleteRenderbuffer(Be.__webglDepthbuffer[Zt])}else{if(Array.isArray(Be.__webglFramebuffer))for(let Zt=0;Zt<Be.__webglFramebuffer.length;Zt++)_.deleteFramebuffer(Be.__webglFramebuffer[Zt]);else _.deleteFramebuffer(Be.__webglFramebuffer);if(Be.__webglDepthbuffer&&_.deleteRenderbuffer(Be.__webglDepthbuffer),Be.__webglMultisampledFramebuffer&&_.deleteFramebuffer(Be.__webglMultisampledFramebuffer),Be.__webglColorRenderbuffer)for(let Zt=0;Zt<Be.__webglColorRenderbuffer.length;Zt++)Be.__webglColorRenderbuffer[Zt]&&_.deleteRenderbuffer(Be.__webglColorRenderbuffer[Zt]);Be.__webglDepthRenderbuffer&&_.deleteRenderbuffer(Be.__webglDepthRenderbuffer)}const Dt=Xe.textures;for(let Zt=0,sn=Dt.length;Zt<sn;Zt++){const nn=l.get(Dt[Zt]);nn.__webglTexture&&(_.deleteTexture(nn.__webglTexture),T.memory.textures--),l.remove(Dt[Zt])}l.remove(Xe)}let at=0;function tt(){at=0}function ut(){const Xe=at;return Xe>=d.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Xe+" texture units while this GPU supports only "+d.maxTextures),at+=1,Xe}function wt(Xe){const Be=[];return Be.push(Xe.wrapS),Be.push(Xe.wrapT),Be.push(Xe.wrapR||0),Be.push(Xe.magFilter),Be.push(Xe.minFilter),Be.push(Xe.anisotropy),Be.push(Xe.internalFormat),Be.push(Xe.format),Be.push(Xe.type),Be.push(Xe.generateMipmaps),Be.push(Xe.premultiplyAlpha),Be.push(Xe.flipY),Be.push(Xe.unpackAlignment),Be.push(Xe.colorSpace),Be.join()}function Yt(Xe,Be){const Dt=l.get(Xe);if(Xe.isVideoTexture&&dr(Xe),Xe.isRenderTargetTexture===!1&&Xe.version>0&&Dt.__version!==Xe.version){const Zt=Xe.image;if(Zt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Zt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(Jn(Dt,Xe,Be))return}s.bindTexture(_.TEXTURE_2D,Dt.__webglTexture,_.TEXTURE0+Be)}function _n(Xe,Be){const Dt=l.get(Xe);if(Xe.version>0&&Dt.__version!==Xe.version){Jn(Dt,Xe,Be);return}s.bindTexture(_.TEXTURE_2D_ARRAY,Dt.__webglTexture,_.TEXTURE0+Be)}function Mt(Xe,Be){const Dt=l.get(Xe);if(Xe.version>0&&Dt.__version!==Xe.version){Jn(Dt,Xe,Be);return}s.bindTexture(_.TEXTURE_3D,Dt.__webglTexture,_.TEXTURE0+Be)}function mn(Xe,Be){const Dt=l.get(Xe);if(Xe.version>0&&Dt.__version!==Xe.version){en(Dt,Xe,Be);return}s.bindTexture(_.TEXTURE_CUBE_MAP,Dt.__webglTexture,_.TEXTURE0+Be)}const vn={[Qe]:_.REPEAT,[He]:_.CLAMP_TO_EDGE,[Pt]:_.MIRRORED_REPEAT},Xn={[rn]:_.NEAREST,[Xt]:_.NEAREST_MIPMAP_NEAREST,[An]:_.NEAREST_MIPMAP_LINEAR,[Dn]:_.LINEAR,[Qr]:_.LINEAR_MIPMAP_NEAREST,[_r]:_.LINEAR_MIPMAP_LINEAR},Gi={[$m]:_.NEVER,[Zm]:_.ALWAYS,[Xm]:_.LESS,[hd]:_.LEQUAL,[Km]:_.EQUAL,[Jm]:_.GEQUAL,[Ym]:_.GREATER,[qm]:_.NOTEQUAL};function vr(Xe,Be){if(Be.type===zr&&n.has("OES_texture_float_linear")===!1&&(Be.magFilter===Dn||Be.magFilter===Qr||Be.magFilter===An||Be.magFilter===_r||Be.minFilter===Dn||Be.minFilter===Qr||Be.minFilter===An||Be.minFilter===_r)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),_.texParameteri(Xe,_.TEXTURE_WRAP_S,vn[Be.wrapS]),_.texParameteri(Xe,_.TEXTURE_WRAP_T,vn[Be.wrapT]),(Xe===_.TEXTURE_3D||Xe===_.TEXTURE_2D_ARRAY)&&_.texParameteri(Xe,_.TEXTURE_WRAP_R,vn[Be.wrapR]),_.texParameteri(Xe,_.TEXTURE_MAG_FILTER,Xn[Be.magFilter]),_.texParameteri(Xe,_.TEXTURE_MIN_FILTER,Xn[Be.minFilter]),Be.compareFunction&&(_.texParameteri(Xe,_.TEXTURE_COMPARE_MODE,_.COMPARE_REF_TO_TEXTURE),_.texParameteri(Xe,_.TEXTURE_COMPARE_FUNC,Gi[Be.compareFunction])),n.has("EXT_texture_filter_anisotropic")===!0){if(Be.magFilter===rn||Be.minFilter!==An&&Be.minFilter!==_r||Be.type===zr&&n.has("OES_texture_float_linear")===!1)return;if(Be.anisotropy>1||l.get(Be).__currentAnisotropy){const Dt=n.get("EXT_texture_filter_anisotropic");_.texParameterf(Xe,Dt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Be.anisotropy,d.getMaxAnisotropy())),l.get(Be).__currentAnisotropy=Be.anisotropy}}}function Gr(Xe,Be){let Dt=!1;Xe.__webglInit===void 0&&(Xe.__webglInit=!0,Be.addEventListener("dispose",ze));const Zt=Be.source;let sn=ee.get(Zt);sn===void 0&&(sn={},ee.set(Zt,sn));const nn=wt(Be);if(nn!==Xe.__cacheKey){sn[nn]===void 0&&(sn[nn]={texture:_.createTexture(),usedTimes:0},T.memory.textures++,Dt=!0),sn[nn].usedTimes++;const ni=sn[Xe.__cacheKey];ni!==void 0&&(sn[Xe.__cacheKey].usedTimes--,ni.usedTimes===0&&Ie(Be)),Xe.__cacheKey=nn,Xe.__webglTexture=sn[nn].texture}return Dt}function fr(Xe){ce=Xe}function Lr(){const Xe=ce;ce=!1;for(const Be of ie)Jn(Be.textureProperties,Be.texture,Be.slot),Be.texture.isPendingDeferredUpload=!1;ie=[],ce=Xe}function Jn(Xe,Be,Dt){if(ce)return Be.isPendingDeferredUpload||(Be.isPendingDeferredUpload=!0,ie.push({textureProperties:Xe,texture:Be,slot:Dt})),!1;let Zt=_.TEXTURE_2D;(Be.isDataArrayTexture||Be.isCompressedArrayTexture)&&(Zt=_.TEXTURE_2D_ARRAY),Be.isData3DTexture&&(Zt=_.TEXTURE_3D);const sn=Gr(Xe,Be),nn=Be.source;s.bindTexture(Zt,Xe.__webglTexture,_.TEXTURE0+Dt);const ni=l.get(nn);if(nn.version!==ni.__version||sn===!0){s.activeTexture(_.TEXTURE0+Dt);const En=gr.getPrimaries(gr.workingColorSpace),Hn=Be.colorSpace===Zs?null:gr.getPrimaries(Be.colorSpace),xr=Be.colorSpace===Zs||En===Hn?_.NONE:_.BROWSER_DEFAULT_WEBGL;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,Be.flipY),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Be.premultiplyAlpha),_.pixelStorei(_.UNPACK_ALIGNMENT,Be.unpackAlignment),_.pixelStorei(_.UNPACK_COLORSPACE_CONVERSION_WEBGL,xr);let zn=we(Be.image,!1,d.maxTextureSize);zn=rs(Be,zn);const ri=b.convert(Be.format,Be.colorSpace),Oi=b.convert(Be.type);let mi=qe(Be.internalFormat,ri,Oi,Be.colorSpace,Be.isVideoTexture);vr(Zt,Be);let et;const un=Be.mipmaps,bn=Be.isVideoTexture!==!0,ii=ni.__version===void 0||sn===!0,Un=nn.dataReady,Fi=Ve(Be,zn);if(Be.isDepthTexture)mi=_.DEPTH_COMPONENT16,Be.type===zr?mi=_.DEPTH_COMPONENT32F:Be.type===Js?mi=_.DEPTH_COMPONENT24:Be.type===Yo&&(mi=_.DEPTH24_STENCIL8),ii&&(bn?s.texStorage2D(_.TEXTURE_2D,1,mi,zn.width,zn.height):s.texImage2D(_.TEXTURE_2D,0,mi,zn.width,zn.height,0,ri,Oi,null));else if(Be.isDataTexture)if(un.length>0){bn&&ii&&s.texStorage2D(_.TEXTURE_2D,Fi,mi,un[0].width,un[0].height);for(let Gn=0,Pn=un.length;Gn<Pn;Gn++)et=un[Gn],bn?Un&&s.texSubImage2D(_.TEXTURE_2D,Gn,0,0,et.width,et.height,ri,Oi,et.data):s.texImage2D(_.TEXTURE_2D,Gn,mi,et.width,et.height,0,ri,Oi,et.data);Be.generateMipmaps=!1}else bn?(ii&&s.texStorage2D(_.TEXTURE_2D,Fi,mi,zn.width,zn.height),Un&&s.texSubImage2D(_.TEXTURE_2D,0,0,0,zn.width,zn.height,ri,Oi,zn.data)):s.texImage2D(_.TEXTURE_2D,0,mi,zn.width,zn.height,0,ri,Oi,zn.data);else if(Be.isCompressedTexture)if(Be.isCompressedArrayTexture){bn&&ii&&s.texStorage3D(_.TEXTURE_2D_ARRAY,Fi,mi,un[0].width,un[0].height,zn.depth);for(let Gn=0,Pn=un.length;Gn<Pn;Gn++)et=un[Gn],Be.format!==We?ri!==null?bn?Un&&s.compressedTexSubImage3D(_.TEXTURE_2D_ARRAY,Gn,0,0,0,et.width,et.height,zn.depth,ri,et.data,0,0):s.compressedTexImage3D(_.TEXTURE_2D_ARRAY,Gn,mi,et.width,et.height,zn.depth,0,et.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):bn?Un&&s.texSubImage3D(_.TEXTURE_2D_ARRAY,Gn,0,0,0,et.width,et.height,zn.depth,ri,Oi,et.data):s.texImage3D(_.TEXTURE_2D_ARRAY,Gn,mi,et.width,et.height,zn.depth,0,ri,Oi,et.data)}else{bn&&ii&&s.texStorage2D(_.TEXTURE_2D,Fi,mi,un[0].width,un[0].height);for(let Gn=0,Pn=un.length;Gn<Pn;Gn++)et=un[Gn],Be.format!==We?ri!==null?bn?Un&&s.compressedTexSubImage2D(_.TEXTURE_2D,Gn,0,0,et.width,et.height,ri,et.data):s.compressedTexImage2D(_.TEXTURE_2D,Gn,mi,et.width,et.height,0,et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):bn?Un&&s.texSubImage2D(_.TEXTURE_2D,Gn,0,0,et.width,et.height,ri,Oi,et.data):s.texImage2D(_.TEXTURE_2D,Gn,mi,et.width,et.height,0,ri,Oi,et.data)}else if(Be.isDataArrayTexture)bn?(ii&&s.texStorage3D(_.TEXTURE_2D_ARRAY,Fi,mi,zn.width,zn.height,zn.depth),Un&&s.texSubImage3D(_.TEXTURE_2D_ARRAY,0,0,0,0,zn.width,zn.height,zn.depth,ri,Oi,zn.data)):s.texImage3D(_.TEXTURE_2D_ARRAY,0,mi,zn.width,zn.height,zn.depth,0,ri,Oi,zn.data);else if(Be.isData3DTexture)bn?(ii&&s.texStorage3D(_.TEXTURE_3D,Fi,mi,zn.width,zn.height,zn.depth),Un&&s.texSubImage3D(_.TEXTURE_3D,0,0,0,0,zn.width,zn.height,zn.depth,ri,Oi,zn.data)):s.texImage3D(_.TEXTURE_3D,0,mi,zn.width,zn.height,zn.depth,0,ri,Oi,zn.data);else if(Be.isFramebufferTexture){if(ii)if(bn)s.texStorage2D(_.TEXTURE_2D,Fi,mi,zn.width,zn.height);else{let Gn=zn.width,Pn=zn.height;for(let Qi=0;Qi<Fi;Qi++)s.texImage2D(_.TEXTURE_2D,Qi,mi,Gn,Pn,0,ri,Oi,null),Gn>>=1,Pn>>=1}}else if(un.length>0){if(bn&&ii){const Gn=Vr(un[0]);s.texStorage2D(_.TEXTURE_2D,Fi,mi,Gn.width,Gn.height)}for(let Gn=0,Pn=un.length;Gn<Pn;Gn++)et=un[Gn],bn?Un&&s.texSubImage2D(_.TEXTURE_2D,Gn,0,0,ri,Oi,et):s.texImage2D(_.TEXTURE_2D,Gn,mi,ri,Oi,et);Be.generateMipmaps=!1}else if(bn){if(ii){const Gn=Vr(zn);s.texStorage2D(_.TEXTURE_2D,Fi,mi,Gn.width,Gn.height)}Un&&s.texSubImage2D(_.TEXTURE_2D,0,0,0,ri,Oi,zn)}else s.texImage2D(_.TEXTURE_2D,0,mi,ri,Oi,zn);ve(Be)&&Ae(Zt),ni.__version=nn.version,Be.onUpdate&&Be.onUpdate(Be)}return Xe.__version=Be.version,!0}function en(Xe,Be,Dt){if(Be.image.length!==6)return;const Zt=Gr(Xe,Be),sn=Be.source;s.bindTexture(_.TEXTURE_CUBE_MAP,Xe.__webglTexture,_.TEXTURE0+Dt);const nn=l.get(sn);if(sn.version!==nn.__version||Zt===!0){s.activeTexture(_.TEXTURE0+Dt);const ni=gr.getPrimaries(gr.workingColorSpace),En=Be.colorSpace===Zs?null:gr.getPrimaries(Be.colorSpace),Hn=Be.colorSpace===Zs||ni===En?_.NONE:_.BROWSER_DEFAULT_WEBGL;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,Be.flipY),_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Be.premultiplyAlpha),_.pixelStorei(_.UNPACK_ALIGNMENT,Be.unpackAlignment),_.pixelStorei(_.UNPACK_COLORSPACE_CONVERSION_WEBGL,Hn);const xr=Be.isCompressedTexture||Be.image[0].isCompressedTexture,zn=Be.image[0]&&Be.image[0].isDataTexture,ri=[];for(let Pn=0;Pn<6;Pn++)!xr&&!zn?ri[Pn]=we(Be.image[Pn],!0,d.maxCubemapSize):ri[Pn]=zn?Be.image[Pn].image:Be.image[Pn],ri[Pn]=rs(Be,ri[Pn]);const Oi=ri[0],mi=b.convert(Be.format,Be.colorSpace),et=b.convert(Be.type),un=qe(Be.internalFormat,mi,et,Be.colorSpace),bn=Be.isVideoTexture!==!0,ii=nn.__version===void 0||Zt===!0,Un=sn.dataReady;let Fi=Ve(Be,Oi);vr(_.TEXTURE_CUBE_MAP,Be);let Gn;if(xr){bn&&ii&&s.texStorage2D(_.TEXTURE_CUBE_MAP,Fi,un,Oi.width,Oi.height);for(let Pn=0;Pn<6;Pn++){Gn=ri[Pn].mipmaps;for(let Qi=0;Qi<Gn.length;Qi++){const gi=Gn[Qi];Be.format!==We?mi!==null?bn?Un&&s.compressedTexSubImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi,0,0,gi.width,gi.height,mi,gi.data):s.compressedTexImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi,un,gi.width,gi.height,0,gi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):bn?Un&&s.texSubImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi,0,0,gi.width,gi.height,mi,et,gi.data):s.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi,un,gi.width,gi.height,0,mi,et,gi.data)}}}else{if(Gn=Be.mipmaps,bn&&ii){Gn.length>0&&Fi++;const Pn=Vr(ri[0]);s.texStorage2D(_.TEXTURE_CUBE_MAP,Fi,un,Pn.width,Pn.height)}for(let Pn=0;Pn<6;Pn++)if(zn){bn?Un&&s.texSubImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,0,0,0,ri[Pn].width,ri[Pn].height,mi,et,ri[Pn].data):s.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,0,un,ri[Pn].width,ri[Pn].height,0,mi,et,ri[Pn].data);for(let Qi=0;Qi<Gn.length;Qi++){const Ps=Gn[Qi].image[Pn].image;bn?Un&&s.texSubImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi+1,0,0,Ps.width,Ps.height,mi,et,Ps.data):s.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi+1,un,Ps.width,Ps.height,0,mi,et,Ps.data)}}else{bn?Un&&s.texSubImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,0,0,0,mi,et,ri[Pn]):s.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,0,un,mi,et,ri[Pn]);for(let Qi=0;Qi<Gn.length;Qi++){const gi=Gn[Qi];bn?Un&&s.texSubImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi+1,0,0,mi,et,gi.image[Pn]):s.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+Pn,Qi+1,un,mi,et,gi.image[Pn])}}}ve(Be)&&Ae(_.TEXTURE_CUBE_MAP),nn.__version=sn.version,Be.onUpdate&&Be.onUpdate(Be)}Xe.__version=Be.version}function Cn(Xe,Be,Dt,Zt,sn,nn){const ni=b.convert(Dt.format,Dt.colorSpace),En=b.convert(Dt.type),Hn=qe(Dt.internalFormat,ni,En,Dt.colorSpace);if(!l.get(Be).__hasExternalTextures){const ri=Math.max(1,Be.width>>nn),Oi=Math.max(1,Be.height>>nn);Be.isWebGLMultiviewRenderTarget===!0?s.texStorage3D(_.TEXTURE_2D_ARRAY,0,Hn,Be.width,Be.height,Be.numViews):sn===_.TEXTURE_3D||sn===_.TEXTURE_2D_ARRAY?s.texImage3D(sn,nn,Hn,ri,Oi,Be.depth,0,ni,En,null):s.texImage2D(sn,nn,Hn,ri,Oi,0,ni,En,null)}s.bindFramebuffer(_.FRAMEBUFFER,Xe);const zn=xi(Be);Be.isWebGLMultiviewRenderTarget===!0?zn?U.framebufferTextureMultisampleMultiviewOVR(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,l.get(Dt).__webglTexture,0,yi(Be),0,Be.numViews):U.framebufferTextureMultiviewOVR(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,l.get(Dt).__webglTexture,0,0,Be.numViews):(sn===_.TEXTURE_2D||sn>=_.TEXTURE_CUBE_MAP_POSITIVE_X&&sn<=_.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(zn?B.framebufferTexture2DMultisampleEXT(_.FRAMEBUFFER,Zt,sn,l.get(Dt).__webglTexture,0,yi(Be)):_.framebufferTexture2D(_.FRAMEBUFFER,Zt,sn,l.get(Dt).__webglTexture,nn)),s.bindFramebuffer(_.FRAMEBUFFER,null)}function Tn(Xe,Be,Dt){if(_.bindRenderbuffer(_.RENDERBUFFER,Xe),Be.isWebGLMultiviewRenderTarget===!0){const Zt=xi(Be),sn=Be.numViews,nn=Be.depthTexture;let ni=_.DEPTH_COMPONENT24,En=_.DEPTH_ATTACHMENT;nn&&nn.isDepthTexture&&(nn.type===zr?ni=_.DEPTH_COMPONENT32F:nn.type===Yo&&(ni=_.DEPTH24_STENCIL8,En=_.DEPTH_STENCIL_ATTACHMENT));let Hn=l.get(Be.depthTexture).__webglTexture;Hn===void 0&&(Hn=_.createTexture(),_.bindTexture(_.TEXTURE_2D_ARRAY,Hn),_.texStorage3D(_.TEXTURE_2D_ARRAY,1,ni,Be.width,Be.height,sn)),Zt?U.framebufferTextureMultisampleMultiviewOVR(_.FRAMEBUFFER,En,Hn,0,yi(Be),0,sn):U.framebufferTextureMultiviewOVR(_.FRAMEBUFFER,En,Hn,0,0,sn)}else if(Be.depthBuffer&&!Be.stencilBuffer){let Zt=_.DEPTH_COMPONENT24;if(Dt||xi(Be)){const sn=Be.depthTexture;sn&&sn.isDepthTexture&&(sn.type===zr?Zt=_.DEPTH_COMPONENT32F:sn.type===Js&&(Zt=_.DEPTH_COMPONENT24));const nn=yi(Be);xi(Be)?B.renderbufferStorageMultisampleEXT(_.RENDERBUFFER,nn,Zt,Be.width,Be.height):_.renderbufferStorageMultisample(_.RENDERBUFFER,nn,Zt,Be.width,Be.height)}else _.renderbufferStorage(_.RENDERBUFFER,Zt,Be.width,Be.height);_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,Xe)}else if(Be.depthBuffer&&Be.stencilBuffer){const Zt=yi(Be);Dt&&xi(Be)===!1?_.renderbufferStorageMultisample(_.RENDERBUFFER,Zt,_.DEPTH24_STENCIL8,Be.width,Be.height):xi(Be)?B.renderbufferStorageMultisampleEXT(_.RENDERBUFFER,Zt,_.DEPTH24_STENCIL8,Be.width,Be.height):_.renderbufferStorage(_.RENDERBUFFER,_.DEPTH_STENCIL,Be.width,Be.height),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.RENDERBUFFER,Xe)}else{const Zt=Be.textures;for(let sn=0;sn<Zt.length;sn++){const nn=Zt[sn],ni=b.convert(nn.format,nn.colorSpace),En=b.convert(nn.type),Hn=qe(nn.internalFormat,ni,En,nn.colorSpace),xr=yi(Be);Dt&&xi(Be)===!1?_.renderbufferStorageMultisample(_.RENDERBUFFER,xr,Hn,Be.width,Be.height):xi(Be)?B.renderbufferStorageMultisampleEXT(_.RENDERBUFFER,xr,Hn,Be.width,Be.height):_.renderbufferStorage(_.RENDERBUFFER,Hn,Be.width,Be.height)}}_.bindRenderbuffer(_.RENDERBUFFER,null)}function ht(Xe,Be){if(Be&&Be.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(s.bindFramebuffer(_.FRAMEBUFFER,Xe),!(Be.depthTexture&&Be.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!l.get(Be.depthTexture).__webglTexture||Be.depthTexture.image.width!==Be.width||Be.depthTexture.image.height!==Be.height)&&(Be.depthTexture.image.width=Be.width,Be.depthTexture.image.height=Be.height,Be.depthTexture.needsUpdate=!0),Yt(Be.depthTexture,0),Be.depthTexture.image.depth!=1?_n(Be.depthTexture,0):Yt(Be.depthTexture,0);const Zt=l.get(Be.depthTexture).__webglTexture,sn=yi(Be);if(Be.isWebGLMultiviewRenderTarget===!0){const nn=xi(Be),ni=Be.numViews;if(Be.depthTexture.format===gt)nn?U.framebufferTextureMultisampleMultiviewOVR(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,Zt,0,sn,0,ni):U.framebufferTextureMultiviewOVR(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,Zt,0,0,ni);else if(Be.depthTexture.format===Ht)nn?U.framebufferTextureMultisampleMultiviewOVR(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,Zt,0,sn,0,ni):U.framebufferTextureMultiviewOVR(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,Zt,0,0,ni);else throw new Error("Unknown depthTexture format")}else if(Be.depthTexture.format===gt)xi(Be)?B.framebufferTexture2DMultisampleEXT(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.TEXTURE_2D,Zt,0,sn):_.framebufferTexture2D(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.TEXTURE_2D,Zt,0);else if(Be.depthTexture.format===Ht)xi(Be)?B.framebufferTexture2DMultisampleEXT(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.TEXTURE_2D,Zt,0,sn):_.framebufferTexture2D(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.TEXTURE_2D,Zt,0);else throw new Error("Unknown depthTexture format")}function tn(Xe){const Be=l.get(Xe),Dt=Xe.isWebGLCubeRenderTarget===!0;if(Xe.depthTexture&&!Be.__autoAllocateDepthBuffer){if(Dt)throw new Error("target.depthTexture not supported in Cube render targets");ht(Be.__webglFramebuffer,Xe)}else if(Dt){Be.__webglDepthbuffer=[];for(let Zt=0;Zt<6;Zt++)s.bindFramebuffer(_.FRAMEBUFFER,Be.__webglFramebuffer[Zt]),Be.__webglDepthbuffer[Zt]=_.createRenderbuffer(),Tn(Be.__webglDepthbuffer[Zt],Xe,!1)}else s.bindFramebuffer(_.FRAMEBUFFER,Be.__webglFramebuffer),Be.__webglDepthbuffer=_.createRenderbuffer(),Tn(Be.__webglDepthbuffer,Xe,!1);s.bindFramebuffer(_.FRAMEBUFFER,null)}function Qt(Xe,Be,Dt){const Zt=l.get(Xe);Be!==void 0&&Cn(Zt.__webglFramebuffer,Xe,Xe.texture,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,0),Dt!==void 0&&tn(Xe)}function dn(Xe){const Be=Xe.texture,Dt=l.get(Xe),Zt=l.get(Be);Xe.addEventListener("dispose",Ke);const sn=Xe.textures,nn=Xe.isWebGLCubeRenderTarget===!0,ni=sn.length>1;if(ni||(Zt.__webglTexture===void 0&&(Zt.__webglTexture=_.createTexture()),Zt.__version=Be.version,T.memory.textures++),nn){Dt.__webglFramebuffer=[];for(let En=0;En<6;En++)if(Be.mipmaps&&Be.mipmaps.length>0){Dt.__webglFramebuffer[En]=[];for(let Hn=0;Hn<Be.mipmaps.length;Hn++)Dt.__webglFramebuffer[En][Hn]=_.createFramebuffer()}else Dt.__webglFramebuffer[En]=_.createFramebuffer()}else{if(Be.mipmaps&&Be.mipmaps.length>0){Dt.__webglFramebuffer=[];for(let En=0;En<Be.mipmaps.length;En++)Dt.__webglFramebuffer[En]=_.createFramebuffer()}else Dt.__webglFramebuffer=_.createFramebuffer();if(ni)for(let En=0,Hn=sn.length;En<Hn;En++){const xr=l.get(sn[En]);xr.__webglTexture===void 0&&(xr.__webglTexture=_.createTexture(),T.memory.textures++)}if(Xe.samples>0&&xi(Xe)===!1){Dt.__webglMultisampledFramebuffer=_.createFramebuffer(),Dt.__webglColorRenderbuffer=[],s.bindFramebuffer(_.FRAMEBUFFER,Dt.__webglMultisampledFramebuffer);for(let En=0;En<sn.length;En++){const Hn=sn[En];Dt.__webglColorRenderbuffer[En]=_.createRenderbuffer(),_.bindRenderbuffer(_.RENDERBUFFER,Dt.__webglColorRenderbuffer[En]);const xr=b.convert(Hn.format,Hn.colorSpace),zn=b.convert(Hn.type),ri=qe(Hn.internalFormat,xr,zn,Hn.colorSpace,Xe.isXRRenderTarget===!0),Oi=yi(Xe);_.renderbufferStorageMultisample(_.RENDERBUFFER,Oi,ri,Xe.width,Xe.height),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0+En,_.RENDERBUFFER,Dt.__webglColorRenderbuffer[En])}_.bindRenderbuffer(_.RENDERBUFFER,null),Xe.depthBuffer&&(Dt.__webglDepthRenderbuffer=_.createRenderbuffer(),Tn(Dt.__webglDepthRenderbuffer,Xe,!0)),s.bindFramebuffer(_.FRAMEBUFFER,null)}}if(nn){s.bindTexture(_.TEXTURE_CUBE_MAP,Zt.__webglTexture),vr(_.TEXTURE_CUBE_MAP,Be);for(let En=0;En<6;En++)if(Be.mipmaps&&Be.mipmaps.length>0)for(let Hn=0;Hn<Be.mipmaps.length;Hn++)Cn(Dt.__webglFramebuffer[En][Hn],Xe,Be,_.COLOR_ATTACHMENT0,_.TEXTURE_CUBE_MAP_POSITIVE_X+En,Hn);else Cn(Dt.__webglFramebuffer[En],Xe,Be,_.COLOR_ATTACHMENT0,_.TEXTURE_CUBE_MAP_POSITIVE_X+En,0);ve(Be)&&Ae(_.TEXTURE_CUBE_MAP),s.unbindTexture()}else if(ni){for(let En=0,Hn=sn.length;En<Hn;En++){const xr=sn[En],zn=l.get(xr);s.bindTexture(_.TEXTURE_2D,zn.__webglTexture),vr(_.TEXTURE_2D,xr),Cn(Dt.__webglFramebuffer,Xe,xr,_.COLOR_ATTACHMENT0+En,_.TEXTURE_2D,0),ve(xr)&&Ae(_.TEXTURE_2D)}s.unbindTexture()}else{let En=_.TEXTURE_2D;if((Xe.isWebGL3DRenderTarget||Xe.isWebGLArrayRenderTarget)&&(En=Xe.isWebGL3DRenderTarget?_.TEXTURE_3D:_.TEXTURE_2D_ARRAY),Xe.isWebGLMultiviewRenderTarget===!0&&(En=_.TEXTURE_2D_ARRAY),s.bindTexture(En,Zt.__webglTexture),vr(En,Be),Be.mipmaps&&Be.mipmaps.length>0)for(let Hn=0;Hn<Be.mipmaps.length;Hn++)Cn(Dt.__webglFramebuffer[Hn],Xe,Be,_.COLOR_ATTACHMENT0,En,Hn);else Cn(Dt.__webglFramebuffer,Xe,Be,_.COLOR_ATTACHMENT0,En,0);ve(Be)&&Ae(En),s.unbindTexture()}(Xe.depthBuffer||Xe.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(Xe)}function hn(Xe){const Be=Xe.textures;for(let Dt=0,Zt=Be.length;Dt<Zt;Dt++){const sn=Be[Dt];if(ve(sn)){const nn=Xe.isWebGLCubeRenderTarget?_.TEXTURE_CUBE_MAP:_.TEXTURE_2D,ni=l.get(sn).__webglTexture;s.bindTexture(nn,ni),Ae(nn),s.unbindTexture()}}}const cn=[],Ln=[];function Vn(Xe){if(Xe.samples>0){if(xi(Xe)===!1){const Be=Xe.textures,Dt=Xe.width,Zt=Xe.height;let sn=_.COLOR_BUFFER_BIT;const nn=Xe.stencilBuffer?_.DEPTH_STENCIL_ATTACHMENT:_.DEPTH_ATTACHMENT,ni=l.get(Xe),En=Be.length>1;if(En)for(let Hn=0;Hn<Be.length;Hn++)s.bindFramebuffer(_.FRAMEBUFFER,ni.__webglMultisampledFramebuffer),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0+Hn,_.RENDERBUFFER,null),s.bindFramebuffer(_.FRAMEBUFFER,ni.__webglFramebuffer),_.framebufferTexture2D(_.DRAW_FRAMEBUFFER,_.COLOR_ATTACHMENT0+Hn,_.TEXTURE_2D,null,0);s.bindFramebuffer(_.READ_FRAMEBUFFER,ni.__webglMultisampledFramebuffer),s.bindFramebuffer(_.DRAW_FRAMEBUFFER,ni.__webglFramebuffer);for(let Hn=0;Hn<Be.length;Hn++){if(Xe.resolveDepthBuffer&&(Xe.depthBuffer&&(sn|=_.DEPTH_BUFFER_BIT),Xe.stencilBuffer&&Xe.resolveStencilBuffer&&(sn|=_.STENCIL_BUFFER_BIT)),En){_.framebufferRenderbuffer(_.READ_FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.RENDERBUFFER,ni.__webglColorRenderbuffer[Hn]);const xr=l.get(Be[Hn]).__webglTexture;_.framebufferTexture2D(_.DRAW_FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,xr,0)}_.blitFramebuffer(0,0,Dt,Zt,0,0,Dt,Zt,sn,_.NEAREST),N===!0&&(cn.length=0,Ln.length=0,cn.push(_.COLOR_ATTACHMENT0+Hn),Xe.depthBuffer&&Xe.resolveDepthBuffer===!1&&(cn.push(nn),Ln.push(nn),_.invalidateFramebuffer(_.DRAW_FRAMEBUFFER,Ln)),_.invalidateFramebuffer(_.READ_FRAMEBUFFER,cn))}if(s.bindFramebuffer(_.READ_FRAMEBUFFER,null),s.bindFramebuffer(_.DRAW_FRAMEBUFFER,null),En)for(let Hn=0;Hn<Be.length;Hn++){s.bindFramebuffer(_.FRAMEBUFFER,ni.__webglMultisampledFramebuffer),_.framebufferRenderbuffer(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0+Hn,_.RENDERBUFFER,ni.__webglColorRenderbuffer[Hn]);const xr=l.get(Be[Hn]).__webglTexture;s.bindFramebuffer(_.FRAMEBUFFER,ni.__webglFramebuffer),_.framebufferTexture2D(_.DRAW_FRAMEBUFFER,_.COLOR_ATTACHMENT0+Hn,_.TEXTURE_2D,xr,0)}s.bindFramebuffer(_.DRAW_FRAMEBUFFER,ni.__webglMultisampledFramebuffer)}else if(Xe.depthBuffer&&Xe.resolveDepthBuffer===!1&&N){const Be=Xe.stencilBuffer?_.DEPTH_STENCIL_ATTACHMENT:_.DEPTH_ATTACHMENT;_.invalidateFramebuffer(_.DRAW_FRAMEBUFFER,[Be])}}}function yi(Xe){return Math.min(d.maxSamples,Xe.samples)}function xi(Xe){const Be=l.get(Xe);return Xe.samples>0&&n.has("WEBGL_multisampled_render_to_texture")===!0&&Be.__useRenderToTexture!==!1}function dr(Xe){const Be=T.render.frame;X.get(Xe)!==Be&&(X.set(Xe,Be),Xe.update())}function rs(Xe,Be){const Dt=Xe.colorSpace,Zt=Xe.format,sn=Xe.type;return Xe.isCompressedTexture===!0||Xe.isVideoTexture===!0||Dt!==Na&&Dt!==Zs&&(gr.getTransfer(Dt)===Rr?(Zt!==We||sn!==Hr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Dt)),Be}function Vr(Xe){return typeof HTMLImageElement<"u"&&Xe instanceof HTMLImageElement?(z.width=Xe.naturalWidth||Xe.width,z.height=Xe.naturalHeight||Xe.height):typeof VideoFrame<"u"&&Xe instanceof VideoFrame?(z.width=Xe.displayWidth,z.height=Xe.displayHeight):(z.width=Xe.width,z.height=Xe.height),z}this.allocateTextureUnit=ut,this.resetTextureUnits=tt,this.setTexture2D=Yt,this.setTexture2DArray=_n,this.setTexture3D=Mt,this.setTextureCube=mn,this.rebindTextures=Qt,this.uploadTexture=Jn,this.setupRenderTarget=dn,this.updateRenderTargetMipmap=hn,this.updateMultisampleRenderTarget=Vn,this.setupDepthTexture=ht,this.setupDepthRenderbuffer=tn,this.setupFrameBufferTexture=Cn,this.useMultisampledRTT=xi,this.runDeferredUploads=Lr,this.setDeferTextureUploads=fr}function UC(_,n){function s(l,d=Zs){let b;const T=gr.getTransfer(d);if(l===Hr)return _.UNSIGNED_BYTE;if(l===ps)return _.UNSIGNED_SHORT_4_4_4_4;if(l===Rl)return _.UNSIGNED_SHORT_5_5_5_1;if(l===yc)return _.UNSIGNED_INT_5_9_9_9_REV;if(l===fa)return _.BYTE;if(l===ds)return _.SHORT;if(l===go)return _.UNSIGNED_SHORT;if(l===da)return _.INT;if(l===Js)return _.UNSIGNED_INT;if(l===zr)return _.FLOAT;if(l===Er)return _.HALF_FLOAT;if(l===nl)return _.ALPHA;if(l===Oe)return _.RGB;if(l===We)return _.RGBA;if(l===ot)return _.LUMINANCE;if(l===Rt)return _.LUMINANCE_ALPHA;if(l===gt)return _.DEPTH_COMPONENT;if(l===Ht)return _.DEPTH_STENCIL;if(l===an)return _.RED;if(l===jn)return _.RED_INTEGER;if(l===Bn)return _.RG;if(l===zt)return _.RG_INTEGER;if(l===Zn)return _.RGBA_INTEGER;if(l===oi||l===hi||l===wr||l===Ti)if(T===Rr)if(b=n.get("WEBGL_compressed_texture_s3tc_srgb"),b!==null){if(l===oi)return b.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(l===hi)return b.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(l===wr)return b.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(l===Ti)return b.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(b=n.get("WEBGL_compressed_texture_s3tc"),b!==null){if(l===oi)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===hi)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===wr)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===Ti)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(l===bi||l===Wi||l===Or||l===ms)if(b=n.get("WEBGL_compressed_texture_pvrtc"),b!==null){if(l===bi)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(l===Wi)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(l===Or)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(l===ms)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(l===Rn||l===Ii||l===es)if(b=n.get("WEBGL_compressed_texture_etc"),b!==null){if(l===Rn||l===Ii)return T===Rr?b.COMPRESSED_SRGB8_ETC2:b.COMPRESSED_RGB8_ETC2;if(l===es)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:b.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(l===Zi||l===ne||l===ae||l===me||l===xe||l===Fe||l===Je||l===nt||l===qt||l===Kt||l===dt||l===Lt||l===on||l===Nn)if(b=n.get("WEBGL_compressed_texture_astc"),b!==null){if(l===Zi)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:b.COMPRESSED_RGBA_ASTC_4x4_KHR;if(l===ne)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:b.COMPRESSED_RGBA_ASTC_5x4_KHR;if(l===ae)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:b.COMPRESSED_RGBA_ASTC_5x5_KHR;if(l===me)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:b.COMPRESSED_RGBA_ASTC_6x5_KHR;if(l===xe)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:b.COMPRESSED_RGBA_ASTC_6x6_KHR;if(l===Fe)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:b.COMPRESSED_RGBA_ASTC_8x5_KHR;if(l===Je)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:b.COMPRESSED_RGBA_ASTC_8x6_KHR;if(l===nt)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:b.COMPRESSED_RGBA_ASTC_8x8_KHR;if(l===qt)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:b.COMPRESSED_RGBA_ASTC_10x5_KHR;if(l===Kt)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:b.COMPRESSED_RGBA_ASTC_10x6_KHR;if(l===dt)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:b.COMPRESSED_RGBA_ASTC_10x8_KHR;if(l===Lt)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:b.COMPRESSED_RGBA_ASTC_10x10_KHR;if(l===on)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:b.COMPRESSED_RGBA_ASTC_12x10_KHR;if(l===Nn)return T===Rr?b.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:b.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(l===$n||l===ai||l===wi)if(b=n.get("EXT_texture_compression_bptc"),b!==null){if(l===$n)return T===Rr?b.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:b.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(l===ai)return b.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(l===wi)return b.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(l===Ai||l===ui||l===ir||l===Cr)if(b=n.get("EXT_texture_compression_rgtc"),b!==null){if(l===$n)return b.COMPRESSED_RED_RGTC1_EXT;if(l===ui)return b.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(l===ir)return b.COMPRESSED_RED_GREEN_RGTC2_EXT;if(l===Cr)return b.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return l===Yo?_.UNSIGNED_INT_24_8:_[l]!==void 0?_[l]:null}return{convert:s}}class wu extends hr{constructor(){super(),this.isGroup=!0,this.type="Group"}}class yb extends Bs{constructor(n=[]){super(),this.isArrayCamera=!0,this.cameras=n}}var GC=new Ge,VC=new Ge;function wF(_,n,s){GC.setFromMatrixPosition(n.matrixWorld),VC.setFromMatrixPosition(s.matrixWorld);var l=GC.distanceTo(VC),d=n.projectionMatrix.elements,b=s.projectionMatrix.elements,T=d[14]/(d[10]-1),B=d[14]/(d[10]+1),N=(d[9]+1)/d[5],U=(d[9]-1)/d[5],z=(d[8]-1)/d[0],X=(b[8]+1)/b[0],q=T*z,ee=T*X,ie=l/(-z+X),ce=ie*-z;n.matrixWorld.decompose(_.position,_.quaternion,_.scale),_.translateX(ce),_.translateZ(ie),_.matrixWorld.compose(_.position,_.quaternion,_.scale),_.matrixWorldInverse.copy(_.matrixWorld).invert();var re=T+ie,te=B+ie,we=q-ce,ve=ee+(l-ce),Ae=N*B/te*re,qe=U*B/te*re;_.projectionMatrix.makePerspective(we,ve,Ae,qe,re,te)}function QC(_){var n,s,l=this,d=null,b=null,T=null,B=[],N=new Kn,U=new Kn,z=1,X="local-floor";typeof window<"u"&&"VRFrameData"in window&&(b=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",Ae,!1));var q=new Kn,ee=new ur,ie=new Ge,ce=new Bs;ce.viewport=new ar,ce.layers.enable(1);var re=new Bs;re.viewport=new ar,re.layers.enable(2);var te=new yb([ce,re]);te.layers.enable(1),te.layers.enable(2);var we=new Jt,ve;function Ae(){var Ye=l.isPresenting=d!==null&&d.isPresenting===!0;if(Ye){var at=d.getEyeParameters("left");n=2*at.renderWidth*z,s=at.renderHeight*z,ve=_.getPixelRatio(),_.getSize(we),_.setDrawingBufferSize(n,s,1),ce.viewport.set(0,0,n/2,s),re.viewport.set(n/2,0,n/2,s),Ie.start(),l.dispatchEvent({type:"sessionstart"})}else l.enabled&&_.setDrawingBufferSize(we.width,we.height,ve),Ie.stop(),l.dispatchEvent({type:"sessionend"})}var qe=[],Ve=[];function ze(Ye){for(var at=navigator.getGamepads&&navigator.getGamepads(),tt=0,ut=at.length;tt<ut;tt++){var wt=at[tt];if(wt&&(wt.id==="Daydream Controller"||wt.id==="Gear VR Controller"||wt.id==="Oculus Go Controller"||wt.id==="OpenVR Gamepad"||wt.id.startsWith("Oculus Touch")||wt.id.startsWith("HTC Vive Focus")||wt.id.startsWith("Spatial Controller"))){var Yt=wt.hand;if(Ye===0&&(Yt===""||Yt==="right")||Ye===1&&Yt==="left")return wt}}}function Ke(){for(var Ye=0;Ye<B.length;Ye++){var at=B[Ye],tt=ze(Ye);if(tt!==void 0&&tt.pose!==void 0){if(tt.pose===null)return;var ut=tt.pose;ut.hasPosition===!1&&at.position.set(.2,-.6,-.05),ut.position!==null&&at.position.fromArray(ut.position),ut.orientation!==null&&at.quaternion.fromArray(ut.orientation),at.matrix.compose(at.position,at.quaternion,at.scale),at.matrix.premultiply(N),at.matrix.decompose(at.position,at.quaternion,at.scale),at.matrixWorldNeedsUpdate=!0,at.visible=!0;var wt=tt.id==="Daydream Controller"?0:1;qe[Ye]===void 0&&(qe[Ye]=!1),qe[Ye]!==tt.buttons[wt].pressed&&(qe[Ye]=tt.buttons[wt].pressed,qe[Ye]===!0?at.dispatchEvent({type:"selectstart"}):(at.dispatchEvent({type:"selectend"}),at.dispatchEvent({type:"select"}))),wt=2,Ve[Ye]===void 0&&(Ve[Ye]=!1),tt.buttons[wt]!==void 0&&Ve[Ye]!==tt.buttons[wt].pressed&&(Ve[Ye]=tt.buttons[wt].pressed,Ve[Ye]===!0?at.dispatchEvent({type:"squeezestart"}):(at.dispatchEvent({type:"squeezeend"}),at.dispatchEvent({type:"squeeze"})))}else at.visible=!1}}function De(Ye,at){at!==null&&at.length===4&&Ye.set(at[0]*n,at[1]*s,at[2]*n,at[3]*s)}this.enabled=!1,this.getController=function(Ye){var at=B[Ye];return at===void 0&&(at=new wu,at.matrixAutoUpdate=!1,at.visible=!1,B[Ye]=at),at},this.getDevice=function(){return d},this.setDevice=function(Ye){Ye!==void 0&&(d=Ye),Ie.setContext(Ye)},this.setFramebufferScaleFactor=function(Ye){z=Ye},this.setReferenceSpaceType=function(Ye){X=Ye},this.setPoseTarget=function(Ye){Ye!==void 0&&(T=Ye)},this.cameraAutoUpdate=!0,this.updateCamera=function(Ye){var at=X==="local-floor"?1.6:0;if(d.depthNear=Ye.near,d.depthFar=Ye.far,d.getFrameData(b),X==="local-floor"){var tt=d.stageParameters;tt?N.fromArray(tt.sittingToStandingTransform):N.makeTranslation(0,at,0)}var ut=b.pose,wt=T!==null?T:Ye;wt.matrix.copy(N),wt.matrix.decompose(wt.position,wt.quaternion,wt.scale),ut.orientation!==null&&(ee.fromArray(ut.orientation),wt.quaternion.multiply(ee)),ut.position!==null&&(ee.setFromRotationMatrix(N),ie.fromArray(ut.position),ie.applyQuaternion(ee),wt.position.add(ie)),wt.updateMatrixWorld();for(var Yt=wt.children,_n=0,Mt=Yt.length;_n<Mt;_n++)Yt[_n].updateMatrixWorld(!0);ce.near=Ye.near,re.near=Ye.near,ce.far=Ye.far,re.far=Ye.far,ce.matrixWorldInverse.fromArray(b.leftViewMatrix),re.matrixWorldInverse.fromArray(b.rightViewMatrix),U.copy(N).invert(),X==="local-floor"&&(ce.matrixWorldInverse.multiply(U),re.matrixWorldInverse.multiply(U));var mn=wt.parent;mn!==null&&(q.copy(mn.matrixWorld).invert(),ce.matrixWorldInverse.multiply(q),re.matrixWorldInverse.multiply(q)),ce.matrixWorld.copy(ce.matrixWorldInverse).invert(),re.matrixWorld.copy(re.matrixWorldInverse).invert(),ce.projectionMatrix.fromArray(b.leftProjectionMatrix),re.projectionMatrix.fromArray(b.rightProjectionMatrix),wF(te,ce,re);var vn=d.getLayers();if(vn.length){var Xn=vn[0];De(ce.viewport,Xn.leftBounds),De(re.viewport,Xn.rightBounds)}return Ke(),te},this.getCamera=function(){return te},this.getFoveation=function(){return 1},this.setFoveation=function(Ye){Ye!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(l.isPresenting)return"opaque"},this.getStandingMatrix=function(){return N},this.isPresenting=!1;var Ie=new ab;this.setAnimationLoop=function(Ye){Ie.setAnimationLoop(Ye),this.isPresenting&&Ie.start()},this.submitFrame=function(){this.isPresenting&&d.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",Ae)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(QC.prototype,{addEventListener:vo.prototype.addEventListener,hasEventListener:vo.prototype.hasEventListener,removeEventListener:vo.prototype.removeEventListener,dispatchEvent:vo.prototype.dispatchEvent});class HC extends Do{constructor(n,s,l,d={}){super(n,s,d),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=l}copy(n){return super.copy(n),this.numViews=n.numViews,this}}HC.prototype.isWebGLMultiviewRenderTarget=!0;const CF={type:"move"};class _b{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ge,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ge),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ge,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ge),this._grip}dispatchEvent(n){return this._targetRay!==null&&this._targetRay.dispatchEvent(n),this._grip!==null&&this._grip.dispatchEvent(n),this._hand!==null&&this._hand.dispatchEvent(n),this}connect(n){if(n&&n.hand){const s=this._hand;if(s)for(const l of n.hand.values())this._getHandJoint(s,l)}return this.dispatchEvent({type:"connected",data:n}),this}disconnect(n){return this.dispatchEvent({type:"disconnected",data:n}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(n,s,l){let d=null,b=null,T=null;const B=this._targetRay,N=this._grip,U=this._hand;if(n&&s.session.visibilityState!=="visible-blurred"){if(U&&n.hand){T=!0;for(const ce of n.hand.values()){const re=s.getJointPose(ce,l),te=this._getHandJoint(U,ce);re!==null&&(te.matrix.fromArray(re.transform.matrix),te.matrix.decompose(te.position,te.rotation,te.scale),te.matrixWorldNeedsUpdate=!0,te.jointRadius=re.radius),te.visible=re!==null}const z=U.joints["index-finger-tip"],X=U.joints["thumb-tip"],q=z.position.distanceTo(X.position),ee=.02,ie=.005;U.inputState.pinching&&q>ee+ie?(U.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:n.handedness,target:this})):!U.inputState.pinching&&q<=ee-ie&&(U.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:n.handedness,target:this}))}else N!==null&&n.gripSpace&&(b=s.getPose(n.gripSpace,l),b!==null&&(N.matrix.fromArray(b.transform.matrix),N.matrix.decompose(N.position,N.rotation,N.scale),N.matrixWorldNeedsUpdate=!0,b.linearVelocity?(N.hasLinearVelocity=!0,N.linearVelocity.copy(b.linearVelocity)):N.hasLinearVelocity=!1,b.angularVelocity?(N.hasAngularVelocity=!0,N.angularVelocity.copy(b.angularVelocity)):N.hasAngularVelocity=!1));B!==null&&(d=s.getPose(n.targetRaySpace,l),d===null&&b!==null&&(d=b),d!==null&&(B.matrix.fromArray(d.transform.matrix),B.matrix.decompose(B.position,B.rotation,B.scale),B.matrixWorldNeedsUpdate=!0,d.linearVelocity?(B.hasLinearVelocity=!0,B.linearVelocity.copy(d.linearVelocity)):B.hasLinearVelocity=!1,d.angularVelocity?(B.hasAngularVelocity=!0,B.angularVelocity.copy(d.angularVelocity)):B.hasAngularVelocity=!1,this.dispatchEvent(CF)))}return B!==null&&(B.visible=d!==null),N!==null&&(N.visible=b!==null),U!==null&&(U.visible=T!==null),this}_getHandJoint(n,s){if(n.joints[s.jointName]===void 0){const l=new wu;l.matrixAutoUpdate=!1,l.visible=!1,n.joints[s.jointName]=l,n.add(l)}return n.joints[s.jointName]}}const xF=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,MF=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class SF{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(n,s,l){if(this.texture===null){const d=new kr,b=n.properties.get(d);b.__webglTexture=s.texture,(s.depthNear!=l.depthNear||s.depthFar!=l.depthFar)&&(this.depthNear=s.depthNear,this.depthFar=s.depthFar),this.texture=d}}render(n,s){if(this.texture!==null){if(this.mesh===null){const l=s.cameras[0].viewport,d=new Fa({vertexShader:xF,fragmentShader:MF,uniforms:{depthColor:{value:this.texture},depthWidth:{value:l.z},depthHeight:{value:l.w}}});this.mesh=new ws(new Gh(20,20),d)}n.render(this.mesh,s)}}reset(){this.texture=null,this.mesh=null}}class TF extends vo{constructor(n,s,l,d){super();const b=this;let T=null,B=1;var N=null;let U=null,z="local-floor",X=1,q=null,ee=null;var ie=[];let ce=null,re=null,te=null,we=null;const ve=new SF,Ae=s.getContextAttributes();let qe=null,Ve=null;const ze=[],Ke=[],De=new Jt;let Ie=null;const Ye=new Bs;Ye.layers.enable(1),Ye.viewport=new ar;const at=new Bs;at.layers.enable(2),at.viewport=new ar;const tt=[Ye,at],ut=new yb;ut.layers.enable(1),ut.layers.enable(2);let wt=null,Yt=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return ee},this.getController=function(en){let Cn=ze[en];return Cn===void 0&&(Cn=new _b,ze[en]=Cn),Cn.getTargetRaySpace()},this.getControllerGrip=function(en){let Cn=ze[en];return Cn===void 0&&(Cn=new _b,ze[en]=Cn),Cn.getGripSpace()},this.getHand=function(en){let Cn=ze[en];return Cn===void 0&&(Cn=new _b,ze[en]=Cn),Cn.getHandSpace()};function _n(en){const Cn=Ke.indexOf(en.inputSource);if(Cn===-1)return;const Tn=ze[Cn];Tn!==void 0&&(Tn.update(en.inputSource,en.frame,q||U),Tn.dispatchEvent({type:en.type,data:en.inputSource}))}function Mt(){T.removeEventListener("select",_n),T.removeEventListener("selectstart",_n),T.removeEventListener("selectend",_n),T.removeEventListener("squeeze",_n),T.removeEventListener("squeezestart",_n),T.removeEventListener("squeezeend",_n),T.removeEventListener("end",Mt),T.removeEventListener("inputsourceschange",mn);for(let en=0;en<ze.length;en++){const Cn=Ke[en];Cn!==null&&(Ke[en]=null,ze[en].disconnect(Cn))}wt=null,Yt=null,ve.reset(),n.setRenderTarget(qe),te=null,re=null,ce=null,T=null,Ve=null,Jn.stop(),b.isPresenting=!1,n.setPixelRatio(Ie),n.setSize(De.width,De.height,!1),b.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(en){B=en,b.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(en){z=en,b.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return q||U},this.setReferenceSpace=function(en){q=en},this.getBaseLayer=function(){return re!==null?re:te},this.getBinding=function(){return ce},this.getFrame=function(){return we},this.getSession=function(){return T},this.setSession=async function(en){if(T=en,T!==null){if(qe=n.getRenderTarget(),T.addEventListener("select",_n),T.addEventListener("selectstart",_n),T.addEventListener("selectend",_n),T.addEventListener("squeeze",_n),T.addEventListener("squeezestart",_n),T.addEventListener("squeezeend",_n),T.addEventListener("end",Mt),T.addEventListener("inputsourceschange",mn),Ae.xrCompatible!==!0&&await s.makeXRCompatible(),Ie=n.getPixelRatio(),n.getSize(De),T.renderState.layers===void 0){const Cn={antialias:Ae.antialias,alpha:!0,depth:Ae.depth,stencil:Ae.stencil,framebufferScaleFactor:B};te=new XRWebGLLayer(T,s,Cn),T.updateRenderState({baseLayer:te}),n.setPixelRatio(1),n.setSize(te.framebufferWidth,te.framebufferHeight,!1),Ve=new Do(te.framebufferWidth,te.framebufferHeight,{format:We,type:Hr,colorSpace:n.outputColorSpace,stencilBuffer:Ae.stencil})}else{let Cn=null,Tn=null,ht=null;Ae.depth&&(ht=Ae.stencil?s.DEPTH24_STENCIL8:s.DEPTH_COMPONENT24,Cn=Ae.stencil?Ht:gt,Tn=Ae.stencil?Yo:Js),b.isMultiview=d&&l.has("OCULUS_multiview");const tn={colorFormat:s.RGBA8,depthFormat:ht,scaleFactor:B};b.isMultiview&&(tn.textureType="texture-array"),ce=new XRWebGLBinding(T,s),re=ce.createProjectionLayer(tn),T.updateRenderState({layers:[re]}),n.setPixelRatio(1),n.setSize(re.textureWidth,re.textureHeight,!1);const Qt={format:We,type:Hr,depthTexture:new mb(re.textureWidth,re.textureHeight,Tn,void 0,void 0,void 0,void 0,void 0,void 0,Cn),stencilBuffer:Ae.stencil,colorSpace:n.outputColorSpace,samples:Ae.antialias?4:0,resolveDepthBuffer:re.ignoreDepthValues===!1};if(b.isMultiview){const dn=l.get("OCULUS_multiview");this.maxNumViews=s.getParameter(dn.MAX_VIEWS_OVR),Ve=new HC(re.textureWidth,re.textureHeight,2,Qt)}else Ve=new Do(re.textureWidth,re.textureHeight,Qt)}Ve.isXRRenderTarget=!0,this.setFoveation(X),q=null,U=await T.requestReferenceSpace(z),Jn.setContext(T),Jn.start(),b.isPresenting=!0,b.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(T!==null)return T.environmentBlendMode},this.addLayer=function(en){!window.XRWebGLBinding||!this.layersEnabled||!T||(ie.push(en),this.updateLayers())},this.removeLayer=function(en){ie.splice(ie.indexOf(en),1),!(!window.XRWebGLBinding||!this.layersEnabled||!T)&&this.updateLayers()},this.updateLayers=function(){var en=ie.map(function(Cn){return Cn});en.unshift(T.renderState.layers[0]),T.updateRenderState({layers:en})};function mn(en){for(let Cn=0;Cn<en.removed.length;Cn++){const Tn=en.removed[Cn],ht=Ke.indexOf(Tn);ht>=0&&(Ke[ht]=null,ze[ht].disconnect(Tn))}for(let Cn=0;Cn<en.added.length;Cn++){const Tn=en.added[Cn];let ht=Ke.indexOf(Tn);if(ht===-1){for(let Qt=0;Qt<ze.length;Qt++)if(Qt>=Ke.length){Ke.push(Tn),ht=Qt;break}else if(Ke[Qt]===null){Ke[Qt]=Tn,ht=Qt;break}if(ht===-1)break}const tn=ze[ht];tn&&tn.connect(Tn)}}const vn=new Ge,Xn=new Ge;function Gi(en,Cn,Tn){vn.setFromMatrixPosition(Cn.matrixWorld),Xn.setFromMatrixPosition(Tn.matrixWorld);const ht=vn.distanceTo(Xn),tn=Cn.projectionMatrix.elements,Qt=Tn.projectionMatrix.elements,dn=tn[14]/(tn[10]-1),hn=tn[14]/(tn[10]+1),cn=(tn[9]+1)/tn[5],Ln=(tn[9]-1)/tn[5],Vn=(tn[8]-1)/tn[0],yi=(Qt[8]+1)/Qt[0],xi=dn*Vn,dr=dn*yi,rs=ht/(-Vn+yi),Vr=rs*-Vn;Cn.matrixWorld.decompose(en.position,en.quaternion,en.scale),en.translateX(Vr),en.translateZ(rs),en.matrixWorld.compose(en.position,en.quaternion,en.scale),en.matrixWorldInverse.copy(en.matrixWorld).invert();const Xe=dn+rs,Be=hn+rs,Dt=xi-Vr,Zt=dr+(ht-Vr),sn=cn*hn/Be*Xe,nn=Ln*hn/Be*Xe;en.projectionMatrix.makePerspective(Dt,Zt,sn,nn,Xe,Be),en.projectionMatrixInverse.copy(en.projectionMatrix).invert()}function vr(en,Cn){Cn===null?en.matrixWorld.copy(en.matrix):en.matrixWorld.multiplyMatrices(Cn.matrixWorld,en.matrix),en.matrixWorldInverse.copy(en.matrixWorld).invert()}this.setPoseTarget=function(en){en!==void 0&&(N=en)},this.updateCamera=function(en){if(T===null)return;ve.texture!==null&&(en.near=ve.depthNear,en.far=ve.depthFar),ut.near=at.near=Ye.near=en.near,ut.far=at.far=Ye.far=en.far,(wt!==ut.near||Yt!==ut.far)&&(T.updateRenderState({depthNear:ut.near,depthFar:ut.far}),wt=ut.near,Yt=ut.far,Ye.near=wt,Ye.far=Yt,at.near=wt,at.far=Yt,Ye.updateProjectionMatrix(),at.updateProjectionMatrix(),en.updateProjectionMatrix());const Cn=ut.cameras;var Tn=N||en;const ht=Tn.parent;vr(ut,ht);for(let tn=0;tn<Cn.length;tn++)vr(Cn[tn],ht);Cn.length===2?Gi(ut,Ye,at):ut.projectionMatrix.copy(Ye.projectionMatrix),Gr(en,ut,Tn)};function Gr(en,Cn,Tn){Cn.matrixWorld.decompose(Cn.position,Cn.quaternion,Cn.scale),Tn.parent===null?Tn.matrix.copy(Cn.matrixWorld):(Tn.matrix.copy(Tn.parent.matrixWorld),Tn.matrix.invert(),Tn.matrix.multiply(Cn.matrixWorld)),Tn.matrix.decompose(Tn.position,Tn.quaternion,Tn.scale),Tn.updateMatrixWorld(!0),en.projectionMatrix.copy(Cn.projectionMatrix),en.projectionMatrixInverse.copy(Cn.projectionMatrixInverse),en.isPerspectiveCamera&&(en.fov=_c*2*Math.atan(1/en.projectionMatrix.elements[5]),en.zoom=1)}this.getCamera=function(){return ut},this.getFoveation=function(){if(!(re===null&&te===null))return X},this.setFoveation=function(en){X=en,re!==null&&(re.fixedFoveation=en),te!==null&&te.fixedFoveation!==void 0&&(te.fixedFoveation=en)},this.hasDepthSensing=function(){return ve.texture!==null};let fr=null;function Lr(en,Cn){if(ee=Cn.getViewerPose(q||U),we=Cn,ee!==null){const Tn=ee.views;te!==null&&(n.setRenderTargetFramebuffer(Ve,te.framebuffer),n.setRenderTarget(Ve));let ht=!1;Tn.length!==ut.cameras.length&&(ut.cameras.length=0,ht=!0);for(let Qt=0;Qt<Tn.length;Qt++){const dn=Tn[Qt];let hn=null;if(te!==null)hn=te.getViewport(dn);else{const Ln=ce.getViewSubImage(re,dn);hn=Ln.viewport,Qt===0&&(n.setRenderTargetTextures(Ve,Ln.colorTexture,re.ignoreDepthValues?void 0:Ln.depthStencilTexture),n.setRenderTarget(Ve))}let cn=tt[Qt];cn===void 0&&(cn=new Bs,cn.layers.enable(Qt),cn.viewport=new ar,tt[Qt]=cn),cn.matrix.fromArray(dn.transform.matrix),cn.matrix.decompose(cn.position,cn.quaternion,cn.scale),cn.projectionMatrix.fromArray(dn.projectionMatrix),cn.projectionMatrixInverse.copy(cn.projectionMatrix).invert(),cn.viewport.set(hn.x,hn.y,hn.width,hn.height),Qt===0&&(ut.matrix.copy(cn.matrix),ut.matrix.decompose(ut.position,ut.quaternion,ut.scale)),ht===!0&&ut.cameras.push(cn)}const tn=T.enabledFeatures;if(tn&&tn.includes("depth-sensing")){const Qt=ce.getDepthInformation(Tn[0]);Qt&&Qt.isValid&&Qt.texture&&ve.init(n,Qt,T.renderState)}}for(let Tn=0;Tn<ze.length;Tn++){const ht=Ke[Tn],tn=ze[Tn];ht!==null&&tn!==void 0&&tn.update(ht,Cn,q||U)}ve.render(n,ut),fr&&fr(en,Cn),Cn.detectedPlanes&&b.dispatchEvent({type:"planesdetected",data:Cn}),we=null}const Jn=new ab;Jn.setAnimationLoop(Lr),this.setAnimationLoop=function(en){fr=en},this.dispose=function(){}}}const Cu=new ta,IF=new Kn;function BF(_,n){function s(re,te){re.matrixAutoUpdate===!0&&re.updateMatrix(),te.value.copy(re.matrix)}function l(re,te){te.color.getRGB(re.fogColor.value,aC(_)),te.isFog?(re.fogNear.value=te.near,re.fogFar.value=te.far):te.isFogExp2&&(re.fogDensity.value=te.density)}function d(re,te,we,ve,Ae){te.isMeshBasicMaterial||te.isMeshLambertMaterial?b(re,te):te.isMeshToonMaterial?(b(re,te),X(re,te)):te.isMeshPhongMaterial?(b(re,te),z(re,te)):te.isMeshStandardMaterial?(b(re,te),q(re,te),te.isMeshPhysicalMaterial&&ee(re,te,Ae)):te.isMeshMatcapMaterial?(b(re,te),ie(re,te)):te.isMeshDepthMaterial?b(re,te):te.isMeshDistanceMaterial?(b(re,te),ce(re,te)):te.isMeshNormalMaterial?b(re,te):te.isLineBasicMaterial?(T(re,te),te.isLineDashedMaterial&&B(re,te)):te.isPointsMaterial?N(re,te,we,ve):te.isSpriteMaterial?U(re,te):te.isShadowMaterial?(re.color.value.copy(te.color),re.opacity.value=te.opacity):te.isShaderMaterial&&(te.uniformsNeedUpdate=!1)}function b(re,te){re.opacity.value=te.opacity,te.color&&re.diffuse.value.copy(te.color),te.emissive&&re.emissive.value.copy(te.emissive).multiplyScalar(te.emissiveIntensity),te.map&&(re.map.value=te.map,s(te.map,re.mapTransform)),te.alphaMap&&(re.alphaMap.value=te.alphaMap,s(te.alphaMap,re.alphaMapTransform)),te.bumpMap&&(re.bumpMap.value=te.bumpMap,s(te.bumpMap,re.bumpMapTransform),re.bumpScale.value=te.bumpScale,te.side===I&&(re.bumpScale.value*=-1)),te.normalMap&&(re.normalMap.value=te.normalMap,s(te.normalMap,re.normalMapTransform),re.normalScale.value.copy(te.normalScale),te.side===I&&re.normalScale.value.negate()),te.displacementMap&&(re.displacementMap.value=te.displacementMap,s(te.displacementMap,re.displacementMapTransform),re.displacementScale.value=te.displacementScale,re.displacementBias.value=te.displacementBias),te.emissiveMap&&(re.emissiveMap.value=te.emissiveMap,s(te.emissiveMap,re.emissiveMapTransform)),te.specularMap&&(re.specularMap.value=te.specularMap,s(te.specularMap,re.specularMapTransform)),te.alphaTest>0&&(re.alphaTest.value=te.alphaTest);const we=n.get(te),ve=we.envMap,Ae=we.envMapRotation;if(ve&&(re.envMap.value=ve,Cu.copy(Ae),Cu.x*=-1,Cu.y*=-1,Cu.z*=-1,ve.isCubeTexture&&ve.isRenderTargetTexture===!1&&(Cu.y*=-1,Cu.z*=-1),re.envMapRotation.value.setFromMatrix4(IF.makeRotationFromEuler(Cu)),re.flipEnvMap.value=ve.isCubeTexture&&ve.isRenderTargetTexture===!1?-1:1,re.reflectivity.value=te.reflectivity,re.ior.value=te.ior,re.refractionRatio.value=te.refractionRatio),te.lightMap){re.lightMap.value=te.lightMap;const qe=_._useLegacyLights===!0?Math.PI:1;re.lightMapIntensity.value=te.lightMapIntensity*qe,s(te.lightMap,re.lightMapTransform)}te.aoMap&&(re.aoMap.value=te.aoMap,re.aoMapIntensity.value=te.aoMapIntensity,s(te.aoMap,re.aoMapTransform))}function T(re,te){re.diffuse.value.copy(te.color),re.opacity.value=te.opacity,te.map&&(re.map.value=te.map,s(te.map,re.mapTransform))}function B(re,te){re.dashSize.value=te.dashSize,re.totalSize.value=te.dashSize+te.gapSize,re.scale.value=te.scale}function N(re,te,we,ve){re.diffuse.value.copy(te.color),re.opacity.value=te.opacity,re.size.value=te.size*we,re.scale.value=ve*.5,te.map&&(re.map.value=te.map,s(te.map,re.uvTransform)),te.alphaMap&&(re.alphaMap.value=te.alphaMap,s(te.alphaMap,re.alphaMapTransform)),te.alphaTest>0&&(re.alphaTest.value=te.alphaTest)}function U(re,te){re.diffuse.value.copy(te.color),re.opacity.value=te.opacity,re.rotation.value=te.rotation,te.map&&(re.map.value=te.map,s(te.map,re.mapTransform)),te.alphaMap&&(re.alphaMap.value=te.alphaMap,s(te.alphaMap,re.alphaMapTransform)),te.alphaTest>0&&(re.alphaTest.value=te.alphaTest)}function z(re,te){re.specular.value.copy(te.specular),re.shininess.value=Math.max(te.shininess,1e-4)}function X(re,te){te.gradientMap&&(re.gradientMap.value=te.gradientMap)}function q(re,te){re.metalness.value=te.metalness,te.metalnessMap&&(re.metalnessMap.value=te.metalnessMap,s(te.metalnessMap,re.metalnessMapTransform)),re.roughness.value=te.roughness,te.roughnessMap&&(re.roughnessMap.value=te.roughnessMap,s(te.roughnessMap,re.roughnessMapTransform)),te.envMap&&(re.envMapIntensity.value=te.envMapIntensity)}function ee(re,te,we){re.ior.value=te.ior,te.sheen>0&&(re.sheenColor.value.copy(te.sheenColor).multiplyScalar(te.sheen),re.sheenRoughness.value=te.sheenRoughness,te.sheenColorMap&&(re.sheenColorMap.value=te.sheenColorMap,s(te.sheenColorMap,re.sheenColorMapTransform)),te.sheenRoughnessMap&&(re.sheenRoughnessMap.value=te.sheenRoughnessMap,s(te.sheenRoughnessMap,re.sheenRoughnessMapTransform))),te.clearcoat>0&&(re.clearcoat.value=te.clearcoat,re.clearcoatRoughness.value=te.clearcoatRoughness,te.clearcoatMap&&(re.clearcoatMap.value=te.clearcoatMap,s(te.clearcoatMap,re.clearcoatMapTransform)),te.clearcoatRoughnessMap&&(re.clearcoatRoughnessMap.value=te.clearcoatRoughnessMap,s(te.clearcoatRoughnessMap,re.clearcoatRoughnessMapTransform)),te.clearcoatNormalMap&&(re.clearcoatNormalMap.value=te.clearcoatNormalMap,s(te.clearcoatNormalMap,re.clearcoatNormalMapTransform),re.clearcoatNormalScale.value.copy(te.clearcoatNormalScale),te.side===I&&re.clearcoatNormalScale.value.negate())),te.dispersion>0&&(re.dispersion.value=te.dispersion),te.iridescence>0&&(re.iridescence.value=te.iridescence,re.iridescenceIOR.value=te.iridescenceIOR,re.iridescenceThicknessMinimum.value=te.iridescenceThicknessRange[0],re.iridescenceThicknessMaximum.value=te.iridescenceThicknessRange[1],te.iridescenceMap&&(re.iridescenceMap.value=te.iridescenceMap,s(te.iridescenceMap,re.iridescenceMapTransform)),te.iridescenceThicknessMap&&(re.iridescenceThicknessMap.value=te.iridescenceThicknessMap,s(te.iridescenceThicknessMap,re.iridescenceThicknessMapTransform))),te.transmission>0&&(re.transmission.value=te.transmission,re.transmissionSamplerMap.value=we.texture,re.transmissionSamplerSize.value.set(we.width,we.height),te.transmissionMap&&(re.transmissionMap.value=te.transmissionMap,s(te.transmissionMap,re.transmissionMapTransform)),re.thickness.value=te.thickness,te.thicknessMap&&(re.thicknessMap.value=te.thicknessMap,s(te.thicknessMap,re.thicknessMapTransform)),re.attenuationDistance.value=te.attenuationDistance,re.attenuationColor.value.copy(te.attenuationColor)),te.anisotropy>0&&(re.anisotropyVector.value.set(te.anisotropy*Math.cos(te.anisotropyRotation),te.anisotropy*Math.sin(te.anisotropyRotation)),te.anisotropyMap&&(re.anisotropyMap.value=te.anisotropyMap,s(te.anisotropyMap,re.anisotropyMapTransform))),re.specularIntensity.value=te.specularIntensity,re.specularColor.value.copy(te.specularColor),te.specularColorMap&&(re.specularColorMap.value=te.specularColorMap,s(te.specularColorMap,re.specularColorMapTransform)),te.specularIntensityMap&&(re.specularIntensityMap.value=te.specularIntensityMap,s(te.specularIntensityMap,re.specularIntensityMapTransform))}function ie(re,te){te.matcap&&(re.matcap.value=te.matcap)}function ce(re,te){const we=n.get(te).light;re.referencePosition.value.setFromMatrixPosition(we.matrixWorld),re.nearDistance.value=we.shadow.camera.near,re.farDistance.value=we.shadow.camera.far}return{refreshFogUniforms:l,refreshMaterialUniforms:d}}function RF(_,n,s,l){let d={},b={},T=[];const B=_.getParameter(_.MAX_UNIFORM_BUFFER_BINDINGS);function N(we,ve){const Ae=ve.program;l.uniformBlockBinding(we,Ae)}function U(we,ve){let Ae=d[we.id];Ae===void 0&&(ie(we),Ae=z(we),d[we.id]=Ae,we.addEventListener("dispose",re));const qe=ve.program;l.updateUBOMapping(we,qe);const Ve=n.render.frame;b[we.id]!==Ve&&(q(we),b[we.id]=Ve)}function z(we){const ve=X();we.__bindingPointIndex=ve;const Ae=_.createBuffer(),qe=we.__size,Ve=we.usage;return _.bindBuffer(_.UNIFORM_BUFFER,Ae),_.bufferData(_.UNIFORM_BUFFER,qe,Ve),_.bindBuffer(_.UNIFORM_BUFFER,null),_.bindBufferBase(_.UNIFORM_BUFFER,ve,Ae),Ae}function X(){for(let we=0;we<B;we++)if(T.indexOf(we)===-1)return T.push(we),we;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function q(we){const ve=d[we.id],Ae=we.uniforms,qe=we.__cache;_.bindBuffer(_.UNIFORM_BUFFER,ve);for(let Ve=0,ze=Ae.length;Ve<ze;Ve++){const Ke=Array.isArray(Ae[Ve])?Ae[Ve]:[Ae[Ve]];for(let De=0,Ie=Ke.length;De<Ie;De++){const Ye=Ke[De];if(ee(Ye,Ve,De,qe)===!0){const at=Ye.__offset,tt=Array.isArray(Ye.value)?Ye.value:[Ye.value];let ut=0;for(let wt=0;wt<tt.length;wt++){const Yt=tt[wt],_n=ce(Yt);typeof Yt=="number"||typeof Yt=="boolean"?(Ye.__data[0]=Yt,_.bufferSubData(_.UNIFORM_BUFFER,at+ut,Ye.__data)):Yt.isMatrix3?(Ye.__data[0]=Yt.elements[0],Ye.__data[1]=Yt.elements[1],Ye.__data[2]=Yt.elements[2],Ye.__data[3]=0,Ye.__data[4]=Yt.elements[3],Ye.__data[5]=Yt.elements[4],Ye.__data[6]=Yt.elements[5],Ye.__data[7]=0,Ye.__data[8]=Yt.elements[6],Ye.__data[9]=Yt.elements[7],Ye.__data[10]=Yt.elements[8],Ye.__data[11]=0):(Yt.toArray(Ye.__data,ut),ut+=_n.storage/Float32Array.BYTES_PER_ELEMENT)}_.bufferSubData(_.UNIFORM_BUFFER,at,Ye.__data)}}}_.bindBuffer(_.UNIFORM_BUFFER,null)}function ee(we,ve,Ae,qe){const Ve=we.value,ze=ve+"_"+Ae;if(qe[ze]===void 0)return typeof Ve=="number"||typeof Ve=="boolean"?qe[ze]=Ve:qe[ze]=Ve.clone(),!0;{const Ke=qe[ze];if(typeof Ve=="number"||typeof Ve=="boolean"){if(Ke!==Ve)return qe[ze]=Ve,!0}else if(Ke.equals(Ve)===!1)return Ke.copy(Ve),!0}return!1}function ie(we){const ve=we.uniforms;let Ae=0;const qe=16;for(let ze=0,Ke=ve.length;ze<Ke;ze++){const De=Array.isArray(ve[ze])?ve[ze]:[ve[ze]];for(let Ie=0,Ye=De.length;Ie<Ye;Ie++){const at=De[Ie],tt=Array.isArray(at.value)?at.value:[at.value];for(let ut=0,wt=tt.length;ut<wt;ut++){const Yt=tt[ut],_n=ce(Yt),Mt=Ae%qe;Mt!==0&&qe-Mt<_n.boundary&&(Ae+=qe-Mt),at.__data=new Float32Array(_n.storage/Float32Array.BYTES_PER_ELEMENT),at.__offset=Ae,Ae+=_n.storage}}}const Ve=Ae%qe;return Ve>0&&(Ae+=qe-Ve),we.__size=Ae,we.__cache={},this}function ce(we){const ve={boundary:0,storage:0};return typeof we=="number"||typeof we=="boolean"?(ve.boundary=4,ve.storage=4):we.isVector2?(ve.boundary=8,ve.storage=8):we.isVector3||we.isColor?(ve.boundary=16,ve.storage=12):we.isVector4?(ve.boundary=16,ve.storage=16):we.isMatrix3?(ve.boundary=48,ve.storage=48):we.isMatrix4?(ve.boundary=64,ve.storage=64):we.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",we),ve}function re(we){const ve=we.target;ve.removeEventListener("dispose",re);const Ae=T.indexOf(ve.__bindingPointIndex);T.splice(Ae,1),_.deleteBuffer(d[ve.id]),delete d[ve.id],delete b[ve.id]}function te(){for(const we in d)_.deleteBuffer(d[we]);T=[],d={},b={}}return{bind:N,update:U,dispose:te}}class LF{constructor(n={}){const{canvas:s=n0(),context:l=null,depth:d=!0,stencil:b=!1,alpha:T=!1,antialias:B=!1,premultipliedAlpha:N=!0,preserveDrawingBuffer:U=!1,powerPreference:z="default",failIfMajorPerformanceCaveat:X=!1,multiviewStereo:q=!1}=n;this.isWebGLRenderer=!0;let ee;if(l!==null){if(typeof WebGLRenderingContext<"u"&&l instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");ee=l.getContextAttributes().alpha}else ee=T;const ie=new Uint32Array(4),ce=new Int32Array(4);let re=null,te=null;const we=[],ve=[];this.domElement=s,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=rr,this._useLegacyLights=!1,this.toneMapping=yt,this.toneMappingExposure=1;const Ae=this;let qe=!1,Ve=0,ze=0,Ke=null,De=-1,Ie=null;const Ye=new ar,at=new ar;let tt=null;const ut=new Qn(0);let wt=0,Yt=s.width,_n=s.height,Mt=1,mn=null,vn=null;const Xn=new ar(0,0,Yt,_n),Gi=new ar(0,0,Yt,_n);let vr=!1;const Gr=new Ed;let fr=!1,Lr=!1;const Jn=new Kn,en=new Ge,Cn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Tn(){return Ke===null?Mt:1}let ht=l;function tn(ke,pt){return s.getContext(ke,pt)}try{const ke={alpha:!0,depth:d,stencil:b,antialias:B,premultipliedAlpha:N,preserveDrawingBuffer:U,powerPreference:z,failIfMajorPerformanceCaveat:X};if("setAttribute"in s&&s.setAttribute("data-engine",`three.js r${f}`),s.addEventListener("webglcontextlost",bn,!1),s.addEventListener("webglcontextrestored",ii,!1),s.addEventListener("webglcontextcreationerror",Un,!1),ht===null){const pt="webgl2";if(ht=tn(pt,ke),ht===null)throw tn(pt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ke){throw console.error("THREE.WebGLRenderer: "+ke.message),ke}let Qt,dn,hn,cn,Ln,Vn,yi,xi,dr,rs,Vr,Xe,Be,Dt,Zt,sn,nn,ni,En,Hn,xr,zn,ri,Oi,mi;function et(){Qt=new QN(ht),Qt.init(),ri=new UC(ht,Qt),dn=new ON(ht,Qt,n,ri),hn=new _F(ht),cn=new jN(ht),Ln=new cF,Vn=new EF(ht,Qt,hn,Ln,dn,ri,cn),yi=new kN(Ae),xi=new VN(Ae),dr=new LD(ht),Oi=new DN(ht,dr),rs=new HN(ht,dr,cn,Oi),Vr=new XN(ht,rs,dr,cn),Hn=new WN(ht,dn,Vn),sn=new FN(Ln),Xe=new lF(Ae,yi,xi,Qt,dn,Oi,sn),Be=new BF(Ae,Ln),Dt=new hF,Zt=new gF(Qt),En=new PN(Ae,yi,xi,hn,Vr,ee,N),ni=new $N(Ae,Qt,ht),nn=new yF(Ae,Vr,dn),mi=new RF(ht,cn,dn,hn),xr=new NN(ht,Qt,cn),zn=new zN(ht,Qt,cn),cn.programs=Xe.programs,Ae.capabilities=dn,Ae.extensions=Qt,Ae.properties=Ln,Ae.renderLists=Dt,Ae.shadowMap=nn,Ae.state=hn,Ae.info=cn}et();const un=typeof navigator<"u"&&"xr"in navigator?new TF(Ae,ht,Qt,q):new QC(Ae);this.xr=un,this.getContext=function(){return ht},this.getContextAttributes=function(){return ht.getContextAttributes()},this.forceContextLoss=function(){const ke=Qt.get("WEBGL_lose_context");ke&&ke.loseContext()},this.forceContextRestore=function(){const ke=Qt.get("WEBGL_lose_context");ke&&ke.restoreContext()},this.getPixelRatio=function(){return Mt},this.setPixelRatio=function(ke){ke!==void 0&&(Mt=ke,this.setSize(Yt,_n,!1))},this.getSize=function(ke){return ke.set(Yt,_n)},this.setSize=function(ke,pt,xt=!0){if(un.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Yt=ke,_n=pt,s.width=Math.floor(ke*Mt),s.height=Math.floor(pt*Mt),xt===!0&&(s.style.width=ke+"px",s.style.height=pt+"px"),this.setViewport(0,0,ke,pt)},this.getDrawingBufferSize=function(ke){return ke.set(Yt*Mt,_n*Mt).floor()},this.setDrawingBufferSize=function(ke,pt,xt){Yt=ke,_n=pt,Mt=xt,s.width=Math.floor(ke*xt),s.height=Math.floor(pt*xt),this.setViewport(0,0,ke,pt)},this.getCurrentViewport=function(ke){return ke.copy(Ye)},this.getViewport=function(ke){return ke.copy(Xn)},this.setViewport=function(ke,pt,xt,_t){ke.isVector4?Xn.set(ke.x,ke.y,ke.z,ke.w):Xn.set(ke,pt,xt,_t),hn.viewport(Ye.copy(Xn).multiplyScalar(Mt).round())},this.getScissor=function(ke){return ke.copy(Gi)},this.setScissor=function(ke,pt,xt,_t){ke.isVector4?Gi.set(ke.x,ke.y,ke.z,ke.w):Gi.set(ke,pt,xt,_t),hn.scissor(at.copy(Gi).multiplyScalar(Mt).round())},this.getScissorTest=function(){return vr},this.setScissorTest=function(ke){hn.setScissorTest(vr=ke)},this.setOpaqueSort=function(ke){mn=ke},this.setTransparentSort=function(ke){vn=ke},this.getClearColor=function(ke){return ke.copy(En.getClearColor())},this.setClearColor=function(){En.setClearColor.apply(En,arguments)},this.getClearAlpha=function(){return En.getClearAlpha()},this.setClearAlpha=function(){En.setClearAlpha.apply(En,arguments)},this.clear=function(ke=!0,pt=!0,xt=!0){let _t=0;if(ke){let Et=!1;if(Ke!==null){const On=Ke.texture.format;Et=On===Zn||On===zt||On===jn}if(Et){const On=Ke.texture.type,si=On===Hr||On===Js||On===go||On===Yo||On===ps||On===Rl,li=En.getClearColor(),vi=En.getClearAlpha(),Bi=li.r,Vi=li.g,$i=li.b;si?(ie[0]=Bi,ie[1]=Vi,ie[2]=$i,ie[3]=vi,ht.clearBufferuiv(ht.COLOR,0,ie)):(ce[0]=Bi,ce[1]=Vi,ce[2]=$i,ce[3]=vi,ht.clearBufferiv(ht.COLOR,0,ce))}else _t|=ht.COLOR_BUFFER_BIT}pt&&(_t|=ht.DEPTH_BUFFER_BIT),xt&&(_t|=ht.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ht.clear(_t)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){s.removeEventListener("webglcontextlost",bn,!1),s.removeEventListener("webglcontextrestored",ii,!1),s.removeEventListener("webglcontextcreationerror",Un,!1),Dt.dispose(),Zt.dispose(),Ln.dispose(),yi.dispose(),xi.dispose(),Vr.dispose(),Oi.dispose(),mi.dispose(),Xe.dispose(),un.dispose(),un.removeEventListener("sessionstart",ul),un.removeEventListener("sessionend",Bx),Fu.stop()};function bn(ke){ke.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),qe=!0}function ii(){console.log("THREE.WebGLRenderer: Context Restored."),qe=!1;const ke=cn.autoReset,pt=nn.enabled,xt=nn.autoUpdate,_t=nn.needsUpdate,Et=nn.type;et(),cn.autoReset=ke,nn.enabled=pt,nn.autoUpdate=xt,nn.needsUpdate=_t,nn.type=Et}function Un(ke){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ke.statusMessage)}function Fi(ke){const pt=ke.target;pt.removeEventListener("dispose",Fi),Gn(pt)}function Gn(ke){Pn(ke),Ln.remove(ke)}function Pn(ke){const pt=Ln.get(ke).programs;pt!==void 0&&(pt.forEach(function(xt){Xe.releaseProgram(xt)}),ke.isShaderMaterial&&Xe.releaseShaderCache(ke))}this.renderBufferDirect=function(ke,pt,xt,_t,Et,On){pt===null&&(pt=Cn);const si=Et.isMesh&&Et.matrixWorld.determinant()<0,li=MU(ke,pt,xt,_t,Et);hn.setMaterial(_t,si);let vi=xt.index,Bi=1;if(_t.wireframe===!0){if(vi=rs.getWireframeAttribute(xt),vi===void 0)return;Bi=2}const Vi=xt.drawRange,$i=xt.attributes.position;let Cs=Vi.start*Bi,co=(Vi.start+Vi.count)*Bi;On!==null&&(Cs=Math.max(Cs,On.start*Bi),co=Math.min(co,(On.start+On.count)*Bi)),vi!==null?(Cs=Math.max(Cs,0),co=Math.min(co,vi.count)):$i!=null&&(Cs=Math.max(Cs,0),co=Math.min(co,$i.count));const ra=co-Cs;if(ra<0||ra===1/0)return;Oi.setup(Et,_t,li,xt,vi);let Fc,br=xr;if(vi!==null&&(Fc=dr.get(vi),br=zn,br.setIndex(Fc)),Et.isMesh)_t.wireframe===!0?(hn.setLineWidth(_t.wireframeLinewidth*Tn()),br.setMode(ht.LINES)):br.setMode(ht.TRIANGLES);else if(Et.isLine){let $l=_t.linewidth;$l===void 0&&($l=1),hn.setLineWidth($l*Tn()),Et.isLineSegments?br.setMode(ht.LINES):Et.isLineLoop?br.setMode(ht.LINE_LOOP):br.setMode(ht.LINE_STRIP)}else Et.isPoints?br.setMode(ht.POINTS):Et.isSprite&&br.setMode(ht.TRIANGLES);if(Et.isBatchedMesh)Et._multiDrawInstances!==null?br.renderMultiDrawInstances(Et._multiDrawStarts,Et._multiDrawCounts,Et._multiDrawCount,Et._multiDrawInstances):br.renderMultiDraw(Et._multiDrawStarts,Et._multiDrawCounts,Et._multiDrawCount);else if(Et.isInstancedMesh)br.renderInstances(Cs,ra,Et.count);else if(xt.isInstancedBufferGeometry){const $l=xt._maxInstanceCount!==void 0?xt._maxInstanceCount:1/0,Hi=Math.min(xt.instanceCount,$l);br.renderInstances(Cs,ra,Hi)}else br.render(Cs,ra)};function Qi(ke,pt,xt){ke.transparent===!0&&ke.side===L&&ke.forceSinglePass===!1?(ke.side=I,ke.needsUpdate=!0,CA(ke,pt,xt),ke.side=S,ke.needsUpdate=!0,CA(ke,pt,xt),ke.side=L):CA(ke,pt,xt)}this.compile=function(ke,pt,xt=null){xt===null&&(xt=ke),te=Zt.get(xt),te.init(pt),ve.push(te),xt.traverseVisible(function(Et){Et.isLight&&Et.layers.test(pt.layers)&&(te.pushLight(Et),Et.castShadow&&te.pushShadow(Et))}),ke!==xt&&ke.traverseVisible(function(Et){Et.isLight&&Et.layers.test(pt.layers)&&(te.pushLight(Et),Et.castShadow&&te.pushShadow(Et))}),te.setupLights(Ae._useLegacyLights);const _t=new Set;return ke.traverse(function(Et){const On=Et.material;if(On)if(Array.isArray(On))for(let si=0;si<On.length;si++){const li=On[si];Qi(li,xt,Et),_t.add(li)}else Qi(On,xt,Et),_t.add(On)}),ve.pop(),te=null,_t},this.compileAsync=function(ke,pt,xt=null){const _t=this.compile(ke,pt,xt);return new Promise(Et=>{function On(){if(_t.forEach(function(si){Ln.get(si).currentProgram.isReady()&&_t.delete(si)}),_t.size===0){Et(ke);return}setTimeout(On,10)}Qt.get("KHR_parallel_shader_compile")!==null?On():setTimeout(On,10)})};let gi=null;function Ps(ke){gi&&gi(ke)}function ul(){Fu.stop()}function Bx(){Fu.start()}const Fu=new ab;Fu.setAnimationLoop(Ps),typeof self<"u"&&Fu.setContext(self),this.setAnimationLoop=function(ke){gi=ke,un.setAnimationLoop(ke),ke===null?Fu.stop():Fu.start()},un.addEventListener("sessionstart",ul),un.addEventListener("sessionend",Bx),this.render=function(ke,pt){if(pt!==void 0&&pt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(qe===!0)return;ke.matrixWorldAutoUpdate===!0&&ke.updateMatrixWorld(),pt.parent===null&&pt.matrixWorldAutoUpdate===!0&&pt.updateMatrixWorld(),un.enabled===!0&&un.isPresenting===!0&&(un.cameraAutoUpdate===!0&&un.updateCamera(pt),pt=un.getCamera()),ke.isScene===!0&&ke.onBeforeRender(Ae,ke,pt,Ke),te=Zt.get(ke,ve.length),te.init(pt),ve.push(te),Jn.multiplyMatrices(pt.projectionMatrix,pt.matrixWorldInverse),Gr.setFromProjectionMatrix(Jn),Lr=this.localClippingEnabled,fr=sn.init(this.clippingPlanes,Lr),re=Dt.get(ke,we.length),re.init(),we.push(re),Rx(ke,pt,0,Ae.sortObjects),re.finish(),Ae.sortObjects===!0&&re.sort(mn,vn);const xt=un.enabled===!1||un.isPresenting===!1||un.hasDepthSensing()===!1;xt&&En.addToRenderList(re,ke),this.info.render.frame++,fr===!0&&sn.beginShadows();const _t=te.state.shadowsArray;nn.render(_t,ke,pt),fr===!0&&sn.endShadows(),this.info.autoReset===!0&&this.info.reset();const Et=re.opaque,On=re.transmissive;if(te.setupLights(Ae._useLegacyLights),pt.isArrayCamera){const si=pt.cameras;if(On.length>0)for(let li=0,vi=si.length;li<vi;li++){const Bi=si[li];Lx(Et,On,ke,Bi)}if(xt&&En.render(ke),un.enabled&&un.isMultiview)Vn.setDeferTextureUploads(!0),ay(re,ke,pt,pt.cameras[0].viewport);else for(let li=0,vi=si.length;li<vi;li++){const Bi=si[li];ay(re,ke,Bi,Bi.viewport)}}else On.length>0&&Lx(Et,On,ke,pt),xt&&En.render(ke),ay(re,ke,pt);Ke!==null&&(Vn.updateMultisampleRenderTarget(Ke),Vn.updateRenderTargetMipmap(Ke)),ke.isScene===!0&&ke.onAfterRender(Ae,ke,pt),Vn.runDeferredUploads(),un.enabled&&un.submitFrame&&un.submitFrame(),Oi.resetDefaultState(),De=-1,Ie=null,ve.pop(),ve.length>0?(te=ve[ve.length-1],fr===!0&&sn.setGlobalState(Ae.clippingPlanes,te.state.camera)):te=null,we.pop(),we.length>0?re=we[we.length-1]:re=null};function Rx(ke,pt,xt,_t){if(ke.visible===!1)return;if(ke.layers.test(pt.layers)){if(ke.isGroup)xt=ke.renderOrder;else if(ke.isLOD)ke.autoUpdate===!0&&ke.update(pt);else if(ke.isLight)te.pushLight(ke),ke.castShadow&&te.pushShadow(ke);else if(ke.isSprite){if(!ke.frustumCulled||Gr.intersectsSprite(ke)){_t&&en.setFromMatrixPosition(ke.matrixWorld).applyMatrix4(Jn);const si=Vr.update(ke),li=ke.material;li.visible&&re.push(ke,si,li,xt,en.z,null)}}else if((ke.isMesh||ke.isLine||ke.isPoints)&&(!ke.frustumCulled||Gr.intersectsObject(ke))){const si=Vr.update(ke),li=ke.material;if(_t&&(ke.boundingSphere!==void 0?(ke.boundingSphere===null&&ke.computeBoundingSphere(),en.copy(ke.boundingSphere.center)):(si.boundingSphere===null&&si.computeBoundingSphere(),en.copy(si.boundingSphere.center)),en.applyMatrix4(ke.matrixWorld).applyMatrix4(Jn)),Array.isArray(li)){const vi=si.groups;for(let Bi=0,Vi=vi.length;Bi<Vi;Bi++){const $i=vi[Bi],Cs=li[$i.materialIndex];Cs&&Cs.visible&&re.push(ke,si,Cs,xt,en.z,$i)}}else li.visible&&re.push(ke,si,li,xt,en.z,null)}}const On=ke.children;for(let si=0,li=On.length;si<li;si++)Rx(On[si],pt,xt,_t)}function ay(ke,pt,xt,_t){const Et=ke.opaque,On=ke.transmissive,si=ke.transparent;te.setupLightsView(xt),fr===!0&&sn.setGlobalState(Ae.clippingPlanes,xt),_t&&hn.viewport(Ye.copy(_t)),Et.length>0&&wA(Et,pt,xt),On.length>0&&wA(On,pt,xt),si.length>0&&wA(si,pt,xt),hn.buffers.depth.setTest(!0),hn.buffers.depth.setMask(!0),hn.buffers.color.setMask(!0),hn.setPolygonOffset(!1)}function Lx(ke,pt,xt,_t){if((xt.isScene===!0?xt.overrideMaterial:null)!==null)return;te.state.transmissionRenderTarget[_t.id]===void 0&&(te.state.transmissionRenderTarget[_t.id]=new Do(1,1,{generateMipmaps:!0,type:Qt.has("EXT_color_buffer_half_float")||Qt.has("EXT_color_buffer_float")?Er:Hr,minFilter:_r,samples:4,stencilBuffer:b,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const On=te.state.transmissionRenderTarget[_t.id],si=_t.viewport||Ye;On.setSize(si.z,si.w);const li=Ae.getRenderTarget();Ae.setRenderTarget(On),Ae.getClearColor(ut),wt=Ae.getClearAlpha(),wt<1&&Ae.setClearColor(16777215,.5),Ae.clear();const vi=Ae.toneMapping;Ae.toneMapping=yt;const Bi=_t.viewport;if(_t.viewport!==void 0&&(_t.viewport=void 0),te.setupLightsView(_t),fr===!0&&sn.setGlobalState(Ae.clippingPlanes,_t),wA(ke,xt,_t),Vn.updateMultisampleRenderTarget(On),Vn.updateRenderTargetMipmap(On),Qt.has("WEBGL_multisampled_render_to_texture")===!1){let Vi=!1;for(let $i=0,Cs=pt.length;$i<Cs;$i++){const co=pt[$i],ra=co.object,Fc=co.geometry,br=co.material,$l=co.group;if(br.side===L&&ra.layers.test(_t.layers)){const Hi=br.side;br.side=I,br.needsUpdate=!0,Px(ra,xt,_t,Fc,br,$l),br.side=Hi,br.needsUpdate=!0,Vi=!0}}Vi===!0&&(Vn.updateMultisampleRenderTarget(On),Vn.updateRenderTargetMipmap(On))}Ae.setRenderTarget(li),Ae.setClearColor(ut,wt),Bi!==void 0&&(_t.viewport=Bi),Ae.toneMapping=vi}function wA(ke,pt,xt){const _t=pt.isScene===!0?pt.overrideMaterial:null;for(let Et=0,On=ke.length;Et<On;Et++){const si=ke[Et],li=si.object,vi=si.geometry,Bi=_t===null?si.material:_t,Vi=si.group;li.layers.test(xt.layers)&&Px(li,pt,xt,vi,Bi,Vi)}}function Px(ke,pt,xt,_t,Et,On){ke.onBeforeRender(Ae,pt,xt,_t,Et,On),ke.modelViewMatrix.multiplyMatrices(xt.matrixWorldInverse,ke.matrixWorld),ke.normalMatrix.getNormalMatrix(ke.modelViewMatrix),Et.onBeforeRender(Ae,pt,xt,_t,ke,On),Et.transparent===!0&&Et.side===L&&Et.forceSinglePass===!1?(Et.side=I,Et.needsUpdate=!0,Ae.renderBufferDirect(xt,pt,_t,Et,ke,On),Et.side=S,Et.needsUpdate=!0,Ae.renderBufferDirect(xt,pt,_t,Et,ke,On),Et.side=L):Ae.renderBufferDirect(xt,pt,_t,Et,ke,On),ke.onAfterRender(Ae,pt,xt,_t,Et,On)}function CA(ke,pt,xt){pt.isScene!==!0&&(pt=Cn);const _t=Ln.get(ke),Et=te.state.lights,On=te.state.shadowsArray,si=Et.state.version,li=Xe.getParameters(ke,Et.state,On,pt,xt),vi=Xe.getProgramCacheKey(li);let Bi=_t.programs;_t.environment=ke.isMeshStandardMaterial?pt.environment:null,_t.fog=pt.fog,_t.envMap=(ke.isMeshStandardMaterial?xi:yi).get(ke.envMap||_t.environment),_t.envMapRotation=_t.environment!==null&&ke.envMap===null?pt.environmentRotation:ke.envMapRotation,Bi===void 0&&(ke.addEventListener("dispose",Fi),Bi=new Map,_t.programs=Bi);let Vi=Bi.get(vi);if(Vi!==void 0){if(_t.currentProgram===Vi&&_t.lightsStateVersion===si)return Nx(ke,li),Vi}else li.uniforms=Xe.getUniforms(ke),ke.onBuild(xt,li,Ae),ke.onBeforeCompile(li,Ae),Vi=Xe.acquireProgram(li,vi),Bi.set(vi,Vi),_t.uniforms=li.uniforms;const $i=_t.uniforms;return(!ke.isShaderMaterial&&!ke.isRawShaderMaterial||ke.clipping===!0)&&($i.clippingPlanes=sn.uniform),Nx(ke,li),_t.needsLights=TU(ke),_t.lightsStateVersion=si,_t.needsLights&&($i.ambientLightColor.value=Et.state.ambient,$i.lightProbe.value=Et.state.probe,$i.directionalLights.value=Et.state.directional,$i.directionalLightShadows.value=Et.state.directionalShadow,$i.spotLights.value=Et.state.spot,$i.spotLightShadows.value=Et.state.spotShadow,$i.rectAreaLights.value=Et.state.rectArea,$i.ltc_1.value=Et.state.rectAreaLTC1,$i.ltc_2.value=Et.state.rectAreaLTC2,$i.pointLights.value=Et.state.point,$i.pointLightShadows.value=Et.state.pointShadow,$i.hemisphereLights.value=Et.state.hemi,$i.directionalShadowMap.value=Et.state.directionalShadowMap,$i.directionalShadowMatrix.value=Et.state.directionalShadowMatrix,$i.spotShadowMap.value=Et.state.spotShadowMap,$i.spotLightMatrix.value=Et.state.spotLightMatrix,$i.spotLightMap.value=Et.state.spotLightMap,$i.pointShadowMap.value=Et.state.pointShadowMap,$i.pointShadowMatrix.value=Et.state.pointShadowMatrix),_t.currentProgram=Vi,_t.uniformsList=null,Vi}function Dx(ke){if(ke.uniformsList===null){const pt=ke.currentProgram.getUniforms();ke.uniformsList=T0.seqWithValue(pt.seq,ke.uniforms)}return ke.uniformsList}function Nx(ke,pt){const xt=Ln.get(ke);xt.outputColorSpace=pt.outputColorSpace,xt.batching=pt.batching,xt.instancing=pt.instancing,xt.instancingColor=pt.instancingColor,xt.instancingMorph=pt.instancingMorph,xt.skinning=pt.skinning,xt.morphTargets=pt.morphTargets,xt.morphNormals=pt.morphNormals,xt.morphColors=pt.morphColors,xt.morphTargetsCount=pt.morphTargetsCount,xt.numClippingPlanes=pt.numClippingPlanes,xt.numIntersection=pt.numClipIntersection,xt.vertexAlphas=pt.vertexAlphas,xt.vertexTangents=pt.vertexTangents,xt.toneMapping=pt.toneMapping,xt.numMultiviewViews=pt.numMultiviewViews}function MU(ke,pt,xt,_t,Et){pt.isScene!==!0&&(pt=Cn),Vn.resetTextureUnits();const On=pt.fog,si=_t.isMeshStandardMaterial?pt.environment:null,li=Ke===null?Ae.outputColorSpace:Ke.isXRRenderTarget===!0?Ke.texture.colorSpace:Na,vi=(_t.isMeshStandardMaterial?xi:yi).get(_t.envMap||si),Bi=_t.vertexColors===!0&&!!xt.attributes.color&&xt.attributes.color.itemSize===4,Vi=!!xt.attributes.tangent&&(!!_t.normalMap||_t.anisotropy>0),$i=!!xt.morphAttributes.position,Cs=!!xt.morphAttributes.normal,co=!!xt.morphAttributes.color;let ra=yt;_t.toneMapped&&(Ke===null||Ke.isXRRenderTarget===!0)&&(ra=Ae.toneMapping);const Fc=Ke&&Ke.isWebGLMultiviewRenderTarget?Ke.numViews:0,br=xt.morphAttributes.position||xt.morphAttributes.normal||xt.morphAttributes.color,$l=br!==void 0?br.length:0,Hi=Ln.get(_t),IU=te.state.lights;if(fr===!0&&(Lr===!0||ke!==Ie)){const va=ke===Ie&&_t.id===De;sn.setState(_t,ke,va)}let $r=!1;_t.version===Hi.__version?(Hi.needsLights&&Hi.lightsStateVersion!==IU.state.version||Hi.outputColorSpace!==li||Et.isBatchedMesh&&Hi.batching===!1||!Et.isBatchedMesh&&Hi.batching===!0||Et.isInstancedMesh&&Hi.instancing===!1||!Et.isInstancedMesh&&Hi.instancing===!0||Et.isSkinnedMesh&&Hi.skinning===!1||!Et.isSkinnedMesh&&Hi.skinning===!0||Et.isInstancedMesh&&Hi.instancingColor===!0&&Et.instanceColor===null||Et.isInstancedMesh&&Hi.instancingColor===!1&&Et.instanceColor!==null||Et.isInstancedMesh&&Hi.instancingMorph===!0&&Et.morphTexture===null||Et.isInstancedMesh&&Hi.instancingMorph===!1&&Et.morphTexture!==null||Hi.envMap!==vi||_t.fog===!0&&Hi.fog!==On||Hi.numClippingPlanes!==void 0&&(Hi.numClippingPlanes!==sn.numPlanes||Hi.numIntersection!==sn.numIntersection)||Hi.vertexAlphas!==Bi||Hi.vertexTangents!==Vi||Hi.morphTargets!==$i||Hi.morphNormals!==Cs||Hi.morphColors!==co||Hi.toneMapping!==ra||Hi.morphTargetsCount!==$l||Hi.numMultiviewViews!==Fc)&&($r=!0):($r=!0,Hi.__version=_t.version);let Xl=Hi.currentProgram;$r===!0&&(Xl=CA(_t,pt,Et));let Ox=!1,Wd=!1,ly=!1;const Ds=Xl.getUniforms(),kc=Hi.uniforms;if(hn.useProgram(Xl.program)&&(Ox=!0,Wd=!0,ly=!0),_t.id!==De&&(De=_t.id,Wd=!0),Ox||Ie!==ke){Xl.numMultiviewViews>0?(ni.updateCameraProjectionMatricesUniform(ke,Ds),ni.updateCameraViewMatricesUniform(ke,Ds)):(Ds.setValue(ht,"projectionMatrix",ke.projectionMatrix),Ds.setValue(ht,"viewMatrix",ke.matrixWorldInverse));const va=Ds.map.cameraPosition;va!==void 0&&va.setValue(ht,en.setFromMatrixPosition(ke.matrixWorld)),dn.logarithmicDepthBuffer&&Ds.setValue(ht,"logDepthBufFC",2/(Math.log(ke.far+1)/Math.LN2)),(_t.isMeshPhongMaterial||_t.isMeshToonMaterial||_t.isMeshLambertMaterial||_t.isMeshBasicMaterial||_t.isMeshStandardMaterial||_t.isShaderMaterial)&&Ds.setValue(ht,"isOrthographic",ke.isOrthographicCamera===!0),Ie!==ke&&(Ie=ke,Wd=!0,ly=!0)}if(Et.isSkinnedMesh){Ds.setOptional(ht,Et,"bindMatrix"),Ds.setOptional(ht,Et,"bindMatrixInverse");const va=Et.skeleton;va&&(va.boneTexture===null&&va.computeBoneTexture(),Ds.setValue(ht,"boneTexture",va.boneTexture,Vn))}Et.isBatchedMesh&&(Ds.setOptional(ht,Et,"batchingTexture"),Ds.setValue(ht,"batchingTexture",Et._matricesTexture,Vn));const cy=xt.morphAttributes;if((cy.position!==void 0||cy.normal!==void 0||cy.color!==void 0)&&Hn.update(Et,xt,Xl),(Wd||Hi.receiveShadow!==Et.receiveShadow)&&(Hi.receiveShadow=Et.receiveShadow,Ds.setValue(ht,"receiveShadow",Et.receiveShadow)),_t.isMeshGouraudMaterial&&_t.envMap!==null&&(kc.envMap.value=vi,kc.flipEnvMap.value=vi.isCubeTexture&&vi.isRenderTargetTexture===!1?-1:1),_t.isMeshStandardMaterial&&_t.envMap===null&&pt.environment!==null&&(kc.envMapIntensity.value=pt.environmentIntensity),Wd&&(Ds.setValue(ht,"toneMappingExposure",Ae.toneMappingExposure),Hi.needsLights&&SU(kc,ly),On&&_t.fog===!0&&Be.refreshFogUniforms(kc,On),Be.refreshMaterialUniforms(kc,_t,Mt,_n,te.state.transmissionRenderTarget[ke.id]),T0.upload(ht,Dx(Hi),kc,Vn)),_t.isShaderMaterial&&_t.uniformsNeedUpdate===!0&&(T0.upload(ht,Dx(Hi),kc,Vn),_t.uniformsNeedUpdate=!1),_t.isSpriteMaterial&&Ds.setValue(ht,"center",Et.center),Xl.numMultiviewViews>0?ni.updateObjectMatricesUniforms(Et,ke,Ds):(Ds.setValue(ht,"modelViewMatrix",Et.modelViewMatrix),Ds.setValue(ht,"normalMatrix",Et.normalMatrix)),Ds.setValue(ht,"modelMatrix",Et.matrixWorld),_t.isShaderMaterial||_t.isRawShaderMaterial){const va=_t.uniformsGroups;for(let uy=0,BU=va.length;uy<BU;uy++){const Fx=va[uy];mi.update(Fx,Xl),mi.bind(Fx,Xl)}}return Xl}function SU(ke,pt){ke.ambientLightColor.needsUpdate=pt,ke.lightProbe.needsUpdate=pt,ke.directionalLights.needsUpdate=pt,ke.directionalLightShadows.needsUpdate=pt,ke.pointLights.needsUpdate=pt,ke.pointLightShadows.needsUpdate=pt,ke.spotLights.needsUpdate=pt,ke.spotLightShadows.needsUpdate=pt,ke.rectAreaLights.needsUpdate=pt,ke.hemisphereLights.needsUpdate=pt}function TU(ke){return ke.isMeshLambertMaterial||ke.isMeshToonMaterial||ke.isMeshPhongMaterial||ke.isMeshStandardMaterial||ke.isShadowMaterial||ke.isShaderMaterial&&ke.lights===!0}this.setTexture2D=function(){var ke=!1;return function(xt,_t){xt&&xt.isWebGLRenderTarget&&(ke||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),ke=!0),xt=xt.texture),Vn.setTexture2D(xt,_t)}}(),this.getActiveCubeFace=function(){return Ve},this.getActiveMipmapLevel=function(){return ze},this.getRenderTarget=function(){return Ke},this.setRenderTargetTextures=function(ke,pt,xt){Ln.get(ke.texture).__webglTexture=pt,Ln.get(ke.depthTexture).__webglTexture=xt;const _t=Ln.get(ke);_t.__hasExternalTextures=!0,_t.__autoAllocateDepthBuffer=xt===void 0,!_t.__autoAllocateDepthBuffer&&(!Ke||!Ke.isWebGLMultiviewRenderTarget)&&Qt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),_t.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(ke,pt){const xt=Ln.get(ke);xt.__webglFramebuffer=pt,xt.__useDefaultFramebuffer=pt===void 0},this.setRenderTarget=function(ke,pt=0,xt=0){Ke=ke,Ve=pt,ze=xt;let _t=!0,Et=null,On=!1,si=!1;if(ke){const vi=Ln.get(ke);vi.__useDefaultFramebuffer!==void 0?(hn.bindFramebuffer(ht.FRAMEBUFFER,null),_t=!1):vi.__webglFramebuffer===void 0?Vn.setupRenderTarget(ke):vi.__hasExternalTextures&&Vn.rebindTextures(ke,Ln.get(ke.texture).__webglTexture,Ln.get(ke.depthTexture).__webglTexture);const Bi=ke.texture;(Bi.isData3DTexture||Bi.isDataArrayTexture||Bi.isCompressedArrayTexture)&&(si=!0);const Vi=Ln.get(ke).__webglFramebuffer;ke.isWebGLCubeRenderTarget?(Array.isArray(Vi[pt])?Et=Vi[pt][xt]:Et=Vi[pt],On=!0):ke.samples>0&&Vn.useMultisampledRTT(ke)===!1?Et=Ln.get(ke).__webglMultisampledFramebuffer:Array.isArray(Vi)?Et=Vi[xt]:Et=Vi,Ye.copy(ke.viewport),at.copy(ke.scissor),tt=ke.scissorTest}else Ye.copy(Xn).multiplyScalar(Mt).floor(),at.copy(Gi).multiplyScalar(Mt).floor(),tt=vr;if(hn.bindFramebuffer(ht.FRAMEBUFFER,Et)&&_t&&hn.drawBuffers(ke,Et),hn.viewport(Ye),hn.scissor(at),hn.setScissorTest(tt),On){const vi=Ln.get(ke.texture);ht.framebufferTexture2D(ht.FRAMEBUFFER,ht.COLOR_ATTACHMENT0,ht.TEXTURE_CUBE_MAP_POSITIVE_X+pt,vi.__webglTexture,xt)}else if(si){const vi=Ln.get(ke.texture),Bi=pt||0;ht.framebufferTextureLayer(ht.FRAMEBUFFER,ht.COLOR_ATTACHMENT0,vi.__webglTexture,xt||0,Bi)}De=-1},this.readRenderTargetPixels=function(ke,pt,xt,_t,Et,On,si){if(!(ke&&ke.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let li=Ln.get(ke).__webglFramebuffer;if(ke.isWebGLCubeRenderTarget&&si!==void 0&&(li=li[si]),li){hn.bindFramebuffer(ht.FRAMEBUFFER,li);try{const vi=ke.texture,Bi=vi.format,Vi=vi.type;if(!dn.textureFormatReadable(Bi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!dn.textureTypeReadable(Vi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}pt>=0&&pt<=ke.width-_t&&xt>=0&&xt<=ke.height-Et&&ht.readPixels(pt,xt,_t,Et,ri.convert(Bi),ri.convert(Vi),On)}finally{const vi=Ke!==null?Ln.get(Ke).__webglFramebuffer:null;hn.bindFramebuffer(ht.FRAMEBUFFER,vi)}}},this.copyFramebufferToTexture=function(ke,pt,xt=0){const _t=Math.pow(2,-xt),Et=Math.floor(pt.image.width*_t),On=Math.floor(pt.image.height*_t);Vn.setTexture2D(pt,0),ht.copyTexSubImage2D(ht.TEXTURE_2D,xt,0,0,ke.x,ke.y,Et,On),hn.unbindTexture()},this.copyTextureToTexture=function(ke,pt,xt,_t=0){const Et=pt.image.width,On=pt.image.height,si=ri.convert(xt.format),li=ri.convert(xt.type);Vn.setTexture2D(xt,0),ht.pixelStorei(ht.UNPACK_FLIP_Y_WEBGL,xt.flipY),ht.pixelStorei(ht.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xt.premultiplyAlpha),ht.pixelStorei(ht.UNPACK_ALIGNMENT,xt.unpackAlignment),pt.isDataTexture?ht.texSubImage2D(ht.TEXTURE_2D,_t,ke.x,ke.y,Et,On,si,li,pt.image.data):pt.isCompressedTexture?ht.compressedTexSubImage2D(ht.TEXTURE_2D,_t,ke.x,ke.y,pt.mipmaps[0].width,pt.mipmaps[0].height,si,pt.mipmaps[0].data):ht.texSubImage2D(ht.TEXTURE_2D,_t,ke.x,ke.y,si,li,pt.image),_t===0&&xt.generateMipmaps&&ht.generateMipmap(ht.TEXTURE_2D),hn.unbindTexture()},this.copyTextureToTexture3D=function(ke,pt,xt,_t,Et=0){const On=ke.max.x-ke.min.x,si=ke.max.y-ke.min.y,li=ke.max.z-ke.min.z,vi=ri.convert(_t.format),Bi=ri.convert(_t.type);let Vi;if(_t.isData3DTexture)Vn.setTexture3D(_t,0),Vi=ht.TEXTURE_3D;else if(_t.isDataArrayTexture||_t.isCompressedArrayTexture)Vn.setTexture2DArray(_t,0),Vi=ht.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ht.pixelStorei(ht.UNPACK_FLIP_Y_WEBGL,_t.flipY),ht.pixelStorei(ht.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_t.premultiplyAlpha),ht.pixelStorei(ht.UNPACK_ALIGNMENT,_t.unpackAlignment);const $i=ht.getParameter(ht.UNPACK_ROW_LENGTH),Cs=ht.getParameter(ht.UNPACK_IMAGE_HEIGHT),co=ht.getParameter(ht.UNPACK_SKIP_PIXELS),ra=ht.getParameter(ht.UNPACK_SKIP_ROWS),Fc=ht.getParameter(ht.UNPACK_SKIP_IMAGES),br=xt.isCompressedTexture?xt.mipmaps[Et]:xt.image;ht.pixelStorei(ht.UNPACK_ROW_LENGTH,br.width),ht.pixelStorei(ht.UNPACK_IMAGE_HEIGHT,br.height),ht.pixelStorei(ht.UNPACK_SKIP_PIXELS,ke.min.x),ht.pixelStorei(ht.UNPACK_SKIP_ROWS,ke.min.y),ht.pixelStorei(ht.UNPACK_SKIP_IMAGES,ke.min.z),xt.isDataTexture||xt.isData3DTexture?ht.texSubImage3D(Vi,Et,pt.x,pt.y,pt.z,On,si,li,vi,Bi,br.data):_t.isCompressedArrayTexture?ht.compressedTexSubImage3D(Vi,Et,pt.x,pt.y,pt.z,On,si,li,vi,br.data):ht.texSubImage3D(Vi,Et,pt.x,pt.y,pt.z,On,si,li,vi,Bi,br),ht.pixelStorei(ht.UNPACK_ROW_LENGTH,$i),ht.pixelStorei(ht.UNPACK_IMAGE_HEIGHT,Cs),ht.pixelStorei(ht.UNPACK_SKIP_PIXELS,co),ht.pixelStorei(ht.UNPACK_SKIP_ROWS,ra),ht.pixelStorei(ht.UNPACK_SKIP_IMAGES,Fc),Et===0&&_t.generateMipmaps&&ht.generateMipmap(Vi),hn.unbindTexture()},this.initTexture=function(ke){ke.isCubeTexture?Vn.setTextureCube(ke,0):ke.isData3DTexture?Vn.setTexture3D(ke,0):ke.isDataArrayTexture||ke.isCompressedArrayTexture?Vn.setTexture2DArray(ke,0):Vn.setTexture2D(ke,0),hn.unbindTexture()},this.resetState=function(){Ve=0,ze=0,Ke=null,hn.reset(),Oi.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ma}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(n){this._outputColorSpace=n;const s=this.getContext();s.drawingBufferColorSpace=n===yh?"display-p3":"srgb",s.unpackColorSpace=gr.workingColorSpace===cu?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(n){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=n}}class I0{constructor(n,s=25e-5){this.isFogExp2=!0,this.name="",this.color=new Qn(n),this.density=s}clone(){return new I0(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class B0{constructor(n,s=1,l=1e3){this.isFog=!0,this.name="",this.color=new Qn(n),this.near=s,this.far=l}clone(){return new B0(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class zC extends hr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ta,this.environmentIntensity=1,this.environmentRotation=new ta,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(n,s){return super.copy(n,s),n.background!==null&&(this.background=n.background.clone()),n.environment!==null&&(this.environment=n.environment.clone()),n.fog!==null&&(this.fog=n.fog.clone()),this.backgroundBlurriness=n.backgroundBlurriness,this.backgroundIntensity=n.backgroundIntensity,this.backgroundRotation.copy(n.backgroundRotation),this.environmentIntensity=n.environmentIntensity,this.environmentRotation.copy(n.environmentRotation),n.overrideMaterial!==null&&(this.overrideMaterial=n.overrideMaterial.clone()),this.matrixAutoUpdate=n.matrixAutoUpdate,this}toJSON(n){const s=super.toJSON(n);return this.fog!==null&&(s.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(s.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(s.object.backgroundIntensity=this.backgroundIntensity),s.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(s.object.environmentIntensity=this.environmentIntensity),s.object.environmentRotation=this.environmentRotation.toArray(),s}}class R0{constructor(n,s){this.isInterleavedBuffer=!0,this.array=n,this.stride=s,this.count=n!==void 0?n.length/s:0,this.usage=du,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=bo()}onUploadCallback(){}set needsUpdate(n){n===!0&&this.version++}get updateRange(){return r0("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(n){return this.usage=n,this}addUpdateRange(n,s){this.updateRanges.push({start:n,count:s})}clearUpdateRanges(){this.updateRanges.length=0}copy(n){return this.array=new n.array.constructor(n.array),this.count=n.count,this.stride=n.stride,this.usage=n.usage,this}copyAt(n,s,l){n*=this.stride,l*=s.stride;for(let d=0,b=this.stride;d<b;d++)this.array[n+d]=s.array[l+d];return this}set(n,s=0){return this.array.set(n,s),this}clone(n){n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=bo()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const s=new this.array.constructor(n.arrayBuffers[this.array.buffer._uuid]),l=new this.constructor(s,this.stride);return l.setUsage(this.usage),l}onUpload(n){return this.onUploadCallback=n,this}toJSON(n){return n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=bo()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Eo=new Ge;class xu{constructor(n,s,l,d=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=n,this.itemSize=s,this.offset=l,this.normalized=d}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(n){this.data.needsUpdate=n}applyMatrix4(n){for(let s=0,l=this.data.count;s<l;s++)Eo.fromBufferAttribute(this,s),Eo.applyMatrix4(n),this.setXYZ(s,Eo.x,Eo.y,Eo.z);return this}applyNormalMatrix(n){for(let s=0,l=this.count;s<l;s++)Eo.fromBufferAttribute(this,s),Eo.applyNormalMatrix(n),this.setXYZ(s,Eo.x,Eo.y,Eo.z);return this}transformDirection(n){for(let s=0,l=this.count;s<l;s++)Eo.fromBufferAttribute(this,s),Eo.transformDirection(n),this.setXYZ(s,Eo.x,Eo.y,Eo.z);return this}getComponent(n,s){let l=this.array[n*this.data.stride+this.offset+s];return this.normalized&&(l=eo(l,this.array)),l}setComponent(n,s,l){return this.normalized&&(l=Ci(l,this.array)),this.data.array[n*this.data.stride+this.offset+s]=l,this}setX(n,s){return this.normalized&&(s=Ci(s,this.array)),this.data.array[n*this.data.stride+this.offset]=s,this}setY(n,s){return this.normalized&&(s=Ci(s,this.array)),this.data.array[n*this.data.stride+this.offset+1]=s,this}setZ(n,s){return this.normalized&&(s=Ci(s,this.array)),this.data.array[n*this.data.stride+this.offset+2]=s,this}setW(n,s){return this.normalized&&(s=Ci(s,this.array)),this.data.array[n*this.data.stride+this.offset+3]=s,this}getX(n){let s=this.data.array[n*this.data.stride+this.offset];return this.normalized&&(s=eo(s,this.array)),s}getY(n){let s=this.data.array[n*this.data.stride+this.offset+1];return this.normalized&&(s=eo(s,this.array)),s}getZ(n){let s=this.data.array[n*this.data.stride+this.offset+2];return this.normalized&&(s=eo(s,this.array)),s}getW(n){let s=this.data.array[n*this.data.stride+this.offset+3];return this.normalized&&(s=eo(s,this.array)),s}setXY(n,s,l){return n=n*this.data.stride+this.offset,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array)),this.data.array[n+0]=s,this.data.array[n+1]=l,this}setXYZ(n,s,l,d){return n=n*this.data.stride+this.offset,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array),d=Ci(d,this.array)),this.data.array[n+0]=s,this.data.array[n+1]=l,this.data.array[n+2]=d,this}setXYZW(n,s,l,d,b){return n=n*this.data.stride+this.offset,this.normalized&&(s=Ci(s,this.array),l=Ci(l,this.array),d=Ci(d,this.array),b=Ci(b,this.array)),this.data.array[n+0]=s,this.data.array[n+1]=l,this.data.array[n+2]=d,this.data.array[n+3]=b,this}clone(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const s=[];for(let l=0;l<this.count;l++){const d=l*this.data.stride+this.offset;for(let b=0;b<this.itemSize;b++)s.push(this.data.array[d+b])}return new Tr(new this.array.constructor(s),this.itemSize,this.normalized)}else return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.clone(n)),new xu(n.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const s=[];for(let l=0;l<this.count;l++){const d=l*this.data.stride+this.offset;for(let b=0;b<this.itemSize;b++)s.push(this.data.array[d+b])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:s,normalized:this.normalized}}else return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.toJSON(n)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Eb extends ao{constructor(n){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Qn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.rotation=n.rotation,this.sizeAttenuation=n.sizeAttenuation,this.fog=n.fog,this}}let zh;const Cd=new Ge,jh=new Ge,Wh=new Ge,$h=new Jt,xd=new Jt,jC=new Kn,L0=new Ge,Md=new Ge,P0=new Ge,WC=new Jt,wb=new Jt,$C=new Jt;class XC extends hr{constructor(n=new Eb){if(super(),this.isSprite=!0,this.type="Sprite",zh===void 0){zh=new Ui;const s=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),l=new R0(s,5);zh.setIndex([0,1,2,0,2,3]),zh.setAttribute("position",new xu(l,3,0,!1)),zh.setAttribute("uv",new xu(l,2,3,!1))}this.geometry=zh,this.material=n,this.center=new Jt(.5,.5)}raycast(n,s){n.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),jh.setFromMatrixScale(this.matrixWorld),jC.copy(n.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(n.camera.matrixWorldInverse,this.matrixWorld),Wh.setFromMatrixPosition(this.modelViewMatrix),n.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&jh.multiplyScalar(-Wh.z);const l=this.material.rotation;let d,b;l!==0&&(b=Math.cos(l),d=Math.sin(l));const T=this.center;D0(L0.set(-.5,-.5,0),Wh,T,jh,d,b),D0(Md.set(.5,-.5,0),Wh,T,jh,d,b),D0(P0.set(.5,.5,0),Wh,T,jh,d,b),WC.set(0,0),wb.set(1,0),$C.set(1,1);let B=n.ray.intersectTriangle(L0,Md,P0,!1,Cd);if(B===null&&(D0(Md.set(-.5,.5,0),Wh,T,jh,d,b),wb.set(0,1),B=n.ray.intersectTriangle(L0,P0,Md,!1,Cd),B===null))return;const N=n.ray.origin.distanceTo(Cd);N<n.near||N>n.far||s.push({distance:N,point:Cd.clone(),uv:na.getInterpolation(Cd,L0,Md,P0,WC,wb,$C,new Jt),face:null,object:this})}copy(n,s){return super.copy(n,s),n.center!==void 0&&this.center.copy(n.center),this.material=n.material,this}}function D0(_,n,s,l,d,b){$h.subVectors(_,s).addScalar(.5).multiply(l),d!==void 0?(xd.x=b*$h.x-d*$h.y,xd.y=d*$h.x+b*$h.y):xd.copy($h),_.copy(n),_.x+=xd.x,_.y+=xd.y,_.applyMatrix4(jC)}const N0=new Ge,KC=new Ge;class YC extends hr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(n){super.copy(n,!1);const s=n.levels;for(let l=0,d=s.length;l<d;l++){const b=s[l];this.addLevel(b.object.clone(),b.distance,b.hysteresis)}return this.autoUpdate=n.autoUpdate,this}addLevel(n,s=0,l=0){s=Math.abs(s);const d=this.levels;let b;for(b=0;b<d.length&&!(s<d[b].distance);b++);return d.splice(b,0,{distance:s,hysteresis:l,object:n}),this.add(n),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(n){const s=this.levels;if(s.length>0){let l,d;for(l=1,d=s.length;l<d;l++){let b=s[l].distance;if(s[l].object.visible&&(b-=b*s[l].hysteresis),n<b)break}return s[l-1].object}return null}raycast(n,s){if(this.levels.length>0){N0.setFromMatrixPosition(this.matrixWorld);const d=n.ray.origin.distanceTo(N0);this.getObjectForDistance(d).raycast(n,s)}}update(n){const s=this.levels;if(s.length>1){N0.setFromMatrixPosition(n.matrixWorld),KC.setFromMatrixPosition(this.matrixWorld);const l=N0.distanceTo(KC)/n.zoom;s[0].object.visible=!0;let d,b;for(d=1,b=s.length;d<b;d++){let T=s[d].distance;if(s[d].object.visible&&(T-=T*s[d].hysteresis),l>=T)s[d-1].object.visible=!1,s[d].object.visible=!0;else break}for(this._currentLevel=d-1;d<b;d++)s[d].object.visible=!1}}toJSON(n){const s=super.toJSON(n);this.autoUpdate===!1&&(s.object.autoUpdate=!1),s.object.levels=[];const l=this.levels;for(let d=0,b=l.length;d<b;d++){const T=l[d];s.object.levels.push({object:T.object.uuid,distance:T.distance,hysteresis:T.hysteresis})}return s}}const qC=new Ge,JC=new ar,ZC=new ar,PF=new Ge,e3=new Kn,O0=new Ge,Cb=new Ts,t3=new Kn,xb=new Is;class n3 extends ws{constructor(n,s){super(n,s),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Re,this.bindMatrix=new Kn,this.bindMatrixInverse=new Kn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const n=this.geometry;this.boundingBox===null&&(this.boundingBox=new ns),this.boundingBox.makeEmpty();const s=n.getAttribute("position");for(let l=0;l<s.count;l++)this.getVertexPosition(l,O0),this.boundingBox.expandByPoint(O0)}computeBoundingSphere(){const n=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ts),this.boundingSphere.makeEmpty();const s=n.getAttribute("position");for(let l=0;l<s.count;l++)this.getVertexPosition(l,O0),this.boundingSphere.expandByPoint(O0)}copy(n,s){return super.copy(n,s),this.bindMode=n.bindMode,this.bindMatrix.copy(n.bindMatrix),this.bindMatrixInverse.copy(n.bindMatrixInverse),this.skeleton=n.skeleton,n.boundingBox!==null&&(this.boundingBox=n.boundingBox.clone()),n.boundingSphere!==null&&(this.boundingSphere=n.boundingSphere.clone()),this}raycast(n,s){const l=this.material,d=this.matrixWorld;l!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Cb.copy(this.boundingSphere),Cb.applyMatrix4(d),n.ray.intersectsSphere(Cb)!==!1&&(t3.copy(d).invert(),xb.copy(n.ray).applyMatrix4(t3),!(this.boundingBox!==null&&xb.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(n,s,xb)))}getVertexPosition(n,s){return super.getVertexPosition(n,s),this.applyBoneTransform(n,s),s}bind(n,s){this.skeleton=n,s===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),s=this.matrixWorld),this.bindMatrix.copy(s),this.bindMatrixInverse.copy(s).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const n=new ar,s=this.geometry.attributes.skinWeight;for(let l=0,d=s.count;l<d;l++){n.fromBufferAttribute(s,l);const b=1/n.manhattanLength();b!==1/0?n.multiplyScalar(b):n.set(1,0,0,0),s.setXYZW(l,n.x,n.y,n.z,n.w)}}updateMatrixWorld(n){super.updateMatrixWorld(n),this.bindMode===Re?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Ce?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(n,s){const l=this.skeleton,d=this.geometry;JC.fromBufferAttribute(d.attributes.skinIndex,n),ZC.fromBufferAttribute(d.attributes.skinWeight,n),qC.copy(s).applyMatrix4(this.bindMatrix),s.set(0,0,0);for(let b=0;b<4;b++){const T=ZC.getComponent(b);if(T!==0){const B=JC.getComponent(b);e3.multiplyMatrices(l.bones[B].matrixWorld,l.boneInverses[B]),s.addScaledVector(PF.copy(qC).applyMatrix4(e3),T)}}return s.applyMatrix4(this.bindMatrixInverse)}}class Mb extends hr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Rc extends kr{constructor(n=null,s=1,l=1,d,b,T,B,N,U=rn,z=rn,X,q){super(null,T,B,N,U,z,d,b,X,q),this.isDataTexture=!0,this.image={data:n,width:s,height:l},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const i3=new Kn,DF=new Kn;class F0{constructor(n=[],s=[]){this.uuid=bo(),this.bones=n.slice(0),this.boneInverses=s,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const n=this.bones,s=this.boneInverses;if(this.boneMatrices=new Float32Array(n.length*16),s.length===0)this.calculateInverses();else if(n.length!==s.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let l=0,d=this.bones.length;l<d;l++)this.boneInverses.push(new Kn)}}calculateInverses(){this.boneInverses.length=0;for(let n=0,s=this.bones.length;n<s;n++){const l=new Kn;this.bones[n]&&l.copy(this.bones[n].matrixWorld).invert(),this.boneInverses.push(l)}}pose(){for(let n=0,s=this.bones.length;n<s;n++){const l=this.bones[n];l&&l.matrixWorld.copy(this.boneInverses[n]).invert()}for(let n=0,s=this.bones.length;n<s;n++){const l=this.bones[n];l&&(l.parent&&l.parent.isBone?(l.matrix.copy(l.parent.matrixWorld).invert(),l.matrix.multiply(l.matrixWorld)):l.matrix.copy(l.matrixWorld),l.matrix.decompose(l.position,l.quaternion,l.scale))}}update(){const n=this.bones,s=this.boneInverses,l=this.boneMatrices,d=this.boneTexture;for(let b=0,T=n.length;b<T;b++){const B=n[b]?n[b].matrixWorld:DF;i3.multiplyMatrices(B,s[b]),i3.toArray(l,b*16)}d!==null&&(d.needsUpdate=!0)}clone(){return new F0(this.bones,this.boneInverses)}computeBoneTexture(){let n=Math.sqrt(this.bones.length*4);n=Math.ceil(n/4)*4,n=Math.max(n,4);const s=new Float32Array(n*n*4);s.set(this.boneMatrices);const l=new Rc(s,n,n,We,zr);return l.needsUpdate=!0,this.boneMatrices=s,this.boneTexture=l,this}getBoneByName(n){for(let s=0,l=this.bones.length;s<l;s++){const d=this.bones[s];if(d.name===n)return d}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(n,s){this.uuid=n.uuid;for(let l=0,d=n.bones.length;l<d;l++){const b=n.bones[l];let T=s[b];T===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",b),T=new Mb),this.bones.push(T),this.boneInverses.push(new Kn().fromArray(n.boneInverses[l]))}return this.init(),this}toJSON(){const n={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};n.uuid=this.uuid;const s=this.bones,l=this.boneInverses;for(let d=0,b=s.length;d<b;d++){const T=s[d];n.bones.push(T.uuid);const B=l[d];n.boneInverses.push(B.toArray())}return n}}class Xh extends Tr{constructor(n,s,l,d=1){super(n,s,l),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=d}copy(n){return super.copy(n),this.meshPerAttribute=n.meshPerAttribute,this}toJSON(){const n=super.toJSON();return n.meshPerAttribute=this.meshPerAttribute,n.isInstancedBufferAttribute=!0,n}}const Kh=new Kn,r3=new Kn,k0=[],s3=new ns,NF=new Kn,Sd=new ws,Td=new Ts;class o3 extends ws{constructor(n,s,l){super(n,s),this.isInstancedMesh=!0,this.instanceMatrix=new Xh(new Float32Array(l*16),16),this.instanceColor=null,this.morphTexture=null,this.count=l,this.boundingBox=null,this.boundingSphere=null;for(let d=0;d<l;d++)this.setMatrixAt(d,NF)}computeBoundingBox(){const n=this.geometry,s=this.count;this.boundingBox===null&&(this.boundingBox=new ns),n.boundingBox===null&&n.computeBoundingBox(),this.boundingBox.makeEmpty();for(let l=0;l<s;l++)this.getMatrixAt(l,Kh),s3.copy(n.boundingBox).applyMatrix4(Kh),this.boundingBox.union(s3)}computeBoundingSphere(){const n=this.geometry,s=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ts),n.boundingSphere===null&&n.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let l=0;l<s;l++)this.getMatrixAt(l,Kh),Td.copy(n.boundingSphere).applyMatrix4(Kh),this.boundingSphere.union(Td)}copy(n,s){return super.copy(n,s),this.instanceMatrix.copy(n.instanceMatrix),n.morphTexture!==null&&(this.morphTexture=n.morphTexture.clone()),n.instanceColor!==null&&(this.instanceColor=n.instanceColor.clone()),this.count=n.count,n.boundingBox!==null&&(this.boundingBox=n.boundingBox.clone()),n.boundingSphere!==null&&(this.boundingSphere=n.boundingSphere.clone()),this}getColorAt(n,s){s.fromArray(this.instanceColor.array,n*3)}getMatrixAt(n,s){s.fromArray(this.instanceMatrix.array,n*16)}getMorphAt(n,s){const l=s.morphTargetInfluences,d=this.morphTexture.source.data.data,b=l.length+1,T=n*b+1;for(let B=0;B<l.length;B++)l[B]=d[T+B]}raycast(n,s){const l=this.matrixWorld,d=this.count;if(Sd.geometry=this.geometry,Sd.material=this.material,Sd.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Td.copy(this.boundingSphere),Td.applyMatrix4(l),n.ray.intersectsSphere(Td)!==!1))for(let b=0;b<d;b++){this.getMatrixAt(b,Kh),r3.multiplyMatrices(l,Kh),Sd.matrixWorld=r3,Sd.raycast(n,k0);for(let T=0,B=k0.length;T<B;T++){const N=k0[T];N.instanceId=b,N.object=this,s.push(N)}k0.length=0}}setColorAt(n,s){this.instanceColor===null&&(this.instanceColor=new Xh(new Float32Array(this.instanceMatrix.count*3),3)),s.toArray(this.instanceColor.array,n*3)}setMatrixAt(n,s){s.toArray(this.instanceMatrix.array,n*16)}setMorphAt(n,s){const l=s.morphTargetInfluences,d=l.length+1;this.morphTexture===null&&(this.morphTexture=new Rc(new Float32Array(d*this.count),d,this.count,an,zr));const b=this.morphTexture.source.data.data;let T=0;for(let U=0;U<l.length;U++)T+=l[U];const B=this.geometry.morphTargetsRelative?1:1-T,N=d*n;b[N]=B,b.set(l,N+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function OF(_,n){return _.z-n.z}function FF(_,n){return n.z-_.z}class kF{constructor(){this.index=0,this.pool=[],this.list=[]}push(n,s){const l=this.pool,d=this.list;this.index>=l.length&&l.push({start:-1,count:-1,z:-1});const b=l[this.index];d.push(b),this.index++,b.start=n.start,b.count=n.count,b.z=s}reset(){this.list.length=0,this.index=0}}const Yh="batchId",Lc=new Kn,a3=new Kn,UF=new Kn,l3=new Kn,Sb=new Ed,U0=new ns,Mu=new Ts,Id=new Ge,Tb=new kF,lo=new ws,G0=[];function GF(_,n,s=0){const l=n.itemSize;if(_.isInterleavedBufferAttribute||_.array.constructor!==n.array.constructor){const d=_.count;for(let b=0;b<d;b++)for(let T=0;T<l;T++)n.setComponent(b+s,T,_.getComponent(b,T))}else n.array.set(_.array,s*l);n.needsUpdate=!0}class c3 extends ws{get maxGeometryCount(){return this._maxGeometryCount}constructor(n,s,l=s*2,d){super(new Ui,d),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=n,this._maxVertexCount=s,this._maxIndexCount=l,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(n),this._multiDrawStarts=new Int32Array(n),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let n=Math.sqrt(this._maxGeometryCount*4);n=Math.ceil(n/4)*4,n=Math.max(n,4);const s=new Float32Array(n*n*4),l=new Rc(s,n,n,We,zr);this._matricesTexture=l}_initializeGeometry(n){const s=this.geometry,l=this._maxVertexCount,d=this._maxGeometryCount,b=this._maxIndexCount;if(this._geometryInitialized===!1){for(const B in n.attributes){const N=n.getAttribute(B),{array:U,itemSize:z,normalized:X}=N,q=new U.constructor(l*z),ee=new Tr(q,z,X);s.setAttribute(B,ee)}if(n.getIndex()!==null){const B=l>65536?new Uint32Array(b):new Uint16Array(b);s.setIndex(new Tr(B,1))}const T=d>65536?new Uint32Array(l):new Uint16Array(l);s.setAttribute(Yh,new Tr(T,1)),this._geometryInitialized=!0}}_validateGeometry(n){if(n.getAttribute(Yh))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Yh}"`);const s=this.geometry;if(!!n.getIndex()!=!!s.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const l in s.attributes){if(l===Yh)continue;if(!n.hasAttribute(l))throw new Error(`BatchedMesh: Added geometry missing "${l}". All geometries must have consistent attributes.`);const d=n.getAttribute(l),b=s.getAttribute(l);if(d.itemSize!==b.itemSize||d.normalized!==b.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(n){return this.customSort=n,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ns);const n=this._geometryCount,s=this.boundingBox,l=this._active;s.makeEmpty();for(let d=0;d<n;d++)l[d]!==!1&&(this.getMatrixAt(d,Lc),this.getBoundingBoxAt(d,U0).applyMatrix4(Lc),s.union(U0))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ts);const n=this._geometryCount,s=this.boundingSphere,l=this._active;s.makeEmpty();for(let d=0;d<n;d++)l[d]!==!1&&(this.getMatrixAt(d,Lc),this.getBoundingSphereAt(d,Mu).applyMatrix4(Lc),s.union(Mu))}addGeometry(n,s=-1,l=-1){if(this._initializeGeometry(n),this._validateGeometry(n),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const d={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let b=null;const T=this._reservedRanges,B=this._drawRanges,N=this._bounds;this._geometryCount!==0&&(b=T[T.length-1]),s===-1?d.vertexCount=n.getAttribute("position").count:d.vertexCount=s,b===null?d.vertexStart=0:d.vertexStart=b.vertexStart+b.vertexCount;const U=n.getIndex(),z=U!==null;if(z&&(l===-1?d.indexCount=U.count:d.indexCount=l,b===null?d.indexStart=0:d.indexStart=b.indexStart+b.indexCount),d.indexStart!==-1&&d.indexStart+d.indexCount>this._maxIndexCount||d.vertexStart+d.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const X=this._visibility,q=this._active,ee=this._matricesTexture,ie=this._matricesTexture.image.data;X.push(!0),q.push(!0);const ce=this._geometryCount;this._geometryCount++,UF.toArray(ie,ce*16),ee.needsUpdate=!0,T.push(d),B.push({start:z?d.indexStart:d.vertexStart,count:-1}),N.push({boxInitialized:!1,box:new ns,sphereInitialized:!1,sphere:new Ts});const re=this.geometry.getAttribute(Yh);for(let te=0;te<d.vertexCount;te++)re.setX(d.vertexStart+te,ce);return re.needsUpdate=!0,this.setGeometryAt(ce,n),ce}setGeometryAt(n,s){if(n>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(s);const l=this.geometry,d=l.getIndex()!==null,b=l.getIndex(),T=s.getIndex(),B=this._reservedRanges[n];if(d&&T.count>B.indexCount||s.attributes.position.count>B.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const N=B.vertexStart,U=B.vertexCount;for(const ee in l.attributes){if(ee===Yh)continue;const ie=s.getAttribute(ee),ce=l.getAttribute(ee);GF(ie,ce,N);const re=ie.itemSize;for(let te=ie.count,we=U;te<we;te++){const ve=N+te;for(let Ae=0;Ae<re;Ae++)ce.setComponent(ve,Ae,0)}ce.needsUpdate=!0,ce.addUpdateRange(N*re,U*re)}if(d){const ee=B.indexStart;for(let ie=0;ie<T.count;ie++)b.setX(ee+ie,N+T.getX(ie));for(let ie=T.count,ce=B.indexCount;ie<ce;ie++)b.setX(ee+ie,N);b.needsUpdate=!0,b.addUpdateRange(ee,B.indexCount)}const z=this._bounds[n];s.boundingBox!==null?(z.box.copy(s.boundingBox),z.boxInitialized=!0):z.boxInitialized=!1,s.boundingSphere!==null?(z.sphere.copy(s.boundingSphere),z.sphereInitialized=!0):z.sphereInitialized=!1;const X=this._drawRanges[n],q=s.getAttribute("position");return X.count=d?T.count:q.count,this._visibilityChanged=!0,n}deleteGeometry(n){const s=this._active;return n>=s.length||s[n]===!1?this:(s[n]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(n){return this._multiDrawInstances===null?null:this._multiDrawInstances[n]}setInstanceCountAt(n,s){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[n]=s,n}getBoundingBoxAt(n,s){if(this._active[n]===!1)return null;const d=this._bounds[n],b=d.box,T=this.geometry;if(d.boxInitialized===!1){b.makeEmpty();const B=T.index,N=T.attributes.position,U=this._drawRanges[n];for(let z=U.start,X=U.start+U.count;z<X;z++){let q=z;B&&(q=B.getX(q)),b.expandByPoint(Id.fromBufferAttribute(N,q))}d.boxInitialized=!0}return s.copy(b),s}getBoundingSphereAt(n,s){if(this._active[n]===!1)return null;const d=this._bounds[n],b=d.sphere,T=this.geometry;if(d.sphereInitialized===!1){b.makeEmpty(),this.getBoundingBoxAt(n,U0),U0.getCenter(b.center);const B=T.index,N=T.attributes.position,U=this._drawRanges[n];let z=0;for(let X=U.start,q=U.start+U.count;X<q;X++){let ee=X;B&&(ee=B.getX(ee)),Id.fromBufferAttribute(N,ee),z=Math.max(z,b.center.distanceToSquared(Id))}b.radius=Math.sqrt(z),d.sphereInitialized=!0}return s.copy(b),s}setMatrixAt(n,s){const l=this._active,d=this._matricesTexture,b=this._matricesTexture.image.data,T=this._geometryCount;return n>=T||l[n]===!1?this:(s.toArray(b,n*16),d.needsUpdate=!0,this)}getMatrixAt(n,s){const l=this._active,d=this._matricesTexture.image.data,b=this._geometryCount;return n>=b||l[n]===!1?null:s.fromArray(d,n*16)}setVisibleAt(n,s){const l=this._visibility,d=this._active,b=this._geometryCount;return n>=b||d[n]===!1||l[n]===s?this:(l[n]=s,this._visibilityChanged=!0,this)}getVisibleAt(n){const s=this._visibility,l=this._active,d=this._geometryCount;return n>=d||l[n]===!1?!1:s[n]}raycast(n,s){const l=this._visibility,d=this._active,b=this._drawRanges,T=this._geometryCount,B=this.matrixWorld,N=this.geometry;lo.material=this.material,lo.geometry.index=N.index,lo.geometry.attributes=N.attributes,lo.geometry.boundingBox===null&&(lo.geometry.boundingBox=new ns),lo.geometry.boundingSphere===null&&(lo.geometry.boundingSphere=new Ts);for(let U=0;U<T;U++){if(!l[U]||!d[U])continue;const z=b[U];lo.geometry.setDrawRange(z.start,z.count),this.getMatrixAt(U,lo.matrixWorld).premultiply(B),this.getBoundingBoxAt(U,lo.geometry.boundingBox),this.getBoundingSphereAt(U,lo.geometry.boundingSphere),lo.raycast(n,G0);for(let X=0,q=G0.length;X<q;X++){const ee=G0[X];ee.object=this,ee.batchId=U,s.push(ee)}G0.length=0}lo.material=null,lo.geometry.index=null,lo.geometry.attributes={},lo.geometry.setDrawRange(0,1/0)}copy(n){return super.copy(n),this.geometry=n.geometry.clone(),this.perObjectFrustumCulled=n.perObjectFrustumCulled,this.sortObjects=n.sortObjects,this.boundingBox=n.boundingBox!==null?n.boundingBox.clone():null,this.boundingSphere=n.boundingSphere!==null?n.boundingSphere.clone():null,this._drawRanges=n._drawRanges.map(s=>({...s})),this._reservedRanges=n._reservedRanges.map(s=>({...s})),this._visibility=n._visibility.slice(),this._active=n._active.slice(),this._bounds=n._bounds.map(s=>({boxInitialized:s.boxInitialized,box:s.box.clone(),sphereInitialized:s.sphereInitialized,sphere:s.sphere.clone()})),this._maxGeometryCount=n._maxGeometryCount,this._maxVertexCount=n._maxVertexCount,this._maxIndexCount=n._maxIndexCount,this._geometryInitialized=n._geometryInitialized,this._geometryCount=n._geometryCount,this._multiDrawCounts=n._multiDrawCounts.slice(),this._multiDrawStarts=n._multiDrawStarts.slice(),this._matricesTexture=n._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(n,s,l,d,b){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const T=d.getIndex(),B=T===null?1:T.array.BYTES_PER_ELEMENT,N=this._active,U=this._visibility,z=this._multiDrawStarts,X=this._multiDrawCounts,q=this._drawRanges,ee=this.perObjectFrustumCulled;ee&&(l3.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse).multiply(this.matrixWorld),Sb.setFromProjectionMatrix(l3,n.coordinateSystem));let ie=0;if(this.sortObjects){a3.copy(this.matrixWorld).invert(),Id.setFromMatrixPosition(l.matrixWorld).applyMatrix4(a3);for(let te=0,we=U.length;te<we;te++)if(U[te]&&N[te]){this.getMatrixAt(te,Lc),this.getBoundingSphereAt(te,Mu).applyMatrix4(Lc);let ve=!1;if(ee&&(ve=!Sb.intersectsSphere(Mu)),!ve){const Ae=Id.distanceTo(Mu.center);Tb.push(q[te],Ae)}}const ce=Tb.list,re=this.customSort;re===null?ce.sort(b.transparent?FF:OF):re.call(this,ce,l);for(let te=0,we=ce.length;te<we;te++){const ve=ce[te];z[ie]=ve.start*B,X[ie]=ve.count,ie++}Tb.reset()}else for(let ce=0,re=U.length;ce<re;ce++)if(U[ce]&&N[ce]){let te=!1;if(ee&&(this.getMatrixAt(ce,Lc),this.getBoundingSphereAt(ce,Mu).applyMatrix4(Lc),te=!Sb.intersectsSphere(Mu)),!te){const we=q[ce];z[ie]=we.start*B,X[ie]=we.count,ie++}}this._multiDrawCount=ie,this._visibilityChanged=!1}onBeforeShadow(n,s,l,d,b,T){this.onBeforeRender(n,null,d,b,T)}}class wo extends ao{constructor(n){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Qn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.linewidth=n.linewidth,this.linecap=n.linecap,this.linejoin=n.linejoin,this.fog=n.fog,this}}const V0=new Ge,Q0=new Ge,u3=new Kn,Bd=new Is,H0=new Ts,Ib=new Ge,h3=new Ge;class Pc extends hr{constructor(n=new Ui,s=new wo){super(),this.isLine=!0,this.type="Line",this.geometry=n,this.material=s,this.updateMorphTargets()}copy(n,s){return super.copy(n,s),this.material=Array.isArray(n.material)?n.material.slice():n.material,this.geometry=n.geometry,this}computeLineDistances(){const n=this.geometry;if(n.index===null){const s=n.attributes.position,l=[0];for(let d=1,b=s.count;d<b;d++)V0.fromBufferAttribute(s,d-1),Q0.fromBufferAttribute(s,d),l[d]=l[d-1],l[d]+=V0.distanceTo(Q0);n.setAttribute("lineDistance",new ei(l,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(n,s){const l=this.geometry,d=this.matrixWorld,b=n.params.Line.threshold,T=l.drawRange;if(l.boundingSphere===null&&l.computeBoundingSphere(),H0.copy(l.boundingSphere),H0.applyMatrix4(d),H0.radius+=b,n.ray.intersectsSphere(H0)===!1)return;u3.copy(d).invert(),Bd.copy(n.ray).applyMatrix4(u3);const B=b/((this.scale.x+this.scale.y+this.scale.z)/3),N=B*B,U=this.isLineSegments?2:1,z=l.index,q=l.attributes.position;if(z!==null){const ee=Math.max(0,T.start),ie=Math.min(z.count,T.start+T.count);for(let ce=ee,re=ie-1;ce<re;ce+=U){const te=z.getX(ce),we=z.getX(ce+1),ve=z0(this,n,Bd,N,te,we);ve&&s.push(ve)}if(this.isLineLoop){const ce=z.getX(ie-1),re=z.getX(ee),te=z0(this,n,Bd,N,ce,re);te&&s.push(te)}}else{const ee=Math.max(0,T.start),ie=Math.min(q.count,T.start+T.count);for(let ce=ee,re=ie-1;ce<re;ce+=U){const te=z0(this,n,Bd,N,ce,ce+1);te&&s.push(te)}if(this.isLineLoop){const ce=z0(this,n,Bd,N,ie-1,ee);ce&&s.push(ce)}}}updateMorphTargets(){const s=this.geometry.morphAttributes,l=Object.keys(s);if(l.length>0){const d=s[l[0]];if(d!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let b=0,T=d.length;b<T;b++){const B=d[b].name||String(b);this.morphTargetInfluences.push(0),this.morphTargetDictionary[B]=b}}}}}function z0(_,n,s,l,d,b){const T=_.geometry.attributes.position;if(V0.fromBufferAttribute(T,d),Q0.fromBufferAttribute(T,b),s.distanceSqToSegment(V0,Q0,Ib,h3)>l)return;Ib.applyMatrix4(_.matrixWorld);const N=n.ray.origin.distanceTo(Ib);if(!(N<n.near||N>n.far))return{distance:N,point:h3.clone().applyMatrix4(_.matrixWorld),index:d,face:null,faceIndex:null,object:_}}const f3=new Ge,d3=new Ge;class ll extends Pc{constructor(n,s){super(n,s),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const n=this.geometry;if(n.index===null){const s=n.attributes.position,l=[];for(let d=0,b=s.count;d<b;d+=2)f3.fromBufferAttribute(s,d),d3.fromBufferAttribute(s,d+1),l[d]=d===0?0:l[d-1],l[d+1]=l[d]+f3.distanceTo(d3);n.setAttribute("lineDistance",new ei(l,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class p3 extends Pc{constructor(n,s){super(n,s),this.isLineLoop=!0,this.type="LineLoop"}}class Bb extends ao{constructor(n){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Qn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.size=n.size,this.sizeAttenuation=n.sizeAttenuation,this.fog=n.fog,this}}const m3=new Kn,Rb=new Is,j0=new Ts,W0=new Ge;class A3 extends hr{constructor(n=new Ui,s=new Bb){super(),this.isPoints=!0,this.type="Points",this.geometry=n,this.material=s,this.updateMorphTargets()}copy(n,s){return super.copy(n,s),this.material=Array.isArray(n.material)?n.material.slice():n.material,this.geometry=n.geometry,this}raycast(n,s){const l=this.geometry,d=this.matrixWorld,b=n.params.Points.threshold,T=l.drawRange;if(l.boundingSphere===null&&l.computeBoundingSphere(),j0.copy(l.boundingSphere),j0.applyMatrix4(d),j0.radius+=b,n.ray.intersectsSphere(j0)===!1)return;m3.copy(d).invert(),Rb.copy(n.ray).applyMatrix4(m3);const B=b/((this.scale.x+this.scale.y+this.scale.z)/3),N=B*B,U=l.index,X=l.attributes.position;if(U!==null){const q=Math.max(0,T.start),ee=Math.min(U.count,T.start+T.count);for(let ie=q,ce=ee;ie<ce;ie++){const re=U.getX(ie);W0.fromBufferAttribute(X,re),g3(W0,re,N,d,n,s,this)}}else{const q=Math.max(0,T.start),ee=Math.min(X.count,T.start+T.count);for(let ie=q,ce=ee;ie<ce;ie++)W0.fromBufferAttribute(X,ie),g3(W0,ie,N,d,n,s,this)}}updateMorphTargets(){const s=this.geometry.morphAttributes,l=Object.keys(s);if(l.length>0){const d=s[l[0]];if(d!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let b=0,T=d.length;b<T;b++){const B=d[b].name||String(b);this.morphTargetInfluences.push(0),this.morphTargetDictionary[B]=b}}}}}function g3(_,n,s,l,d,b,T){const B=Rb.distanceSqToPoint(_);if(B<s){const N=new Ge;Rb.closestPointToPoint(_,N),N.applyMatrix4(l);const U=d.ray.origin.distanceTo(N);if(U<d.near||U>d.far)return;b.push({distance:U,distanceToRay:Math.sqrt(B),point:N,index:n,face:null,object:T})}}class VF extends kr{constructor(n,s,l,d,b,T,B,N,U){super(n,s,l,d,b,T,B,N,U),this.isVideoTexture=!0,this.minFilter=T!==void 0?T:Dn,this.magFilter=b!==void 0?b:Dn,this.generateMipmaps=!1;const z=this;function X(){z.needsUpdate=!0,n.requestVideoFrameCallback(X)}"requestVideoFrameCallback"in n&&n.requestVideoFrameCallback(X)}clone(){return new this.constructor(this.image).copy(this)}update(){const n=this.image;"requestVideoFrameCallback"in n===!1&&n.readyState>=n.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class QF extends kr{constructor(n,s){super({width:n,height:s}),this.isFramebufferTexture=!0,this.magFilter=rn,this.minFilter=rn,this.generateMipmaps=!1,this.needsUpdate=!0}}class $0 extends kr{constructor(n,s,l,d,b,T,B,N,U,z,X,q){super(null,T,B,N,U,z,d,b,X,q),this.isCompressedTexture=!0,this.image={width:s,height:l},this.mipmaps=n,this.flipY=!1,this.generateMipmaps=!1}}class HF extends $0{constructor(n,s,l,d,b,T){super(n,s,l,b,T),this.isCompressedArrayTexture=!0,this.image.depth=d,this.wrapR=He}}class zF extends $0{constructor(n,s,l){super(void 0,n[0].width,n[0].height,s,l,le),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=n}}class jF extends kr{constructor(n,s,l,d,b,T,B,N,U){super(n,s,l,d,b,T,B,N,U),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ua{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(n,s){const l=this.getUtoTmapping(n);return this.getPoint(l,s)}getPoints(n=5){const s=[];for(let l=0;l<=n;l++)s.push(this.getPoint(l/n));return s}getSpacedPoints(n=5){const s=[];for(let l=0;l<=n;l++)s.push(this.getPointAt(l/n));return s}getLength(){const n=this.getLengths();return n[n.length-1]}getLengths(n=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const s=[];let l,d=this.getPoint(0),b=0;s.push(0);for(let T=1;T<=n;T++)l=this.getPoint(T/n),b+=l.distanceTo(d),s.push(b),d=l;return this.cacheArcLengths=s,s}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(n,s){const l=this.getLengths();let d=0;const b=l.length;let T;s?T=s:T=n*l[b-1];let B=0,N=b-1,U;for(;B<=N;)if(d=Math.floor(B+(N-B)/2),U=l[d]-T,U<0)B=d+1;else if(U>0)N=d-1;else{N=d;break}if(d=N,l[d]===T)return d/(b-1);const z=l[d],q=l[d+1]-z,ee=(T-z)/q;return(d+ee)/(b-1)}getTangent(n,s){let d=n-1e-4,b=n+1e-4;d<0&&(d=0),b>1&&(b=1);const T=this.getPoint(d),B=this.getPoint(b),N=s||(T.isVector2?new Jt:new Ge);return N.copy(B).sub(T).normalize(),N}getTangentAt(n,s){const l=this.getUtoTmapping(n);return this.getTangent(l,s)}computeFrenetFrames(n,s){const l=new Ge,d=[],b=[],T=[],B=new Ge,N=new Kn;for(let ee=0;ee<=n;ee++){const ie=ee/n;d[ee]=this.getTangentAt(ie,new Ge)}b[0]=new Ge,T[0]=new Ge;let U=Number.MAX_VALUE;const z=Math.abs(d[0].x),X=Math.abs(d[0].y),q=Math.abs(d[0].z);z<=U&&(U=z,l.set(1,0,0)),X<=U&&(U=X,l.set(0,1,0)),q<=U&&l.set(0,0,1),B.crossVectors(d[0],l).normalize(),b[0].crossVectors(d[0],B),T[0].crossVectors(d[0],b[0]);for(let ee=1;ee<=n;ee++){if(b[ee]=b[ee-1].clone(),T[ee]=T[ee-1].clone(),B.crossVectors(d[ee-1],d[ee]),B.length()>Number.EPSILON){B.normalize();const ie=Math.acos(Kr(d[ee-1].dot(d[ee]),-1,1));b[ee].applyMatrix4(N.makeRotationAxis(B,ie))}T[ee].crossVectors(d[ee],b[ee])}if(s===!0){let ee=Math.acos(Kr(b[0].dot(b[n]),-1,1));ee/=n,d[0].dot(B.crossVectors(b[0],b[n]))>0&&(ee=-ee);for(let ie=1;ie<=n;ie++)b[ie].applyMatrix4(N.makeRotationAxis(d[ie],ee*ie)),T[ie].crossVectors(d[ie],b[ie])}return{tangents:d,normals:b,binormals:T}}clone(){return new this.constructor().copy(this)}copy(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}toJSON(){const n={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return n.arcLengthDivisions=this.arcLengthDivisions,n.type=this.type,n}fromJSON(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}}class X0 extends Ua{constructor(n=0,s=0,l=1,d=1,b=0,T=Math.PI*2,B=!1,N=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=n,this.aY=s,this.xRadius=l,this.yRadius=d,this.aStartAngle=b,this.aEndAngle=T,this.aClockwise=B,this.aRotation=N}getPoint(n,s=new Jt){const l=s,d=Math.PI*2;let b=this.aEndAngle-this.aStartAngle;const T=Math.abs(b)<Number.EPSILON;for(;b<0;)b+=d;for(;b>d;)b-=d;b<Number.EPSILON&&(T?b=0:b=d),this.aClockwise===!0&&!T&&(b===d?b=-d:b=b-d);const B=this.aStartAngle+n*b;let N=this.aX+this.xRadius*Math.cos(B),U=this.aY+this.yRadius*Math.sin(B);if(this.aRotation!==0){const z=Math.cos(this.aRotation),X=Math.sin(this.aRotation),q=N-this.aX,ee=U-this.aY;N=q*z-ee*X+this.aX,U=q*X+ee*z+this.aY}return l.set(N,U)}copy(n){return super.copy(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}toJSON(){const n=super.toJSON();return n.aX=this.aX,n.aY=this.aY,n.xRadius=this.xRadius,n.yRadius=this.yRadius,n.aStartAngle=this.aStartAngle,n.aEndAngle=this.aEndAngle,n.aClockwise=this.aClockwise,n.aRotation=this.aRotation,n}fromJSON(n){return super.fromJSON(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}}class v3 extends X0{constructor(n,s,l,d,b,T){super(n,s,l,l,d,b,T),this.isArcCurve=!0,this.type="ArcCurve"}}function Lb(){let _=0,n=0,s=0,l=0;function d(b,T,B,N){_=b,n=B,s=-3*b+3*T-2*B-N,l=2*b-2*T+B+N}return{initCatmullRom:function(b,T,B,N,U){d(T,B,U*(B-b),U*(N-T))},initNonuniformCatmullRom:function(b,T,B,N,U,z,X){let q=(T-b)/U-(B-b)/(U+z)+(B-T)/z,ee=(B-T)/z-(N-T)/(z+X)+(N-B)/X;q*=z,ee*=z,d(T,B,q,ee)},calc:function(b){const T=b*b,B=T*b;return _+n*b+s*T+l*B}}}const K0=new Ge,Pb=new Lb,Db=new Lb,Nb=new Lb;class b3 extends Ua{constructor(n=[],s=!1,l="centripetal",d=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=n,this.closed=s,this.curveType=l,this.tension=d}getPoint(n,s=new Ge){const l=s,d=this.points,b=d.length,T=(b-(this.closed?0:1))*n;let B=Math.floor(T),N=T-B;this.closed?B+=B>0?0:(Math.floor(Math.abs(B)/b)+1)*b:N===0&&B===b-1&&(B=b-2,N=1);let U,z;this.closed||B>0?U=d[(B-1)%b]:(K0.subVectors(d[0],d[1]).add(d[0]),U=K0);const X=d[B%b],q=d[(B+1)%b];if(this.closed||B+2<b?z=d[(B+2)%b]:(K0.subVectors(d[b-1],d[b-2]).add(d[b-1]),z=K0),this.curveType==="centripetal"||this.curveType==="chordal"){const ee=this.curveType==="chordal"?.5:.25;let ie=Math.pow(U.distanceToSquared(X),ee),ce=Math.pow(X.distanceToSquared(q),ee),re=Math.pow(q.distanceToSquared(z),ee);ce<1e-4&&(ce=1),ie<1e-4&&(ie=ce),re<1e-4&&(re=ce),Pb.initNonuniformCatmullRom(U.x,X.x,q.x,z.x,ie,ce,re),Db.initNonuniformCatmullRom(U.y,X.y,q.y,z.y,ie,ce,re),Nb.initNonuniformCatmullRom(U.z,X.z,q.z,z.z,ie,ce,re)}else this.curveType==="catmullrom"&&(Pb.initCatmullRom(U.x,X.x,q.x,z.x,this.tension),Db.initCatmullRom(U.y,X.y,q.y,z.y,this.tension),Nb.initCatmullRom(U.z,X.z,q.z,z.z,this.tension));return l.set(Pb.calc(N),Db.calc(N),Nb.calc(N)),l}copy(n){super.copy(n),this.points=[];for(let s=0,l=n.points.length;s<l;s++){const d=n.points[s];this.points.push(d.clone())}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}toJSON(){const n=super.toJSON();n.points=[];for(let s=0,l=this.points.length;s<l;s++){const d=this.points[s];n.points.push(d.toArray())}return n.closed=this.closed,n.curveType=this.curveType,n.tension=this.tension,n}fromJSON(n){super.fromJSON(n),this.points=[];for(let s=0,l=n.points.length;s<l;s++){const d=n.points[s];this.points.push(new Ge().fromArray(d))}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}}function y3(_,n,s,l,d){const b=(l-n)*.5,T=(d-s)*.5,B=_*_,N=_*B;return(2*s-2*l+b+T)*N+(-3*s+3*l-2*b-T)*B+b*_+s}function WF(_,n){const s=1-_;return s*s*n}function $F(_,n){return 2*(1-_)*_*n}function XF(_,n){return _*_*n}function Rd(_,n,s,l){return WF(_,n)+$F(_,s)+XF(_,l)}function KF(_,n){const s=1-_;return s*s*s*n}function YF(_,n){const s=1-_;return 3*s*s*_*n}function qF(_,n){return 3*(1-_)*_*_*n}function JF(_,n){return _*_*_*n}function Ld(_,n,s,l,d){return KF(_,n)+YF(_,s)+qF(_,l)+JF(_,d)}class Ob extends Ua{constructor(n=new Jt,s=new Jt,l=new Jt,d=new Jt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=n,this.v1=s,this.v2=l,this.v3=d}getPoint(n,s=new Jt){const l=s,d=this.v0,b=this.v1,T=this.v2,B=this.v3;return l.set(Ld(n,d.x,b.x,T.x,B.x),Ld(n,d.y,b.y,T.y,B.y)),l}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}class _3 extends Ua{constructor(n=new Ge,s=new Ge,l=new Ge,d=new Ge){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=n,this.v1=s,this.v2=l,this.v3=d}getPoint(n,s=new Ge){const l=s,d=this.v0,b=this.v1,T=this.v2,B=this.v3;return l.set(Ld(n,d.x,b.x,T.x,B.x),Ld(n,d.y,b.y,T.y,B.y),Ld(n,d.z,b.z,T.z,B.z)),l}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}class Fb extends Ua{constructor(n=new Jt,s=new Jt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=n,this.v2=s}getPoint(n,s=new Jt){const l=s;return n===1?l.copy(this.v2):(l.copy(this.v2).sub(this.v1),l.multiplyScalar(n).add(this.v1)),l}getPointAt(n,s){return this.getPoint(n,s)}getTangent(n,s=new Jt){return s.subVectors(this.v2,this.v1).normalize()}getTangentAt(n,s){return this.getTangent(n,s)}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class E3 extends Ua{constructor(n=new Ge,s=new Ge){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=n,this.v2=s}getPoint(n,s=new Ge){const l=s;return n===1?l.copy(this.v2):(l.copy(this.v2).sub(this.v1),l.multiplyScalar(n).add(this.v1)),l}getPointAt(n,s){return this.getPoint(n,s)}getTangent(n,s=new Ge){return s.subVectors(this.v2,this.v1).normalize()}getTangentAt(n,s){return this.getTangent(n,s)}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class kb extends Ua{constructor(n=new Jt,s=new Jt,l=new Jt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=n,this.v1=s,this.v2=l}getPoint(n,s=new Jt){const l=s,d=this.v0,b=this.v1,T=this.v2;return l.set(Rd(n,d.x,b.x,T.x),Rd(n,d.y,b.y,T.y)),l}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class Ub extends Ua{constructor(n=new Ge,s=new Ge,l=new Ge){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=n,this.v1=s,this.v2=l}getPoint(n,s=new Ge){const l=s,d=this.v0,b=this.v1,T=this.v2;return l.set(Rd(n,d.x,b.x,T.x),Rd(n,d.y,b.y,T.y),Rd(n,d.z,b.z,T.z)),l}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class Gb extends Ua{constructor(n=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=n}getPoint(n,s=new Jt){const l=s,d=this.points,b=(d.length-1)*n,T=Math.floor(b),B=b-T,N=d[T===0?T:T-1],U=d[T],z=d[T>d.length-2?d.length-1:T+1],X=d[T>d.length-3?d.length-1:T+2];return l.set(y3(B,N.x,U.x,z.x,X.x),y3(B,N.y,U.y,z.y,X.y)),l}copy(n){super.copy(n),this.points=[];for(let s=0,l=n.points.length;s<l;s++){const d=n.points[s];this.points.push(d.clone())}return this}toJSON(){const n=super.toJSON();n.points=[];for(let s=0,l=this.points.length;s<l;s++){const d=this.points[s];n.points.push(d.toArray())}return n}fromJSON(n){super.fromJSON(n),this.points=[];for(let s=0,l=n.points.length;s<l;s++){const d=n.points[s];this.points.push(new Jt().fromArray(d))}return this}}var Y0=Object.freeze({__proto__:null,ArcCurve:v3,CatmullRomCurve3:b3,CubicBezierCurve:Ob,CubicBezierCurve3:_3,EllipseCurve:X0,LineCurve:Fb,LineCurve3:E3,QuadraticBezierCurve:kb,QuadraticBezierCurve3:Ub,SplineCurve:Gb});class w3 extends Ua{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(n){this.curves.push(n)}closePath(){const n=this.curves[0].getPoint(0),s=this.curves[this.curves.length-1].getPoint(1);if(!n.equals(s)){const l=n.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Y0[l](s,n))}return this}getPoint(n,s){const l=n*this.getLength(),d=this.getCurveLengths();let b=0;for(;b<d.length;){if(d[b]>=l){const T=d[b]-l,B=this.curves[b],N=B.getLength(),U=N===0?0:1-T/N;return B.getPointAt(U,s)}b++}return null}getLength(){const n=this.getCurveLengths();return n[n.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const n=[];let s=0;for(let l=0,d=this.curves.length;l<d;l++)s+=this.curves[l].getLength(),n.push(s);return this.cacheLengths=n,n}getSpacedPoints(n=40){const s=[];for(let l=0;l<=n;l++)s.push(this.getPoint(l/n));return this.autoClose&&s.push(s[0]),s}getPoints(n=12){const s=[];let l;for(let d=0,b=this.curves;d<b.length;d++){const T=b[d],B=T.isEllipseCurve?n*2:T.isLineCurve||T.isLineCurve3?1:T.isSplineCurve?n*T.points.length:n,N=T.getPoints(B);for(let U=0;U<N.length;U++){const z=N[U];l&&l.equals(z)||(s.push(z),l=z)}}return this.autoClose&&s.length>1&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s}copy(n){super.copy(n),this.curves=[];for(let s=0,l=n.curves.length;s<l;s++){const d=n.curves[s];this.curves.push(d.clone())}return this.autoClose=n.autoClose,this}toJSON(){const n=super.toJSON();n.autoClose=this.autoClose,n.curves=[];for(let s=0,l=this.curves.length;s<l;s++){const d=this.curves[s];n.curves.push(d.toJSON())}return n}fromJSON(n){super.fromJSON(n),this.autoClose=n.autoClose,this.curves=[];for(let s=0,l=n.curves.length;s<l;s++){const d=n.curves[s];this.curves.push(new Y0[d.type]().fromJSON(d))}return this}}class Pd extends w3{constructor(n){super(),this.type="Path",this.currentPoint=new Jt,n&&this.setFromPoints(n)}setFromPoints(n){this.moveTo(n[0].x,n[0].y);for(let s=1,l=n.length;s<l;s++)this.lineTo(n[s].x,n[s].y);return this}moveTo(n,s){return this.currentPoint.set(n,s),this}lineTo(n,s){const l=new Fb(this.currentPoint.clone(),new Jt(n,s));return this.curves.push(l),this.currentPoint.set(n,s),this}quadraticCurveTo(n,s,l,d){const b=new kb(this.currentPoint.clone(),new Jt(n,s),new Jt(l,d));return this.curves.push(b),this.currentPoint.set(l,d),this}bezierCurveTo(n,s,l,d,b,T){const B=new Ob(this.currentPoint.clone(),new Jt(n,s),new Jt(l,d),new Jt(b,T));return this.curves.push(B),this.currentPoint.set(b,T),this}splineThru(n){const s=[this.currentPoint.clone()].concat(n),l=new Gb(s);return this.curves.push(l),this.currentPoint.copy(n[n.length-1]),this}arc(n,s,l,d,b,T){const B=this.currentPoint.x,N=this.currentPoint.y;return this.absarc(n+B,s+N,l,d,b,T),this}absarc(n,s,l,d,b,T){return this.absellipse(n,s,l,l,d,b,T),this}ellipse(n,s,l,d,b,T,B,N){const U=this.currentPoint.x,z=this.currentPoint.y;return this.absellipse(n+U,s+z,l,d,b,T,B,N),this}absellipse(n,s,l,d,b,T,B,N){const U=new X0(n,s,l,d,b,T,B,N);if(this.curves.length>0){const X=U.getPoint(0);X.equals(this.currentPoint)||this.lineTo(X.x,X.y)}this.curves.push(U);const z=U.getPoint(1);return this.currentPoint.copy(z),this}copy(n){return super.copy(n),this.currentPoint.copy(n.currentPoint),this}toJSON(){const n=super.toJSON();return n.currentPoint=this.currentPoint.toArray(),n}fromJSON(n){return super.fromJSON(n),this.currentPoint.fromArray(n.currentPoint),this}}class Dd extends Ui{constructor(n=[new Jt(0,-.5),new Jt(.5,0),new Jt(0,.5)],s=12,l=0,d=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:n,segments:s,phiStart:l,phiLength:d},s=Math.floor(s),d=Kr(d,0,Math.PI*2);const b=[],T=[],B=[],N=[],U=[],z=1/s,X=new Ge,q=new Jt,ee=new Ge,ie=new Ge,ce=new Ge;let re=0,te=0;for(let we=0;we<=n.length-1;we++)switch(we){case 0:re=n[we+1].x-n[we].x,te=n[we+1].y-n[we].y,ee.x=te*1,ee.y=-re,ee.z=te*0,ce.copy(ee),ee.normalize(),N.push(ee.x,ee.y,ee.z);break;case n.length-1:N.push(ce.x,ce.y,ce.z);break;default:re=n[we+1].x-n[we].x,te=n[we+1].y-n[we].y,ee.x=te*1,ee.y=-re,ee.z=te*0,ie.copy(ee),ee.x+=ce.x,ee.y+=ce.y,ee.z+=ce.z,ee.normalize(),N.push(ee.x,ee.y,ee.z),ce.copy(ie)}for(let we=0;we<=s;we++){const ve=l+we*z*d,Ae=Math.sin(ve),qe=Math.cos(ve);for(let Ve=0;Ve<=n.length-1;Ve++){X.x=n[Ve].x*Ae,X.y=n[Ve].y,X.z=n[Ve].x*qe,T.push(X.x,X.y,X.z),q.x=we/s,q.y=Ve/(n.length-1),B.push(q.x,q.y);const ze=N[3*Ve+0]*Ae,Ke=N[3*Ve+1],De=N[3*Ve+0]*qe;U.push(ze,Ke,De)}}for(let we=0;we<s;we++)for(let ve=0;ve<n.length-1;ve++){const Ae=ve+we*n.length,qe=Ae,Ve=Ae+n.length,ze=Ae+n.length+1,Ke=Ae+1;b.push(qe,Ve,Ke),b.push(ze,Ke,Ve)}this.setIndex(b),this.setAttribute("position",new ei(T,3)),this.setAttribute("uv",new ei(B,2)),this.setAttribute("normal",new ei(U,3))}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new Dd(n.points,n.segments,n.phiStart,n.phiLength)}}class q0 extends Dd{constructor(n=1,s=1,l=4,d=8){const b=new Pd;b.absarc(0,-s/2,n,Math.PI*1.5,0),b.absarc(0,s/2,n,0,Math.PI*.5),super(b.getPoints(l),d),this.type="CapsuleGeometry",this.parameters={radius:n,length:s,capSegments:l,radialSegments:d}}static fromJSON(n){return new q0(n.radius,n.length,n.capSegments,n.radialSegments)}}class J0 extends Ui{constructor(n=1,s=32,l=0,d=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:n,segments:s,thetaStart:l,thetaLength:d},s=Math.max(3,s);const b=[],T=[],B=[],N=[],U=new Ge,z=new Jt;T.push(0,0,0),B.push(0,0,1),N.push(.5,.5);for(let X=0,q=3;X<=s;X++,q+=3){const ee=l+X/s*d;U.x=n*Math.cos(ee),U.y=n*Math.sin(ee),T.push(U.x,U.y,U.z),B.push(0,0,1),z.x=(T[q]/n+1)/2,z.y=(T[q+1]/n+1)/2,N.push(z.x,z.y)}for(let X=1;X<=s;X++)b.push(X,X+1,0);this.setIndex(b),this.setAttribute("position",new ei(T,3)),this.setAttribute("normal",new ei(B,3)),this.setAttribute("uv",new ei(N,2))}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new J0(n.radius,n.segments,n.thetaStart,n.thetaLength)}}class qh extends Ui{constructor(n=1,s=1,l=1,d=32,b=1,T=!1,B=0,N=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:n,radiusBottom:s,height:l,radialSegments:d,heightSegments:b,openEnded:T,thetaStart:B,thetaLength:N};const U=this;d=Math.floor(d),b=Math.floor(b);const z=[],X=[],q=[],ee=[];let ie=0;const ce=[],re=l/2;let te=0;we(),T===!1&&(n>0&&ve(!0),s>0&&ve(!1)),this.setIndex(z),this.setAttribute("position",new ei(X,3)),this.setAttribute("normal",new ei(q,3)),this.setAttribute("uv",new ei(ee,2));function we(){const Ae=new Ge,qe=new Ge;let Ve=0;const ze=(s-n)/l;for(let Ke=0;Ke<=b;Ke++){const De=[],Ie=Ke/b,Ye=Ie*(s-n)+n;for(let at=0;at<=d;at++){const tt=at/d,ut=tt*N+B,wt=Math.sin(ut),Yt=Math.cos(ut);qe.x=Ye*wt,qe.y=-Ie*l+re,qe.z=Ye*Yt,X.push(qe.x,qe.y,qe.z),Ae.set(wt,ze,Yt).normalize(),q.push(Ae.x,Ae.y,Ae.z),ee.push(tt,1-Ie),De.push(ie++)}ce.push(De)}for(let Ke=0;Ke<d;Ke++)for(let De=0;De<b;De++){const Ie=ce[De][Ke],Ye=ce[De+1][Ke],at=ce[De+1][Ke+1],tt=ce[De][Ke+1];z.push(Ie,Ye,tt),z.push(Ye,at,tt),Ve+=6}U.addGroup(te,Ve,0),te+=Ve}function ve(Ae){const qe=ie,Ve=new Jt,ze=new Ge;let Ke=0;const De=Ae===!0?n:s,Ie=Ae===!0?1:-1;for(let at=1;at<=d;at++)X.push(0,re*Ie,0),q.push(0,Ie,0),ee.push(.5,.5),ie++;const Ye=ie;for(let at=0;at<=d;at++){const ut=at/d*N+B,wt=Math.cos(ut),Yt=Math.sin(ut);ze.x=De*Yt,ze.y=re*Ie,ze.z=De*wt,X.push(ze.x,ze.y,ze.z),q.push(0,Ie,0),Ve.x=wt*.5+.5,Ve.y=Yt*.5*Ie+.5,ee.push(Ve.x,Ve.y),ie++}for(let at=0;at<d;at++){const tt=qe+at,ut=Ye+at;Ae===!0?z.push(ut,ut+1,tt):z.push(ut+1,ut,tt),Ke+=3}U.addGroup(te,Ke,Ae===!0?1:2),te+=Ke}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new qh(n.radiusTop,n.radiusBottom,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}class Z0 extends qh{constructor(n=1,s=1,l=32,d=1,b=!1,T=0,B=Math.PI*2){super(0,n,s,l,d,b,T,B),this.type="ConeGeometry",this.parameters={radius:n,height:s,radialSegments:l,heightSegments:d,openEnded:b,thetaStart:T,thetaLength:B}}static fromJSON(n){return new Z0(n.radius,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}class Dc extends Ui{constructor(n=[],s=[],l=1,d=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:n,indices:s,radius:l,detail:d};const b=[],T=[];B(d),U(l),z(),this.setAttribute("position",new ei(b,3)),this.setAttribute("normal",new ei(b.slice(),3)),this.setAttribute("uv",new ei(T,2)),d===0?this.computeVertexNormals():this.normalizeNormals();function B(we){const ve=new Ge,Ae=new Ge,qe=new Ge;for(let Ve=0;Ve<s.length;Ve+=3)ee(s[Ve+0],ve),ee(s[Ve+1],Ae),ee(s[Ve+2],qe),N(ve,Ae,qe,we)}function N(we,ve,Ae,qe){const Ve=qe+1,ze=[];for(let Ke=0;Ke<=Ve;Ke++){ze[Ke]=[];const De=we.clone().lerp(Ae,Ke/Ve),Ie=ve.clone().lerp(Ae,Ke/Ve),Ye=Ve-Ke;for(let at=0;at<=Ye;at++)at===0&&Ke===Ve?ze[Ke][at]=De:ze[Ke][at]=De.clone().lerp(Ie,at/Ye)}for(let Ke=0;Ke<Ve;Ke++)for(let De=0;De<2*(Ve-Ke)-1;De++){const Ie=Math.floor(De/2);De%2===0?(q(ze[Ke][Ie+1]),q(ze[Ke+1][Ie]),q(ze[Ke][Ie])):(q(ze[Ke][Ie+1]),q(ze[Ke+1][Ie+1]),q(ze[Ke+1][Ie]))}}function U(we){const ve=new Ge;for(let Ae=0;Ae<b.length;Ae+=3)ve.x=b[Ae+0],ve.y=b[Ae+1],ve.z=b[Ae+2],ve.normalize().multiplyScalar(we),b[Ae+0]=ve.x,b[Ae+1]=ve.y,b[Ae+2]=ve.z}function z(){const we=new Ge;for(let ve=0;ve<b.length;ve+=3){we.x=b[ve+0],we.y=b[ve+1],we.z=b[ve+2];const Ae=re(we)/2/Math.PI+.5,qe=te(we)/Math.PI+.5;T.push(Ae,1-qe)}ie(),X()}function X(){for(let we=0;we<T.length;we+=6){const ve=T[we+0],Ae=T[we+2],qe=T[we+4],Ve=Math.max(ve,Ae,qe),ze=Math.min(ve,Ae,qe);Ve>.9&&ze<.1&&(ve<.2&&(T[we+0]+=1),Ae<.2&&(T[we+2]+=1),qe<.2&&(T[we+4]+=1))}}function q(we){b.push(we.x,we.y,we.z)}function ee(we,ve){const Ae=we*3;ve.x=n[Ae+0],ve.y=n[Ae+1],ve.z=n[Ae+2]}function ie(){const we=new Ge,ve=new Ge,Ae=new Ge,qe=new Ge,Ve=new Jt,ze=new Jt,Ke=new Jt;for(let De=0,Ie=0;De<b.length;De+=9,Ie+=6){we.set(b[De+0],b[De+1],b[De+2]),ve.set(b[De+3],b[De+4],b[De+5]),Ae.set(b[De+6],b[De+7],b[De+8]),Ve.set(T[Ie+0],T[Ie+1]),ze.set(T[Ie+2],T[Ie+3]),Ke.set(T[Ie+4],T[Ie+5]),qe.copy(we).add(ve).add(Ae).divideScalar(3);const Ye=re(qe);ce(Ve,Ie+0,we,Ye),ce(ze,Ie+2,ve,Ye),ce(Ke,Ie+4,Ae,Ye)}}function ce(we,ve,Ae,qe){qe<0&&we.x===1&&(T[ve]=we.x-1),Ae.x===0&&Ae.z===0&&(T[ve]=qe/2/Math.PI+.5)}function re(we){return Math.atan2(we.z,-we.x)}function te(we){return Math.atan2(-we.y,Math.sqrt(we.x*we.x+we.z*we.z))}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new Dc(n.vertices,n.indices,n.radius,n.details)}}class eA extends Dc{constructor(n=1,s=0){const l=(1+Math.sqrt(5))/2,d=1/l,b=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-l,0,-d,l,0,d,-l,0,d,l,-d,-l,0,-d,l,0,d,-l,0,d,l,0,-l,0,-d,l,0,-d,-l,0,d,l,0,d],T=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(b,T,n,s),this.type="DodecahedronGeometry",this.parameters={radius:n,detail:s}}static fromJSON(n){return new eA(n.radius,n.detail)}}const tA=new Ge,nA=new Ge,Vb=new Ge,iA=new na;class C3 extends Ui{constructor(n=null,s=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:n,thresholdAngle:s},n!==null){const d=Math.pow(10,4),b=Math.cos(Ol*s),T=n.getIndex(),B=n.getAttribute("position"),N=T?T.count:B.count,U=[0,0,0],z=["a","b","c"],X=new Array(3),q={},ee=[];for(let ie=0;ie<N;ie+=3){T?(U[0]=T.getX(ie),U[1]=T.getX(ie+1),U[2]=T.getX(ie+2)):(U[0]=ie,U[1]=ie+1,U[2]=ie+2);const{a:ce,b:re,c:te}=iA;if(ce.fromBufferAttribute(B,U[0]),re.fromBufferAttribute(B,U[1]),te.fromBufferAttribute(B,U[2]),iA.getNormal(Vb),X[0]=`${Math.round(ce.x*d)},${Math.round(ce.y*d)},${Math.round(ce.z*d)}`,X[1]=`${Math.round(re.x*d)},${Math.round(re.y*d)},${Math.round(re.z*d)}`,X[2]=`${Math.round(te.x*d)},${Math.round(te.y*d)},${Math.round(te.z*d)}`,!(X[0]===X[1]||X[1]===X[2]||X[2]===X[0]))for(let we=0;we<3;we++){const ve=(we+1)%3,Ae=X[we],qe=X[ve],Ve=iA[z[we]],ze=iA[z[ve]],Ke=`${Ae}_${qe}`,De=`${qe}_${Ae}`;De in q&&q[De]?(Vb.dot(q[De].normal)<=b&&(ee.push(Ve.x,Ve.y,Ve.z),ee.push(ze.x,ze.y,ze.z)),q[De]=null):Ke in q||(q[Ke]={index0:U[we],index1:U[ve],normal:Vb.clone()})}}for(const ie in q)if(q[ie]){const{index0:ce,index1:re}=q[ie];tA.fromBufferAttribute(B,ce),nA.fromBufferAttribute(B,re),ee.push(tA.x,tA.y,tA.z),ee.push(nA.x,nA.y,nA.z)}this.setAttribute("position",new ei(ee,3))}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}}class Su extends Pd{constructor(n){super(n),this.uuid=bo(),this.type="Shape",this.holes=[]}getPointsHoles(n){const s=[];for(let l=0,d=this.holes.length;l<d;l++)s[l]=this.holes[l].getPoints(n);return s}extractPoints(n){return{shape:this.getPoints(n),holes:this.getPointsHoles(n)}}copy(n){super.copy(n),this.holes=[];for(let s=0,l=n.holes.length;s<l;s++){const d=n.holes[s];this.holes.push(d.clone())}return this}toJSON(){const n=super.toJSON();n.uuid=this.uuid,n.holes=[];for(let s=0,l=this.holes.length;s<l;s++){const d=this.holes[s];n.holes.push(d.toJSON())}return n}fromJSON(n){super.fromJSON(n),this.uuid=n.uuid,this.holes=[];for(let s=0,l=n.holes.length;s<l;s++){const d=n.holes[s];this.holes.push(new Pd().fromJSON(d))}return this}}const ZF={triangulate:function(_,n,s=2){const l=n&&n.length,d=l?n[0]*s:_.length;let b=x3(_,0,d,s,!0);const T=[];if(!b||b.next===b.prev)return T;let B,N,U,z,X,q,ee;if(l&&(b=rk(_,n,b,s)),_.length>80*s){B=U=_[0],N=z=_[1];for(let ie=s;ie<d;ie+=s)X=_[ie],q=_[ie+1],X<B&&(B=X),q<N&&(N=q),X>U&&(U=X),q>z&&(z=q);ee=Math.max(U-B,z-N),ee=ee!==0?32767/ee:0}return Nd(b,T,s,B,N,ee,0),T}};function x3(_,n,s,l,d){let b,T;if(d===mk(_,n,s,l)>0)for(b=n;b<s;b+=l)T=T3(b,_[b],_[b+1],T);else for(b=s-l;b>=n;b-=l)T=T3(b,_[b],_[b+1],T);return T&&rA(T,T.next)&&(Fd(T),T=T.next),T}function Tu(_,n){if(!_)return _;n||(n=_);let s=_,l;do if(l=!1,!s.steiner&&(rA(s,s.next)||is(s.prev,s,s.next)===0)){if(Fd(s),s=n=s.prev,s===s.next)break;l=!0}else s=s.next;while(l||s!==n);return n}function Nd(_,n,s,l,d,b,T){if(!_)return;!T&&b&&ck(_,l,d,b);let B=_,N,U;for(;_.prev!==_.next;){if(N=_.prev,U=_.next,b?tk(_,l,d,b):ek(_)){n.push(N.i/s|0),n.push(_.i/s|0),n.push(U.i/s|0),Fd(_),_=U.next,B=U.next;continue}if(_=U,_===B){T?T===1?(_=nk(Tu(_),n,s),Nd(_,n,s,l,d,b,2)):T===2&&ik(_,n,s,l,d,b):Nd(Tu(_),n,s,l,d,b,1);break}}}function ek(_){const n=_.prev,s=_,l=_.next;if(is(n,s,l)>=0)return!1;const d=n.x,b=s.x,T=l.x,B=n.y,N=s.y,U=l.y,z=d<b?d<T?d:T:b<T?b:T,X=B<N?B<U?B:U:N<U?N:U,q=d>b?d>T?d:T:b>T?b:T,ee=B>N?B>U?B:U:N>U?N:U;let ie=l.next;for(;ie!==n;){if(ie.x>=z&&ie.x<=q&&ie.y>=X&&ie.y<=ee&&Jh(d,B,b,N,T,U,ie.x,ie.y)&&is(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function tk(_,n,s,l){const d=_.prev,b=_,T=_.next;if(is(d,b,T)>=0)return!1;const B=d.x,N=b.x,U=T.x,z=d.y,X=b.y,q=T.y,ee=B<N?B<U?B:U:N<U?N:U,ie=z<X?z<q?z:q:X<q?X:q,ce=B>N?B>U?B:U:N>U?N:U,re=z>X?z>q?z:q:X>q?X:q,te=Qb(ee,ie,n,s,l),we=Qb(ce,re,n,s,l);let ve=_.prevZ,Ae=_.nextZ;for(;ve&&ve.z>=te&&Ae&&Ae.z<=we;){if(ve.x>=ee&&ve.x<=ce&&ve.y>=ie&&ve.y<=re&&ve!==d&&ve!==T&&Jh(B,z,N,X,U,q,ve.x,ve.y)&&is(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Ae.x>=ee&&Ae.x<=ce&&Ae.y>=ie&&Ae.y<=re&&Ae!==d&&Ae!==T&&Jh(B,z,N,X,U,q,Ae.x,Ae.y)&&is(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;ve&&ve.z>=te;){if(ve.x>=ee&&ve.x<=ce&&ve.y>=ie&&ve.y<=re&&ve!==d&&ve!==T&&Jh(B,z,N,X,U,q,ve.x,ve.y)&&is(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Ae&&Ae.z<=we;){if(Ae.x>=ee&&Ae.x<=ce&&Ae.y>=ie&&Ae.y<=re&&Ae!==d&&Ae!==T&&Jh(B,z,N,X,U,q,Ae.x,Ae.y)&&is(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function nk(_,n,s){let l=_;do{const d=l.prev,b=l.next.next;!rA(d,b)&&M3(d,l,l.next,b)&&Od(d,b)&&Od(b,d)&&(n.push(d.i/s|0),n.push(l.i/s|0),n.push(b.i/s|0),Fd(l),Fd(l.next),l=_=b),l=l.next}while(l!==_);return Tu(l)}function ik(_,n,s,l,d,b){let T=_;do{let B=T.next.next;for(;B!==T.prev;){if(T.i!==B.i&&fk(T,B)){let N=S3(T,B);T=Tu(T,T.next),N=Tu(N,N.next),Nd(T,n,s,l,d,b,0),Nd(N,n,s,l,d,b,0);return}B=B.next}T=T.next}while(T!==_)}function rk(_,n,s,l){const d=[];let b,T,B,N,U;for(b=0,T=n.length;b<T;b++)B=n[b]*l,N=b<T-1?n[b+1]*l:_.length,U=x3(_,B,N,l,!1),U===U.next&&(U.steiner=!0),d.push(hk(U));for(d.sort(sk),b=0;b<d.length;b++)s=ok(d[b],s);return s}function sk(_,n){return _.x-n.x}function ok(_,n){const s=ak(_,n);if(!s)return n;const l=S3(s,_);return Tu(l,l.next),Tu(s,s.next)}function ak(_,n){let s=n,l=-1/0,d;const b=_.x,T=_.y;do{if(T<=s.y&&T>=s.next.y&&s.next.y!==s.y){const q=s.x+(T-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(q<=b&&q>l&&(l=q,d=s.x<s.next.x?s:s.next,q===b))return d}s=s.next}while(s!==n);if(!d)return null;const B=d,N=d.x,U=d.y;let z=1/0,X;s=d;do b>=s.x&&s.x>=N&&b!==s.x&&Jh(T<U?b:l,T,N,U,T<U?l:b,T,s.x,s.y)&&(X=Math.abs(T-s.y)/(b-s.x),Od(s,_)&&(X<z||X===z&&(s.x>d.x||s.x===d.x&&lk(d,s)))&&(d=s,z=X)),s=s.next;while(s!==B);return d}function lk(_,n){return is(_.prev,_,n.prev)<0&&is(n.next,_,_.next)<0}function ck(_,n,s,l){let d=_;do d.z===0&&(d.z=Qb(d.x,d.y,n,s,l)),d.prevZ=d.prev,d.nextZ=d.next,d=d.next;while(d!==_);d.prevZ.nextZ=null,d.prevZ=null,uk(d)}function uk(_){let n,s,l,d,b,T,B,N,U=1;do{for(s=_,_=null,b=null,T=0;s;){for(T++,l=s,B=0,n=0;n<U&&(B++,l=l.nextZ,!!l);n++);for(N=U;B>0||N>0&&l;)B!==0&&(N===0||!l||s.z<=l.z)?(d=s,s=s.nextZ,B--):(d=l,l=l.nextZ,N--),b?b.nextZ=d:_=d,d.prevZ=b,b=d;s=l}b.nextZ=null,U*=2}while(T>1);return _}function Qb(_,n,s,l,d){return _=(_-s)*d|0,n=(n-l)*d|0,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,_|n<<1}function hk(_){let n=_,s=_;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==_);return s}function Jh(_,n,s,l,d,b,T,B){return(d-T)*(n-B)>=(_-T)*(b-B)&&(_-T)*(l-B)>=(s-T)*(n-B)&&(s-T)*(b-B)>=(d-T)*(l-B)}function fk(_,n){return _.next.i!==n.i&&_.prev.i!==n.i&&!dk(_,n)&&(Od(_,n)&&Od(n,_)&&pk(_,n)&&(is(_.prev,_,n.prev)||is(_,n.prev,n))||rA(_,n)&&is(_.prev,_,_.next)>0&&is(n.prev,n,n.next)>0)}function is(_,n,s){return(n.y-_.y)*(s.x-n.x)-(n.x-_.x)*(s.y-n.y)}function rA(_,n){return _.x===n.x&&_.y===n.y}function M3(_,n,s,l){const d=oA(is(_,n,s)),b=oA(is(_,n,l)),T=oA(is(s,l,_)),B=oA(is(s,l,n));return!!(d!==b&&T!==B||d===0&&sA(_,s,n)||b===0&&sA(_,l,n)||T===0&&sA(s,_,l)||B===0&&sA(s,n,l))}function sA(_,n,s){return n.x<=Math.max(_.x,s.x)&&n.x>=Math.min(_.x,s.x)&&n.y<=Math.max(_.y,s.y)&&n.y>=Math.min(_.y,s.y)}function oA(_){return _>0?1:_<0?-1:0}function dk(_,n){let s=_;do{if(s.i!==_.i&&s.next.i!==_.i&&s.i!==n.i&&s.next.i!==n.i&&M3(s,s.next,_,n))return!0;s=s.next}while(s!==_);return!1}function Od(_,n){return is(_.prev,_,_.next)<0?is(_,n,_.next)>=0&&is(_,_.prev,n)>=0:is(_,n,_.prev)<0||is(_,_.next,n)<0}function pk(_,n){let s=_,l=!1;const d=(_.x+n.x)/2,b=(_.y+n.y)/2;do s.y>b!=s.next.y>b&&s.next.y!==s.y&&d<(s.next.x-s.x)*(b-s.y)/(s.next.y-s.y)+s.x&&(l=!l),s=s.next;while(s!==_);return l}function S3(_,n){const s=new Hb(_.i,_.x,_.y),l=new Hb(n.i,n.x,n.y),d=_.next,b=n.prev;return _.next=n,n.prev=_,s.next=d,d.prev=s,l.next=s,s.prev=l,b.next=l,l.prev=b,l}function T3(_,n,s,l){const d=new Hb(_,n,s);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Fd(_){_.next.prev=_.prev,_.prev.next=_.next,_.prevZ&&(_.prevZ.nextZ=_.nextZ),_.nextZ&&(_.nextZ.prevZ=_.prevZ)}function Hb(_,n,s){this.i=_,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function mk(_,n,s,l){let d=0;for(let b=n,T=s-l;b<s;b+=l)d+=(_[T]-_[b])*(_[b+1]+_[T+1]),T=b;return d}class cl{static area(n){const s=n.length;let l=0;for(let d=s-1,b=0;b<s;d=b++)l+=n[d].x*n[b].y-n[b].x*n[d].y;return l*.5}static isClockWise(n){return cl.area(n)<0}static triangulateShape(n,s){const l=[],d=[],b=[];I3(n),B3(l,n);let T=n.length;s.forEach(I3);for(let N=0;N<s.length;N++)d.push(T),T+=s[N].length,B3(l,s[N]);const B=ZF.triangulate(l,d);for(let N=0;N<B.length;N+=3)b.push(B.slice(N,N+3));return b}}function I3(_){const n=_.length;n>2&&_[n-1].equals(_[0])&&_.pop()}function B3(_,n){for(let s=0;s<n.length;s++)_.push(n[s].x),_.push(n[s].y)}class aA extends Ui{constructor(n=new Su([new Jt(.5,.5),new Jt(-.5,.5),new Jt(-.5,-.5),new Jt(.5,-.5)]),s={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:n,options:s},n=Array.isArray(n)?n:[n];const l=this,d=[],b=[];for(let B=0,N=n.length;B<N;B++){const U=n[B];T(U)}this.setAttribute("position",new ei(d,3)),this.setAttribute("uv",new ei(b,2)),this.computeVertexNormals();function T(B){const N=[],U=s.curveSegments!==void 0?s.curveSegments:12,z=s.steps!==void 0?s.steps:1,X=s.depth!==void 0?s.depth:1;let q=s.bevelEnabled!==void 0?s.bevelEnabled:!0,ee=s.bevelThickness!==void 0?s.bevelThickness:.2,ie=s.bevelSize!==void 0?s.bevelSize:ee-.1,ce=s.bevelOffset!==void 0?s.bevelOffset:0,re=s.bevelSegments!==void 0?s.bevelSegments:3;const te=s.extrudePath,we=s.UVGenerator!==void 0?s.UVGenerator:Ak;let ve,Ae=!1,qe,Ve,ze,Ke;te&&(ve=te.getSpacedPoints(z),Ae=!0,q=!1,qe=te.computeFrenetFrames(z,!1),Ve=new Ge,ze=new Ge,Ke=new Ge),q||(re=0,ee=0,ie=0,ce=0);const De=B.extractPoints(U);let Ie=De.shape;const Ye=De.holes;if(!cl.isClockWise(Ie)){Ie=Ie.reverse();for(let tn=0,Qt=Ye.length;tn<Qt;tn++){const dn=Ye[tn];cl.isClockWise(dn)&&(Ye[tn]=dn.reverse())}}const tt=cl.triangulateShape(Ie,Ye),ut=Ie;for(let tn=0,Qt=Ye.length;tn<Qt;tn++){const dn=Ye[tn];Ie=Ie.concat(dn)}function wt(tn,Qt,dn){return Qt||console.error("THREE.ExtrudeGeometry: vec does not exist"),tn.clone().addScaledVector(Qt,dn)}const Yt=Ie.length,_n=tt.length;function Mt(tn,Qt,dn){let hn,cn,Ln;const Vn=tn.x-Qt.x,yi=tn.y-Qt.y,xi=dn.x-tn.x,dr=dn.y-tn.y,rs=Vn*Vn+yi*yi,Vr=Vn*dr-yi*xi;if(Math.abs(Vr)>Number.EPSILON){const Xe=Math.sqrt(rs),Be=Math.sqrt(xi*xi+dr*dr),Dt=Qt.x-yi/Xe,Zt=Qt.y+Vn/Xe,sn=dn.x-dr/Be,nn=dn.y+xi/Be,ni=((sn-Dt)*dr-(nn-Zt)*xi)/(Vn*dr-yi*xi);hn=Dt+Vn*ni-tn.x,cn=Zt+yi*ni-tn.y;const En=hn*hn+cn*cn;if(En<=2)return new Jt(hn,cn);Ln=Math.sqrt(En/2)}else{let Xe=!1;Vn>Number.EPSILON?xi>Number.EPSILON&&(Xe=!0):Vn<-Number.EPSILON?xi<-Number.EPSILON&&(Xe=!0):Math.sign(yi)===Math.sign(dr)&&(Xe=!0),Xe?(hn=-yi,cn=Vn,Ln=Math.sqrt(rs)):(hn=Vn,cn=yi,Ln=Math.sqrt(rs/2))}return new Jt(hn/Ln,cn/Ln)}const mn=[];for(let tn=0,Qt=ut.length,dn=Qt-1,hn=tn+1;tn<Qt;tn++,dn++,hn++)dn===Qt&&(dn=0),hn===Qt&&(hn=0),mn[tn]=Mt(ut[tn],ut[dn],ut[hn]);const vn=[];let Xn,Gi=mn.concat();for(let tn=0,Qt=Ye.length;tn<Qt;tn++){const dn=Ye[tn];Xn=[];for(let hn=0,cn=dn.length,Ln=cn-1,Vn=hn+1;hn<cn;hn++,Ln++,Vn++)Ln===cn&&(Ln=0),Vn===cn&&(Vn=0),Xn[hn]=Mt(dn[hn],dn[Ln],dn[Vn]);vn.push(Xn),Gi=Gi.concat(Xn)}for(let tn=0;tn<re;tn++){const Qt=tn/re,dn=ee*Math.cos(Qt*Math.PI/2),hn=ie*Math.sin(Qt*Math.PI/2)+ce;for(let cn=0,Ln=ut.length;cn<Ln;cn++){const Vn=wt(ut[cn],mn[cn],hn);Jn(Vn.x,Vn.y,-dn)}for(let cn=0,Ln=Ye.length;cn<Ln;cn++){const Vn=Ye[cn];Xn=vn[cn];for(let yi=0,xi=Vn.length;yi<xi;yi++){const dr=wt(Vn[yi],Xn[yi],hn);Jn(dr.x,dr.y,-dn)}}}const vr=ie+ce;for(let tn=0;tn<Yt;tn++){const Qt=q?wt(Ie[tn],Gi[tn],vr):Ie[tn];Ae?(ze.copy(qe.normals[0]).multiplyScalar(Qt.x),Ve.copy(qe.binormals[0]).multiplyScalar(Qt.y),Ke.copy(ve[0]).add(ze).add(Ve),Jn(Ke.x,Ke.y,Ke.z)):Jn(Qt.x,Qt.y,0)}for(let tn=1;tn<=z;tn++)for(let Qt=0;Qt<Yt;Qt++){const dn=q?wt(Ie[Qt],Gi[Qt],vr):Ie[Qt];Ae?(ze.copy(qe.normals[tn]).multiplyScalar(dn.x),Ve.copy(qe.binormals[tn]).multiplyScalar(dn.y),Ke.copy(ve[tn]).add(ze).add(Ve),Jn(Ke.x,Ke.y,Ke.z)):Jn(dn.x,dn.y,X/z*tn)}for(let tn=re-1;tn>=0;tn--){const Qt=tn/re,dn=ee*Math.cos(Qt*Math.PI/2),hn=ie*Math.sin(Qt*Math.PI/2)+ce;for(let cn=0,Ln=ut.length;cn<Ln;cn++){const Vn=wt(ut[cn],mn[cn],hn);Jn(Vn.x,Vn.y,X+dn)}for(let cn=0,Ln=Ye.length;cn<Ln;cn++){const Vn=Ye[cn];Xn=vn[cn];for(let yi=0,xi=Vn.length;yi<xi;yi++){const dr=wt(Vn[yi],Xn[yi],hn);Ae?Jn(dr.x,dr.y+ve[z-1].y,ve[z-1].x+dn):Jn(dr.x,dr.y,X+dn)}}}Gr(),fr();function Gr(){const tn=d.length/3;if(q){let Qt=0,dn=Yt*Qt;for(let hn=0;hn<_n;hn++){const cn=tt[hn];en(cn[2]+dn,cn[1]+dn,cn[0]+dn)}Qt=z+re*2,dn=Yt*Qt;for(let hn=0;hn<_n;hn++){const cn=tt[hn];en(cn[0]+dn,cn[1]+dn,cn[2]+dn)}}else{for(let Qt=0;Qt<_n;Qt++){const dn=tt[Qt];en(dn[2],dn[1],dn[0])}for(let Qt=0;Qt<_n;Qt++){const dn=tt[Qt];en(dn[0]+Yt*z,dn[1]+Yt*z,dn[2]+Yt*z)}}l.addGroup(tn,d.length/3-tn,0)}function fr(){const tn=d.length/3;let Qt=0;Lr(ut,Qt),Qt+=ut.length;for(let dn=0,hn=Ye.length;dn<hn;dn++){const cn=Ye[dn];Lr(cn,Qt),Qt+=cn.length}l.addGroup(tn,d.length/3-tn,1)}function Lr(tn,Qt){let dn=tn.length;for(;--dn>=0;){const hn=dn;let cn=dn-1;cn<0&&(cn=tn.length-1);for(let Ln=0,Vn=z+re*2;Ln<Vn;Ln++){const yi=Yt*Ln,xi=Yt*(Ln+1),dr=Qt+hn+yi,rs=Qt+cn+yi,Vr=Qt+cn+xi,Xe=Qt+hn+xi;Cn(dr,rs,Vr,Xe)}}}function Jn(tn,Qt,dn){N.push(tn),N.push(Qt),N.push(dn)}function en(tn,Qt,dn){Tn(tn),Tn(Qt),Tn(dn);const hn=d.length/3,cn=we.generateTopUV(l,d,hn-3,hn-2,hn-1);ht(cn[0]),ht(cn[1]),ht(cn[2])}function Cn(tn,Qt,dn,hn){Tn(tn),Tn(Qt),Tn(hn),Tn(Qt),Tn(dn),Tn(hn);const cn=d.length/3,Ln=we.generateSideWallUV(l,d,cn-6,cn-3,cn-2,cn-1);ht(Ln[0]),ht(Ln[1]),ht(Ln[3]),ht(Ln[1]),ht(Ln[2]),ht(Ln[3])}function Tn(tn){d.push(N[tn*3+0]),d.push(N[tn*3+1]),d.push(N[tn*3+2])}function ht(tn){b.push(tn.x),b.push(tn.y)}}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}toJSON(){const n=super.toJSON(),s=this.parameters.shapes,l=this.parameters.options;return gk(s,l,n)}static fromJSON(n,s){const l=[];for(let b=0,T=n.shapes.length;b<T;b++){const B=s[n.shapes[b]];l.push(B)}const d=n.options.extrudePath;return d!==void 0&&(n.options.extrudePath=new Y0[d.type]().fromJSON(d)),new aA(l,n.options)}}const Ak={generateTopUV:function(_,n,s,l,d){const b=n[s*3],T=n[s*3+1],B=n[l*3],N=n[l*3+1],U=n[d*3],z=n[d*3+1];return[new Jt(b,T),new Jt(B,N),new Jt(U,z)]},generateSideWallUV:function(_,n,s,l,d,b){const T=n[s*3],B=n[s*3+1],N=n[s*3+2],U=n[l*3],z=n[l*3+1],X=n[l*3+2],q=n[d*3],ee=n[d*3+1],ie=n[d*3+2],ce=n[b*3],re=n[b*3+1],te=n[b*3+2];return Math.abs(B-z)<Math.abs(T-U)?[new Jt(T,1-N),new Jt(U,1-X),new Jt(q,1-ie),new Jt(ce,1-te)]:[new Jt(B,1-N),new Jt(z,1-X),new Jt(ee,1-ie),new Jt(re,1-te)]}};function gk(_,n,s){if(s.shapes=[],Array.isArray(_))for(let l=0,d=_.length;l<d;l++){const b=_[l];s.shapes.push(b.uuid)}else s.shapes.push(_.uuid);return s.options=Object.assign({},n),n.extrudePath!==void 0&&(s.options.extrudePath=n.extrudePath.toJSON()),s}class lA extends Dc{constructor(n=1,s=0){const l=(1+Math.sqrt(5))/2,d=[-1,l,0,1,l,0,-1,-l,0,1,-l,0,0,-1,l,0,1,l,0,-1,-l,0,1,-l,l,0,-1,l,0,1,-l,0,-1,-l,0,1],b=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(d,b,n,s),this.type="IcosahedronGeometry",this.parameters={radius:n,detail:s}}static fromJSON(n){return new lA(n.radius,n.detail)}}class kd extends Dc{constructor(n=1,s=0){const l=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],d=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(l,d,n,s),this.type="OctahedronGeometry",this.parameters={radius:n,detail:s}}static fromJSON(n){return new kd(n.radius,n.detail)}}class cA extends Ui{constructor(n=.5,s=1,l=32,d=1,b=0,T=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:n,outerRadius:s,thetaSegments:l,phiSegments:d,thetaStart:b,thetaLength:T},l=Math.max(3,l),d=Math.max(1,d);const B=[],N=[],U=[],z=[];let X=n;const q=(s-n)/d,ee=new Ge,ie=new Jt;for(let ce=0;ce<=d;ce++){for(let re=0;re<=l;re++){const te=b+re/l*T;ee.x=X*Math.cos(te),ee.y=X*Math.sin(te),N.push(ee.x,ee.y,ee.z),U.push(0,0,1),ie.x=(ee.x/s+1)/2,ie.y=(ee.y/s+1)/2,z.push(ie.x,ie.y)}X+=q}for(let ce=0;ce<d;ce++){const re=ce*(l+1);for(let te=0;te<l;te++){const we=te+re,ve=we,Ae=we+l+1,qe=we+l+2,Ve=we+1;B.push(ve,Ae,Ve),B.push(Ae,qe,Ve)}}this.setIndex(B),this.setAttribute("position",new ei(N,3)),this.setAttribute("normal",new ei(U,3)),this.setAttribute("uv",new ei(z,2))}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new cA(n.innerRadius,n.outerRadius,n.thetaSegments,n.phiSegments,n.thetaStart,n.thetaLength)}}class uA extends Ui{constructor(n=new Su([new Jt(0,.5),new Jt(-.5,-.5),new Jt(.5,-.5)]),s=12){super(),this.type="ShapeGeometry",this.parameters={shapes:n,curveSegments:s};const l=[],d=[],b=[],T=[];let B=0,N=0;if(Array.isArray(n)===!1)U(n);else for(let z=0;z<n.length;z++)U(n[z]),this.addGroup(B,N,z),B+=N,N=0;this.setIndex(l),this.setAttribute("position",new ei(d,3)),this.setAttribute("normal",new ei(b,3)),this.setAttribute("uv",new ei(T,2));function U(z){const X=d.length/3,q=z.extractPoints(s);let ee=q.shape;const ie=q.holes;cl.isClockWise(ee)===!1&&(ee=ee.reverse());for(let re=0,te=ie.length;re<te;re++){const we=ie[re];cl.isClockWise(we)===!0&&(ie[re]=we.reverse())}const ce=cl.triangulateShape(ee,ie);for(let re=0,te=ie.length;re<te;re++){const we=ie[re];ee=ee.concat(we)}for(let re=0,te=ee.length;re<te;re++){const we=ee[re];d.push(we.x,we.y,0),b.push(0,0,1),T.push(we.x,we.y)}for(let re=0,te=ce.length;re<te;re++){const we=ce[re],ve=we[0]+X,Ae=we[1]+X,qe=we[2]+X;l.push(ve,Ae,qe),N+=3}}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}toJSON(){const n=super.toJSON(),s=this.parameters.shapes;return vk(s,n)}static fromJSON(n,s){const l=[];for(let d=0,b=n.shapes.length;d<b;d++){const T=s[n.shapes[d]];l.push(T)}return new uA(l,n.curveSegments)}}function vk(_,n){if(n.shapes=[],Array.isArray(_))for(let s=0,l=_.length;s<l;s++){const d=_[s];n.shapes.push(d.uuid)}else n.shapes.push(_.uuid);return n}class Ud extends Ui{constructor(n=1,s=32,l=16,d=0,b=Math.PI*2,T=0,B=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:n,widthSegments:s,heightSegments:l,phiStart:d,phiLength:b,thetaStart:T,thetaLength:B},s=Math.max(3,Math.floor(s)),l=Math.max(2,Math.floor(l));const N=Math.min(T+B,Math.PI);let U=0;const z=[],X=new Ge,q=new Ge,ee=[],ie=[],ce=[],re=[];for(let te=0;te<=l;te++){const we=[],ve=te/l;let Ae=0;te===0&&T===0?Ae=.5/s:te===l&&N===Math.PI&&(Ae=-.5/s);for(let qe=0;qe<=s;qe++){const Ve=qe/s;X.x=-n*Math.cos(d+Ve*b)*Math.sin(T+ve*B),X.y=n*Math.cos(T+ve*B),X.z=n*Math.sin(d+Ve*b)*Math.sin(T+ve*B),ie.push(X.x,X.y,X.z),q.copy(X).normalize(),ce.push(q.x,q.y,q.z),re.push(Ve+Ae,1-ve),we.push(U++)}z.push(we)}for(let te=0;te<l;te++)for(let we=0;we<s;we++){const ve=z[te][we+1],Ae=z[te][we],qe=z[te+1][we],Ve=z[te+1][we+1];(te!==0||T>0)&&ee.push(ve,Ae,Ve),(te!==l-1||N<Math.PI)&&ee.push(Ae,qe,Ve)}this.setIndex(ee),this.setAttribute("position",new ei(ie,3)),this.setAttribute("normal",new ei(ce,3)),this.setAttribute("uv",new ei(re,2))}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new Ud(n.radius,n.widthSegments,n.heightSegments,n.phiStart,n.phiLength,n.thetaStart,n.thetaLength)}}class hA extends Dc{constructor(n=1,s=0){const l=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],d=[2,1,0,0,3,2,1,3,0,2,3,1];super(l,d,n,s),this.type="TetrahedronGeometry",this.parameters={radius:n,detail:s}}static fromJSON(n){return new hA(n.radius,n.detail)}}class fA extends Ui{constructor(n=1,s=.4,l=12,d=48,b=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:n,tube:s,radialSegments:l,tubularSegments:d,arc:b},l=Math.floor(l),d=Math.floor(d);const T=[],B=[],N=[],U=[],z=new Ge,X=new Ge,q=new Ge;for(let ee=0;ee<=l;ee++)for(let ie=0;ie<=d;ie++){const ce=ie/d*b,re=ee/l*Math.PI*2;X.x=(n+s*Math.cos(re))*Math.cos(ce),X.y=(n+s*Math.cos(re))*Math.sin(ce),X.z=s*Math.sin(re),B.push(X.x,X.y,X.z),z.x=n*Math.cos(ce),z.y=n*Math.sin(ce),q.subVectors(X,z).normalize(),N.push(q.x,q.y,q.z),U.push(ie/d),U.push(ee/l)}for(let ee=1;ee<=l;ee++)for(let ie=1;ie<=d;ie++){const ce=(d+1)*ee+ie-1,re=(d+1)*(ee-1)+ie-1,te=(d+1)*(ee-1)+ie,we=(d+1)*ee+ie;T.push(ce,re,we),T.push(re,te,we)}this.setIndex(T),this.setAttribute("position",new ei(B,3)),this.setAttribute("normal",new ei(N,3)),this.setAttribute("uv",new ei(U,2))}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new fA(n.radius,n.tube,n.radialSegments,n.tubularSegments,n.arc)}}class dA extends Ui{constructor(n=1,s=.4,l=64,d=8,b=2,T=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:n,tube:s,tubularSegments:l,radialSegments:d,p:b,q:T},l=Math.floor(l),d=Math.floor(d);const B=[],N=[],U=[],z=[],X=new Ge,q=new Ge,ee=new Ge,ie=new Ge,ce=new Ge,re=new Ge,te=new Ge;for(let ve=0;ve<=l;++ve){const Ae=ve/l*b*Math.PI*2;we(Ae,b,T,n,ee),we(Ae+.01,b,T,n,ie),re.subVectors(ie,ee),te.addVectors(ie,ee),ce.crossVectors(re,te),te.crossVectors(ce,re),ce.normalize(),te.normalize();for(let qe=0;qe<=d;++qe){const Ve=qe/d*Math.PI*2,ze=-s*Math.cos(Ve),Ke=s*Math.sin(Ve);X.x=ee.x+(ze*te.x+Ke*ce.x),X.y=ee.y+(ze*te.y+Ke*ce.y),X.z=ee.z+(ze*te.z+Ke*ce.z),N.push(X.x,X.y,X.z),q.subVectors(X,ee).normalize(),U.push(q.x,q.y,q.z),z.push(ve/l),z.push(qe/d)}}for(let ve=1;ve<=l;ve++)for(let Ae=1;Ae<=d;Ae++){const qe=(d+1)*(ve-1)+(Ae-1),Ve=(d+1)*ve+(Ae-1),ze=(d+1)*ve+Ae,Ke=(d+1)*(ve-1)+Ae;B.push(qe,Ve,Ke),B.push(Ve,ze,Ke)}this.setIndex(B),this.setAttribute("position",new ei(N,3)),this.setAttribute("normal",new ei(U,3)),this.setAttribute("uv",new ei(z,2));function we(ve,Ae,qe,Ve,ze){const Ke=Math.cos(ve),De=Math.sin(ve),Ie=qe/Ae*ve,Ye=Math.cos(Ie);ze.x=Ve*(2+Ye)*.5*Ke,ze.y=Ve*(2+Ye)*De*.5,ze.z=Ve*Math.sin(Ie)*.5}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}static fromJSON(n){return new dA(n.radius,n.tube,n.tubularSegments,n.radialSegments,n.p,n.q)}}class pA extends Ui{constructor(n=new Ub(new Ge(-1,-1,0),new Ge(-1,1,0),new Ge(1,1,0)),s=64,l=1,d=8,b=!1){super(),this.type="TubeGeometry",this.parameters={path:n,tubularSegments:s,radius:l,radialSegments:d,closed:b};const T=n.computeFrenetFrames(s,b);this.tangents=T.tangents,this.normals=T.normals,this.binormals=T.binormals;const B=new Ge,N=new Ge,U=new Jt;let z=new Ge;const X=[],q=[],ee=[],ie=[];ce(),this.setIndex(ie),this.setAttribute("position",new ei(X,3)),this.setAttribute("normal",new ei(q,3)),this.setAttribute("uv",new ei(ee,2));function ce(){for(let ve=0;ve<s;ve++)re(ve);re(b===!1?s:0),we(),te()}function re(ve){z=n.getPointAt(ve/s,z);const Ae=T.normals[ve],qe=T.binormals[ve];for(let Ve=0;Ve<=d;Ve++){const ze=Ve/d*Math.PI*2,Ke=Math.sin(ze),De=-Math.cos(ze);N.x=De*Ae.x+Ke*qe.x,N.y=De*Ae.y+Ke*qe.y,N.z=De*Ae.z+Ke*qe.z,N.normalize(),q.push(N.x,N.y,N.z),B.x=z.x+l*N.x,B.y=z.y+l*N.y,B.z=z.z+l*N.z,X.push(B.x,B.y,B.z)}}function te(){for(let ve=1;ve<=s;ve++)for(let Ae=1;Ae<=d;Ae++){const qe=(d+1)*(ve-1)+(Ae-1),Ve=(d+1)*ve+(Ae-1),ze=(d+1)*ve+Ae,Ke=(d+1)*(ve-1)+Ae;ie.push(qe,Ve,Ke),ie.push(Ve,ze,Ke)}}function we(){for(let ve=0;ve<=s;ve++)for(let Ae=0;Ae<=d;Ae++)U.x=ve/s,U.y=Ae/d,ee.push(U.x,U.y)}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}toJSON(){const n=super.toJSON();return n.path=this.parameters.path.toJSON(),n}static fromJSON(n){return new pA(new Y0[n.path.type]().fromJSON(n.path),n.tubularSegments,n.radius,n.radialSegments,n.closed)}}class R3 extends Ui{constructor(n=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:n},n!==null){const s=[],l=new Set,d=new Ge,b=new Ge;if(n.index!==null){const T=n.attributes.position,B=n.index;let N=n.groups;N.length===0&&(N=[{start:0,count:B.count,materialIndex:0}]);for(let U=0,z=N.length;U<z;++U){const X=N[U],q=X.start,ee=X.count;for(let ie=q,ce=q+ee;ie<ce;ie+=3)for(let re=0;re<3;re++){const te=B.getX(ie+re),we=B.getX(ie+(re+1)%3);d.fromBufferAttribute(T,te),b.fromBufferAttribute(T,we),L3(d,b,l)===!0&&(s.push(d.x,d.y,d.z),s.push(b.x,b.y,b.z))}}}else{const T=n.attributes.position;for(let B=0,N=T.count/3;B<N;B++)for(let U=0;U<3;U++){const z=3*B+U,X=3*B+(U+1)%3;d.fromBufferAttribute(T,z),b.fromBufferAttribute(T,X),L3(d,b,l)===!0&&(s.push(d.x,d.y,d.z),s.push(b.x,b.y,b.z))}}this.setAttribute("position",new ei(s,3))}}copy(n){return super.copy(n),this.parameters=Object.assign({},n.parameters),this}}function L3(_,n,s){const l=`${_.x},${_.y},${_.z}-${n.x},${n.y},${n.z}`,d=`${n.x},${n.y},${n.z}-${_.x},${_.y},${_.z}`;return s.has(l)===!0||s.has(d)===!0?!1:(s.add(l),s.add(d),!0)}var P3=Object.freeze({__proto__:null,BoxGeometry:vu,CapsuleGeometry:q0,CircleGeometry:J0,ConeGeometry:Z0,CylinderGeometry:qh,DodecahedronGeometry:eA,EdgesGeometry:C3,ExtrudeGeometry:aA,IcosahedronGeometry:lA,LatheGeometry:Dd,OctahedronGeometry:kd,PlaneGeometry:Gh,PolyhedronGeometry:Dc,RingGeometry:cA,ShapeGeometry:uA,SphereGeometry:Ud,TetrahedronGeometry:hA,TorusGeometry:fA,TorusKnotGeometry:dA,TubeGeometry:pA,WireframeGeometry:R3});class D3 extends ao{constructor(n){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Qn(0),this.transparent=!0,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.fog=n.fog,this}}class N3 extends Fa{constructor(n){super(n),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class zb extends ao{constructor(n){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Qn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ta,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.defines={STANDARD:""},this.color.copy(n.color),this.roughness=n.roughness,this.metalness=n.metalness,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.roughnessMap=n.roughnessMap,this.metalnessMap=n.metalnessMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapRotation.copy(n.envMapRotation),this.envMapIntensity=n.envMapIntensity,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this.fog=n.fog,this}}class O3 extends zb{constructor(n){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Jt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Kr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(s){this.ior=(1+.4*s)/(1-.4*s)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Qn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Qn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Qn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(n)}get anisotropy(){return this._anisotropy}set anisotropy(n){this._anisotropy>0!=n>0&&this.version++,this._anisotropy=n}get clearcoat(){return this._clearcoat}set clearcoat(n){this._clearcoat>0!=n>0&&this.version++,this._clearcoat=n}get iridescence(){return this._iridescence}set iridescence(n){this._iridescence>0!=n>0&&this.version++,this._iridescence=n}get dispersion(){return this._dispersion}set dispersion(n){this._dispersion>0!=n>0&&this.version++,this._dispersion=n}get sheen(){return this._sheen}set sheen(n){this._sheen>0!=n>0&&this.version++,this._sheen=n}get transmission(){return this._transmission}set transmission(n){this._transmission>0!=n>0&&this.version++,this._transmission=n}copy(n){return super.copy(n),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=n.anisotropy,this.anisotropyRotation=n.anisotropyRotation,this.anisotropyMap=n.anisotropyMap,this.clearcoat=n.clearcoat,this.clearcoatMap=n.clearcoatMap,this.clearcoatRoughness=n.clearcoatRoughness,this.clearcoatRoughnessMap=n.clearcoatRoughnessMap,this.clearcoatNormalMap=n.clearcoatNormalMap,this.clearcoatNormalScale.copy(n.clearcoatNormalScale),this.dispersion=n.dispersion,this.ior=n.ior,this.iridescence=n.iridescence,this.iridescenceMap=n.iridescenceMap,this.iridescenceIOR=n.iridescenceIOR,this.iridescenceThicknessRange=[...n.iridescenceThicknessRange],this.iridescenceThicknessMap=n.iridescenceThicknessMap,this.sheen=n.sheen,this.sheenColor.copy(n.sheenColor),this.sheenColorMap=n.sheenColorMap,this.sheenRoughness=n.sheenRoughness,this.sheenRoughnessMap=n.sheenRoughnessMap,this.transmission=n.transmission,this.transmissionMap=n.transmissionMap,this.thickness=n.thickness,this.thicknessMap=n.thicknessMap,this.attenuationDistance=n.attenuationDistance,this.attenuationColor.copy(n.attenuationColor),this.specularIntensity=n.specularIntensity,this.specularIntensityMap=n.specularIntensityMap,this.specularColor.copy(n.specularColor),this.specularColorMap=n.specularColorMap,this}}class F3 extends ao{constructor(n){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Qn(16777215),this.specular=new Qn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ta,this.combine=Tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.specular.copy(n.specular),this.shininess=n.shininess,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapRotation.copy(n.envMapRotation),this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this.fog=n.fog,this}}class k3 extends ao{constructor(n){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Qn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.gradientMap=n.gradientMap,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.fog=n.fog,this}}class U3 extends ao{constructor(n){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.flatShading=n.flatShading,this}}class G3 extends ao{constructor(n){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ta,this.combine=Tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapRotation.copy(n.envMapRotation),this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this.fog=n.fog,this}}class V3 extends ao{constructor(n){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Qn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ro,this.normalScale=new Jt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.defines={MATCAP:""},this.color.copy(n.color),this.matcap=n.matcap,this.map=n.map,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.flatShading=n.flatShading,this.fog=n.fog,this}}class Q3 extends wo{constructor(n){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(n)}copy(n){return super.copy(n),this.scale=n.scale,this.dashSize=n.dashSize,this.gapSize=n.gapSize,this}}function Iu(_,n,s){return!_||!s&&_.constructor===n?_:typeof n.BYTES_PER_ELEMENT=="number"?new n(_):Array.prototype.slice.call(_)}function H3(_){return ArrayBuffer.isView(_)&&!(_ instanceof DataView)}function z3(_){function n(d,b){return _[d]-_[b]}const s=_.length,l=new Array(s);for(let d=0;d!==s;++d)l[d]=d;return l.sort(n),l}function jb(_,n,s){const l=_.length,d=new _.constructor(l);for(let b=0,T=0;T!==l;++b){const B=s[b]*n;for(let N=0;N!==n;++N)d[T++]=_[B+N]}return d}function Wb(_,n,s,l){let d=1,b=_[0];for(;b!==void 0&&b[l]===void 0;)b=_[d++];if(b===void 0)return;let T=b[l];if(T!==void 0)if(Array.isArray(T))do T=b[l],T!==void 0&&(n.push(b.time),s.push.apply(s,T)),b=_[d++];while(b!==void 0);else if(T.toArray!==void 0)do T=b[l],T!==void 0&&(n.push(b.time),T.toArray(s,s.length)),b=_[d++];while(b!==void 0);else do T=b[l],T!==void 0&&(n.push(b.time),s.push(T)),b=_[d++];while(b!==void 0)}function bk(_,n,s,l,d=30){const b=_.clone();b.name=n;const T=[];for(let N=0;N<b.tracks.length;++N){const U=b.tracks[N],z=U.getValueSize(),X=[],q=[];for(let ee=0;ee<U.times.length;++ee){const ie=U.times[ee]*d;if(!(ie<s||ie>=l)){X.push(U.times[ee]);for(let ce=0;ce<z;++ce)q.push(U.values[ee*z+ce])}}X.length!==0&&(U.times=Iu(X,U.times.constructor),U.values=Iu(q,U.values.constructor),T.push(U))}b.tracks=T;let B=1/0;for(let N=0;N<b.tracks.length;++N)B>b.tracks[N].times[0]&&(B=b.tracks[N].times[0]);for(let N=0;N<b.tracks.length;++N)b.tracks[N].shift(-1*B);return b.resetDuration(),b}function yk(_,n=0,s=_,l=30){l<=0&&(l=30);const d=s.tracks.length,b=n/l;for(let T=0;T<d;++T){const B=s.tracks[T],N=B.ValueTypeName;if(N==="bool"||N==="string")continue;const U=_.tracks.find(function(te){return te.name===B.name&&te.ValueTypeName===N});if(U===void 0)continue;let z=0;const X=B.getValueSize();B.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(z=X/3);let q=0;const ee=U.getValueSize();U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(q=ee/3);const ie=B.times.length-1;let ce;if(b<=B.times[0]){const te=z,we=X-z;ce=B.values.slice(te,we)}else if(b>=B.times[ie]){const te=ie*X+z,we=te+X-z;ce=B.values.slice(te,we)}else{const te=B.createInterpolant(),we=z,ve=X-z;te.evaluate(b),ce=te.resultBuffer.slice(we,ve)}N==="quaternion"&&new ur().fromArray(ce).normalize().conjugate().toArray(ce);const re=U.times.length;for(let te=0;te<re;++te){const we=te*ee+q;if(N==="quaternion")ur.multiplyQuaternionsFlat(U.values,we,ce,0,U.values,we);else{const ve=ee-q*2;for(let Ae=0;Ae<ve;++Ae)U.values[we+Ae]-=ce[Ae]}}}return _.blendMode=Da,_}const _k={convertArray:Iu,isTypedArray:H3,getKeyframeOrder:z3,sortedArray:jb,flattenJSON:Wb,subclip:bk,makeClipAdditive:yk};class Gd{constructor(n,s,l,d){this.parameterPositions=n,this._cachedIndex=0,this.resultBuffer=d!==void 0?d:new s.constructor(l),this.sampleValues=s,this.valueSize=l,this.settings=null,this.DefaultSettings_={}}evaluate(n){const s=this.parameterPositions;let l=this._cachedIndex,d=s[l],b=s[l-1];e:{t:{let T;n:{i:if(!(n<d)){for(let B=l+2;;){if(d===void 0){if(n<b)break i;return l=s.length,this._cachedIndex=l,this.copySampleValue_(l-1)}if(l===B)break;if(b=d,d=s[++l],n<d)break t}T=s.length;break n}if(!(n>=b)){const B=s[1];n<B&&(l=2,b=B);for(let N=l-2;;){if(b===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(l===N)break;if(d=b,b=s[--l-1],n>=b)break t}T=l,l=0;break n}break e}for(;l<T;){const B=l+T>>>1;n<s[B]?T=B:l=B+1}if(d=s[l],b=s[l-1],b===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(d===void 0)return l=s.length,this._cachedIndex=l,this.copySampleValue_(l-1)}this._cachedIndex=l,this.intervalChanged_(l,b,d)}return this.interpolate_(l,b,n,d)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(n){const s=this.resultBuffer,l=this.sampleValues,d=this.valueSize,b=n*d;for(let T=0;T!==d;++T)s[T]=l[b+T];return s}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class j3 extends Gd{constructor(n,s,l,d){super(n,s,l,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ts,endingEnd:ts}}intervalChanged_(n,s,l){const d=this.parameterPositions;let b=n-2,T=n+1,B=d[b],N=d[T];if(B===void 0)switch(this.getSettings_().endingStart){case Us:b=n,B=2*s-l;break;case qo:b=d.length-2,B=s+d[b]-d[b+1];break;default:b=n,B=l}if(N===void 0)switch(this.getSettings_().endingEnd){case Us:T=n,N=2*l-s;break;case qo:T=1,N=l+d[1]-d[0];break;default:T=n-1,N=s}const U=(l-s)*.5,z=this.valueSize;this._weightPrev=U/(s-B),this._weightNext=U/(N-l),this._offsetPrev=b*z,this._offsetNext=T*z}interpolate_(n,s,l,d){const b=this.resultBuffer,T=this.sampleValues,B=this.valueSize,N=n*B,U=N-B,z=this._offsetPrev,X=this._offsetNext,q=this._weightPrev,ee=this._weightNext,ie=(l-s)/(d-s),ce=ie*ie,re=ce*ie,te=-q*re+2*q*ce-q*ie,we=(1+q)*re+(-1.5-2*q)*ce+(-.5+q)*ie+1,ve=(-1-ee)*re+(1.5+ee)*ce+.5*ie,Ae=ee*re-ee*ce;for(let qe=0;qe!==B;++qe)b[qe]=te*T[z+qe]+we*T[U+qe]+ve*T[N+qe]+Ae*T[X+qe];return b}}class $b extends Gd{constructor(n,s,l,d){super(n,s,l,d)}interpolate_(n,s,l,d){const b=this.resultBuffer,T=this.sampleValues,B=this.valueSize,N=n*B,U=N-B,z=(l-s)/(d-s),X=1-z;for(let q=0;q!==B;++q)b[q]=T[U+q]*X+T[N+q]*z;return b}}class W3 extends Gd{constructor(n,s,l,d){super(n,s,l,d)}interpolate_(n){return this.copySampleValue_(n-1)}}class Ga{constructor(n,s,l,d){if(n===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(s===void 0||s.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+n);this.name=n,this.times=Iu(s,this.TimeBufferType),this.values=Iu(l,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation)}static toJSON(n){const s=n.constructor;let l;if(s.toJSON!==this.toJSON)l=s.toJSON(n);else{l={name:n.name,times:Iu(n.times,Array),values:Iu(n.values,Array)};const d=n.getInterpolation();d!==n.DefaultInterpolation&&(l.interpolation=d)}return l.type=n.ValueTypeName,l}InterpolantFactoryMethodDiscrete(n){return new W3(this.times,this.values,this.getValueSize(),n)}InterpolantFactoryMethodLinear(n){return new $b(this.times,this.values,this.getValueSize(),n)}InterpolantFactoryMethodSmooth(n){return new j3(this.times,this.values,this.getValueSize(),n)}setInterpolation(n){let s;switch(n){case gs:s=this.InterpolantFactoryMethodDiscrete;break;case vs:s=this.InterpolantFactoryMethodLinear;break;case _s:s=this.InterpolantFactoryMethodSmooth;break}if(s===void 0){const l="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(n!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(l);return console.warn("THREE.KeyframeTrack:",l),this}return this.createInterpolant=s,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return gs;case this.InterpolantFactoryMethodLinear:return vs;case this.InterpolantFactoryMethodSmooth:return _s}}getValueSize(){return this.values.length/this.times.length}shift(n){if(n!==0){const s=this.times;for(let l=0,d=s.length;l!==d;++l)s[l]+=n}return this}scale(n){if(n!==1){const s=this.times;for(let l=0,d=s.length;l!==d;++l)s[l]*=n}return this}trim(n,s){const l=this.times,d=l.length;let b=0,T=d-1;for(;b!==d&&l[b]<n;)++b;for(;T!==-1&&l[T]>s;)--T;if(++T,b!==0||T!==d){b>=T&&(T=Math.max(T,1),b=T-1);const B=this.getValueSize();this.times=l.slice(b,T),this.values=this.values.slice(b*B,T*B)}return this}validate(){let n=!0;const s=this.getValueSize();s-Math.floor(s)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),n=!1);const l=this.times,d=this.values,b=l.length;b===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),n=!1);let T=null;for(let B=0;B!==b;B++){const N=l[B];if(typeof N=="number"&&isNaN(N)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,B,N),n=!1;break}if(T!==null&&T>N){console.error("THREE.KeyframeTrack: Out of order keys.",this,B,N,T),n=!1;break}T=N}if(d!==void 0&&H3(d))for(let B=0,N=d.length;B!==N;++B){const U=d[B];if(isNaN(U)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,B,U),n=!1;break}}return n}optimize(){const n=this.times.slice(),s=this.values.slice(),l=this.getValueSize(),d=this.getInterpolation()===_s,b=n.length-1;let T=1;for(let B=1;B<b;++B){let N=!1;const U=n[B],z=n[B+1];if(U!==z&&(B!==1||U!==n[0]))if(d)N=!0;else{const X=B*l,q=X-l,ee=X+l;for(let ie=0;ie!==l;++ie){const ce=s[X+ie];if(ce!==s[q+ie]||ce!==s[ee+ie]){N=!0;break}}}if(N){if(B!==T){n[T]=n[B];const X=B*l,q=T*l;for(let ee=0;ee!==l;++ee)s[q+ee]=s[X+ee]}++T}}if(b>0){n[T]=n[b];for(let B=b*l,N=T*l,U=0;U!==l;++U)s[N+U]=s[B+U];++T}return T!==n.length?(this.times=n.slice(0,T),this.values=s.slice(0,T*l)):(this.times=n,this.values=s),this}clone(){const n=this.times.slice(),s=this.values.slice(),l=this.constructor,d=new l(this.name,n,s);return d.createInterpolant=this.createInterpolant,d}}Ga.prototype.TimeBufferType=Float32Array,Ga.prototype.ValueBufferType=Float32Array,Ga.prototype.DefaultInterpolation=vs;class Bu extends Ga{}Bu.prototype.ValueTypeName="bool",Bu.prototype.ValueBufferType=Array,Bu.prototype.DefaultInterpolation=gs,Bu.prototype.InterpolantFactoryMethodLinear=void 0,Bu.prototype.InterpolantFactoryMethodSmooth=void 0;class Xb extends Ga{}Xb.prototype.ValueTypeName="color";class Vd extends Ga{}Vd.prototype.ValueTypeName="number";class $3 extends Gd{constructor(n,s,l,d){super(n,s,l,d)}interpolate_(n,s,l,d){const b=this.resultBuffer,T=this.sampleValues,B=this.valueSize,N=(l-s)/(d-s);let U=n*B;for(let z=U+B;U!==z;U+=4)ur.slerpFlat(b,0,T,U-B,T,U,N);return b}}class Zh extends Ga{InterpolantFactoryMethodLinear(n){return new $3(this.times,this.values,this.getValueSize(),n)}}Zh.prototype.ValueTypeName="quaternion",Zh.prototype.DefaultInterpolation=vs,Zh.prototype.InterpolantFactoryMethodSmooth=void 0;class Ru extends Ga{}Ru.prototype.ValueTypeName="string",Ru.prototype.ValueBufferType=Array,Ru.prototype.DefaultInterpolation=gs,Ru.prototype.InterpolantFactoryMethodLinear=void 0,Ru.prototype.InterpolantFactoryMethodSmooth=void 0;class Qd extends Ga{}Qd.prototype.ValueTypeName="vector";class Hd{constructor(n="",s=-1,l=[],d=pa){this.name=n,this.tracks=l,this.duration=s,this.blendMode=d,this.uuid=bo(),this.duration<0&&this.resetDuration()}static parse(n){const s=[],l=n.tracks,d=1/(n.fps||1);for(let T=0,B=l.length;T!==B;++T)s.push(wk(l[T]).scale(d));const b=new this(n.name,n.duration,s,n.blendMode);return b.uuid=n.uuid,b}static toJSON(n){const s=[],l=n.tracks,d={name:n.name,duration:n.duration,tracks:s,uuid:n.uuid,blendMode:n.blendMode};for(let b=0,T=l.length;b!==T;++b)s.push(Ga.toJSON(l[b]));return d}static CreateFromMorphTargetSequence(n,s,l,d){const b=s.length,T=[];for(let B=0;B<b;B++){let N=[],U=[];N.push((B+b-1)%b,B,(B+1)%b),U.push(0,1,0);const z=z3(N);N=jb(N,1,z),U=jb(U,1,z),!d&&N[0]===0&&(N.push(b),U.push(U[0])),T.push(new Vd(".morphTargetInfluences["+s[B].name+"]",N,U).scale(1/l))}return new this(n,-1,T)}static findByName(n,s){let l=n;if(!Array.isArray(n)){const d=n;l=d.geometry&&d.geometry.animations||d.animations}for(let d=0;d<l.length;d++)if(l[d].name===s)return l[d];return null}static CreateClipsFromMorphTargetSequences(n,s,l){const d={},b=/^([\w-]*?)([\d]+)$/;for(let B=0,N=n.length;B<N;B++){const U=n[B],z=U.name.match(b);if(z&&z.length>1){const X=z[1];let q=d[X];q||(d[X]=q=[]),q.push(U)}}const T=[];for(const B in d)T.push(this.CreateFromMorphTargetSequence(B,d[B],s,l));return T}static parseAnimation(n,s){if(!n)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const l=function(X,q,ee,ie,ce){if(ee.length!==0){const re=[],te=[];Wb(ee,re,te,ie),re.length!==0&&ce.push(new X(q,re,te))}},d=[],b=n.name||"default",T=n.fps||30,B=n.blendMode;let N=n.length||-1;const U=n.hierarchy||[];for(let X=0;X<U.length;X++){const q=U[X].keys;if(!(!q||q.length===0))if(q[0].morphTargets){const ee={};let ie;for(ie=0;ie<q.length;ie++)if(q[ie].morphTargets)for(let ce=0;ce<q[ie].morphTargets.length;ce++)ee[q[ie].morphTargets[ce]]=-1;for(const ce in ee){const re=[],te=[];for(let we=0;we!==q[ie].morphTargets.length;++we){const ve=q[ie];re.push(ve.time),te.push(ve.morphTarget===ce?1:0)}d.push(new Vd(".morphTargetInfluence["+ce+"]",re,te))}N=ee.length*T}else{const ee=".bones["+s[X].name+"]";l(Qd,ee+".position",q,"pos",d),l(Zh,ee+".quaternion",q,"rot",d),l(Qd,ee+".scale",q,"scl",d)}}return d.length===0?null:new this(b,N,d,B)}resetDuration(){const n=this.tracks;let s=0;for(let l=0,d=n.length;l!==d;++l){const b=this.tracks[l];s=Math.max(s,b.times[b.times.length-1])}return this.duration=s,this}trim(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].trim(0,this.duration);return this}validate(){let n=!0;for(let s=0;s<this.tracks.length;s++)n=n&&this.tracks[s].validate();return n}optimize(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].optimize();return this}clone(){const n=[];for(let s=0;s<this.tracks.length;s++)n.push(this.tracks[s].clone());return new this.constructor(this.name,this.duration,n,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ek(_){switch(_.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Vd;case"vector":case"vector2":case"vector3":case"vector4":return Qd;case"color":return Xb;case"quaternion":return Zh;case"bool":case"boolean":return Bu;case"string":return Ru}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+_)}function wk(_){if(_.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const n=Ek(_.type);if(_.times===void 0){const s=[],l=[];Wb(_.keys,s,l,"value"),_.times=s,_.values=l}return n.parse!==void 0?n.parse(_):new n(_.name,_.times,_.values,_.interpolation)}const zl={enabled:!1,files:{},add:function(_,n){this.enabled!==!1&&(this.files[_]=n)},get:function(_){if(this.enabled!==!1)return this.files[_]},remove:function(_){delete this.files[_]},clear:function(){this.files={}}};class Kb{constructor(n,s,l){const d=this;let b=!1,T=0,B=0,N;const U=[];this.onStart=void 0,this.onLoad=n,this.onProgress=s,this.onError=l,this.itemStart=function(z){B++,b===!1&&d.onStart!==void 0&&d.onStart(z,T,B),b=!0},this.itemEnd=function(z){T++,d.onProgress!==void 0&&d.onProgress(z,T,B),T===B&&(b=!1,d.onLoad!==void 0&&d.onLoad())},this.itemError=function(z){d.onError!==void 0&&d.onError(z)},this.resolveURL=function(z){return N?N(z):z},this.setURLModifier=function(z){return N=z,this},this.addHandler=function(z,X){return U.push(z,X),this},this.removeHandler=function(z){const X=U.indexOf(z);return X!==-1&&U.splice(X,2),this},this.getHandler=function(z){for(let X=0,q=U.length;X<q;X+=2){const ee=U[X],ie=U[X+1];if(ee.global&&(ee.lastIndex=0),ee.test(z))return ie}return null}}}const X3=new Kb;class ko{constructor(n){this.manager=n!==void 0?n:X3,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(n,s){const l=this;return new Promise(function(d,b){l.load(n,d,s,b)})}parse(){}setCrossOrigin(n){return this.crossOrigin=n,this}setWithCredentials(n){return this.withCredentials=n,this}setPath(n){return this.path=n,this}setResourcePath(n){return this.resourcePath=n,this}setRequestHeader(n){return this.requestHeader=n,this}}ko.DEFAULT_MATERIAL_NAME="__DEFAULT";const jl={};class Ck extends Error{constructor(n,s){super(n),this.response=s}}class Wl extends ko{constructor(n){super(n)}load(n,s,l,d){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const b=zl.get(n);if(b!==void 0)return this.manager.itemStart(n),setTimeout(()=>{s&&s(b),this.manager.itemEnd(n)},0),b;if(jl[n]!==void 0){jl[n].push({onLoad:s,onProgress:l,onError:d});return}jl[n]=[],jl[n].push({onLoad:s,onProgress:l,onError:d});const T=new Request(n,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),B=this.mimeType,N=this.responseType;fetch(T).then(U=>{if(U.status===200||U.status===0){if(U.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||U.body===void 0||U.body.getReader===void 0)return U;const z=jl[n],X=U.body.getReader(),q=U.headers.get("X-File-Size")||U.headers.get("Content-Length"),ee=q?parseInt(q):0,ie=ee!==0;let ce=0;const re=new ReadableStream({start(te){we();function we(){X.read().then(({done:ve,value:Ae})=>{if(ve)te.close();else{ce+=Ae.byteLength;const qe=new ProgressEvent("progress",{lengthComputable:ie,loaded:ce,total:ee});for(let Ve=0,ze=z.length;Ve<ze;Ve++){const Ke=z[Ve];Ke.onProgress&&Ke.onProgress(qe)}te.enqueue(Ae),we()}})}}});return new Response(re)}else throw new Ck(`fetch for "${U.url}" responded with ${U.status}: ${U.statusText}`,U)}).then(U=>{switch(N){case"arraybuffer":return U.arrayBuffer();case"blob":return U.blob();case"document":return U.text().then(z=>new DOMParser().parseFromString(z,B));case"json":return U.json();default:if(B===void 0)return U.text();{const X=/charset="?([^;"\s]*)"?/i.exec(B),q=X&&X[1]?X[1].toLowerCase():void 0,ee=new TextDecoder(q);return U.arrayBuffer().then(ie=>ee.decode(ie))}}}).then(U=>{zl.add(n,U);const z=jl[n];delete jl[n];for(let X=0,q=z.length;X<q;X++){const ee=z[X];ee.onLoad&&ee.onLoad(U)}}).catch(U=>{const z=jl[n];if(z===void 0)throw this.manager.itemError(n),U;delete jl[n];for(let X=0,q=z.length;X<q;X++){const ee=z[X];ee.onError&&ee.onError(U)}this.manager.itemError(n)}).finally(()=>{this.manager.itemEnd(n)}),this.manager.itemStart(n)}setResponseType(n){return this.responseType=n,this}setMimeType(n){return this.mimeType=n,this}}class xk extends ko{constructor(n){super(n)}load(n,s,l,d){const b=this,T=new Wl(this.manager);T.setPath(this.path),T.setRequestHeader(this.requestHeader),T.setWithCredentials(this.withCredentials),T.load(n,function(B){try{s(b.parse(JSON.parse(B)))}catch(N){d?d(N):console.error(N),b.manager.itemError(n)}},l,d)}parse(n){const s=[];for(let l=0;l<n.length;l++){const d=Hd.parse(n[l]);s.push(d)}return s}}class Mk extends ko{constructor(n){super(n)}load(n,s,l,d){const b=this,T=[],B=new $0,N=new Wl(this.manager);N.setPath(this.path),N.setResponseType("arraybuffer"),N.setRequestHeader(this.requestHeader),N.setWithCredentials(b.withCredentials);let U=0;function z(X){N.load(n[X],function(q){const ee=b.parse(q,!0);T[X]={width:ee.width,height:ee.height,format:ee.format,mipmaps:ee.mipmaps},U+=1,U===6&&(ee.mipmapCount===1&&(B.minFilter=Dn),B.image=T,B.format=ee.format,B.needsUpdate=!0,s&&s(B))},l,d)}if(Array.isArray(n))for(let X=0,q=n.length;X<q;++X)z(X);else N.load(n,function(X){const q=b.parse(X,!0);if(q.isCubemap){const ee=q.mipmaps.length/q.mipmapCount;for(let ie=0;ie<ee;ie++){T[ie]={mipmaps:[]};for(let ce=0;ce<q.mipmapCount;ce++)T[ie].mipmaps.push(q.mipmaps[ie*q.mipmapCount+ce]),T[ie].format=q.format,T[ie].width=q.width,T[ie].height=q.height}B.image=T}else B.image.width=q.width,B.image.height=q.height,B.mipmaps=q.mipmaps;q.mipmapCount===1&&(B.minFilter=Dn),B.format=q.format,B.needsUpdate=!0,s&&s(B)},l,d);return B}}class zd extends ko{constructor(n){super(n)}load(n,s,l,d){this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const b=this,T=zl.get(n);if(T!==void 0)return b.manager.itemStart(n),setTimeout(function(){s&&s(T),b.manager.itemEnd(n)},0),T;const B=Au("img");function N(){z(),zl.add(n,this),s&&s(this),b.manager.itemEnd(n)}function U(X){z(),d&&d(X),b.manager.itemError(n),b.manager.itemEnd(n)}function z(){B.removeEventListener("load",N,!1),B.removeEventListener("error",U,!1)}return B.addEventListener("load",N,!1),B.addEventListener("error",U,!1),n.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(B.crossOrigin=this.crossOrigin),b.manager.itemStart(n),B.src=n,B}}class Sk extends ko{constructor(n){super(n)}load(n,s,l,d){const b=new _d;b.colorSpace=rr;const T=new zd(this.manager);T.setCrossOrigin(this.crossOrigin),T.setPath(this.path);let B=0;function N(U){T.load(n[U],function(z){b.images[U]=z,B++,B===6&&(b.needsUpdate=!0,s&&s(b))},void 0,d)}for(let U=0;U<n.length;++U)N(U);return b}}class Tk extends ko{constructor(n){super(n)}load(n,s,l,d){const b=this,T=new Rc,B=new Wl(this.manager);return B.setResponseType("arraybuffer"),B.setRequestHeader(this.requestHeader),B.setPath(this.path),B.setWithCredentials(b.withCredentials),B.load(n,function(N){let U;try{U=b.parse(N)}catch(z){if(d!==void 0)d(z);else{console.error(z);return}}U.image!==void 0?T.image=U.image:U.data!==void 0&&(T.image.width=U.width,T.image.height=U.height,T.image.data=U.data),T.wrapS=U.wrapS!==void 0?U.wrapS:He,T.wrapT=U.wrapT!==void 0?U.wrapT:He,T.magFilter=U.magFilter!==void 0?U.magFilter:Dn,T.minFilter=U.minFilter!==void 0?U.minFilter:Dn,T.anisotropy=U.anisotropy!==void 0?U.anisotropy:1,U.colorSpace!==void 0&&(T.colorSpace=U.colorSpace),U.flipY!==void 0&&(T.flipY=U.flipY),U.format!==void 0&&(T.format=U.format),U.type!==void 0&&(T.type=U.type),U.mipmaps!==void 0&&(T.mipmaps=U.mipmaps,T.minFilter=_r),U.mipmapCount===1&&(T.minFilter=Dn),U.generateMipmaps!==void 0&&(T.generateMipmaps=U.generateMipmaps),T.needsUpdate=!0,s&&s(T,U)},l,d),T}}class Ik extends ko{constructor(n){super(n)}load(n,s,l,d){const b=new kr,T=new zd(this.manager);return T.setCrossOrigin(this.crossOrigin),T.setPath(this.path),T.load(n,function(B){b.image=B,b.needsUpdate=!0,s!==void 0&&s(b)},l,d),b}}class Nc extends hr{constructor(n,s=1){super(),this.isLight=!0,this.type="Light",this.color=new Qn(n),this.intensity=s}dispose(){}copy(n,s){return super.copy(n,s),this.color.copy(n.color),this.intensity=n.intensity,this}toJSON(n){const s=super.toJSON(n);return s.object.color=this.color.getHex(),s.object.intensity=this.intensity,this.groundColor!==void 0&&(s.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(s.object.distance=this.distance),this.angle!==void 0&&(s.object.angle=this.angle),this.decay!==void 0&&(s.object.decay=this.decay),this.penumbra!==void 0&&(s.object.penumbra=this.penumbra),this.shadow!==void 0&&(s.object.shadow=this.shadow.toJSON()),s}}class K3 extends Nc{constructor(n,s,l){super(n,l),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(hr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Qn(s)}copy(n,s){return super.copy(n,s),this.groundColor.copy(n.groundColor),this}}const Yb=new Kn,Y3=new Ge,q3=new Ge;class qb{constructor(n){this.camera=n,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jt(512,512),this.map=null,this.mapPass=null,this.matrix=new Kn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ed,this._frameExtents=new Jt(1,1),this._viewportCount=1,this._viewports=[new ar(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(n){const s=this.camera,l=this.matrix;Y3.setFromMatrixPosition(n.matrixWorld),s.position.copy(Y3),q3.setFromMatrixPosition(n.target.matrixWorld),s.lookAt(q3),s.updateMatrixWorld(),Yb.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Yb),l.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),l.multiply(Yb)}getViewport(n){return this._viewports[n]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(n){return this.camera=n.camera.clone(),this.bias=n.bias,this.radius=n.radius,this.mapSize.copy(n.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const n={};return this.bias!==0&&(n.bias=this.bias),this.normalBias!==0&&(n.normalBias=this.normalBias),this.radius!==1&&(n.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(n.mapSize=this.mapSize.toArray()),n.camera=this.camera.toJSON(!1).object,delete n.camera.matrix,n}}class Bk extends qb{constructor(){super(new Bs(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(n){const s=this.camera,l=_c*2*n.angle*this.focus,d=this.mapSize.width/this.mapSize.height,b=n.distance||s.far;(l!==s.fov||d!==s.aspect||b!==s.far)&&(s.fov=l,s.aspect=d,s.far=b,s.updateProjectionMatrix()),super.updateMatrices(n)}copy(n){return super.copy(n),this.focus=n.focus,this}}class J3 extends Nc{constructor(n,s,l=0,d=Math.PI/3,b=0,T=2){super(n,s),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(hr.DEFAULT_UP),this.updateMatrix(),this.target=new hr,this.distance=l,this.angle=d,this.penumbra=b,this.decay=T,this.map=null,this.shadow=new Bk}get power(){return this.intensity*Math.PI}set power(n){this.intensity=n/Math.PI}dispose(){this.shadow.dispose()}copy(n,s){return super.copy(n,s),this.distance=n.distance,this.angle=n.angle,this.penumbra=n.penumbra,this.decay=n.decay,this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}const Z3=new Kn,jd=new Ge,Jb=new Ge;class Rk extends qb{constructor(){super(new Bs(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Jt(4,2),this._viewportCount=6,this._viewports=[new ar(2,1,1,1),new ar(0,1,1,1),new ar(3,1,1,1),new ar(1,1,1,1),new ar(3,0,1,1),new ar(1,0,1,1)],this._cubeDirections=[new Ge(1,0,0),new Ge(-1,0,0),new Ge(0,0,1),new Ge(0,0,-1),new Ge(0,1,0),new Ge(0,-1,0)],this._cubeUps=[new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,0,1),new Ge(0,0,-1)]}updateMatrices(n,s=0){const l=this.camera,d=this.matrix,b=n.distance||l.far;b!==l.far&&(l.far=b,l.updateProjectionMatrix()),jd.setFromMatrixPosition(n.matrixWorld),l.position.copy(jd),Jb.copy(l.position),Jb.add(this._cubeDirections[s]),l.up.copy(this._cubeUps[s]),l.lookAt(Jb),l.updateMatrixWorld(),d.makeTranslation(-jd.x,-jd.y,-jd.z),Z3.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Z3)}}class ex extends Nc{constructor(n,s,l=0,d=2){super(n,s),this.isPointLight=!0,this.type="PointLight",this.distance=l,this.decay=d,this.shadow=new Rk}get power(){return this.intensity*4*Math.PI}set power(n){this.intensity=n/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(n,s){return super.copy(n,s),this.distance=n.distance,this.decay=n.decay,this.shadow=n.shadow.clone(),this}}class Lk extends qb{constructor(){super(new x0(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class tx extends Nc{constructor(n,s){super(n,s),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(hr.DEFAULT_UP),this.updateMatrix(),this.target=new hr,this.shadow=new Lk}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}class nx extends Nc{constructor(n,s){super(n,s),this.isAmbientLight=!0,this.type="AmbientLight"}}class ix extends Nc{constructor(n,s,l=10,d=10){super(n,s),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=l,this.height=d}get power(){return this.intensity*this.width*this.height*Math.PI}set power(n){this.intensity=n/(this.width*this.height*Math.PI)}copy(n){return super.copy(n),this.width=n.width,this.height=n.height,this}toJSON(n){const s=super.toJSON(n);return s.object.width=this.width,s.object.height=this.height,s}}class rx{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let n=0;n<9;n++)this.coefficients.push(new Ge)}set(n){for(let s=0;s<9;s++)this.coefficients[s].copy(n[s]);return this}zero(){for(let n=0;n<9;n++)this.coefficients[n].set(0,0,0);return this}getAt(n,s){const l=n.x,d=n.y,b=n.z,T=this.coefficients;return s.copy(T[0]).multiplyScalar(.282095),s.addScaledVector(T[1],.488603*d),s.addScaledVector(T[2],.488603*b),s.addScaledVector(T[3],.488603*l),s.addScaledVector(T[4],1.092548*(l*d)),s.addScaledVector(T[5],1.092548*(d*b)),s.addScaledVector(T[6],.315392*(3*b*b-1)),s.addScaledVector(T[7],1.092548*(l*b)),s.addScaledVector(T[8],.546274*(l*l-d*d)),s}getIrradianceAt(n,s){const l=n.x,d=n.y,b=n.z,T=this.coefficients;return s.copy(T[0]).multiplyScalar(.886227),s.addScaledVector(T[1],1.023328*d),s.addScaledVector(T[2],1.023328*b),s.addScaledVector(T[3],1.023328*l),s.addScaledVector(T[4],.858086*l*d),s.addScaledVector(T[5],.858086*d*b),s.addScaledVector(T[6],.743125*b*b-.247708),s.addScaledVector(T[7],.858086*l*b),s.addScaledVector(T[8],.429043*(l*l-d*d)),s}add(n){for(let s=0;s<9;s++)this.coefficients[s].add(n.coefficients[s]);return this}addScaledSH(n,s){for(let l=0;l<9;l++)this.coefficients[l].addScaledVector(n.coefficients[l],s);return this}scale(n){for(let s=0;s<9;s++)this.coefficients[s].multiplyScalar(n);return this}lerp(n,s){for(let l=0;l<9;l++)this.coefficients[l].lerp(n.coefficients[l],s);return this}equals(n){for(let s=0;s<9;s++)if(!this.coefficients[s].equals(n.coefficients[s]))return!1;return!0}copy(n){return this.set(n.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(n,s=0){const l=this.coefficients;for(let d=0;d<9;d++)l[d].fromArray(n,s+d*3);return this}toArray(n=[],s=0){const l=this.coefficients;for(let d=0;d<9;d++)l[d].toArray(n,s+d*3);return n}static getBasisAt(n,s){const l=n.x,d=n.y,b=n.z;s[0]=.282095,s[1]=.488603*d,s[2]=.488603*b,s[3]=.488603*l,s[4]=1.092548*l*d,s[5]=1.092548*d*b,s[6]=.315392*(3*b*b-1),s[7]=1.092548*l*b,s[8]=.546274*(l*l-d*d)}}class sx extends Nc{constructor(n=new rx,s=1){super(void 0,s),this.isLightProbe=!0,this.sh=n}copy(n){return super.copy(n),this.sh.copy(n.sh),this}fromJSON(n){return this.intensity=n.intensity,this.sh.fromArray(n.sh),this}toJSON(n){const s=super.toJSON(n);return s.object.sh=this.sh.toArray(),s}}class mA extends ko{constructor(n){super(n),this.textures={}}load(n,s,l,d){const b=this,T=new Wl(b.manager);T.setPath(b.path),T.setRequestHeader(b.requestHeader),T.setWithCredentials(b.withCredentials),T.load(n,function(B){try{s(b.parse(JSON.parse(B)))}catch(N){d?d(N):console.error(N),b.manager.itemError(n)}},l,d)}parse(n){const s=this.textures;function l(b){return s[b]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",b),s[b]}const d=mA.createMaterialFromType(n.type);if(n.uuid!==void 0&&(d.uuid=n.uuid),n.name!==void 0&&(d.name=n.name),n.color!==void 0&&d.color!==void 0&&d.color.setHex(n.color),n.roughness!==void 0&&(d.roughness=n.roughness),n.metalness!==void 0&&(d.metalness=n.metalness),n.sheen!==void 0&&(d.sheen=n.sheen),n.sheenColor!==void 0&&(d.sheenColor=new Qn().setHex(n.sheenColor)),n.sheenRoughness!==void 0&&(d.sheenRoughness=n.sheenRoughness),n.emissive!==void 0&&d.emissive!==void 0&&d.emissive.setHex(n.emissive),n.specular!==void 0&&d.specular!==void 0&&d.specular.setHex(n.specular),n.specularIntensity!==void 0&&(d.specularIntensity=n.specularIntensity),n.specularColor!==void 0&&d.specularColor!==void 0&&d.specularColor.setHex(n.specularColor),n.shininess!==void 0&&(d.shininess=n.shininess),n.clearcoat!==void 0&&(d.clearcoat=n.clearcoat),n.clearcoatRoughness!==void 0&&(d.clearcoatRoughness=n.clearcoatRoughness),n.dispersion!==void 0&&(d.dispersion=n.dispersion),n.iridescence!==void 0&&(d.iridescence=n.iridescence),n.iridescenceIOR!==void 0&&(d.iridescenceIOR=n.iridescenceIOR),n.iridescenceThicknessRange!==void 0&&(d.iridescenceThicknessRange=n.iridescenceThicknessRange),n.transmission!==void 0&&(d.transmission=n.transmission),n.thickness!==void 0&&(d.thickness=n.thickness),n.attenuationDistance!==void 0&&(d.attenuationDistance=n.attenuationDistance),n.attenuationColor!==void 0&&d.attenuationColor!==void 0&&d.attenuationColor.setHex(n.attenuationColor),n.anisotropy!==void 0&&(d.anisotropy=n.anisotropy),n.anisotropyRotation!==void 0&&(d.anisotropyRotation=n.anisotropyRotation),n.fog!==void 0&&(d.fog=n.fog),n.flatShading!==void 0&&(d.flatShading=n.flatShading),n.blending!==void 0&&(d.blending=n.blending),n.combine!==void 0&&(d.combine=n.combine),n.side!==void 0&&(d.side=n.side),n.shadowSide!==void 0&&(d.shadowSide=n.shadowSide),n.opacity!==void 0&&(d.opacity=n.opacity),n.transparent!==void 0&&(d.transparent=n.transparent),n.alphaTest!==void 0&&(d.alphaTest=n.alphaTest),n.alphaHash!==void 0&&(d.alphaHash=n.alphaHash),n.depthFunc!==void 0&&(d.depthFunc=n.depthFunc),n.depthTest!==void 0&&(d.depthTest=n.depthTest),n.depthWrite!==void 0&&(d.depthWrite=n.depthWrite),n.colorWrite!==void 0&&(d.colorWrite=n.colorWrite),n.blendSrc!==void 0&&(d.blendSrc=n.blendSrc),n.blendDst!==void 0&&(d.blendDst=n.blendDst),n.blendEquation!==void 0&&(d.blendEquation=n.blendEquation),n.blendSrcAlpha!==void 0&&(d.blendSrcAlpha=n.blendSrcAlpha),n.blendDstAlpha!==void 0&&(d.blendDstAlpha=n.blendDstAlpha),n.blendEquationAlpha!==void 0&&(d.blendEquationAlpha=n.blendEquationAlpha),n.blendColor!==void 0&&d.blendColor!==void 0&&d.blendColor.setHex(n.blendColor),n.blendAlpha!==void 0&&(d.blendAlpha=n.blendAlpha),n.stencilWriteMask!==void 0&&(d.stencilWriteMask=n.stencilWriteMask),n.stencilFunc!==void 0&&(d.stencilFunc=n.stencilFunc),n.stencilRef!==void 0&&(d.stencilRef=n.stencilRef),n.stencilFuncMask!==void 0&&(d.stencilFuncMask=n.stencilFuncMask),n.stencilFail!==void 0&&(d.stencilFail=n.stencilFail),n.stencilZFail!==void 0&&(d.stencilZFail=n.stencilZFail),n.stencilZPass!==void 0&&(d.stencilZPass=n.stencilZPass),n.stencilWrite!==void 0&&(d.stencilWrite=n.stencilWrite),n.wireframe!==void 0&&(d.wireframe=n.wireframe),n.wireframeLinewidth!==void 0&&(d.wireframeLinewidth=n.wireframeLinewidth),n.wireframeLinecap!==void 0&&(d.wireframeLinecap=n.wireframeLinecap),n.wireframeLinejoin!==void 0&&(d.wireframeLinejoin=n.wireframeLinejoin),n.rotation!==void 0&&(d.rotation=n.rotation),n.linewidth!==void 0&&(d.linewidth=n.linewidth),n.dashSize!==void 0&&(d.dashSize=n.dashSize),n.gapSize!==void 0&&(d.gapSize=n.gapSize),n.scale!==void 0&&(d.scale=n.scale),n.polygonOffset!==void 0&&(d.polygonOffset=n.polygonOffset),n.polygonOffsetFactor!==void 0&&(d.polygonOffsetFactor=n.polygonOffsetFactor),n.polygonOffsetUnits!==void 0&&(d.polygonOffsetUnits=n.polygonOffsetUnits),n.dithering!==void 0&&(d.dithering=n.dithering),n.alphaToCoverage!==void 0&&(d.alphaToCoverage=n.alphaToCoverage),n.premultipliedAlpha!==void 0&&(d.premultipliedAlpha=n.premultipliedAlpha),n.forceSinglePass!==void 0&&(d.forceSinglePass=n.forceSinglePass),n.visible!==void 0&&(d.visible=n.visible),n.toneMapped!==void 0&&(d.toneMapped=n.toneMapped),n.userData!==void 0&&(d.userData=n.userData),n.vertexColors!==void 0&&(typeof n.vertexColors=="number"?d.vertexColors=n.vertexColors>0:d.vertexColors=n.vertexColors),n.uniforms!==void 0)for(const b in n.uniforms){const T=n.uniforms[b];switch(d.uniforms[b]={},T.type){case"t":d.uniforms[b].value=l(T.value);break;case"c":d.uniforms[b].value=new Qn().setHex(T.value);break;case"v2":d.uniforms[b].value=new Jt().fromArray(T.value);break;case"v3":d.uniforms[b].value=new Ge().fromArray(T.value);break;case"v4":d.uniforms[b].value=new ar().fromArray(T.value);break;case"m3":d.uniforms[b].value=new _i().fromArray(T.value);break;case"m4":d.uniforms[b].value=new Kn().fromArray(T.value);break;default:d.uniforms[b].value=T.value}}if(n.defines!==void 0&&(d.defines=n.defines),n.vertexShader!==void 0&&(d.vertexShader=n.vertexShader),n.fragmentShader!==void 0&&(d.fragmentShader=n.fragmentShader),n.glslVersion!==void 0&&(d.glslVersion=n.glslVersion),n.extensions!==void 0)for(const b in n.extensions)d.extensions[b]=n.extensions[b];if(n.lights!==void 0&&(d.lights=n.lights),n.clipping!==void 0&&(d.clipping=n.clipping),n.size!==void 0&&(d.size=n.size),n.sizeAttenuation!==void 0&&(d.sizeAttenuation=n.sizeAttenuation),n.map!==void 0&&(d.map=l(n.map)),n.matcap!==void 0&&(d.matcap=l(n.matcap)),n.alphaMap!==void 0&&(d.alphaMap=l(n.alphaMap)),n.bumpMap!==void 0&&(d.bumpMap=l(n.bumpMap)),n.bumpScale!==void 0&&(d.bumpScale=n.bumpScale),n.normalMap!==void 0&&(d.normalMap=l(n.normalMap)),n.normalMapType!==void 0&&(d.normalMapType=n.normalMapType),n.normalScale!==void 0){let b=n.normalScale;Array.isArray(b)===!1&&(b=[b,b]),d.normalScale=new Jt().fromArray(b)}return n.displacementMap!==void 0&&(d.displacementMap=l(n.displacementMap)),n.displacementScale!==void 0&&(d.displacementScale=n.displacementScale),n.displacementBias!==void 0&&(d.displacementBias=n.displacementBias),n.roughnessMap!==void 0&&(d.roughnessMap=l(n.roughnessMap)),n.metalnessMap!==void 0&&(d.metalnessMap=l(n.metalnessMap)),n.emissiveMap!==void 0&&(d.emissiveMap=l(n.emissiveMap)),n.emissiveIntensity!==void 0&&(d.emissiveIntensity=n.emissiveIntensity),n.specularMap!==void 0&&(d.specularMap=l(n.specularMap)),n.specularIntensityMap!==void 0&&(d.specularIntensityMap=l(n.specularIntensityMap)),n.specularColorMap!==void 0&&(d.specularColorMap=l(n.specularColorMap)),n.envMap!==void 0&&(d.envMap=l(n.envMap)),n.envMapRotation!==void 0&&d.envMapRotation.fromArray(n.envMapRotation),n.envMapIntensity!==void 0&&(d.envMapIntensity=n.envMapIntensity),n.reflectivity!==void 0&&(d.reflectivity=n.reflectivity),n.refractionRatio!==void 0&&(d.refractionRatio=n.refractionRatio),n.lightMap!==void 0&&(d.lightMap=l(n.lightMap)),n.lightMapIntensity!==void 0&&(d.lightMapIntensity=n.lightMapIntensity),n.aoMap!==void 0&&(d.aoMap=l(n.aoMap)),n.aoMapIntensity!==void 0&&(d.aoMapIntensity=n.aoMapIntensity),n.gradientMap!==void 0&&(d.gradientMap=l(n.gradientMap)),n.clearcoatMap!==void 0&&(d.clearcoatMap=l(n.clearcoatMap)),n.clearcoatRoughnessMap!==void 0&&(d.clearcoatRoughnessMap=l(n.clearcoatRoughnessMap)),n.clearcoatNormalMap!==void 0&&(d.clearcoatNormalMap=l(n.clearcoatNormalMap)),n.clearcoatNormalScale!==void 0&&(d.clearcoatNormalScale=new Jt().fromArray(n.clearcoatNormalScale)),n.iridescenceMap!==void 0&&(d.iridescenceMap=l(n.iridescenceMap)),n.iridescenceThicknessMap!==void 0&&(d.iridescenceThicknessMap=l(n.iridescenceThicknessMap)),n.transmissionMap!==void 0&&(d.transmissionMap=l(n.transmissionMap)),n.thicknessMap!==void 0&&(d.thicknessMap=l(n.thicknessMap)),n.anisotropyMap!==void 0&&(d.anisotropyMap=l(n.anisotropyMap)),n.sheenColorMap!==void 0&&(d.sheenColorMap=l(n.sheenColorMap)),n.sheenRoughnessMap!==void 0&&(d.sheenRoughnessMap=l(n.sheenRoughnessMap)),d}setTextures(n){return this.textures=n,this}static createMaterialFromType(n){const s={ShadowMaterial:D3,SpriteMaterial:Eb,RawShaderMaterial:N3,ShaderMaterial:Fa,PointsMaterial:Bb,MeshPhysicalMaterial:O3,MeshStandardMaterial:zb,MeshPhongMaterial:F3,MeshToonMaterial:k3,MeshNormalMaterial:U3,MeshLambertMaterial:G3,MeshDepthMaterial:vb,MeshDistanceMaterial:bb,MeshBasicMaterial:Tc,MeshMatcapMaterial:V3,LineDashedMaterial:Q3,LineBasicMaterial:wo,Material:ao};return new s[n]}}class Zb{static decodeText(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let s="";for(let l=0,d=n.length;l<d;l++)s+=String.fromCharCode(n[l]);try{return decodeURIComponent(escape(s))}catch{return s}}static extractUrlBase(n){const s=n.lastIndexOf("/");return s===-1?"./":n.slice(0,s+1)}static resolveURL(n,s){return typeof n!="string"||n===""?"":(/^https?:\/\//i.test(s)&&/^\//.test(n)&&(s=s.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(n)||/^data:.*,.*$/i.test(n)||/^blob:.*$/i.test(n)?n:s+n)}}class ox extends Ui{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(n){return super.copy(n),this.instanceCount=n.instanceCount,this}toJSON(){const n=super.toJSON();return n.instanceCount=this.instanceCount,n.isInstancedBufferGeometry=!0,n}}class ax extends ko{constructor(n){super(n)}load(n,s,l,d){const b=this,T=new Wl(b.manager);T.setPath(b.path),T.setRequestHeader(b.requestHeader),T.setWithCredentials(b.withCredentials),T.load(n,function(B){try{s(b.parse(JSON.parse(B)))}catch(N){d?d(N):console.error(N),b.manager.itemError(n)}},l,d)}parse(n){const s={},l={};function d(ee,ie){if(s[ie]!==void 0)return s[ie];const re=ee.interleavedBuffers[ie],te=b(ee,re.buffer),we=Ec(re.type,te),ve=new R0(we,re.stride);return ve.uuid=re.uuid,s[ie]=ve,ve}function b(ee,ie){if(l[ie]!==void 0)return l[ie];const re=ee.arrayBuffers[ie],te=new Uint32Array(re).buffer;return l[ie]=te,te}const T=n.isInstancedBufferGeometry?new ox:new Ui,B=n.data.index;if(B!==void 0){const ee=Ec(B.type,B.array);T.setIndex(new Tr(ee,1))}const N=n.data.attributes;for(const ee in N){const ie=N[ee];let ce;if(ie.isInterleavedBufferAttribute){const re=d(n.data,ie.data);ce=new xu(re,ie.itemSize,ie.offset,ie.normalized)}else{const re=Ec(ie.type,ie.array),te=ie.isInstancedBufferAttribute?Xh:Tr;ce=new te(re,ie.itemSize,ie.normalized)}ie.name!==void 0&&(ce.name=ie.name),ie.usage!==void 0&&ce.setUsage(ie.usage),T.setAttribute(ee,ce)}const U=n.data.morphAttributes;if(U)for(const ee in U){const ie=U[ee],ce=[];for(let re=0,te=ie.length;re<te;re++){const we=ie[re];let ve;if(we.isInterleavedBufferAttribute){const Ae=d(n.data,we.data);ve=new xu(Ae,we.itemSize,we.offset,we.normalized)}else{const Ae=Ec(we.type,we.array);ve=new Tr(Ae,we.itemSize,we.normalized)}we.name!==void 0&&(ve.name=we.name),ce.push(ve)}T.morphAttributes[ee]=ce}n.data.morphTargetsRelative&&(T.morphTargetsRelative=!0);const X=n.data.groups||n.data.drawcalls||n.data.offsets;if(X!==void 0)for(let ee=0,ie=X.length;ee!==ie;++ee){const ce=X[ee];T.addGroup(ce.start,ce.count,ce.materialIndex)}const q=n.data.boundingSphere;if(q!==void 0){const ee=new Ge;q.center!==void 0&&ee.fromArray(q.center),T.boundingSphere=new Ts(ee,q.radius)}return n.name&&(T.name=n.name),n.userData&&(T.userData=n.userData),T}}class Pk extends ko{constructor(n){super(n)}load(n,s,l,d){const b=this,T=this.path===""?Zb.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||T;const B=new Wl(this.manager);B.setPath(this.path),B.setRequestHeader(this.requestHeader),B.setWithCredentials(this.withCredentials),B.load(n,function(N){let U=null;try{U=JSON.parse(N)}catch(X){d!==void 0&&d(X),console.error("THREE:ObjectLoader: Can't parse "+n+".",X.message);return}const z=U.metadata;if(z===void 0||z.type===void 0||z.type.toLowerCase()==="geometry"){d!==void 0&&d(new Error("THREE.ObjectLoader: Can't load "+n)),console.error("THREE.ObjectLoader: Can't load "+n);return}b.parse(U,s)},l,d)}async loadAsync(n,s){const l=this,d=this.path===""?Zb.extractUrlBase(n):this.path;this.resourcePath=this.resourcePath||d;const b=new Wl(this.manager);b.setPath(this.path),b.setRequestHeader(this.requestHeader),b.setWithCredentials(this.withCredentials);const T=await b.loadAsync(n,s),B=JSON.parse(T),N=B.metadata;if(N===void 0||N.type===void 0||N.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+n);return await l.parseAsync(B)}parse(n,s){const l=this.parseAnimations(n.animations),d=this.parseShapes(n.shapes),b=this.parseGeometries(n.geometries,d),T=this.parseImages(n.images,function(){s!==void 0&&s(U)}),B=this.parseTextures(n.textures,T),N=this.parseMaterials(n.materials,B),U=this.parseObject(n.object,b,N,B,l),z=this.parseSkeletons(n.skeletons,U);if(this.bindSkeletons(U,z),s!==void 0){let X=!1;for(const q in T)if(T[q].data instanceof HTMLImageElement){X=!0;break}X===!1&&s(U)}return U}async parseAsync(n){const s=this.parseAnimations(n.animations),l=this.parseShapes(n.shapes),d=this.parseGeometries(n.geometries,l),b=await this.parseImagesAsync(n.images),T=this.parseTextures(n.textures,b),B=this.parseMaterials(n.materials,T),N=this.parseObject(n.object,d,B,T,s),U=this.parseSkeletons(n.skeletons,N);return this.bindSkeletons(N,U),N}parseShapes(n){const s={};if(n!==void 0)for(let l=0,d=n.length;l<d;l++){const b=new Su().fromJSON(n[l]);s[b.uuid]=b}return s}parseSkeletons(n,s){const l={},d={};if(s.traverse(function(b){b.isBone&&(d[b.uuid]=b)}),n!==void 0)for(let b=0,T=n.length;b<T;b++){const B=new F0().fromJSON(n[b],d);l[B.uuid]=B}return l}parseGeometries(n,s){const l={};if(n!==void 0){const b=new ax;for(let T=0,B=n.length;T<B;T++){let N;const U=n[T];switch(U.type){case"BufferGeometry":case"InstancedBufferGeometry":N=b.parse(U);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var d=new THREE.LegacyJSONLoader;N=d.parse(U,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:U.type in P3?N=P3[U.type].fromJSON(U,s):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${U.type}"`)}N.uuid=U.uuid,U.name!==void 0&&(N.name=U.name),U.userData!==void 0&&(N.userData=U.userData),l[U.uuid]=N}}return l}parseMaterials(n,s){const l={},d={};if(n!==void 0){const b=new mA;b.setTextures(s);for(let T=0,B=n.length;T<B;T++){const N=n[T];l[N.uuid]===void 0&&(l[N.uuid]=b.parse(N)),d[N.uuid]=l[N.uuid]}}return d}parseAnimations(n){const s={};if(n!==void 0)for(let l=0;l<n.length;l++){const d=n[l],b=Hd.parse(d);s[b.uuid]=b}return s}parseImages(n,s){const l=this,d={};let b;function T(N){return l.manager.itemStart(N),b.load(N,function(){l.manager.itemEnd(N)},void 0,function(){l.manager.itemError(N),l.manager.itemEnd(N)})}function B(N){if(typeof N=="string"){const U=N,z=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(U)?U:l.resourcePath+U;return T(z)}else return N.data?{data:Ec(N.type,N.data),width:N.width,height:N.height}:null}if(n!==void 0&&n.length>0){const N=new Kb(s);b=new zd(N),b.setCrossOrigin(this.crossOrigin);for(let U=0,z=n.length;U<z;U++){const X=n[U],q=X.url;if(Array.isArray(q)){const ee=[];for(let ie=0,ce=q.length;ie<ce;ie++){const re=q[ie],te=B(re);te!==null&&(te instanceof HTMLImageElement?ee.push(te):ee.push(new Rc(te.data,te.width,te.height)))}d[X.uuid]=new Wr(ee)}else{const ee=B(X.url);d[X.uuid]=new Wr(ee)}}}return d}async parseImagesAsync(n){const s=this,l={};let d;async function b(T){if(typeof T=="string"){const B=T,N=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(B)?B:s.resourcePath+B;return await d.loadAsync(N)}else return T.data?{data:Ec(T.type,T.data),width:T.width,height:T.height}:null}if(n!==void 0&&n.length>0){d=new zd(this.manager),d.setCrossOrigin(this.crossOrigin);for(let T=0,B=n.length;T<B;T++){const N=n[T],U=N.url;if(Array.isArray(U)){const z=[];for(let X=0,q=U.length;X<q;X++){const ee=U[X],ie=await b(ee);ie!==null&&(ie instanceof HTMLImageElement?z.push(ie):z.push(new Rc(ie.data,ie.width,ie.height)))}l[N.uuid]=new Wr(z)}else{const z=await b(N.url);l[N.uuid]=new Wr(z)}}}return l}parseTextures(n,s){function l(b,T){return typeof b=="number"?b:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",b),T[b])}const d={};if(n!==void 0)for(let b=0,T=n.length;b<T;b++){const B=n[b];B.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',B.uuid),s[B.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",B.image);const N=s[B.image],U=N.data;let z;Array.isArray(U)?(z=new _d,U.length===6&&(z.needsUpdate=!0)):(U&&U.data?z=new Rc:z=new kr,U&&(z.needsUpdate=!0)),z.source=N,z.uuid=B.uuid,B.name!==void 0&&(z.name=B.name),B.mapping!==void 0&&(z.mapping=l(B.mapping,Dk)),B.channel!==void 0&&(z.channel=B.channel),B.offset!==void 0&&z.offset.fromArray(B.offset),B.repeat!==void 0&&z.repeat.fromArray(B.repeat),B.center!==void 0&&z.center.fromArray(B.center),B.rotation!==void 0&&(z.rotation=B.rotation),B.wrap!==void 0&&(z.wrapS=l(B.wrap[0],lx),z.wrapT=l(B.wrap[1],lx)),B.format!==void 0&&(z.format=B.format),B.internalFormat!==void 0&&(z.internalFormat=B.internalFormat),B.type!==void 0&&(z.type=B.type),B.colorSpace!==void 0&&(z.colorSpace=B.colorSpace),B.minFilter!==void 0&&(z.minFilter=l(B.minFilter,cx)),B.magFilter!==void 0&&(z.magFilter=l(B.magFilter,cx)),B.anisotropy!==void 0&&(z.anisotropy=B.anisotropy),B.flipY!==void 0&&(z.flipY=B.flipY),B.generateMipmaps!==void 0&&(z.generateMipmaps=B.generateMipmaps),B.premultiplyAlpha!==void 0&&(z.premultiplyAlpha=B.premultiplyAlpha),B.unpackAlignment!==void 0&&(z.unpackAlignment=B.unpackAlignment),B.compareFunction!==void 0&&(z.compareFunction=B.compareFunction),B.userData!==void 0&&(z.userData=B.userData),d[B.uuid]=z}return d}parseObject(n,s,l,d,b){let T;function B(q){return s[q]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",q),s[q]}function N(q){if(q!==void 0){if(Array.isArray(q)){const ee=[];for(let ie=0,ce=q.length;ie<ce;ie++){const re=q[ie];l[re]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",re),ee.push(l[re])}return ee}return l[q]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",q),l[q]}}function U(q){return d[q]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",q),d[q]}let z,X;switch(n.type){case"Scene":T=new zC,n.background!==void 0&&(Number.isInteger(n.background)?T.background=new Qn(n.background):T.background=U(n.background)),n.environment!==void 0&&(T.environment=U(n.environment)),n.fog!==void 0&&(n.fog.type==="Fog"?T.fog=new B0(n.fog.color,n.fog.near,n.fog.far):n.fog.type==="FogExp2"&&(T.fog=new I0(n.fog.color,n.fog.density)),n.fog.name!==""&&(T.fog.name=n.fog.name)),n.backgroundBlurriness!==void 0&&(T.backgroundBlurriness=n.backgroundBlurriness),n.backgroundIntensity!==void 0&&(T.backgroundIntensity=n.backgroundIntensity),n.backgroundRotation!==void 0&&T.backgroundRotation.fromArray(n.backgroundRotation),n.environmentIntensity!==void 0&&(T.environmentIntensity=n.environmentIntensity),n.environmentRotation!==void 0&&T.environmentRotation.fromArray(n.environmentRotation);break;case"PerspectiveCamera":T=new Bs(n.fov,n.aspect,n.near,n.far),n.focus!==void 0&&(T.focus=n.focus),n.zoom!==void 0&&(T.zoom=n.zoom),n.filmGauge!==void 0&&(T.filmGauge=n.filmGauge),n.filmOffset!==void 0&&(T.filmOffset=n.filmOffset),n.view!==void 0&&(T.view=Object.assign({},n.view));break;case"OrthographicCamera":T=new x0(n.left,n.right,n.top,n.bottom,n.near,n.far),n.zoom!==void 0&&(T.zoom=n.zoom),n.view!==void 0&&(T.view=Object.assign({},n.view));break;case"AmbientLight":T=new nx(n.color,n.intensity);break;case"DirectionalLight":T=new tx(n.color,n.intensity);break;case"PointLight":T=new ex(n.color,n.intensity,n.distance,n.decay);break;case"RectAreaLight":T=new ix(n.color,n.intensity,n.width,n.height);break;case"SpotLight":T=new J3(n.color,n.intensity,n.distance,n.angle,n.penumbra,n.decay);break;case"HemisphereLight":T=new K3(n.color,n.groundColor,n.intensity);break;case"LightProbe":T=new sx().fromJSON(n);break;case"SkinnedMesh":z=B(n.geometry),X=N(n.material),T=new n3(z,X),n.bindMode!==void 0&&(T.bindMode=n.bindMode),n.bindMatrix!==void 0&&T.bindMatrix.fromArray(n.bindMatrix),n.skeleton!==void 0&&(T.skeleton=n.skeleton);break;case"Mesh":z=B(n.geometry),X=N(n.material),T=new ws(z,X);break;case"InstancedMesh":z=B(n.geometry),X=N(n.material);const q=n.count,ee=n.instanceMatrix,ie=n.instanceColor;T=new o3(z,X,q),T.instanceMatrix=new Xh(new Float32Array(ee.array),16),ie!==void 0&&(T.instanceColor=new Xh(new Float32Array(ie.array),ie.itemSize));break;case"BatchedMesh":z=B(n.geometry),X=N(n.material),T=new c3(n.maxGeometryCount,n.maxVertexCount,n.maxIndexCount,X),T.geometry=z,T.perObjectFrustumCulled=n.perObjectFrustumCulled,T.sortObjects=n.sortObjects,T._drawRanges=n.drawRanges,T._reservedRanges=n.reservedRanges,T._visibility=n.visibility,T._active=n.active,T._bounds=n.bounds.map(ce=>{const re=new ns;re.min.fromArray(ce.boxMin),re.max.fromArray(ce.boxMax);const te=new Ts;return te.radius=ce.sphereRadius,te.center.fromArray(ce.sphereCenter),{boxInitialized:ce.boxInitialized,box:re,sphereInitialized:ce.sphereInitialized,sphere:te}}),T._maxGeometryCount=n.maxGeometryCount,T._maxVertexCount=n.maxVertexCount,T._maxIndexCount=n.maxIndexCount,T._geometryInitialized=n.geometryInitialized,T._geometryCount=n.geometryCount,T._matricesTexture=U(n.matricesTexture.uuid);break;case"LOD":T=new YC;break;case"Line":T=new Pc(B(n.geometry),N(n.material));break;case"LineLoop":T=new p3(B(n.geometry),N(n.material));break;case"LineSegments":T=new ll(B(n.geometry),N(n.material));break;case"PointCloud":case"Points":T=new A3(B(n.geometry),N(n.material));break;case"Sprite":T=new XC(N(n.material));break;case"Group":T=new wu;break;case"Bone":T=new Mb;break;default:T=new hr}if(T.uuid=n.uuid,n.name!==void 0&&(T.name=n.name),n.matrix!==void 0?(T.matrix.fromArray(n.matrix),n.matrixAutoUpdate!==void 0&&(T.matrixAutoUpdate=n.matrixAutoUpdate),T.matrixAutoUpdate&&T.matrix.decompose(T.position,T.quaternion,T.scale)):(n.position!==void 0&&T.position.fromArray(n.position),n.rotation!==void 0&&T.rotation.fromArray(n.rotation),n.quaternion!==void 0&&T.quaternion.fromArray(n.quaternion),n.scale!==void 0&&T.scale.fromArray(n.scale)),n.up!==void 0&&T.up.fromArray(n.up),n.castShadow!==void 0&&(T.castShadow=n.castShadow),n.receiveShadow!==void 0&&(T.receiveShadow=n.receiveShadow),n.shadow&&(n.shadow.bias!==void 0&&(T.shadow.bias=n.shadow.bias),n.shadow.normalBias!==void 0&&(T.shadow.normalBias=n.shadow.normalBias),n.shadow.radius!==void 0&&(T.shadow.radius=n.shadow.radius),n.shadow.mapSize!==void 0&&T.shadow.mapSize.fromArray(n.shadow.mapSize),n.shadow.camera!==void 0&&(T.shadow.camera=this.parseObject(n.shadow.camera))),n.visible!==void 0&&(T.visible=n.visible),n.frustumCulled!==void 0&&(T.frustumCulled=n.frustumCulled),n.renderOrder!==void 0&&(T.renderOrder=n.renderOrder),n.userData!==void 0&&(T.userData=n.userData),n.layers!==void 0&&(T.layers.mask=n.layers),n.children!==void 0){const q=n.children;for(let ee=0;ee<q.length;ee++)T.add(this.parseObject(q[ee],s,l,d,b))}if(n.animations!==void 0){const q=n.animations;for(let ee=0;ee<q.length;ee++){const ie=q[ee];T.animations.push(b[ie])}}if(n.type==="LOD"){n.autoUpdate!==void 0&&(T.autoUpdate=n.autoUpdate);const q=n.levels;for(let ee=0;ee<q.length;ee++){const ie=q[ee],ce=T.getObjectByProperty("uuid",ie.object);ce!==void 0&&T.addLevel(ce,ie.distance,ie.hysteresis)}}return T}bindSkeletons(n,s){Object.keys(s).length!==0&&n.traverse(function(l){if(l.isSkinnedMesh===!0&&l.skeleton!==void 0){const d=s[l.skeleton];d===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",l.skeleton):l.bind(d,l.bindMatrix)}})}}const Dk={UVMapping:Ne,CubeReflectionMapping:le,CubeRefractionMapping:j,EquirectangularReflectionMapping:Z,EquirectangularRefractionMapping:pe,CubeUVReflectionMapping:Ee},lx={RepeatWrapping:Qe,ClampToEdgeWrapping:He,MirroredRepeatWrapping:Pt},cx={NearestFilter:rn,NearestMipmapNearestFilter:Xt,NearestMipmapLinearFilter:An,LinearFilter:Dn,LinearMipmapNearestFilter:Qr,LinearMipmapLinearFilter:_r};class Nk extends ko{constructor(n){super(n),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(n){return this.options=n,this}load(n,s,l,d){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const b=this,T=zl.get(n);if(T!==void 0){if(b.manager.itemStart(n),T.then){T.then(U=>{s&&s(U),b.manager.itemEnd(n)}).catch(U=>{d&&d(U)});return}return setTimeout(function(){s&&s(T),b.manager.itemEnd(n)},0),T}const B={};B.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",B.headers=this.requestHeader;const N=fetch(n,B).then(function(U){return U.blob()}).then(function(U){return createImageBitmap(U,Object.assign(b.options,{colorSpaceConversion:"none"}))}).then(function(U){return zl.add(n,U),s&&s(U),b.manager.itemEnd(n),U}).catch(function(U){d&&d(U),zl.remove(n),b.manager.itemError(n),b.manager.itemEnd(n)});zl.add(n,N),b.manager.itemStart(n)}}let AA;class ey{static getContext(){return AA===void 0&&(AA=new(window.AudioContext||window.webkitAudioContext)),AA}static setContext(n){AA=n}}class Ok extends ko{constructor(n){super(n)}load(n,s,l,d){const b=this,T=new Wl(this.manager);T.setResponseType("arraybuffer"),T.setPath(this.path),T.setRequestHeader(this.requestHeader),T.setWithCredentials(this.withCredentials),T.load(n,function(N){try{const U=N.slice(0);ey.getContext().decodeAudioData(U,function(X){s(X)}).catch(B)}catch(U){B(U)}},l,d);function B(N){d?d(N):console.error(N),b.manager.itemError(n)}}}const ux=new Kn,hx=new Kn,Lu=new Kn;class Fk{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Bs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Bs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(n){const s=this._cache;if(s.focus!==n.focus||s.fov!==n.fov||s.aspect!==n.aspect*this.aspect||s.near!==n.near||s.far!==n.far||s.zoom!==n.zoom||s.eyeSep!==this.eyeSep){s.focus=n.focus,s.fov=n.fov,s.aspect=n.aspect*this.aspect,s.near=n.near,s.far=n.far,s.zoom=n.zoom,s.eyeSep=this.eyeSep,Lu.copy(n.projectionMatrix);const d=s.eyeSep/2,b=d*s.near/s.focus,T=s.near*Math.tan(Ol*s.fov*.5)/s.zoom;let B,N;hx.elements[12]=-d,ux.elements[12]=d,B=-T*s.aspect+b,N=T*s.aspect+b,Lu.elements[0]=2*s.near/(N-B),Lu.elements[8]=(N+B)/(N-B),this.cameraL.projectionMatrix.copy(Lu),B=-T*s.aspect-b,N=T*s.aspect-b,Lu.elements[0]=2*s.near/(N-B),Lu.elements[8]=(N+B)/(N-B),this.cameraR.projectionMatrix.copy(Lu)}this.cameraL.matrixWorld.copy(n.matrixWorld).multiply(hx),this.cameraR.matrixWorld.copy(n.matrixWorld).multiply(ux)}}class fx{constructor(n=!0){this.autoStart=n,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=dx(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let n=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const s=dx();n=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=n}return n}}function dx(){return(typeof performance>"u"?Date:performance).now()}const Pu=new Ge,px=new ur,kk=new Ge,Du=new Ge;class Uk extends hr{constructor(){super(),this.type="AudioListener",this.context=ey.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new fx}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(n){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=n,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this}updateMatrixWorld(n){super.updateMatrixWorld(n);const s=this.context.listener,l=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Pu,px,kk),Du.set(0,0,-1).applyQuaternion(px),s.positionX){const d=this.context.currentTime+this.timeDelta;s.positionX.linearRampToValueAtTime(Pu.x,d),s.positionY.linearRampToValueAtTime(Pu.y,d),s.positionZ.linearRampToValueAtTime(Pu.z,d),s.forwardX.linearRampToValueAtTime(Du.x,d),s.forwardY.linearRampToValueAtTime(Du.y,d),s.forwardZ.linearRampToValueAtTime(Du.z,d),s.upX.linearRampToValueAtTime(l.x,d),s.upY.linearRampToValueAtTime(l.y,d),s.upZ.linearRampToValueAtTime(l.z,d)}else s.setPosition(Pu.x,Pu.y,Pu.z),s.setOrientation(Du.x,Du.y,Du.z,l.x,l.y,l.z)}}class mx extends hr{constructor(n){super(),this.type="Audio",this.listener=n,this.context=n.context,this.gain=this.context.createGain(),this.gain.connect(n.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(n){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=n,this.connect(),this}setMediaElementSource(n){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(n),this.connect(),this}setMediaStreamSource(n){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(n),this.connect(),this}setBuffer(n){return this.buffer=n,this.sourceType="buffer",this.autoplay&&this.play(),this}play(n=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+n;const s=this.context.createBufferSource();return s.buffer=this.buffer,s.loop=this.loop,s.loopStart=this.loopStart,s.loopEnd=this.loopEnd,s.onended=this.onEnded.bind(this),s.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=s,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let n=1,s=this.filters.length;n<s;n++)this.filters[n-1].connect(this.filters[n]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let n=1,s=this.filters.length;n<s;n++)this.filters[n-1].disconnect(this.filters[n]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(n){return n||(n=[]),this._connected===!0?(this.disconnect(),this.filters=n.slice(),this.connect()):this.filters=n.slice(),this}setDetune(n){return this.detune=n,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(n){return this.setFilters(n?[n]:[])}setPlaybackRate(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=n,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=n,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(n){return this.loopStart=n,this}setLoopEnd(n){return this.loopEnd=n,this}getVolume(){return this.gain.gain.value}setVolume(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this}}const Nu=new Ge,Ax=new ur,Gk=new Ge,Ou=new Ge;class Vk extends mx{constructor(n){super(n),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(n){return this.panner.refDistance=n,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(n){return this.panner.rolloffFactor=n,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(n){return this.panner.distanceModel=n,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(n){return this.panner.maxDistance=n,this}setDirectionalCone(n,s,l){return this.panner.coneInnerAngle=n,this.panner.coneOuterAngle=s,this.panner.coneOuterGain=l,this}updateMatrixWorld(n){if(super.updateMatrixWorld(n),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Nu,Ax,Gk),Ou.set(0,0,1).applyQuaternion(Ax);const s=this.panner;if(s.positionX){const l=this.context.currentTime+this.listener.timeDelta;s.positionX.linearRampToValueAtTime(Nu.x,l),s.positionY.linearRampToValueAtTime(Nu.y,l),s.positionZ.linearRampToValueAtTime(Nu.z,l),s.orientationX.linearRampToValueAtTime(Ou.x,l),s.orientationY.linearRampToValueAtTime(Ou.y,l),s.orientationZ.linearRampToValueAtTime(Ou.z,l)}else s.setPosition(Nu.x,Nu.y,Nu.z),s.setOrientation(Ou.x,Ou.y,Ou.z)}}class Qk{constructor(n,s=2048){this.analyser=n.context.createAnalyser(),this.analyser.fftSize=s,this.data=new Uint8Array(this.analyser.frequencyBinCount),n.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let n=0;const s=this.getFrequencyData();for(let l=0;l<s.length;l++)n+=s[l];return n/s.length}}class gx{constructor(n,s,l){this.binding=n,this.valueSize=l;let d,b,T;switch(s){case"quaternion":d=this._slerp,b=this._slerpAdditive,T=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(l*6),this._workIndex=5;break;case"string":case"bool":d=this._select,b=this._select,T=this._setAdditiveIdentityOther,this.buffer=new Array(l*5);break;default:d=this._lerp,b=this._lerpAdditive,T=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(l*5)}this._mixBufferRegion=d,this._mixBufferRegionAdditive=b,this._setIdentity=T,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(n,s){const l=this.buffer,d=this.valueSize,b=n*d+d;let T=this.cumulativeWeight;if(T===0){for(let B=0;B!==d;++B)l[b+B]=l[B];T=s}else{T+=s;const B=s/T;this._mixBufferRegion(l,b,0,B,d)}this.cumulativeWeight=T}accumulateAdditive(n){const s=this.buffer,l=this.valueSize,d=l*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(s,d,0,n,l),this.cumulativeWeightAdditive+=n}apply(n){const s=this.valueSize,l=this.buffer,d=n*s+s,b=this.cumulativeWeight,T=this.cumulativeWeightAdditive,B=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,b<1){const N=s*this._origIndex;this._mixBufferRegion(l,d,N,1-b,s)}T>0&&this._mixBufferRegionAdditive(l,d,this._addIndex*s,1,s);for(let N=s,U=s+s;N!==U;++N)if(l[N]!==l[N+s]){B.setValue(l,d);break}}saveOriginalState(){const n=this.binding,s=this.buffer,l=this.valueSize,d=l*this._origIndex;n.getValue(s,d);for(let b=l,T=d;b!==T;++b)s[b]=s[d+b%l];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const n=this.valueSize*3;this.binding.setValue(this.buffer,n)}_setAdditiveIdentityNumeric(){const n=this._addIndex*this.valueSize,s=n+this.valueSize;for(let l=n;l<s;l++)this.buffer[l]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const n=this._origIndex*this.valueSize,s=this._addIndex*this.valueSize;for(let l=0;l<this.valueSize;l++)this.buffer[s+l]=this.buffer[n+l]}_select(n,s,l,d,b){if(d>=.5)for(let T=0;T!==b;++T)n[s+T]=n[l+T]}_slerp(n,s,l,d){ur.slerpFlat(n,s,n,s,n,l,d)}_slerpAdditive(n,s,l,d,b){const T=this._workIndex*b;ur.multiplyQuaternionsFlat(n,T,n,s,n,l),ur.slerpFlat(n,s,n,s,n,T,d)}_lerp(n,s,l,d,b){const T=1-d;for(let B=0;B!==b;++B){const N=s+B;n[N]=n[N]*T+n[l+B]*d}}_lerpAdditive(n,s,l,d,b){for(let T=0;T!==b;++T){const B=s+T;n[B]=n[B]+n[l+T]*d}}}const ty="\\[\\]\\.:\\/",Hk=new RegExp("["+ty+"]","g"),ny="[^"+ty+"]",zk="[^"+ty.replace("\\.","")+"]",jk=/((?:WC+[\/:])*)/.source.replace("WC",ny),Wk=/(WCOD+)?/.source.replace("WCOD",zk),$k=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ny),Xk=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ny),Kk=new RegExp("^"+jk+Wk+$k+Xk+"$"),Yk=["material","materials","bones","map"];class qk{constructor(n,s,l){const d=l||lr.parseTrackName(s);this._targetGroup=n,this._bindings=n.subscribe_(s,d)}getValue(n,s){this.bind();const l=this._targetGroup.nCachedObjects_,d=this._bindings[l];d!==void 0&&d.getValue(n,s)}setValue(n,s){const l=this._bindings;for(let d=this._targetGroup.nCachedObjects_,b=l.length;d!==b;++d)l[d].setValue(n,s)}bind(){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=n.length;s!==l;++s)n[s].bind()}unbind(){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=n.length;s!==l;++s)n[s].unbind()}}class lr{constructor(n,s,l){this.path=s,this.parsedPath=l||lr.parseTrackName(s),this.node=lr.findNode(n,this.parsedPath.nodeName),this.rootNode=n,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(n,s,l){return n&&n.isAnimationObjectGroup?new lr.Composite(n,s,l):new lr(n,s,l)}static sanitizeNodeName(n){return n.replace(/\s/g,"_").replace(Hk,"")}static parseTrackName(n){const s=Kk.exec(n);if(s===null)throw new Error("PropertyBinding: Cannot parse trackName: "+n);const l={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},d=l.nodeName&&l.nodeName.lastIndexOf(".");if(d!==void 0&&d!==-1){const b=l.nodeName.substring(d+1);Yk.indexOf(b)!==-1&&(l.nodeName=l.nodeName.substring(0,d),l.objectName=b)}if(l.propertyName===null||l.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+n);return l}static findNode(n,s){if(s===void 0||s===""||s==="."||s===-1||s===n.name||s===n.uuid)return n;if(n.skeleton){const l=n.skeleton.getBoneByName(s);if(l!==void 0)return l}if(n.children){const l=function(b){for(let T=0;T<b.length;T++){const B=b[T];if(B.name===s||B.uuid===s)return B;const N=l(B.children);if(N)return N}return null},d=l(n.children);if(d)return d}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(n,s){n[s]=this.targetObject[this.propertyName]}_getValue_array(n,s){const l=this.resolvedProperty;for(let d=0,b=l.length;d!==b;++d)n[s++]=l[d]}_getValue_arrayElement(n,s){n[s]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(n,s){this.resolvedProperty.toArray(n,s)}_setValue_direct(n,s){this.targetObject[this.propertyName]=n[s]}_setValue_direct_setNeedsUpdate(n,s){this.targetObject[this.propertyName]=n[s],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(n,s){this.targetObject[this.propertyName]=n[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(n,s){const l=this.resolvedProperty;for(let d=0,b=l.length;d!==b;++d)l[d]=n[s++]}_setValue_array_setNeedsUpdate(n,s){const l=this.resolvedProperty;for(let d=0,b=l.length;d!==b;++d)l[d]=n[s++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(n,s){const l=this.resolvedProperty;for(let d=0,b=l.length;d!==b;++d)l[d]=n[s++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(n,s){this.resolvedProperty[this.propertyIndex]=n[s]}_setValue_arrayElement_setNeedsUpdate(n,s){this.resolvedProperty[this.propertyIndex]=n[s],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(n,s){this.resolvedProperty[this.propertyIndex]=n[s],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(n,s){this.resolvedProperty.fromArray(n,s)}_setValue_fromArray_setNeedsUpdate(n,s){this.resolvedProperty.fromArray(n,s),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(n,s){this.resolvedProperty.fromArray(n,s),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(n,s){this.bind(),this.getValue(n,s)}_setValue_unbound(n,s){this.bind(),this.setValue(n,s)}bind(){let n=this.node;const s=this.parsedPath,l=s.objectName,d=s.propertyName;let b=s.propertyIndex;if(n||(n=lr.findNode(this.rootNode,s.nodeName),this.node=n),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!n){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(l){let U=s.objectIndex;switch(l){case"materials":if(!n.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!n.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}n=n.material.materials;break;case"bones":if(!n.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}n=n.skeleton.bones;for(let z=0;z<n.length;z++)if(n[z].name===U){U=z;break}break;case"map":if("map"in n){n=n.map;break}if(!n.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!n.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}n=n.material.map;break;default:if(n[l]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}n=n[l]}if(U!==void 0){if(n[U]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,n);return}n=n[U]}}const T=n[d];if(T===void 0){const U=s.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+U+"."+d+" but it wasn't found.",n);return}let B=this.Versioning.None;this.targetObject=n,n.needsUpdate!==void 0?B=this.Versioning.NeedsUpdate:n.matrixWorldNeedsUpdate!==void 0&&(B=this.Versioning.MatrixWorldNeedsUpdate);let N=this.BindingType.Direct;if(b!==void 0){if(d==="morphTargetInfluences"){if(!n.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!n.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}n.morphTargetDictionary[b]!==void 0&&(b=n.morphTargetDictionary[b])}N=this.BindingType.ArrayElement,this.resolvedProperty=T,this.propertyIndex=b}else T.fromArray!==void 0&&T.toArray!==void 0?(N=this.BindingType.HasFromToArray,this.resolvedProperty=T):Array.isArray(T)?(N=this.BindingType.EntireArray,this.resolvedProperty=T):this.propertyName=d;this.getValue=this.GetterByBindingType[N],this.setValue=this.SetterByBindingTypeAndVersioning[N][B]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}lr.Composite=qk,lr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},lr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},lr.prototype.GetterByBindingType=[lr.prototype._getValue_direct,lr.prototype._getValue_array,lr.prototype._getValue_arrayElement,lr.prototype._getValue_toArray],lr.prototype.SetterByBindingTypeAndVersioning=[[lr.prototype._setValue_direct,lr.prototype._setValue_direct_setNeedsUpdate,lr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[lr.prototype._setValue_array,lr.prototype._setValue_array_setNeedsUpdate,lr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[lr.prototype._setValue_arrayElement,lr.prototype._setValue_arrayElement_setNeedsUpdate,lr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[lr.prototype._setValue_fromArray,lr.prototype._setValue_fromArray_setNeedsUpdate,lr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Jk{constructor(){this.isAnimationObjectGroup=!0,this.uuid=bo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const n={};this._indicesByUUID=n;for(let l=0,d=arguments.length;l!==d;++l)n[arguments[l].uuid]=l;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const s=this;this.stats={objects:{get total(){return s._objects.length},get inUse(){return this.total-s.nCachedObjects_}},get bindingsPerObject(){return s._bindings.length}}}add(){const n=this._objects,s=this._indicesByUUID,l=this._paths,d=this._parsedPaths,b=this._bindings,T=b.length;let B,N=n.length,U=this.nCachedObjects_;for(let z=0,X=arguments.length;z!==X;++z){const q=arguments[z],ee=q.uuid;let ie=s[ee];if(ie===void 0){ie=N++,s[ee]=ie,n.push(q);for(let ce=0,re=T;ce!==re;++ce)b[ce].push(new lr(q,l[ce],d[ce]))}else if(ie<U){B=n[ie];const ce=--U,re=n[ce];s[re.uuid]=ie,n[ie]=re,s[ee]=ce,n[ce]=q;for(let te=0,we=T;te!==we;++te){const ve=b[te],Ae=ve[ce];let qe=ve[ie];ve[ie]=Ae,qe===void 0&&(qe=new lr(q,l[te],d[te])),ve[ce]=qe}}else n[ie]!==B&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=U}remove(){const n=this._objects,s=this._indicesByUUID,l=this._bindings,d=l.length;let b=this.nCachedObjects_;for(let T=0,B=arguments.length;T!==B;++T){const N=arguments[T],U=N.uuid,z=s[U];if(z!==void 0&&z>=b){const X=b++,q=n[X];s[q.uuid]=z,n[z]=q,s[U]=X,n[X]=N;for(let ee=0,ie=d;ee!==ie;++ee){const ce=l[ee],re=ce[X],te=ce[z];ce[z]=re,ce[X]=te}}}this.nCachedObjects_=b}uncache(){const n=this._objects,s=this._indicesByUUID,l=this._bindings,d=l.length;let b=this.nCachedObjects_,T=n.length;for(let B=0,N=arguments.length;B!==N;++B){const U=arguments[B],z=U.uuid,X=s[z];if(X!==void 0)if(delete s[z],X<b){const q=--b,ee=n[q],ie=--T,ce=n[ie];s[ee.uuid]=X,n[X]=ee,s[ce.uuid]=q,n[q]=ce,n.pop();for(let re=0,te=d;re!==te;++re){const we=l[re],ve=we[q],Ae=we[ie];we[X]=ve,we[q]=Ae,we.pop()}}else{const q=--T,ee=n[q];q>0&&(s[ee.uuid]=X),n[X]=ee,n.pop();for(let ie=0,ce=d;ie!==ce;++ie){const re=l[ie];re[X]=re[q],re.pop()}}}this.nCachedObjects_=b}subscribe_(n,s){const l=this._bindingsIndicesByPath;let d=l[n];const b=this._bindings;if(d!==void 0)return b[d];const T=this._paths,B=this._parsedPaths,N=this._objects,U=N.length,z=this.nCachedObjects_,X=new Array(U);d=b.length,l[n]=d,T.push(n),B.push(s),b.push(X);for(let q=z,ee=N.length;q!==ee;++q){const ie=N[q];X[q]=new lr(ie,n,s)}return X}unsubscribe_(n){const s=this._bindingsIndicesByPath,l=s[n];if(l!==void 0){const d=this._paths,b=this._parsedPaths,T=this._bindings,B=T.length-1,N=T[B],U=n[B];s[U]=l,T[l]=N,T.pop(),b[l]=b[B],b.pop(),d[l]=d[B],d.pop()}}}class vx{constructor(n,s,l=null,d=s.blendMode){this._mixer=n,this._clip=s,this._localRoot=l,this.blendMode=d;const b=s.tracks,T=b.length,B=new Array(T),N={endingStart:ts,endingEnd:ts};for(let U=0;U!==T;++U){const z=b[U].createInterpolant(null);B[U]=z,z.settings=N}this._interpolantSettings=N,this._interpolants=B,this._propertyBindings=new Array(T),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Fr,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(n){return this._startTime=n,this}setLoop(n,s){return this.loop=n,this.repetitions=s,this}setEffectiveWeight(n){return this.weight=n,this._effectiveWeight=this.enabled?n:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(n){return this._scheduleFading(n,0,1)}fadeOut(n){return this._scheduleFading(n,1,0)}crossFadeFrom(n,s,l){if(n.fadeOut(s),this.fadeIn(s),l){const d=this._clip.duration,b=n._clip.duration,T=b/d,B=d/b;n.warp(1,T,s),this.warp(B,1,s)}return this}crossFadeTo(n,s,l){return n.crossFadeFrom(this,s,l)}stopFading(){const n=this._weightInterpolant;return n!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(n)),this}setEffectiveTimeScale(n){return this.timeScale=n,this._effectiveTimeScale=this.paused?0:n,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(n){return this.timeScale=this._clip.duration/n,this.stopWarping()}syncWith(n){return this.time=n.time,this.timeScale=n.timeScale,this.stopWarping()}halt(n){return this.warp(this._effectiveTimeScale,0,n)}warp(n,s,l){const d=this._mixer,b=d.time,T=this.timeScale;let B=this._timeScaleInterpolant;B===null&&(B=d._lendControlInterpolant(),this._timeScaleInterpolant=B);const N=B.parameterPositions,U=B.sampleValues;return N[0]=b,N[1]=b+l,U[0]=n/T,U[1]=s/T,this}stopWarping(){const n=this._timeScaleInterpolant;return n!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(n)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(n,s,l,d){if(!this.enabled){this._updateWeight(n);return}const b=this._startTime;if(b!==null){const N=(n-b)*l;N<0||l===0?s=0:(this._startTime=null,s=l*N)}s*=this._updateTimeScale(n);const T=this._updateTime(s),B=this._updateWeight(n);if(B>0){const N=this._interpolants,U=this._propertyBindings;switch(this.blendMode){case Da:for(let z=0,X=N.length;z!==X;++z)N[z].evaluate(T),U[z].accumulateAdditive(B);break;case pa:default:for(let z=0,X=N.length;z!==X;++z)N[z].evaluate(T),U[z].accumulate(d,B)}}}_updateWeight(n){let s=0;if(this.enabled){s=this.weight;const l=this._weightInterpolant;if(l!==null){const d=l.evaluate(n)[0];s*=d,n>l.parameterPositions[1]&&(this.stopFading(),d===0&&(this.enabled=!1))}}return this._effectiveWeight=s,s}_updateTimeScale(n){let s=0;if(!this.paused){s=this.timeScale;const l=this._timeScaleInterpolant;if(l!==null){const d=l.evaluate(n)[0];s*=d,n>l.parameterPositions[1]&&(this.stopWarping(),s===0?this.paused=!0:this.timeScale=s)}}return this._effectiveTimeScale=s,s}_updateTime(n){const s=this._clip.duration,l=this.loop;let d=this.time+n,b=this._loopCount;const T=l===As;if(n===0)return b===-1?d:T&&(b&1)===1?s-d:d;if(l===jr){b===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(d>=s)d=s;else if(d<0)d=0;else{this.time=d;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=d,this._mixer.dispatchEvent({type:"finished",action:this,direction:n<0?-1:1})}}else{if(b===-1&&(n>=0?(b=0,this._setEndings(!0,this.repetitions===0,T)):this._setEndings(this.repetitions===0,!0,T)),d>=s||d<0){const B=Math.floor(d/s);d-=s*B,b+=Math.abs(B);const N=this.repetitions-b;if(N<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,d=n>0?s:0,this.time=d,this._mixer.dispatchEvent({type:"finished",action:this,direction:n>0?1:-1});else{if(N===1){const U=n<0;this._setEndings(U,!U,T)}else this._setEndings(!1,!1,T);this._loopCount=b,this.time=d,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:B})}}else this.time=d;if(T&&(b&1)===1)return s-d}return d}_setEndings(n,s,l){const d=this._interpolantSettings;l?(d.endingStart=Us,d.endingEnd=Us):(n?d.endingStart=this.zeroSlopeAtStart?Us:ts:d.endingStart=qo,s?d.endingEnd=this.zeroSlopeAtEnd?Us:ts:d.endingEnd=qo)}_scheduleFading(n,s,l){const d=this._mixer,b=d.time;let T=this._weightInterpolant;T===null&&(T=d._lendControlInterpolant(),this._weightInterpolant=T);const B=T.parameterPositions,N=T.sampleValues;return B[0]=b,N[0]=s,B[1]=b+n,N[1]=l,this}}const Zk=new Float32Array(1);class eU extends vo{constructor(n){super(),this._root=n,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(n,s){const l=n._localRoot||this._root,d=n._clip.tracks,b=d.length,T=n._propertyBindings,B=n._interpolants,N=l.uuid,U=this._bindingsByRootAndName;let z=U[N];z===void 0&&(z={},U[N]=z);for(let X=0;X!==b;++X){const q=d[X],ee=q.name;let ie=z[ee];if(ie!==void 0)++ie.referenceCount,T[X]=ie;else{if(ie=T[X],ie!==void 0){ie._cacheIndex===null&&(++ie.referenceCount,this._addInactiveBinding(ie,N,ee));continue}const ce=s&&s._propertyBindings[X].binding.parsedPath;ie=new gx(lr.create(l,ee,ce),q.ValueTypeName,q.getValueSize()),++ie.referenceCount,this._addInactiveBinding(ie,N,ee),T[X]=ie}B[X].resultBuffer=ie.buffer}}_activateAction(n){if(!this._isActiveAction(n)){if(n._cacheIndex===null){const l=(n._localRoot||this._root).uuid,d=n._clip.uuid,b=this._actionsByClip[d];this._bindAction(n,b&&b.knownActions[0]),this._addInactiveAction(n,d,l)}const s=n._propertyBindings;for(let l=0,d=s.length;l!==d;++l){const b=s[l];b.useCount++===0&&(this._lendBinding(b),b.saveOriginalState())}this._lendAction(n)}}_deactivateAction(n){if(this._isActiveAction(n)){const s=n._propertyBindings;for(let l=0,d=s.length;l!==d;++l){const b=s[l];--b.useCount===0&&(b.restoreOriginalState(),this._takeBackBinding(b))}this._takeBackAction(n)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const n=this;this.stats={actions:{get total(){return n._actions.length},get inUse(){return n._nActiveActions}},bindings:{get total(){return n._bindings.length},get inUse(){return n._nActiveBindings}},controlInterpolants:{get total(){return n._controlInterpolants.length},get inUse(){return n._nActiveControlInterpolants}}}}_isActiveAction(n){const s=n._cacheIndex;return s!==null&&s<this._nActiveActions}_addInactiveAction(n,s,l){const d=this._actions,b=this._actionsByClip;let T=b[s];if(T===void 0)T={knownActions:[n],actionByRoot:{}},n._byClipCacheIndex=0,b[s]=T;else{const B=T.knownActions;n._byClipCacheIndex=B.length,B.push(n)}n._cacheIndex=d.length,d.push(n),T.actionByRoot[l]=n}_removeInactiveAction(n){const s=this._actions,l=s[s.length-1],d=n._cacheIndex;l._cacheIndex=d,s[d]=l,s.pop(),n._cacheIndex=null;const b=n._clip.uuid,T=this._actionsByClip,B=T[b],N=B.knownActions,U=N[N.length-1],z=n._byClipCacheIndex;U._byClipCacheIndex=z,N[z]=U,N.pop(),n._byClipCacheIndex=null;const X=B.actionByRoot,q=(n._localRoot||this._root).uuid;delete X[q],N.length===0&&delete T[b],this._removeInactiveBindingsForAction(n)}_removeInactiveBindingsForAction(n){const s=n._propertyBindings;for(let l=0,d=s.length;l!==d;++l){const b=s[l];--b.referenceCount===0&&this._removeInactiveBinding(b)}}_lendAction(n){const s=this._actions,l=n._cacheIndex,d=this._nActiveActions++,b=s[d];n._cacheIndex=d,s[d]=n,b._cacheIndex=l,s[l]=b}_takeBackAction(n){const s=this._actions,l=n._cacheIndex,d=--this._nActiveActions,b=s[d];n._cacheIndex=d,s[d]=n,b._cacheIndex=l,s[l]=b}_addInactiveBinding(n,s,l){const d=this._bindingsByRootAndName,b=this._bindings;let T=d[s];T===void 0&&(T={},d[s]=T),T[l]=n,n._cacheIndex=b.length,b.push(n)}_removeInactiveBinding(n){const s=this._bindings,l=n.binding,d=l.rootNode.uuid,b=l.path,T=this._bindingsByRootAndName,B=T[d],N=s[s.length-1],U=n._cacheIndex;N._cacheIndex=U,s[U]=N,s.pop(),delete B[b],Object.keys(B).length===0&&delete T[d]}_lendBinding(n){const s=this._bindings,l=n._cacheIndex,d=this._nActiveBindings++,b=s[d];n._cacheIndex=d,s[d]=n,b._cacheIndex=l,s[l]=b}_takeBackBinding(n){const s=this._bindings,l=n._cacheIndex,d=--this._nActiveBindings,b=s[d];n._cacheIndex=d,s[d]=n,b._cacheIndex=l,s[l]=b}_lendControlInterpolant(){const n=this._controlInterpolants,s=this._nActiveControlInterpolants++;let l=n[s];return l===void 0&&(l=new $b(new Float32Array(2),new Float32Array(2),1,Zk),l.__cacheIndex=s,n[s]=l),l}_takeBackControlInterpolant(n){const s=this._controlInterpolants,l=n.__cacheIndex,d=--this._nActiveControlInterpolants,b=s[d];n.__cacheIndex=d,s[d]=n,b.__cacheIndex=l,s[l]=b}clipAction(n,s,l){const d=s||this._root,b=d.uuid;let T=typeof n=="string"?Hd.findByName(d,n):n;const B=T!==null?T.uuid:n,N=this._actionsByClip[B];let U=null;if(l===void 0&&(T!==null?l=T.blendMode:l=pa),N!==void 0){const X=N.actionByRoot[b];if(X!==void 0&&X.blendMode===l)return X;U=N.knownActions[0],T===null&&(T=U._clip)}if(T===null)return null;const z=new vx(this,T,s,l);return this._bindAction(z,U),this._addInactiveAction(z,B,b),z}existingAction(n,s){const l=s||this._root,d=l.uuid,b=typeof n=="string"?Hd.findByName(l,n):n,T=b?b.uuid:n,B=this._actionsByClip[T];return B!==void 0&&B.actionByRoot[d]||null}stopAllAction(){const n=this._actions,s=this._nActiveActions;for(let l=s-1;l>=0;--l)n[l].stop();return this}update(n){n*=this.timeScale;const s=this._actions,l=this._nActiveActions,d=this.time+=n,b=Math.sign(n),T=this._accuIndex^=1;for(let U=0;U!==l;++U)s[U]._update(d,n,b,T);const B=this._bindings,N=this._nActiveBindings;for(let U=0;U!==N;++U)B[U].apply(T);return this}setTime(n){this.time=0;for(let s=0;s<this._actions.length;s++)this._actions[s].time=0;return this.update(n)}getRoot(){return this._root}uncacheClip(n){const s=this._actions,l=n.uuid,d=this._actionsByClip,b=d[l];if(b!==void 0){const T=b.knownActions;for(let B=0,N=T.length;B!==N;++B){const U=T[B];this._deactivateAction(U);const z=U._cacheIndex,X=s[s.length-1];U._cacheIndex=null,U._byClipCacheIndex=null,X._cacheIndex=z,s[z]=X,s.pop(),this._removeInactiveBindingsForAction(U)}delete d[l]}}uncacheRoot(n){const s=n.uuid,l=this._actionsByClip;for(const T in l){const B=l[T].actionByRoot,N=B[s];N!==void 0&&(this._deactivateAction(N),this._removeInactiveAction(N))}const d=this._bindingsByRootAndName,b=d[s];if(b!==void 0)for(const T in b){const B=b[T];B.restoreOriginalState(),this._removeInactiveBinding(B)}}uncacheAction(n,s){const l=this.existingAction(n,s);l!==null&&(this._deactivateAction(l),this._removeInactiveAction(l))}}class iy{constructor(n){this.value=n}clone(){return new iy(this.value.clone===void 0?this.value:this.value.clone())}}let tU=0;class nU extends vo{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:tU++}),this.name="",this.usage=du,this.uniforms=[]}add(n){return this.uniforms.push(n),this}remove(n){const s=this.uniforms.indexOf(n);return s!==-1&&this.uniforms.splice(s,1),this}setName(n){return this.name=n,this}setUsage(n){return this.usage=n,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(n){this.name=n.name,this.usage=n.usage;const s=n.uniforms;this.uniforms.length=0;for(let l=0,d=s.length;l<d;l++){const b=Array.isArray(s[l])?s[l]:[s[l]];for(let T=0;T<b.length;T++)this.uniforms.push(b[T].clone())}return this}clone(){return new this.constructor().copy(this)}}class iU extends R0{constructor(n,s,l=1){super(n,s),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=l}copy(n){return super.copy(n),this.meshPerAttribute=n.meshPerAttribute,this}clone(n){const s=super.clone(n);return s.meshPerAttribute=this.meshPerAttribute,s}toJSON(n){const s=super.toJSON(n);return s.isInstancedInterleavedBuffer=!0,s.meshPerAttribute=this.meshPerAttribute,s}}class rU{constructor(n,s,l,d,b){this.isGLBufferAttribute=!0,this.name="",this.buffer=n,this.type=s,this.itemSize=l,this.elementSize=d,this.count=b,this.version=0}set needsUpdate(n){n===!0&&this.version++}setBuffer(n){return this.buffer=n,this}setType(n,s){return this.type=n,this.elementSize=s,this}setItemSize(n){return this.itemSize=n,this}setCount(n){return this.count=n,this}}const bx=new Kn;class sU{constructor(n,s,l=0,d=1/0){this.ray=new Is(n,s),this.near=l,this.far=d,this.camera=null,this.layers=new u0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(n,s){this.ray.set(n,s)}setFromCamera(n,s){s.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(s.matrixWorld),this.ray.direction.set(n.x,n.y,.5).unproject(s).sub(this.ray.origin).normalize(),this.camera=s):s.isOrthographicCamera?(this.ray.origin.set(n.x,n.y,(s.near+s.far)/(s.near-s.far)).unproject(s),this.ray.direction.set(0,0,-1).transformDirection(s.matrixWorld),this.camera=s):console.error("THREE.Raycaster: Unsupported camera type: "+s.type)}setFromXRController(n){return bx.identity().extractRotation(n.matrixWorld),this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(bx),this}intersectObject(n,s=!0,l=[]){return ry(n,this,l,s),l.sort(yx),l}intersectObjects(n,s=!0,l=[]){for(let d=0,b=n.length;d<b;d++)ry(n[d],this,l,s);return l.sort(yx),l}}function yx(_,n){return _.distance-n.distance}function ry(_,n,s,l){if(_.layers.test(n.layers)&&_.raycast(n,s),l===!0){const d=_.children;for(let b=0,T=d.length;b<T;b++)ry(d[b],n,s,!0)}}class oU{constructor(n=1,s=0,l=0){return this.radius=n,this.phi=s,this.theta=l,this}set(n,s,l){return this.radius=n,this.phi=s,this.theta=l,this}copy(n){return this.radius=n.radius,this.phi=n.phi,this.theta=n.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(n){return this.setFromCartesianCoords(n.x,n.y,n.z)}setFromCartesianCoords(n,s,l){return this.radius=Math.sqrt(n*n+s*s+l*l),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(n,l),this.phi=Math.acos(Kr(s/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class aU{constructor(n=1,s=0,l=0){return this.radius=n,this.theta=s,this.y=l,this}set(n,s,l){return this.radius=n,this.theta=s,this.y=l,this}copy(n){return this.radius=n.radius,this.theta=n.theta,this.y=n.y,this}setFromVector3(n){return this.setFromCartesianCoords(n.x,n.y,n.z)}setFromCartesianCoords(n,s,l){return this.radius=Math.sqrt(n*n+l*l),this.theta=Math.atan2(n,l),this.y=s,this}clone(){return new this.constructor().copy(this)}}const _x=new Jt;class lU{constructor(n=new Jt(1/0,1/0),s=new Jt(-1/0,-1/0)){this.isBox2=!0,this.min=n,this.max=s}set(n,s){return this.min.copy(n),this.max.copy(s),this}setFromPoints(n){this.makeEmpty();for(let s=0,l=n.length;s<l;s++)this.expandByPoint(n[s]);return this}setFromCenterAndSize(n,s){const l=_x.copy(s).multiplyScalar(.5);return this.min.copy(n).sub(l),this.max.copy(n).add(l),this}clone(){return new this.constructor().copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(n){return this.isEmpty()?n.set(0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}containsPoint(n){return!(n.x<this.min.x||n.x>this.max.x||n.y<this.min.y||n.y>this.max.y)}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y}getParameter(n,s){return s.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(n){return!(n.max.x<this.min.x||n.min.x>this.max.x||n.max.y<this.min.y||n.min.y>this.max.y)}clampPoint(n,s){return s.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return this.clampPoint(n,_x).distanceTo(n)}intersect(n){return this.min.max(n.min),this.max.min(n.max),this.isEmpty()&&this.makeEmpty(),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}}const Ex=new Ge,gA=new Ge;class cU{constructor(n=new Ge,s=new Ge){this.start=n,this.end=s}set(n,s){return this.start.copy(n),this.end.copy(s),this}copy(n){return this.start.copy(n.start),this.end.copy(n.end),this}getCenter(n){return n.addVectors(this.start,this.end).multiplyScalar(.5)}delta(n){return n.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(n,s){return this.delta(s).multiplyScalar(n).add(this.start)}closestPointToPointParameter(n,s){Ex.subVectors(n,this.start),gA.subVectors(this.end,this.start);const l=gA.dot(gA);let b=gA.dot(Ex)/l;return s&&(b=Kr(b,0,1)),b}closestPointToPoint(n,s,l){const d=this.closestPointToPointParameter(n,s);return this.delta(l).multiplyScalar(d).add(this.start)}applyMatrix4(n){return this.start.applyMatrix4(n),this.end.applyMatrix4(n),this}equals(n){return n.start.equals(this.start)&&n.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const wx=new Ge;class uU extends hr{constructor(n,s){super(),this.light=n,this.matrixAutoUpdate=!1,this.color=s,this.type="SpotLightHelper";const l=new Ui,d=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let T=0,B=1,N=32;T<N;T++,B++){const U=T/N*Math.PI*2,z=B/N*Math.PI*2;d.push(Math.cos(U),Math.sin(U),1,Math.cos(z),Math.sin(z),1)}l.setAttribute("position",new ei(d,3));const b=new wo({fog:!1,toneMapped:!1});this.cone=new ll(l,b),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const n=this.light.distance?this.light.distance:1e3,s=n*Math.tan(this.light.angle);this.cone.scale.set(s,s,n),wx.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(wx),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Oc=new Ge,vA=new Kn,sy=new Kn;class hU extends ll{constructor(n){const s=Cx(n),l=new Ui,d=[],b=[],T=new Qn(0,0,1),B=new Qn(0,1,0);for(let U=0;U<s.length;U++){const z=s[U];z.parent&&z.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),b.push(T.r,T.g,T.b),b.push(B.r,B.g,B.b))}l.setAttribute("position",new ei(d,3)),l.setAttribute("color",new ei(b,3));const N=new wo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(l,N),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=n,this.bones=s,this.matrix=n.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(n){const s=this.bones,l=this.geometry,d=l.getAttribute("position");sy.copy(this.root.matrixWorld).invert();for(let b=0,T=0;b<s.length;b++){const B=s[b];B.parent&&B.parent.isBone&&(vA.multiplyMatrices(sy,B.matrixWorld),Oc.setFromMatrixPosition(vA),d.setXYZ(T,Oc.x,Oc.y,Oc.z),vA.multiplyMatrices(sy,B.parent.matrixWorld),Oc.setFromMatrixPosition(vA),d.setXYZ(T+1,Oc.x,Oc.y,Oc.z),T+=2)}l.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(n)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Cx(_){const n=[];_.isBone===!0&&n.push(_);for(let s=0;s<_.children.length;s++)n.push.apply(n,Cx(_.children[s]));return n}class fU extends ws{constructor(n,s,l){const d=new Ud(s,4,2),b=new Tc({wireframe:!0,fog:!1,toneMapped:!1});super(d,b),this.light=n,this.color=l,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const dU=new Ge,xx=new Qn,Mx=new Qn;class pU extends hr{constructor(n,s,l){super(),this.light=n,this.matrix=n.matrixWorld,this.matrixAutoUpdate=!1,this.color=l,this.type="HemisphereLightHelper";const d=new kd(s);d.rotateY(Math.PI*.5),this.material=new Tc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const b=d.getAttribute("position"),T=new Float32Array(b.count*3);d.setAttribute("color",new Tr(T,3)),this.add(new ws(d,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const n=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const s=n.geometry.getAttribute("color");xx.copy(this.light.color),Mx.copy(this.light.groundColor);for(let l=0,d=s.count;l<d;l++){const b=l<d/2?xx:Mx;s.setXYZ(l,b.r,b.g,b.b)}s.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),n.lookAt(dU.setFromMatrixPosition(this.light.matrixWorld).negate())}}class mU extends ll{constructor(n=10,s=10,l=4473924,d=8947848){l=new Qn(l),d=new Qn(d);const b=s/2,T=n/s,B=n/2,N=[],U=[];for(let q=0,ee=0,ie=-B;q<=s;q++,ie+=T){N.push(-B,0,ie,B,0,ie),N.push(ie,0,-B,ie,0,B);const ce=q===b?l:d;ce.toArray(U,ee),ee+=3,ce.toArray(U,ee),ee+=3,ce.toArray(U,ee),ee+=3,ce.toArray(U,ee),ee+=3}const z=new Ui;z.setAttribute("position",new ei(N,3)),z.setAttribute("color",new ei(U,3));const X=new wo({vertexColors:!0,toneMapped:!1});super(z,X),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class AU extends ll{constructor(n=10,s=16,l=8,d=64,b=4473924,T=8947848){b=new Qn(b),T=new Qn(T);const B=[],N=[];if(s>1)for(let X=0;X<s;X++){const q=X/s*(Math.PI*2),ee=Math.sin(q)*n,ie=Math.cos(q)*n;B.push(0,0,0),B.push(ee,0,ie);const ce=X&1?b:T;N.push(ce.r,ce.g,ce.b),N.push(ce.r,ce.g,ce.b)}for(let X=0;X<l;X++){const q=X&1?b:T,ee=n-n/l*X;for(let ie=0;ie<d;ie++){let ce=ie/d*(Math.PI*2),re=Math.sin(ce)*ee,te=Math.cos(ce)*ee;B.push(re,0,te),N.push(q.r,q.g,q.b),ce=(ie+1)/d*(Math.PI*2),re=Math.sin(ce)*ee,te=Math.cos(ce)*ee,B.push(re,0,te),N.push(q.r,q.g,q.b)}}const U=new Ui;U.setAttribute("position",new ei(B,3)),U.setAttribute("color",new ei(N,3));const z=new wo({vertexColors:!0,toneMapped:!1});super(U,z),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const Sx=new Ge,bA=new Ge,Tx=new Ge;class gU extends hr{constructor(n,s,l){super(),this.light=n,this.matrix=n.matrixWorld,this.matrixAutoUpdate=!1,this.color=l,this.type="DirectionalLightHelper",s===void 0&&(s=1);let d=new Ui;d.setAttribute("position",new ei([-s,s,0,s,s,0,s,-s,0,-s,-s,0,-s,s,0],3));const b=new wo({fog:!1,toneMapped:!1});this.lightPlane=new Pc(d,b),this.add(this.lightPlane),d=new Ui,d.setAttribute("position",new ei([0,0,0,0,0,1],3)),this.targetLine=new Pc(d,b),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Sx.setFromMatrixPosition(this.light.matrixWorld),bA.setFromMatrixPosition(this.light.target.matrixWorld),Tx.subVectors(bA,Sx),this.lightPlane.lookAt(bA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bA),this.targetLine.scale.z=Tx.length()}}const yA=new Ge,as=new E0;class vU extends ll{constructor(n){const s=new Ui,l=new wo({color:16777215,vertexColors:!0,toneMapped:!1}),d=[],b=[],T={};B("n1","n2"),B("n2","n4"),B("n4","n3"),B("n3","n1"),B("f1","f2"),B("f2","f4"),B("f4","f3"),B("f3","f1"),B("n1","f1"),B("n2","f2"),B("n3","f3"),B("n4","f4"),B("p","n1"),B("p","n2"),B("p","n3"),B("p","n4"),B("u1","u2"),B("u2","u3"),B("u3","u1"),B("c","t"),B("p","c"),B("cn1","cn2"),B("cn3","cn4"),B("cf1","cf2"),B("cf3","cf4");function B(ie,ce){N(ie),N(ce)}function N(ie){d.push(0,0,0),b.push(0,0,0),T[ie]===void 0&&(T[ie]=[]),T[ie].push(d.length/3-1)}s.setAttribute("position",new ei(d,3)),s.setAttribute("color",new ei(b,3)),super(s,l),this.type="CameraHelper",this.camera=n,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=n.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=T,this.update();const U=new Qn(16755200),z=new Qn(16711680),X=new Qn(43775),q=new Qn(16777215),ee=new Qn(3355443);this.setColors(U,z,X,q,ee)}setColors(n,s,l,d,b){const B=this.geometry.getAttribute("color");B.setXYZ(0,n.r,n.g,n.b),B.setXYZ(1,n.r,n.g,n.b),B.setXYZ(2,n.r,n.g,n.b),B.setXYZ(3,n.r,n.g,n.b),B.setXYZ(4,n.r,n.g,n.b),B.setXYZ(5,n.r,n.g,n.b),B.setXYZ(6,n.r,n.g,n.b),B.setXYZ(7,n.r,n.g,n.b),B.setXYZ(8,n.r,n.g,n.b),B.setXYZ(9,n.r,n.g,n.b),B.setXYZ(10,n.r,n.g,n.b),B.setXYZ(11,n.r,n.g,n.b),B.setXYZ(12,n.r,n.g,n.b),B.setXYZ(13,n.r,n.g,n.b),B.setXYZ(14,n.r,n.g,n.b),B.setXYZ(15,n.r,n.g,n.b),B.setXYZ(16,n.r,n.g,n.b),B.setXYZ(17,n.r,n.g,n.b),B.setXYZ(18,n.r,n.g,n.b),B.setXYZ(19,n.r,n.g,n.b),B.setXYZ(20,n.r,n.g,n.b),B.setXYZ(21,n.r,n.g,n.b),B.setXYZ(22,n.r,n.g,n.b),B.setXYZ(23,n.r,n.g,n.b),B.setXYZ(24,s.r,s.g,s.b),B.setXYZ(25,s.r,s.g,s.b),B.setXYZ(26,s.r,s.g,s.b),B.setXYZ(27,s.r,s.g,s.b),B.setXYZ(28,s.r,s.g,s.b),B.setXYZ(29,s.r,s.g,s.b),B.setXYZ(30,s.r,s.g,s.b),B.setXYZ(31,s.r,s.g,s.b),B.setXYZ(32,l.r,l.g,l.b),B.setXYZ(33,l.r,l.g,l.b),B.setXYZ(34,l.r,l.g,l.b),B.setXYZ(35,l.r,l.g,l.b),B.setXYZ(36,l.r,l.g,l.b),B.setXYZ(37,l.r,l.g,l.b),B.setXYZ(38,d.r,d.g,d.b),B.setXYZ(39,d.r,d.g,d.b),B.setXYZ(40,b.r,b.g,b.b),B.setXYZ(41,b.r,b.g,b.b),B.setXYZ(42,b.r,b.g,b.b),B.setXYZ(43,b.r,b.g,b.b),B.setXYZ(44,b.r,b.g,b.b),B.setXYZ(45,b.r,b.g,b.b),B.setXYZ(46,b.r,b.g,b.b),B.setXYZ(47,b.r,b.g,b.b),B.setXYZ(48,b.r,b.g,b.b),B.setXYZ(49,b.r,b.g,b.b),B.needsUpdate=!0}update(){const n=this.geometry,s=this.pointMap,l=1,d=1;as.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),bs("c",s,n,as,0,0,-1),bs("t",s,n,as,0,0,1),bs("n1",s,n,as,-l,-d,-1),bs("n2",s,n,as,l,-d,-1),bs("n3",s,n,as,-l,d,-1),bs("n4",s,n,as,l,d,-1),bs("f1",s,n,as,-l,-d,1),bs("f2",s,n,as,l,-d,1),bs("f3",s,n,as,-l,d,1),bs("f4",s,n,as,l,d,1),bs("u1",s,n,as,l*.7,d*1.1,-1),bs("u2",s,n,as,-l*.7,d*1.1,-1),bs("u3",s,n,as,0,d*2,-1),bs("cf1",s,n,as,-l,0,1),bs("cf2",s,n,as,l,0,1),bs("cf3",s,n,as,0,-d,1),bs("cf4",s,n,as,0,d,1),bs("cn1",s,n,as,-l,0,-1),bs("cn2",s,n,as,l,0,-1),bs("cn3",s,n,as,0,-d,-1),bs("cn4",s,n,as,0,d,-1),n.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function bs(_,n,s,l,d,b,T){yA.set(d,b,T).unproject(l);const B=n[_];if(B!==void 0){const N=s.getAttribute("position");for(let U=0,z=B.length;U<z;U++)N.setXYZ(B[U],yA.x,yA.y,yA.z)}}const _A=new ns;class bU extends ll{constructor(n,s=16776960){const l=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(8*3),b=new Ui;b.setIndex(new Tr(l,1)),b.setAttribute("position",new Tr(d,3)),super(b,new wo({color:s,toneMapped:!1})),this.object=n,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(n){if(n!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_A.setFromObject(this.object),_A.isEmpty())return;const s=_A.min,l=_A.max,d=this.geometry.attributes.position,b=d.array;b[0]=l.x,b[1]=l.y,b[2]=l.z,b[3]=s.x,b[4]=l.y,b[5]=l.z,b[6]=s.x,b[7]=s.y,b[8]=l.z,b[9]=l.x,b[10]=s.y,b[11]=l.z,b[12]=l.x,b[13]=l.y,b[14]=s.z,b[15]=s.x,b[16]=l.y,b[17]=s.z,b[18]=s.x,b[19]=s.y,b[20]=s.z,b[21]=l.x,b[22]=s.y,b[23]=s.z,d.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(n){return this.object=n,this.update(),this}copy(n,s){return super.copy(n,s),this.object=n.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class yU extends ll{constructor(n,s=16776960){const l=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],b=new Ui;b.setIndex(new Tr(l,1)),b.setAttribute("position",new ei(d,3)),super(b,new wo({color:s,toneMapped:!1})),this.box=n,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(n){const s=this.box;s.isEmpty()||(s.getCenter(this.position),s.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(n))}dispose(){this.geometry.dispose(),this.material.dispose()}}class _U extends Pc{constructor(n,s=1,l=16776960){const d=l,b=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],T=new Ui;T.setAttribute("position",new ei(b,3)),T.computeBoundingSphere(),super(T,new wo({color:d,toneMapped:!1})),this.type="PlaneHelper",this.plane=n,this.size=s;const B=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],N=new Ui;N.setAttribute("position",new ei(B,3)),N.computeBoundingSphere(),this.add(new ws(N,new Tc({color:d,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(n){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(n)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Ix=new Ge;let EA,oy;class EU extends hr{constructor(n=new Ge(0,0,1),s=new Ge(0,0,0),l=1,d=16776960,b=l*.2,T=b*.2){super(),this.type="ArrowHelper",EA===void 0&&(EA=new Ui,EA.setAttribute("position",new ei([0,0,0,0,1,0],3)),oy=new qh(0,.5,1,5,1),oy.translate(0,-.5,0)),this.position.copy(s),this.line=new Pc(EA,new wo({color:d,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ws(oy,new Tc({color:d,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(l,b,T)}setDirection(n){if(n.y>.99999)this.quaternion.set(0,0,0,1);else if(n.y<-.99999)this.quaternion.set(1,0,0,0);else{Ix.set(n.z,0,-n.x).normalize();const s=Math.acos(n.y);this.quaternion.setFromAxisAngle(Ix,s)}}setLength(n,s=n*.2,l=s*.2){this.line.scale.set(1,Math.max(1e-4,n-s),1),this.line.updateMatrix(),this.cone.scale.set(l,s,l),this.cone.position.y=n,this.cone.updateMatrix()}setColor(n){this.line.material.color.set(n),this.cone.material.color.set(n)}copy(n){return super.copy(n,!1),this.line.copy(n.line),this.cone.copy(n.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class wU extends ll{constructor(n=1){const s=[0,0,0,n,0,0,0,0,0,0,n,0,0,0,0,0,0,n],l=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],d=new Ui;d.setAttribute("position",new ei(s,3)),d.setAttribute("color",new ei(l,3));const b=new wo({vertexColors:!0,toneMapped:!1});super(d,b),this.type="AxesHelper"}setColors(n,s,l){const d=new Qn,b=this.geometry.attributes.color.array;return d.set(n),d.toArray(b,0),d.toArray(b,3),d.set(s),d.toArray(b,6),d.toArray(b,9),d.set(l),d.toArray(b,12),d.toArray(b,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class CU{constructor(){this.type="ShapePath",this.color=new Qn,this.subPaths=[],this.currentPath=null}moveTo(n,s){return this.currentPath=new Pd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(n,s),this}lineTo(n,s){return this.currentPath.lineTo(n,s),this}quadraticCurveTo(n,s,l,d){return this.currentPath.quadraticCurveTo(n,s,l,d),this}bezierCurveTo(n,s,l,d,b,T){return this.currentPath.bezierCurveTo(n,s,l,d,b,T),this}splineThru(n){return this.currentPath.splineThru(n),this}toShapes(n){function s(te){const we=[];for(let ve=0,Ae=te.length;ve<Ae;ve++){const qe=te[ve],Ve=new Su;Ve.curves=qe.curves,we.push(Ve)}return we}function l(te,we){const ve=we.length;let Ae=!1;for(let qe=ve-1,Ve=0;Ve<ve;qe=Ve++){let ze=we[qe],Ke=we[Ve],De=Ke.x-ze.x,Ie=Ke.y-ze.y;if(Math.abs(Ie)>Number.EPSILON){if(Ie<0&&(ze=we[Ve],De=-De,Ke=we[qe],Ie=-Ie),te.y<ze.y||te.y>Ke.y)continue;if(te.y===ze.y){if(te.x===ze.x)return!0}else{const Ye=Ie*(te.x-ze.x)-De*(te.y-ze.y);if(Ye===0)return!0;if(Ye<0)continue;Ae=!Ae}}else{if(te.y!==ze.y)continue;if(Ke.x<=te.x&&te.x<=ze.x||ze.x<=te.x&&te.x<=Ke.x)return!0}}return Ae}const d=cl.isClockWise,b=this.subPaths;if(b.length===0)return[];let T,B,N;const U=[];if(b.length===1)return B=b[0],N=new Su,N.curves=B.curves,U.push(N),U;let z=!d(b[0].getPoints());z=n?!z:z;const X=[],q=[];let ee=[],ie=0,ce;q[ie]=void 0,ee[ie]=[];for(let te=0,we=b.length;te<we;te++)B=b[te],ce=B.getPoints(),T=d(ce),T=n?!T:T,T?(!z&&q[ie]&&ie++,q[ie]={s:new Su,p:ce},q[ie].s.curves=B.curves,z&&ie++,ee[ie]=[]):ee[ie].push({h:B,p:ce[0]});if(!q[0])return s(b);if(q.length>1){let te=!1,we=0;for(let ve=0,Ae=q.length;ve<Ae;ve++)X[ve]=[];for(let ve=0,Ae=q.length;ve<Ae;ve++){const qe=ee[ve];for(let Ve=0;Ve<qe.length;Ve++){const ze=qe[Ve];let Ke=!0;for(let De=0;De<q.length;De++)l(ze.p,q[De].p)&&(ve!==De&&we++,Ke?(Ke=!1,X[De].push(ze)):te=!0);Ke&&X[ve].push(ze)}}we>0&&te===!1&&(ee=X)}let re;for(let te=0,we=q.length;te<we;te++){N=q[te].s,U.push(N),re=ee[te];for(let ve=0,Ae=re.length;ve<Ae;ve++)N.holes.push(re[ve].h)}return U}}class xU extends Do{constructor(n=1,s=1,l=1,d={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(n,s,{...d,count:l}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:f}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=f)},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(u,p,c)=>{c.r(p),c.d(p,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>kn,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>At,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>yt,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>Tt,KHR_DF_CHANNEL_RGBSDA_RED:()=>Ct,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>pn,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>k,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>R,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>y,KHR_DF_MODEL_ASTC:()=>I,KHR_DF_MODEL_ETC1:()=>w,KHR_DF_MODEL_ETC1S:()=>L,KHR_DF_MODEL_ETC2:()=>S,KHR_DF_MODEL_RGBSDA:()=>M,KHR_DF_MODEL_UNSPECIFIED:()=>x,KHR_DF_PRIMARIES_ACES:()=>vt,KHR_DF_PRIMARIES_ACESCC:()=>ft,KHR_DF_PRIMARIES_ADOBERGB:()=>ct,KHR_DF_PRIMARIES_BT2020:()=>rt,KHR_DF_PRIMARIES_BT601_EBU:()=>je,KHR_DF_PRIMARIES_BT601_SMPTE:()=>Te,KHR_DF_PRIMARIES_BT709:()=>be,KHR_DF_PRIMARIES_CIEXYZ:()=>mt,KHR_DF_PRIMARIES_DISPLAYP3:()=>$t,KHR_DF_PRIMARIES_NTSC1953:()=>Ze,KHR_DF_PRIMARIES_PAL525:()=>St,KHR_DF_PRIMARIES_UNSPECIFIED:()=>Le,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>bt,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>qn,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>ye,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>Gt,KHR_DF_TRANSFER_ACESCC:()=>de,KHR_DF_TRANSFER_ACESCCT:()=>Pe,KHR_DF_TRANSFER_ADOBERGB:()=>Se,KHR_DF_TRANSFER_BT1886:()=>Y,KHR_DF_TRANSFER_DCIP3:()=>se,KHR_DF_TRANSFER_HLG_EOTF:()=>G,KHR_DF_TRANSFER_HLG_OETF:()=>Q,KHR_DF_TRANSFER_ITU:()=>W,KHR_DF_TRANSFER_LINEAR:()=>F,KHR_DF_TRANSFER_NTSC:()=>V,KHR_DF_TRANSFER_PAL625_EOTF:()=>he,KHR_DF_TRANSFER_PAL_OETF:()=>ue,KHR_DF_TRANSFER_PQ_EOTF:()=>J,KHR_DF_TRANSFER_PQ_OETF:()=>K,KHR_DF_TRANSFER_SLOG:()=>$,KHR_DF_TRANSFER_SLOG2:()=>H,KHR_DF_TRANSFER_SRGB:()=>O,KHR_DF_TRANSFER_ST240:()=>Me,KHR_DF_TRANSFER_UNSPECIFIED:()=>P,KHR_DF_VENDORID_KHRONOS:()=>C,KHR_DF_VERSION:()=>E,KHR_SUPERCOMPRESSION_BASISLZ:()=>m,KHR_SUPERCOMPRESSION_NONE:()=>g,KHR_SUPERCOMPRESSION_ZLIB:()=>A,KHR_SUPERCOMPRESSION_ZSTD:()=>v,KTX2Container:()=>Fl,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>pe,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>Zn,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Bn,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>zt,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>jn,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>an,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>gt,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>Ht,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>Rt,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>md,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>wc,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>_h,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>Kr,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>bo,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>r0,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>vo,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>pu,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>s0,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>e0,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>Gs,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>o0,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>_c,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Ol,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>Kv,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>Rv,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>dd,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>gr,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>mu,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>Lv,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>_i,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>qm,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>Ym,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>pd,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>Zm,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>Jm,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>t0,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>Ev,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>du,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>Xv,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>Cv,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>wv,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>Ec,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>Mv,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>xv,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>Au,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>Tv,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>Sv,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>n0,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>Bv,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>Iv,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>i0,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>ma,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>fd,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>Pl,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>Fv,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>Qv,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>Ce,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>Z,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>le,VK_FORMAT_B8G8R8A8_SINT:()=>We,VK_FORMAT_B8G8R8A8_SNORM:()=>nl,VK_FORMAT_B8G8R8A8_SRGB:()=>ot,VK_FORMAT_B8G8R8A8_UINT:()=>Oe,VK_FORMAT_B8G8R8A8_UNORM:()=>yc,VK_FORMAT_B8G8R8_SINT:()=>da,VK_FORMAT_B8G8R8_SNORM:()=>ds,VK_FORMAT_B8G8R8_SRGB:()=>Js,VK_FORMAT_B8G8R8_UINT:()=>go,VK_FORMAT_B8G8R8_UNORM:()=>fa,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>Rr,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>uu,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>cu,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>yh,VK_FORMAT_BC2_SRGB_BLOCK:()=>fu,VK_FORMAT_BC2_UNORM_BLOCK:()=>hu,VK_FORMAT_BC3_SRGB_BLOCK:()=>Nl,VK_FORMAT_BC3_UNORM_BLOCK:()=>lv,VK_FORMAT_BC4_SNORM_BLOCK:()=>uv,VK_FORMAT_BC4_UNORM_BLOCK:()=>cv,VK_FORMAT_BC5_SNORM_BLOCK:()=>fv,VK_FORMAT_BC5_UNORM_BLOCK:()=>hv,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>pv,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>dv,VK_FORMAT_BC7_SRGB_BLOCK:()=>Av,VK_FORMAT_BC7_UNORM_BLOCK:()=>mv,VK_FORMAT_D16_UNORM:()=>il,VK_FORMAT_D16_UNORM_S8_UINT:()=>Zs,VK_FORMAT_D24_UNORM_S8_UINT:()=>rr,VK_FORMAT_D32_SFLOAT:()=>ro,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>Na,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Dl,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>hd,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>Km,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>Xm,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>$m,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>yv,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>bv,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>ud,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>_v,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>vv,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>gv,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>Ov,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>Vv,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>eo,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>Hv,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Ci,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>zv,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>$v,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>jv,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>Jt,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>Wv,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>Nv,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>Dv,VK_FORMAT_R10X6_UNORM_PACK16:()=>Pv,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>Gv,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>Uv,VK_FORMAT_R12X4_UNORM_PACK16:()=>kv,VK_FORMAT_R16G16B16A16_SFLOAT:()=>qt,VK_FORMAT_R16G16B16A16_SINT:()=>nt,VK_FORMAT_R16G16B16A16_SNORM:()=>Fe,VK_FORMAT_R16G16B16A16_UINT:()=>Je,VK_FORMAT_R16G16B16A16_UNORM:()=>xe,VK_FORMAT_R16G16B16_SFLOAT:()=>me,VK_FORMAT_R16G16B16_SINT:()=>ae,VK_FORMAT_R16G16B16_SNORM:()=>Zi,VK_FORMAT_R16G16B16_UINT:()=>ne,VK_FORMAT_R16G16B16_UNORM:()=>es,VK_FORMAT_R16G16_SFLOAT:()=>Ii,VK_FORMAT_R16G16_SINT:()=>Rn,VK_FORMAT_R16G16_SNORM:()=>Or,VK_FORMAT_R16G16_UINT:()=>ms,VK_FORMAT_R16G16_UNORM:()=>Wi,VK_FORMAT_R16_SFLOAT:()=>bi,VK_FORMAT_R16_SINT:()=>Ti,VK_FORMAT_R16_SNORM:()=>hi,VK_FORMAT_R16_UINT:()=>wr,VK_FORMAT_R16_UNORM:()=>oi,VK_FORMAT_R32G32B32A32_SFLOAT:()=>Cr,VK_FORMAT_R32G32B32A32_SINT:()=>ir,VK_FORMAT_R32G32B32A32_UINT:()=>ui,VK_FORMAT_R32G32B32_SFLOAT:()=>Ai,VK_FORMAT_R32G32B32_SINT:()=>wi,VK_FORMAT_R32G32B32_UINT:()=>ai,VK_FORMAT_R32G32_SFLOAT:()=>$n,VK_FORMAT_R32G32_SINT:()=>Nn,VK_FORMAT_R32G32_UINT:()=>on,VK_FORMAT_R32_SFLOAT:()=>Lt,VK_FORMAT_R32_SINT:()=>dt,VK_FORMAT_R32_UINT:()=>Kt,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>Re,VK_FORMAT_R4G4_UNORM_PACK8:()=>Ue,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>j,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>Ne,VK_FORMAT_R64G64B64A64_SFLOAT:()=>Ll,VK_FORMAT_R64G64B64A64_SINT:()=>Da,VK_FORMAT_R64G64B64A64_UINT:()=>pa,VK_FORMAT_R64G64B64_SFLOAT:()=>qo,VK_FORMAT_R64G64B64_SINT:()=>Us,VK_FORMAT_R64G64B64_UINT:()=>ts,VK_FORMAT_R64G64_SFLOAT:()=>_s,VK_FORMAT_R64G64_SINT:()=>vs,VK_FORMAT_R64G64_UINT:()=>gs,VK_FORMAT_R64_SFLOAT:()=>As,VK_FORMAT_R64_SINT:()=>Fr,VK_FORMAT_R64_UINT:()=>jr,VK_FORMAT_R8G8B8A8_SINT:()=>Rl,VK_FORMAT_R8G8B8A8_SNORM:()=>Er,VK_FORMAT_R8G8B8A8_SRGB:()=>Yo,VK_FORMAT_R8G8B8A8_UINT:()=>ps,VK_FORMAT_R8G8B8A8_UNORM:()=>zr,VK_FORMAT_R8G8B8_SINT:()=>Po,VK_FORMAT_R8G8B8_SNORM:()=>nr,VK_FORMAT_R8G8B8_SRGB:()=>Hr,VK_FORMAT_R8G8B8_UINT:()=>_r,VK_FORMAT_R8G8B8_UNORM:()=>Qr,VK_FORMAT_R8G8_SINT:()=>Vt,VK_FORMAT_R8G8_SNORM:()=>st,VK_FORMAT_R8G8_SRGB:()=>Dn,VK_FORMAT_R8G8_UINT:()=>An,VK_FORMAT_R8G8_UNORM:()=>Xt,VK_FORMAT_R8_SINT:()=>Pt,VK_FORMAT_R8_SNORM:()=>Qe,VK_FORMAT_R8_SRGB:()=>rn,VK_FORMAT_R8_UINT:()=>He,VK_FORMAT_R8_UNORM:()=>Ee,VK_FORMAT_S8_UINT:()=>sl,VK_FORMAT_UNDEFINED:()=>_e,VK_FORMAT_X8_D24_UNORM_PACK32:()=>rl,read:()=>ar,write:()=>Ch});var f=c("./node_modules/buffer/index.js").Buffer;const g=0,m=1,v=2,A=3,y=0,C=0,E=2,x=0,M=1,w=160,S=161,I=162,L=163,R=0,k=1,P=0,F=1,O=2,W=3,V=4,$=5,H=6,Y=7,Q=8,G=9,J=10,K=11,se=12,ue=13,he=14,Me=15,de=16,Pe=17,Se=18,Le=0,be=1,je=2,Te=3,rt=4,mt=5,vt=6,ft=7,Ze=8,St=9,$t=10,ct=11,Ct=0,Tt=1,At=2,pn=13,yt=14,kn=15,qn=128,Gt=64,bt=32,ye=16,_e=0,Ue=1,Re=2,Ce=3,Ne=4,le=5,j=6,Z=7,pe=8,Ee=9,Qe=10,He=13,Pt=14,rn=15,Xt=16,st=17,An=20,Vt=21,Dn=22,Qr=23,nr=24,_r=27,Po=28,Hr=29,fa=30,ds=31,go=34,da=35,Js=36,zr=37,Er=38,ps=41,Rl=42,Yo=43,yc=44,nl=45,Oe=48,We=49,ot=50,Rt=58,gt=59,Ht=62,an=63,jn=64,Bn=65,zt=68,Zn=69,oi=70,hi=71,wr=74,Ti=75,bi=76,Wi=77,Or=78,ms=81,Rn=82,Ii=83,es=84,Zi=85,ne=88,ae=89,me=90,xe=91,Fe=92,Je=95,nt=96,qt=97,Kt=98,dt=99,Lt=100,on=101,Nn=102,$n=103,ai=104,wi=105,Ai=106,ui=107,ir=108,Cr=109,jr=110,Fr=111,As=112,gs=113,vs=114,_s=115,ts=116,Us=117,qo=118,pa=119,Da=120,Ll=121,Pl=122,Dl=123,il=124,rl=125,ro=126,sl=127,Zs=128,rr=129,Na=130,yh=131,cu=132,uu=133,Rr=134,hu=135,fu=136,lv=137,Nl=138,cv=139,uv=140,hv=141,fv=142,dv=143,pv=144,mv=145,Av=146,gv=147,vv=148,bv=149,yv=150,_v=151,ud=152,$m=153,Xm=154,Km=155,hd=156,Ym=157,qm=158,Jm=159,Zm=160,du=161,Ev=162,wv=163,Cv=164,xv=165,Mv=166,Sv=167,Tv=168,Iv=169,Bv=170,fd=171,ma=172,pu=173,vo=174,Gs=175,e0=176,Ol=177,_c=178,bo=179,Kr=180,dd=181,Rv=182,Lv=183,mu=184,Pv=1000156007,Dv=1000156008,Nv=1000156009,Ov=1000156010,Fv=1000156011,kv=1000156017,Uv=1000156018,Gv=1000156019,Vv=1000156020,Qv=1000156021,Hv=1000054e3,zv=1000054001,jv=1000054002,Wv=1000054003,eo=1000054004,Ci=1000054005,$v=1000054006,Jt=1000054007,_i=1000066e3,pd=1000066001,t0=1000066002,Xv=1000066003,Ec=1000066004,Au=1000066005,n0=1000066006,i0=1000066007,r0=1000066008,s0=1000066009,o0=1000066010,_h=1000066011,Kv=1000066012,gr=1000066013,wc=100034e4,md=1000340001;class Fl{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Cc{constructor(Ei,er,ur,Ge){this._dataView=new DataView(Ei.buffer,Ei.byteOffset+er,ur),this._littleEndian=Ge,this._offset=0}_nextUint8(){const Ei=this._dataView.getUint8(this._offset);return this._offset+=1,Ei}_nextUint16(){const Ei=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Ei}_nextUint32(){const Ei=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Ei}_nextUint64(){const Ei=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Ei}_nextInt32(){const Ei=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Ei}_skip(Ei){return this._offset+=Ei,this}_scan(Ei,er=0){const ur=this._offset;let Ge=0;for(;this._dataView.getUint8(this._offset)!==er&&Ge<Ei;)Ge++,this._offset++;return Ge<Ei&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+ur,Ge)}}const a0=new Uint8Array([0]),Wr=[171,75,84,88,32,50,48,187,13,10,26,10];function Eh(Wn){return typeof TextEncoder<"u"?new TextEncoder().encode(Wn):f.from(Wn)}function l0(Wn){return typeof TextDecoder<"u"?new TextDecoder().decode(Wn):f.from(Wn).toString("utf8")}function kr(Wn){let Ei=0;for(const Ge of Wn)Ei+=Ge.byteLength;const er=new Uint8Array(Ei);let ur=0;for(const Ge of Wn)er.set(new Uint8Array(Ge),ur),ur+=Ge.byteLength;return er}function ar(Wn){const Ei=new Uint8Array(Wn.buffer,Wn.byteOffset,Wr.length);if(Ei[0]!==Wr[0]||Ei[1]!==Wr[1]||Ei[2]!==Wr[2]||Ei[3]!==Wr[3]||Ei[4]!==Wr[4]||Ei[5]!==Wr[5]||Ei[6]!==Wr[6]||Ei[7]!==Wr[7]||Ei[8]!==Wr[8]||Ei[9]!==Wr[9]||Ei[10]!==Wr[10]||Ei[11]!==Wr[11])throw new Error("Missing KTX 2.0 identifier.");const er=new Fl,ur=17*Uint32Array.BYTES_PER_ELEMENT,Ge=new Cc(Wn,Wr.length,ur,!0);er.vkFormat=Ge._nextUint32(),er.typeSize=Ge._nextUint32(),er.pixelWidth=Ge._nextUint32(),er.pixelHeight=Ge._nextUint32(),er.pixelDepth=Ge._nextUint32(),er.layerCount=Ge._nextUint32(),er.faceCount=Ge._nextUint32();const Jo=Ge._nextUint32();er.supercompressionScheme=Ge._nextUint32();const os=Ge._nextUint32(),ns=Ge._nextUint32(),qi=Ge._nextUint32(),so=Ge._nextUint32(),ol=Ge._nextUint64(),No=Ge._nextUint64(),Vs=new Cc(Wn,Wr.length+ur,3*Jo*8,!0);for(let Is=0;Is<Jo;Is++)er.levels.push({levelData:new Uint8Array(Wn.buffer,Wn.byteOffset+Vs._nextUint64(),Vs._nextUint64()),uncompressedByteLength:Vs._nextUint64()});const Pi=new Cc(Wn,os,ns,!0),to={vendorId:Pi._skip(4)._nextUint16(),descriptorType:Pi._nextUint16(),versionNumber:Pi._nextUint16(),descriptorBlockSize:Pi._nextUint16(),colorModel:Pi._nextUint8(),colorPrimaries:Pi._nextUint8(),transferFunction:Pi._nextUint8(),flags:Pi._nextUint8(),texelBlockDimension:[Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8()],bytesPlane:[Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8()],samples:[]},Zo=(to.descriptorBlockSize/4-6)/4;for(let Is=0;Is<Zo;Is++){const Kn={bitOffset:Pi._nextUint16(),bitLength:Pi._nextUint8(),channelType:Pi._nextUint8(),samplePosition:[Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8(),Pi._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&Kn.channelType?(Kn.sampleLower=Pi._nextInt32(),Kn.sampleUpper=Pi._nextInt32()):(Kn.sampleLower=Pi._nextUint32(),Kn.sampleUpper=Pi._nextUint32()),to.samples[Is]=Kn}er.dataFormatDescriptor.length=0,er.dataFormatDescriptor.push(to);const Qs=new Cc(Wn,qi,so,!0);for(;Qs._offset<so;){const Is=Qs._nextUint32(),Kn=Qs._scan(Is),Ul=l0(Kn),Oo=Qs._scan(Is-Kn.byteLength);er.keyValue[Ul]=Ul.match(/^ktx/i)?l0(Oo):Oo,Qs._offset%4&&Qs._skip(4-Qs._offset%4)}if(No<=0)return er;const sr=new Cc(Wn,ol,No,!0),Sr=sr._nextUint16(),Di=sr._nextUint16(),or=sr._nextUint32(),yo=sr._nextUint32(),xc=sr._nextUint32(),kl=sr._nextUint32(),xh=[];for(let Is=0;Is<Jo;Is++)xh.push({imageFlags:sr._nextUint32(),rgbSliceByteOffset:sr._nextUint32(),rgbSliceByteLength:sr._nextUint32(),alphaSliceByteOffset:sr._nextUint32(),alphaSliceByteLength:sr._nextUint32()});const Ts=ol+sr._offset,Aa=Ts+or,Mh=Aa+yo,Sh=Mh+xc,al=new Uint8Array(Wn.buffer,Wn.byteOffset+Ts,or),Ad=new Uint8Array(Wn.buffer,Wn.byteOffset+Aa,yo),Th=new Uint8Array(Wn.buffer,Wn.byteOffset+Mh,xc),gd=new Uint8Array(Wn.buffer,Wn.byteOffset+Sh,kl);return er.globalData={endpointCount:Sr,selectorCount:Di,imageDescs:xh,endpointsData:al,selectorsData:Ad,tablesData:Th,extendedData:gd},er}function wh(){return(wh=Object.assign||function(Wn){for(var Ei=1;Ei<arguments.length;Ei++){var er=arguments[Ei];for(var ur in er)Object.prototype.hasOwnProperty.call(er,ur)&&(Wn[ur]=er[ur])}return Wn}).apply(this,arguments)}const Do={keepWriter:!1};function Ch(Wn,Ei={}){Ei=wh({},Do,Ei);let er=new ArrayBuffer(0);if(Wn.globalData){const Sr=new ArrayBuffer(20+5*Wn.globalData.imageDescs.length*4),Di=new DataView(Sr);Di.setUint16(0,Wn.globalData.endpointCount,!0),Di.setUint16(2,Wn.globalData.selectorCount,!0),Di.setUint32(4,Wn.globalData.endpointsData.byteLength,!0),Di.setUint32(8,Wn.globalData.selectorsData.byteLength,!0),Di.setUint32(12,Wn.globalData.tablesData.byteLength,!0),Di.setUint32(16,Wn.globalData.extendedData.byteLength,!0);for(let or=0;or<Wn.globalData.imageDescs.length;or++){const yo=Wn.globalData.imageDescs[or];Di.setUint32(20+5*or*4+0,yo.imageFlags,!0),Di.setUint32(20+5*or*4+4,yo.rgbSliceByteOffset,!0),Di.setUint32(20+5*or*4+8,yo.rgbSliceByteLength,!0),Di.setUint32(20+5*or*4+12,yo.alphaSliceByteOffset,!0),Di.setUint32(20+5*or*4+16,yo.alphaSliceByteLength,!0)}er=kr([Sr,Wn.globalData.endpointsData,Wn.globalData.selectorsData,Wn.globalData.tablesData,Wn.globalData.extendedData])}const ur=[];let Ge=Wn.keyValue;Ei.keepWriter||(Ge=wh({},Wn.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(const Sr in Ge){const Di=Ge[Sr],or=Eh(Sr),yo=typeof Di=="string"?Eh(Di):Di,xc=or.byteLength+1+yo.byteLength+1,kl=xc%4?4-xc%4:0;ur.push(kr([new Uint32Array([xc]),or,a0,yo,a0,new Uint8Array(kl).fill(0)]))}const Jo=kr(ur);if(Wn.dataFormatDescriptor.length!==1||Wn.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");const os=Wn.dataFormatDescriptor[0],ns=new ArrayBuffer(28+16*os.samples.length),qi=new DataView(ns),so=24+16*os.samples.length;if(qi.setUint32(0,ns.byteLength,!0),qi.setUint16(4,os.vendorId,!0),qi.setUint16(6,os.descriptorType,!0),qi.setUint16(8,os.versionNumber,!0),qi.setUint16(10,so,!0),qi.setUint8(12,os.colorModel),qi.setUint8(13,os.colorPrimaries),qi.setUint8(14,os.transferFunction),qi.setUint8(15,os.flags),!Array.isArray(os.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");qi.setUint8(16,os.texelBlockDimension[0]),qi.setUint8(17,os.texelBlockDimension[1]),qi.setUint8(18,os.texelBlockDimension[2]),qi.setUint8(19,os.texelBlockDimension[3]);for(let Sr=0;Sr<8;Sr++)qi.setUint8(20+Sr,os.bytesPlane[Sr]);for(let Sr=0;Sr<os.samples.length;Sr++){const Di=os.samples[Sr],or=28+16*Sr;if(Di.channelID)throw new Error("channelID has been renamed to channelType.");qi.setUint16(or+0,Di.bitOffset,!0),qi.setUint8(or+2,Di.bitLength),qi.setUint8(or+3,Di.channelType),qi.setUint8(or+4,Di.samplePosition[0]),qi.setUint8(or+5,Di.samplePosition[1]),qi.setUint8(or+6,Di.samplePosition[2]),qi.setUint8(or+7,Di.samplePosition[3]),64&Di.channelType?(qi.setInt32(or+8,Di.sampleLower,!0),qi.setInt32(or+12,Di.sampleUpper,!0)):(qi.setUint32(or+8,Di.sampleLower,!0),qi.setUint32(or+12,Di.sampleUpper,!0))}const ol=Wr.length+68+3*Wn.levels.length*8,No=ol+ns.byteLength;let Vs=er.byteLength>0?No+Jo.byteLength:0;Vs%8&&(Vs+=8-Vs%8);const Pi=[],to=new DataView(new ArrayBuffer(3*Wn.levels.length*8));let Zo=(Vs||No+Jo.byteLength)+er.byteLength;for(let Sr=0;Sr<Wn.levels.length;Sr++){const Di=Wn.levels[Sr];Pi.push(Di.levelData),to.setBigUint64(24*Sr+0,BigInt(Zo),!0),to.setBigUint64(24*Sr+8,BigInt(Di.levelData.byteLength),!0),to.setBigUint64(24*Sr+16,BigInt(Di.uncompressedByteLength),!0),Zo+=Di.levelData.byteLength}const Qs=new ArrayBuffer(68),sr=new DataView(Qs);return sr.setUint32(0,Wn.vkFormat,!0),sr.setUint32(4,Wn.typeSize,!0),sr.setUint32(8,Wn.pixelWidth,!0),sr.setUint32(12,Wn.pixelHeight,!0),sr.setUint32(16,Wn.pixelDepth,!0),sr.setUint32(20,Wn.layerCount,!0),sr.setUint32(24,Wn.faceCount,!0),sr.setUint32(28,Wn.levels.length,!0),sr.setUint32(32,Wn.supercompressionScheme,!0),sr.setUint32(36,ol,!0),sr.setUint32(40,ns.byteLength,!0),sr.setUint32(44,No,!0),sr.setUint32(48,Jo.byteLength,!0),sr.setBigUint64(52,BigInt(er.byteLength>0?Vs:0),!0),sr.setBigUint64(60,BigInt(er.byteLength),!0),new Uint8Array(kr([new Uint8Array(Wr).buffer,Qs,to.buffer,ns,Jo,Vs>0?new ArrayBuffer(Vs-(No+Jo.byteLength)):new ArrayBuffer(0),er,...Pi]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(u,p,c)=>{c.r(p),c.d(p,{ZSTDDecoder:()=>y});var f=c("./node_modules/buffer/index.js").Buffer;let g,m,v;const A={env:{emscripten_notify_memory_growth:function(E){v=new Uint8Array(m.exports.memory.buffer)}}};class y{init(){return g||(g=typeof fetch<"u"?fetch("data:application/wasm;base64,"+C).then(x=>x.arrayBuffer()).then(x=>WebAssembly.instantiate(x,A)).then(this._init):WebAssembly.instantiate(f.from(C,"base64"),A).then(this._init),g)}_init(x){m=x.instance,A.env.emscripten_notify_memory_growth(0)}decode(x,M=0){if(!m)throw new Error("ZSTDDecoder: Await .init() before decoding.");const w=x.byteLength,S=m.exports.malloc(w);v.set(x,S),M=M||Number(m.exports.ZSTD_findDecompressedSize(S,w));const I=m.exports.malloc(M),L=m.exports.ZSTD_decompress(I,M,S,w),R=v.slice(I,I+L);return m.exports.free(S),m.exports.free(I),R}}const C="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(u,p,c)=>{c.r(p),c.d(p,{LightProbeGenerator:()=>g});var f=c("./node_modules/three/build/three.module.js");class g{static fromCubeTexture(A){let y=0;const C=new f.Vector3,E=new f.Vector3,x=new f.Color,M=[0,0,0,0,0,0,0,0,0],w=new f.SphericalHarmonics3,S=w.coefficients;for(let L=0;L<6;L++){const R=A.image[L],k=R.width,P=R.height,F=document.createElement("canvas");F.width=k,F.height=P;const O=F.getContext("2d");O.drawImage(R,0,0,k,P);const W=O.getImageData(0,0,k,P),V=W.data,$=W.width,H=2/$;for(let Y=0,Q=V.length;Y<Q;Y+=4){x.setRGB(V[Y]/255,V[Y+1]/255,V[Y+2]/255),m(x,A.colorSpace);const G=Y/4,J=-1+(G%$+.5)*H,K=1-(Math.floor(G/$)+.5)*H;switch(L){case 0:C.set(-1,K,-J);break;case 1:C.set(1,K,J);break;case 2:C.set(-J,1,-K);break;case 3:C.set(-J,-1,K);break;case 4:C.set(-J,K,1);break;case 5:C.set(J,K,-1);break}const se=C.lengthSq(),ue=4/(Math.sqrt(se)*se);y+=ue,E.copy(C).normalize(),f.SphericalHarmonics3.getBasisAt(E,M);for(let he=0;he<9;he++)S[he].x+=M[he]*x.r*ue,S[he].y+=M[he]*x.g*ue,S[he].z+=M[he]*x.b*ue}}const I=4*Math.PI/y;for(let L=0;L<9;L++)S[L].x*=I,S[L].y*=I,S[L].z*=I;return new f.LightProbe(w)}static fromCubeRenderTarget(A,y){let C=0;const E=new f.Vector3,x=new f.Vector3,M=new f.Color,w=[0,0,0,0,0,0,0,0,0],S=new f.SphericalHarmonics3,I=S.coefficients,L=y.texture.type;for(let k=0;k<6;k++){const P=y.width;let F;L===f.HalfFloatType?F=new Uint16Array(P*P*4):F=new Uint8Array(P*P*4),A.readRenderTargetPixels(y,0,0,P,P,F,k);const O=2/P;for(let W=0,V=F.length;W<V;W+=4){let $,H,Y;L===f.HalfFloatType?($=f.DataUtils.fromHalfFloat(F[W]),H=f.DataUtils.fromHalfFloat(F[W+1]),Y=f.DataUtils.fromHalfFloat(F[W+2])):($=F[W]/255,H=F[W+1]/255,Y=F[W+2]/255),M.setRGB($,H,Y),m(M,y.texture.colorSpace);const Q=W/4,G=-1+(Q%P+.5)*O,J=1-(Math.floor(Q/P)+.5)*O;switch(k){case 0:E.set(1,J,-G);break;case 1:E.set(-1,J,G);break;case 2:E.set(G,1,-J);break;case 3:E.set(G,-1,J);break;case 4:E.set(G,J,1);break;case 5:E.set(-G,J,-1);break}const K=E.lengthSq(),se=4/(Math.sqrt(K)*K);C+=se,x.copy(E).normalize(),f.SphericalHarmonics3.getBasisAt(x,w);for(let ue=0;ue<9;ue++)I[ue].x+=w[ue]*M.r*se,I[ue].y+=w[ue]*M.g*se,I[ue].z+=w[ue]*M.b*se}}const R=4*Math.PI/C;for(let k=0;k<9;k++)I[k].x*=R,I[k].y*=R,I[k].z*=R;return new f.LightProbe(S)}}function m(v,A){switch(A){case f.SRGBColorSpace:v.convertSRGBToLinear();break;case f.LinearSRGBColorSpace:case f.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return v}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(u,p,c)=>{c.r(p),c.d(p,{DRACOLoader:()=>m});var f=c("./node_modules/three/build/three.module.js");const g=new WeakMap;class m extends f.Loader{constructor(y){super(y),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(y){return this.decoderPath=y,this}setDecoderConfig(y){return this.decoderConfig=y,this}setWorkerLimit(y){return this.workerLimit=y,this}load(y,C,E,x){const M=new f.FileLoader(this.manager);M.setPath(this.path),M.setResponseType("arraybuffer"),M.setRequestHeader(this.requestHeader),M.setWithCredentials(this.withCredentials),M.load(y,w=>{this.parse(w,C,x)},E,x)}parse(y,C,E=()=>{}){this.decodeDracoFile(y,C,null,null,f.SRGBColorSpace).catch(E)}decodeDracoFile(y,C,E,x,M=f.LinearSRGBColorSpace,w=()=>{}){const S={attributeIDs:E||this.defaultAttributeIDs,attributeTypes:x||this.defaultAttributeTypes,useUniqueIDs:!!E,vertexColorSpace:M};return this.decodeGeometry(y,S).then(C).catch(w)}decodeGeometry(y,C){const E=JSON.stringify(C);if(g.has(y)){const I=g.get(y);if(I.key===E)return I.promise;if(y.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let x;const M=this.workerNextTaskID++,w=y.byteLength,S=this._getWorker(M,w).then(I=>(x=I,new Promise((L,R)=>{x._callbacks[M]={resolve:L,reject:R},x.postMessage({type:"decode",id:M,taskConfig:C,buffer:y},[y])}))).then(I=>this._createGeometry(I.geometry));return S.catch(()=>!0).then(()=>{x&&M&&this._releaseTask(x,M)}),g.set(y,{key:E,promise:S}),S}_createGeometry(y){const C=new f.BufferGeometry;y.index&&C.setIndex(new f.BufferAttribute(y.index.array,1));for(let E=0;E<y.attributes.length;E++){const x=y.attributes[E],M=x.name,w=x.array,S=x.itemSize,I=new f.BufferAttribute(w,S);M==="color"&&(this._assignVertexColorSpace(I,x.vertexColorSpace),I.normalized=!(w instanceof Float32Array)),C.setAttribute(M,I)}return C}_assignVertexColorSpace(y,C){if(C!==f.SRGBColorSpace)return;const E=new f.Color;for(let x=0,M=y.count;x<M;x++)E.fromBufferAttribute(y,x).convertSRGBToLinear(),y.setXYZ(x,E.r,E.g,E.b)}_loadLibrary(y,C){const E=new f.FileLoader(this.manager);return E.setPath(this.decoderPath),E.setResponseType(C),E.setWithCredentials(this.withCredentials),new Promise((x,M)=>{E.load(y,x,void 0,M)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const y=typeof WebAssembly!="object"||this.decoderConfig.type==="js",C=[];return y?C.push(this._loadLibrary("draco_decoder.js","text")):(C.push(this._loadLibrary("draco_wasm_wrapper.js","text")),C.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(C).then(E=>{const x=E[0];y||(this.decoderConfig.wasmBinary=E[1]);const M=v.toString(),w=["/* draco decoder */",x,"","/* worker */",M.substring(M.indexOf("{")+1,M.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([w]))}),this.decoderPending}_getWorker(y,C){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const x=new Worker(this.workerSourceURL);x._callbacks={},x._taskCosts={},x._taskLoad=0,x.postMessage({type:"init",decoderConfig:this.decoderConfig}),x.onmessage=function(M){const w=M.data;switch(w.type){case"decode":x._callbacks[w.id].resolve(w);break;case"error":x._callbacks[w.id].reject(w);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+w.type+'"')}},this.workerPool.push(x)}else this.workerPool.sort(function(x,M){return x._taskLoad>M._taskLoad?-1:1});const E=this.workerPool[this.workerPool.length-1];return E._taskCosts[y]=C,E._taskLoad+=C,E})}_releaseTask(y,C){y._taskLoad-=y._taskCosts[C],delete y._callbacks[C],delete y._taskCosts[C]}debug(){console.log("Task load: ",this.workerPool.map(y=>y._taskLoad))}dispose(){for(let y=0;y<this.workerPool.length;++y)this.workerPool[y].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function v(){let A,y;onmessage=function(w){const S=w.data;switch(S.type){case"init":A=S.decoderConfig,y=new Promise(function(R){A.onModuleLoaded=function(k){R({draco:k})},DracoDecoderModule(A)});break;case"decode":const I=S.buffer,L=S.taskConfig;y.then(R=>{const k=R.draco,P=new k.Decoder;try{const F=C(k,P,new Int8Array(I),L),O=F.attributes.map(W=>W.array.buffer);F.index&&O.push(F.index.array.buffer),self.postMessage({type:"decode",id:S.id,geometry:F},O)}catch(F){console.error(F),self.postMessage({type:"error",id:S.id,error:F.message})}finally{k.destroy(P)}});break}};function C(w,S,I,L){const R=L.attributeIDs,k=L.attributeTypes;let P,F;const O=S.GetEncodedGeometryType(I);if(O===w.TRIANGULAR_MESH)P=new w.Mesh,F=S.DecodeArrayToMesh(I,I.byteLength,P);else if(O===w.POINT_CLOUD)P=new w.PointCloud,F=S.DecodeArrayToPointCloud(I,I.byteLength,P);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!F.ok()||P.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+F.error_msg());const W={index:null,attributes:[]};for(const V in R){const $=self[k[V]];let H,Y;if(L.useUniqueIDs)Y=R[V],H=S.GetAttributeByUniqueId(P,Y);else{if(Y=S.GetAttributeId(P,w[R[V]]),Y===-1)continue;H=S.GetAttribute(P,Y)}const Q=x(w,S,P,V,$,H);V==="color"&&(Q.vertexColorSpace=L.vertexColorSpace),W.attributes.push(Q)}return O===w.TRIANGULAR_MESH&&(W.index=E(w,S,P)),w.destroy(P),W}function E(w,S,I){const R=I.num_faces()*3,k=R*4,P=w._malloc(k);S.GetTrianglesUInt32Array(I,k,P);const F=new Uint32Array(w.HEAPF32.buffer,P,R).slice();return w._free(P),{array:F,itemSize:1}}function x(w,S,I,L,R,k){const P=k.num_components(),O=I.num_points()*P,W=O*R.BYTES_PER_ELEMENT,V=M(w,R),$=w._malloc(W);S.GetAttributeDataArrayForAllPoints(I,k,V,W,$);const H=new R(w.HEAPF32.buffer,$,O).slice();return w._free($),{name:L,array:H,itemSize:P}}function M(w,S){switch(S){case Float32Array:return w.DT_FLOAT32;case Int8Array:return w.DT_INT8;case Int16Array:return w.DT_INT16;case Int32Array:return w.DT_INT32;case Uint8Array:return w.DT_UINT8;case Uint16Array:return w.DT_UINT16;case Uint32Array:return w.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(u,p,c)=>{c.r(p),c.d(p,{GLTFLoader:()=>m});var f=c("./node_modules/three/build/three.module.js"),g=c("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class m extends f.Loader{constructor(ye){super(ye),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(_e){return new x(_e)}),this.register(function(_e){return new M(_e)}),this.register(function(_e){return new O(_e)}),this.register(function(_e){return new W(_e)}),this.register(function(_e){return new V(_e)}),this.register(function(_e){return new S(_e)}),this.register(function(_e){return new I(_e)}),this.register(function(_e){return new L(_e)}),this.register(function(_e){return new R(_e)}),this.register(function(_e){return new E(_e)}),this.register(function(_e){return new k(_e)}),this.register(function(_e){return new w(_e)}),this.register(function(_e){return new F(_e)}),this.register(function(_e){return new P(_e)}),this.register(function(_e){return new y(_e)}),this.register(function(_e){return new $(_e)}),this.register(function(_e){return new H(_e)})}load(ye,_e,Ue,Re){const Ce=this;let Ne;if(this.resourcePath!=="")Ne=this.resourcePath;else if(this.path!==""){const Z=f.LoaderUtils.extractUrlBase(ye);Ne=f.LoaderUtils.resolveURL(Z,this.path)}else Ne=f.LoaderUtils.extractUrlBase(ye);this.manager.itemStart(ye);const le=function(Z){Re?Re(Z):console.error(Z),Ce.manager.itemError(ye),Ce.manager.itemEnd(ye)},j=new f.FileLoader(this.manager);j.setPath(this.path),j.setResponseType("arraybuffer"),j.setRequestHeader(this.requestHeader),j.setWithCredentials(this.withCredentials),j.load(ye,function(Z){try{Ce.parse(Z,Ne,function(pe){_e(pe),Ce.manager.itemEnd(ye)},le)}catch(pe){le(pe)}},Ue,le)}setDRACOLoader(ye){return this.dracoLoader=ye,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(ye){return this.ktx2Loader=ye,this}setMeshoptDecoder(ye){return this.meshoptDecoder=ye,this}register(ye){return this.pluginCallbacks.indexOf(ye)===-1&&this.pluginCallbacks.push(ye),this}unregister(ye){return this.pluginCallbacks.indexOf(ye)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ye),1),this}parse(ye,_e,Ue,Re){let Ce;const Ne={},le={},j=new TextDecoder;if(typeof ye=="string")Ce=JSON.parse(ye);else if(ye instanceof ArrayBuffer)if(j.decode(new Uint8Array(ye,0,4))===Y){try{Ne[A.KHR_BINARY_GLTF]=new J(ye)}catch(Ee){Re&&Re(Ee);return}Ce=JSON.parse(Ne[A.KHR_BINARY_GLTF].content)}else Ce=JSON.parse(j.decode(ye));else Ce=ye;if(Ce.asset===void 0||Ce.asset.version[0]<2){Re&&Re(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const Z=new kn(Ce,{path:_e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});Z.fileLoader.setRequestHeader(this.requestHeader);for(let pe=0;pe<this.pluginCallbacks.length;pe++){const Ee=this.pluginCallbacks[pe](Z);Ee.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),le[Ee.name]=Ee,Ne[Ee.name]=!0}if(Ce.extensionsUsed)for(let pe=0;pe<Ce.extensionsUsed.length;++pe){const Ee=Ce.extensionsUsed[pe],Qe=Ce.extensionsRequired||[];switch(Ee){case A.KHR_MATERIALS_UNLIT:Ne[Ee]=new C;break;case A.KHR_DRACO_MESH_COMPRESSION:Ne[Ee]=new K(Ce,this.dracoLoader);break;case A.KHR_TEXTURE_TRANSFORM:Ne[Ee]=new se;break;case A.KHR_MESH_QUANTIZATION:Ne[Ee]=new ue;break;default:Qe.indexOf(Ee)>=0&&le[Ee]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Ee+'".')}}Z.setExtensions(Ne),Z.setPlugins(le),Z.parse(Ue,Re)}parseAsync(ye,_e){const Ue=this;return new Promise(function(Re,Ce){Ue.parse(ye,_e,Re,Ce)})}}function v(){let bt={};return{get:function(ye){return bt[ye]},add:function(ye,_e){bt[ye]=_e},remove:function(ye){delete bt[ye]},removeAll:function(){bt={}}}}const A={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class y{constructor(ye){this.parser=ye,this.name=A.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const ye=this.parser,_e=this.parser.json.nodes||[];for(let Ue=0,Re=_e.length;Ue<Re;Ue++){const Ce=_e[Ue];Ce.extensions&&Ce.extensions[this.name]&&Ce.extensions[this.name].light!==void 0&&ye._addNodeRef(this.cache,Ce.extensions[this.name].light)}}_loadLight(ye){const _e=this.parser,Ue="light:"+ye;let Re=_e.cache.get(Ue);if(Re)return Re;const Ce=_e.json,j=((Ce.extensions&&Ce.extensions[this.name]||{}).lights||[])[ye];let Z;const pe=new f.Color(16777215);j.color!==void 0&&pe.setRGB(j.color[0],j.color[1],j.color[2],f.LinearSRGBColorSpace);const Ee=j.range!==void 0?j.range:0;switch(j.type){case"directional":Z=new f.DirectionalLight(pe),Z.target.position.set(0,0,-1),Z.add(Z.target);break;case"point":Z=new f.PointLight(pe),Z.distance=Ee;break;case"spot":Z=new f.SpotLight(pe),Z.distance=Ee,j.spot=j.spot||{},j.spot.innerConeAngle=j.spot.innerConeAngle!==void 0?j.spot.innerConeAngle:0,j.spot.outerConeAngle=j.spot.outerConeAngle!==void 0?j.spot.outerConeAngle:Math.PI/4,Z.angle=j.spot.outerConeAngle,Z.penumbra=1-j.spot.innerConeAngle/j.spot.outerConeAngle,Z.target.position.set(0,0,-1),Z.add(Z.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+j.type)}return Z.position.set(0,0,0),Z.decay=2,St(Z,j),j.intensity!==void 0&&(Z.intensity=j.intensity),Z.name=_e.createUniqueName(j.name||"light_"+ye),Re=Promise.resolve(Z),_e.cache.add(Ue,Re),Re}getDependency(ye,_e){if(ye==="light")return this._loadLight(_e)}createNodeAttachment(ye){const _e=this,Ue=this.parser,Ce=Ue.json.nodes[ye],le=(Ce.extensions&&Ce.extensions[this.name]||{}).light;return le===void 0?null:this._loadLight(le).then(function(j){return Ue._getNodeRef(_e.cache,le,j)})}}class C{constructor(){this.name=A.KHR_MATERIALS_UNLIT}getMaterialType(){return f.MeshBasicMaterial}extendParams(ye,_e,Ue){const Re=[];ye.color=new f.Color(1,1,1),ye.opacity=1;const Ce=_e.pbrMetallicRoughness;if(Ce){if(Array.isArray(Ce.baseColorFactor)){const Ne=Ce.baseColorFactor;ye.color.setRGB(Ne[0],Ne[1],Ne[2],f.LinearSRGBColorSpace),ye.opacity=Ne[3]}Ce.baseColorTexture!==void 0&&Re.push(Ue.assignTexture(ye,"map",Ce.baseColorTexture,f.SRGBColorSpace))}return Promise.all(Re)}}class E{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(ye,_e){const Re=this.parser.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=Re.extensions[this.name].emissiveStrength;return Ce!==void 0&&(_e.emissiveIntensity=Ce),Promise.resolve()}}class x{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_CLEARCOAT}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];if(Ne.clearcoatFactor!==void 0&&(_e.clearcoat=Ne.clearcoatFactor),Ne.clearcoatTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"clearcoatMap",Ne.clearcoatTexture)),Ne.clearcoatRoughnessFactor!==void 0&&(_e.clearcoatRoughness=Ne.clearcoatRoughnessFactor),Ne.clearcoatRoughnessTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"clearcoatRoughnessMap",Ne.clearcoatRoughnessTexture)),Ne.clearcoatNormalTexture!==void 0&&(Ce.push(Ue.assignTexture(_e,"clearcoatNormalMap",Ne.clearcoatNormalTexture)),Ne.clearcoatNormalTexture.scale!==void 0)){const le=Ne.clearcoatNormalTexture.scale;_e.clearcoatNormalScale=new f.Vector2(le,le)}return Promise.all(Ce)}}class M{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_DISPERSION}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Re=this.parser.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=Re.extensions[this.name];return _e.dispersion=Ce.dispersion!==void 0?Ce.dispersion:0,Promise.resolve()}}class w{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_IRIDESCENCE}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];return Ne.iridescenceFactor!==void 0&&(_e.iridescence=Ne.iridescenceFactor),Ne.iridescenceTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"iridescenceMap",Ne.iridescenceTexture)),Ne.iridescenceIor!==void 0&&(_e.iridescenceIOR=Ne.iridescenceIor),_e.iridescenceThicknessRange===void 0&&(_e.iridescenceThicknessRange=[100,400]),Ne.iridescenceThicknessMinimum!==void 0&&(_e.iridescenceThicknessRange[0]=Ne.iridescenceThicknessMinimum),Ne.iridescenceThicknessMaximum!==void 0&&(_e.iridescenceThicknessRange[1]=Ne.iridescenceThicknessMaximum),Ne.iridescenceThicknessTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"iridescenceThicknessMap",Ne.iridescenceThicknessTexture)),Promise.all(Ce)}}class S{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_SHEEN}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[];_e.sheenColor=new f.Color(0,0,0),_e.sheenRoughness=0,_e.sheen=1;const Ne=Re.extensions[this.name];if(Ne.sheenColorFactor!==void 0){const le=Ne.sheenColorFactor;_e.sheenColor.setRGB(le[0],le[1],le[2],f.LinearSRGBColorSpace)}return Ne.sheenRoughnessFactor!==void 0&&(_e.sheenRoughness=Ne.sheenRoughnessFactor),Ne.sheenColorTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"sheenColorMap",Ne.sheenColorTexture,f.SRGBColorSpace)),Ne.sheenRoughnessTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"sheenRoughnessMap",Ne.sheenRoughnessTexture)),Promise.all(Ce)}}class I{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_TRANSMISSION}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];return Ne.transmissionFactor!==void 0&&(_e.transmission=Ne.transmissionFactor),Ne.transmissionTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"transmissionMap",Ne.transmissionTexture)),Promise.all(Ce)}}class L{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_VOLUME}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];_e.thickness=Ne.thicknessFactor!==void 0?Ne.thicknessFactor:0,Ne.thicknessTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"thicknessMap",Ne.thicknessTexture)),_e.attenuationDistance=Ne.attenuationDistance||1/0;const le=Ne.attenuationColor||[1,1,1];return _e.attenuationColor=new f.Color().setRGB(le[0],le[1],le[2],f.LinearSRGBColorSpace),Promise.all(Ce)}}class R{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_IOR}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Re=this.parser.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=Re.extensions[this.name];return _e.ior=Ce.ior!==void 0?Ce.ior:1.5,Promise.resolve()}}class k{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_SPECULAR}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];_e.specularIntensity=Ne.specularFactor!==void 0?Ne.specularFactor:1,Ne.specularTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"specularIntensityMap",Ne.specularTexture));const le=Ne.specularColorFactor||[1,1,1];return _e.specularColor=new f.Color().setRGB(le[0],le[1],le[2],f.LinearSRGBColorSpace),Ne.specularColorTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"specularColorMap",Ne.specularColorTexture,f.SRGBColorSpace)),Promise.all(Ce)}}class P{constructor(ye){this.parser=ye,this.name=A.EXT_MATERIALS_BUMP}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];return _e.bumpScale=Ne.bumpFactor!==void 0?Ne.bumpFactor:1,Ne.bumpTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"bumpMap",Ne.bumpTexture)),Promise.all(Ce)}}class F{constructor(ye){this.parser=ye,this.name=A.KHR_MATERIALS_ANISOTROPY}getMaterialType(ye){const Ue=this.parser.json.materials[ye];return!Ue.extensions||!Ue.extensions[this.name]?null:f.MeshPhysicalMaterial}extendMaterialParams(ye,_e){const Ue=this.parser,Re=Ue.json.materials[ye];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const Ce=[],Ne=Re.extensions[this.name];return Ne.anisotropyStrength!==void 0&&(_e.anisotropy=Ne.anisotropyStrength),Ne.anisotropyRotation!==void 0&&(_e.anisotropyRotation=Ne.anisotropyRotation),Ne.anisotropyTexture!==void 0&&Ce.push(Ue.assignTexture(_e,"anisotropyMap",Ne.anisotropyTexture)),Promise.all(Ce)}}class O{constructor(ye){this.parser=ye,this.name=A.KHR_TEXTURE_BASISU}loadTexture(ye){const _e=this.parser,Ue=_e.json,Re=Ue.textures[ye];if(!Re.extensions||!Re.extensions[this.name])return null;const Ce=Re.extensions[this.name],Ne=_e.options.ktx2Loader;if(!Ne){if(Ue.extensionsRequired&&Ue.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return _e.loadTextureImage(ye,Ce.source,Ne)}}class W{constructor(ye){this.parser=ye,this.name=A.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(ye){const _e=this.name,Ue=this.parser,Re=Ue.json,Ce=Re.textures[ye];if(!Ce.extensions||!Ce.extensions[_e])return null;const Ne=Ce.extensions[_e],le=Re.images[Ne.source];let j=Ue.textureLoader;if(le.uri){const Z=Ue.options.manager.getHandler(le.uri);Z!==null&&(j=Z)}return this.detectSupport().then(function(Z){if(Z)return Ue.loadTextureImage(ye,Ne.source,j);if(Re.extensionsRequired&&Re.extensionsRequired.indexOf(_e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Ue.loadTexture(ye)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ye){const _e=new Image;_e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",_e.onload=_e.onerror=function(){ye(_e.height===1)}})),this.isSupported}}class V{constructor(ye){this.parser=ye,this.name=A.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(ye){const _e=this.name,Ue=this.parser,Re=Ue.json,Ce=Re.textures[ye];if(!Ce.extensions||!Ce.extensions[_e])return null;const Ne=Ce.extensions[_e],le=Re.images[Ne.source];let j=Ue.textureLoader;if(le.uri){const Z=Ue.options.manager.getHandler(le.uri);Z!==null&&(j=Z)}return this.detectSupport().then(function(Z){if(Z)return Ue.loadTextureImage(ye,Ne.source,j);if(Re.extensionsRequired&&Re.extensionsRequired.indexOf(_e)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return Ue.loadTexture(ye)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ye){const _e=new Image;_e.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",_e.onload=_e.onerror=function(){ye(_e.height===1)}})),this.isSupported}}class ${constructor(ye){this.name=A.EXT_MESHOPT_COMPRESSION,this.parser=ye}loadBufferView(ye){const _e=this.parser.json,Ue=_e.bufferViews[ye];if(Ue.extensions&&Ue.extensions[this.name]){const Re=Ue.extensions[this.name],Ce=this.parser.getDependency("buffer",Re.buffer),Ne=this.parser.options.meshoptDecoder;if(!Ne||!Ne.supported){if(_e.extensionsRequired&&_e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Ce.then(function(le){const j=Re.byteOffset||0,Z=Re.byteLength||0,pe=Re.count,Ee=Re.byteStride,Qe=new Uint8Array(le,j,Z);return Ne.decodeGltfBufferAsync?Ne.decodeGltfBufferAsync(pe,Ee,Qe,Re.mode,Re.filter).then(function(He){return He.buffer}):Ne.ready.then(function(){const He=new ArrayBuffer(pe*Ee);return Ne.decodeGltfBuffer(new Uint8Array(He),pe,Ee,Qe,Re.mode,Re.filter),He})})}else return null}}class H{constructor(ye){this.name=A.EXT_MESH_GPU_INSTANCING,this.parser=ye}createNodeMesh(ye){const _e=this.parser.json,Ue=_e.nodes[ye];if(!Ue.extensions||!Ue.extensions[this.name]||Ue.mesh===void 0)return null;const Re=_e.meshes[Ue.mesh];for(const Z of Re.primitives)if(Z.mode!==Pe.TRIANGLES&&Z.mode!==Pe.TRIANGLE_STRIP&&Z.mode!==Pe.TRIANGLE_FAN&&Z.mode!==void 0)return null;const Ne=Ue.extensions[this.name].attributes,le=[],j={};for(const Z in Ne)le.push(this.parser.getDependency("accessor",Ne[Z]).then(pe=>(j[Z]=pe,j[Z])));return le.length<1?null:(le.push(this.parser.createNodeMesh(ye)),Promise.all(le).then(Z=>{const pe=Z.pop(),Ee=pe.isGroup?pe.children:[pe],Qe=Z[0].count,He=[];for(const Pt of Ee){const rn=new f.Matrix4,Xt=new f.Vector3,st=new f.Quaternion,An=new f.Vector3(1,1,1),Vt=new f.InstancedMesh(Pt.geometry,Pt.material,Qe);for(let Dn=0;Dn<Qe;Dn++)j.TRANSLATION&&Xt.fromBufferAttribute(j.TRANSLATION,Dn),j.ROTATION&&st.fromBufferAttribute(j.ROTATION,Dn),j.SCALE&&An.fromBufferAttribute(j.SCALE,Dn),Vt.setMatrixAt(Dn,rn.compose(Xt,st,An));for(const Dn in j)if(Dn==="_COLOR_0"){const Qr=j[Dn];Vt.instanceColor=new f.InstancedBufferAttribute(Qr.array,Qr.itemSize,Qr.normalized)}else Dn!=="TRANSLATION"&&Dn!=="ROTATION"&&Dn!=="SCALE"&&Pt.geometry.setAttribute(Dn,j[Dn]);f.Object3D.prototype.copy.call(Vt,Pt),this.parser.assignFinalMaterial(Vt),He.push(Vt)}return pe.isGroup?(pe.clear(),pe.add(...He),pe):He[0]}))}}const Y="glTF",Q=12,G={JSON:1313821514,BIN:5130562};class J{constructor(ye){this.name=A.KHR_BINARY_GLTF,this.content=null,this.body=null;const _e=new DataView(ye,0,Q),Ue=new TextDecoder;if(this.header={magic:Ue.decode(new Uint8Array(ye.slice(0,4))),version:_e.getUint32(4,!0),length:_e.getUint32(8,!0)},this.header.magic!==Y)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const Re=this.header.length-Q,Ce=new DataView(ye,Q);let Ne=0;for(;Ne<Re;){const le=Ce.getUint32(Ne,!0);Ne+=4;const j=Ce.getUint32(Ne,!0);if(Ne+=4,j===G.JSON){const Z=new Uint8Array(ye,Q+Ne,le);this.content=Ue.decode(Z)}else if(j===G.BIN){const Z=Q+Ne;this.body=ye.slice(Z,Z+le)}Ne+=le}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class K{constructor(ye,_e){if(!_e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=A.KHR_DRACO_MESH_COMPRESSION,this.json=ye,this.dracoLoader=_e,this.dracoLoader.preload()}decodePrimitive(ye,_e){const Ue=this.json,Re=this.dracoLoader,Ce=ye.extensions[this.name].bufferView,Ne=ye.extensions[this.name].attributes,le={},j={},Z={};for(const pe in Ne){const Ee=Te[pe]||pe.toLowerCase();le[Ee]=Ne[pe]}for(const pe in ye.attributes){const Ee=Te[pe]||pe.toLowerCase();if(Ne[pe]!==void 0){const Qe=Ue.accessors[ye.attributes[pe]],He=Se[Qe.componentType];Z[Ee]=He.name,j[Ee]=Qe.normalized===!0}}return _e.getDependency("bufferView",Ce).then(function(pe){return new Promise(function(Ee,Qe){Re.decodeDracoFile(pe,function(He){for(const Pt in He.attributes){const rn=He.attributes[Pt],Xt=j[Pt];Xt!==void 0&&(rn.normalized=Xt)}Ee(He)},le,Z,f.LinearSRGBColorSpace,Qe)})})}}class se{constructor(){this.name=A.KHR_TEXTURE_TRANSFORM}extendTexture(ye,_e){return(_e.texCoord===void 0||_e.texCoord===ye.channel)&&_e.offset===void 0&&_e.rotation===void 0&&_e.scale===void 0||(ye=ye.clone(),_e.texCoord!==void 0&&(ye.channel=_e.texCoord),_e.offset!==void 0&&ye.offset.fromArray(_e.offset),_e.rotation!==void 0&&(ye.rotation=_e.rotation),_e.scale!==void 0&&ye.repeat.fromArray(_e.scale),ye.needsUpdate=!0),ye}}class ue{constructor(){this.name=A.KHR_MESH_QUANTIZATION}}class he extends f.Interpolant{constructor(ye,_e,Ue,Re){super(ye,_e,Ue,Re)}copySampleValue_(ye){const _e=this.resultBuffer,Ue=this.sampleValues,Re=this.valueSize,Ce=ye*Re*3+Re;for(let Ne=0;Ne!==Re;Ne++)_e[Ne]=Ue[Ce+Ne];return _e}interpolate_(ye,_e,Ue,Re){const Ce=this.resultBuffer,Ne=this.sampleValues,le=this.valueSize,j=le*2,Z=le*3,pe=Re-_e,Ee=(Ue-_e)/pe,Qe=Ee*Ee,He=Qe*Ee,Pt=ye*Z,rn=Pt-Z,Xt=-2*He+3*Qe,st=He-Qe,An=1-Xt,Vt=st-Qe+Ee;for(let Dn=0;Dn!==le;Dn++){const Qr=Ne[rn+Dn+le],nr=Ne[rn+Dn+j]*pe,_r=Ne[Pt+Dn+le],Po=Ne[Pt+Dn]*pe;Ce[Dn]=An*Qr+Vt*nr+Xt*_r+st*Po}return Ce}}const Me=new f.Quaternion;class de extends he{interpolate_(ye,_e,Ue,Re){const Ce=super.interpolate_(ye,_e,Ue,Re);return Me.fromArray(Ce).normalize().toArray(Ce),Ce}}const Pe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Se={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Le={9728:f.NearestFilter,9729:f.LinearFilter,9984:f.NearestMipmapNearestFilter,9985:f.LinearMipmapNearestFilter,9986:f.NearestMipmapLinearFilter,9987:f.LinearMipmapLinearFilter},be={33071:f.ClampToEdgeWrapping,33648:f.MirroredRepeatWrapping,10497:f.RepeatWrapping},je={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Te={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},rt={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},mt={CUBICSPLINE:void 0,LINEAR:f.InterpolateLinear,STEP:f.InterpolateDiscrete},vt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ft(bt){return bt.DefaultMaterial===void 0&&(bt.DefaultMaterial=new f.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:f.FrontSide})),bt.DefaultMaterial}function Ze(bt,ye,_e){for(const Ue in _e.extensions)bt[Ue]===void 0&&(ye.userData.gltfExtensions=ye.userData.gltfExtensions||{},ye.userData.gltfExtensions[Ue]=_e.extensions[Ue])}function St(bt,ye){ye.extras!==void 0&&(typeof ye.extras=="object"?Object.assign(bt.userData,ye.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ye.extras))}function $t(bt,ye,_e){let Ue=!1,Re=!1,Ce=!1;for(let Z=0,pe=ye.length;Z<pe;Z++){const Ee=ye[Z];if(Ee.POSITION!==void 0&&(Ue=!0),Ee.NORMAL!==void 0&&(Re=!0),Ee.COLOR_0!==void 0&&(Ce=!0),Ue&&Re&&Ce)break}if(!Ue&&!Re&&!Ce)return Promise.resolve(bt);const Ne=[],le=[],j=[];for(let Z=0,pe=ye.length;Z<pe;Z++){const Ee=ye[Z];if(Ue){const Qe=Ee.POSITION!==void 0?_e.getDependency("accessor",Ee.POSITION):bt.attributes.position;Ne.push(Qe)}if(Re){const Qe=Ee.NORMAL!==void 0?_e.getDependency("accessor",Ee.NORMAL):bt.attributes.normal;le.push(Qe)}if(Ce){const Qe=Ee.COLOR_0!==void 0?_e.getDependency("accessor",Ee.COLOR_0):bt.attributes.color;j.push(Qe)}}return Promise.all([Promise.all(Ne),Promise.all(le),Promise.all(j)]).then(function(Z){const pe=Z[0],Ee=Z[1],Qe=Z[2];return Ue&&(bt.morphAttributes.position=pe),Re&&(bt.morphAttributes.normal=Ee),Ce&&(bt.morphAttributes.color=Qe),bt.morphTargetsRelative=!0,bt})}function ct(bt,ye){if(bt.updateMorphTargets(),ye.weights!==void 0)for(let _e=0,Ue=ye.weights.length;_e<Ue;_e++)bt.morphTargetInfluences[_e]=ye.weights[_e];if(ye.extras&&Array.isArray(ye.extras.targetNames)){const _e=ye.extras.targetNames;if(bt.morphTargetInfluences.length===_e.length){bt.morphTargetDictionary={};for(let Ue=0,Re=_e.length;Ue<Re;Ue++)bt.morphTargetDictionary[_e[Ue]]=Ue}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ct(bt){let ye;const _e=bt.extensions&&bt.extensions[A.KHR_DRACO_MESH_COMPRESSION];if(_e?ye="draco:"+_e.bufferView+":"+_e.indices+":"+Tt(_e.attributes):ye=bt.indices+":"+Tt(bt.attributes)+":"+bt.mode,bt.targets!==void 0)for(let Ue=0,Re=bt.targets.length;Ue<Re;Ue++)ye+=":"+Tt(bt.targets[Ue]);return ye}function Tt(bt){let ye="";const _e=Object.keys(bt).sort();for(let Ue=0,Re=_e.length;Ue<Re;Ue++)ye+=_e[Ue]+":"+bt[_e[Ue]]+";";return ye}function At(bt){switch(bt){case Int8Array:return .007874015748031496;case Uint8Array:return .00392156862745098;case Int16Array:return 3051850947599719e-20;case Uint16Array:return 15259021896696422e-21;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function pn(bt){return bt.search(/\.jpe?g($|\?)/i)>0||bt.search(/^data\:image\/jpeg/)===0?"image/jpeg":bt.search(/\.webp($|\?)/i)>0||bt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const yt=new f.Matrix4;class kn{constructor(ye={},_e={}){this.json=ye,this.extensions={},this.plugins={},this.options=_e,this.cache=new v,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let Ue=!1,Re=!1,Ce=-1;typeof navigator<"u"&&(Ue=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,Re=navigator.userAgent.indexOf("Firefox")>-1,Ce=Re?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||Ue||Re&&Ce<98?this.textureLoader=new f.TextureLoader(this.options.manager):this.textureLoader=new f.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new f.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(ye){this.extensions=ye}setPlugins(ye){this.plugins=ye}parse(ye,_e){const Ue=this,Re=this.json,Ce=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(Ne){return Ne._markDefs&&Ne._markDefs()}),Promise.all(this._invokeAll(function(Ne){return Ne.beforeRoot&&Ne.beforeRoot()})).then(function(){return Promise.all([Ue.getDependencies("scene"),Ue.getDependencies("animation"),Ue.getDependencies("camera")])}).then(function(Ne){const le={scene:Ne[0][Re.scene||0],scenes:Ne[0],animations:Ne[1],cameras:Ne[2],asset:Re.asset,parser:Ue,userData:{}};return Ze(Ce,le,Re),St(le,Re),Promise.all(Ue._invokeAll(function(j){return j.afterRoot&&j.afterRoot(le)})).then(function(){for(const j of le.scenes)j.updateMatrixWorld();ye(le)})}).catch(_e)}_markDefs(){const ye=this.json.nodes||[],_e=this.json.skins||[],Ue=this.json.meshes||[];for(let Re=0,Ce=_e.length;Re<Ce;Re++){const Ne=_e[Re].joints;for(let le=0,j=Ne.length;le<j;le++)ye[Ne[le]].isBone=!0}for(let Re=0,Ce=ye.length;Re<Ce;Re++){const Ne=ye[Re];Ne.mesh!==void 0&&(this._addNodeRef(this.meshCache,Ne.mesh),Ne.skin!==void 0&&(Ue[Ne.mesh].isSkinnedMesh=!0)),Ne.camera!==void 0&&this._addNodeRef(this.cameraCache,Ne.camera)}}_addNodeRef(ye,_e){_e!==void 0&&(ye.refs[_e]===void 0&&(ye.refs[_e]=ye.uses[_e]=0),ye.refs[_e]++)}_getNodeRef(ye,_e,Ue){if(ye.refs[_e]<=1)return Ue;const Re=Ue.clone(),Ce=(Ne,le)=>{const j=this.associations.get(Ne);j!=null&&this.associations.set(le,j);for(const[Z,pe]of Ne.children.entries())Ce(pe,le.children[Z])};return Ce(Ue,Re),Re.name+="_instance_"+ye.uses[_e]++,Re}_invokeOne(ye){const _e=Object.values(this.plugins);_e.push(this);for(let Ue=0;Ue<_e.length;Ue++){const Re=ye(_e[Ue]);if(Re)return Re}return null}_invokeAll(ye){const _e=Object.values(this.plugins);_e.unshift(this);const Ue=[];for(let Re=0;Re<_e.length;Re++){const Ce=ye(_e[Re]);Ce&&Ue.push(Ce)}return Ue}getDependency(ye,_e){const Ue=ye+":"+_e;let Re=this.cache.get(Ue);if(!Re){switch(ye){case"scene":Re=this.loadScene(_e);break;case"node":Re=this._invokeOne(function(Ce){return Ce.loadNode&&Ce.loadNode(_e)});break;case"mesh":Re=this._invokeOne(function(Ce){return Ce.loadMesh&&Ce.loadMesh(_e)});break;case"accessor":Re=this.loadAccessor(_e);break;case"bufferView":Re=this._invokeOne(function(Ce){return Ce.loadBufferView&&Ce.loadBufferView(_e)});break;case"buffer":Re=this.loadBuffer(_e);break;case"material":Re=this._invokeOne(function(Ce){return Ce.loadMaterial&&Ce.loadMaterial(_e)});break;case"texture":Re=this._invokeOne(function(Ce){return Ce.loadTexture&&Ce.loadTexture(_e)});break;case"skin":Re=this.loadSkin(_e);break;case"animation":Re=this._invokeOne(function(Ce){return Ce.loadAnimation&&Ce.loadAnimation(_e)});break;case"camera":Re=this.loadCamera(_e);break;default:if(Re=this._invokeOne(function(Ce){return Ce!=this&&Ce.getDependency&&Ce.getDependency(ye,_e)}),!Re)throw new Error("Unknown type: "+ye);break}this.cache.add(Ue,Re)}return Re}getDependencies(ye){let _e=this.cache.get(ye);if(!_e){const Ue=this,Re=this.json[ye+(ye==="mesh"?"es":"s")]||[];_e=Promise.all(Re.map(function(Ce,Ne){return Ue.getDependency(ye,Ne)})),this.cache.add(ye,_e)}return _e}loadBuffer(ye){const _e=this.json.buffers[ye],Ue=this.fileLoader;if(_e.type&&_e.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+_e.type+" buffer type is not supported.");if(_e.uri===void 0&&ye===0)return Promise.resolve(this.extensions[A.KHR_BINARY_GLTF].body);const Re=this.options;return new Promise(function(Ce,Ne){Ue.load(f.LoaderUtils.resolveURL(_e.uri,Re.path),Ce,void 0,function(){Ne(new Error('THREE.GLTFLoader: Failed to load buffer "'+_e.uri+'".'))})})}loadBufferView(ye){const _e=this.json.bufferViews[ye];return this.getDependency("buffer",_e.buffer).then(function(Ue){const Re=_e.byteLength||0,Ce=_e.byteOffset||0;return Ue.slice(Ce,Ce+Re)})}loadAccessor(ye){const _e=this,Ue=this.json,Re=this.json.accessors[ye];if(Re.bufferView===void 0&&Re.sparse===void 0){const Ne=je[Re.type],le=Se[Re.componentType],j=Re.normalized===!0,Z=new le(Re.count*Ne);return Promise.resolve(new f.BufferAttribute(Z,Ne,j))}const Ce=[];return Re.bufferView!==void 0?Ce.push(this.getDependency("bufferView",Re.bufferView)):Ce.push(null),Re.sparse!==void 0&&(Ce.push(this.getDependency("bufferView",Re.sparse.indices.bufferView)),Ce.push(this.getDependency("bufferView",Re.sparse.values.bufferView))),Promise.all(Ce).then(function(Ne){const le=Ne[0],j=je[Re.type],Z=Se[Re.componentType],pe=Z.BYTES_PER_ELEMENT,Ee=pe*j,Qe=Re.byteOffset||0,He=Re.bufferView!==void 0?Ue.bufferViews[Re.bufferView].byteStride:void 0,Pt=Re.normalized===!0;let rn,Xt;if(He&&He!==Ee){const st=Math.floor(Qe/He),An="InterleavedBuffer:"+Re.bufferView+":"+Re.componentType+":"+st+":"+Re.count;let Vt=_e.cache.get(An);Vt||(rn=new Z(le,st*He,Re.count*He/pe),Vt=new f.InterleavedBuffer(rn,He/pe),_e.cache.add(An,Vt)),Xt=new f.InterleavedBufferAttribute(Vt,j,Qe%He/pe,Pt)}else le===null?rn=new Z(Re.count*j):rn=new Z(le,Qe,Re.count*j),Xt=new f.BufferAttribute(rn,j,Pt);if(Re.sparse!==void 0){const st=je.SCALAR,An=Se[Re.sparse.indices.componentType],Vt=Re.sparse.indices.byteOffset||0,Dn=Re.sparse.values.byteOffset||0,Qr=new An(Ne[1],Vt,Re.sparse.count*st),nr=new Z(Ne[2],Dn,Re.sparse.count*j);le!==null&&(Xt=new f.BufferAttribute(Xt.array.slice(),Xt.itemSize,Xt.normalized));for(let _r=0,Po=Qr.length;_r<Po;_r++){const Hr=Qr[_r];if(Xt.setX(Hr,nr[_r*j]),j>=2&&Xt.setY(Hr,nr[_r*j+1]),j>=3&&Xt.setZ(Hr,nr[_r*j+2]),j>=4&&Xt.setW(Hr,nr[_r*j+3]),j>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Xt})}loadTexture(ye){const _e=this.json,Ue=this.options,Ce=_e.textures[ye].source,Ne=_e.images[Ce];let le=this.textureLoader;if(Ne.uri){const j=Ue.manager.getHandler(Ne.uri);j!==null&&(le=j)}return this.loadTextureImage(ye,Ce,le)}loadTextureImage(ye,_e,Ue){const Re=this,Ce=this.json,Ne=Ce.textures[ye],le=Ce.images[_e],j=(le.uri||le.bufferView)+":"+Ne.sampler;if(this.textureCache[j])return this.textureCache[j];const Z=this.loadImageSource(_e,Ue).then(function(pe){pe.flipY=!1,pe.name=Ne.name||le.name||"",pe.name===""&&typeof le.uri=="string"&&le.uri.startsWith("data:image/")===!1&&(pe.name=le.uri);const Qe=(Ce.samplers||{})[Ne.sampler]||{};return pe.magFilter=Le[Qe.magFilter]||f.LinearFilter,pe.minFilter=Le[Qe.minFilter]||f.LinearMipmapLinearFilter,pe.wrapS=be[Qe.wrapS]||f.RepeatWrapping,pe.wrapT=be[Qe.wrapT]||f.RepeatWrapping,Re.associations.set(pe,{textures:ye}),pe}).catch(function(){return null});return this.textureCache[j]=Z,Z}loadImageSource(ye,_e){const Ue=this,Re=this.json,Ce=this.options;if(this.sourceCache[ye]!==void 0)return this.sourceCache[ye].then(Ee=>Ee.clone());const Ne=Re.images[ye],le=self.URL||self.webkitURL;let j=Ne.uri||"",Z=!1;if(Ne.bufferView!==void 0)j=Ue.getDependency("bufferView",Ne.bufferView).then(function(Ee){Z=!0;const Qe=new Blob([Ee],{type:Ne.mimeType});return j=le.createObjectURL(Qe),j});else if(Ne.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+ye+" is missing URI and bufferView");const pe=Promise.resolve(j).then(function(Ee){return new Promise(function(Qe,He){let Pt=Qe;_e.isImageBitmapLoader===!0&&(Pt=function(rn){const Xt=new f.Texture(rn);Xt.needsUpdate=!0,Qe(Xt)}),_e.load(f.LoaderUtils.resolveURL(Ee,Ce.path),Pt,void 0,He)})}).then(function(Ee){return Z===!0&&le.revokeObjectURL(j),Ee.userData.mimeType=Ne.mimeType||pn(Ne.uri),Ee}).catch(function(Ee){throw console.error("THREE.GLTFLoader: Couldn't load texture",j),Ee});return this.sourceCache[ye]=pe,pe}assignTexture(ye,_e,Ue,Re){const Ce=this;return this.getDependency("texture",Ue.index).then(function(Ne){if(!Ne)return null;if(Ue.texCoord!==void 0&&Ue.texCoord>0&&(Ne=Ne.clone(),Ne.channel=Ue.texCoord),Ce.extensions[A.KHR_TEXTURE_TRANSFORM]){const le=Ue.extensions!==void 0?Ue.extensions[A.KHR_TEXTURE_TRANSFORM]:void 0;if(le){const j=Ce.associations.get(Ne);Ne=Ce.extensions[A.KHR_TEXTURE_TRANSFORM].extendTexture(Ne,le),Ce.associations.set(Ne,j)}}return Re!==void 0&&(Ne.colorSpace=Re),ye[_e]=Ne,Ne})}assignFinalMaterial(ye){const _e=ye.geometry;let Ue=ye.material;const Re=_e.attributes.tangent===void 0,Ce=_e.attributes.color!==void 0,Ne=_e.attributes.normal===void 0;if(ye.isPoints){const le="PointsMaterial:"+Ue.uuid;let j=this.cache.get(le);j||(j=new f.PointsMaterial,f.Material.prototype.copy.call(j,Ue),j.color.copy(Ue.color),j.map=Ue.map,j.sizeAttenuation=!1,this.cache.add(le,j)),Ue=j}else if(ye.isLine){const le="LineBasicMaterial:"+Ue.uuid;let j=this.cache.get(le);j||(j=new f.LineBasicMaterial,f.Material.prototype.copy.call(j,Ue),j.color.copy(Ue.color),j.map=Ue.map,this.cache.add(le,j)),Ue=j}if(Re||Ce||Ne){let le="ClonedMaterial:"+Ue.uuid+":";Re&&(le+="derivative-tangents:"),Ce&&(le+="vertex-colors:"),Ne&&(le+="flat-shading:");let j=this.cache.get(le);j||(j=Ue.clone(),Ce&&(j.vertexColors=!0),Ne&&(j.flatShading=!0),Re&&(j.normalScale&&(j.normalScale.y*=-1),j.clearcoatNormalScale&&(j.clearcoatNormalScale.y*=-1)),this.cache.add(le,j),this.associations.set(j,this.associations.get(Ue))),Ue=j}ye.material=Ue}getMaterialType(){return f.MeshStandardMaterial}loadMaterial(ye){const _e=this,Ue=this.json,Re=this.extensions,Ce=Ue.materials[ye];let Ne;const le={},j=Ce.extensions||{},Z=[];if(j[A.KHR_MATERIALS_UNLIT]){const Ee=Re[A.KHR_MATERIALS_UNLIT];Ne=Ee.getMaterialType(),Z.push(Ee.extendParams(le,Ce,_e))}else{const Ee=Ce.pbrMetallicRoughness||{};if(le.color=new f.Color(1,1,1),le.opacity=1,Array.isArray(Ee.baseColorFactor)){const Qe=Ee.baseColorFactor;le.color.setRGB(Qe[0],Qe[1],Qe[2],f.LinearSRGBColorSpace),le.opacity=Qe[3]}Ee.baseColorTexture!==void 0&&Z.push(_e.assignTexture(le,"map",Ee.baseColorTexture,f.SRGBColorSpace)),le.metalness=Ee.metallicFactor!==void 0?Ee.metallicFactor:1,le.roughness=Ee.roughnessFactor!==void 0?Ee.roughnessFactor:1,Ee.metallicRoughnessTexture!==void 0&&(Z.push(_e.assignTexture(le,"metalnessMap",Ee.metallicRoughnessTexture)),Z.push(_e.assignTexture(le,"roughnessMap",Ee.metallicRoughnessTexture))),Ne=this._invokeOne(function(Qe){return Qe.getMaterialType&&Qe.getMaterialType(ye)}),Z.push(Promise.all(this._invokeAll(function(Qe){return Qe.extendMaterialParams&&Qe.extendMaterialParams(ye,le)})))}Ce.doubleSided===!0&&(le.side=f.DoubleSide);const pe=Ce.alphaMode||vt.OPAQUE;if(pe===vt.BLEND?(le.transparent=!0,le.depthWrite=!1):(le.transparent=!1,pe===vt.MASK&&(le.alphaTest=Ce.alphaCutoff!==void 0?Ce.alphaCutoff:.5)),Ce.normalTexture!==void 0&&Ne!==f.MeshBasicMaterial&&(Z.push(_e.assignTexture(le,"normalMap",Ce.normalTexture)),le.normalScale=new f.Vector2(1,1),Ce.normalTexture.scale!==void 0)){const Ee=Ce.normalTexture.scale;le.normalScale.set(Ee,Ee)}if(Ce.occlusionTexture!==void 0&&Ne!==f.MeshBasicMaterial&&(Z.push(_e.assignTexture(le,"aoMap",Ce.occlusionTexture)),Ce.occlusionTexture.strength!==void 0&&(le.aoMapIntensity=Ce.occlusionTexture.strength)),Ce.emissiveFactor!==void 0&&Ne!==f.MeshBasicMaterial){const Ee=Ce.emissiveFactor;le.emissive=new f.Color().setRGB(Ee[0],Ee[1],Ee[2],f.LinearSRGBColorSpace)}return Ce.emissiveTexture!==void 0&&Ne!==f.MeshBasicMaterial&&Z.push(_e.assignTexture(le,"emissiveMap",Ce.emissiveTexture,f.SRGBColorSpace)),Promise.all(Z).then(function(){const Ee=new Ne(le);return Ce.name&&(Ee.name=Ce.name),St(Ee,Ce),_e.associations.set(Ee,{materials:ye}),Ce.extensions&&Ze(Re,Ee,Ce),Ee})}createUniqueName(ye){const _e=f.PropertyBinding.sanitizeNodeName(ye||"");return _e in this.nodeNamesUsed?_e+"_"+ ++this.nodeNamesUsed[_e]:(this.nodeNamesUsed[_e]=0,_e)}loadGeometries(ye){const _e=this,Ue=this.extensions,Re=this.primitiveCache;function Ce(le){return Ue[A.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(le,_e).then(function(j){return Gt(j,le,_e)})}const Ne=[];for(let le=0,j=ye.length;le<j;le++){const Z=ye[le],pe=Ct(Z),Ee=Re[pe];if(Ee)Ne.push(Ee.promise);else{let Qe;Z.extensions&&Z.extensions[A.KHR_DRACO_MESH_COMPRESSION]?Qe=Ce(Z):Qe=Gt(new f.BufferGeometry,Z,_e),Re[pe]={primitive:Z,promise:Qe},Ne.push(Qe)}}return Promise.all(Ne)}loadMesh(ye){const _e=this,Ue=this.json,Re=this.extensions,Ce=Ue.meshes[ye],Ne=Ce.primitives,le=[];for(let j=0,Z=Ne.length;j<Z;j++){const pe=Ne[j].material===void 0?ft(this.cache):this.getDependency("material",Ne[j].material);le.push(pe)}return le.push(_e.loadGeometries(Ne)),Promise.all(le).then(function(j){const Z=j.slice(0,j.length-1),pe=j[j.length-1],Ee=[];for(let He=0,Pt=pe.length;He<Pt;He++){const rn=pe[He],Xt=Ne[He];let st;const An=Z[He];if(Xt.mode===Pe.TRIANGLES||Xt.mode===Pe.TRIANGLE_STRIP||Xt.mode===Pe.TRIANGLE_FAN||Xt.mode===void 0)st=Ce.isSkinnedMesh===!0?new f.SkinnedMesh(rn,An):new f.Mesh(rn,An),st.isSkinnedMesh===!0&&st.normalizeSkinWeights(),Xt.mode===Pe.TRIANGLE_STRIP?st.geometry=(0,g.toTrianglesDrawMode)(st.geometry,f.TriangleStripDrawMode):Xt.mode===Pe.TRIANGLE_FAN&&(st.geometry=(0,g.toTrianglesDrawMode)(st.geometry,f.TriangleFanDrawMode));else if(Xt.mode===Pe.LINES)st=new f.LineSegments(rn,An);else if(Xt.mode===Pe.LINE_STRIP)st=new f.Line(rn,An);else if(Xt.mode===Pe.LINE_LOOP)st=new f.LineLoop(rn,An);else if(Xt.mode===Pe.POINTS)st=new f.Points(rn,An);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Xt.mode);Object.keys(st.geometry.morphAttributes).length>0&&ct(st,Ce),st.name=_e.createUniqueName(Ce.name||"mesh_"+ye),St(st,Ce),Xt.extensions&&Ze(Re,st,Xt),_e.assignFinalMaterial(st),Ee.push(st)}for(let He=0,Pt=Ee.length;He<Pt;He++)_e.associations.set(Ee[He],{meshes:ye,primitives:He});if(Ee.length===1)return Ce.extensions&&Ze(Re,Ee[0],Ce),Ee[0];const Qe=new f.Group;Ce.extensions&&Ze(Re,Qe,Ce),_e.associations.set(Qe,{meshes:ye});for(let He=0,Pt=Ee.length;He<Pt;He++)Qe.add(Ee[He]);return Qe})}loadCamera(ye){let _e;const Ue=this.json.cameras[ye],Re=Ue[Ue.type];if(!Re){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Ue.type==="perspective"?_e=new f.PerspectiveCamera(f.MathUtils.radToDeg(Re.yfov),Re.aspectRatio||1,Re.znear||1,Re.zfar||2e6):Ue.type==="orthographic"&&(_e=new f.OrthographicCamera(-Re.xmag,Re.xmag,Re.ymag,-Re.ymag,Re.znear,Re.zfar)),Ue.name&&(_e.name=this.createUniqueName(Ue.name)),St(_e,Ue),Promise.resolve(_e)}loadSkin(ye){const _e=this.json.skins[ye],Ue=[];for(let Re=0,Ce=_e.joints.length;Re<Ce;Re++)Ue.push(this._loadNodeShallow(_e.joints[Re]));return _e.inverseBindMatrices!==void 0?Ue.push(this.getDependency("accessor",_e.inverseBindMatrices)):Ue.push(null),Promise.all(Ue).then(function(Re){const Ce=Re.pop(),Ne=Re,le=[],j=[];for(let Z=0,pe=Ne.length;Z<pe;Z++){const Ee=Ne[Z];if(Ee){le.push(Ee);const Qe=new f.Matrix4;Ce!==null&&Qe.fromArray(Ce.array,Z*16),j.push(Qe)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',_e.joints[Z])}return new f.Skeleton(le,j)})}loadAnimation(ye){const _e=this.json,Ue=this,Re=_e.animations[ye],Ce=Re.name?Re.name:"animation_"+ye,Ne=[],le=[],j=[],Z=[],pe=[];for(let Ee=0,Qe=Re.channels.length;Ee<Qe;Ee++){const He=Re.channels[Ee],Pt=Re.samplers[He.sampler],rn=He.target,Xt=rn.node,st=Re.parameters!==void 0?Re.parameters[Pt.input]:Pt.input,An=Re.parameters!==void 0?Re.parameters[Pt.output]:Pt.output;rn.node!==void 0&&(Ne.push(this.getDependency("node",Xt)),le.push(this.getDependency("accessor",st)),j.push(this.getDependency("accessor",An)),Z.push(Pt),pe.push(rn))}return Promise.all([Promise.all(Ne),Promise.all(le),Promise.all(j),Promise.all(Z),Promise.all(pe)]).then(function(Ee){const Qe=Ee[0],He=Ee[1],Pt=Ee[2],rn=Ee[3],Xt=Ee[4],st=[];for(let An=0,Vt=Qe.length;An<Vt;An++){const Dn=Qe[An],Qr=He[An],nr=Pt[An],_r=rn[An],Po=Xt[An];if(Dn===void 0)continue;Dn.updateMatrix&&Dn.updateMatrix();const Hr=Ue._createAnimationTracks(Dn,Qr,nr,_r,Po);if(Hr)for(let fa=0;fa<Hr.length;fa++)st.push(Hr[fa])}return new f.AnimationClip(Ce,void 0,st)})}createNodeMesh(ye){const _e=this.json,Ue=this,Re=_e.nodes[ye];return Re.mesh===void 0?null:Ue.getDependency("mesh",Re.mesh).then(function(Ce){const Ne=Ue._getNodeRef(Ue.meshCache,Re.mesh,Ce);return Re.weights!==void 0&&Ne.traverse(function(le){if(le.isMesh)for(let j=0,Z=Re.weights.length;j<Z;j++)le.morphTargetInfluences[j]=Re.weights[j]}),Ne})}loadNode(ye){const _e=this.json,Ue=this,Re=_e.nodes[ye],Ce=Ue._loadNodeShallow(ye),Ne=[],le=Re.children||[];for(let Z=0,pe=le.length;Z<pe;Z++)Ne.push(Ue.getDependency("node",le[Z]));const j=Re.skin===void 0?Promise.resolve(null):Ue.getDependency("skin",Re.skin);return Promise.all([Ce,Promise.all(Ne),j]).then(function(Z){const pe=Z[0],Ee=Z[1],Qe=Z[2];Qe!==null&&pe.traverse(function(He){He.isSkinnedMesh&&He.bind(Qe,yt)});for(let He=0,Pt=Ee.length;He<Pt;He++)pe.add(Ee[He]);return pe})}_loadNodeShallow(ye){const _e=this.json,Ue=this.extensions,Re=this;if(this.nodeCache[ye]!==void 0)return this.nodeCache[ye];const Ce=_e.nodes[ye],Ne=Ce.name?Re.createUniqueName(Ce.name):"",le=[],j=Re._invokeOne(function(Z){return Z.createNodeMesh&&Z.createNodeMesh(ye)});return j&&le.push(j),Ce.camera!==void 0&&le.push(Re.getDependency("camera",Ce.camera).then(function(Z){return Re._getNodeRef(Re.cameraCache,Ce.camera,Z)})),Re._invokeAll(function(Z){return Z.createNodeAttachment&&Z.createNodeAttachment(ye)}).forEach(function(Z){le.push(Z)}),this.nodeCache[ye]=Promise.all(le).then(function(Z){let pe;if(Ce.isBone===!0?pe=new f.Bone:Z.length>1?pe=new f.Group:Z.length===1?pe=Z[0]:pe=new f.Object3D,pe!==Z[0])for(let Ee=0,Qe=Z.length;Ee<Qe;Ee++)pe.add(Z[Ee]);if(Ce.name&&(pe.userData.name=Ce.name,pe.name=Ne),St(pe,Ce),Ce.extensions&&Ze(Ue,pe,Ce),Ce.matrix!==void 0){const Ee=new f.Matrix4;Ee.fromArray(Ce.matrix),pe.applyMatrix4(Ee)}else Ce.translation!==void 0&&pe.position.fromArray(Ce.translation),Ce.rotation!==void 0&&pe.quaternion.fromArray(Ce.rotation),Ce.scale!==void 0&&pe.scale.fromArray(Ce.scale);return Re.associations.has(pe)||Re.associations.set(pe,{}),Re.associations.get(pe).nodes=ye,pe}),this.nodeCache[ye]}loadScene(ye){const _e=this.extensions,Ue=this.json.scenes[ye],Re=this,Ce=new f.Group;Ue.name&&(Ce.name=Re.createUniqueName(Ue.name)),St(Ce,Ue),Ue.extensions&&Ze(_e,Ce,Ue);const Ne=Ue.nodes||[],le=[];for(let j=0,Z=Ne.length;j<Z;j++)le.push(Re.getDependency("node",Ne[j]));return Promise.all(le).then(function(j){for(let pe=0,Ee=j.length;pe<Ee;pe++)Ce.add(j[pe]);const Z=pe=>{const Ee=new Map;for(const[Qe,He]of Re.associations)(Qe instanceof f.Material||Qe instanceof f.Texture)&&Ee.set(Qe,He);return pe.traverse(Qe=>{const He=Re.associations.get(Qe);He!=null&&Ee.set(Qe,He)}),Ee};return Re.associations=Z(Ce),Ce})}_createAnimationTracks(ye,_e,Ue,Re,Ce){const Ne=[],le=ye.name?ye.name:ye.uuid,j=[];rt[Ce.path]===rt.weights?ye.traverse(function(Qe){Qe.morphTargetInfluences&&j.push(Qe.name?Qe.name:Qe.uuid)}):j.push(le);let Z;switch(rt[Ce.path]){case rt.weights:Z=f.NumberKeyframeTrack;break;case rt.rotation:Z=f.QuaternionKeyframeTrack;break;case rt.position:case rt.scale:Z=f.VectorKeyframeTrack;break;default:switch(Ue.itemSize){case 1:Z=f.NumberKeyframeTrack;break;case 2:case 3:default:Z=f.VectorKeyframeTrack;break}break}const pe=Re.interpolation!==void 0?mt[Re.interpolation]:f.InterpolateLinear,Ee=this._getArrayFromAccessor(Ue);for(let Qe=0,He=j.length;Qe<He;Qe++){const Pt=new Z(j[Qe]+"."+rt[Ce.path],_e.array,Ee,pe);Re.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(Pt),Ne.push(Pt)}return Ne}_getArrayFromAccessor(ye){let _e=ye.array;if(ye.normalized){const Ue=At(_e.constructor),Re=new Float32Array(_e.length);for(let Ce=0,Ne=_e.length;Ce<Ne;Ce++)Re[Ce]=_e[Ce]*Ue;_e=Re}return _e}_createCubicSplineTrackInterpolant(ye){ye.createInterpolant=function(Ue){const Re=this instanceof f.QuaternionKeyframeTrack?de:he;return new Re(this.times,this.values,this.getValueSize()/3,Ue)},ye.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function qn(bt,ye,_e){const Ue=ye.attributes,Re=new f.Box3;if(Ue.POSITION!==void 0){const le=_e.json.accessors[Ue.POSITION],j=le.min,Z=le.max;if(j!==void 0&&Z!==void 0){if(Re.set(new f.Vector3(j[0],j[1],j[2]),new f.Vector3(Z[0],Z[1],Z[2])),le.normalized){const pe=At(Se[le.componentType]);Re.min.multiplyScalar(pe),Re.max.multiplyScalar(pe)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const Ce=ye.targets;if(Ce!==void 0){const le=new f.Vector3,j=new f.Vector3;for(let Z=0,pe=Ce.length;Z<pe;Z++){const Ee=Ce[Z];if(Ee.POSITION!==void 0){const Qe=_e.json.accessors[Ee.POSITION],He=Qe.min,Pt=Qe.max;if(He!==void 0&&Pt!==void 0){if(j.setX(Math.max(Math.abs(He[0]),Math.abs(Pt[0]))),j.setY(Math.max(Math.abs(He[1]),Math.abs(Pt[1]))),j.setZ(Math.max(Math.abs(He[2]),Math.abs(Pt[2]))),Qe.normalized){const rn=At(Se[Qe.componentType]);j.multiplyScalar(rn)}le.max(j)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Re.expandByVector(le)}bt.boundingBox=Re;const Ne=new f.Sphere;Re.getCenter(Ne.center),Ne.radius=Re.min.distanceTo(Re.max)/2,bt.boundingSphere=Ne}function Gt(bt,ye,_e){const Ue=ye.attributes,Re=[];function Ce(Ne,le){return _e.getDependency("accessor",Ne).then(function(j){bt.setAttribute(le,j)})}for(const Ne in Ue){const le=Te[Ne]||Ne.toLowerCase();le in bt.attributes||Re.push(Ce(Ue[Ne],le))}if(ye.indices!==void 0&&!bt.index){const Ne=_e.getDependency("accessor",ye.indices).then(function(le){bt.setIndex(le)});Re.push(Ne)}return f.ColorManagement.workingColorSpace!==f.LinearSRGBColorSpace&&"COLOR_0"in Ue&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${f.ColorManagement.workingColorSpace}" not supported.`),St(bt,ye),qn(bt,ye,_e),Promise.all(Re).then(function(){return ye.targets!==void 0?$t(bt,ye.targets,_e):bt})}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(u,p,c)=>{c.r(p),c.d(p,{KTX2Loader:()=>E});var f=c("./node_modules/three/build/three.module.js"),g=c("./node_modules/three/examples/jsm/utils/WorkerPool.js"),m=c("./node_modules/three/examples/jsm/libs/ktx-parse.module.js"),v=c("./node_modules/three/examples/jsm/libs/zstddec.module.js");const A=new WeakMap;let y=0,C;class E extends f.Loader{constructor(R){super(R),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new g.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(R){return this.transcoderPath=R,this}setWorkerLimit(R){return this.workerPool.setWorkerLimit(R),this}async detectSupportAsync(R){return this.workerConfig={astcSupported:await R.hasFeatureAsync("texture-compression-astc"),etc1Supported:await R.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await R.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await R.hasFeatureAsync("texture-compression-bc"),bptcSupported:await R.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await R.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(R){return R.isWebGPURenderer===!0?this.workerConfig={astcSupported:R.hasFeature("texture-compression-astc"),etc1Supported:R.hasFeature("texture-compression-etc1"),etc2Supported:R.hasFeature("texture-compression-etc2"),dxtSupported:R.hasFeature("texture-compression-bc"),bptcSupported:R.hasFeature("texture-compression-bptc"),pvrtcSupported:R.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:R.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:R.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:R.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:R.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:R.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:R.extensions.has("WEBGL_compressed_texture_pvrtc")||R.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const R=new f.FileLoader(this.manager);R.setPath(this.transcoderPath),R.setWithCredentials(this.withCredentials);const k=R.loadAsync("basis_transcoder.js"),P=new f.FileLoader(this.manager);P.setPath(this.transcoderPath),P.setResponseType("arraybuffer"),P.setWithCredentials(this.withCredentials);const F=P.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([k,F]).then(([O,W])=>{const V=E.BasisWorker.toString(),$=["/* constants */","let _EngineFormat = "+JSON.stringify(E.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(E.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(E.BasisFormat),"/* basis_transcoder.js */",O,"/* worker */",V.substring(V.indexOf("{")+1,V.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([$])),this.transcoderBinary=W,this.workerPool.setWorkerCreator(()=>{const H=new Worker(this.workerSourceURL),Y=this.transcoderBinary.slice(0);return H.postMessage({type:"init",config:this.workerConfig,transcoderBinary:Y},[Y]),H})}),y>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),y++}return this.transcoderPending}load(R,k,P,F){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const O=new f.FileLoader(this.manager);O.setResponseType("arraybuffer"),O.setWithCredentials(this.withCredentials),O.load(R,W=>{if(A.has(W))return A.get(W).promise.then(k).catch(F);this._createTexture(W).then(V=>k?k(V):null).catch(F)},P,F)}_createTextureFrom(R,k){const{faces:P,width:F,height:O,format:W,type:V,error:$,dfdFlags:H}=R;if(V==="error")return Promise.reject($);let Y;if(k.faceCount===6)Y=new f.CompressedCubeTexture(P,W,f.UnsignedByteType);else{const Q=P[0].mipmaps;Y=k.layerCount>1?new f.CompressedArrayTexture(Q,F,O,k.layerCount,W,f.UnsignedByteType):new f.CompressedTexture(Q,F,O,W,f.UnsignedByteType)}return Y.minFilter=P[0].mipmaps.length===1?f.LinearFilter:f.LinearMipmapLinearFilter,Y.magFilter=f.LinearFilter,Y.generateMipmaps=!1,Y.needsUpdate=!0,Y.colorSpace=I(k),Y.premultiplyAlpha=!!(H&m.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),Y}async _createTexture(R,k={}){const P=(0,m.read)(new Uint8Array(R));if(P.vkFormat!==m.VK_FORMAT_UNDEFINED)return S(P);const F=k,O=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:R,taskConfig:F},[R])).then(W=>this._createTextureFrom(W.data,P));return A.set(R,{promise:O}),O}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),y--,this}}E.BasisFormat={ETC1S:0,UASTC_4x4:1},E.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},E.EngineFormat={RGBAFormat:f.RGBAFormat,RGBA_ASTC_4x4_Format:f.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:f.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:f.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:f.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:f.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:f.RGB_ETC1_Format,RGB_ETC2_Format:f.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:f.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:f.RGBA_S3TC_DXT1_Format},E.BasisWorker=function(){let L,R,k;const P=_EngineFormat,F=_TranscoderFormat,O=_BasisFormat;self.addEventListener("message",function(K){const se=K.data;switch(se.type){case"init":L=se.config,W(se.transcoderBinary);break;case"transcode":R.then(()=>{try{const{faces:ue,buffers:he,width:Me,height:de,hasAlpha:Pe,format:Se,dfdFlags:Le}=V(se.buffer);self.postMessage({type:"transcode",id:se.id,faces:ue,width:Me,height:de,hasAlpha:Pe,format:Se,dfdFlags:Le},he)}catch(ue){console.error(ue),self.postMessage({type:"error",id:se.id,error:ue.message})}});break}});function W(K){R=new Promise(se=>{k={wasmBinary:K,onRuntimeInitialized:se},BASIS(k)}).then(()=>{k.initializeBasis(),k.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function V(K){const se=new k.KTX2File(new Uint8Array(K));function ue(){se.close(),se.delete()}if(!se.isValid())throw ue(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const he=se.isUASTC()?O.UASTC_4x4:O.ETC1S,Me=se.getWidth(),de=se.getHeight(),Pe=se.getLayers()||1,Se=se.getLevels(),Le=se.getFaces(),be=se.getHasAlpha(),je=se.getDFDFlags(),{transcoderFormat:Te,engineFormat:rt}=Q(he,Me,de,be);if(!Me||!de||!Se)throw ue(),new Error("THREE.KTX2Loader:	Invalid texture");if(!se.startTranscoding())throw ue(),new Error("THREE.KTX2Loader: .startTranscoding failed");const mt=[],vt=[];for(let ft=0;ft<Le;ft++){const Ze=[];for(let St=0;St<Se;St++){const $t=[];let ct,Ct;for(let At=0;At<Pe;At++){const pn=se.getImageLevelInfo(St,At,ft);ft===0&&St===0&&At===0&&(pn.origWidth%4!==0||pn.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),Se>1?(ct=pn.origWidth,Ct=pn.origHeight):(ct=pn.width,Ct=pn.height);const yt=new Uint8Array(se.getImageTranscodedSizeInBytes(St,At,0,Te));if(!se.transcodeImage(yt,St,At,ft,Te,0,-1,-1))throw ue(),new Error("THREE.KTX2Loader: .transcodeImage failed.");$t.push(yt)}const Tt=J($t);Ze.push({data:Tt,width:ct,height:Ct}),vt.push(Tt.buffer)}mt.push({mipmaps:Ze,width:Me,height:de,format:rt})}return ue(),{faces:mt,buffers:vt,width:Me,height:de,hasAlpha:be,format:rt,dfdFlags:je}}const $=[{if:"astcSupported",basisFormat:[O.UASTC_4x4],transcoderFormat:[F.ASTC_4x4,F.ASTC_4x4],engineFormat:[P.RGBA_ASTC_4x4_Format,P.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[O.ETC1S,O.UASTC_4x4],transcoderFormat:[F.BC7_M5,F.BC7_M5],engineFormat:[P.RGBA_BPTC_Format,P.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[O.ETC1S,O.UASTC_4x4],transcoderFormat:[F.BC1,F.BC3],engineFormat:[P.RGBA_S3TC_DXT1_Format,P.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[O.ETC1S,O.UASTC_4x4],transcoderFormat:[F.ETC1,F.ETC2],engineFormat:[P.RGB_ETC2_Format,P.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[O.ETC1S,O.UASTC_4x4],transcoderFormat:[F.ETC1],engineFormat:[P.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[O.ETC1S,O.UASTC_4x4],transcoderFormat:[F.PVRTC1_4_RGB,F.PVRTC1_4_RGBA],engineFormat:[P.RGB_PVRTC_4BPPV1_Format,P.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],H=$.sort(function(K,se){return K.priorityETC1S-se.priorityETC1S}),Y=$.sort(function(K,se){return K.priorityUASTC-se.priorityUASTC});function Q(K,se,ue,he){let Me,de;const Pe=K===O.ETC1S?H:Y;for(let Se=0;Se<Pe.length;Se++){const Le=Pe[Se];if(L[Le.if]&&Le.basisFormat.includes(K)&&!(he&&Le.transcoderFormat.length<2)&&!(Le.needsPowerOfTwo&&!(G(se)&&G(ue))))return Me=Le.transcoderFormat[he?1:0],de=Le.engineFormat[he?1:0],{transcoderFormat:Me,engineFormat:de}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),Me=F.RGBA32,de=P.RGBAFormat,{transcoderFormat:Me,engineFormat:de}}function G(K){return K<=2?!0:(K&K-1)===0&&K!==0}function J(K){if(K.length===1)return K[0];let se=0;for(let Me=0;Me<K.length;Me++){const de=K[Me];se+=de.byteLength}const ue=new Uint8Array(se);let he=0;for(let Me=0;Me<K.length;Me++){const de=K[Me];ue.set(de,he),he+=de.byteLength}return ue}};const x=new Set([f.RGBAFormat,f.RGFormat,f.RedFormat]),M={[m.VK_FORMAT_R32G32B32A32_SFLOAT]:f.RGBAFormat,[m.VK_FORMAT_R16G16B16A16_SFLOAT]:f.RGBAFormat,[m.VK_FORMAT_R8G8B8A8_UNORM]:f.RGBAFormat,[m.VK_FORMAT_R8G8B8A8_SRGB]:f.RGBAFormat,[m.VK_FORMAT_R32G32_SFLOAT]:f.RGFormat,[m.VK_FORMAT_R16G16_SFLOAT]:f.RGFormat,[m.VK_FORMAT_R8G8_UNORM]:f.RGFormat,[m.VK_FORMAT_R8G8_SRGB]:f.RGFormat,[m.VK_FORMAT_R32_SFLOAT]:f.RedFormat,[m.VK_FORMAT_R16_SFLOAT]:f.RedFormat,[m.VK_FORMAT_R8_SRGB]:f.RedFormat,[m.VK_FORMAT_R8_UNORM]:f.RedFormat,[m.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:f.RGBA_ASTC_6x6_Format,[m.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:f.RGBA_ASTC_6x6_Format},w={[m.VK_FORMAT_R32G32B32A32_SFLOAT]:f.FloatType,[m.VK_FORMAT_R16G16B16A16_SFLOAT]:f.HalfFloatType,[m.VK_FORMAT_R8G8B8A8_UNORM]:f.UnsignedByteType,[m.VK_FORMAT_R8G8B8A8_SRGB]:f.UnsignedByteType,[m.VK_FORMAT_R32G32_SFLOAT]:f.FloatType,[m.VK_FORMAT_R16G16_SFLOAT]:f.HalfFloatType,[m.VK_FORMAT_R8G8_UNORM]:f.UnsignedByteType,[m.VK_FORMAT_R8G8_SRGB]:f.UnsignedByteType,[m.VK_FORMAT_R32_SFLOAT]:f.FloatType,[m.VK_FORMAT_R16_SFLOAT]:f.HalfFloatType,[m.VK_FORMAT_R8_SRGB]:f.UnsignedByteType,[m.VK_FORMAT_R8_UNORM]:f.UnsignedByteType,[m.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:f.UnsignedByteType,[m.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:f.UnsignedByteType};async function S(L){const{vkFormat:R}=L;if(M[R]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let k;L.supercompressionScheme===m.KHR_SUPERCOMPRESSION_ZSTD&&(C||(C=new Promise(async O=>{const W=new v.ZSTDDecoder;await W.init(),O(W)})),k=await C);const P=[];for(let O=0;O<L.levels.length;O++){const W=Math.max(1,L.pixelWidth>>O),V=Math.max(1,L.pixelHeight>>O),$=L.pixelDepth?Math.max(1,L.pixelDepth>>O):0,H=L.levels[O];let Y;if(L.supercompressionScheme===m.KHR_SUPERCOMPRESSION_NONE)Y=H.levelData;else if(L.supercompressionScheme===m.KHR_SUPERCOMPRESSION_ZSTD)Y=k.decode(H.levelData,H.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let Q;w[R]===f.FloatType?Q=new Float32Array(Y.buffer,Y.byteOffset,Y.byteLength/Float32Array.BYTES_PER_ELEMENT):w[R]===f.HalfFloatType?Q=new Uint16Array(Y.buffer,Y.byteOffset,Y.byteLength/Uint16Array.BYTES_PER_ELEMENT):Q=Y,P.push({data:Q,width:W,height:V,depth:$})}let F;if(x.has(M[R]))F=L.pixelDepth===0?new f.DataTexture(P[0].data,L.pixelWidth,L.pixelHeight):new f.Data3DTexture(P[0].data,L.pixelWidth,L.pixelHeight,L.pixelDepth);else{if(L.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");F=new f.CompressedTexture(P,L.pixelWidth,L.pixelHeight)}return F.mipmaps=P,F.type=w[R],F.format=M[R],F.colorSpace=I(L),F.needsUpdate=!0,Promise.resolve(F)}function I(L){const R=L.dataFormatDescriptor[0];return R.colorPrimaries===m.KHR_DF_PRIMARIES_BT709?R.transferFunction===m.KHR_DF_TRANSFER_SRGB?f.SRGBColorSpace:f.LinearSRGBColorSpace:R.colorPrimaries===m.KHR_DF_PRIMARIES_DISPLAYP3?R.transferFunction===m.KHR_DF_TRANSFER_SRGB?f.DisplayP3ColorSpace:f.LinearDisplayP3ColorSpace:(R.colorPrimaries===m.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${R.colorPrimaries}"`),f.NoColorSpace)}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(u,p,c)=>{c.r(p),c.d(p,{MTLLoader:()=>g});var f=c("./node_modules/three/build/three.module.js");class g extends f.Loader{constructor(A){super(A)}load(A,y,C,E){const x=this,M=this.path===""?f.LoaderUtils.extractUrlBase(A):this.path,w=new f.FileLoader(this.manager);w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(A,function(S){try{y(x.parse(S,M))}catch(I){E?E(I):console.error(I),x.manager.itemError(A)}},C,E)}setMaterialOptions(A){return this.materialOptions=A,this}parse(A,y){const C=A.split(`
`);let E={};const x=/\s+/,M={};for(let S=0;S<C.length;S++){let I=C[S];if(I=I.trim(),I.length===0||I.charAt(0)==="#")continue;const L=I.indexOf(" ");let R=L>=0?I.substring(0,L):I;R=R.toLowerCase();let k=L>=0?I.substring(L+1):"";if(k=k.trim(),R==="newmtl")E={name:k},M[k]=E;else if(R==="ka"||R==="kd"||R==="ks"||R==="ke"){const P=k.split(x,3);E[R]=[parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2])]}else E[R]=k}const w=new m(this.resourcePath||y,this.materialOptions);return w.setCrossOrigin(this.crossOrigin),w.setManager(this.manager),w.setMaterials(M),w}}class m{constructor(A="",y={}){this.baseUrl=A,this.options=y,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:f.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:f.RepeatWrapping}setCrossOrigin(A){return this.crossOrigin=A,this}setManager(A){this.manager=A}setMaterials(A){this.materialsInfo=this.convert(A),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(A){if(!this.options)return A;const y={};for(const C in A){const E=A[C],x={};y[C]=x;for(const M in E){let w=!0,S=E[M];const I=M.toLowerCase();switch(I){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(S=[S[0]/255,S[1]/255,S[2]/255]),this.options&&this.options.ignoreZeroRGBs&&S[0]===0&&S[1]===0&&S[2]===0&&(w=!1);break}w&&(x[I]=S)}}return y}preload(){for(const A in this.materialsInfo)this.create(A)}getIndex(A){return this.nameLookup[A]}getAsArray(){let A=0;for(const y in this.materialsInfo)this.materialsArray[A]=this.create(y),this.nameLookup[y]=A,A++;return this.materialsArray}create(A){return this.materials[A]===void 0&&this.createMaterial_(A),this.materials[A]}createMaterial_(A){const y=this,C=this.materialsInfo[A],E={name:A,side:this.side};function x(w,S){return typeof S!="string"||S===""?"":/^https?:\/\//i.test(S)?S:w+S}function M(w,S){if(E[w])return;const I=y.getTextureParams(S,E),L=y.loadTexture(x(y.baseUrl,I.url));L.repeat.copy(I.scale),L.offset.copy(I.offset),L.wrapS=y.wrap,L.wrapT=y.wrap,(w==="map"||w==="emissiveMap")&&(L.colorSpace=f.SRGBColorSpace),E[w]=L}for(const w in C){const S=C[w];let I;if(S!=="")switch(w.toLowerCase()){case"kd":E.color=new f.Color().fromArray(S).convertSRGBToLinear();break;case"ks":E.specular=new f.Color().fromArray(S).convertSRGBToLinear();break;case"ke":E.emissive=new f.Color().fromArray(S).convertSRGBToLinear();break;case"map_kd":M("map",S);break;case"map_ks":M("specularMap",S);break;case"map_ke":M("emissiveMap",S);break;case"norm":M("normalMap",S);break;case"map_bump":case"bump":M("bumpMap",S);break;case"map_d":M("alphaMap",S),E.transparent=!0;break;case"ns":E.shininess=parseFloat(S);break;case"d":I=parseFloat(S),I<1&&(E.opacity=I,E.transparent=!0);break;case"tr":I=parseFloat(S),this.options&&this.options.invertTrProperty&&(I=1-I),I>0&&(E.opacity=1-I,E.transparent=!0);break}}return this.materials[A]=new f.MeshPhongMaterial(E),this.materials[A]}getTextureParams(A,y){const C={scale:new f.Vector2(1,1),offset:new f.Vector2(0,0)},E=A.split(/\s+/);let x;return x=E.indexOf("-bm"),x>=0&&(y.bumpScale=parseFloat(E[x+1]),E.splice(x,2)),x=E.indexOf("-s"),x>=0&&(C.scale.set(parseFloat(E[x+1]),parseFloat(E[x+2])),E.splice(x,4)),x=E.indexOf("-o"),x>=0&&(C.offset.set(parseFloat(E[x+1]),parseFloat(E[x+2])),E.splice(x,4)),C.url=E.join(" ").trim(),C}loadTexture(A,y,C,E,x){const M=this.manager!==void 0?this.manager:f.DefaultLoadingManager;let w=M.getHandler(A);w===null&&(w=new f.TextureLoader(M)),w.setCrossOrigin&&w.setCrossOrigin(this.crossOrigin);const S=w.load(A,C,E,x);return y!==void 0&&(S.mapping=y),S}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(u,p,c)=>{c.r(p),c.d(p,{OBJLoader:()=>L});var f=c("./node_modules/three/build/three.module.js");const g=/^[og]\s*(.+)?/,m=/^mtllib /,v=/^usemtl /,A=/^usemap /,y=/\s+/,C=new f.Vector3,E=new f.Vector3,x=new f.Vector3,M=new f.Vector3,w=new f.Vector3,S=new f.Color;function I(){const R={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(k,P){if(this.object&&this.object.fromDeclaration===!1){this.object.name=k,this.object.fromDeclaration=P!==!1;return}const F=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:k||"",fromDeclaration:P!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(O,W){const V=this._finalize(!1);V&&(V.inherited||V.groupCount<=0)&&this.materials.splice(V.index,1);const $={index:this.materials.length,name:O||"",mtllib:Array.isArray(W)&&W.length>0?W[W.length-1]:"",smooth:V!==void 0?V.smooth:this.smooth,groupStart:V!==void 0?V.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(H){const Y={index:typeof H=="number"?H:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return Y.clone=this.clone.bind(Y),Y}};return this.materials.push($),$},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(O){const W=this.currentMaterial();if(W&&W.groupEnd===-1&&(W.groupEnd=this.geometry.vertices.length/3,W.groupCount=W.groupEnd-W.groupStart,W.inherited=!1),O&&this.materials.length>1)for(let V=this.materials.length-1;V>=0;V--)this.materials[V].groupCount<=0&&this.materials.splice(V,1);return O&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),W}},F&&F.name&&typeof F.clone=="function"){const O=F.clone(0);O.inherited=!0,this.object.materials.push(O)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(k,P){const F=parseInt(k,10);return(F>=0?F-1:F+P/3)*3},parseNormalIndex:function(k,P){const F=parseInt(k,10);return(F>=0?F-1:F+P/3)*3},parseUVIndex:function(k,P){const F=parseInt(k,10);return(F>=0?F-1:F+P/2)*2},addVertex:function(k,P,F){const O=this.vertices,W=this.object.geometry.vertices;W.push(O[k+0],O[k+1],O[k+2]),W.push(O[P+0],O[P+1],O[P+2]),W.push(O[F+0],O[F+1],O[F+2])},addVertexPoint:function(k){const P=this.vertices;this.object.geometry.vertices.push(P[k+0],P[k+1],P[k+2])},addVertexLine:function(k){const P=this.vertices;this.object.geometry.vertices.push(P[k+0],P[k+1],P[k+2])},addNormal:function(k,P,F){const O=this.normals,W=this.object.geometry.normals;W.push(O[k+0],O[k+1],O[k+2]),W.push(O[P+0],O[P+1],O[P+2]),W.push(O[F+0],O[F+1],O[F+2])},addFaceNormal:function(k,P,F){const O=this.vertices,W=this.object.geometry.normals;C.fromArray(O,k),E.fromArray(O,P),x.fromArray(O,F),w.subVectors(x,E),M.subVectors(C,E),w.cross(M),w.normalize(),W.push(w.x,w.y,w.z),W.push(w.x,w.y,w.z),W.push(w.x,w.y,w.z)},addColor:function(k,P,F){const O=this.colors,W=this.object.geometry.colors;O[k]!==void 0&&W.push(O[k+0],O[k+1],O[k+2]),O[P]!==void 0&&W.push(O[P+0],O[P+1],O[P+2]),O[F]!==void 0&&W.push(O[F+0],O[F+1],O[F+2])},addUV:function(k,P,F){const O=this.uvs,W=this.object.geometry.uvs;W.push(O[k+0],O[k+1]),W.push(O[P+0],O[P+1]),W.push(O[F+0],O[F+1])},addDefaultUV:function(){const k=this.object.geometry.uvs;k.push(0,0),k.push(0,0),k.push(0,0)},addUVLine:function(k){const P=this.uvs;this.object.geometry.uvs.push(P[k+0],P[k+1])},addFace:function(k,P,F,O,W,V,$,H,Y){const Q=this.vertices.length;let G=this.parseVertexIndex(k,Q),J=this.parseVertexIndex(P,Q),K=this.parseVertexIndex(F,Q);if(this.addVertex(G,J,K),this.addColor(G,J,K),$!==void 0&&$!==""){const se=this.normals.length;G=this.parseNormalIndex($,se),J=this.parseNormalIndex(H,se),K=this.parseNormalIndex(Y,se),this.addNormal(G,J,K)}else this.addFaceNormal(G,J,K);if(O!==void 0&&O!==""){const se=this.uvs.length;G=this.parseUVIndex(O,se),J=this.parseUVIndex(W,se),K=this.parseUVIndex(V,se),this.addUV(G,J,K),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(k){this.object.geometry.type="Points";const P=this.vertices.length;for(let F=0,O=k.length;F<O;F++){const W=this.parseVertexIndex(k[F],P);this.addVertexPoint(W),this.addColor(W)}},addLineGeometry:function(k,P){this.object.geometry.type="Line";const F=this.vertices.length,O=this.uvs.length;for(let W=0,V=k.length;W<V;W++)this.addVertexLine(this.parseVertexIndex(k[W],F));for(let W=0,V=P.length;W<V;W++)this.addUVLine(this.parseUVIndex(P[W],O))}};return R.startObject("",!1),R}class L extends f.Loader{constructor(k){super(k),this.materials=null}load(k,P,F,O){const W=this,V=new f.FileLoader(this.manager);V.setPath(this.path),V.setRequestHeader(this.requestHeader),V.setWithCredentials(this.withCredentials),V.load(k,function($){try{P(W.parse($))}catch(H){O?O(H):console.error(H),W.manager.itemError(k)}},F,O)}setMaterials(k){return this.materials=k,this}parse(k){const P=new I;k.indexOf(`\r
`)!==-1&&(k=k.replace(/\r\n/g,`
`)),k.indexOf(`\\
`)!==-1&&(k=k.replace(/\\\n/g,""));const F=k.split(`
`);let O=[];for(let $=0,H=F.length;$<H;$++){const Y=F[$].trimStart();if(Y.length===0)continue;const Q=Y.charAt(0);if(Q!=="#")if(Q==="v"){const G=Y.split(y);switch(G[0]){case"v":P.vertices.push(parseFloat(G[1]),parseFloat(G[2]),parseFloat(G[3])),G.length>=7?(S.setRGB(parseFloat(G[4]),parseFloat(G[5]),parseFloat(G[6])).convertSRGBToLinear(),P.colors.push(S.r,S.g,S.b)):P.colors.push(void 0,void 0,void 0);break;case"vn":P.normals.push(parseFloat(G[1]),parseFloat(G[2]),parseFloat(G[3]));break;case"vt":P.uvs.push(parseFloat(G[1]),parseFloat(G[2]));break}}else if(Q==="f"){const J=Y.slice(1).trim().split(y),K=[];for(let ue=0,he=J.length;ue<he;ue++){const Me=J[ue];if(Me.length>0){const de=Me.split("/");K.push(de)}}const se=K[0];for(let ue=1,he=K.length-1;ue<he;ue++){const Me=K[ue],de=K[ue+1];P.addFace(se[0],Me[0],de[0],se[1],Me[1],de[1],se[2],Me[2],de[2])}}else if(Q==="l"){const G=Y.substring(1).trim().split(" ");let J=[];const K=[];if(Y.indexOf("/")===-1)J=G;else for(let se=0,ue=G.length;se<ue;se++){const he=G[se].split("/");he[0]!==""&&J.push(he[0]),he[1]!==""&&K.push(he[1])}P.addLineGeometry(J,K)}else if(Q==="p"){const J=Y.slice(1).trim().split(" ");P.addPointGeometry(J)}else if((O=g.exec(Y))!==null){const G=(" "+O[0].slice(1).trim()).slice(1);P.startObject(G)}else if(v.test(Y))P.object.startMaterial(Y.substring(7).trim(),P.materialLibraries);else if(m.test(Y))P.materialLibraries.push(Y.substring(7).trim());else if(A.test(Y))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(Q==="s"){if(O=Y.split(" "),O.length>1){const J=O[1].trim().toLowerCase();P.object.smooth=J!=="0"&&J!=="off"}else P.object.smooth=!0;const G=P.object.currentMaterial();G&&(G.smooth=P.object.smooth)}else{if(Y==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+Y+'"')}}P.finalize();const W=new f.Group;if(W.materialLibraries=[].concat(P.materialLibraries),!(P.objects.length===1&&P.objects[0].geometry.vertices.length===0)===!0)for(let $=0,H=P.objects.length;$<H;$++){const Y=P.objects[$],Q=Y.geometry,G=Y.materials,J=Q.type==="Line",K=Q.type==="Points";let se=!1;if(Q.vertices.length===0)continue;const ue=new f.BufferGeometry;ue.setAttribute("position",new f.Float32BufferAttribute(Q.vertices,3)),Q.normals.length>0&&ue.setAttribute("normal",new f.Float32BufferAttribute(Q.normals,3)),Q.colors.length>0&&(se=!0,ue.setAttribute("color",new f.Float32BufferAttribute(Q.colors,3))),Q.hasUVIndices===!0&&ue.setAttribute("uv",new f.Float32BufferAttribute(Q.uvs,2));const he=[];for(let de=0,Pe=G.length;de<Pe;de++){const Se=G[de],Le=Se.name+"_"+Se.smooth+"_"+se;let be=P.materials[Le];if(this.materials!==null){if(be=this.materials.create(Se.name),J&&be&&!(be instanceof f.LineBasicMaterial)){const je=new f.LineBasicMaterial;f.Material.prototype.copy.call(je,be),je.color.copy(be.color),be=je}else if(K&&be&&!(be instanceof f.PointsMaterial)){const je=new f.PointsMaterial({size:10,sizeAttenuation:!1});f.Material.prototype.copy.call(je,be),je.color.copy(be.color),je.map=be.map,be=je}}be===void 0&&(J?be=new f.LineBasicMaterial:K?be=new f.PointsMaterial({size:1,sizeAttenuation:!1}):be=new f.MeshPhongMaterial,be.name=Se.name,be.flatShading=!Se.smooth,be.vertexColors=se,P.materials[Le]=be),he.push(be)}let Me;if(he.length>1){for(let de=0,Pe=G.length;de<Pe;de++){const Se=G[de];ue.addGroup(Se.groupStart,Se.groupCount,de)}J?Me=new f.LineSegments(ue,he):K?Me=new f.Points(ue,he):Me=new f.Mesh(ue,he)}else J?Me=new f.LineSegments(ue,he[0]):K?Me=new f.Points(ue,he[0]):Me=new f.Mesh(ue,he[0]);Me.name=Y.name,W.add(Me)}else if(P.vertices.length>0){const $=new f.PointsMaterial({size:1,sizeAttenuation:!1}),H=new f.BufferGeometry;H.setAttribute("position",new f.Float32BufferAttribute(P.vertices,3)),P.colors.length>0&&P.colors[0]!==void 0&&(H.setAttribute("color",new f.Float32BufferAttribute(P.colors,3)),$.vertexColors=!0);const Y=new f.Points(H,$);W.add(Y)}return W}}},"./node_modules/three/examples/jsm/math/OBB.js":(u,p,c)=>{c.r(p),c.d(p,{OBB:()=>F});var f=c("./node_modules/three/build/three.module.js");const g={c:null,u:[new f.Vector3,new f.Vector3,new f.Vector3],e:[]},m={c:null,u:[new f.Vector3,new f.Vector3,new f.Vector3],e:[]},v=[[],[],[]],A=[[],[],[]],y=[],C=new f.Vector3,E=new f.Vector3,x=new f.Vector3,M=new f.Vector3,w=new f.Vector3,S=new f.Vector3,I=new f.Matrix3,L=new f.Box3,R=new f.Matrix4,k=new f.Matrix4,P=new f.Ray;class F{constructor(V=new f.Vector3,$=new f.Vector3,H=new f.Matrix3){this.center=V,this.halfSize=$,this.rotation=H}set(V,$,H){return this.center=V,this.halfSize=$,this.rotation=H,this}copy(V){return this.center.copy(V.center),this.halfSize.copy(V.halfSize),this.rotation.copy(V.rotation),this}clone(){return new this.constructor().copy(this)}getSize(V){return V.copy(this.halfSize).multiplyScalar(2)}clampPoint(V,$){const H=this.halfSize;M.subVectors(V,this.center),this.rotation.extractBasis(C,E,x),$.copy(this.center);const Y=f.MathUtils.clamp(M.dot(C),-H.x,H.x);$.add(C.multiplyScalar(Y));const Q=f.MathUtils.clamp(M.dot(E),-H.y,H.y);$.add(E.multiplyScalar(Q));const G=f.MathUtils.clamp(M.dot(x),-H.z,H.z);return $.add(x.multiplyScalar(G)),$}containsPoint(V){return M.subVectors(V,this.center),this.rotation.extractBasis(C,E,x),Math.abs(M.dot(C))<=this.halfSize.x&&Math.abs(M.dot(E))<=this.halfSize.y&&Math.abs(M.dot(x))<=this.halfSize.z}intersectsBox3(V){return this.intersectsOBB(O.fromBox3(V))}intersectsSphere(V){return this.clampPoint(V.center,S),S.distanceToSquared(V.center)<=V.radius*V.radius}intersectsOBB(V,$=Number.EPSILON){g.c=this.center,g.e[0]=this.halfSize.x,g.e[1]=this.halfSize.y,g.e[2]=this.halfSize.z,this.rotation.extractBasis(g.u[0],g.u[1],g.u[2]),m.c=V.center,m.e[0]=V.halfSize.x,m.e[1]=V.halfSize.y,m.e[2]=V.halfSize.z,V.rotation.extractBasis(m.u[0],m.u[1],m.u[2]);for(let Q=0;Q<3;Q++)for(let G=0;G<3;G++)v[Q][G]=g.u[Q].dot(m.u[G]);M.subVectors(m.c,g.c),y[0]=M.dot(g.u[0]),y[1]=M.dot(g.u[1]),y[2]=M.dot(g.u[2]);for(let Q=0;Q<3;Q++)for(let G=0;G<3;G++)A[Q][G]=Math.abs(v[Q][G])+$;let H,Y;for(let Q=0;Q<3;Q++)if(H=g.e[Q],Y=m.e[0]*A[Q][0]+m.e[1]*A[Q][1]+m.e[2]*A[Q][2],Math.abs(y[Q])>H+Y)return!1;for(let Q=0;Q<3;Q++)if(H=g.e[0]*A[0][Q]+g.e[1]*A[1][Q]+g.e[2]*A[2][Q],Y=m.e[Q],Math.abs(y[0]*v[0][Q]+y[1]*v[1][Q]+y[2]*v[2][Q])>H+Y)return!1;return H=g.e[1]*A[2][0]+g.e[2]*A[1][0],Y=m.e[1]*A[0][2]+m.e[2]*A[0][1],!(Math.abs(y[2]*v[1][0]-y[1]*v[2][0])>H+Y||(H=g.e[1]*A[2][1]+g.e[2]*A[1][1],Y=m.e[0]*A[0][2]+m.e[2]*A[0][0],Math.abs(y[2]*v[1][1]-y[1]*v[2][1])>H+Y)||(H=g.e[1]*A[2][2]+g.e[2]*A[1][2],Y=m.e[0]*A[0][1]+m.e[1]*A[0][0],Math.abs(y[2]*v[1][2]-y[1]*v[2][2])>H+Y)||(H=g.e[0]*A[2][0]+g.e[2]*A[0][0],Y=m.e[1]*A[1][2]+m.e[2]*A[1][1],Math.abs(y[0]*v[2][0]-y[2]*v[0][0])>H+Y)||(H=g.e[0]*A[2][1]+g.e[2]*A[0][1],Y=m.e[0]*A[1][2]+m.e[2]*A[1][0],Math.abs(y[0]*v[2][1]-y[2]*v[0][1])>H+Y)||(H=g.e[0]*A[2][2]+g.e[2]*A[0][2],Y=m.e[0]*A[1][1]+m.e[1]*A[1][0],Math.abs(y[0]*v[2][2]-y[2]*v[0][2])>H+Y)||(H=g.e[0]*A[1][0]+g.e[1]*A[0][0],Y=m.e[1]*A[2][2]+m.e[2]*A[2][1],Math.abs(y[1]*v[0][0]-y[0]*v[1][0])>H+Y)||(H=g.e[0]*A[1][1]+g.e[1]*A[0][1],Y=m.e[0]*A[2][2]+m.e[2]*A[2][0],Math.abs(y[1]*v[0][1]-y[0]*v[1][1])>H+Y)||(H=g.e[0]*A[1][2]+g.e[1]*A[0][2],Y=m.e[0]*A[2][1]+m.e[1]*A[2][0],Math.abs(y[1]*v[0][2]-y[0]*v[1][2])>H+Y))}intersectsPlane(V){this.rotation.extractBasis(C,E,x);const $=this.halfSize.x*Math.abs(V.normal.dot(C))+this.halfSize.y*Math.abs(V.normal.dot(E))+this.halfSize.z*Math.abs(V.normal.dot(x)),H=V.normal.dot(this.center)-V.constant;return Math.abs(H)<=$}intersectRay(V,$){return this.getSize(w),L.setFromCenterAndSize(M.set(0,0,0),w),R.setFromMatrix3(this.rotation),R.setPosition(this.center),k.copy(R).invert(),P.copy(V).applyMatrix4(k),P.intersectBox(L,$)?$.applyMatrix4(R):null}intersectsRay(V){return this.intersectRay(V,M)!==null}fromBox3(V){return V.getCenter(this.center),V.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(V){return V.center.equals(this.center)&&V.halfSize.equals(this.halfSize)&&V.rotation.equals(this.rotation)}applyMatrix4(V){const $=V.elements;let H=M.set($[0],$[1],$[2]).length();const Y=M.set($[4],$[5],$[6]).length(),Q=M.set($[8],$[9],$[10]).length();V.determinant()<0&&(H=-H),I.setFromMatrix4(V);const J=1/H,K=1/Y,se=1/Q;return I.elements[0]*=J,I.elements[1]*=J,I.elements[2]*=J,I.elements[3]*=K,I.elements[4]*=K,I.elements[5]*=K,I.elements[6]*=se,I.elements[7]*=se,I.elements[8]*=se,this.rotation.multiply(I),this.halfSize.x*=H,this.halfSize.y*=Y,this.halfSize.z*=Q,M.setFromMatrixPosition(V),this.center.add(M),this}}const O=new F},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(u,p,c)=>{c.r(p),c.d(p,{computeMikkTSpaceTangents:()=>g,computeMorphedAttributes:()=>S,deepCloneAttribute:()=>A,deinterleaveAttribute:()=>C,deinterleaveGeometry:()=>E,estimateBytesUsed:()=>x,interleaveAttributes:()=>y,mergeAttributes:()=>v,mergeGeometries:()=>m,mergeGroups:()=>I,mergeVertices:()=>M,toCreasedNormals:()=>L,toTrianglesDrawMode:()=>w});var f=c("./node_modules/three/build/three.module.js");function g(R,k,P=!0){if(!k||!k.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!R.hasAttribute("position")||!R.hasAttribute("normal")||!R.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function F(V){if(V.normalized||V.isInterleavedBufferAttribute){const $=new Float32Array(V.count*V.itemSize);for(let H=0,Y=0;H<V.count;H++)$[Y++]=V.getX(H),$[Y++]=V.getY(H),V.itemSize>2&&($[Y++]=V.getZ(H));return $}return V.array instanceof Float32Array?V.array:new Float32Array(V.array)}const O=R.index?R.toNonIndexed():R,W=k.generateTangents(F(O.attributes.position),F(O.attributes.normal),F(O.attributes.uv));if(P)for(let V=3;V<W.length;V+=4)W[V]*=-1;return O.setAttribute("tangent",new f.BufferAttribute(W,4)),R!==O&&R.copy(O),R}function m(R,k=!1){const P=R[0].index!==null,F=new Set(Object.keys(R[0].attributes)),O=new Set(Object.keys(R[0].morphAttributes)),W={},V={},$=R[0].morphTargetsRelative,H=new f.BufferGeometry;let Y=0;for(let Q=0;Q<R.length;++Q){const G=R[Q];let J=0;if(P!==(G.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Q+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const K in G.attributes){if(!F.has(K))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Q+'. All geometries must have compatible attributes; make sure "'+K+'" attribute exists among all geometries, or in none of them.'),null;W[K]===void 0&&(W[K]=[]),W[K].push(G.attributes[K]),J++}if(J!==F.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Q+". Make sure all geometries have the same number of attributes."),null;if($!==G.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Q+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const K in G.morphAttributes){if(!O.has(K))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Q+".  .morphAttributes must be consistent throughout all geometries."),null;V[K]===void 0&&(V[K]=[]),V[K].push(G.morphAttributes[K])}if(k){let K;if(P)K=G.index.count;else if(G.attributes.position!==void 0)K=G.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+Q+". The geometry must have either an index or a position attribute"),null;H.addGroup(Y,K,Q),Y+=K}}if(P){let Q=0;const G=[];for(let J=0;J<R.length;++J){const K=R[J].index;for(let se=0;se<K.count;++se)G.push(K.getX(se)+Q);Q+=R[J].attributes.position.count}H.setIndex(G)}for(const Q in W){const G=v(W[Q]);if(!G)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Q+" attribute."),null;H.setAttribute(Q,G)}for(const Q in V){const G=V[Q][0].length;if(G===0)break;H.morphAttributes=H.morphAttributes||{},H.morphAttributes[Q]=[];for(let J=0;J<G;++J){const K=[];for(let ue=0;ue<V[Q].length;++ue)K.push(V[Q][ue][J]);const se=v(K);if(!se)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+Q+" morphAttribute."),null;H.morphAttributes[Q].push(se)}}return H}function v(R){let k,P,F,O=-1,W=0;for(let Y=0;Y<R.length;++Y){const Q=R[Y];if(k===void 0&&(k=Q.array.constructor),k!==Q.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(P===void 0&&(P=Q.itemSize),P!==Q.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(F===void 0&&(F=Q.normalized),F!==Q.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(O===-1&&(O=Q.gpuType),O!==Q.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;W+=Q.count*P}const V=new k(W),$=new f.BufferAttribute(V,P,F);let H=0;for(let Y=0;Y<R.length;++Y){const Q=R[Y];if(Q.isInterleavedBufferAttribute){const G=H/P;for(let J=0,K=Q.count;J<K;J++)for(let se=0;se<P;se++){const ue=Q.getComponent(J,se);$.setComponent(J+G,se,ue)}}else V.set(Q.array,H);H+=Q.count*P}return O!==void 0&&($.gpuType=O),$}function A(R){return R.isInstancedInterleavedBufferAttribute||R.isInterleavedBufferAttribute?C(R):R.isInstancedBufferAttribute?new f.InstancedBufferAttribute().copy(R):new f.BufferAttribute().copy(R)}function y(R){let k,P=0,F=0;for(let Y=0,Q=R.length;Y<Q;++Y){const G=R[Y];if(k===void 0&&(k=G.array.constructor),k!==G.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;P+=G.array.length,F+=G.itemSize}const O=new f.InterleavedBuffer(new k(P),F);let W=0;const V=[],$=["getX","getY","getZ","getW"],H=["setX","setY","setZ","setW"];for(let Y=0,Q=R.length;Y<Q;Y++){const G=R[Y],J=G.itemSize,K=G.count,se=new f.InterleavedBufferAttribute(O,J,W,G.normalized);V.push(se),W+=J;for(let ue=0;ue<K;ue++)for(let he=0;he<J;he++)se[H[he]](ue,G[$[he]](ue))}return V}function C(R){const k=R.data.array.constructor,P=R.count,F=R.itemSize,O=R.normalized,W=new k(P*F);let V;R.isInstancedInterleavedBufferAttribute?V=new f.InstancedBufferAttribute(W,F,O,R.meshPerAttribute):V=new f.BufferAttribute(W,F,O);for(let $=0;$<P;$++)V.setX($,R.getX($)),F>=2&&V.setY($,R.getY($)),F>=3&&V.setZ($,R.getZ($)),F>=4&&V.setW($,R.getW($));return V}function E(R){const k=R.attributes,P=R.morphTargets,F=new Map;for(const O in k){const W=k[O];W.isInterleavedBufferAttribute&&(F.has(W)||F.set(W,C(W)),k[O]=F.get(W))}for(const O in P){const W=P[O];W.isInterleavedBufferAttribute&&(F.has(W)||F.set(W,C(W)),P[O]=F.get(W))}}function x(R){let k=0;for(const F in R.attributes){const O=R.getAttribute(F);k+=O.count*O.itemSize*O.array.BYTES_PER_ELEMENT}const P=R.getIndex();return k+=P?P.count*P.itemSize*P.array.BYTES_PER_ELEMENT:0,k}function M(R,k=1e-4){k=Math.max(k,Number.EPSILON);const P={},F=R.getIndex(),O=R.getAttribute("position"),W=F?F.count:O.count;let V=0;const $=Object.keys(R.attributes),H={},Y={},Q=[],G=["getX","getY","getZ","getW"],J=["setX","setY","setZ","setW"];for(let de=0,Pe=$.length;de<Pe;de++){const Se=$[de],Le=R.attributes[Se];H[Se]=new f.BufferAttribute(new Le.array.constructor(Le.count*Le.itemSize),Le.itemSize,Le.normalized);const be=R.morphAttributes[Se];be&&(Y[Se]=new f.BufferAttribute(new be.array.constructor(be.count*be.itemSize),be.itemSize,be.normalized))}const K=k*.5,se=Math.log10(1/k),ue=Math.pow(10,se),he=K*ue;for(let de=0;de<W;de++){const Pe=F?F.getX(de):de;let Se="";for(let Le=0,be=$.length;Le<be;Le++){const je=$[Le],Te=R.getAttribute(je),rt=Te.itemSize;for(let mt=0;mt<rt;mt++)Se+=`${~~(Te[G[mt]](Pe)*ue+he)},`}if(Se in P)Q.push(P[Se]);else{for(let Le=0,be=$.length;Le<be;Le++){const je=$[Le],Te=R.getAttribute(je),rt=R.morphAttributes[je],mt=Te.itemSize,vt=H[je],ft=Y[je];for(let Ze=0;Ze<mt;Ze++){const St=G[Ze],$t=J[Ze];if(vt[$t](V,Te[St](Pe)),rt)for(let ct=0,Ct=rt.length;ct<Ct;ct++)ft[ct][$t](V,rt[ct][St](Pe))}}P[Se]=V,Q.push(V),V++}}const Me=R.clone();for(const de in R.attributes){const Pe=H[de];if(Me.setAttribute(de,new f.BufferAttribute(Pe.array.slice(0,V*Pe.itemSize),Pe.itemSize,Pe.normalized)),de in Y)for(let Se=0;Se<Y[de].length;Se++){const Le=Y[de][Se];Me.morphAttributes[de][Se]=new f.BufferAttribute(Le.array.slice(0,V*Le.itemSize),Le.itemSize,Le.normalized)}}return Me.setIndex(Q),Me}function w(R,k){if(k===f.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),R;if(k===f.TriangleFanDrawMode||k===f.TriangleStripDrawMode){let P=R.getIndex();if(P===null){const V=[],$=R.getAttribute("position");if($!==void 0){for(let H=0;H<$.count;H++)V.push(H);R.setIndex(V),P=R.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),R}const F=P.count-2,O=[];if(k===f.TriangleFanDrawMode)for(let V=1;V<=F;V++)O.push(P.getX(0)),O.push(P.getX(V)),O.push(P.getX(V+1));else for(let V=0;V<F;V++)V%2===0?(O.push(P.getX(V)),O.push(P.getX(V+1)),O.push(P.getX(V+2))):(O.push(P.getX(V+2)),O.push(P.getX(V+1)),O.push(P.getX(V)));O.length/3!==F&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const W=R.clone();return W.setIndex(O),W.clearGroups(),W}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",k),R}function S(R){const k=new f.Vector3,P=new f.Vector3,F=new f.Vector3,O=new f.Vector3,W=new f.Vector3,V=new f.Vector3,$=new f.Vector3,H=new f.Vector3,Y=new f.Vector3;function Q(At,pn,yt,kn,qn,Gt,bt,ye){k.fromBufferAttribute(pn,qn),P.fromBufferAttribute(pn,Gt),F.fromBufferAttribute(pn,bt);const _e=At.morphTargetInfluences;if(yt&&_e){$.set(0,0,0),H.set(0,0,0),Y.set(0,0,0);for(let Ue=0,Re=yt.length;Ue<Re;Ue++){const Ce=_e[Ue],Ne=yt[Ue];Ce!==0&&(O.fromBufferAttribute(Ne,qn),W.fromBufferAttribute(Ne,Gt),V.fromBufferAttribute(Ne,bt),kn?($.addScaledVector(O,Ce),H.addScaledVector(W,Ce),Y.addScaledVector(V,Ce)):($.addScaledVector(O.sub(k),Ce),H.addScaledVector(W.sub(P),Ce),Y.addScaledVector(V.sub(F),Ce)))}k.add($),P.add(H),F.add(Y)}At.isSkinnedMesh&&(At.applyBoneTransform(qn,k),At.applyBoneTransform(Gt,P),At.applyBoneTransform(bt,F)),ye[qn*3+0]=k.x,ye[qn*3+1]=k.y,ye[qn*3+2]=k.z,ye[Gt*3+0]=P.x,ye[Gt*3+1]=P.y,ye[Gt*3+2]=P.z,ye[bt*3+0]=F.x,ye[bt*3+1]=F.y,ye[bt*3+2]=F.z}const G=R.geometry,J=R.material;let K,se,ue;const he=G.index,Me=G.attributes.position,de=G.morphAttributes.position,Pe=G.morphTargetsRelative,Se=G.attributes.normal,Le=G.morphAttributes.position,be=G.groups,je=G.drawRange;let Te,rt,mt,vt,ft,Ze,St;const $t=new Float32Array(Me.count*Me.itemSize),ct=new Float32Array(Se.count*Se.itemSize);if(he!==null)if(Array.isArray(J))for(Te=0,mt=be.length;Te<mt;Te++)for(ft=be[Te],Ze=Math.max(ft.start,je.start),St=Math.min(ft.start+ft.count,je.start+je.count),rt=Ze,vt=St;rt<vt;rt+=3)K=he.getX(rt),se=he.getX(rt+1),ue=he.getX(rt+2),Q(R,Me,de,Pe,K,se,ue,$t),Q(R,Se,Le,Pe,K,se,ue,ct);else for(Ze=Math.max(0,je.start),St=Math.min(he.count,je.start+je.count),Te=Ze,mt=St;Te<mt;Te+=3)K=he.getX(Te),se=he.getX(Te+1),ue=he.getX(Te+2),Q(R,Me,de,Pe,K,se,ue,$t),Q(R,Se,Le,Pe,K,se,ue,ct);else if(Array.isArray(J))for(Te=0,mt=be.length;Te<mt;Te++)for(ft=be[Te],Ze=Math.max(ft.start,je.start),St=Math.min(ft.start+ft.count,je.start+je.count),rt=Ze,vt=St;rt<vt;rt+=3)K=rt,se=rt+1,ue=rt+2,Q(R,Me,de,Pe,K,se,ue,$t),Q(R,Se,Le,Pe,K,se,ue,ct);else for(Ze=Math.max(0,je.start),St=Math.min(Me.count,je.start+je.count),Te=Ze,mt=St;Te<mt;Te+=3)K=Te,se=Te+1,ue=Te+2,Q(R,Me,de,Pe,K,se,ue,$t),Q(R,Se,Le,Pe,K,se,ue,ct);const Ct=new f.Float32BufferAttribute($t,3),Tt=new f.Float32BufferAttribute(ct,3);return{positionAttribute:Me,normalAttribute:Se,morphedPositionAttribute:Ct,morphedNormalAttribute:Tt}}function I(R){if(R.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),R;let k=R.groups;if(k=k.sort((V,$)=>V.materialIndex!==$.materialIndex?V.materialIndex-$.materialIndex:V.start-$.start),R.getIndex()===null){const V=R.getAttribute("position"),$=[];for(let H=0;H<V.count;H+=3)$.push(H,H+1,H+2);R.setIndex($)}const P=R.getIndex(),F=[];for(let V=0;V<k.length;V++){const $=k[V],H=$.start,Y=H+$.count;for(let Q=H;Q<Y;Q++)F.push(P.getX(Q))}R.dispose(),R.setIndex(F);let O=0;for(let V=0;V<k.length;V++){const $=k[V];$.start=O,O+=$.count}let W=k[0];R.groups=[W];for(let V=1;V<k.length;V++){const $=k[V];W.materialIndex===$.materialIndex?W.count+=$.count:(W=$,R.groups.push(W))}return R}function L(R,k=Math.PI/3){const P=Math.cos(k),F=(1+1e-10)*100,O=[new f.Vector3,new f.Vector3,new f.Vector3],W=new f.Vector3,V=new f.Vector3,$=new f.Vector3,H=new f.Vector3;function Y(ue){const he=~~(ue.x*F),Me=~~(ue.y*F),de=~~(ue.z*F);return`${he},${Me},${de}`}const Q=R.index?R.toNonIndexed():R,G=Q.attributes.position,J={};for(let ue=0,he=G.count/3;ue<he;ue++){const Me=3*ue,de=O[0].fromBufferAttribute(G,Me+0),Pe=O[1].fromBufferAttribute(G,Me+1),Se=O[2].fromBufferAttribute(G,Me+2);W.subVectors(Se,Pe),V.subVectors(de,Pe);const Le=new f.Vector3().crossVectors(W,V).normalize();for(let be=0;be<3;be++){const je=O[be],Te=Y(je);Te in J||(J[Te]=[]),J[Te].push(Le)}}const K=new Float32Array(G.count*3),se=new f.BufferAttribute(K,3,!1);for(let ue=0,he=G.count/3;ue<he;ue++){const Me=3*ue,de=O[0].fromBufferAttribute(G,Me+0),Pe=O[1].fromBufferAttribute(G,Me+1),Se=O[2].fromBufferAttribute(G,Me+2);W.subVectors(Se,Pe),V.subVectors(de,Pe),$.crossVectors(W,V).normalize();for(let Le=0;Le<3;Le++){const be=O[Le],je=Y(be),Te=J[je];H.set(0,0,0);for(let rt=0,mt=Te.length;rt<mt;rt++){const vt=Te[rt];$.dot(vt)>P&&H.add(vt)}H.normalize(),se.setXYZ(Me+Le,H.x,H.y,H.z)}}return Q.setAttribute("normal",se),Q}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(u,p,c)=>{c.r(p),c.d(p,{WorkerPool:()=>f});class f{constructor(m=4){this.pool=m,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(m){if(!this.workers[m]){const v=this.workerCreator();v.addEventListener("message",this._onMessage.bind(this,m)),this.workers[m]=v}}_getIdleWorker(){for(let m=0;m<this.pool;m++)if(!(this.workerStatus&1<<m))return m;return-1}_onMessage(m,v){const A=this.workersResolve[m];if(A&&A(v),this.queue.length){const{resolve:y,msg:C,transfer:E}=this.queue.shift();this.workersResolve[m]=y,this.workers[m].postMessage(C,E)}else this.workerStatus^=1<<m}setWorkerCreator(m){this.workerCreator=m}setWorkerLimit(m){this.pool=m}postMessage(m,v){return new Promise(A=>{const y=this._getIdleWorker();y!==-1?(this._initWorker(y),this.workerStatus|=1<<y,this.workersResolve[y]=A,this.workers[y].postMessage(m,v)):this.queue.push({resolve:A,msg:m,transfer:v})})}dispose(){this.workers.forEach(m=>m.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./src/lib/three.mjs":(u,p,c)=>{c.r(p),c.d(p,{default:()=>w});var f=c("./node_modules/three/build/three.module.js"),g=c("./node_modules/three/examples/jsm/loaders/DRACOLoader.js"),m=c("./node_modules/three/examples/jsm/loaders/GLTFLoader.js"),v=c("./node_modules/three/examples/jsm/loaders/KTX2Loader.js"),A=c("./node_modules/three/examples/jsm/math/OBB.js"),y=c("./node_modules/three/examples/jsm/loaders/OBJLoader.js"),C=c("./node_modules/three/examples/jsm/loaders/MTLLoader.js"),E=c("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js"),x=c("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js"),M={...f};M.DRACOLoader=g.DRACOLoader,M.GLTFLoader=m.GLTFLoader,M.KTX2Loader=v.KTX2Loader,M.OBJLoader=y.OBJLoader,M.MTLLoader=C.MTLLoader,M.OBB=A.OBB,M.BufferGeometryUtils=E,M.LightProbeGenerator=x.LightProbeGenerator;const w=M},"./package.json":u=>{u.exports=JSON.parse('{"name":"aframe","version":"1.6.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.5.0 1.6.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node --experimental-require-module ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.164.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},o={};function a(u){var p=o[u];if(p!==void 0)return p.exports;var c=o[u]={id:u,exports:{}};return r[u].call(c.exports,c,c.exports,a),c.exports}a.m=r,a.n=u=>{var p=u&&u.__esModule?()=>u.default:()=>u;return a.d(p,{a:p}),p},a.d=(u,p)=>{for(var c in p)a.o(p,c)&&!a.o(u,c)&&Object.defineProperty(u,c,{enumerable:!0,get:p[c]})},a.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),a.o=(u,p)=>Object.prototype.hasOwnProperty.call(u,p),a.r=u=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},a.b=document.baseURI||self.location.href,a.nc=void 0;var h=a("./src/index.js");return h})())})(fP);var Sw=fP.exports;const Pae=gE(Sw),Dae=PU({__proto__:null,default:Pae},[Sw]),Nae={},Oae={};AFRAME.registerComponent("svelte",{multiple:!0,schema:{props:{default:{},parse(e){switch(typeof e){case"string":return JSON.parse(e);default:return e}},serialize(e){return JSON.stringify(e)}},component:{parse(e){return Nae[e]},serialize(e){return e.name}},gather:{parse(e){return Oae[e]},serialize(e){return e.name},default:function(){return this.data.props}}},update(){this.remove(),this.data.component&&requestAnimationFrame(()=>{this.svelte=new this.data.component({target:this.el,props:this.data.gather.call(this)})})},remove(){this.svelte&&(this.svelte.$destroy(),delete this.svelte)}});function NI(e,t,i){const r=e.slice();return r[17]=t[i],r}function OI(e,t,i){const r=e.slice();return r[20]=t[i],r}function Fae(e,t,i){const r=e.slice();return r[23]=t[i],r}function kae(e,t,i){const r=e.slice();return r[23]=t[i],r}function FI(e,t,i){const r=e.slice();return r[28]=t[i],r}function kI(e,t,i){const r=e.slice();return r[31]=t[i],r}function UI(e){let t,i,r;return{c(){t=oe("a-cylinder"),i=ge(),r=oe("a-entity"),Fn(t,"position",`${Jp/2} 0 ${e[31]-5}`),Fn(t,"radius",.02*(e[31]/6+1)),Fn(t,"height","26"),Fn(t,"rotation","0 0 90"),Fn(t,"color",e[7][qp-e[31]-1]),Fn(r,"text","value: "+e[6][e[31]]+"; color: #666"),Fn(r,"position",`2.5 0 ${e[31]-5}`),Fn(r,"scale","10 10 10")},m(o,a){Bt(o,t,a),Bt(o,i,a),Bt(o,r,a)},p:gn,d(o){o&&(It(t),It(i),It(r))}}}function GI(e){let t,i,r;return{c(){t=oe("a-cylinder"),i=ge(),r=oe("a-entity"),Fn(t,"position",`${e[28]} 0 -2.5`),Fn(t,"radius",.02),Fn(t,"height","5"),Fn(t,"rotation","90 0 0"),Fn(t,"color","#ddd"),Fn(r,"text","value: "+e[28]+"; color: #666"),Fn(r,"position",`${e[28]+4.5} 0 1`),Fn(r,"scale","10 10 10")},m(o,a){Bt(o,t,a),Bt(o,i,a),Bt(o,r,a)},p:gn,d(o){o&&(It(t),It(i),It(r))}}}function Uae(e){let t;return{c(){t=oe("a-sphere"),Fn(t,"position",e[23]-.5+" 0 -2.5"),Fn(t,"color","silver"),Fn(t,"scale","0.25 0.1 0.25")},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Gae(e){let t,i,r;return{c(){t=oe("a-sphere"),i=ge(),r=oe("a-sphere"),Fn(t,"position",e[23]-.5+" 0 -1.5"),Fn(t,"color","silver"),Fn(t,"scale","0.25 0.1 0.25"),Fn(r,"position",e[23]-.5+" 0 -3.5"),Fn(r,"color","silver"),Fn(r,"scale","0.25 0.1 0.25")},m(o,a){Bt(o,t,a),Bt(o,i,a),Bt(o,r,a)},p:gn,d(o){o&&(It(t),It(i),It(r))}}}function VI(e){let t,i,r,o,a,h;return{c(){t=oe("a-cylinder"),r=ge(),o=oe("a-entity"),Fn(t,"position",i=`${Jp/2} ${e[5](e[20])} -6`),Fn(t,"radius","0.02"),Fn(t,"height","26"),Fn(t,"rotation","0 0 90"),Fn(t,"color","#ccc"),Fn(o,"text",a="value: "+e[20].toFixed()+"s; color: #666"),Fn(o,"position",h=`2.5 ${e[5](e[20])} -6 `),Fn(o,"scale","10 10 10")},m(u,p){Bt(u,t,p),Bt(u,r,p),Bt(u,o,p)},p(u,p){p[0]&38&&i!==(i=`${Jp/2} ${u[5](u[20])} -6`)&&Fn(t,"position",i),p[0]&6&&a!==(a="value: "+u[20].toFixed()+"s; color: #666")&&Fn(o,"text",a),p[0]&38&&h!==(h=`2.5 ${u[5](u[20])} -6 `)&&Fn(o,"position",h)},d(u){u&&(It(t),It(r),It(o))}}}function QI(e){let t,i,r,o,a,h;return{c(){t=oe("a-box"),i=oe("a-entity"),o=ge(),Fn(i,"text",r="value: "+e[17].note+"\\n"+e[17].fret+"; color: #666"),Fn(i,"position","2.35 0 0.201"),Fn(i,"scale","5 5 5"),Fn(t,"position",a=`${e[17].fret-.3} ${e[5](e[17].time)} ${e[17].string-5}`),Fn(t,"color",h=e[7][qp-e[17].string-1]),Fn(t,"opacity","0.5"),Fn(t,"width","0.4"),Fn(t,"height","0.4"),Fn(t,"depth","0.4")},m(u,p){Bt(u,t,p),D(t,i),D(t,o)},p(u,p){p[0]&16&&r!==(r="value: "+u[17].note+"\\n"+u[17].fret+"; color: #666")&&Fn(i,"text",r),p[0]&48&&a!==(a=`${u[17].fret-.3} ${u[5](u[17].time)} ${u[17].string-5}`)&&Fn(t,"position",a),p[0]&16&&h!==(h=u[7][qp-u[17].string-1])&&Fn(t,"color",h)},d(u){u&&It(t)}}}function Vae(e){let t,i,r,o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V=fn(Mn(qp)),$=[];for(let de=0;de<V.length;de+=1)$[de]=UI(kI(e,V,de));let H=fn(Mn(Jp+1)),Y=[];for(let de=0;de<H.length;de+=1)Y[de]=GI(FI(e,H,de));let Q=fn([3,5,7,9,15,17,19,21]),G=[];for(let de=0;de<8;de+=1)G[de]=Uae(kae(e,Q,de));let J=fn([12,24]),K=[];for(let de=0;de<2;de+=1)K[de]=Gae(Fae(e,J,de));let se=fn(Mn(nS(e[2],5),e[1]+1,5)),ue=[];for(let de=0;de<se.length;de+=1)ue[de]=VI(OI(e,se,de));let he=fn(e[4]),Me=[];for(let de=0;de<he.length;de+=1)Me[de]=QI(NI(e,he,de));return O=new Nr({props:{noteOn:e[8],controlChange:e[9]}}),{c(){t=oe("main"),i=oe("a-scene"),r=oe("a-entity"),o=ge(),a=oe("a-entity"),h=ge(),u=oe("a-entity"),p=ge(),c=oe("a-entity"),f=ge(),g=oe("a-sky"),m=ge(),v=oe("a-entity"),y=ge(),C=oe("a-entity"),E=ge(),x=oe("a-entity"),w=ge(),S=oe("a-box");for(let de=0;de<$.length;de+=1)$[de].c();I=ge();for(let de=0;de<Y.length;de+=1)Y[de].c();L=ge();for(let de=0;de<8;de+=1)G[de].c();R=ge();for(let de=0;de<2;de+=1)K[de].c();k=ge();for(let de=0;de<ue.length;de+=1)ue[de].c();P=ge();for(let de=0;de<Me.length;de+=1)Me[de].c();F=ge(),Ut(O.$$.fragment),Fn(r,"oculus-touch-controls","hand: left"),Fn(a,"oculus-touch-controls","hand: right"),Fn(u,"id","leftHand"),Fn(u,"hand-tracking-controls","hand: left;"),Fn(c,"id","rightHand"),Fn(c,"hand-tracking-controls","hand: right;"),Fn(g,"color","white"),Fn(v,"text",A="value: "+e[0].title+"; color: #666; width: 5"),Fn(v,"position","-1.75 1.85 -1.5"),Fn(v,"scale",".35 .35 .35"),Fn(C,"text","value: Connect a MIDI guitar and start playing. Notes are positioned based on their string (forward), fret (right), and time (up). They are colored by string and labelled with note name and fret number.\\n\\nRandom notes are shown until you play.\\n\\nGo back in your browser to return to the main page.; color: #666; width: 5"),Fn(C,"position","-2 1.5 -1.5"),Fn(C,"scale",".25 .25 .25"),Fn(x,"text",M="value: "+e[3]+"; color: #666; width: 5"),Fn(x,"position","-2 1 -1.5"),Fn(x,"scale",".25 .25 .25"),Fn(S,"position","-1 .5 -1"),Fn(S,"rotation","0 0 0"),Fn(S,"scale",".1 .1 .1"),Fn(S,"visible","true"),Fn(S,"opacity","0"),fe(t,"class","demo")},m(de,Pe){Bt(de,t,Pe),D(t,i),D(i,r),D(i,o),D(i,a),D(i,h),D(i,u),D(i,p),D(i,c),D(i,f),D(i,g),D(i,m),D(i,v),D(i,y),D(i,C),D(i,E),D(i,x),D(i,w),D(i,S);for(let Se=0;Se<$.length;Se+=1)$[Se]&&$[Se].m(S,null);D(S,I);for(let Se=0;Se<Y.length;Se+=1)Y[Se]&&Y[Se].m(S,null);D(S,L);for(let Se=0;Se<8;Se+=1)G[Se]&&G[Se].m(S,null);D(S,R);for(let Se=0;Se<2;Se+=1)K[Se]&&K[Se].m(S,null);D(S,k);for(let Se=0;Se<ue.length;Se+=1)ue[Se]&&ue[Se].m(S,null);D(S,P);for(let Se=0;Se<Me.length;Se+=1)Me[Se]&&Me[Se].m(S,null);D(t,F),Ft(O,t,null),W=!0},p(de,Pe){if((!W||Pe[0]&1&&A!==(A="value: "+de[0].title+"; color: #666; width: 5"))&&Fn(v,"text",A),(!W||Pe[0]&8&&M!==(M="value: "+de[3]+"; color: #666; width: 5"))&&Fn(x,"text",M),Pe[0]&192){V=fn(Mn(qp));let Se;for(Se=0;Se<V.length;Se+=1){const Le=kI(de,V,Se);$[Se]?$[Se].p(Le,Pe):($[Se]=UI(Le),$[Se].c(),$[Se].m(S,I))}for(;Se<$.length;Se+=1)$[Se].d(1);$.length=V.length}if(Pe&0){H=fn(Mn(Jp+1));let Se;for(Se=0;Se<H.length;Se+=1){const Le=FI(de,H,Se);Y[Se]?Y[Se].p(Le,Pe):(Y[Se]=GI(Le),Y[Se].c(),Y[Se].m(S,L))}for(;Se<Y.length;Se+=1)Y[Se].d(1);Y.length=H.length}if(Pe[0]&38){se=fn(Mn(nS(de[2],5),de[1]+1,5));let Se;for(Se=0;Se<se.length;Se+=1){const Le=OI(de,se,Se);ue[Se]?ue[Se].p(Le,Pe):(ue[Se]=VI(Le),ue[Se].c(),ue[Se].m(S,P))}for(;Se<ue.length;Se+=1)ue[Se].d(1);ue.length=se.length}if(Pe[0]&176){he=fn(de[4]);let Se;for(Se=0;Se<he.length;Se+=1){const Le=NI(de,he,Se);Me[Se]?Me[Se].p(Le,Pe):(Me[Se]=QI(Le),Me[Se].c(),Me[Se].m(S,null))}for(;Se<Me.length;Se+=1)Me[Se].d(1);Me.length=he.length}},i(de){W||(Nt(O.$$.fragment,de),W=!0)},o(de){Ot(O.$$.fragment,de),W=!1},d(de){de&&It(t),ti($,de),ti(Y,de),ti(G,de),ti(K,de),ti(ue,de),ti(Me,de),kt(O)}}}let qp=6,Jp=24;function Qae(e,t,i){let r,o,a,{demoInfo:h}=t,u=[64,59,55,50,45,40];const p=u.map(Ss.fromMidiSharps),c=Vp;let f=.5,g=60,m=0,v=60,A=[];const y=w=>{const S=Math.floor(Math.random()*6),I=Math.round(Math.random()*24),L=Math.round(Math.random()*127),R=u[S]+I;return w=w??Math.round(Math.random()*60),i(1,v=w),{string:S,fret:I,time:w,note:nu[R%12],velocity:L}};let C=setInterval(()=>i(12,A=[...A,y(performance.now()/1e3)]),500),E="";const x=w=>{C&&(clearInterval(C),C=null,i(12,A=[])),A.length===0&&(m=w.timestamp);const S=(w.timestamp-m)/1e3,I=w.message.channel-1,L=w.note.number-u[I];if(L<0)return;const R={number:w.note.number,note:nu[w.note.number%12],velocity:w.rawVelocity,time:S,channel:w.message.channel,string:I,fret:L};i(12,A=[...A,R]),i(1,v=S)},M=w=>{const S=w.controller.number;S===14?i(10,f=w.value):S===15&&i(11,g=w.value*120)};return tr(()=>{console.log(Dae),Sw.registerComponent("thumbstick-logging",{init(){this.el.addEventListener("thumbstickmoved",this.logThumbstick)},logThumbstick(w){w.detail.y>.95&&console.log("DOWN"),w.detail.y<-.95&&console.log("UP"),w.detail.x<-.95&&console.log("LEFT"),w.detail.x>.95&&console.log("RIGHT"),i(3,E=`x ${w.detail.x} y ${w.detail.y}`)}})}),Io(()=>{clearInterval(C)}),e.$$set=w=>{"demoInfo"in w&&i(0,h=w.demoInfo)},e.$$.update=()=>{e.$$.dirty[0]&2050&&i(2,r=v-g),e.$$.dirty[0]&3078&&i(5,o=T1().domain([v,r]).range([.5,g*f])),e.$$.dirty[0]&6146&&i(4,a=A.filter(w=>w.time>v-g))},[h,v,r,E,a,o,p,c,x,M,f,g,A]}class Hae extends pi{constructor(t){super(),di(this,t,Qae,Vae,fi,{demoInfo:0},null,[-1,-1])}}function zae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g=(e[2]?qr:Yr)+"",m,v,A,y,C=(e[3]?Yr:qr)+"",E,x,M,w,S=(e[4]?Yr:qr)+"",I,L,R,k,P,F,O,W,V,$,H,Y,Q,G,J,K;function se(he){e[14](he)}let ue={callback:e[7]};return e[5]!==void 0&&(ue.notes=e[5]),F=new qs({props:ue}),In.push(()=>Yi(F,"notes",se)),V=new $o({props:{exportFunction:e[8]}}),H=new Xo({props:{importFunction:e[9]}}),Q=new Nr({props:{noteOn:e[6]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI instrument and start playing. The bar chart below shows
        how often you played each interval: when you go up in pitch, the bar of
        the played interval in the top half will increase. If you go down, it
        will show up in the bottom half. Colors denote the type of interval, so
        you can quickly see if you play, for example, more major or minor
        intervals.`,u=ge(),p=oe("div"),c=oe("button"),f=$e("unison "),m=$e(g),v=ge(),A=oe("button"),y=$e("colors "),E=$e(C),x=ge(),M=oe("button"),w=$e("semitones "),I=$e(S),L=ge(),R=oe("div"),k=ge(),P=oe("div"),Ut(F.$$.fragment),W=ge(),Ut(V.$$.fragment),$=ge(),Ut(H.$$.fragment),Y=ge(),Ut(Q.$$.fragment),fe(h,"class","explanation"),fe(c,"title","Toggle filtering unison intervals"),fe(A,"title","Use colors for interval types"),fe(M,"title","Show number of semitones instead of musical names for intervals on the y axis"),fe(p,"class","control svelte-13613lz"),fe(R,"class","visualization svelte-13613lz"),fe(P,"class","control svelte-13613lz"),fe(t,"class","demo")},m(he,Me){Bt(he,t,Me),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,m),D(p,v),D(p,A),D(A,y),D(A,E),D(p,x),D(p,M),D(M,w),D(M,I),D(t,L),D(t,R),e[13](R),D(t,k),D(t,P),Ft(F,P,null),D(P,W),Ft(V,P,null),D(P,$),Ft(H,P,null),D(t,Y),Ft(Q,t,null),G=!0,J||(K=[lt(c,"click",e[10]),lt(A,"click",e[11]),lt(M,"click",e[12])],J=!0)},p(he,[Me]){(!G||Me&1)&&r!==(r=he[0].title+"")&&jt(o,r),(!G||Me&4)&&g!==(g=(he[2]?qr:Yr)+"")&&jt(m,g),(!G||Me&8)&&C!==(C=(he[3]?Yr:qr)+"")&&jt(E,C),(!G||Me&16)&&S!==(S=(he[4]?Yr:qr)+"")&&jt(I,S);const de={};!O&&Me&32&&(O=!0,de.notes=he[5],Ki(()=>O=!1)),F.$set(de)},i(he){G||(Nt(F.$$.fragment,he),Nt(V.$$.fragment,he),Nt(H.$$.fragment,he),Nt(Q.$$.fragment,he),G=!0)},o(he){Ot(F.$$.fragment,he),Ot(V.$$.fragment,he),Ot(H.$$.fragment,he),Ot(Q.$$.fragment,he),G=!1},d(he){he&&It(t),e[13](null),kt(F),kt(V),kt(H),kt(Q),J=!1,ji(K)}}}let jae=1e3,Wae=650;function $ae(e,t,i){let{demoInfo:r}=t,o,a=!0,h=!1,u=!1,p=[];const c=[{semitones:0,name:"Unison",short:"P1",type:"perfect"},{semitones:1,name:"Minor 2nd",short:"m2",type:"minor"},{semitones:2,name:"Major 2nd",short:"M2",type:"major"},{semitones:3,name:"Minor 3rd",short:"m3",type:"minor"},{semitones:4,name:"Major 3rd",short:"M3",type:"major"},{semitones:5,name:"Perfect 4th",short:"P4",type:"perfect"},{semitones:6,name:"Augmented 4th",short:"A4",type:"tritone"},{semitones:7,name:"Perfect 5th",short:"P5",type:"perfect"},{semitones:8,name:"Minor 6th",short:"m6",type:"minor"},{semitones:9,name:"Major 6th",short:"M6",type:"major"},{semitones:10,name:"Minor 7th",short:"m7",type:"minor"},{semitones:11,name:"Major 7th",short:"M7",type:"major"},{semitones:12,name:"Perfect 8ve",short:"P8",type:"perfect"}],f=M=>{const w={number:M.note.number,velocity:M.rawVelocity,time:M.timestamp};p.push(w),g()},g=()=>{let M=p.map((I,L)=>L===0?0:I.number-p[L-1].number);a&&(M=M.filter(I=>I!==0)),M=M.map(I=>{if(Math.abs(I)<=12)return I;{const L=I>0?12:-12;for(;Math.abs(I)>12;)I-=L;return I}});const w=Rp(M,I=>I).map(([I,L])=>({interval:I,count:L.length})),S=Ji({width:jae,height:Wae,marginLeft:120,marginRight:10,color:{legend:h,domain:["minor","major","perfect","tritone"],range:["#7da2e8","#ed796a","gold","#ccc"]},x:{},y:{tickFormat:u?I=>I:I=>I>=0?c[I].name:c[-I].name,domain:Mn(-12,13,1),label:` going down ${" ".repeat(75)} going up      `,reverse:!0},marks:[hs([-12,0,12],{stroke:"#888",strokeWidth:1.5}),km(w,{x:"count",y:"interval",fill:h?I=>c[Math.abs(I.interval)].type:"#ddd",dx:.5,rx:4})]});i(1,o.textContent="",o),o.appendChild(S)},m=()=>{const M={filterUnison:a,useColors:h,useSemitones:u,notes:p};Lo(r.id,M)},v=async M=>{if(p.length===0||confirm("Import data and overwrite currently unsaved data?")){const w=await Ro(M);i(2,a=w.filterUnison),i(3,h=w.useColors),i(4,u=w.useSemitones),i(5,p=w.notes),g()}};tr(g);const A=()=>{i(2,a=!a),g()},y=()=>{i(3,h=!h),g()},C=()=>{i(4,u=!u),g()};function E(M){In[M?"unshift":"push"](()=>{o=M,i(1,o)})}function x(M){p=M,i(5,p)}return e.$$set=M=>{"demoInfo"in M&&i(0,r=M.demoInfo)},[r,o,a,h,u,p,f,g,m,v,A,y,C,E,x]}class Xae extends pi{constructor(t){super(),di(this,t,$ae,zae,fi,{demoInfo:0})}}function Kae(e,t,i){const r=e.slice();return r[17]=t[i],r}function Yae(e){let t;return{c(){t=oe("option"),t.textContent=`${e[17]}`,t.__value=e[17],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function qae(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W=fn(nu),V=[];for(let Y=0;Y<W.length;Y+=1)V[Y]=Yae(Kae(e,W,Y));function $(Y){e[13](Y)}let H={callback:e[9]};return e[3]!==void 0&&(H.value=e[3]),v=new ad({props:H}),In.push(()=>Yi(v,"value",$)),S=new $o({props:{exportFunction:e[10]}}),L=new Xo({props:{importFunction:e[11]}}),k=new Nr({props:{noteOn:e[6],noteOff:e[7],controlChange:e[8]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Notes that you play are shown as bars. The color shows which scale
        subset a note belongs to. The bars' height encodes the notes' durations.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`root note
            `),g=oe("select");for(let Y=0;Y<V.length;Y+=1)V[Y].c();m=ge(),Ut(v.$$.fragment),y=ge(),C=oe("div"),E=ge(),x=oe("div"),M=oe("button"),M.textContent="reset",w=ge(),Ut(S.$$.fragment),I=ge(),Ut(L.$$.fragment),R=ge(),Ut(k.$$.fragment),fe(h,"class","explanation"),e[2]===void 0&&yr(()=>e[12].call(g)),fe(p,"class","control"),fe(C,"class","visualization"),fe(M,"title","Clear all played notes"),fe(x,"class","control"),fe(t,"class","demo")},m(Y,Q){Bt(Y,t,Q),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let G=0;G<V.length;G+=1)V[G]&&V[G].m(g,null);ci(g,e[2],!0),D(p,m),Ft(v,p,null),D(t,y),D(t,C),e[14](C),D(t,E),D(t,x),D(x,M),D(x,w),Ft(S,x,null),D(x,I),Ft(L,x,null),D(t,R),Ft(k,t,null),P=!0,F||(O=[lt(g,"change",e[12]),lt(g,"change",e[9]),lt(M,"click",e[15])],F=!0)},p(Y,[Q]){(!P||Q&1)&&r!==(r=Y[0].title+"")&&jt(o,r),Q&4&&ci(g,Y[2]);const G={};!A&&Q&8&&(A=!0,G.value=Y[3],Ki(()=>A=!1)),v.$set(G)},i(Y){P||(Nt(v.$$.fragment,Y),Nt(S.$$.fragment,Y),Nt(L.$$.fragment,Y),Nt(k.$$.fragment,Y),P=!0)},o(Y){Ot(v.$$.fragment,Y),Ot(S.$$.fragment,Y),Ot(L.$$.fragment,Y),Ot(k.$$.fragment,Y),P=!1},d(Y){Y&&It(t),ti(V,Y),kt(v),e[14](null),kt(S),kt(L),kt(k),F=!1,ji(O)}}}let Jae=1200,Zae=280;function ele(e,t,i){let{demoInfo:r}=t,o,a="A",h=50,u=[],p,c=new Map;const f=w=>{u.length===0&&(p=w.timestamp);const S=(w.timestamp-p)/1e3,I={name:w.note.name,number:w.note.number,velocity:w.rawVelocity,time:S,channel:w.message.channel,duration:0};if(c.has(w.note.number)){const L=c.get(w.note.number);L.end===void 0&&(L.end=S)}u.push(I),c.set(w.note.number,I),v()},g=w=>{if(c.has(w.note.number)){const S=c.get(w.note.number),I=(w.timestamp-p)/1e3;S.end=I,S.duration=S.end-S.time}v()},m=w=>{const S=Jr(w.rawValue*2,20,250);i(3,h=S),v()},v=()=>{const w=new Set(Ws.get(`${a} minor`).notes),S=new Set(Ws.get(`${a} minor blues`).notes),I=new Set(Ws.get(`${a} minor pentatonic`).notes),L=Um.map(P=>P===a?"#1B5E20":I.has(P)?"#689F38":S.has(P)?"cornflowerblue":w.has(P)?"#D4E157":"lightgray"),R=u.slice(-h),k=Ji({width:Jae,height:Zae,marginLeft:80,marginBottom:50,padding:0,x:{axis:!1},y:{},color:{legend:!0,domain:Mn(12),range:L,tickFormat:P=>nu[P],marginLeft:290},marks:[hs([0],{stroke:"#ddd"}),Wf(R,{x:(P,F)=>F,y:"duration",fill:P=>P.number%12,inset:.5,rx:4,tip:!0}),Ba(R,{x:(P,F)=>F,y:"duration",text:"name",fontSize:14,dy:-10})]});i(1,o.textContent="",o),o.appendChild(k)},A=()=>{const w={root:a,notes:u,pastNoteCount:h};Lo(r.id,w)},y=async w=>{if(u.length===0||confirm("Import data and overwrite currently unsaved data?")){const S=await Ro(w);i(2,a=S.root),i(4,u=S.notes),i(3,h=S.pastNoteCount),v()}};tr(v);function C(){a=Dr(this),i(2,a)}function E(w){h=w,i(3,h)}function x(w){In[w?"unshift":"push"](()=>{o=w,i(1,o)})}const M=()=>{confirm("Reset played notes?")&&(i(4,u=[]),i(5,c=new Map),v())};return e.$$set=w=>{"demoInfo"in w&&i(0,r=w.demoInfo)},[r,o,a,h,u,c,f,g,m,v,A,y,C,E,x,M]}class tle extends pi{constructor(t){super(),di(this,t,ele,qae,fi,{demoInfo:0})}}function HI(e,t,i){const r=e.slice();return r[19]=t[i],r}function zI(e,t,i){const r=e.slice();return r[22]=t[i],r}function jI(e){let t,i=e[22]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[22],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function WI(e){let t,i=e[19]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[19],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function nle(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x=(e[4]?Yr:qr)+"",M,w,S,I,L=(e[5]?Yr:qr)+"",R,k,P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he=fn(e[7]),Me=[];for(let be=0;be<he.length;be+=1)Me[be]=jI(zI(e,he,be));let de=fn(e[8]),Pe=[];for(let be=0;be<de.length;be+=1)Pe[be]=WI(HI(e,de,be));function Se(be){e[18](be)}let Le={callback:e[10]};return e[6]!==void 0&&(Le.notes=e[6]),W=new qs({props:Le}),In.push(()=>Yi(W,"notes",Se)),H=new $o({props:{exportFunction:e[11]}}),Q=new Xo({props:{importFunction:e[12]}}),J=new Nr({props:{noteOn:e[9]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI instrument and start playing. The bar chart below shows
        how often you played each scale degree.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`scale
            `),g=oe("select");for(let be=0;be<Me.length;be+=1)Me[be].c();m=ge(),v=oe("select");for(let be=0;be<Pe.length;be+=1)Pe[be].c();A=ge(),y=oe("div"),C=oe("button"),E=$e("colors "),M=$e(x),w=ge(),S=oe("button"),I=$e("non-scale notes "),R=$e(L),k=ge(),P=oe("div"),F=ge(),O=oe("div"),Ut(W.$$.fragment),$=ge(),Ut(H.$$.fragment),Y=ge(),Ut(Q.$$.fragment),G=ge(),Ut(J.$$.fragment),fe(h,"class","explanation"),e[2]===void 0&&yr(()=>e[13].call(g)),e[3]===void 0&&yr(()=>e[14].call(v)),fe(p,"class","control svelte-13613lz"),fe(C,"title","Use colors for root, in-scale, outside-scale"),fe(S,"title","Show notes outside the scale"),fe(y,"class","control svelte-13613lz"),fe(P,"class","visualization svelte-13613lz"),fe(O,"class","control svelte-13613lz"),fe(t,"class","demo")},m(be,je){Bt(be,t,je),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let Te=0;Te<Me.length;Te+=1)Me[Te]&&Me[Te].m(g,null);ci(g,e[2],!0),D(c,m),D(c,v);for(let Te=0;Te<Pe.length;Te+=1)Pe[Te]&&Pe[Te].m(v,null);ci(v,e[3],!0),D(t,A),D(t,y),D(y,C),D(C,E),D(C,M),D(y,w),D(y,S),D(S,I),D(S,R),D(t,k),D(t,P),e[17](P),D(t,F),D(t,O),Ft(W,O,null),D(O,$),Ft(H,O,null),D(O,Y),Ft(Q,O,null),D(t,G),Ft(J,t,null),K=!0,se||(ue=[lt(g,"change",e[13]),lt(g,"change",e[10]),lt(v,"change",e[14]),lt(v,"change",e[10]),lt(C,"click",e[15]),lt(S,"click",e[16])],se=!0)},p(be,[je]){if((!K||je&1)&&r!==(r=be[0].title+"")&&jt(o,r),je&128){he=fn(be[7]);let rt;for(rt=0;rt<he.length;rt+=1){const mt=zI(be,he,rt);Me[rt]?Me[rt].p(mt,je):(Me[rt]=jI(mt),Me[rt].c(),Me[rt].m(g,null))}for(;rt<Me.length;rt+=1)Me[rt].d(1);Me.length=he.length}if(je&132&&ci(g,be[2]),je&256){de=fn(be[8]);let rt;for(rt=0;rt<de.length;rt+=1){const mt=HI(be,de,rt);Pe[rt]?Pe[rt].p(mt,je):(Pe[rt]=WI(mt),Pe[rt].c(),Pe[rt].m(v,null))}for(;rt<Pe.length;rt+=1)Pe[rt].d(1);Pe.length=de.length}je&264&&ci(v,be[3]),(!K||je&16)&&x!==(x=(be[4]?Yr:qr)+"")&&jt(M,x),(!K||je&32)&&L!==(L=(be[5]?Yr:qr)+"")&&jt(R,L);const Te={};!V&&je&64&&(V=!0,Te.notes=be[6],Ki(()=>V=!1)),W.$set(Te)},i(be){K||(Nt(W.$$.fragment,be),Nt(H.$$.fragment,be),Nt(Q.$$.fragment,be),Nt(J.$$.fragment,be),K=!0)},o(be){Ot(W.$$.fragment,be),Ot(H.$$.fragment,be),Ot(Q.$$.fragment,be),Ot(J.$$.fragment,be),K=!1},d(be){be&&It(t),ti(Me,be),ti(Pe,be),e[17](null),kt(W),kt(H),kt(Q),kt(J),se=!1,ji(ue)}}}let ile=1e3,rle=650;function sle(e,t,i){let{demoInfo:r}=t,o,a="A",h="minor pentatonic",u=!0,p=!0,c=[];const f=Um,g=Ws.names(),m=I=>{const L={number:I.note.number,velocity:I.rawVelocity,time:I.timestamp};c.push(L),v()},v=()=>{if(i(1,o.textContent="",o),c.length===0)return;const I=f.indexOf(a),L=Ws.get(`${a} ${h}`),R=L.notes.map((V,$)=>{const H=f.indexOf(V);let Y=H-I;return Y=Y>=0?Y:Y+12,{name:V,chroma:H,interval:L.intervals[$],degree:$,offset:Y}}),k=new Set(R.map(V=>V.offset)),F=c.map(V=>V.number%12).map(V=>{const $=V-I;return $>=0?$:$+12}),O=Rp(F,V=>V).map(([V,$])=>({value:V,count:$.length})),W=Ji({width:ile,height:rle,marginLeft:70,marginRight:10,color:{legend:u,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:V=>f[(V+I)%12],domain:p?Mn(0,12,1):[...k],reverse:!0,label:"notes, increasing semitones from root "},marks:[km(O,{x:"count",y:"value",fill:V=>u?V.value===0?"#666":k.has(V.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});o.appendChild(W)},A=()=>{const I={root:a,scale:h,useColors:u,showOutsideScale:p,notes:c};Lo(r.id,I)},y=async I=>{if(c.length===0||confirm("Import data and overwrite currently unsaved data?")){const L=await Ro(I);i(2,a=L.root),i(3,h=L.scale),i(4,u=L.useColors),i(5,p=L.showOutsideScale),i(6,c=L.notes),v()}};tr(v);function C(){a=Dr(this),i(2,a),i(7,f)}function E(){h=Dr(this),i(3,h),i(8,g)}const x=()=>{i(4,u=!u),v()},M=()=>{i(5,p=!p),v()};function w(I){In[I?"unshift":"push"](()=>{o=I,i(1,o)})}function S(I){c=I,i(6,c)}return e.$$set=I=>{"demoInfo"in I&&i(0,r=I.demoInfo)},[r,o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S]}class ole extends pi{constructor(t){super(),di(this,t,sle,nle,fi,{demoInfo:0})}}function $I(e,t,i){const r=e.slice();return r[21]=t[i],r}function XI(e,t,i){const r=e.slice();return r[24]=t[i],r}function KI(e){let t,i=e[24]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[24],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function YI(e){let t,i=e[21]+"",r;return{c(){t=oe("option"),r=$e(i),t.__value=e[21],ln(t,t.__value)},m(o,a){Bt(o,t,a),D(t,r)},p:gn,d(o){o&&It(t)}}}function ale(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S=(e[4]?Yr:qr)+"",I,L,R,k,P=(e[5]?Yr:qr)+"",F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le=fn(e[8]),be=[];for(let Ze=0;Ze<Le.length;Ze+=1)be[Ze]=KI(XI(e,Le,Ze));let je=fn(e[9]),Te=[];for(let Ze=0;Ze<je.length;Ze+=1)Te[Ze]=YI($I(e,je,Ze));function rt(Ze){e[16](Ze)}let mt={callback:e[11]};e[6]!==void 0&&(mt.value=e[6]),C=new La({props:mt}),In.push(()=>Yi(C,"value",rt));function vt(Ze){e[20](Ze)}let ft={callback:e[11]};return e[7]!==void 0&&(ft.notes=e[7]),H=new qs({props:ft}),In.push(()=>Yi(H,"notes",vt)),G=new $o({props:{exportFunction:e[12]}}),K=new Xo({props:{importFunction:e[13]}}),ue=new bc({props:{tempo:e[6],accent:4}}),Me=new Nr({props:{noteOn:e[10]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI instrument and start playing. The bar chart below shows
        how often you played each scale degree.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`scale
            `),g=oe("select");for(let Ze=0;Ze<be.length;Ze+=1)be[Ze].c();m=ge(),v=oe("select");for(let Ze=0;Ze<Te.length;Ze+=1)Te[Ze].c();A=ge(),y=oe("div"),Ut(C.$$.fragment),x=ge(),M=oe("button"),w=$e("colors "),I=$e(S),L=ge(),R=oe("button"),k=$e("non-scale notes "),F=$e(P),O=ge(),W=oe("div"),V=ge(),$=oe("div"),Ut(H.$$.fragment),Q=ge(),Ut(G.$$.fragment),J=ge(),Ut(K.$$.fragment),se=ge(),Ut(ue.$$.fragment),he=ge(),Ut(Me.$$.fragment),fe(h,"class","explanation"),e[2]===void 0&&yr(()=>e[14].call(g)),e[3]===void 0&&yr(()=>e[15].call(v)),fe(p,"class","control svelte-13613lz"),fe(M,"title","Use colors for root, in-scale, outside-scale"),fe(R,"title","Show notes outside the scale"),fe(y,"class","control svelte-13613lz"),fe(W,"class","visualization svelte-13613lz"),fe($,"class","control svelte-13613lz"),fe(t,"class","demo")},m(Ze,St){Bt(Ze,t,St),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g);for(let $t=0;$t<be.length;$t+=1)be[$t]&&be[$t].m(g,null);ci(g,e[2],!0),D(c,m),D(c,v);for(let $t=0;$t<Te.length;$t+=1)Te[$t]&&Te[$t].m(v,null);ci(v,e[3],!0),D(t,A),D(t,y),Ft(C,y,null),D(y,x),D(y,M),D(M,w),D(M,I),D(y,L),D(y,R),D(R,k),D(R,F),D(t,O),D(t,W),e[19](W),D(t,V),D(t,$),Ft(H,$,null),D($,Q),Ft(G,$,null),D($,J),Ft(K,$,null),D($,se),Ft(ue,$,null),D(t,he),Ft(Me,t,null),de=!0,Pe||(Se=[lt(g,"change",e[14]),lt(g,"change",e[11]),lt(v,"change",e[15]),lt(v,"change",e[11]),lt(M,"click",e[17]),lt(R,"click",e[18])],Pe=!0)},p(Ze,[St]){if((!de||St&1)&&r!==(r=Ze[0].title+"")&&jt(o,r),St&256){Le=fn(Ze[8]);let Tt;for(Tt=0;Tt<Le.length;Tt+=1){const At=XI(Ze,Le,Tt);be[Tt]?be[Tt].p(At,St):(be[Tt]=KI(At),be[Tt].c(),be[Tt].m(g,null))}for(;Tt<be.length;Tt+=1)be[Tt].d(1);be.length=Le.length}if(St&260&&ci(g,Ze[2]),St&512){je=fn(Ze[9]);let Tt;for(Tt=0;Tt<je.length;Tt+=1){const At=$I(Ze,je,Tt);Te[Tt]?Te[Tt].p(At,St):(Te[Tt]=YI(At),Te[Tt].c(),Te[Tt].m(v,null))}for(;Tt<Te.length;Tt+=1)Te[Tt].d(1);Te.length=je.length}St&520&&ci(v,Ze[3]);const $t={};!E&&St&64&&(E=!0,$t.value=Ze[6],Ki(()=>E=!1)),C.$set($t),(!de||St&16)&&S!==(S=(Ze[4]?Yr:qr)+"")&&jt(I,S),(!de||St&32)&&P!==(P=(Ze[5]?Yr:qr)+"")&&jt(F,P);const ct={};!Y&&St&128&&(Y=!0,ct.notes=Ze[7],Ki(()=>Y=!1)),H.$set(ct);const Ct={};St&64&&(Ct.tempo=Ze[6]),ue.$set(Ct)},i(Ze){de||(Nt(C.$$.fragment,Ze),Nt(H.$$.fragment,Ze),Nt(G.$$.fragment,Ze),Nt(K.$$.fragment,Ze),Nt(ue.$$.fragment,Ze),Nt(Me.$$.fragment,Ze),de=!0)},o(Ze){Ot(C.$$.fragment,Ze),Ot(H.$$.fragment,Ze),Ot(G.$$.fragment,Ze),Ot(K.$$.fragment,Ze),Ot(ue.$$.fragment,Ze),Ot(Me.$$.fragment,Ze),de=!1},d(Ze){Ze&&It(t),ti(be,Ze),ti(Te,Ze),kt(C),e[19](null),kt(H),kt(G),kt(K),kt(ue),kt(Me),Pe=!1,ji(Se)}}}let lle=1e3,cle=650;function ule(e,t,i){let{demoInfo:r}=t,o,a="A",h="minor pentatonic",u=!0,p=!0,c=120,f=[];const g=Um,m=Ws.names(),v=R=>{let k=0;f.length>0&&(k=R.timestamp/1e3-f[0].time);const P={number:R.note.number,velocity:R.rawVelocity,time:k};f.push(P),A()},A=()=>{if(f.length===0)return;const R=g.indexOf(a),k=Ws.get(`${a} ${h}`),P=k.notes.map((Q,G)=>{const J=g.indexOf(Q);let K=J-R;return K=K>=0?K:K+12,{name:Q,chroma:J,interval:k.intervals[G],degree:G,offset:K}}),F=new Set(P.map(Q=>Q.offset)),O=xs(c)*4,W=Rp(f,Q=>Math.floor(Q.time/O));let V=[];for(const[Q,G]of W){const J=G.map(se=>{const he=se.number%12-R;return he>=0?he:he+12}),K=Rp(J,se=>se).map(([se,ue])=>({value:se,count:ue.length,barId:Q}));V=V.concat(K)}const H=Math.floor(f.at(-1).time/O)-9;V=V.filter(Q=>Q.barId>=H);const Y=Ji({width:lle,height:cle,marginLeft:70,marginRight:10,color:{legend:u,domain:["root","scale","outside scale"],range:["#666","#aaa","#eee"]},y:{tickFormat:Q=>g[(Q+R)%12],domain:p?Mn(0,12,1):[...F],reverse:!0,label:"notes, increasing semitones from root "},marks:[km(V,{x:"count",y:"value",fx:"barId",fill:Q=>u?Q.value===0?"#666":F.has(Q.value)?"#aaa":"#eee":"#ddd",dx:.5,rx:4})]});i(1,o.textContent="",o),o.appendChild(Y)},y=()=>{const R={root:a,scale:h,useColors:u,showOutsideScale:p,notes:f,tempo:c};Lo(r.id,R)},C=async R=>{if(f.length===0||confirm("Import data and overwrite currently unsaved data?")){const k=await Ro(R);i(2,a=k.root),i(3,h=k.scale),i(4,u=k.useColors),i(5,p=k.showOutsideScale),i(7,f=k.notes),i(6,c=k.tempo),A()}};tr(A);function E(){a=Dr(this),i(2,a),i(8,g)}function x(){h=Dr(this),i(3,h),i(9,m)}function M(R){c=R,i(6,c)}const w=()=>{i(4,u=!u),A()},S=()=>{i(5,p=!p),A()};function I(R){In[R?"unshift":"push"](()=>{o=R,i(1,o)})}function L(R){f=R,i(7,f)}return e.$$set=R=>{"demoInfo"in R&&i(0,r=R.demoInfo)},[r,o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L]}class hle extends pi{constructor(t){super(),di(this,t,ule,ale,fi,{demoInfo:0})}}function fle(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L;function R(O){e[8](O)}let k={callback:e[5]};e[2]!==void 0&&(k.value=e[2]),c=new ad({props:k}),In.push(()=>Yi(c,"value",R));function P(O){e[10](O)}let F={callback:e[5]};return e[3]!==void 0&&(F.notes=e[3]),y=new qs({props:F}),In.push(()=>Yi(y,"notes",P)),x=new $o({props:{exportFunction:e[6]}}),w=new Xo({props:{importFunction:e[7]}}),I=new Nr({props:{noteOn:e[4]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI keyboard and start playing. The heatmap below shows how
        often you played each keyboard key.`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("div"),v=ge(),A=oe("div"),Ut(y.$$.fragment),E=ge(),Ut(x.$$.fragment),M=ge(),Ut(w.$$.fragment),S=ge(),Ut(I.$$.fragment),fe(h,"class","explanation"),fe(p,"class","control"),fe(m,"class","visualization"),fe(A,"class","control"),fe(t,"class","demo")},m(O,W){Bt(O,t,W),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(t,g),D(t,m),e[9](m),D(t,v),D(t,A),Ft(y,A,null),D(A,E),Ft(x,A,null),D(A,M),Ft(w,A,null),D(t,S),Ft(I,t,null),L=!0},p(O,[W]){(!L||W&1)&&r!==(r=O[0].title+"")&&jt(o,r);const V={};!f&&W&4&&(f=!0,V.value=O[2],Ki(()=>f=!1)),c.$set(V);const $={};!C&&W&8&&(C=!0,$.notes=O[3],Ki(()=>C=!1)),y.$set($)},i(O){L||(Nt(c.$$.fragment,O),Nt(y.$$.fragment,O),Nt(x.$$.fragment,O),Nt(w.$$.fragment,O),Nt(I.$$.fragment,O),L=!0)},o(O){Ot(c.$$.fragment,O),Ot(y.$$.fragment,O),Ot(x.$$.fragment,O),Ot(w.$$.fragment,O),Ot(I.$$.fragment,O),L=!1},d(O){O&&It(t),kt(c),e[9](null),kt(y),kt(x),kt(w),kt(I)}}}let dle=1200,ple=280;const a2=21,l2=108;function mle(e,t,i){let{demoInfo:r}=t,o,a=500,h=[];const u=A=>{const y={number:A.note.number,velocity:A.rawVelocity,time:A.timestamp,channel:A.message.channel};h.push(y),p()},p=()=>{const A=h.slice(-a),y=Rp(A,x=>x.number),C=Zr(y,x=>x[1].length),E=Ji({width:dle,height:ple,marginLeft:80,marginBottom:50,padding:0,x:{domain:Mn(a2,l2),tickFormat:x=>Mp(x)?"":x%12===0?`
`+Ss.fromMidiSharps(x):Ss.fromMidiSharps(x).slice(0,-1)},y:{},marks:[no(B6(a2,l2),{stroke:"#ddd"}),hs([0],{stroke:"#ddd"}),Wf(Mn(a2,l2).filter(x=>Mp(x)),{x:x=>x,y:()=>C,fill:"#f8f8f8",inset:.5}),Wf(A,mq({y:"count"},{x:"number",fill:x=>Mp(x.number)?"#444":"#ccc",inset:.5,rx:4,tip:!0}))]});i(1,o.textContent="",o),o.appendChild(E)},c=()=>{const A={notes:h,pastNoteCount:a};Lo(r.id,A)},f=async A=>{if(h.length===0||confirm("Import data and overwrite currently unsaved data?")){const y=await Ro(A);i(3,h=y.notes),i(2,a=y.pastNoteCount),p()}};tr(p);function g(A){a=A,i(2,a)}function m(A){In[A?"unshift":"push"](()=>{o=A,i(1,o)})}function v(A){h=A,i(3,h)}return e.$$set=A=>{"demoInfo"in A&&i(0,r=A.demoInfo)},[r,o,a,h,u,p,c,f,g,m,v]}class Ale extends pi{constructor(t){super(),di(this,t,mle,fle,fi,{demoInfo:0})}}var dP="1.13.6",qI=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},ov=Array.prototype,Tw=Object.prototype,JI=typeof Symbol<"u"?Symbol.prototype:null,gle=ov.push,Qm=ov.slice,Zp=Tw.toString,vle=Tw.hasOwnProperty,pP=typeof ArrayBuffer<"u",ble=typeof DataView<"u",yle=Array.isArray,ZI=Object.keys,e4=Object.create,t4=pP&&ArrayBuffer.isView,_le=isNaN,Ele=isFinite,mP=!{toString:null}.propertyIsEnumerable("toString"),n4=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],wle=Math.pow(2,53)-1;function zo(e,t){return t=t==null?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),r=Array(i),o=0;o<i;o++)r[o]=arguments[o+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var a=Array(t+1);for(o=0;o<t;o++)a[o]=arguments[o];return a[t]=r,e.apply(this,a)}}function gh(e){var t=typeof e;return t==="function"||t==="object"&&!!e}function Cle(e){return e===null}function AP(e){return e===void 0}function gP(e){return e===!0||e===!1||Zp.call(e)==="[object Boolean]"}function xle(e){return!!(e&&e.nodeType===1)}function Ao(e){var t="[object "+e+"]";return function(i){return Zp.call(i)===t}}const Iw=Ao("String"),vP=Ao("Number"),Mle=Ao("Date"),Sle=Ao("RegExp"),Tle=Ao("Error"),bP=Ao("Symbol"),yP=Ao("ArrayBuffer");var _P=Ao("Function"),Ile=qI.document&&qI.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof Ile!="function"&&(_P=function(e){return typeof e=="function"||!1});const To=_P,EP=Ao("Object");var wP=ble&&EP(new DataView(new ArrayBuffer(8))),Bw=typeof Map<"u"&&EP(new Map),Ble=Ao("DataView");function Rle(e){return e!=null&&To(e.getInt8)&&yP(e.buffer)}const r1=wP?Rle:Ble,vh=yle||Ao("Array");function lu(e,t){return e!=null&&vle.call(e,t)}var L_=Ao("Arguments");(function(){L_(arguments)||(L_=function(e){return lu(e,"callee")})})();const Rw=L_;function Lle(e){return!bP(e)&&Ele(e)&&!isNaN(parseFloat(e))}function CP(e){return vP(e)&&_le(e)}function xP(e){return function(){return e}}function MP(e){return function(t){var i=e(t);return typeof i=="number"&&i>=0&&i<=wle}}function SP(e){return function(t){return t==null?void 0:t[e]}}const s1=SP("byteLength"),Ple=MP(s1);var Dle=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;function Nle(e){return t4?t4(e)&&!r1(e):Ple(e)&&Dle.test(Zp.call(e))}const TP=pP?Nle:xP(!1),jo=SP("length");function Ole(e){for(var t={},i=e.length,r=0;r<i;++r)t[e[r]]=!0;return{contains:function(o){return t[o]===!0},push:function(o){return t[o]=!0,e.push(o)}}}function IP(e,t){t=Ole(t);var i=n4.length,r=e.constructor,o=To(r)&&r.prototype||Tw,a="constructor";for(lu(e,a)&&!t.contains(a)&&t.push(a);i--;)a=n4[i],a in e&&e[a]!==o[a]&&!t.contains(a)&&t.push(a)}function Ks(e){if(!gh(e))return[];if(ZI)return ZI(e);var t=[];for(var i in e)lu(e,i)&&t.push(i);return mP&&IP(e,t),t}function Fle(e){if(e==null)return!0;var t=jo(e);return typeof t=="number"&&(vh(e)||Iw(e)||Rw(e))?t===0:jo(Ks(e))===0}function BP(e,t){var i=Ks(t),r=i.length;if(e==null)return!r;for(var o=Object(e),a=0;a<r;a++){var h=i[a];if(t[h]!==o[h]||!(h in o))return!1}return!0}function Mr(e){if(e instanceof Mr)return e;if(!(this instanceof Mr))return new Mr(e);this._wrapped=e}Mr.VERSION=dP;Mr.prototype.value=function(){return this._wrapped};Mr.prototype.valueOf=Mr.prototype.toJSON=Mr.prototype.value;Mr.prototype.toString=function(){return String(this._wrapped)};function i4(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,s1(e))}var r4="[object DataView]";function P_(e,t,i,r){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var o=typeof e;return o!=="function"&&o!=="object"&&typeof t!="object"?!1:RP(e,t,i,r)}function RP(e,t,i,r){e instanceof Mr&&(e=e._wrapped),t instanceof Mr&&(t=t._wrapped);var o=Zp.call(e);if(o!==Zp.call(t))return!1;if(wP&&o=="[object Object]"&&r1(e)){if(!r1(t))return!1;o=r4}switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return JI.valueOf.call(e)===JI.valueOf.call(t);case"[object ArrayBuffer]":case r4:return RP(i4(e),i4(t),i,r)}var a=o==="[object Array]";if(!a&&TP(e)){var h=s1(e);if(h!==s1(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;a=!0}if(!a){if(typeof e!="object"||typeof t!="object")return!1;var u=e.constructor,p=t.constructor;if(u!==p&&!(To(u)&&u instanceof u&&To(p)&&p instanceof p)&&"constructor"in e&&"constructor"in t)return!1}i=i||[],r=r||[];for(var c=i.length;c--;)if(i[c]===e)return r[c]===t;if(i.push(e),r.push(t),a){if(c=e.length,c!==t.length)return!1;for(;c--;)if(!P_(e[c],t[c],i,r))return!1}else{var f=Ks(e),g;if(c=f.length,Ks(t).length!==c)return!1;for(;c--;)if(g=f[c],!(lu(t,g)&&P_(e[g],t[g],i,r)))return!1}return i.pop(),r.pop(),!0}function kle(e,t){return P_(e,t)}function Hm(e){if(!gh(e))return[];var t=[];for(var i in e)t.push(i);return mP&&IP(e,t),t}function Lw(e){var t=jo(e);return function(i){if(i==null)return!1;var r=Hm(i);if(jo(r))return!1;for(var o=0;o<t;o++)if(!To(i[e[o]]))return!1;return e!==DP||!To(i[Pw])}}var Pw="forEach",LP="has",Dw=["clear","delete"],PP=["get",LP,"set"],Ule=Dw.concat(Pw,PP),DP=Dw.concat(PP),Gle=["add"].concat(Dw,Pw,LP);const Vle=Bw?Lw(Ule):Ao("Map"),Qle=Bw?Lw(DP):Ao("WeakMap"),Hle=Bw?Lw(Gle):Ao("Set"),zle=Ao("WeakSet");function ld(e){for(var t=Ks(e),i=t.length,r=Array(i),o=0;o<i;o++)r[o]=e[t[o]];return r}function jle(e){for(var t=Ks(e),i=t.length,r=Array(i),o=0;o<i;o++)r[o]=[t[o],e[t[o]]];return r}function NP(e){for(var t={},i=Ks(e),r=0,o=i.length;r<o;r++)t[e[i[r]]]=i[r];return t}function D_(e){var t=[];for(var i in e)To(e[i])&&t.push(i);return t.sort()}function Nw(e,t){return function(i){var r=arguments.length;if(t&&(i=Object(i)),r<2||i==null)return i;for(var o=1;o<r;o++)for(var a=arguments[o],h=e(a),u=h.length,p=0;p<u;p++){var c=h[p];(!t||i[c]===void 0)&&(i[c]=a[c])}return i}}const OP=Nw(Hm),o1=Nw(Ks),FP=Nw(Hm,!0);function Wle(){return function(){}}function kP(e){if(!gh(e))return{};if(e4)return e4(e);var t=Wle();t.prototype=e;var i=new t;return t.prototype=null,i}function $le(e,t){var i=kP(e);return t&&o1(i,t),i}function Xle(e){return gh(e)?vh(e)?e.slice():OP({},e):e}function Kle(e,t){return t(e),e}function UP(e){return vh(e)?e:[e]}Mr.toPath=UP;function zm(e){return Mr.toPath(e)}function Ow(e,t){for(var i=t.length,r=0;r<i;r++){if(e==null)return;e=e[t[r]]}return i?e:void 0}function GP(e,t,i){var r=Ow(e,zm(t));return AP(r)?i:r}function Yle(e,t){t=zm(t);for(var i=t.length,r=0;r<i;r++){var o=t[r];if(!lu(e,o))return!1;e=e[o]}return!!i}function Fw(e){return e}function em(e){return e=o1({},e),function(t){return BP(t,e)}}function kw(e){return e=zm(e),function(t){return Ow(t,e)}}function jm(e,t,i){if(t===void 0)return e;switch(i??3){case 1:return function(r){return e.call(t,r)};case 3:return function(r,o,a){return e.call(t,r,o,a)};case 4:return function(r,o,a,h){return e.call(t,r,o,a,h)}}return function(){return e.apply(t,arguments)}}function VP(e,t,i){return e==null?Fw:To(e)?jm(e,t,i):gh(e)&&!vh(e)?em(e):kw(e)}function Uw(e,t){return VP(e,t,1/0)}Mr.iteratee=Uw;function Ko(e,t,i){return Mr.iteratee!==Uw?Mr.iteratee(e,t):VP(e,t,i)}function qle(e,t,i){t=Ko(t,i);for(var r=Ks(e),o=r.length,a={},h=0;h<o;h++){var u=r[h];a[u]=t(e[u],u,e)}return a}function QP(){}function Jle(e){return e==null?QP:function(t){return GP(e,t)}}function Zle(e,t,i){var r=Array(Math.max(0,e));t=jm(t,i,1);for(var o=0;o<e;o++)r[o]=t(o);return r}function N_(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}const tm=Date.now||function(){return new Date().getTime()};function HP(e){var t=function(a){return e[a]},i="(?:"+Ks(e).join("|")+")",r=RegExp(i),o=RegExp(i,"g");return function(a){return a=a==null?"":""+a,r.test(a)?a.replace(o,t):a}}const zP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ece=HP(zP),tce=NP(zP),nce=HP(tce),ice=Mr.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var c2=/(.)^/,rce={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},sce=/\\|'|\r|\n|\u2028|\u2029/g;function oce(e){return"\\"+rce[e]}var ace=/^\s*(\w|\$)+\s*$/;function lce(e,t,i){!t&&i&&(t=i),t=FP({},t,Mr.templateSettings);var r=RegExp([(t.escape||c2).source,(t.interpolate||c2).source,(t.evaluate||c2).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(r,function(c,f,g,m,v){return a+=e.slice(o,v).replace(sce,oce),o=v+c.length,f?a+=`'+
((__t=(`+f+`))==null?'':_.escape(__t))+
'`:g?a+=`'+
((__t=(`+g+`))==null?'':__t)+
'`:m&&(a+=`';
`+m+`
__p+='`),c}),a+=`';
`;var h=t.variable;if(h){if(!ace.test(h))throw new Error("variable is not a bare identifier: "+h)}else a=`with(obj||{}){
`+a+`}
`,h="obj";a=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+a+`return __p;
`;var u;try{u=new Function(h,"_",a)}catch(c){throw c.source=a,c}var p=function(c){return u.call(this,c,Mr)};return p.source="function("+h+`){
`+a+"}",p}function cce(e,t,i){t=zm(t);var r=t.length;if(!r)return To(i)?i.call(e):i;for(var o=0;o<r;o++){var a=e==null?void 0:e[t[o]];a===void 0&&(a=i,o=r),e=To(a)?a.call(e):a}return e}var uce=0;function hce(e){var t=++uce+"";return e?e+t:t}function fce(e){var t=Mr(e);return t._chain=!0,t}function jP(e,t,i,r,o){if(!(r instanceof t))return e.apply(i,o);var a=kP(e.prototype),h=e.apply(a,o);return gh(h)?h:a}var cd=zo(function(e,t){var i=cd.placeholder,r=function(){for(var o=0,a=t.length,h=Array(a),u=0;u<a;u++)h[u]=t[u]===i?arguments[o++]:t[u];for(;o<arguments.length;)h.push(arguments[o++]);return jP(e,r,this,this,h)};return r});cd.placeholder=Mr;const WP=zo(function(e,t,i){if(!To(e))throw new TypeError("Bind must be called on a function");var r=zo(function(o){return jP(e,r,t,this,i.concat(o))});return r}),ha=MP(jo);function bh(e,t,i,r){if(r=r||[],!t&&t!==0)t=1/0;else if(t<=0)return r.concat(e);for(var o=r.length,a=0,h=jo(e);a<h;a++){var u=e[a];if(ha(u)&&(vh(u)||Rw(u)))if(t>1)bh(u,t-1,i,r),o=r.length;else for(var p=0,c=u.length;p<c;)r[o++]=u[p++];else i||(r[o++]=u)}return r}const dce=zo(function(e,t){t=bh(t,!1,!1);var i=t.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var r=t[i];e[r]=WP(e[r],e)}return e});function pce(e,t){var i=function(r){var o=i.cache,a=""+(t?t.apply(this,arguments):r);return lu(o,a)||(o[a]=e.apply(this,arguments)),o[a]};return i.cache={},i}const $P=zo(function(e,t,i){return setTimeout(function(){return e.apply(null,i)},t)}),mce=cd($P,Mr,1);function XP(e,t,i){var r,o,a,h,u=0;i||(i={});var p=function(){u=i.leading===!1?0:tm(),r=null,h=e.apply(o,a),r||(o=a=null)},c=function(){var f=tm();!u&&i.leading===!1&&(u=f);var g=t-(f-u);return o=this,a=arguments,g<=0||g>t?(r&&(clearTimeout(r),r=null),u=f,h=e.apply(o,a),r||(o=a=null)):!r&&i.trailing!==!1&&(r=setTimeout(p,g)),h};return c.cancel=function(){clearTimeout(r),u=0,r=o=a=null},c}function Ace(e,t,i){var r,o,a,h,u,p=function(){var f=tm()-o;t>f?r=setTimeout(p,t-f):(r=null,i||(h=e.apply(u,a)),r||(a=u=null))},c=zo(function(f){return u=this,a=f,o=tm(),r||(r=setTimeout(p,t),i&&(h=e.apply(u,a))),h});return c.cancel=function(){clearTimeout(r),r=a=u=null},c}function gce(e,t){return cd(t,e)}function Gw(e){return function(){return!e.apply(this,arguments)}}function vce(){var e=arguments,t=e.length-1;return function(){for(var i=t,r=e[t].apply(this,arguments);i--;)r=e[i].call(this,r);return r}}function bce(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function KP(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}}const yce=cd(KP,2);function YP(e,t,i){t=Ko(t,i);for(var r=Ks(e),o,a=0,h=r.length;a<h;a++)if(o=r[a],t(e[o],o,e))return o}function qP(e){return function(t,i,r){i=Ko(i,r);for(var o=jo(t),a=e>0?0:o-1;a>=0&&a<o;a+=e)if(i(t[a],a,t))return a;return-1}}const Vw=qP(1),JP=qP(-1);function ZP(e,t,i,r){i=Ko(i,r,1);for(var o=i(t),a=0,h=jo(e);a<h;){var u=Math.floor((a+h)/2);i(e[u])<o?a=u+1:h=u}return a}function eD(e,t,i){return function(r,o,a){var h=0,u=jo(r);if(typeof a=="number")e>0?h=a>=0?a:Math.max(a+u,h):u=a>=0?Math.min(a+1,u):a+u+1;else if(i&&a&&u)return a=i(r,o),r[a]===o?a:-1;if(o!==o)return a=t(Qm.call(r,h,u),CP),a>=0?a+h:-1;for(a=e>0?h:u-1;a>=0&&a<u;a+=e)if(r[a]===o)return a;return-1}}const tD=eD(1,Vw,ZP),_ce=eD(-1,JP);function O_(e,t,i){var r=ha(e)?Vw:YP,o=r(e,t,i);if(o!==void 0&&o!==-1)return e[o]}function Ece(e,t){return O_(e,em(t))}function Ac(e,t,i){t=jm(t,i);var r,o;if(ha(e))for(r=0,o=e.length;r<o;r++)t(e[r],r,e);else{var a=Ks(e);for(r=0,o=a.length;r<o;r++)t(e[a[r]],a[r],e)}return e}function lh(e,t,i){t=Ko(t,i);for(var r=!ha(e)&&Ks(e),o=(r||e).length,a=Array(o),h=0;h<o;h++){var u=r?r[h]:h;a[h]=t(e[u],u,e)}return a}function nD(e){var t=function(i,r,o,a){var h=!ha(i)&&Ks(i),u=(h||i).length,p=e>0?0:u-1;for(a||(o=i[h?h[p]:p],p+=e);p>=0&&p<u;p+=e){var c=h?h[p]:p;o=r(o,i[c],c,i)}return o};return function(i,r,o,a){var h=arguments.length>=3;return t(i,jm(r,a,4),o,h)}}const u2=nD(1),s4=nD(-1);function qf(e,t,i){var r=[];return t=Ko(t,i),Ac(e,function(o,a,h){t(o,a,h)&&r.push(o)}),r}function wce(e,t,i){return qf(e,Gw(Ko(t)),i)}function o4(e,t,i){t=Ko(t,i);for(var r=!ha(e)&&Ks(e),o=(r||e).length,a=0;a<o;a++){var h=r?r[a]:a;if(!t(e[h],h,e))return!1}return!0}function a4(e,t,i){t=Ko(t,i);for(var r=!ha(e)&&Ks(e),o=(r||e).length,a=0;a<o;a++){var h=r?r[a]:a;if(t(e[h],h,e))return!0}return!1}function uc(e,t,i,r){return ha(e)||(e=ld(e)),(typeof i!="number"||r)&&(i=0),tD(e,t,i)>=0}const Cce=zo(function(e,t,i){var r,o;return To(t)?o=t:(t=zm(t),r=t.slice(0,-1),t=t[t.length-1]),lh(e,function(a){var h=o;if(!h){if(r&&r.length&&(a=Ow(a,r)),a==null)return;h=a[t]}return h==null?h:h.apply(a,i)})});function Qw(e,t){return lh(e,kw(t))}function xce(e,t){return qf(e,em(t))}function iD(e,t,i){var r=-1/0,o=-1/0,a,h;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=ha(e)?e:ld(e);for(var u=0,p=e.length;u<p;u++)a=e[u],a!=null&&a>r&&(r=a)}else t=Ko(t,i),Ac(e,function(c,f,g){h=t(c,f,g),(h>o||h===-1/0&&r===-1/0)&&(r=c,o=h)});return r}function Mce(e,t,i){var r=1/0,o=1/0,a,h;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=ha(e)?e:ld(e);for(var u=0,p=e.length;u<p;u++)a=e[u],a!=null&&a<r&&(r=a)}else t=Ko(t,i),Ac(e,function(c,f,g){h=t(c,f,g),(h<o||h===1/0&&r===1/0)&&(r=c,o=h)});return r}var Sce=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function rD(e){return e?vh(e)?Qm.call(e):Iw(e)?e.match(Sce):ha(e)?lh(e,Fw):ld(e):[]}function sD(e,t,i){if(t==null||i)return ha(e)||(e=ld(e)),e[N_(e.length-1)];var r=rD(e),o=jo(r);t=Math.max(Math.min(t,o),0);for(var a=o-1,h=0;h<t;h++){var u=N_(h,a),p=r[h];r[h]=r[u],r[u]=p}return r.slice(0,t)}function Tce(e){return sD(e,1/0)}function Ice(e,t,i){var r=0;return t=Ko(t,i),Qw(lh(e,function(o,a,h){return{value:o,index:r++,criteria:t(o,a,h)}}).sort(function(o,a){var h=o.criteria,u=a.criteria;if(h!==u){if(h>u||h===void 0)return 1;if(h<u||u===void 0)return-1}return o.index-a.index}),"value")}function av(e,t){return function(i,r,o){var a=t?[[],[]]:{};return r=Ko(r,o),Ac(i,function(h,u){var p=r(h,u,i);e(a,h,p)}),a}}const Bce=av(function(e,t,i){lu(e,i)?e[i].push(t):e[i]=[t]}),Rce=av(function(e,t,i){e[i]=t}),Lce=av(function(e,t,i){lu(e,i)?e[i]++:e[i]=1}),Pce=av(function(e,t,i){e[i?0:1].push(t)},!0);function Dce(e){return e==null?0:ha(e)?e.length:Ks(e).length}function Nce(e,t,i){return t in i}const oD=zo(function(e,t){var i={},r=t[0];if(e==null)return i;To(r)?(t.length>1&&(r=jm(r,t[1])),t=Hm(e)):(r=Nce,t=bh(t,!1,!1),e=Object(e));for(var o=0,a=t.length;o<a;o++){var h=t[o],u=e[h];r(u,h,e)&&(i[h]=u)}return i}),Oce=zo(function(e,t){var i=t[0],r;return To(i)?(i=Gw(i),t.length>1&&(r=t[1])):(t=lh(bh(t,!1,!1),String),i=function(o,a){return!uc(t,a)}),oD(e,i,r)});function aD(e,t,i){return Qm.call(e,0,Math.max(0,e.length-(t==null||i?1:t)))}function h2(e,t,i){return e==null||e.length<1?t==null||i?void 0:[]:t==null||i?e[0]:aD(e,e.length-t)}function ag(e,t,i){return Qm.call(e,t==null||i?1:t)}function Fce(e,t,i){return e==null||e.length<1?t==null||i?void 0:[]:t==null||i?e[e.length-1]:ag(e,Math.max(0,e.length-t))}function kce(e){return qf(e,Boolean)}function Uce(e,t){return bh(e,t,!1)}const lD=zo(function(e,t){return t=bh(t,!0,!0),qf(e,function(i){return!uc(t,i)})}),Gce=zo(function(e,t){return lD(e,t)});function F_(e,t,i,r){gP(t)||(r=i,i=t,t=!1),i!=null&&(i=Ko(i,r));for(var o=[],a=[],h=0,u=jo(e);h<u;h++){var p=e[h],c=i?i(p,h,e):p;t&&!i?((!h||a!==c)&&o.push(p),a=c):i?uc(a,c)||(a.push(c),o.push(p)):uc(o,p)||o.push(p)}return o}const Vce=zo(function(e){return F_(bh(e,!0,!0))});function Qce(e){for(var t=[],i=arguments.length,r=0,o=jo(e);r<o;r++){var a=e[r];if(!uc(t,a)){var h;for(h=1;h<i&&uc(arguments[h],a);h++);h===i&&t.push(a)}}return t}function k_(e){for(var t=e&&iD(e,jo).length||0,i=Array(t),r=0;r<t;r++)i[r]=Qw(e,r);return i}const Hce=zo(k_);function zce(e,t){for(var i={},r=0,o=jo(e);r<o;r++)t?i[e[r]]=t[r]:i[e[r][0]]=e[r][1];return i}function jce(e,t,i){t==null&&(t=e||0,e=0),i||(i=t<e?-1:1);for(var r=Math.max(Math.ceil((t-e)/i),0),o=Array(r),a=0;a<r;a++,e+=i)o[a]=e;return o}function Wce(e,t){if(t==null||t<1)return[];for(var i=[],r=0,o=e.length;r<o;)i.push(Qm.call(e,r,r+=t));return i}function Hw(e,t){return e._chain?Mr(t).chain():t}function cD(e){return Ac(D_(e),function(t){var i=Mr[t]=e[t];Mr.prototype[t]=function(){var r=[this._wrapped];return gle.apply(r,arguments),Hw(this,i.apply(Mr,r))}}),Mr}Ac(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=ov[e];Mr.prototype[e]=function(){var i=this._wrapped;return i!=null&&(t.apply(i,arguments),(e==="shift"||e==="splice")&&i.length===0&&delete i[0]),Hw(this,i)}});Ac(["concat","join","slice"],function(e){var t=ov[e];Mr.prototype[e]=function(){var i=this._wrapped;return i!=null&&(i=t.apply(i,arguments)),Hw(this,i)}});const $ce=Object.freeze(Object.defineProperty({__proto__:null,VERSION:dP,after:bce,all:o4,allKeys:Hm,any:a4,assign:o1,before:KP,bind:WP,bindAll:dce,chain:fce,chunk:Wce,clone:Xle,collect:lh,compact:kce,compose:vce,constant:xP,contains:uc,countBy:Lce,create:$le,debounce:Ace,default:Mr,defaults:FP,defer:mce,delay:$P,detect:O_,difference:lD,drop:ag,each:Ac,escape:ece,every:o4,extend:OP,extendOwn:o1,filter:qf,find:O_,findIndex:Vw,findKey:YP,findLastIndex:JP,findWhere:Ece,first:h2,flatten:Uce,foldl:u2,foldr:s4,forEach:Ac,functions:D_,get:GP,groupBy:Bce,has:Yle,head:h2,identity:Fw,include:uc,includes:uc,indexBy:Rce,indexOf:tD,initial:aD,inject:u2,intersection:Qce,invert:NP,invoke:Cce,isArguments:Rw,isArray:vh,isArrayBuffer:yP,isBoolean:gP,isDataView:r1,isDate:Mle,isElement:xle,isEmpty:Fle,isEqual:kle,isError:Tle,isFinite:Lle,isFunction:To,isMap:Vle,isMatch:BP,isNaN:CP,isNull:Cle,isNumber:vP,isObject:gh,isRegExp:Sle,isSet:Hle,isString:Iw,isSymbol:bP,isTypedArray:TP,isUndefined:AP,isWeakMap:Qle,isWeakSet:zle,iteratee:Uw,keys:Ks,last:Fce,lastIndexOf:_ce,map:lh,mapObject:qle,matcher:em,matches:em,max:iD,memoize:pce,methods:D_,min:Mce,mixin:cD,negate:Gw,noop:QP,now:tm,object:zce,omit:Oce,once:yce,pairs:jle,partial:cd,partition:Pce,pick:oD,pluck:Qw,property:kw,propertyOf:Jle,random:N_,range:jce,reduce:u2,reduceRight:s4,reject:wce,rest:ag,restArguments:zo,result:cce,sample:sD,select:qf,shuffle:Tce,size:Dce,some:a4,sortBy:Ice,sortedIndex:ZP,tail:ag,take:h2,tap:Kle,template:lce,templateSettings:ice,throttle:XP,times:Zle,toArray:rD,toPath:UP,transpose:k_,unescape:nce,union:Vce,uniq:F_,unique:F_,uniqueId:hce,unzip:k_,values:ld,where:xce,without:Gce,wrap:gce,zip:Hce},Symbol.toStringTag,{value:"Module"}));var l4=cD($ce);l4._=l4;function Xce(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P;function F(W){e[10](W)}let O={callback:e[5]};return e[3]!==void 0&&(O.notes=e[3]),C=new qs({props:O}),In.push(()=>Yi(C,"notes",F)),M=new $o({props:{exportFunction:e[6]}}),S=new Xo({props:{importFunction:e[7]}}),L=new Nr({props:{pitchBend:e[4]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Connect a MIDI device and play pitch bends or vibratos. The line chart
        below shows how far you bend up and down over time`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`past seconds
            `),g=oe("input"),m=ge(),v=oe("div"),A=ge(),y=oe("div"),Ut(C.$$.fragment),x=ge(),Ut(M.$$.fragment),w=ge(),Ut(S.$$.fragment),I=ge(),Ut(L.$$.fragment),fe(h,"class","explanation"),fe(g,"type","number"),fe(g,"min","5"),fe(g,"max","60"),fe(g,"step","5"),fe(p,"class","control"),fe(v,"class","visualization"),fe(y,"class","control"),fe(t,"class","demo")},m(W,V){Bt(W,t,V),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g),ln(g,e[2]),D(t,m),D(t,v),e[9](v),D(t,A),D(t,y),Ft(C,y,null),D(y,x),Ft(M,y,null),D(y,w),Ft(S,y,null),D(t,I),Ft(L,t,null),R=!0,k||(P=lt(g,"input",e[8]),k=!0)},p(W,[V]){(!R||V&1)&&r!==(r=W[0].title+"")&&jt(o,r),V&4&&Yn(g.value)!==W[2]&&ln(g,W[2]);const $={};!E&&V&8&&(E=!0,$.notes=W[3],Ki(()=>E=!1)),C.$set($)},i(W){R||(Nt(C.$$.fragment,W),Nt(M.$$.fragment,W),Nt(S.$$.fragment,W),Nt(L.$$.fragment,W),R=!0)},o(W){Ot(C.$$.fragment,W),Ot(M.$$.fragment,W),Ot(S.$$.fragment,W),Ot(L.$$.fragment,W),R=!1},d(W){W&&It(t),e[9](null),kt(C),kt(M),kt(S),kt(L),k=!1,P()}}}let Kce=1200,Yce=700;function qce(e,t,i){let{demoInfo:r}=t,o,a=10,h=0,u=[];const p=C=>{u.length===0&&(h=C.timestamp);const E=(C.timestamp-h)/1e3,x={value:C.value,time:E};u.push(x),f()},c=()=>{const C=(performance.now()-h)/1e3,E=C-a,x=u.filter(w=>w.time>E),M=Ji({width:Kce,height:Yce,marginLeft:80,marginBottom:50,padding:0,x:{domain:[E,C],label:"time in seconds"},y:{domain:[-1,1],label:"bend value"},marks:[hs([-1,-.5,0,.5,1],{stroke:"#ddd"}),hs([0]),qg(x,{x:"time",y:"value",clip:!0,curve:"basis"})]});i(1,o.textContent="",o),o.appendChild(M)},f=XP(c,33),g=()=>{const C={pastTime:a,firstTimeStamp:h,bendValues:u};Lo(r.id,C)},m=async C=>{if(u.length===0||confirm("Import data and overwrite currently unsaved data?")){const E=await Ro(C);i(2,a=E.pastTime),h=E.firstTimeStamp,i(3,u=E.bendValues),c()}};tr(c);function v(){a=Yn(this.value),i(2,a)}function A(C){In[C?"unshift":"push"](()=>{o=C,i(1,o)})}function y(C){u=C,i(3,u)}return e.$$set=C=>{"demoInfo"in C&&i(0,r=C.demoInfo)},[r,o,a,u,p,c,g,m,v,A,y]}class Jce extends pi{constructor(t){super(),di(this,t,qce,Xce,fi,{demoInfo:0})}}function Zce(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M=(e[5]?qr:Yr)+"",w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q,G;function J(se){e[17](se)}let K={callback:e[8]};return e[7]!==void 0&&(K.notes=e[7]),F=new qs({props:K}),In.push(()=>Yi(F,"notes",J)),V=new $o({props:{exportFunction:e[9]}}),H=new Xo({props:{importFunction:e[10]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Allow microphone access and play pitch bends or vibratos. The line chart
        below shows how far you bend up and down over time.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`past seconds
            `),g=oe("input"),m=ge(),v=oe("label"),A=$e(`min. decibels
            `),y=oe("input"),C=ge(),E=oe("button"),x=$e("octave "),w=$e(M),S=ge(),I=oe("button"),I.textContent="resume",L=ge(),R=oe("div"),k=ge(),P=oe("div"),Ut(F.$$.fragment),W=ge(),Ut(V.$$.fragment),$=ge(),Ut(H.$$.fragment),fe(h,"class","explanation"),fe(g,"type","number"),fe(g,"min","5"),fe(g,"max","60"),fe(g,"step","5"),fe(y,"type","number"),fe(y,"min","-40"),fe(y,"max","-5"),fe(y,"step","5"),fe(v,"title","The minimum loudness in decibels for a sound to be registered as input. Lower means fainter notes will be registered but there will be more noise such as octave errors."),fe(E,"title","When ignoring the octave, the lower visualization will only show the note's chroma from C to B"),fe(I,"title","Press this button if your browser prevents audio access because there needs to be a user interaction first"),fe(p,"class","control"),fe(R,"class","visualization"),fe(P,"class","control"),fe(t,"class","demo")},m(se,ue){Bt(se,t,ue),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g),ln(g,e[4]),D(p,m),D(p,v),D(v,A),D(v,y),ln(y,e[6]),D(p,C),D(p,E),D(E,x),D(E,w),D(p,S),D(p,I),D(t,L),D(t,R),e[16](R),D(t,k),D(t,P),Ft(F,P,null),D(P,W),Ft(V,P,null),D(P,$),Ft(H,P,null),Y=!0,Q||(G=[lt(g,"input",e[11]),lt(y,"input",e[12]),lt(y,"change",e[13]),lt(E,"click",e[14]),lt(I,"click",e[15])],Q=!0)},p(se,[ue]){(!Y||ue&1)&&r!==(r=se[0].title+"")&&jt(o,r),ue&16&&Yn(g.value)!==se[4]&&ln(g,se[4]),ue&64&&Yn(y.value)!==se[6]&&ln(y,se[6]),(!Y||ue&32)&&M!==(M=(se[5]?qr:Yr)+"")&&jt(w,M);const he={};!O&&ue&128&&(O=!0,he.notes=se[7],Ki(()=>O=!1)),F.$set(he)},i(se){Y||(Nt(F.$$.fragment,se),Nt(V.$$.fragment,se),Nt(H.$$.fragment,se),Y=!0)},o(se){Ot(F.$$.fragment,se),Ot(V.$$.fragment,se),Ot(H.$$.fragment,se),Y=!1},d(se){se&&It(t),e[16](null),kt(F),kt(V),kt(H),Q=!1,ji(G)}}}let eue=1200,tue=500;const c4=16;function nue(e,t,i){let{demoInfo:r}=t,o,a,h,u,p,c=10,f=!0,g=-25,m=0,v=[],A=0;function y(P,F){h.getFloatTimeDomainData(P);const O=u.findPitch(P,F),W=O[0],V=O[1],$=Ss.fromFreq(W),H=Ss.midi($),Y=Gf.freqToMidi(W),Q=(Y-H)*100,J={time:(performance.now()-m)/1e3,pitch:W,noteMidi:H,actualMidi:Y,actualMidiChroma:Y%12,centsOffset:Q,clarity:V};v.push(J),i(7,v=v.slice(-(1e3/c4)*c)),C(),p=requestAnimationFrame(()=>y(P,F))}const C=()=>{i(1,o.textContent="",o);const P=(performance.now()-m)/1e3,F=P-c,O=1e3/c4;let W=Math.round(Lp(v.slice(-O),$=>$.actualMidi));isNaN(W)?W=A:A=W;const V=Ji({width:eue,height:tue,marginLeft:80,marginBottom:50,padding:0,x:{domain:[F,P],label:"time in seconds"},y:{domain:f?[0,12]:[W-5,W+5],label:f?"chroma":"pitch",tickFormat:$=>Math.floor($)===$?Gf.midiToNoteName($,{pitchClass:f,sharps:!0}):"",grid:!0},marks:[qg(v,{x:"time",y:f?"actualMidiChroma":"actualMidi",clip:!0,curve:"basis"})]});o.appendChild(V)},E=()=>{const P={pastTime:c,firstTimeStamp:m,minVolumeDecibels:g,ignoreOctave:f,bendValues:v};Lo(r.id,P)},x=async P=>{if(v.length===0||confirm("Import data and overwrite currently unsaved data?")){const F=await Ro(P);i(4,c=F.pastTime),m=F.firstTimeStamp,i(6,g=F.minVolumeDecibels),i(5,f=F.ignoreOctave??!1),i(7,v=F.bendValues),C()}};tr(()=>{m=performance.now(),i(2,a=new window.AudioContext),h=a.createAnalyser(),navigator.mediaDevices.getUserMedia({audio:!0}).then(P=>{a.createMediaStreamSource(P).connect(h),i(3,u=Yu.forFloat32Array(h.fftSize)),i(3,u.minVolumeDecibels=g,u);const F=new Float32Array(u.inputLength);y(F,a.sampleRate)}),C()}),Io(()=>{clearTimeout(p),cancelAnimationFrame(p)});function M(){c=Yn(this.value),i(4,c)}function w(){g=Yn(this.value),i(6,g)}const S=()=>i(3,u.minVolumeDecibels=g,u),I=()=>{i(5,f=!f)},L=()=>a.resume();function R(P){In[P?"unshift":"push"](()=>{o=P,i(1,o)})}function k(P){v=P,i(7,v)}return e.$$set=P=>{"demoInfo"in P&&i(0,r=P.demoInfo)},[r,o,a,u,c,f,g,v,C,E,x,M,w,S,I,L,R,k]}class iue extends pi{constructor(t){super(),di(this,t,nue,Zce,fi,{demoInfo:0})}}function u4(e){let t,i,r=Gf.midiToNoteName(e[6].at(-1).noteMidi)+"",o;return{c(){t=oe("p"),i=$e("Current closest note: "),o=$e(r)},m(a,h){Bt(a,t,h),D(t,i),D(t,o)},p(a,h){h&64&&r!==(r=Gf.midiToNoteName(a[6].at(-1).noteMidi)+"")&&jt(o,r)},d(a){a&&It(t)}}}function rue(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H=e[6].length>0&&u4(e);function Y(G){e[15](G)}let Q={callback:e[7]};return e[6]!==void 0&&(Q.notes=e[6]),L=new qs({props:Q}),In.push(()=>Yi(L,"notes",Y)),P=new $o({props:{exportFunction:e[8]}}),O=new Xo({props:{importFunction:e[9]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Allow microphone access and play pitch bends or vibratos. The line chart
        below shows how far you bend up and down over time.`,u=ge(),H&&H.c(),p=ge(),c=oe("div"),f=oe("label"),g=$e(`past seconds
            `),m=oe("input"),v=ge(),A=oe("label"),y=$e(`min. decibels
            `),C=oe("input"),E=ge(),x=oe("button"),x.textContent="resume",M=ge(),w=oe("div"),S=ge(),I=oe("div"),Ut(L.$$.fragment),k=ge(),Ut(P.$$.fragment),F=ge(),Ut(O.$$.fragment),fe(h,"class","explanation"),fe(m,"type","number"),fe(m,"min","5"),fe(m,"max","60"),fe(m,"step","5"),fe(C,"type","number"),fe(C,"min","-40"),fe(C,"max","-5"),fe(C,"step","5"),fe(A,"title","The minimum loudness in decibels for a sound to be registered as input. Lower means fainter notes will be registered but there will be more noise such as octave errors."),fe(x,"title","Press this button if your browser prevents audio access because there needs to be a user interaction first"),fe(c,"class","control"),fe(w,"class","visualization"),fe(I,"class","control"),fe(t,"class","demo")},m(G,J){Bt(G,t,J),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),H&&H.m(t,null),D(t,p),D(t,c),D(c,f),D(f,g),D(f,m),ln(m,e[4]),D(c,v),D(c,A),D(A,y),D(A,C),ln(C,e[5]),D(c,E),D(c,x),D(t,M),D(t,w),e[14](w),D(t,S),D(t,I),Ft(L,I,null),D(I,k),Ft(P,I,null),D(I,F),Ft(O,I,null),W=!0,V||($=[lt(m,"input",e[10]),lt(C,"input",e[11]),lt(C,"change",e[12]),lt(x,"click",e[13])],V=!0)},p(G,[J]){(!W||J&1)&&r!==(r=G[0].title+"")&&jt(o,r),G[6].length>0?H?H.p(G,J):(H=u4(G),H.c(),H.m(t,p)):H&&(H.d(1),H=null),J&16&&Yn(m.value)!==G[4]&&ln(m,G[4]),J&32&&Yn(C.value)!==G[5]&&ln(C,G[5]);const K={};!R&&J&64&&(R=!0,K.notes=G[6],Ki(()=>R=!1)),L.$set(K)},i(G){W||(Nt(L.$$.fragment,G),Nt(P.$$.fragment,G),Nt(O.$$.fragment,G),W=!0)},o(G){Ot(L.$$.fragment,G),Ot(P.$$.fragment,G),Ot(O.$$.fragment,G),W=!1},d(G){G&&It(t),H&&H.d(),e[14](null),kt(L),kt(P),kt(O),V=!1,ji($)}}}let sue=1200,oue=500;const aue=16;function lue(e,t,i){let{demoInfo:r}=t,o,a,h,u,p,c=10,f=-25,g=0,m=[];function v(L,R){h.getFloatTimeDomainData(L);const k=u.findPitch(L,R),P=k[0],F=k[1],O=Ss.fromFreq(P),W=Ss.midi(O),V=Gf.freqToMidi(P),$=(V-W)*100,Y={time:(performance.now()-g)/1e3,pitch:P,noteMidi:W,actualMidi:V,actualMidiChroma:V%12,centsOffset:$,clarity:F};m.push(Y),i(6,m=m.slice(-(1e3/aue)*c)),A(),p=requestAnimationFrame(()=>v(L,R))}const A=()=>{i(1,o.textContent="",o);const L=(performance.now()-g)/1e3,R=L-c,k=Ji({width:sue,height:oue,marginLeft:80,marginBottom:50,padding:0,x:{domain:[R,L],label:"time in seconds"},y:{domain:[-50,50],label:"offset in cents",grid:!0},marks:[hs([0]),qg(m,{x:"time",y:"centsOffset",clip:!0,curve:"basis"}),qg(m,{x:"time",y:"centsOffset",clip:!0,curve:"basis"})]});o.appendChild(k)},y=()=>{const L={pastTime:c,firstTimeStamp:g,minVolumeDecibels:f,bendValues:m};Lo(r.id,L)},C=async L=>{if(m.length===0||confirm("Import data and overwrite currently unsaved data?")){const R=await Ro(L);i(4,c=R.pastTime),g=R.firstTimeStamp,i(5,f=R.minVolumeDecibels),i(6,m=R.bendValues),A()}};tr(()=>{g=performance.now(),i(2,a=new window.AudioContext),h=a.createAnalyser(),navigator.mediaDevices.getUserMedia({audio:!0}).then(L=>{a.createMediaStreamSource(L).connect(h),i(3,u=Yu.forFloat32Array(h.fftSize)),i(3,u.minVolumeDecibels=f,u);const R=new Float32Array(u.inputLength);v(R,a.sampleRate)}),A()}),Io(()=>{clearTimeout(p),cancelAnimationFrame(p)});function E(){c=Yn(this.value),i(4,c)}function x(){f=Yn(this.value),i(5,f)}const M=()=>i(3,u.minVolumeDecibels=f,u),w=()=>a.resume();function S(L){In[L?"unshift":"push"](()=>{o=L,i(1,o)})}function I(L){m=L,i(6,m)}return e.$$set=L=>{"demoInfo"in L&&i(0,r=L.demoInfo)},[r,o,a,u,c,f,m,A,y,C,E,x,M,w,S,I]}class cue extends pi{constructor(t){super(),di(this,t,lue,rue,fi,{demoInfo:0})}}function uue(e,t,i){let{key:r=" "}=t,{callback:o=()=>{}}=t;const a=h=>{h.key===r&&(h.preventDefault(),o())};return tr(()=>{document.addEventListener("keydown",a)}),Io(()=>{document.removeEventListener("keydown",a)}),e.$$set=h=>{"key"in h&&i(0,r=h.key),"callback"in h&&i(1,o=h.callback)},[r,o]}class Sa extends pi{constructor(t){super(),di(this,t,uue,null,fi,{key:0,callback:1})}}function hue(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R=(e[4]?Yr:qr)+"",k,P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue;function he(Se){e[11](Se)}let Me={callback:e[10]};e[2]!==void 0&&(Me.value=e[2]),C=new La({props:Me}),In.push(()=>Yi(C,"value",he));function de(Se){e[12](Se)}let Pe={callback:e[10]};return e[3]!==void 0&&(Pe.value=e[3]),M=new ad({props:Pe}),In.push(()=>Yi(M,"value",de)),H=new bc({props:{tempo:e[2],accent:4}}),Q=new Sa({props:{key:" ",callback:e[16]}}),J=new Nr({props:{noteOn:e[9]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),u=$e(`Set a tempo and start playing. The time between the notes you play will
        be displayed as note symbols, so you can see whether you play, for
        example, correct quarter notes. Numbers show you how many percent of the
        detected note duration you played, for example a -5 means your note was
        5% too short. Bars below show you these percent as well, `),p=oe("span"),c=$e("blue"),f=$e(`
        for notes that were too long (playing too slow) and
        `),g=oe("span"),m=$e("orange"),v=$e(" for short (fast) ones."),A=ge(),y=oe("div"),Ut(C.$$.fragment),x=ge(),Ut(M.$$.fragment),S=ge(),I=oe("button"),L=$e("dotted notes "),k=$e(R),P=ge(),F=oe("div"),O=ge(),W=oe("div"),V=oe("button"),V.textContent="reset",$=ge(),Ut(H.$$.fragment),Y=ge(),Ut(Q.$$.fragment),G=ge(),Ut(J.$$.fragment),cr(p,"color",e[8]),cr(g,"color",e[7]),fe(h,"class","explanation"),fe(I,"title","Use dotted notes? If not, the closest non-dotted note will be taken."),fe(y,"class","control"),fe(F,"class","visualization"),fe(V,"title","Clear played notes"),fe(W,"class","control"),fe(t,"class","demo")},m(Se,Le){Bt(Se,t,Le),D(t,i),D(i,o),D(t,a),D(t,h),D(h,u),D(h,p),D(p,c),D(h,f),D(h,g),D(g,m),D(h,v),D(t,A),D(t,y),Ft(C,y,null),D(y,x),Ft(M,y,null),D(y,S),D(y,I),D(I,L),D(I,k),D(t,P),D(t,F),e[14](F),D(t,O),D(t,W),D(W,V),D(W,$),Ft(H,W,null),D(t,Y),Ft(Q,t,null),D(t,G),Ft(J,t,null),K=!0,se||(ue=[lt(I,"click",e[13]),lt(V,"click",e[15])],se=!0)},p(Se,[Le]){(!K||Le&1)&&r!==(r=Se[0].title+"")&&jt(o,r);const be={};!E&&Le&4&&(E=!0,be.value=Se[2],Ki(()=>E=!1)),C.$set(be);const je={};!w&&Le&8&&(w=!0,je.value=Se[3],Ki(()=>w=!1)),M.$set(je),(!K||Le&16)&&R!==(R=(Se[4]?Yr:qr)+"")&&jt(k,R);const Te={};Le&4&&(Te.tempo=Se[2]),H.$set(Te)},i(Se){K||(Nt(C.$$.fragment,Se),Nt(M.$$.fragment,Se),Nt(H.$$.fragment,Se),Nt(Q.$$.fragment,Se),Nt(J.$$.fragment,Se),K=!0)},o(Se){Ot(C.$$.fragment,Se),Ot(M.$$.fragment,Se),Ot(H.$$.fragment,Se),Ot(Q.$$.fragment,Se),Ot(J.$$.fragment,Se),K=!1},d(Se){Se&&It(t),kt(C),kt(M),e[14](null),kt(H),kt(Q),kt(J),se=!1,ji(ue)}}}let h4=1e3;function fue(e,t,i){let{demoInfo:r}=t,o,a=120,h=10,u=!0;const p=Vp[1],c=Vp[0];let f=0,g=[];const m=hP,v=m.filter(I=>!I.dotted),A=async I=>{g.length===0&&i(5,f=I.timestamp);const R=(I.timestamp-f)/1e3;g.push(R),y()},y=()=>{if(i(1,o.textContent="",o),g.length===0)return;let I=xs(a);const L=g.slice(-(h+1)),k=L.map((V,$)=>$===0?0:V-L[$-1]).map(V=>V/I),P=u?m:v,F=k.map(V=>{const $=H_(P,Y=>Math.abs(V-Y.beats)),H=P[$];return{...H,beats:V,offsetPercent:(V/H.beats*100).toFixed()}}),O=Ji({width:h4,height:100,marginLeft:80,x:{label:"",domain:Mn(1,h),ticks:[]},y:{domain:[1,0],ticks:Mn(3),tickFormat:V=>["note","percent too long"][V]},marks:[Ba(F,{text:"symbol",x:(V,$)=>$,y:0,fontSize:40}),Ba(F,{text:V=>V.offsetPercent-100,x:(V,$)=>$,y:1,fontSize:20})]});o.appendChild(O);const W=Ji({width:h4,height:250,marginLeft:80,x:{label:"Note",domain:Mn(1,h),tickSize:0,ticks:[]},y:{label:"percent too long",domain:[-30,30],ticks:Mn(-30,31,10),grid:!0},marks:[Wf(F,{x:(V,$)=>$,y:V=>V.offsetPercent-100,fill:V=>V.offsetPercent<100?p:c}),hs([0])]});o.appendChild(W)};tr(y);function C(I){a=I,i(2,a)}function E(I){h=I,i(3,h)}const x=()=>{i(4,u=!u),y()};function M(I){In[I?"unshift":"push"](()=>{o=I,i(1,o)})}const w=()=>{confirm("Clear notes?")&&(i(5,f=performance.now()),i(6,g=[]),y())},S=()=>A({timestamp:performance.now()});return e.$$set=I=>{"demoInfo"in I&&i(0,r=I.demoInfo)},[r,o,a,h,u,f,g,p,c,A,y,C,E,x,M,w,S]}class due extends pi{constructor(t){super(),di(this,t,fue,hue,fi,{demoInfo:0})}}function pue(e,t,i){const r=e.slice();return r[32]=t[i],r}function mue(e,t,i){const r=e.slice();return r[32]=t[i],r}function Aue(e){let t;return{c(){t=oe("option"),t.textContent=`${e[32]}`,t.__value=e[32],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function gue(e){let t;return{c(){t=oe("option"),t.textContent=`${e[32]}`,t.__value=e[32],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function vue(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te,rt,mt,vt,ft,Ze,St,$t,ct,Ct,Tt,At,pn,yt,kn,qn,Gt,bt,ye,_e,Ue,Re;function Ce(He){e[20](He)}let Ne={label:"initial tempo",title:"Set a tempo at which you are able to input the exercise precisely (in BPM)",callback:e[16]};e[2]!==void 0&&(Ne.value=e[2]),c=new La({props:Ne}),In.push(()=>Yi(c,"value",Ce));function le(He){e[21](He)}let j={label:"target tempo",title:"Set the tempo you want to be able to play the exercise at (in BPM)",callback:e[16]};e[3]!==void 0&&(j.value=e[3]),m=new La({props:j}),In.push(()=>Yi(m,"value",le));let Z=fn(["off","32nd","16th","8th"]),pe=[];for(let He=0;He<4;He+=1)pe[He]=Aue(mue(e,Z,He));let Ee=fn(["quarter","eighth","quarter-triplets","swing"]),Qe=[];for(let He=0;He<4;He+=1)Qe[He]=gue(pue(e,Ee,He));return pn=new $o({props:{exportFunction:e[18]}}),kn=new Xo({props:{importFunction:e[19]}}),Gt=new Sa({props:{key:" ",callback:e[26]}}),ye=new Nr({props:{noteOn:e[11]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo.`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),Ut(m.$$.fragment),A=ge(),y=oe("label"),C=$e(`tempo increase
            `),E=oe("input"),x=ge(),M=oe("label"),w=$e(`quantize exercise
            `),S=oe("select");for(let He=0;He<4;He+=1)pe[He].c();I=ge(),L=oe("div"),R=oe("label"),k=$e(`pre-defined exercise
            `),P=oe("select");for(let He=0;He<4;He+=1)Qe[He].c();F=ge(),O=oe("button"),W=$e("input exercise"),$=ge(),H=oe("button"),Y=$e("save exercise"),G=ge(),J=oe("button"),K=$e("start practice"),ue=ge(),he=oe("button"),Me=$e("stop practice"),Pe=ge(),Se=oe("div"),Le=$e("current step: "),be=oe("b"),je=$e(e[6]),Te=$e(" current tempo: "),rt=oe("b"),mt=$e(e[7]),vt=$e(" BPM"),ft=ge(),Ze=oe("div"),St=ge(),$t=oe("div"),ct=oe("button"),Ct=$e("reset practice"),At=ge(),Ut(pn.$$.fragment),yt=ge(),Ut(kn.$$.fragment),qn=ge(),Ut(Gt.$$.fragment),bt=ge(),Ut(ye.$$.fragment),fe(h,"class","explanation"),fe(E,"type","number"),fe(E,"min","1"),fe(E,"max","20"),fe(E,"step","1"),fe(y,"title","Set the tempo increase between practice runs (in BPM)"),e[5]===void 0&&yr(()=>e[23].call(S)),fe(p,"class","control"),fe(O,"title","Start recording the exercise."),O.disabled=V=e[6]==="input exercise"||e[6]==="practice",fe(H,"title","Stop recording the exercise."),H.disabled=Q=e[6]!=="input exercise",fe(J,"title","Start recording the practice with speed-up."),J.disabled=se=e[9].length===0,fe(he,"title","Stop recording the practice with speed-up."),he.disabled=de=e[6]!=="practice",fe(L,"class","control"),fe(Ze,"class","visualization"),fe(ct,"title","Clear practice but not exercise"),ct.disabled=Tt=e[6]!=="",fe($t,"class","control"),fe(t,"class","demo")},m(He,Pt){Bt(He,t,Pt),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),Ft(m,p,null),D(p,A),D(p,y),D(y,C),D(y,E),ln(E,e[4]),D(p,x),D(p,M),D(M,w),D(M,S);for(let rn=0;rn<4;rn+=1)pe[rn]&&pe[rn].m(S,null);ci(S,e[5],!0),D(t,I),D(t,L),D(L,R),D(R,k),D(R,P);for(let rn=0;rn<4;rn+=1)Qe[rn]&&Qe[rn].m(P,null);D(L,F),D(L,O),D(O,W),D(L,$),D(L,H),D(H,Y),D(L,G),D(L,J),D(J,K),D(L,ue),D(L,he),D(he,Me),D(t,Pe),D(t,Se),D(Se,Le),D(Se,be),D(be,je),D(Se,Te),D(Se,rt),D(rt,mt),D(Se,vt),D(t,ft),D(t,Ze),e[24](Ze),D(t,St),D(t,$t),D($t,ct),D(ct,Ct),D($t,At),Ft(pn,$t,null),D($t,yt),Ft(kn,$t,null),D(t,qn),Ft(Gt,t,null),D(t,bt),Ft(ye,t,null),_e=!0,Ue||(Re=[lt(E,"input",e[22]),lt(S,"change",e[23]),lt(S,"change",e[16]),lt(P,"change",e[17]),lt(O,"click",e[12]),lt(H,"click",e[13]),lt(J,"click",e[14]),lt(he,"click",e[15]),lt(ct,"click",e[25])],Ue=!0)},p(He,Pt){(!_e||Pt[0]&1)&&r!==(r=He[0].title+"")&&jt(o,r);const rn={};!f&&Pt[0]&4&&(f=!0,rn.value=He[2],Ki(()=>f=!1)),c.$set(rn);const Xt={};!v&&Pt[0]&8&&(v=!0,Xt.value=He[3],Ki(()=>v=!1)),m.$set(Xt),Pt[0]&16&&Yn(E.value)!==He[4]&&ln(E,He[4]),Pt[0]&32&&ci(S,He[5]),(!_e||Pt[0]&64&&V!==(V=He[6]==="input exercise"||He[6]==="practice"))&&(O.disabled=V),(!_e||Pt[0]&64&&Q!==(Q=He[6]!=="input exercise"))&&(H.disabled=Q),(!_e||Pt[0]&512&&se!==(se=He[9].length===0))&&(J.disabled=se),(!_e||Pt[0]&64&&de!==(de=He[6]!=="practice"))&&(he.disabled=de),(!_e||Pt[0]&64)&&jt(je,He[6]),(!_e||Pt[0]&128)&&jt(mt,He[7]),(!_e||Pt[0]&64&&Tt!==(Tt=He[6]!==""))&&(ct.disabled=Tt)},i(He){_e||(Nt(c.$$.fragment,He),Nt(m.$$.fragment,He),Nt(pn.$$.fragment,He),Nt(kn.$$.fragment,He),Nt(Gt.$$.fragment,He),Nt(ye.$$.fragment,He),_e=!0)},o(He){Ot(c.$$.fragment,He),Ot(m.$$.fragment,He),Ot(pn.$$.fragment,He),Ot(kn.$$.fragment,He),Ot(Gt.$$.fragment,He),Ot(ye.$$.fragment,He),_e=!1},d(He){He&&It(t),kt(c),kt(m),ti(pe,He),ti(Qe,He),e[24](null),kt(pn),kt(kn),kt(Gt),kt(ye),Ue=!1,ji(Re)}}}let f4=1e3,bue=60;function yue(e,t,i){const r=e[0];return e.map(a=>{let h=a-r;if(t!=="off"){let u;t==="8th"&&(u=i/2),t==="16th"&&(u=i/4),t==="32nd"&&(u=i/8),h=Math.round(h/u)*u}return h/i})}function _ue(e,t,i){let{demoInfo:r}=t,o,a=new xw,h=60,u=120,p=10,c="off",f="",g=u,m=performance.now(),v=[],A,y=new Map,C=!0,E;const x=async G=>{const K=(G.timestamp-m)/1e3;if(f==="input exercise")i(9,v=[...v,K]);else if(f==="practice"){y.has(g)||y.set(g,[]);const se=y.get(g);C&&se.push(K)}R()},M=async()=>{const G=y.get(g);if(!G||!G.length)return;const J=So(G),se=(performance.now()-m)/1e3-J;let ue=xs(g);se/ue>=A&&(console.log("increasing bpm"),a.stop(),g<=u?(i(7,g+=p),C=!1,await R6(1),a.start(g,4),y.has(g)&&y.set(g,[]),C=!0):L())},w=()=>{i(6,f="input exercise"),i(9,v=[]),i(10,y=new Map),a.start(h,4),R()},S=()=>{if(i(6,f=""),a.stop(),v.length>0){const G=Zr(v)-So(v);let J=xs(h);A=Math.ceil(G/J)}},I=async()=>{if(v.length===0){alert("You need to input an exercise first");return}i(6,f="practice"),i(7,g=h),i(10,y=new Map),a.start(g,4),E=setInterval(M,100)},L=()=>{console.log("stop practice"),i(6,f=""),i(7,g=u),clearInterval(E),a.stop()},R=()=>{if(i(1,o.textContent="",o),v.length===0)return;let G=xs(h);const J=yue(v,c,G);let K=Math.ceil(Zr(J)/4*4)+.5;console.log(J,K);const se=Ji({width:f4,height:bue,marginLeft:40,x:{label:"time in beats",domain:[0,K]},y:{},marks:[no(Mn(0,K,1),{stroke:"#ddd"}),no(Mn(0,K,4)),po(J,{symbol:"times",stroke:"#333",x:ue=>ue,r:5})]});o.appendChild(se);for(const[ue,he]of y){const Me=he[0];G=xs(ue);const de=he.map(Se=>(Se-Me)/G),Pe=Ji({width:f4,height:70,marginLeft:40,x:{label:"time in beats",domain:[0,K]},y:{label:`${ue} BPM`,ticks:[]},marks:[no(Mn(0,K,1),{stroke:"#ddd"}),no(Mn(0,K,4)),po(de,{symbol:"times",stroke:"#333",x:Se=>Se,y:0,r:5})]});o.appendChild(Pe)}};tr(R),Io(()=>{clearInterval(E),a.stop()});const k=G=>{const J=G.target.value,K=new Map([["quarter",Mn(0,8,1)],["eighth",Mn(0,8,.5)],["quarter-triplets",Mn(0,8,1/3)],["swing",Mn(0,8,.5).map((he,Me)=>Me%2===0?Me:Me+.2)]]),se=xs(h);i(5,c="off");const ue=K.get(J);i(9,v=ue.map(he=>he*se)),A=Math.ceil(Zr(ue)+1),R()},P=()=>{const G={initialTempo:h,targetTempo:u,tempoIncrease:p,quantize:c,currentStep:f,currentTempo:g,firstTimeStamp:m,exerciseNotes:v,exerciseBeatCount:A,practiceRecordings:y};Lo(r.id,G)},F=async G=>{if(v.length===0||confirm("Import data and overwrite currently unsaved data?")){const J=await Ro(G);i(2,h=J.initialTempo),i(3,u=J.targetTempo),i(4,p=J.tempoIncrease),i(5,c=J.quantize),i(6,f=J.currentStep),i(7,g=J.currentTempo),i(8,m=J.firstTimeStamp),i(9,v=J.exerciseNotes),A=J.exerciseBeatCount,i(10,y=J.practiceRecordings),R()}};function O(G){h=G,i(2,h)}function W(G){u=G,i(3,u)}function V(){p=Yn(this.value),i(4,p)}function $(){c=Dr(this),i(5,c)}function H(G){In[G?"unshift":"push"](()=>{o=G,i(1,o)})}const Y=()=>{confirm("Reset practice?")&&(i(10,y=new Map),i(8,m=performance.now()),R())},Q=()=>x({timestamp:performance.now()});return e.$$set=G=>{"demoInfo"in G&&i(0,r=G.demoInfo)},[r,o,h,u,p,c,f,g,m,v,y,x,w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q]}class Eue extends pi{constructor(t){super(),di(this,t,_ue,vue,fi,{demoInfo:0},null,[-1,-1])}}function wue(e,t,i){const r=e.slice();return r[33]=t[i],r}function Cue(e,t,i){const r=e.slice();return r[33]=t[i],r}function xue(e){let t;return{c(){t=oe("option"),t.textContent=`${e[33]}`,t.__value=e[33],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Mue(e){let t;return{c(){t=oe("option"),t.textContent=`${e[33]}`,t.__value=e[33],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Sue(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te,rt,mt,vt,ft,Ze,St,$t,ct,Ct,Tt,At,pn,yt,kn,qn,Gt,bt,ye,_e;function Ue(Ee){e[20](Ee)}let Re={label:"initial tempo",title:"Set a tempo at which you are able to input the exercise precisely (in BPM)",callback:e[16]};e[2]!==void 0&&(Re.value=e[2]),c=new La({props:Re}),In.push(()=>Yi(c,"value",Ue));function Ce(Ee){e[21](Ee)}let Ne={label:"target tempo",title:"Set the tempo you want to be able to play the exercise at (in BPM)",callback:e[16]};e[3]!==void 0&&(Ne.value=e[3]),m=new La({props:Ne}),In.push(()=>Yi(m,"value",Ce));let le=fn(["off","32nd","16th","8th"]),j=[];for(let Ee=0;Ee<4;Ee+=1)j[Ee]=xue(Cue(e,le,Ee));let Z=fn(["quarter","eighth","quarter-triplets","swing"]),pe=[];for(let Ee=0;Ee<4;Ee+=1)pe[Ee]=Mue(wue(e,Z,Ee));return pn=new $o({props:{exportFunction:e[18]}}),kn=new Xo({props:{importFunction:e[19]}}),Gt=new Nr({props:{noteOn:e[11]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`Adjust the initial and target tempo, record an exercise at the inital
        tempo, and then practice it with increasing speed until you reach your
        target tempo. The notes you play are displayed in a guitar-tab-like
        visualization with crosses, numbers above notes indicate the fret. The
        darkness (white to black) encodes the notes' velocities, so eventual
        noise (unintended notes) is less distracting.`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),Ut(m.$$.fragment),A=ge(),y=oe("label"),C=$e(`tempo increase
            `),E=oe("input"),x=ge(),M=oe("label"),w=$e(`quantize exercise
            `),S=oe("select");for(let Ee=0;Ee<4;Ee+=1)j[Ee].c();I=ge(),L=oe("div"),R=oe("label"),k=$e(`pre-defined exercise
            `),P=oe("select");for(let Ee=0;Ee<4;Ee+=1)pe[Ee].c();F=ge(),O=oe("button"),W=$e("input exercise"),$=ge(),H=oe("button"),Y=$e("save exercise"),G=ge(),J=oe("button"),K=$e("start practice"),ue=ge(),he=oe("button"),Me=$e("stop practice"),Pe=ge(),Se=oe("div"),Le=$e("current step: "),be=oe("b"),je=$e(e[6]),Te=$e(" current tempo: "),rt=oe("b"),mt=$e(e[7]),vt=$e(" BPM"),ft=ge(),Ze=oe("div"),St=ge(),$t=oe("div"),ct=oe("button"),Ct=$e("reset practice"),At=ge(),Ut(pn.$$.fragment),yt=ge(),Ut(kn.$$.fragment),qn=ge(),Ut(Gt.$$.fragment),fe(h,"class","explanation"),fe(E,"type","number"),fe(E,"min","1"),fe(E,"max","20"),fe(E,"step","1"),fe(y,"title","Set the tempo increase between practice runs (in BPM)"),e[5]===void 0&&yr(()=>e[23].call(S)),fe(p,"class","control"),fe(O,"title","Start recording the exercise."),O.disabled=V=e[6]==="input exercise"||e[6]==="practice",fe(H,"title","Stop recording the exercise."),H.disabled=Q=e[6]!=="input exercise",fe(J,"title","Start recording the practice with speed-up."),J.disabled=se=e[9].length===0,fe(he,"title","Stop recording the practice with speed-up."),he.disabled=de=e[6]!=="practice",fe(L,"class","control"),fe(Ze,"class","visualization"),fe(ct,"title","Clear practice but not exercise"),ct.disabled=Tt=e[6]!=="",fe($t,"class","control"),fe(t,"class","demo")},m(Ee,Qe){Bt(Ee,t,Qe),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),Ft(m,p,null),D(p,A),D(p,y),D(y,C),D(y,E),ln(E,e[4]),D(p,x),D(p,M),D(M,w),D(M,S);for(let He=0;He<4;He+=1)j[He]&&j[He].m(S,null);ci(S,e[5],!0),D(t,I),D(t,L),D(L,R),D(R,k),D(R,P);for(let He=0;He<4;He+=1)pe[He]&&pe[He].m(P,null);D(L,F),D(L,O),D(O,W),D(L,$),D(L,H),D(H,Y),D(L,G),D(L,J),D(J,K),D(L,ue),D(L,he),D(he,Me),D(t,Pe),D(t,Se),D(Se,Le),D(Se,be),D(be,je),D(Se,Te),D(Se,rt),D(rt,mt),D(Se,vt),D(t,ft),D(t,Ze),e[24](Ze),D(t,St),D(t,$t),D($t,ct),D(ct,Ct),D($t,At),Ft(pn,$t,null),D($t,yt),Ft(kn,$t,null),D(t,qn),Ft(Gt,t,null),bt=!0,ye||(_e=[lt(E,"input",e[22]),lt(S,"change",e[23]),lt(S,"change",e[16]),lt(P,"change",e[17]),lt(O,"click",e[12]),lt(H,"click",e[13]),lt(J,"click",e[14]),lt(he,"click",e[15]),lt(ct,"click",e[25])],ye=!0)},p(Ee,Qe){(!bt||Qe[0]&1)&&r!==(r=Ee[0].title+"")&&jt(o,r);const He={};!f&&Qe[0]&4&&(f=!0,He.value=Ee[2],Ki(()=>f=!1)),c.$set(He);const Pt={};!v&&Qe[0]&8&&(v=!0,Pt.value=Ee[3],Ki(()=>v=!1)),m.$set(Pt),Qe[0]&16&&Yn(E.value)!==Ee[4]&&ln(E,Ee[4]),Qe[0]&32&&ci(S,Ee[5]),(!bt||Qe[0]&64&&V!==(V=Ee[6]==="input exercise"||Ee[6]==="practice"))&&(O.disabled=V),(!bt||Qe[0]&64&&Q!==(Q=Ee[6]!=="input exercise"))&&(H.disabled=Q),(!bt||Qe[0]&512&&se!==(se=Ee[9].length===0))&&(J.disabled=se),(!bt||Qe[0]&64&&de!==(de=Ee[6]!=="practice"))&&(he.disabled=de),(!bt||Qe[0]&64)&&jt(je,Ee[6]),(!bt||Qe[0]&128)&&jt(mt,Ee[7]),(!bt||Qe[0]&64&&Tt!==(Tt=Ee[6]!==""))&&(ct.disabled=Tt)},i(Ee){bt||(Nt(c.$$.fragment,Ee),Nt(m.$$.fragment,Ee),Nt(pn.$$.fragment,Ee),Nt(kn.$$.fragment,Ee),Nt(Gt.$$.fragment,Ee),bt=!0)},o(Ee){Ot(c.$$.fragment,Ee),Ot(m.$$.fragment,Ee),Ot(pn.$$.fragment,Ee),Ot(kn.$$.fragment,Ee),Ot(Gt.$$.fragment,Ee),bt=!1},d(Ee){Ee&&It(t),kt(c),kt(m),ti(j,Ee),ti(pe,Ee),e[24](null),kt(pn),kt(kn),kt(Gt),ye=!1,ji(_e)}}}let d4=1e3,p4=150,jA=6;function Tue(e,t,i){const r=e[0].time;return e.map(a=>{let h=a.time-r;if(t!=="off"){let p;t==="8th"&&(p=i/2),t==="16th"&&(p=i/4),t==="32nd"&&(p=i/8),h=Math.round(h/p)*p}const u=h/i;return{...a,time:u}})}function Iue(e,t,i){let{demoInfo:r}=t,o,a=new xw,h=!0,u,p=60,c=120,f=10,g="off",m="",v=c,A=performance.now(),y=[],C,E=new Map,x=[64,59,55,50,45,40];const M=x.map(Ss.fromMidiSharps),w=async J=>{const K=(J.timestamp-A)/1e3,se=J.message.channel-1,ue={time:K,string:se,fret:J.note.number-x[se],velocity:J.rawVelocity};if(m==="input exercise")i(9,y=[...y,ue]);else if(m==="practice"){E.has(v)||E.set(v,[]);const he=E.get(v);h&&he.push(ue)}P()},S=async()=>{const J=E.get(v);if(!J||!J.length)return;const K=So(J,de=>de.time),ue=(performance.now()-A)/1e3-K;let he=xs(v);ue/he>=C&&(console.log("increasing bpm"),a.stop(),v<=c?(i(7,v+=f),h=!1,await R6(1),a.start(v,4),E.has(v)&&E.set(v,[]),h=!0):k())},I=()=>{i(6,m="input exercise"),i(9,y=[]),i(10,E=new Map),a.start(p,4),P()},L=()=>{if(i(6,m=""),a.stop(),y.length>0){const J=Zr(y,se=>se.time)-So(y,se=>se.time);let K=xs(p);C=Math.ceil(J/K)}},R=async()=>{if(y.length===0){alert("You need to input an exercise first");return}i(6,m="practice"),i(7,v=p),i(10,E=new Map),a.start(v,4),u=setInterval(S,100)},k=()=>{i(6,m=""),i(7,v=c),clearInterval(u),a.stop()},P=()=>{if(i(1,o.textContent="",o),y.length===0)return;let J=xs(p);const K=Tue(y,g,J);let se=Math.ceil(Zr(K,he=>he.time)/4*4)+.5;const ue=Ji({width:d4,height:p4,marginLeft:40,x:{label:"time in beats",domain:[0,se]},y:{domain:Mn(0,jA),tickFormat:he=>M[he],tickSize:0},marks:[no(Mn(0,se,1),{stroke:"#ddd"}),hs(Mn(0,jA),{stroke:"#ddd"}),no(Mn(0,se,4)),po(K,{symbol:"times",stroke:"#333",x:he=>he.time,y:he=>he.string,r:5})]});o.appendChild(ue);for(const[he,Me]of E){if(Me.length===0)continue;const de=Me[0].time;J=xs(he);const Pe=Me.map(Le=>({...Le,time:(Le.time-de)/J})),Se=Ji({width:d4,height:p4,marginLeft:40,x:{label:"time in beats",domain:[0,se]},y:{label:`${he} BPM`,domain:Mn(0,jA),tickFormat:Le=>M[Le],tickSize:0},color:{domain:[0,127],scheme:"Greys"},marks:[no(Mn(0,se,1),{stroke:"#ddd"}),no(Mn(0,se,4)),hs(Mn(0,jA),{stroke:"#ddd"}),po(Pe,{symbol:"times",stroke:"velocity",x:Le=>Le.time,y:Le=>Le.string,r:4}),Ba(Pe,{text:"fret",fill:"velocity",x:Le=>Le.time,y:Le=>Le.string,textAnchor:"middle",dy:-10})]});o.appendChild(Se)}};tr(P),Io(()=>{clearInterval(u),a.stop()});const F=J=>{const K=J.target.value,se=new Map([["quarter",Mn(0,8,1)],["eighth",Mn(0,8,.5)],["quarter-triplets",Mn(0,8,1/3)],["swing",Mn(0,8,.5).map((Me,de)=>de%2===0?de:de+.2)]]),ue=xs(p);i(5,g="off");const he=se.get(K);i(9,y=he.map(Me=>Me*ue)),C=Math.ceil(Zr(he)+1),i(9,y=y.map(Me=>({time:Me,string:5,fret:5}))),P()},O=()=>{const J={initialTempo:p,targetTempo:c,tempoIncrease:f,quantize:g,currentStep:m,currentTempo:v,firstTimeStamp:A,exerciseNotes:y,exerciseBeatCount:C,practiceRecordings:E};Lo(r.id,J)},W=async J=>{if(y.length===0||confirm("Import data and overwrite currently unsaved data?")){const K=await Ro(J);i(2,p=K.initialTempo),i(3,c=K.targetTempo),i(4,f=K.tempoIncrease),i(5,g=K.quantize),i(6,m=K.currentStep),i(7,v=K.currentTempo),i(8,A=K.firstTimeStamp),i(9,y=K.exerciseNotes),C=K.exerciseBeatCount,i(10,E=K.practiceRecordings),P()}};function V(J){p=J,i(2,p)}function $(J){c=J,i(3,c)}function H(){f=Yn(this.value),i(4,f)}function Y(){g=Dr(this),i(5,g)}function Q(J){In[J?"unshift":"push"](()=>{o=J,i(1,o)})}const G=()=>{confirm("Reset practice?")&&(i(10,E=new Map),i(8,A=performance.now()),P())};return e.$$set=J=>{"demoInfo"in J&&i(0,r=J.demoInfo)},[r,o,p,c,f,g,m,v,A,y,E,w,I,L,R,k,P,F,O,W,V,$,H,Y,Q,G]}class Bue extends pi{constructor(t){super(),di(this,t,Iue,Sue,fi,{demoInfo:0},null,[-1,-1])}}function Rue(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k;return I=new Nr({props:{noteOn:e[7],noteOff:e[8]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.textContent=`This demo shows you how you strummed (up or down? which strings?), so
        you can make sure you strumm a pattern as intended. For example, try
        strumming D U U D. The upper chart shows you the when you played a note
        on which string. The lower chart shows you the time between the start of
        the first and last note of the chord (rectangle width) and which strings
        it spanned (rectangle y and height). Blue chords were strummed upward
        and orange ones downward.`,u=ge(),p=oe("div"),c=oe("label"),f=$e(`time
            `),g=oe("input"),m=ge(),v=oe("label"),A=$e(`max. note distance
            `),y=oe("input"),C=ge(),E=oe("div"),x=ge(),M=oe("div"),w=oe("button"),w.textContent="reset",S=ge(),Ut(I.$$.fragment),fe(h,"class","explanation"),fe(g,"type","number"),fe(g,"min","10"),fe(g,"max","300"),fe(g,"step","10"),fe(c,"title","time in seconds for past notes to be shown"),fe(y,"type","number"),fe(y,"min","0.05"),fe(y,"max","5"),fe(y,"step","0.05"),fe(v,"title","maximum distance between notes such that they still count as beloning to the same chord"),fe(p,"class","control"),fe(E,"class","visualization"),fe(w,"title","Clear all played notes"),fe(M,"class","control"),fe(t,"class","demo")},m(P,F){Bt(P,t,F),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(p,c),D(c,f),D(c,g),ln(g,e[2]),D(p,m),D(p,v),D(v,A),D(v,y),ln(y,e[3]),D(t,C),D(t,E),e[12](E),D(t,x),D(t,M),D(M,w),D(t,S),Ft(I,t,null),L=!0,R||(k=[lt(g,"input",e[10]),lt(y,"input",e[11]),lt(y,"change",e[9]),lt(w,"click",e[13])],R=!0)},p(P,[F]){(!L||F&1)&&r!==(r=P[0].title+"")&&jt(o,r),F&4&&Yn(g.value)!==P[2]&&ln(g,P[2]),F&8&&Yn(y.value)!==P[3]&&ln(y,P[3])},i(P){L||(Nt(I.$$.fragment,P),L=!0)},o(P){Ot(I.$$.fragment,P),L=!1},d(P){P&&It(t),e[12](null),kt(I),R=!1,ji(k)}}}let m4=1e3,A4=200,f2=6;function Lue(e,t,i){let{demoInfo:r}=t,o=[64,59,55,50,45,40];const a=o.map(Ss.fromMidiSharps);let h,u=10,p=.1;const c=iS("guitarMidiMinVelocity")??0,f=iS("guitarMidiMinDuration")??0;console.log({minVelo:c,minDur:f});let g=0,m=[],v=new Map;const A=S=>{const I=(S.timestamp-g)/1e3,L=S.message.channel-1,R={number:S.note.number,velocity:S.rawVelocity,time:I,channel:S.message.channel,string:L,fret:S.note.number-o[L]};if(v.has(S.note.number)){const k=v.get(S.note.number);k.end===void 0&&(k.end=I)}m.push(R),v.set(S.note.number,R),C()},y=S=>{if(v.has(S.note.number)){const I=v.get(S.note.number),L=(S.timestamp-g)/1e3;I.end=L,I.duration=I.end-I.time}C()},C=()=>{const S=(performance.now()-g)/1e3+.5,I=S-u,L=m.filter(O=>(O.end>I||O.end===void 0)&&O.velocity>=c&&(O.duration===void 0||O.duration>=f)),k=Mw(L,p).map(O=>{const W=Ms(O,H=>H.string),V=Ms(O,H=>H.time),$=O.slice(1).map((H,Y)=>H.string-O[Y].string);return{minString:W[0],maxString:W[1],minTime:V[0],maxTime:V[1],direction:Lp($)>0?"up":"down"}}),P=Ji({width:m4,height:A4,marginLeft:60,marginBottom:40,x:{label:"Time in seconds",domain:[I,S]},y:{label:"String",grid:!0,domain:Mn(0,f2),tickFormat:O=>a[O]},color:{type:"categorical",label:"MIDI channel",scheme:"observable10",reverse:!0,legend:!0,marginLeft:100,width:300,domain:Mn(1,f2+1)},opacity:{domain:[0,127]},marks:[Xa(L,{clip:!0,x:"time",y:"string",stroke:"channel",opacity:"velocity",strokeWidth:3})]}),F=Ji({width:m4,height:A4,marginLeft:60,marginBottom:40,x:{label:"Time in seconds",domain:[I,S]},y:{label:"Strumming",grid:!0,domain:Mn(0,f2),tickFormat:O=>a[O]},color:{type:"categorical",scheme:"observable10",legend:!0,marginLeft:100,width:300,domain:["up","down"]},marks:[Fte(k,{clip:!0,x1:"minTime",x2:"maxTime",y1:"minString",y2:"maxString",fill:"direction",rx:5})]});i(1,h.textContent="",h),h.appendChild(P),h.appendChild(F)};tr(()=>{i(4,g=performance.now()),C()});function E(){u=Yn(this.value),i(2,u)}function x(){p=Yn(this.value),i(3,p)}function M(S){In[S?"unshift":"push"](()=>{h=S,i(1,h)})}const w=()=>{confirm("Reset played notes?")&&(i(5,m=[]),i(6,v=new Map),i(4,g=performance.now()))};return e.$$set=S=>{"demoInfo"in S&&i(0,r=S.demoInfo)},[r,h,u,p,g,m,v,A,y,C,E,x,M,w]}class Pue extends pi{constructor(t){super(),di(this,t,Lue,Rue,fi,{demoInfo:0})}}function g4(e,t){return e==null?t:typeof e=="function"?e:i=>i[e]}function Due(e,t,i,r,o,a){const h=new Float64Array(a),u=(a-1)/(o-r);for(let p=0;p<e.length;++p){const c=e[p],f=t(c,p,e),g=i(c,p,e);if(!(Number.isFinite(f)&&Number.isFinite(g)))continue;const m=(f-r)*u,v=Math.floor(m),A=v+1;0<=v&&A<a?(h[v]+=(A-m)*g,h[A]+=(m-v)*g):v===-1?h[A]+=(m-v)*g:A===a&&(h[v]+=(A-m)*g)}return h}function v4(e,t=!1){const i=new Float64Array(5),r=new Float64Array(4);Nue(i,r,e);const o=Float64Array.of(0,r[1]-i[1]*r[0],r[2]-i[2]*r[0],r[3]-i[3]*r[0],-i[4]*r[0]),a=1+i[1]+i[2]+i[3]+i[4],h=(r[0]+r[1]+r[2]+r[3])/a,u=(o[1]+o[2]+o[3]+o[4])/a;return{sigma:e,negative:t,a:i,b_causal:r,b_anticausal:o,sum_causal:h,sum_anticausal:u}}function Nue(e,t,i){const o=Float64Array.of(.84,1.8675,.84,-1.8675,-.34015,-.1299,-.34015,.1299),a=Math.exp(-1.783/i),h=Math.exp(-1.723/i),u=.6318/i,p=1.997/i,c=Float64Array.of(-a*Math.cos(u),a*Math.sin(u),-a*Math.cos(-u),a*Math.sin(-u),-h*Math.cos(p),h*Math.sin(p),-h*Math.cos(-p),h*Math.sin(-p)),f=i*2.5066282746310007,g=Float64Array.of(o[0],o[1],0,0,0,0,0,0),m=Float64Array.of(1,0,c[0],c[1],0,0,0,0,0,0);let v,A;for(A=2;A<8;A+=2){for(g[A]=c[A]*g[A-2]-c[A+1]*g[A-1],g[A+1]=c[A]*g[A-1]+c[A+1]*g[A-2],v=A-2;v>0;v-=2)g[v]+=c[A]*g[v-2]-c[A+1]*g[v-1],g[v+1]+=c[A]*g[v-1]+c[A+1]*g[v-2];for(v=0;v<=A;v+=2)g[v]+=o[A]*m[v]-o[A+1]*m[v+1],g[v+1]+=o[A]*m[v+1]+o[A+1]*m[v];for(m[A+2]=c[A]*m[A]-c[A+1]*m[A+1],m[A+3]=c[A]*m[A+1]+c[A+1]*m[A],v=A;v>0;v-=2)m[v]+=c[A]*m[v-2]-c[A+1]*m[v-1],m[v+1]+=c[A]*m[v-1]+c[A+1]*m[v-2]}for(A=0;A<4;++A)v=A<<1,t[A]=g[v]/f,e[A+1]=m[v+2]}function Oue(e,t,i,r=1,o=new Float64Array(i),a=new Float64Array(i),h=new Float64Array(5),u=o,p=Fue){const c=r*2,f=r*3,g=r*4,m=r*i;let v,A;for(p(o,t,i,r,e.b_causal,3,e.a,4,e.sum_causal,h,e.sigma),A=4,v=g;A<i;++A,v+=r)o[A]=e.b_causal[0]*t[v]+e.b_causal[1]*t[v-r]+e.b_causal[2]*t[v-c]+e.b_causal[3]*t[v-f]-e.a[1]*o[A-1]-e.a[2]*o[A-2]-e.a[3]*o[A-3]-e.a[4]*o[A-4];for(p(a,t,i,-r,e.b_anticausal,4,e.a,4,e.sum_anticausal,h,e.sigma),A=4,v=m-r*5;A<i;++A,v-=r)a[A]=e.b_anticausal[1]*t[v+r]+e.b_anticausal[2]*t[v+c]+e.b_anticausal[3]*t[v+f]+e.b_anticausal[4]*t[v+g]-e.a[1]*a[A-1]-e.a[2]*a[A-2]-e.a[3]*a[A-3]-e.a[4]*a[A-4];if(e.negative)for(A=0,v=0;A<i;++A,v+=r)u[v]=o[A]+a[i-A-1];else for(A=0,v=0;A<i;++A,v+=r)u[v]=Math.max(0,o[A]+a[i-A-1]);return u}function Fue(e,t,i,r,o,a,h,u,p,c,f,g=.5){const m=Math.abs(r)*i,v=r<0?m+r:0;let A,y,C;for(y=0;y<u;++y)for(c[y]=y<=a?o[y]:0,C=1;C<=u&&C<=y;++C)c[y]-=h[C]*c[y-C];for(C=0;C<u;++C)for(e[C]=0,y=1;y<=C;++y)A=v+r*y,A>=0&&A<m&&(e[C]+=c[C-y]*t[A]);const E=t[v],x=Math.ceil(f*10);for(y=0;y<x;++y){for(C=0;C<u;++C)e[C]+=c[C]*E;if(p-=Math.abs(c[0]),p<=g)break;for(c[u]=y+u<=a?o[y+u]:0,C=1;C<=u;++C)c[u]-=h[C]*c[u-C];for(C=0;C<u;++C)c[C]=c[C+1]}}function kue(e,t,i=0){const r=e.length;let o,a;for(let h=0;h<r;++h){const u=t(e[h],h,e);u!=null&&(o===void 0?u>=u&&(o=a=u):(u<o&&(o=u),u>a&&(a=u)))}return[o-i,a+i]}function Uue(e,t){const i=e.map(t).filter(c=>c!=null&&c>=c);i.sort((c,f)=>c-f);const r=Gue(i),o=b4(i,.25),a=b4(i,.75),h=i.length,u=(a-o)/1.34;return 1.06*(Math.min(r,u)||r||Math.abs(o)||1)*Math.pow(h,-.2)}function Gue(e){const t=e.length;let i=0,r,o=0,a=0;for(let h=0;h<t;++h){const u=e[h];r=u-o,o+=r/++i,a+=r*(u-o)}return i>1?Math.sqrt(a/(i-1)):NaN}function b4(e,t){const i=e.length;if(!i)return NaN;if((t=+t)<=0||i<2)return e[0];if(t>=1)return e[i-1];const r=(i-1)*t,o=Math.floor(r),a=e[o];return a+(e[o+1]-a)*(r-o)}function Wm(e,t={}){const{adjust:i=1,pad:r=3,bins:o=512}=t,a=g4(t.x,E=>E),h=g4(t.weight,()=>1/e.length);let u=t.bandwidth??i*Uue(e,a);const[p,c]=t.extent??kue(e,a,r*u),f=Due(e,a,h,p,c,o),g=(c-p)/(o-1),m=f.some(E=>E<0);let v=v4(u/g,m),A;function*y(E="x",x="y"){const M=C.grid(),w=1/g;for(let S=0;S<o;++S)yield{[E]:p+S*g,[x]:M[S]*w}}const C={[Symbol.iterator]:y,points:y,grid:()=>A||(A=Oue(v,f,o)),extent:()=>[p,c],bandwidth(E){return arguments.length?(E!==u&&(u=E,A=null,v=v4(u/g,m)),C):u}};return C}const Xs=["4:2","4:3","4:4","4:5","4:6","3:2","3:3","3:4","3:5","3:6","2:2","2:3","2:4","2:5","2:6"],io=[16,32,64,128,24,48,96,192],Vue=60,Que="4:3",Hue=96,zue=0,jue=0,Wue=!1,$ue=[0,.416,.787,1.166,1.502,1.820099999964237,2.16,2.448099999964237,2.751,3.069,3.449099999964237,3.749,4.069099999964237,4.415,4.7320999999642375,5.065,5.42,5.730099999964237,6.050099999964237,6.405,6.705,7.041099999964238,7.373,7.674,8.022099999964237,8.385,8.7,9.024099999964237,9.392,9.709,10.026,10.378,10.691099999964237,11.024099999964237,11.372099999964238,11.683099999964238,12.021099999964237,12.367099999964237,12.701099999964237,13.033099999964238,13.353099999964238,13.679,14.011099999964237,14.352099999964237,14.688099999964237,15.012099999964237,15.374099999964237,15.68,16.011,16.372,17.028,18.033099999964236,18.042099999964236,19.030099999964236,19.692,20.024,21.01809999996424,21.38109999996424,21.73609999996424,22.065099999964236,22.386,22.694099999964237,23.030099999964236,23.347,23.63109999996424,23.997,24.34909999996424,24.687,25.028099999964237,25.385,25.683,26.014099999964237,26.378,26.697099999964237,27.027099999964236,27.373099999964236,27.692,28.049099999964238,28.404,28.70709999996424,29.045,29.397099999964237,29.709099999964238,30.055,30.41609999996424,30.726,31.062099999964236,31.418099999964237,31.745099999964236],Xue="sub-division",Kue="2024-06-11T18:42:10.274Z",zw={tempo:Vue,grid:Que,binNote:Hue,adjustTime:zue,noteTickLimit:jue,showKde:Wue,noteOnTimes:$ue,_demoId:Xue,_date:Kue};function Yue(e){let t,i,r;return{c(){t=oe("button"),t.textContent="export",fe(t,"title","Export all data and settings")},m(o,a){Bt(o,t,a),i||(r=lt(t,"click",e[0]),i=!0)},p:gn,i:gn,o:gn,d(o){o&&It(t),i=!1,r()}}}function que(e,t,i){let{demoId:r}=t,{getExportData:o}=t;const a=()=>{const h=o();Lo(r,h)};return e.$$set=h=>{"demoId"in h&&i(1,r=h.demoId),"getExportData"in h&&i(2,o=h.getExportData)},[a,r,o]}class jw extends pi{constructor(t){super(),di(this,t,que,Yue,fi,{demoId:1,getExportData:2})}}function Jue(e){let t,i,r,o,a;return{c(){t=oe("button"),t.textContent="import",i=ge(),r=oe("input"),fe(t,"title","Import all data and settings"),fe(r,"type","file"),fe(r,"id","file-input"),cr(r,"display","none")},m(h,u){Bt(h,t,u),Bt(h,i,u),Bt(h,r,u),e[4](r),o||(a=[lt(t,"click",e[3]),lt(r,"input",e[1])],o=!0)},p:gn,i:gn,o:gn,d(h){h&&(It(t),It(i),It(r)),e[4](null),o=!1,ji(a)}}}function Zue(e,t,i){let{loadData:r}=t,o;const a=async p=>{const c=await Ro(p);r(c)},h=()=>o.click();function u(p){In[p?"unshift":"push"](()=>{o=p,i(0,o)})}return e.$$set=p=>{"loadData"in p&&i(2,r=p.loadData)},[o,a,r,h,u]}class Ww extends pi{constructor(t){super(),di(this,t,Zue,Jue,fi,{loadData:2})}}function ehe(e,t,i){const r=e.slice();return r[29]=t[i],r}function the(e,t,i){const r=e.slice();return r[29]=t[i],r}function nhe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[29]}`,t.__value=e[29],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function ihe(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[29]} note`,t.__value=e[29],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function rhe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W=e[7]?"area":"bars",V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te,rt,mt,vt,ft;function Ze(yt){e[15](yt)}let St={callback:e[11]};e[2]!==void 0&&(St.value=e[2]),c=new La({props:St}),In.push(()=>Yi(c,"value",Ze));let $t=fn(Xs),ct=[];for(let yt=0;yt<$t.length;yt+=1)ct[yt]=nhe(the(e,$t,yt));let Ct=fn(io),Tt=[];for(let yt=0;yt<Ct.length;yt+=1)Tt[yt]=ihe(ehe(e,Ct,yt));function At(yt){e[24](yt)}let pn={callback:e[23]};return e[8]!==void 0&&(pn.notes=e[8]),J=new qs({props:pn}),In.push(()=>Yi(J,"notes",At)),ue=new jw({props:{getExportData:e[12],demoId:e[0].id}}),Me=new Ww({props:{loadData:e[13]}}),Le=new bc({props:{tempo:e[2],accent:+e[3].split(":")[0]}}),je=new Sa({props:{key:" ",callback:e[26]}}),rt=new Nr({props:{noteOn:e[9],controlChange:e[10]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI instrument, choose your tempo and subdivision, and start
        playing. The bar chart will show you how often you hit each time bin and
        the last notes will be shown as ticks that fade out one new notes come
        in (from red for new to blue for old). You can play freely, use the
        integrated metronome, or play a song in the background (in another tab).
        All notes will be timed relative to the first one, but you can adjust
        all notes to make them earlier or later in case you messed up the first
        one.
        <i>Try playing without looking, focus on the metronome.</i>`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("label"),v=$e(`grid
            `),A=oe("select");for(let yt=0;yt<ct.length;yt+=1)ct[yt].c();y=ge(),C=oe("label"),E=$e(`binning
            `),x=oe("select");for(let yt=0;yt<Tt.length;yt+=1)Tt[yt].c();M=ge(),w=oe("label"),S=$e(`adjust
            `),I=oe("input"),L=ge(),R=oe("label"),k=$e(`note ticks
            `),P=oe("input"),F=ge(),O=oe("button"),V=$e(W),$=ge(),H=oe("div"),Y=oe("canvas"),Q=ge(),G=oe("div"),Ut(J.$$.fragment),se=ge(),Ut(ue.$$.fragment),he=ge(),Ut(Me.$$.fragment),de=ge(),Pe=oe("button"),Pe.textContent="example",Se=ge(),Ut(Le.$$.fragment),be=ge(),Ut(je.$$.fragment),Te=ge(),Ut(rt.$$.fragment),fe(h,"class","explanation"),e[3]===void 0&&yr(()=>e[16].call(A)),fe(m,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[4]===void 0&&yr(()=>e[17].call(x)),fe(C,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),fe(I,"type","number"),fe(I,"step","0.01"),fe(I,"min","-2"),fe(I,"max","2"),cr(I,"width","55px"),fe(w,"title","Shift all notes by an amount in seconds"),fe(P,"type","number"),fe(P,"step","1"),fe(P,"min","0"),fe(P,"max","100"),cr(P,"width","55px"),fe(R,"title","The number of most recent notes that are shown as ticks."),fe(O,"title","Toggle between bars and area"),fe(p,"class","control"),cr(Y,"width",mp+"px"),cr(Y,"height",U_+"px"),fe(H,"class","visualization"),fe(G,"class","control"),fe(t,"class","demo")},m(yt,kn){Bt(yt,t,kn),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),D(p,m),D(m,v),D(m,A);for(let qn=0;qn<ct.length;qn+=1)ct[qn]&&ct[qn].m(A,null);ci(A,e[3],!0),D(p,y),D(p,C),D(C,E),D(C,x);for(let qn=0;qn<Tt.length;qn+=1)Tt[qn]&&Tt[qn].m(x,null);ci(x,e[4],!0),D(p,M),D(p,w),D(w,S),D(w,I),ln(I,e[5]),D(p,L),D(p,R),D(R,k),D(R,P),ln(P,e[6]),D(p,F),D(p,O),D(O,V),D(t,$),D(t,H),D(H,Y),e[21](Y),D(t,Q),D(t,G),Ft(J,G,null),D(G,se),Ft(ue,G,null),D(G,he),Ft(Me,G,null),D(G,de),D(G,Pe),D(G,Se),Ft(Le,G,null),D(t,be),Ft(je,t,null),D(t,Te),Ft(rt,t,null),mt=!0,vt||(ft=[lt(A,"change",e[16]),lt(A,"change",e[11]),lt(x,"change",e[17]),lt(x,"change",e[11]),lt(I,"input",e[18]),lt(I,"change",e[11]),lt(P,"input",e[19]),lt(P,"change",e[11]),lt(O,"click",e[20]),lt(H,"touchstart",e[22],{passive:!0}),lt(Pe,"click",e[25])],vt=!0)},p(yt,kn){(!mt||kn[0]&1)&&r!==(r=yt[0].title+"")&&jt(o,r);const qn={};!f&&kn[0]&4&&(f=!0,qn.value=yt[2],Ki(()=>f=!1)),c.$set(qn),kn[0]&8&&ci(A,yt[3]),kn[0]&16&&ci(x,yt[4]),kn[0]&32&&Yn(I.value)!==yt[5]&&ln(I,yt[5]),kn[0]&64&&Yn(P.value)!==yt[6]&&ln(P,yt[6]),(!mt||kn[0]&128)&&W!==(W=yt[7]?"area":"bars")&&jt(V,W);const Gt={};!K&&kn[0]&256&&(K=!0,Gt.notes=yt[8],Ki(()=>K=!1)),J.$set(Gt);const bt={};kn[0]&1&&(bt.demoId=yt[0].id),ue.$set(bt);const ye={};kn[0]&4&&(ye.tempo=yt[2]),kn[0]&8&&(ye.accent=+yt[3].split(":")[0]),Le.$set(ye)},i(yt){mt||(Nt(c.$$.fragment,yt),Nt(J.$$.fragment,yt),Nt(ue.$$.fragment,yt),Nt(Me.$$.fragment,yt),Nt(Le.$$.fragment,yt),Nt(je.$$.fragment,yt),Nt(rt.$$.fragment,yt),mt=!0)},o(yt){Ot(c.$$.fragment,yt),Ot(J.$$.fragment,yt),Ot(ue.$$.fragment,yt),Ot(Me.$$.fragment,yt),Ot(Le.$$.fragment,yt),Ot(je.$$.fragment,yt),Ot(rt.$$.fragment,yt),mt=!1},d(yt){yt&&It(t),kt(c),ti(ct,yt),ti(Tt,yt),e[21](null),kt(J),kt(ue),kt(Me),kt(Le),kt(je),kt(rt),vt=!1,ji(ft)}}}let mp=1e3,U_=1e3;function she(e,t,i){let{demoInfo:r}=t;const o=Math.PI*2;let a,h=120,u=Xs[0],p=64,c=0,f=1,g=!1,m=0,v=[];const A=H=>{v.length===0&&(m=H.timestamp);const Y=(H.timestamp-m)/1e3;v.push(Y),C()},y=H=>{const Y=H.controller.number;Y===14?i(2,h=Jr(H.rawValue,0,120)+60):Y===15?i(3,u=Xs[Jr(Math.floor(H.rawValue/5),0,Xs.length-1)]):Y===16?i(4,p=io[Jr(Math.floor(H.rawValue/5),0,io.length-1)]):Y===17?i(5,c=(Jr(H.rawValue,0,100)-50)/100):Y===18&&i(6,f=Math.round(Jr(H.rawValue*2,0,200))),C()},C=()=>{const H=mp/2,Y=U_/2,Q=mp*.4,G=Q*.8,J=Q*.9,K=Q*1.1,se=Q*.95,ue=Math.PI/2,he=a.getContext("2d"),Me=window.devicePixelRatio,de=a.getBoundingClientRect();i(1,a.width=de.width*Me,a),i(1,a.height=de.height*Me,a),he.scale(Me,Me),i(1,a.style.width=`${de.width}px`,a),i(1,a.style.height=`${de.height}px`,a),he.clearRect(0,0,mp,U_);const[Pe,Se]=u.split(":").map(ft=>+ft),Le=xs(h)*Pe,be=v.map(ft=>ft+c),Te=be.map(ft=>ft%Le).map(ft=>ft/Le*o),rt=mp*.08;if(!g){const ft=p*Pe/4;he.fillStyle="#f8f8f8",he.strokeStyle="#aaa";const St=Q4().domain([0,o]).thresholds(Mn(ft).map(ct=>ct/ft*o))(Te),$t=Zr(St,ct=>ct.length);for(const ct of St){if(ct.length===0)continue;const Ct=ct.length/$t*rt,Tt=Q+Ct,At=ct.x0-ue,pn=Math.cos(At),yt=Math.sin(At),kn=ct.x1-ue,qn=Math.cos(kn),Gt=Math.sin(kn);he.beginPath(),he.moveTo(H+pn*Q,Y+yt*Q),he.lineTo(H+pn*Tt,Y+yt*Tt),he.arc(H,Y,Tt,At,kn),he.lineTo(H+qn*Q,Y+Gt*Q),he.closePath(),he.fill(),he.stroke()}}if(g&&Te.length>0){let ft=4/p;const ct=Wm(Te,{bandwidth:ft,pad:0,bins:360}).bandwidth(ft),Ct=Zr([...ct],Tt=>Tt.y);he.beginPath();for(const Tt of ct){const At=Tt.x-ue,pn=Q+Tt.y/Ct*rt,yt=Math.cos(At),kn=Math.sin(At);he.lineTo(H+yt*pn,Y+kn*pn)}he.closePath(),he.fillStyle="#e4f0fa",he.fill(),he.strokeStyle="#aaa",he.stroke()}if(f>0){he.lineWidth=3;const ft=St=>uE(1-St),Ze=be.slice(-f);for(const[St,$t]of Ze.entries()){const ct=$t/Le*o-ue,Ct=Math.cos(ct),Tt=Math.sin(ct);he.strokeStyle=ft(St/Ze.length),he.beginPath(),he.moveTo(H+Ct*Q,Y+Tt*Q),he.lineTo(H+Ct*K,Y+Tt*K),he.stroke()}}he.strokeStyle="#aaa",he.fillStyle="white",B_(he,H,Y,Q),he.lineWidth=2,he.fill(),he.stroke();const mt=Mn(Pe).map(ft=>o/Pe*ft-ue),vt=Mn(Pe*Se).map(ft=>o/(Pe*Se)*ft-ue);he.beginPath(),he.lineWidth=2;for(const ft of mt){const Ze=Math.cos(ft),St=Math.sin(ft);he.moveTo(H+Ze*G,Y+St*G),he.lineTo(H+Ze*se,Y+St*se)}he.stroke(),he.lineWidth=1,he.beginPath();for(const ft of vt){const Ze=Math.cos(ft),St=Math.sin(ft);he.moveTo(H+Ze*J,Y+St*J),he.lineTo(H+Ze*se,Y+St*se)}he.stroke()},E=()=>({tempo:h,grid:u,binNote:p,adjustTime:c,noteTickLimit:f,showKde:g,noteOnTimes:v}),x=H=>{(v.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(i(2,h=H.tempo),i(3,u=H.grid),i(4,p=H.binNote),i(5,c=H.adjustTime),i(6,f=H.noteTickLimit??0),i(8,v=H.noteOnTimes),i(7,g=H.showKde??!1),C())},M=()=>{AE(r.id,E())};tr(C),Io(M);function w(H){h=H,i(2,h)}function S(){u=Dr(this),i(3,u)}function I(){p=Dr(this),i(4,p)}function L(){c=Yn(this.value),i(5,c)}function R(){f=Yn(this.value),i(6,f)}const k=()=>{i(7,g=!g),C()};function P(H){In[H?"unshift":"push"](()=>{a=H,i(1,a)})}const F=()=>A({timestamp:performance.now()}),O=()=>{M(),C()};function W(H){v=H,i(8,v)}const V=()=>x(zw),$=()=>A({timestamp:performance.now()});return e.$$set=H=>{"demoInfo"in H&&i(0,r=H.demoInfo)},[r,a,h,u,p,c,f,g,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$]}class ohe extends pi{constructor(t){super(),di(this,t,she,rhe,fi,{demoInfo:0},null,[-1,-1])}}function ahe(e,t,i){const r=e.slice();return r[25]=t[i],r}function lhe(e,t,i){const r=e.slice();return r[25]=t[i],r}function che(e){let t;return{c(){t=oe("option"),t.textContent=`${e[25]}`,t.__value=e[25],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function uhe(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[25]} note`,t.__value=e[25],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function hhe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k=e[6]?"area":"bars",P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te;function rt(Ct){e[14](Ct)}let mt={callback:e[10]};e[2]!==void 0&&(mt.value=e[2]),c=new La({props:mt}),In.push(()=>Yi(c,"value",rt));let vt=fn(Xs),ft=[];for(let Ct=0;Ct<vt.length;Ct+=1)ft[Ct]=che(lhe(e,vt,Ct));let Ze=fn(io),St=[];for(let Ct=0;Ct<Ze.length;Ct+=1)St[Ct]=uhe(ahe(e,Ze,Ct));function $t(Ct){e[20](Ct)}let ct={callback:e[10]};return e[7]!==void 0&&(ct.notes=e[7]),H=new qs({props:ct}),In.push(()=>Yi(H,"notes",$t)),G=new $o({props:{exportFunction:e[11]}}),K=new Xo({props:{importFunction:e[12]}}),Me=new bc({props:{tempo:e[2],accent:+e[3].split(":")[0]}}),Pe=new Sa({props:{key:" ",callback:e[22]}}),Le=new Nr({props:{noteOn:e[8],controlChange:e[9]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI instrument, choose your tempo and subdivision, and start
        playing. The bar chart will show you how often you hit each time bin and
        the notes will be shown as ticks, one layer per bar. You can play
        freely, use the integrated metronome, or play a song in the background
        (in another tab). Light gray wedges show if you stayed within on bin
        size of your defined timing grid. All notes will be timed relative to
        the first one, but you can adjust all notes to make them earlier or
        later in case you messed up the first one.
        <i>Try playing without looking, focus on the metronome.</i>`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("label"),v=$e(`grid
            `),A=oe("select");for(let Ct=0;Ct<ft.length;Ct+=1)ft[Ct].c();y=ge(),C=oe("label"),E=$e(`binning
            `),x=oe("select");for(let Ct=0;Ct<St.length;Ct+=1)St[Ct].c();M=ge(),w=oe("label"),S=$e(`adjust
            `),I=oe("input"),L=ge(),R=oe("button"),P=$e(k),F=ge(),O=oe("div"),W=oe("canvas"),V=ge(),$=oe("div"),Ut(H.$$.fragment),Q=ge(),Ut(G.$$.fragment),J=ge(),Ut(K.$$.fragment),se=ge(),ue=oe("button"),ue.textContent="example",he=ge(),Ut(Me.$$.fragment),de=ge(),Ut(Pe.$$.fragment),Se=ge(),Ut(Le.$$.fragment),fe(h,"class","explanation"),e[3]===void 0&&yr(()=>e[15].call(A)),fe(m,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[4]===void 0&&yr(()=>e[16].call(x)),fe(C,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),fe(I,"type","number"),fe(I,"step","0.01"),fe(I,"min","-2"),fe(I,"max","2"),cr(I,"width","55px"),fe(w,"title","Shift all notes by an amount in seconds"),fe(R,"title","Toggle between bars and area"),fe(p,"class","control"),cr(W,"width",of+"px"),cr(W,"height",G_+"px"),fe(O,"class","visualization"),fe($,"class","control"),fe(t,"class","demo")},m(Ct,Tt){Bt(Ct,t,Tt),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),D(p,m),D(m,v),D(m,A);for(let At=0;At<ft.length;At+=1)ft[At]&&ft[At].m(A,null);ci(A,e[3],!0),D(p,y),D(p,C),D(C,E),D(C,x);for(let At=0;At<St.length;At+=1)St[At]&&St[At].m(x,null);ci(x,e[4],!0),D(p,M),D(p,w),D(w,S),D(w,I),ln(I,e[5]),D(p,L),D(p,R),D(R,P),D(t,F),D(t,O),D(O,W),e[19](W),D(t,V),D(t,$),Ft(H,$,null),D($,Q),Ft(G,$,null),D($,J),Ft(K,$,null),D($,se),D($,ue),D($,he),Ft(Me,$,null),D(t,de),Ft(Pe,t,null),D(t,Se),Ft(Le,t,null),be=!0,je||(Te=[lt(A,"change",e[15]),lt(A,"change",e[10]),lt(x,"change",e[16]),lt(x,"change",e[10]),lt(I,"input",e[17]),lt(I,"change",e[10]),lt(R,"click",e[18]),lt(ue,"click",e[21])],je=!0)},p(Ct,[Tt]){(!be||Tt&1)&&r!==(r=Ct[0].title+"")&&jt(o,r);const At={};!f&&Tt&4&&(f=!0,At.value=Ct[2],Ki(()=>f=!1)),c.$set(At),Tt&8&&ci(A,Ct[3]),Tt&16&&ci(x,Ct[4]),Tt&32&&Yn(I.value)!==Ct[5]&&ln(I,Ct[5]),(!be||Tt&64)&&k!==(k=Ct[6]?"area":"bars")&&jt(P,k);const pn={};!Y&&Tt&128&&(Y=!0,pn.notes=Ct[7],Ki(()=>Y=!1)),H.$set(pn);const yt={};Tt&4&&(yt.tempo=Ct[2]),Tt&8&&(yt.accent=+Ct[3].split(":")[0]),Me.$set(yt)},i(Ct){be||(Nt(c.$$.fragment,Ct),Nt(H.$$.fragment,Ct),Nt(G.$$.fragment,Ct),Nt(K.$$.fragment,Ct),Nt(Me.$$.fragment,Ct),Nt(Pe.$$.fragment,Ct),Nt(Le.$$.fragment,Ct),be=!0)},o(Ct){Ot(c.$$.fragment,Ct),Ot(H.$$.fragment,Ct),Ot(G.$$.fragment,Ct),Ot(K.$$.fragment,Ct),Ot(Me.$$.fragment,Ct),Ot(Pe.$$.fragment,Ct),Ot(Le.$$.fragment,Ct),be=!1},d(Ct){Ct&&It(t),kt(c),ti(ft,Ct),ti(St,Ct),e[19](null),kt(H),kt(G),kt(K),kt(Me),kt(Pe),kt(Le),je=!1,ji(Te)}}}let of=1e3,G_=1e3;function fhe(e,t,i){let{demoInfo:r}=t;const o=Math.PI*2;let a,h=120,u=Xs[0],p=64,c=0,f=!1,g=0,m=[];const v=O=>{m.length===0&&(g=O.timestamp);const W=(O.timestamp-g)/1e3;m.push(W),y()},A=O=>{const W=O.controller.number;W===14?i(2,h=Jr(O.rawValue,0,120)+60):W===15?i(3,u=Xs[Jr(Math.floor(O.rawValue/5),0,Xs.length-1)]):W===16?i(4,p=io[Jr(Math.floor(O.rawValue/5),0,io.length-1)]):W===17&&i(5,c=(Jr(O.rawValue,0,100)-50)/100),y()},y=()=>{const O=of/2,W=G_/2,V=of*.2,$=V*.8,H=V*.9,Y=V*.95,Q=Math.PI/2,G=a.getContext("2d"),J=window.devicePixelRatio,K=a.getBoundingClientRect();i(1,a.width=K.width*J,a),i(1,a.height=K.height*J,a),G.scale(J,J),i(1,a.style.width=`${K.width}px`,a),i(1,a.style.height=`${K.height}px`,a),G.clearRect(0,0,of,G_);const[se,ue]=u.split(":").map(vt=>+vt),he=xs(h)*se,Me=m.map(vt=>vt+c),Pe=Me.map(vt=>vt%he).map(vt=>vt/he*o),Se=V*.2,Le=p*se/4;G.fillStyle="#f8f8f8";const be=o/Le,je=Mn(se*ue).map(vt=>o/(se*ue)*vt-Q),Te=of/2-10;for(const vt of je){const ft=Math.cos(vt-be),Ze=Math.sin(vt-be),St=Math.cos(vt+be),$t=Math.sin(vt+be);G.moveTo(O,W),G.lineTo(O+ft*Te,W+Ze*Te),G.lineTo(O+St*Te,W+$t*Te),G.closePath()}if(G.fill(),!f){G.fillStyle="#f8f8f8",G.strokeStyle="#aaa";const ft=Q4().domain([0,o]).thresholds(Mn(Le).map(St=>St/Le*o))(Pe),Ze=Zr(ft,St=>St.length);for(const St of ft){if(St.length===0)continue;const $t=St.length/Ze*Se,ct=V+$t,Ct=St.x0-Q,Tt=Math.cos(Ct),At=Math.sin(Ct),pn=St.x1-Q,yt=Math.cos(pn),kn=Math.sin(pn);G.beginPath(),G.moveTo(O+Tt*V,W+At*V),G.lineTo(O+Tt*ct,W+At*ct),G.arc(O,W,ct,Ct,pn),G.lineTo(O+yt*V,W+kn*V),G.closePath(),G.fill(),G.stroke()}}if(f&&Pe.length>0){let vt=4/p;const $t=Wm(Pe,{bandwidth:vt,pad:.1,bins:360}).bandwidth(vt),ct=Zr([...$t],Ct=>Ct.y);G.beginPath();for(const Ct of $t){const Tt=Ct.x-Q,At=V+Ct.y/ct*Se,pn=Math.cos(Tt),yt=Math.sin(Tt);G.lineTo(O+pn*At,W+yt*At)}G.closePath(),G.fillStyle="#e4f0fa",G.fill(),G.strokeStyle="#aaa",G.stroke()}if(Me.length>0){G.lineWidth=2,G.strokeStyle="#888";const vt=Me,ft=Math.floor(Me.at(-1)/he)+1,Ze=(of/2-V-Se-10)/ft;for(const[St,$t]of vt.entries()){const ct=$t/he*o-Q,Ct=Math.cos(ct),Tt=Math.sin(ct),At=Math.floor($t/he),pn=V+Se+At*Ze+5,yt=pn+Ze;G.beginPath(),G.moveTo(O+Ct*pn,W+Tt*pn),G.lineTo(O+Ct*yt,W+Tt*yt),G.stroke()}G.lineWidth=1,G.strokeStyle="#eee";for(let St=0;St<ft;St++){const $t=V+Se+St*Ze+5;B_(G,O,W,$t)}}G.strokeStyle="#aaa",G.fillStyle="white",B_(G,O,W,V),G.lineWidth=2,G.fill(),G.stroke();const rt=Mn(se).map(vt=>o/se*vt-Q),mt=Mn(se*ue).map(vt=>o/(se*ue)*vt-Q);G.beginPath(),G.lineWidth=2;for(const vt of rt){const ft=Math.cos(vt),Ze=Math.sin(vt);G.moveTo(O+ft*$,W+Ze*$),G.lineTo(O+ft*Y,W+Ze*Y)}G.stroke(),G.lineWidth=1,G.beginPath();for(const vt of mt){const ft=Math.cos(vt),Ze=Math.sin(vt);G.moveTo(O+ft*H,W+Ze*H),G.lineTo(O+ft*Y,W+Ze*Y)}G.stroke()},C=()=>{const O={tempo:h,grid:u,binNote:p,adjustTime:c,showKde:f,noteOnTimes:m};Lo(r.id,O)},E=async O=>{if(m.length===0||confirm("Import data and overwrite currently unsaved data?")){const W=await Ro(O);x(W)}},x=O=>{i(2,h=O.tempo),i(3,u=O.grid),i(4,p=O.binNote),i(5,c=O.adjustTime),i(7,m=O.noteOnTimes),i(6,f=O.showKde??!1),y()};tr(y);function M(O){h=O,i(2,h)}function w(){u=Dr(this),i(3,u)}function S(){p=Dr(this),i(4,p)}function I(){c=Yn(this.value),i(5,c)}const L=()=>{i(6,f=!f),y()};function R(O){In[O?"unshift":"push"](()=>{a=O,i(1,a)})}function k(O){m=O,i(7,m)}const P=()=>x(zw),F=()=>v({timestamp:performance.now()});return e.$$set=O=>{"demoInfo"in O&&i(0,r=O.demoInfo)},[r,a,h,u,p,c,f,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F]}class dhe extends pi{constructor(t){super(),di(this,t,fhe,hhe,fi,{demoInfo:0})}}function phe(e,t,i){const r=e.slice();return r[25]=t[i],r}function mhe(e,t,i){const r=e.slice();return r[25]=t[i],r}function Ahe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[25]}`,t.__value=e[25],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function ghe(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[25]} note`,t.__value=e[25],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function vhe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je;function Te(ct){e[14](ct)}let rt={callback:e[10]};e[2]!==void 0&&(rt.value=e[2]),c=new La({props:rt}),In.push(()=>Yi(c,"value",Te));let mt=fn(Xs),vt=[];for(let ct=0;ct<mt.length;ct+=1)vt[ct]=Ahe(mhe(e,mt,ct));let ft=fn(io),Ze=[];for(let ct=0;ct<ft.length;ct+=1)Ze[ct]=ghe(phe(e,ft,ct));function St(ct){e[21](ct)}let $t={callback:e[20]};return e[7]!==void 0&&($t.notes=e[7]),$=new qs({props:$t}),In.push(()=>Yi($,"notes",St)),Q=new jw({props:{getExportData:e[11],demoId:e[0].id}}),J=new Ww({props:{loadData:e[12]}}),he=new bc({props:{tempo:e[2],accent:+e[3].split(":")[0]}}),de=new Sa({props:{key:" ",callback:e[23]}}),Se=new Nr({props:{noteOn:e[8],controlChange:e[9]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI instrument, choose your tempo and subdivision, and start
        playing. The bar chart will show you how often you hit each time bin and
        the last notes will be shown as ticks that fade out one new notes come
        in (from red for new to blue for old). You can play freely, use the
        integrated metronome, or play a song in the background (in another tab).
        All notes will be timed relative to the first one, but you can adjust
        all notes to make them earlier or later in case you messed up the first
        one.
        <i>Try playing without looking, focus on the metronome.</i>`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("label"),v=$e(`grid
            `),A=oe("select");for(let ct=0;ct<vt.length;ct+=1)vt[ct].c();y=ge(),C=oe("label"),E=$e(`binning
            `),x=oe("select");for(let ct=0;ct<Ze.length;ct+=1)Ze[ct].c();M=ge(),w=oe("label"),S=$e(`adjust
            `),I=oe("input"),L=ge(),R=oe("label"),k=$e(`note ticks
            `),P=oe("input"),F=ge(),O=oe("div"),W=ge(),V=oe("div"),Ut($.$$.fragment),Y=ge(),Ut(Q.$$.fragment),G=ge(),Ut(J.$$.fragment),K=ge(),se=oe("button"),se.textContent="example",ue=ge(),Ut(he.$$.fragment),Me=ge(),Ut(de.$$.fragment),Pe=ge(),Ut(Se.$$.fragment),fe(h,"class","explanation"),e[3]===void 0&&yr(()=>e[15].call(A)),fe(m,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[4]===void 0&&yr(()=>e[16].call(x)),fe(C,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),fe(I,"type","number"),fe(I,"step","0.01"),fe(I,"min","-2"),fe(I,"max","2"),cr(I,"width","55px"),fe(w,"title","Shift all notes by an amount in seconds"),fe(P,"type","number"),fe(P,"step","1"),fe(P,"min","0"),fe(P,"max","100"),cr(P,"width","55px"),fe(R,"title","The number of most recent notes that are shown as ticks."),fe(p,"class","control"),fe(O,"class","visualization"),fe(V,"class","control"),fe(t,"class","demo")},m(ct,Ct){Bt(ct,t,Ct),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),D(p,m),D(m,v),D(m,A);for(let Tt=0;Tt<vt.length;Tt+=1)vt[Tt]&&vt[Tt].m(A,null);ci(A,e[3],!0),D(p,y),D(p,C),D(C,E),D(C,x);for(let Tt=0;Tt<Ze.length;Tt+=1)Ze[Tt]&&Ze[Tt].m(x,null);ci(x,e[4],!0),D(p,M),D(p,w),D(w,S),D(w,I),ln(I,e[5]),D(p,L),D(p,R),D(R,k),D(R,P),ln(P,e[6]),D(t,F),D(t,O),e[19](O),D(t,W),D(t,V),Ft($,V,null),D(V,Y),Ft(Q,V,null),D(V,G),Ft(J,V,null),D(V,K),D(V,se),D(V,ue),Ft(he,V,null),D(t,Me),Ft(de,t,null),D(t,Pe),Ft(Se,t,null),Le=!0,be||(je=[lt(A,"change",e[15]),lt(A,"change",e[10]),lt(x,"change",e[16]),lt(x,"change",e[10]),lt(I,"input",e[17]),lt(I,"change",e[10]),lt(P,"input",e[18]),lt(P,"change",e[10]),lt(se,"click",e[22])],be=!0)},p(ct,[Ct]){(!Le||Ct&1)&&r!==(r=ct[0].title+"")&&jt(o,r);const Tt={};!f&&Ct&4&&(f=!0,Tt.value=ct[2],Ki(()=>f=!1)),c.$set(Tt),Ct&8&&ci(A,ct[3]),Ct&16&&ci(x,ct[4]),Ct&32&&Yn(I.value)!==ct[5]&&ln(I,ct[5]),Ct&64&&Yn(P.value)!==ct[6]&&ln(P,ct[6]);const At={};!H&&Ct&128&&(H=!0,At.notes=ct[7],Ki(()=>H=!1)),$.$set(At);const pn={};Ct&1&&(pn.demoId=ct[0].id),Q.$set(pn);const yt={};Ct&4&&(yt.tempo=ct[2]),Ct&8&&(yt.accent=+ct[3].split(":")[0]),he.$set(yt)},i(ct){Le||(Nt(c.$$.fragment,ct),Nt($.$$.fragment,ct),Nt(Q.$$.fragment,ct),Nt(J.$$.fragment,ct),Nt(he.$$.fragment,ct),Nt(de.$$.fragment,ct),Nt(Se.$$.fragment,ct),Le=!0)},o(ct){Ot(c.$$.fragment,ct),Ot($.$$.fragment,ct),Ot(Q.$$.fragment,ct),Ot(J.$$.fragment,ct),Ot(he.$$.fragment,ct),Ot(de.$$.fragment,ct),Ot(Se.$$.fragment,ct),Le=!1},d(ct){ct&&It(t),kt(c),ti(vt,ct),ti(Ze,ct),e[19](null),kt($),kt(Q),kt(J),kt(he),kt(de),kt(Se),be=!1,ji(je)}}}let y4=1e3;function bhe(e,t,i){let{demoInfo:r}=t,o,a=120,h=Xs[0],u=64,p=0,c=100,f=0,g=[];const m=O=>{g.length===0&&(f=O.timestamp);const W=(O.timestamp-f)/1e3;g.push(W),A()},v=O=>{const W=O.controller.number;W===14?i(2,a=Jr(O.rawValue,0,120)+60):W===15?i(3,h=Xs[Jr(Math.floor(O.rawValue/5),0,Xs.length-1)]):W===16?i(4,u=io[Jr(Math.floor(O.rawValue/5),0,io.length-1)]):W===17?i(5,p=(Jr(O.rawValue,0,100)-50)/100):W===18&&i(6,c=Math.round(Jr(O.rawValue*2,0,200))),A()},A=()=>{const[O,W]=h.split(":").map(de=>+de),V=xs(a),H=g.map(de=>(de+p)/V).map(de=>de%O);let Y=[];if(H.length>0){let de=4/u,Pe=1,Se=y4/2;Y=Wm(H,{bandwidth:de,pad:Pe,bins:Se}).bandwidth(de)}let Q=[];c>0&&(Q=H.slice(-c));const G=Mn(0,O+1,1),J=Mn(0,O,1/W),K=[Xa(J,{stroke:"#888"}),Xa(G,{stroke:"#888",strokeWidth:3})],se={width:y4,height:90,marginLeft:60,marginBottom:10,padding:0,x:{label:null,domain:[0,O],ticks:[]},y:{axis:!1}},ue=Ji({...se,marks:[gw(H,ev({y:"count"},{x:de=>de,fill:"#ccc",thresholds:Mn(0,O+1,4/u)})),hs([0]),...K]}),he=Ji({...se,marks:[mw(Y,{x:"x",y:"y",fill:de=>"#e4f0fa",clip:!0}),hs([0]),...K]}),Me=Ji({...se,marginBottom:30,x:{ticks:[...J,O],label:"time in beats",domain:[0,O]},color:{scheme:"viridis",reverse:!0,domain:[0,Q.length]},marks:[Xa(Q,{x:de=>de,stroke:(de,Pe)=>Pe,clip:!0})]});i(1,o.textContent="",o),o.appendChild(ue),o.appendChild(he),o.appendChild(Me)},y=()=>({tempo:a,grid:h,binNote:u,adjustTime:p,noteTickLimit:c,noteOnTimes:g}),C=O=>{(g.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(i(2,a=O.tempo),i(3,h=O.grid),i(4,u=O.binNote),i(5,p=O.adjustTime),i(6,c=O.noteTickLimit??0),i(7,g=O.noteOnTimes),A())},E=()=>{AE(r.id,y())};tr(A),Io(E);function x(O){a=O,i(2,a)}function M(){h=Dr(this),i(3,h)}function w(){u=Dr(this),i(4,u)}function S(){p=Yn(this.value),i(5,p)}function I(){c=Yn(this.value),i(6,c)}function L(O){In[O?"unshift":"push"](()=>{o=O,i(1,o)})}const R=()=>{E(),A()};function k(O){g=O,i(7,g)}const P=()=>C(zw),F=()=>m({timestamp:performance.now()});return e.$$set=O=>{"demoInfo"in O&&i(0,r=O.demoInfo)},[r,o,a,h,u,p,c,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F]}class yhe extends pi{constructor(t){super(),di(this,t,bhe,vhe,fi,{demoInfo:0})}}const _he=120,Ehe=128,whe=0,Che=100,xhe=[0,.461,.995,1.495,2.0089000000357626,2.524,3.047,3.542,4.074,4.57,5.085,5.618,6.1349000000357625,6.635,7.13,7.64,8.178,8.686,9.194,9.706,10.198900000035763,10.683900000035763,11.186900000035763,11.69,12.166,12.646,13.155900000035762,13.669,14.194,14.7,15.209900000035763,15.743900000035763,16.257,16.790900000035762,17.311,17.823900000035763,18.35,18.866900000035763,19.401900000035763,19.901,20.416900000035763,20.92090000003576,21.441,21.928,22.464,22.965,23.49690000003576,24.01,24.519,25.023900000035763,25.58990000003576,26.111,26.634900000035763,27.154,27.671,28.181,28.675,29.174,29.674,30.141,30.64790000003576,31.142,31.628900000035763,32.141,32.68,33.17590000003576,33.688,34.198],Mhe="tempo-drift",She="2024-06-11T18:59:54.533Z",The={tempo:_he,binNote:Ehe,filterNote:whe,barLimit:Che,noteOnTimes:xhe,_demoId:Mhe,_date:She};function Ihe(e,t,i){const r=e.slice();return r[24]=t[i],r}function Bhe(e,t,i){const r=e.slice();return r[24]=t[i],r}function Rhe(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[24]} note`,t.__value=e[24],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Lhe(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[24]} note`,t.__value=e[24],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function _4(e){let t,i,r=e[7].toFixed(1)+"",o,a;return{c(){t=oe("div"),i=$e("estimated: "),o=$e(r),a=$e(" bpm"),fe(t,"class","svelte-1ruiyqw")},m(h,u){Bt(h,t,u),D(t,i),D(t,o),D(t,a)},p(h,u){u&128&&r!==(r=h[7].toFixed(1)+"")&&jt(o,r)},d(h){h&&It(t)}}}function Phe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te,rt,mt,vt,ft=fn(io),Ze=[];for(let At=0;At<ft.length;At+=1)Ze[At]=Rhe(Bhe(e,ft,At));let St=fn(io),$t=[];for(let At=0;At<St.length;At+=1)$t[At]=Lhe(Ihe(e,St,At));let ct=e[7]&&_4(e);function Ct(At){e[20](At)}let Tt={callback:e[19]};return e[6]!==void 0&&(Tt.notes=e[6]),G=new qs({props:Tt}),In.push(()=>Yi(G,"notes",Ct)),se=new jw({props:{getExportData:e[10],demoId:e[0].id}}),he=new Ww({props:{loadData:e[11]}}),Se=new bc({props:{tempo:e[2],accent:4,maxBeeps:8}}),be=new Sa({props:{key:" ",callback:e[22]}}),Te=new Nr({props:{noteOn:e[8]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI instrument, choose your tempo, and start playing. The
        time between two note onsets will be shown as a bar, so you can see how
        well you still hit, for example, quarter notes after playing for some
        time. Bar heights are either exact or rounded to the closest, for
        example, 64th note (binning dropdown). You can filter very short
        inter-note times, which happen whan playing two notes at roughly the
        same time as in a chord.
        <i>Try playing without looking!</i>`,u=ge(),p=oe("p"),p.textContent=`One possible exercise is trying to play at a given tempo without any
        count in. You can use the randomize tempo button () to get challenged.`,c=ge(),f=oe("div"),g=oe("label"),m=$e(`tempo
            `),v=oe("input"),A=ge(),y=oe("button"),y.textContent="",C=ge(),E=oe("label"),x=$e(`binning
            `),M=oe("select"),w=oe("option"),w.textContent="off";for(let At=0;At<Ze.length;At+=1)Ze[At].c();S=ge(),I=oe("label"),L=$e(`filtering
            `),R=oe("select"),k=oe("option"),k.textContent="off";for(let At=0;At<$t.length;At+=1)$t[At].c();P=ge(),F=oe("label"),O=$e(`bars
            `),W=oe("input"),V=ge(),$=oe("div"),H=ge(),ct&&ct.c(),Y=ge(),Q=oe("div"),Ut(G.$$.fragment),K=ge(),Ut(se.$$.fragment),ue=ge(),Ut(he.$$.fragment),Me=ge(),de=oe("button"),de.textContent="example",Pe=ge(),Ut(Se.$$.fragment),Le=ge(),Ut(be.$$.fragment),je=ge(),Ut(Te.$$.fragment),fe(h,"class","explanation"),fe(p,"class","explanation"),fe(v,"type","number"),fe(v,"step","1"),fe(v,"min","10"),fe(v,"max","400"),cr(v,"width","55px"),fe(g,"title","The tempo in beats per minute (bpm)"),fe(y,"title","randomize tempo"),w.__value=0,ln(w,w.__value),e[3]===void 0&&yr(()=>e[15].call(M)),fe(E,"title","You can change between seeing exact bar heights and binned (rounded) heights."),k.__value=0,ln(k,k.__value),e[4]===void 0&&yr(()=>e[16].call(R)),fe(I,"title","You can filter out notes that are shorter than a given note duration."),fe(W,"type","number"),fe(W,"step","25"),fe(W,"min","25"),fe(W,"max","1000"),cr(W,"width","55px"),fe(F,"title","The number of most recent notes that are shown as bars."),fe(f,"class","control svelte-1ruiyqw"),fe($,"class","visualization svelte-1ruiyqw"),fe(Q,"class","control svelte-1ruiyqw"),fe(t,"class","demo")},m(At,pn){Bt(At,t,pn),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),D(t,c),D(t,f),D(f,g),D(g,m),D(g,v),ln(v,e[2]),D(f,A),D(f,y),D(f,C),D(f,E),D(E,x),D(E,M),D(M,w);for(let yt=0;yt<Ze.length;yt+=1)Ze[yt]&&Ze[yt].m(M,null);ci(M,e[3],!0),D(f,S),D(f,I),D(I,L),D(I,R),D(R,k);for(let yt=0;yt<$t.length;yt+=1)$t[yt]&&$t[yt].m(R,null);ci(R,e[4],!0),D(f,P),D(f,F),D(F,O),D(F,W),ln(W,e[5]),D(t,V),D(t,$),e[18]($),D(t,H),ct&&ct.m(t,null),D(t,Y),D(t,Q),Ft(G,Q,null),D(Q,K),Ft(se,Q,null),D(Q,ue),Ft(he,Q,null),D(Q,Me),D(Q,de),D(Q,Pe),Ft(Se,Q,null),D(t,Le),Ft(be,t,null),D(t,je),Ft(Te,t,null),rt=!0,mt||(vt=[lt(v,"input",e[13]),lt(v,"change",e[9]),lt(y,"click",e[14]),lt(M,"change",e[15]),lt(M,"change",e[9]),lt(R,"change",e[16]),lt(R,"change",e[9]),lt(W,"input",e[17]),lt(W,"change",e[9]),lt(de,"click",e[21])],mt=!0)},p(At,[pn]){(!rt||pn&1)&&r!==(r=At[0].title+"")&&jt(o,r),pn&4&&Yn(v.value)!==At[2]&&ln(v,At[2]),pn&8&&ci(M,At[3]),pn&16&&ci(R,At[4]),pn&32&&Yn(W.value)!==At[5]&&ln(W,At[5]),At[7]?ct?ct.p(At,pn):(ct=_4(At),ct.c(),ct.m(t,Y)):ct&&(ct.d(1),ct=null);const yt={};!J&&pn&64&&(J=!0,yt.notes=At[6],Ki(()=>J=!1)),G.$set(yt);const kn={};pn&1&&(kn.demoId=At[0].id),se.$set(kn);const qn={};pn&4&&(qn.tempo=At[2]),Se.$set(qn)},i(At){rt||(Nt(G.$$.fragment,At),Nt(se.$$.fragment,At),Nt(he.$$.fragment,At),Nt(Se.$$.fragment,At),Nt(be.$$.fragment,At),Nt(Te.$$.fragment,At),rt=!0)},o(At){Ot(G.$$.fragment,At),Ot(se.$$.fragment,At),Ot(he.$$.fragment,At),Ot(Se.$$.fragment,At),Ot(be.$$.fragment,At),Ot(Te.$$.fragment,At),rt=!1},d(At){At&&It(t),ti(Ze,At),ti($t,At),e[18](null),ct&&ct.d(),kt(G),kt(se),kt(he),kt(Se),kt(be),kt(Te),mt=!1,ji(vt)}}}let Dhe=1e3,Nhe=750;function Ohe(e,t,i){let{demoInfo:r}=t,o,a=120,h=64,u=0,p=50,c=0,f=[],g=0;const m=F=>{f.length===0&&(c=F.timestamp);const O=(F.timestamp-c)/1e3;f.push(O),v()},v=()=>{const F=xs(a),O=F/4,W=F/2,V=F*2,$=F*4,Y=[0,F/3,O,W,W*1.5,F,F*1.5,V,V*1.5],Q=["0","","","",".","",".","","."];let G=f.map((ue,he)=>he===0?0:ue-f[he-1]);if(u!==0){const ue=$/u;G=G.filter(he=>he>=ue)}let J=G;if(h!==0){const ue=$/h;J=G.map(he=>Math.round(he/ue)*ue)}const K=Ji({width:Dhe,height:Nhe,marginLeft:45,marginRight:1,x:{axis:!1},y:{ticks:Y,tickFormat:ue=>{const he=Y.indexOf(ue);return Q[he]},domain:[0,V*1.1],tickSize:0},marks:[Wf(J.slice(-p),{x:(ue,he)=>he,y:ue=>ue,fill:"#ddd",inset:0,dx:.5}),hs(Y,{stroke:"#aaa"})]});i(1,o.textContent="",o),o.appendChild(K);const se=G.filter(ue=>ue>.8*O&&ue<1.25*F).slice(-24).map(ue=>ue<.6*F?ue*2:ue>1.5*F?ue/2:ue);i(7,g=j$(W4(se)))},A=()=>({tempo:a,binNote:h,filterNote:u,barLimit:p,noteOnTimes:f}),y=F=>{(f.length===0||confirm("Import data and overwrite currently unsaved data?"))&&(i(2,a=F.tempo),i(3,h=F.binNote??"off"),i(4,u=F.filterNote??"off"),i(5,p=F.barLimit),i(6,f=F.noteOnTimes),v())},C=()=>{AE(r.id,A())};tr(v),Io(C);function E(){a=Yn(this.value),i(2,a)}const x=()=>{let F=a;for(;F===a;)F=Math.round(Math.random()*24+12)*5;i(2,a=F)};function M(){h=Dr(this),i(3,h)}function w(){u=Dr(this),i(4,u)}function S(){p=Yn(this.value),i(5,p)}function I(F){In[F?"unshift":"push"](()=>{o=F,i(1,o)})}const L=()=>{C(),v()};function R(F){f=F,i(6,f)}const k=()=>y(The),P=()=>m({timestamp:performance.now()});return e.$$set=F=>{"demoInfo"in F&&i(0,r=F.demoInfo)},[r,o,a,h,u,p,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P]}class Fhe extends pi{constructor(t){super(),di(this,t,Ohe,Phe,fi,{demoInfo:0})}}var Qc,wf,sm,Hc,zc,om,tc,Cf,ju,dl,nc,Wu,Ha,xf,pl,ic;class khe{constructor(){Ir(this,Qc,null);Ir(this,wf,null);Ir(this,sm,1);Ir(this,Hc,null);Ir(this,zc,!1);Ir(this,om,!1);pr(this,"currentPlayTime",null);Ir(this,tc,new AudioContext);Ir(this,Cf,null);Ir(this,ju,null);Ir(this,dl,0);Ir(this,nc,-1);Ir(this,Wu,[]);Ir(this,Ha,[]);Ir(this,xf,null);Ir(this,pl,!1);Ir(this,ic,!1);pr(this,"onTimeChange",t=>(mr(this,Qc,t),this));pr(this,"onStop",t=>(mr(this,wf,t),this));pr(this,"setVolume",t=>(mr(this,sm,t),this));pr(this,"setLogging",t=>(mr(this,om,t),this));pr(this,"isPlaying",()=>wn(this,pl));pr(this,"isPaused",()=>wn(this,ic));pr(this,"playNotes",(t,i=0,r=-1,o=1,a=!1)=>{if(wn(this,pl)&&!wn(this,ic)&&!wn(this,zc)&&this.stop(),!t||t.length===0){console.warn("[PLAYER] Was called with no data");return}mr(this,Wu,[...t]);let h=new df(t).sortByTime();mr(this,xf,h.getDuration()),i>0&&(h=h.filter(u=>u.start>=i).shiftTime(-i),console.log(`[Player] Will start at ${i.toFixed(2)} seconds with ${h.length()} notes left`)),o!==1&&o>0&&(h=h.scaleTime(1/o),mr(this,xf,wn(this,xf)/o)),t=h.getNotes(),console.log(`[Player] Playing ${t.length} notes, speed ${o}, and volume ${wn(this,sm)}`),wn(this,tc).state==="suspended"&&wn(this,tc).resume(),mr(this,dl,i),mr(this,nc,r),mr(this,Hc,o),mr(this,zc,a),mr(this,Ha,[...t]),this._start()});pr(this,"_start",()=>{console.log("[Player] Starting"),mr(this,pl,!0),mr(this,ic,!1),mr(this,ju,wn(this,tc).currentTime),this._scheduler()});pr(this,"_updateTime",t=>{const i=(t-wn(this,ju))*wn(this,Hc)+wn(this,dl);this.currentPlayTime=i,wn(this,Qc)&&wn(this,Qc).call(this,i)});pr(this,"_playNote",(t,i)=>{const r=t.getDuration();wn(this,om)&&console.log(`[Player] Playing ${t.getName()} for ${r}s`);const o=wn(this,tc).createOscillator();o.connect(wn(this,tc).destination);const a=$f[t.pitch].frequency;o.frequency.value=a,o.start(i),o.stop(i+r)});pr(this,"_scheduler",()=>{const r=wn(this,tc).currentTime;this._updateTime(r);const o=(wn(this,nc)-wn(this,dl))/wn(this,Hc)+wn(this,dl);for(;wn(this,Ha).length>0;){const h=wn(this,ju)+wn(this,Ha)[0].start;if(h>r+.1||wn(this,nc)!==-1&&wn(this,Ha)[0].start+wn(this,dl)>=o)break;const u=wn(this,Ha).shift();this._playNote(u,h)}const a=r-wn(this,ju)+wn(this,dl);wn(this,nc)!==-1&&a>=o?this._stopOrLoop():a>=wn(this,xf)?this._stopOrLoop():mr(this,Cf,setTimeout(this._scheduler,33))});pr(this,"_stopOrLoop",()=>{wn(this,zc)?this.playNotes(wn(this,Wu),wn(this,dl),wn(this,nc),wn(this,Hc),wn(this,zc)):this.stop()});pr(this,"stop",(t=!0)=>{if(wn(this,pl))return console.log("[Player] Stopping player"),clearTimeout(wn(this,Cf)),this.currentPlayTime=null,mr(this,pl,!1),mr(this,ic,!1),mr(this,Wu,[]),mr(this,Ha,[]),wn(this,Qc)&&wn(this,Qc).call(this,null),t&&wn(this,wf)&&wn(this,wf).call(this),this});pr(this,"pause",()=>(console.log("[Player] Pausing player"),clearTimeout(wn(this,Cf)),mr(this,ic,!0),this));pr(this,"resume",()=>{if(console.log("[Player] Resuming player"),!wn(this,Ha)||wn(this,Ha).length===0){console.warn("[Player] Cannot resume player since it has not been started!");return}return this.playNotes(wn(this,Wu),this.currentPlayTime,wn(this,nc),wn(this,Hc),wn(this,zc)),this});pr(this,"pauseOrResume",()=>{if(!wn(this,pl)){console.warn("[Player] Cannot pause / resume when player is not playing!");return}return wn(this,ic)?this.resume():this.pause(),this})}toggle(t,i=0,r=-1,o=1,a=!1){wn(this,pl)?this.stop():this.playNotes(t,i,r,o,a)}}Qc=new WeakMap,wf=new WeakMap,sm=new WeakMap,Hc=new WeakMap,zc=new WeakMap,om=new WeakMap,tc=new WeakMap,Cf=new WeakMap,ju=new WeakMap,dl=new WeakMap,nc=new WeakMap,Wu=new WeakMap,Ha=new WeakMap,xf=new WeakMap,pl=new WeakMap,ic=new WeakMap;function Uhe(e){let t,i,r;return{c(){t=oe("button"),t.textContent="play rhythm",fe(t,"title","Play the current rhythm grid")},m(o,a){Bt(o,t,a),i||(r=lt(t,"click",e[7]),i=!0)},p:gn,i:gn,o:gn,d(o){o&&It(t),i=!1,r()}}}function Ghe(e,t,i){let r,{notes:o=[]}=t,{startAt:a=0}=t,{endAt:h=-1}=t,{speed:u=1}=t,{loop:p=!1}=t;const c=new khe;Io(()=>{c.stop()});const f=()=>{console.log(r),c.toggle(r,a,h,u,p)};return e.$$set=g=>{"notes"in g&&i(6,o=g.notes),"startAt"in g&&i(0,a=g.startAt),"endAt"in g&&i(1,h=g.endAt),"speed"in g&&i(2,u=g.speed),"loop"in g&&i(3,p=g.loop)},e.$$.update=()=>{e.$$.dirty&64&&i(4,r=o.map(g=>({pitch:g.number,start:g.time,duration:g.duration??.075,velocity:127})))},[a,h,u,p,r,c,o,f]}class Vhe extends pi{constructor(t){super(),di(this,t,Ghe,Uhe,fi,{notes:6,startAt:0,endAt:1,speed:2,loop:3})}}function Qhe(e,t,i){const r=e.slice();return r[31]=t[i],r}function Hhe(e,t,i){const r=e.slice();return r[31]=t[i],r}function zhe(e,t,i){const r=e.slice();return r[31]=t[i],r}function jhe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[31]}`,t.__value=e[31],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Whe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[31]}`,t.__value=e[31],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function $he(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[31]} note`,t.__value=e[31],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function Xhe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y=e[8]?"density area":"histogram",Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te,rt,mt,vt,ft,Ze,St,$t,ct,Ct,Tt,At;function pn(Ce){e[17](Ce)}let yt={callback:e[13]};e[3]!==void 0&&(yt.value=e[3]),c=new La({props:yt}),In.push(()=>Yi(c,"value",pn));let kn=fn(Xs),qn=[];for(let Ce=0;Ce<kn.length;Ce+=1)qn[Ce]=jhe(zhe(e,kn,Ce));let Gt=fn(Xs),bt=[];for(let Ce=0;Ce<Gt.length;Ce+=1)bt[Ce]=Whe(Hhe(e,Gt,Ce));let ye=fn(io),_e=[];for(let Ce=0;Ce<ye.length;Ce+=1)_e[Ce]=$he(Qhe(e,ye,Ce));function Ue(Ce){e[26](Ce)}let Re={callback:e[13]};return e[10]!==void 0&&(Re.notes=e[10]),Me=new qs({props:Re}),In.push(()=>Yi(Me,"notes",Ue)),Se=new $o({props:{exportFunction:e[14]}}),be=new Xo({props:{importFunction:e[15]}}),Te=new bc({props:{tempo:e[3],accent:+e[4].split(":")[0]}}),mt=new Vhe({props:{notes:e[16](e[4],e[5],e[3])}}),ft=new Sa({props:{key:"f",callback:e[27]}}),St=new Sa({props:{key:"j",callback:e[28]}}),ct=new Nr({props:{noteOn:e[11],controlChange:e[12]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI keyboard and start playing to the metronome. The chart
        will show you how a summary of where your notes started, the top one is
        for your left hand (keys left of the middle A) and the bottom one for
        your right hand. For example, you can try to play quarter triplets with
        your left and eighths with your right hand. If you do not have a MIDI
        keyboard, you can press the
        <code class="svelte-dje2r7">f</code>
        key on your PC keyboard for left and <code class="svelte-dje2r7">j</code> for right.
        <i>Try playing without looking, focus on the metronome.</i>`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("label"),v=$e(`grid (left)
            `),A=oe("select");for(let Ce=0;Ce<qn.length;Ce+=1)qn[Ce].c();y=ge(),C=oe("label"),E=$e(`grid (right)
            `),x=oe("select");for(let Ce=0;Ce<bt.length;Ce+=1)bt[Ce].c();M=ge(),w=oe("label"),S=$e(`binning
            `),I=oe("select");for(let Ce=0;Ce<_e.length;Ce+=1)_e[Ce].c();L=ge(),R=oe("label"),k=$e(`adjust
            `),P=oe("input"),F=ge(),O=oe("label"),W=$e(`last bars
            `),V=oe("input"),$=ge(),H=oe("button"),Q=$e(Y),G=ge(),J=oe("div"),K=ge(),se=oe("div"),ue=ge(),he=oe("div"),Ut(Me.$$.fragment),Pe=ge(),Ut(Se.$$.fragment),Le=ge(),Ut(be.$$.fragment),je=ge(),Ut(Te.$$.fragment),rt=ge(),Ut(mt.$$.fragment),vt=ge(),Ut(ft.$$.fragment),Ze=ge(),Ut(St.$$.fragment),$t=ge(),Ut(ct.$$.fragment),fe(h,"class","explanation"),e[4]===void 0&&yr(()=>e[18].call(A)),fe(m,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[5]===void 0&&yr(()=>e[19].call(x)),fe(C,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[6]===void 0&&yr(()=>e[20].call(I)),fe(w,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),fe(P,"type","number"),fe(P,"step","0.01"),fe(P,"min","-2"),fe(P,"max","2"),cr(P,"width","55px"),fe(R,"title","Shift all notes by an amount in seconds"),fe(V,"type","number"),fe(V,"min","1"),fe(V,"max","100"),cr(V,"width","55px"),fe(O,"title","The number of past bars to be shown. Allows to 'forget' mistakes in the beginning."),fe(H,"title","Toggle between an area chart and a histogram of the note density"),cr(H,"width","120px"),fe(p,"class","control"),fe(J,"class","visualization"),fe(se,"class","visualization"),fe(he,"class","control"),fe(t,"class","demo")},m(Ce,Ne){Bt(Ce,t,Ne),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),D(p,m),D(m,v),D(m,A);for(let le=0;le<qn.length;le+=1)qn[le]&&qn[le].m(A,null);ci(A,e[4],!0),D(p,y),D(p,C),D(C,E),D(C,x);for(let le=0;le<bt.length;le+=1)bt[le]&&bt[le].m(x,null);ci(x,e[5],!0),D(p,M),D(p,w),D(w,S),D(w,I);for(let le=0;le<_e.length;le+=1)_e[le]&&_e[le].m(I,null);ci(I,e[6],!0),D(p,L),D(p,R),D(R,k),D(R,P),ln(P,e[7]),D(p,F),D(p,O),D(O,W),D(O,V),ln(V,e[9]),D(p,$),D(p,H),D(H,Q),D(t,G),D(t,J),e[24](J),D(t,K),D(t,se),e[25](se),D(t,ue),D(t,he),Ft(Me,he,null),D(he,Pe),Ft(Se,he,null),D(he,Le),Ft(be,he,null),D(he,je),Ft(Te,he,null),D(he,rt),Ft(mt,he,null),D(t,vt),Ft(ft,t,null),D(t,Ze),Ft(St,t,null),D(t,$t),Ft(ct,t,null),Ct=!0,Tt||(At=[lt(A,"change",e[18]),lt(A,"change",e[13]),lt(x,"change",e[19]),lt(x,"change",e[13]),lt(I,"change",e[20]),lt(I,"change",e[13]),lt(P,"input",e[21]),lt(P,"change",e[13]),lt(V,"input",e[22]),lt(V,"change",e[13]),lt(H,"click",e[23])],Tt=!0)},p(Ce,Ne){(!Ct||Ne[0]&1)&&r!==(r=Ce[0].title+"")&&jt(o,r);const le={};!f&&Ne[0]&8&&(f=!0,le.value=Ce[3],Ki(()=>f=!1)),c.$set(le),Ne[0]&16&&ci(A,Ce[4]),Ne[0]&32&&ci(x,Ce[5]),Ne[0]&64&&ci(I,Ce[6]),Ne[0]&128&&Yn(P.value)!==Ce[7]&&ln(P,Ce[7]),Ne[0]&512&&Yn(V.value)!==Ce[9]&&ln(V,Ce[9]),(!Ct||Ne[0]&256)&&Y!==(Y=Ce[8]?"density area":"histogram")&&jt(Q,Y);const j={};!de&&Ne[0]&1024&&(de=!0,j.notes=Ce[10],Ki(()=>de=!1)),Me.$set(j);const Z={};Ne[0]&8&&(Z.tempo=Ce[3]),Ne[0]&16&&(Z.accent=+Ce[4].split(":")[0]),Te.$set(Z);const pe={};Ne[0]&56&&(pe.notes=Ce[16](Ce[4],Ce[5],Ce[3])),mt.$set(pe)},i(Ce){Ct||(Nt(c.$$.fragment,Ce),Nt(Me.$$.fragment,Ce),Nt(Se.$$.fragment,Ce),Nt(be.$$.fragment,Ce),Nt(Te.$$.fragment,Ce),Nt(mt.$$.fragment,Ce),Nt(ft.$$.fragment,Ce),Nt(St.$$.fragment,Ce),Nt(ct.$$.fragment,Ce),Ct=!0)},o(Ce){Ot(c.$$.fragment,Ce),Ot(Me.$$.fragment,Ce),Ot(Se.$$.fragment,Ce),Ot(be.$$.fragment,Ce),Ot(Te.$$.fragment,Ce),Ot(mt.$$.fragment,Ce),Ot(ft.$$.fragment,Ce),Ot(St.$$.fragment,Ce),Ot(ct.$$.fragment,Ce),Ct=!1},d(Ce){Ce&&It(t),kt(c),ti(qn,Ce),ti(bt,Ce),ti(_e,Ce),e[24](null),e[25](null),kt(Me),kt(Se),kt(be),kt(Te),kt(mt),kt(ft),kt(St),kt(ct),Tt=!1,ji(At)}}}let E4=1e3,w4=69;function Khe(e,t,i){let{demoInfo:r}=t,o,a,h=60,u=Xs[1],p=Xs[0],c=64,f=0,g=!0,m=4,v=0,A=[];const y=Q=>{A.length===0&&(v=Q.timestamp);const G=(Q.timestamp-v)/1e3;A.push({time:G,number:Q.note.number}),x()},C=Q=>{const G=Q.controller.number;G===14?i(3,h=Jr(Q.rawValue,0,120)+60):G===15?i(6,c=io[Jr(Math.floor(Q.rawValue/5),0,io.length-1)]):G===16?i(7,f=(Jr(Q.rawValue,0,100)-50)/100):G===17&&i(9,m=Jr(Q.rawValue,0,99)+1),x()},E=(Q=!0)=>{const G=Q?u:p,[J,K]=G.split(":").map(Le=>+Le),se=xs(h);let ue=A.filter(Le=>Q&&Le.number<w4||!Q&&Le.number>=w4);if(ue=ue.map(Le=>(Le.time+f)/se),m>0&&ue.length>0){const Le=Math.floor(ue.at(-1)/J);ue=ue.filter(be=>be/J>=Le-m)}ue=ue.map(Le=>Le%J);let he=[];if(ue.length>0){let Le=4/c,be=1,je=E4/2;he=Wm(ue,{bandwidth:Le,pad:be,bins:je}).bandwidth(Le)}const Me=Mn(0,J+1,1),de=Mn(0,J*K,1/K),Pe=Ji({width:E4,height:Q?90:105,marginLeft:60,marginBottom:Q?0:15,padding:0,x:{label:Q?null:"time in beats",domain:[0,4],ticks:[]},y:{axis:!1,reverse:!Q},marks:[g?mw(he,{x:"x",y:"y",fill:Le=>"#e4f0fa",clip:!0}):gw(ue,ev({y:"count"},{x:Le=>Le,fill:"#ccc",thresholds:Mn(0,J+1,4/c)})),hs([0]),Xa(de,{stroke:"#888"}),Xa(Me,{stroke:"#888",strokeWidth:3})]}),Se=Q?o:a;Se.textContent="",Se.appendChild(Pe)},x=()=>{E(!0),E(!1)},M=()=>{const Q={tempo:h,gridLeft:u,gridRight:p,binNote:c,adjustTime:f,pastBars:m,noteOnTimes:A};Lo(r.id,Q)},w=async Q=>{if(A.length===0||confirm("Import data and overwrite currently unsaved data?")){const G=await Ro(Q);i(3,h=G.tempo),i(4,u=G.gridLeft),i(5,p=G.gridRight),i(6,c=G.binNote),i(7,f=G.adjustTime??0),i(9,m=G.pastBars),i(10,A=G.noteOnTimes),x()}};tr(x);const S=(Q,G,J)=>{if(!Q)return[];const K=xs(J);let se=[Q,G].flatMap((ue,he)=>{const[Me,de]=ue.split(":").map(Se=>+Se),Pe=Mn(0,Me,1/de);return console.log({grid1:Me,grid2:de,fineGrid:Pe}),Pe.map(Se=>({time:Se*K,number:69}))});return se.sort((ue,he)=>ue.time-he.time),console.log(se),se};function I(Q){h=Q,i(3,h)}function L(){u=Dr(this),i(4,u)}function R(){p=Dr(this),i(5,p)}function k(){c=Dr(this),i(6,c)}function P(){f=Yn(this.value),i(7,f)}function F(){m=Yn(this.value),i(9,m)}const O=()=>{i(8,g=!g),x()};function W(Q){In[Q?"unshift":"push"](()=>{o=Q,i(1,o)})}function V(Q){In[Q?"unshift":"push"](()=>{a=Q,i(2,a)})}function $(Q){A=Q,i(10,A)}const H=()=>y({timestamp:performance.now(),note:{number:0}}),Y=()=>y({timestamp:performance.now(),note:{number:127}});return e.$$set=Q=>{"demoInfo"in Q&&i(0,r=Q.demoInfo)},[r,o,a,h,u,p,c,f,g,m,A,y,C,x,M,w,S,I,L,R,k,P,F,O,W,V,$,H,Y]}class Yhe extends pi{constructor(t){super(),di(this,t,Khe,Xhe,fi,{demoInfo:0},null,[-1,-1])}}function qhe(e,t,i){const r=e.slice();return r[29]=t[i],r}function Jhe(e,t,i){const r=e.slice();return r[29]=t[i],r}function Zhe(e){let t;return{c(){t=oe("option"),t.textContent=`${e[29]}`,t.__value=e[29],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function efe(e){let t;return{c(){t=oe("option"),t.textContent=`1/${e[29]} note`,t.__value=e[29],ln(t,t.__value)},m(i,r){Bt(i,t,r)},p:gn,d(i){i&&It(t)}}}function tfe(e){let t,i,r=e[0].title+"",o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O,W=e[6]?"density area":"histogram",V,$,H,Y,Q,G,J,K,se,ue,he,Me,de,Pe,Se,Le,be,je,Te,rt,mt,vt,ft,Ze,St,$t;function ct(Gt){e[15](Gt)}let Ct={callback:e[11]};e[2]!==void 0&&(Ct.value=e[2]),c=new La({props:Ct}),In.push(()=>Yi(c,"value",ct));let Tt=fn(Xs),At=[];for(let Gt=0;Gt<Tt.length;Gt+=1)At[Gt]=Zhe(Jhe(e,Tt,Gt));let pn=fn(io),yt=[];for(let Gt=0;Gt<pn.length;Gt+=1)yt[Gt]=efe(qhe(e,pn,Gt));function kn(Gt){e[22](Gt)}let qn={callback:e[11]};return e[8]!==void 0&&(qn.notes=e[8]),G=new qs({props:qn}),In.push(()=>Yi(G,"notes",kn)),se=new $o({props:{exportFunction:e[12]}}),he=new Xo({props:{importFunction:e[13]}}),de=new bc({props:{tempo:e[2],accent:+e[3].split(":")[0]}}),Se=new Sa({props:{key:"s",callback:e[23]}}),be=new Sa({props:{key:"h",callback:e[24]}}),Te=new Sa({props:{key:"t",callback:e[25]}}),mt=new Sa({props:{key:"k",callback:e[26]}}),ft=new Nr({props:{noteOn:e[9],controlChange:e[10]}}),{c(){t=oe("main"),i=oe("h2"),o=$e(r),a=ge(),h=oe("p"),h.innerHTML=`Connect a MIDI drum kit and start playing to the metronome. The chart
        will show you how a summary of where your notes started, one for each
        type of drum. If you do not have a MIDI keyboard, you can press keys:
        <code class="svelte-dje2r7">h</code>, <code class="svelte-dje2r7">s</code>, <code class="svelte-dje2r7">t</code>, and <code class="svelte-dje2r7">k</code> for
        hi-hat, snare, tom, and kick drum.
        <i>Try playing without looking, focus on the metronome.</i>`,u=ge(),p=oe("div"),Ut(c.$$.fragment),g=ge(),m=oe("label"),v=$e(`grid
            `),A=oe("select");for(let Gt=0;Gt<At.length;Gt+=1)At[Gt].c();y=ge(),C=oe("label"),E=$e(`binning
            `),x=oe("select");for(let Gt=0;Gt<yt.length;Gt+=1)yt[Gt].c();M=ge(),w=oe("label"),S=$e(`adjust
            `),I=oe("input"),L=ge(),R=oe("label"),k=$e(`last bars
            `),P=oe("input"),F=ge(),O=oe("button"),V=$e(W),$=ge(),H=oe("div"),Y=ge(),Q=oe("div"),Ut(G.$$.fragment),K=ge(),Ut(se.$$.fragment),ue=ge(),Ut(he.$$.fragment),Me=ge(),Ut(de.$$.fragment),Pe=ge(),Ut(Se.$$.fragment),Le=ge(),Ut(be.$$.fragment),je=ge(),Ut(Te.$$.fragment),rt=ge(),Ut(mt.$$.fragment),vt=ge(),Ut(ft.$$.fragment),fe(h,"class","explanation"),e[3]===void 0&&yr(()=>e[16].call(A)),fe(m,"title","The whole circle is one bar, you can choose to divide it by 3 or 4 quarter notes and then further sub-divide it into, for example, triplets"),e[4]===void 0&&yr(()=>e[17].call(x)),fe(C,"title","The width of each bar in rhythmic units. For example, each bin could be a 32nd note wide."),fe(I,"type","number"),fe(I,"step","0.01"),fe(I,"min","-2"),fe(I,"max","2"),cr(I,"width","55px"),fe(w,"title","Shift all notes by an amount in seconds"),fe(P,"type","number"),fe(P,"min","1"),fe(P,"max","100"),cr(P,"width","55px"),fe(R,"title","The number of past bars to be shown. Allows to 'forget' mistakes in the beginning."),fe(O,"title","Toggle between an area chart and a histogram of the note density"),cr(O,"width","120px"),fe(p,"class","control"),fe(H,"class","visualization"),fe(Q,"class","control"),fe(t,"class","demo")},m(Gt,bt){Bt(Gt,t,bt),D(t,i),D(i,o),D(t,a),D(t,h),D(t,u),D(t,p),Ft(c,p,null),D(p,g),D(p,m),D(m,v),D(m,A);for(let ye=0;ye<At.length;ye+=1)At[ye]&&At[ye].m(A,null);ci(A,e[3],!0),D(p,y),D(p,C),D(C,E),D(C,x);for(let ye=0;ye<yt.length;ye+=1)yt[ye]&&yt[ye].m(x,null);ci(x,e[4],!0),D(p,M),D(p,w),D(w,S),D(w,I),ln(I,e[5]),D(p,L),D(p,R),D(R,k),D(R,P),ln(P,e[7]),D(p,F),D(p,O),D(O,V),D(t,$),D(t,H),e[21](H),D(t,Y),D(t,Q),Ft(G,Q,null),D(Q,K),Ft(se,Q,null),D(Q,ue),Ft(he,Q,null),D(Q,Me),Ft(de,Q,null),D(t,Pe),Ft(Se,t,null),D(t,Le),Ft(be,t,null),D(t,je),Ft(Te,t,null),D(t,rt),Ft(mt,t,null),D(t,vt),Ft(ft,t,null),Ze=!0,St||($t=[lt(A,"change",e[16]),lt(A,"change",e[11]),lt(x,"change",e[17]),lt(x,"change",e[11]),lt(I,"input",e[18]),lt(I,"change",e[11]),lt(P,"input",e[19]),lt(P,"change",e[11]),lt(O,"click",e[20])],St=!0)},p(Gt,bt){(!Ze||bt[0]&1)&&r!==(r=Gt[0].title+"")&&jt(o,r);const ye={};!f&&bt[0]&4&&(f=!0,ye.value=Gt[2],Ki(()=>f=!1)),c.$set(ye),bt[0]&8&&ci(A,Gt[3]),bt[0]&16&&ci(x,Gt[4]),bt[0]&32&&Yn(I.value)!==Gt[5]&&ln(I,Gt[5]),bt[0]&128&&Yn(P.value)!==Gt[7]&&ln(P,Gt[7]),(!Ze||bt[0]&64)&&W!==(W=Gt[6]?"density area":"histogram")&&jt(V,W);const _e={};!J&&bt[0]&256&&(J=!0,_e.notes=Gt[8],Ki(()=>J=!1)),G.$set(_e);const Ue={};bt[0]&4&&(Ue.tempo=Gt[2]),bt[0]&8&&(Ue.accent=+Gt[3].split(":")[0]),de.$set(Ue)},i(Gt){Ze||(Nt(c.$$.fragment,Gt),Nt(G.$$.fragment,Gt),Nt(se.$$.fragment,Gt),Nt(he.$$.fragment,Gt),Nt(de.$$.fragment,Gt),Nt(Se.$$.fragment,Gt),Nt(be.$$.fragment,Gt),Nt(Te.$$.fragment,Gt),Nt(mt.$$.fragment,Gt),Nt(ft.$$.fragment,Gt),Ze=!0)},o(Gt){Ot(c.$$.fragment,Gt),Ot(G.$$.fragment,Gt),Ot(se.$$.fragment,Gt),Ot(he.$$.fragment,Gt),Ot(de.$$.fragment,Gt),Ot(Se.$$.fragment,Gt),Ot(be.$$.fragment,Gt),Ot(Te.$$.fragment,Gt),Ot(mt.$$.fragment,Gt),Ot(ft.$$.fragment,Gt),Ze=!1},d(Gt){Gt&&It(t),kt(c),ti(At,Gt),ti(yt,Gt),e[21](null),kt(G),kt(se),kt(he),kt(de),kt(Se),kt(be),kt(Te),kt(mt),kt(ft),St=!1,ji($t)}}}let C4=1e3;function nfe(e,t,i){let{demoInfo:r}=t,o,a=60,h=Xs[0],u=64,p=0,c=!0,f=4,g=0,m=[];const v=new Map([[49,{repPitch:49,label:"CC",name:"Crash Cymbal 1"}],[55,{repPitch:49,label:"CC",name:"Crash Cymbal 1"}],[52,{repPitch:57,label:"CC",name:"Crash Cymbal 2"}],[57,{repPitch:57,label:"CC",name:"Crash Cymbal 2"}],[22,{repPitch:46,label:"HH",name:"Hi-Hat"}],[26,{repPitch:46,label:"HH",name:"Hi-Hat"}],[42,{repPitch:46,label:"HH",name:"Hi-Hat"}],[46,{repPitch:46,label:"HH",name:"Hi-Hat"}],[44,{repPitch:44,label:"HH",name:"Hi-Hat Pedal"}],[51,{repPitch:51,label:"Rd",name:"Ride Cymbal"}],[53,{repPitch:51,label:"Rd",name:"Ride Cymbal"}],[59,{repPitch:51,label:"Rd",name:"Ride Cymbal"}],[38,{repPitch:38,label:"SN",name:"Snare"}],[40,{repPitch:38,label:"SN",name:"Snare"}],[48,{repPitch:48,label:"TO",name:"Tom 1"}],[50,{repPitch:48,label:"TO",name:"Tom 1"}],[45,{repPitch:45,label:"TO",name:"Tom 2"}],[47,{repPitch:45,label:"TO",name:"Tom 2"}],[43,{repPitch:43,label:"TO",name:"Stand Tom 1"}],[58,{repPitch:43,label:"TO",name:"Stand Tom 1"}],[39,{repPitch:41,label:"TO",name:"Stand Tom 2"}],[41,{repPitch:41,label:"TO",name:"Stand Tom 2"}],[35,{repPitch:36,label:"KD",name:"Kick Drum"}],[36,{repPitch:36,label:"KD",name:"Kick Drum"}]]),A=H=>{var Q;m.length===0&&(g=H.timestamp);const Y=(H.timestamp-g)/1e3;m.push({time:Y,number:H.note.number,drum:((Q=v.get(H.note.number))==null?void 0:Q.label)??H.note.number}),E()},y=H=>{const Y=H.controller.number;Y===14?i(2,a=Jr(H.rawValue,0,120)+60):Y===15?i(4,u=io[Jr(Math.floor(H.rawValue/5),0,io.length-1)]):Y===16?i(5,p=(Jr(H.rawValue,0,100)-50)/100):Y===17&&i(7,f=Jr(H.rawValue,0,99)+1),E()},C=(H="KD",Y=null)=>{const[Q,G]=h.split(":").map(Pe=>+Pe),J=xs(a);let K=m.filter(Pe=>Pe.drum===H);if(K=K.map(Pe=>(Pe.time+p)/J),f>0&&K.length>0){const Pe=Math.floor(K.at(-1)/Q);K=K.filter(Se=>Se/Q>=Pe-f)}K=K.map(Pe=>Pe%Q);let se=[];if(K.length>0){let Pe=4/u,Se=1,Le=C4/2;se=Wm(K,{bandwidth:Pe,pad:Se,bins:Le}).bandwidth(Pe)}const ue=Mn(0,Q+1,1),he=Mn(0,Q,1/G),Me=Ji({width:C4,height:90,marginLeft:60,marginBottom:10,padding:0,x:{label:Y,domain:[0,4],ticks:[]},y:{axis:!1},marks:[c?mw(se,{x:"x",y:"y",fill:Pe=>"#e4f0fa",clip:!0}):gw(K,ev({y:"count"},{x:Pe=>Pe,fill:"#ccc",thresholds:Mn(0,Q+1,4/u)})),hs([0]),Xa(he,{stroke:"#888"}),Xa(ue,{stroke:"#888",strokeWidth:3})]}),de=document.createElement("span");de.innerText=H,o.appendChild(de),o.appendChild(Me)},E=()=>{i(1,o.textContent="",o),C("HH"),C("SN"),C("TO"),C("KD","time in beats")},x=()=>{const H={tempo:a,grid:h,binNote:u,adjustTime:p,pastBars:f,noteOnTimes:m};Lo(r.id,H)},M=async H=>{if(m.length===0||confirm("Import data and overwrite currently unsaved data?")){const Y=await Ro(H);i(2,a=Y.tempo),i(3,h=Y.grid),i(4,u=Y.binNote),i(5,p=Y.adjustTime??0),i(7,f=Y.pastBars),i(8,m=Y.noteOnTimes),E()}};tr(E);function w(H){a=H,i(2,a)}function S(){h=Dr(this),i(3,h)}function I(){u=Dr(this),i(4,u)}function L(){p=Yn(this.value),i(5,p)}function R(){f=Yn(this.value),i(7,f)}const k=()=>{i(6,c=!c),E()};function P(H){In[H?"unshift":"push"](()=>{o=H,i(1,o)})}function F(H){m=H,i(8,m)}const O=()=>A({timestamp:performance.now(),note:{number:38}}),W=()=>A({timestamp:performance.now(),note:{number:46}}),V=()=>A({timestamp:performance.now(),note:{number:48}}),$=()=>A({timestamp:performance.now(),note:{number:36}});return e.$$set=H=>{"demoInfo"in H&&i(0,r=H.demoInfo)},[r,o,a,h,u,p,c,f,m,A,y,E,x,M,v,w,S,I,L,R,k,P,F,O,W,V,$]}class ife extends pi{constructor(t){super(),di(this,t,nfe,tfe,fi,{demoInfo:0,drumPitchReplacementMapMD90:14},null,[-1,-1])}get drumPitchReplacementMapMD90(){return this.$$.ctx[14]}}const af=[{id:"accents",title:"[new] Accents",description:"See if you accent the right notes.",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],skills:["accents"],component:tae},{id:"chord-arpeggio-timing",title:"Chord and Arpeggio Timing",description:"See how spaced out the notes in a chord or arpeggio are, and how much time lies between these.",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],skills:["chord-timing","arpeggio-timing"],component:sae},{id:"chord-diagrams",title:"Chord Diagrams",description:"See what chords you play on a guitar/bass as chord diagrams.",input:"MIDI",instruments:["guitar/bass"],skills:["chord-notes"],component:cae},{id:"dynamics",title:"Dynamics",description:"Check how well you control the loudness of notes.",input:"MIDI",instruments:["drum","guitar/bass","keyboard"],skills:["constant-dynamics","(de)crescendo","accents"],component:yae},{id:"fretboard-heatmap",title:"Fretboard Heatmap",description:"See how often you play different fretboard positions.",input:"MIDI",instruments:["guitar/bass"],skills:["instrument-layout"],component:Cae},{id:"fretboard-improvisation-intervals",title:"Fretboard Improvisation Intervals",description:"Once you play a note, see where on the fretboard you can reach different intervals to the last played note.",input:"MIDI",instruments:["guitar/bass"],skills:["instrument-layout","pitch-intervals"],component:Tae},{id:"fretboard-jitter",title:"Fretboard Jitter",description:"See how you play different fretboard positions over time.",input:"MIDI",instruments:["guitar/bass"],skills:["instrument-layout"],component:Lae},{id:"fretboard-spacetmime-cube",title:"Fretboard Spacetime Cube",description:"See how you play different fretboard positions over time.",input:"MIDI",instruments:["guitar/bass"],skills:["instrument-layout"],component:Hae},{id:"improvisation-intervals",title:"Improvisation Intervals",description:"See how often you use different intervals in improvisation.",input:"MIDI",instruments:["guitar/bass","keyboard"],skills:["pitch-intervals"],component:Xae},{id:"improvisation-note-colors",title:"Improvisation Note Colors",description:"See how often you use different kinds of notes in improvisation.",input:"MIDI",instruments:["guitar/bass","keyboard"],skills:["pitch-intervals","scale-degrees"],component:tle},{id:"improvisation-scale-degrees",title:"Improvisation Scale Degrees",description:"See how often you use different scale degrees in improvisation.",input:"MIDI",instruments:["guitar/bass","keyboard"],skills:["pitch-intervals","scale-degrees"],component:ole},{id:"improvisation-scale-degrees-bar",title:"Improvisation Scale Degrees (Bar)",description:"See how often you use different scale degrees in improvisation, for each played bar.",input:"MIDI",instruments:["guitar/bass","keyboard"],skills:["pitch-intervals","scale-degrees"],component:hle},{id:"keyboard-histogram",title:"Keyboard Histogram",description:"See how often you play different keyboard keys.",input:"MIDI",instruments:["keyboard"],skills:["instrument-layout"],component:Ale},{id:"pitch-bend",title:"Pitch Bend",description:"Practice different kinds of pitch bends.",input:"MIDI",instruments:["guitar/bass","keyboard"],skills:["bending","vibrato"],component:Jce},{id:"pitch-bend-audio",title:"Pitch Bend (Audio)",description:"Practice different kinds of pitch bends.",input:"audio",instruments:["guitar/bass","keyboard","singing"],skills:["bending","vibrato"],component:iue},{id:"pitch-offset-cents",title:"[new] Pitch Offset in Cents",description:"See how well you are on pitch.",input:"audio",instruments:["guitar/bass","keyboard","singing"],skills:["pitch-keeping","bending","vibrato"],component:cue},{id:"rhythm-sheet-music",title:"Rhythm Sheet Music",description:"This demo displays the notes you play as staff notation (, , , , ) and offset in percent.",input:"MIDI",instruments:["drum","guitar/bass","keyboard","pc-key"],skills:["sub-division"],component:due},{id:"speed-up",title:"Speed-Up",description:"Record a short exercise at a slow tempo, then practice it with steadily increasing tempo.",input:"MIDI",instruments:["drum","guitar/bass","keyboard","pc-key"],skills:["sub-division","timing-consistency"],component:Eue},{id:"speed-up-tab",title:" Speed-Up Tab",description:"Record a short guitar exercise at a slow tempo, then practice it with steadily increasing tempo.",input:"MIDI",instruments:["guitar/bass"],skills:["sub-division","timing-consistency"],component:Bue},{id:"sub-division",title:"Sub-Division",description:"Learn rhythmic playing in different sub-divisions.",input:"MIDI",instruments:["drum","guitar/bass","keyboard","pc-key"],skills:["sub-division","timing-consistency"],component:ohe},{id:"sub-division-bar",title:"Sub-Division (Per Bar)",description:"Learn rhythmic playing in different sub-divisions.",input:"MIDI",instruments:["drum","guitar/bass","keyboard","pc-key"],skills:["sub-division","timing-consistency"],component:dhe},{id:"sub-division-drums",title:"[new] Sub-Division (Drums)",description:"Learn rhythmic playing in different sub-divisions.",input:"MIDI",instruments:["drum","pc-key"],skills:["sub-division","timing-consistency"],component:ife},{id:"sub-division-linear",title:"Sub-Division (Linear)",description:"Learn rhythmic playing in different sub-divisions.",input:"MIDI",instruments:["drum","guitar/bass","keyboard","pc-key"],skills:["sub-division","timing-consistency"],component:yhe},{id:"strumming-pattern",title:"[new] Strumming Pattern",description:"Practice up/down strumming patterns.",input:"MIDI",instruments:["guitar/bass"],skills:["strumming-direction","strumming-strings"],component:Pue},{id:"tempo-drift",title:"Tempo Drift",description:"Keep your tempo constant over a longer stretch of playing.",input:"MIDI",instruments:["drum","guitar/bass","keyboard","pc-key"],skills:["tempo-keeping"],component:Fhe},{id:"two-handed-timing",title:"[new] Two-Handed Timing",description:"Play the same or a different rhythm with each hand and see your timing seperately.",input:"MIDI",instruments:["keyboard","pc-key"],skills:["sub-division","timing-consistency","syncopation"],component:Yhe}];function x4(e,t,i){const r=e.slice();return r[29]=t[i],r}function M4(e,t,i){const r=e.slice();return r[32]=t[i],r}function S4(e,t,i){const r=e.slice();return r[32]=t[i],r}function rfe(e){let t,i,r;var o=e[0].component;function a(h,u){return{props:{demoInfo:h[0]}}}return o&&(t=cg(o,a(e))),{c(){t&&Ut(t.$$.fragment),i=Zf()},m(h,u){t&&Ft(t,h,u),Bt(h,i,u),r=!0},p(h,u){if(u[0]&1&&o!==(o=h[0].component)){if(t){u1();const p=t;Ot(p.$$.fragment,1,0,()=>{kt(p,1)}),h1()}o?(t=cg(o,a(h)),Ut(t.$$.fragment),Nt(t.$$.fragment,1),Ft(t,i.parentNode,i)):t=null}else if(o){const p={};u[0]&1&&(p.demoInfo=h[0]),t.$set(p)}},i(h){r||(t&&Nt(t.$$.fragment,h),r=!0)},o(h){t&&Ot(t.$$.fragment,h),r=!1},d(h){h&&It(i),t&&kt(t,h)}}}function sfe(e){let t,i;return t=new zoe({props:{demos:af,allInstruments:e[8]}}),{c(){Ut(t.$$.fragment)},m(r,o){Ft(t,r,o),i=!0},p:gn,i(r){i||(Nt(t.$$.fragment,r),i=!0)},o(r){Ot(t.$$.fragment,r),i=!1},d(r){kt(t,r)}}}function ofe(e){let t,i;return t=new Noe({}),{c(){Ut(t.$$.fragment)},m(r,o){Ft(t,r,o),i=!0},p:gn,i(r){i||(Nt(t.$$.fragment,r),i=!0)},o(r){Ot(t.$$.fragment,r),i=!1},d(r){kt(t,r)}}}function afe(e){let t,i,r;function o(h){e[26](h)}let a={};return e[6]!==void 0&&(a.currentTool=e[6]),t=new Loe({props:a}),In.push(()=>Yi(t,"currentTool",o)),{c(){Ut(t.$$.fragment)},m(h,u){Ft(t,h,u),r=!0},p(h,u){const p={};!i&&u[0]&64&&(i=!0,p.currentTool=h[6],Ki(()=>i=!1)),t.$set(p)},i(h){r||(Nt(t.$$.fragment,h),r=!0)},o(h){Ot(t.$$.fragment,h),r=!1},d(h){kt(t,h)}}}function lfe(e){let t,i,r,o,a,h,u,p,c,f,g,m,v,A,y,C,E,x,M,w,S,I,L,R,k,P,F,O;function W(K){e[17](K)}let V={allSkills:e[10]};e[4]!==void 0&&(V.currentSkills=e[4]),p=new eX({props:V}),In.push(()=>Yi(p,"currentSkills",W));let $=fn(e[8].values()),H=[];for(let K=0;K<$.length;K+=1)H[K]=T4(S4(e,$,K));let Y=fn(e[9].values()),Q=[];for(let K=0;K<Y.length;K+=1)Q[K]=I4(M4(e,Y,K));let G=fn(e[7]),J=[];for(let K=0;K<G.length;K+=1)J[K]=B4(x4(e,G,K));return{c(){t=oe("p"),t.textContent=`This page contains a collection of small tools (demos) that are each
      tailored to a specific musical skill and sometimes also specific kind of
      musical data. You can filter demos by different aspects with the sidebar
      on the left.`,i=ge(),r=oe("div"),o=oe("div"),a=oe("div"),h=oe("input"),u=ge(),Ut(p.$$.fragment),f=ge(),g=oe("div"),m=oe("h2"),m.textContent="instrument",v=ge(),A=oe("button"),A.textContent="show all",y=ge();for(let K=0;K<H.length;K+=1)H[K].c();C=ge(),E=oe("div"),x=oe("h2"),x.textContent="input",M=ge(),w=oe("button"),w.textContent="show all",S=ge();for(let K=0;K<Q.length;K+=1)Q[K].c();I=ge(),L=oe("div");for(let K=0;K<J.length;K+=1)J[K].c();R=ge(),k=oe("button"),k.textContent=" export usage",fe(t,"class","explanation"),fe(h,"class","search-box svelte-tuqaaf"),fe(h,"type","search"),fe(h,"placeholder","search by title"),fe(A,"class","svelte-tuqaaf"),fe(w,"class","svelte-tuqaaf"),fe(o,"class","filter svelte-tuqaaf"),fe(L,"class","grid"),fe(r,"class","grid-filter-demo svelte-tuqaaf"),fe(k,"title","Export usage statistics")},m(K,se){Bt(K,t,se),Bt(K,i,se),Bt(K,r,se),D(r,o),D(o,a),D(a,h),ln(h,e[5]),D(o,u),Ft(p,o,null),D(o,f),D(o,g),D(g,m),D(g,v),D(g,A),D(g,y);for(let ue=0;ue<H.length;ue+=1)H[ue]&&H[ue].m(g,null);D(o,C),D(o,E),D(E,x),D(E,M),D(E,w),D(E,S);for(let ue=0;ue<Q.length;ue+=1)Q[ue]&&Q[ue].m(E,null);D(r,I),D(r,L);for(let ue=0;ue<J.length;ue+=1)J[ue]&&J[ue].m(L,null);Bt(K,R,se),Bt(K,k,se),P=!0,F||(O=[lt(h,"input",e[16]),lt(A,"click",e[18]),lt(w,"click",e[21]),lt(k,"click",e[25])],F=!0)},p(K,se){se[0]&32&&h.value!==K[5]&&ln(h,K[5]);const ue={};if(!c&&se[0]&16&&(c=!0,ue.currentSkills=K[4],Ki(()=>c=!1)),p.$set(ue),se[0]&260){$=fn(K[8].values());let he;for(he=0;he<$.length;he+=1){const Me=S4(K,$,he);H[he]?H[he].p(Me,se):(H[he]=T4(Me),H[he].c(),H[he].m(g,null))}for(;he<H.length;he+=1)H[he].d(1);H.length=$.length}if(se[0]&520){Y=fn(K[9].values());let he;for(he=0;he<Y.length;he+=1){const Me=M4(K,Y,he);Q[he]?Q[he].p(Me,se):(Q[he]=I4(Me),Q[he].c(),Q[he].m(E,null))}for(;he<Q.length;he+=1)Q[he].d(1);Q.length=Y.length}if(se[0]&129){G=fn(K[7]);let he;for(he=0;he<G.length;he+=1){const Me=x4(K,G,he);J[he]?J[he].p(Me,se):(J[he]=B4(Me),J[he].c(),J[he].m(L,null))}for(;he<J.length;he+=1)J[he].d(1);J.length=G.length}},i(K){P||(Nt(p.$$.fragment,K),P=!0)},o(K){Ot(p.$$.fragment,K),P=!1},d(K){K&&(It(t),It(i),It(r),It(R),It(k)),kt(p),ti(H,K),ti(Q,K),ti(J,K),F=!1,ji(O)}}}function cfe(e){let t,i,r;return{c(){t=oe("input"),fe(t,"type","password"),fe(t,"placeholder","password")},m(o,a){Bt(o,t,a),ln(t,e[1]),i||(r=lt(t,"input",e[15]),i=!0)},p(o,a){a[0]&2&&t.value!==o[1]&&ln(t,o[1])},i:gn,o:gn,d(o){o&&It(t),i=!1,r()}}}function T4(e){let t,i=e[32]+"",r,o,a,h,u;function p(){return e[19](e[32])}function c(){return e[20](e[32])}return{c(){t=oe("button"),r=$e(i),o=ge(),fe(t,"class",a=lg(e[2].has(e[32])?"active":"hidden")+" svelte-tuqaaf"),fe(t,"title","click to toggle, double-click to only show this")},m(f,g){Bt(f,t,g),D(t,r),D(t,o),h||(u=[lt(t,"click",p),lt(t,"dblclick",c)],h=!0)},p(f,g){e=f,g[0]&4&&a!==(a=lg(e[2].has(e[32])?"active":"hidden")+" svelte-tuqaaf")&&fe(t,"class",a)},d(f){f&&It(t),h=!1,ji(u)}}}function I4(e){let t,i=e[32]+"",r,o,a,h,u;function p(){return e[22](e[32])}function c(){return e[23](e[32])}return{c(){t=oe("button"),r=$e(i),o=ge(),fe(t,"class",a=lg(e[3].has(e[32])?"active":"hidden")+" svelte-tuqaaf"),fe(t,"title","click to toggle, double-click to only show this")},m(f,g){Bt(f,t,g),D(t,r),D(t,o),h||(u=[lt(t,"click",p),lt(t,"dblclick",c)],h=!0)},p(f,g){e=f,g[0]&8&&a!==(a=lg(e[3].has(e[32])?"active":"hidden")+" svelte-tuqaaf")&&fe(t,"class",a)},d(f){f&&It(t),h=!1,ji(u)}}}function B4(e){let t,i,r=e[29].title+"",o,a,h,u=e[29].description+"",p,c,f,g=(e[29].input==="audio"?aS:"")+"",m,v,A=(e[29].input==="MIDI"?oS:"")+"",y,C,E=e[29].instruments.includes("guitar/bass")?"":"",x,M,w=e[29].instruments.includes("drum")?"":"",S,I,L=e[29].instruments.includes("keyboard")?"":"",R,k,P=e[29].instruments.includes("wind")?"":"",F,O,W=e[29].instruments.includes("singing")?"":"",V,$,H=e[29].instruments.includes("strings")?"":"",Y,Q,G=e[29].instruments.includes("pc-key")?"":"",J,K,se,ue;function he(){return e[24](e[29])}return{c(){t=oe("div"),i=oe("h2"),o=$e(r),a=ge(),h=oe("div"),p=$e(u),c=ge(),f=oe("div"),m=$e(g),v=ge(),y=$e(A),C=ge(),x=$e(E),M=ge(),S=$e(w),I=ge(),R=$e(L),k=ge(),F=$e(P),O=ge(),V=$e(W),$=ge(),Y=$e(H),Q=ge(),J=$e(G),K=ge(),fe(h,"class","description"),fe(f,"class","tags svelte-tuqaaf"),fe(t,"class","card svelte-tuqaaf")},m(Me,de){Bt(Me,t,de),D(t,i),D(i,o),D(t,a),D(t,h),D(h,p),D(t,c),D(t,f),D(f,m),D(f,v),D(f,y),D(f,C),D(f,x),D(f,M),D(f,S),D(f,I),D(f,R),D(f,k),D(f,F),D(f,O),D(f,V),D(f,$),D(f,Y),D(f,Q),D(f,J),D(t,K),se||(ue=lt(t,"click",he),se=!0)},p(Me,de){e=Me,de[0]&128&&r!==(r=e[29].title+"")&&jt(o,r),de[0]&128&&u!==(u=e[29].description+"")&&jt(p,u),de[0]&128&&g!==(g=(e[29].input==="audio"?aS:"")+"")&&jt(m,g),de[0]&128&&A!==(A=(e[29].input==="MIDI"?oS:"")+"")&&jt(y,A),de[0]&128&&E!==(E=e[29].instruments.includes("guitar/bass")?"":"")&&jt(x,E),de[0]&128&&w!==(w=e[29].instruments.includes("drum")?"":"")&&jt(S,w),de[0]&128&&L!==(L=e[29].instruments.includes("keyboard")?"":"")&&jt(R,L),de[0]&128&&P!==(P=e[29].instruments.includes("wind")?"":"")&&jt(F,P),de[0]&128&&W!==(W=e[29].instruments.includes("singing")?"":"")&&jt(V,W),de[0]&128&&H!==(H=e[29].instruments.includes("strings")?"":"")&&jt(Y,H),de[0]&128&&G!==(G=e[29].instruments.includes("pc-key")?"":"")&&jt(J,G)},d(Me){Me&&It(t),se=!1,ue()}}}function ufe(e){let t,i,r,o,a,h,u,p,c,f,g,m,v,A,y,C,E;const x=[cfe,lfe,afe,ofe,sfe,rfe],M=[];function w(S,I){return S[1]!==hfe?0:S[0]?S[0]==="tools"?2:S[0]==="settings"?3:S[0]==="overview"?4:5:1}return v=w(e),A=M[v]=x[v](e),{c(){t=oe("main"),i=oe("header"),r=oe("h1"),r.textContent="Data-Driven Music Education Demos",o=ge(),a=oe("button"),a.textContent=" demos",h=ge(),u=oe("button"),u.textContent=" overview",p=ge(),c=oe("button"),c.textContent=" tools",f=ge(),g=oe("button"),g.textContent=" settings",m=ge(),A.c()},m(S,I){Bt(S,t,I),D(t,i),D(i,r),D(i,o),D(i,a),D(i,h),D(i,u),D(i,p),D(i,c),D(i,f),D(i,g),D(t,m),M[v].m(t,null),y=!0,C||(E=[lt(a,"click",e[11]),lt(u,"click",e[12]),lt(c,"click",e[13]),lt(g,"click",e[14])],C=!0)},p(S,I){let L=v;v=w(S),v===L?M[v].p(S,I):(u1(),Ot(M[L],1,1,()=>{M[L]=null}),h1(),A=M[v],A?A.p(S,I):(A=M[v]=x[v](S),A.c()),Nt(A,1),A.m(t,null))},i(S){y||(Nt(A),y=!0)},o(S){Ot(A),y=!1},d(S){S&&It(t),M[v].d(),C=!1,ji(E)}}}let hfe="rhyvis";function ffe(e,t,i){let r,o=null;const a=QU(window,"d");a&&a!==""&&(o=af.filter(H=>H.id===a)[0]);let h=localStorage.getItem("pwd")??"";window.onpopstate=H=>{o!==null&&i(0,o=null)},console.log("localStorage space",X$()),console.log("usage data",L6());const u=new Set(af.flatMap(H=>H.instruments).sort()),p=new Set(af.flatMap(H=>H.input).sort()),c=new Set(af.flatMap(H=>H.skills).sort());let f=new Set(u),g=new Set(p),m=new Set(c),v="",A=null;const y=new Set(q$.map(H=>H.id));console.log({extraSkills:[...Tf(c,y)],missingSkills:[...Tf(y,c)]});const C=()=>{i(0,o=null),$d(window,"d","")},E=()=>{i(0,o="overview"),$d(window,"d","overview")},x=()=>{i(0,o="tools"),i(6,A=null),$d(window,"d","tools")},M=()=>{i(0,o="settings"),$d(window,"d","settings")};function w(){h=this.value,i(1,h)}function S(){v=this.value,i(5,v)}function I(H){m=H,i(4,m)}const L=()=>{i(2,f=new Set(u))},R=H=>i(2,f=eS(f,H)),k=H=>i(2,f=new Set([H])),P=()=>{i(3,g=new Set(p))},F=H=>i(3,g=eS(g,H)),O=H=>i(3,g=new Set([H])),W=H=>{i(0,o=H),$d(window,"d",H.id)},V=()=>{const H=localStorage.getItem("usage"),Y=new Blob([H],{type:"text/plain;charset=utf-8"});D6(Y,"usage.json")};function $(H){A=H,i(6,A)}return e.$$.update=()=>{if(e.$$.dirty[0]&2&&localStorage.setItem("pwd",h),e.$$.dirty[0]&1&&o&&o!=="tools"){let H;localStorage.getItem("usage")!==null?(H=localStorage.getItem("usage"),H=JSON.parse(H)):H={demoClicks:{}};const Y=H.demoClicks,Q=Y[o.id]??[];Q.push(new Date().toUTCString()),Y[o.id]=Q,localStorage.setItem("usage",JSON.stringify(H))}e.$$.dirty[0]&60&&i(7,r=af.filter(H=>H.title.toLowerCase().includes(v)&&tS(f,H.instruments)&&tS(m,H.skills)&&g.has(H.input)))},[o,h,f,g,m,v,A,r,u,p,c,C,E,x,M,w,S,I,L,R,k,P,F,O,W,V,$]}class dfe extends pi{constructor(t){super(),di(this,t,ffe,ufe,fi,{},null,[-1,-1])}}new dfe({target:document.getElementById("app")});
