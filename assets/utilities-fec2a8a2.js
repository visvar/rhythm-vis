import{g as $}from"./index-1d009458.js";function n(){const h=Uint8Array,d=Float32Array;n.modules||Object.defineProperties(n,{modules:{value:new WeakMap},setModule:{value(e,t){n.modules.set(e,Promise.resolve(t))}},getModule:{value(e,t){let s=n.modules.get(e);return s||(t?s=WebAssembly.compile(n.decodeDynString(t)):(t=e.wasm,s=n.inflateDynEncodeString(t).then(U=>WebAssembly.compile(U))),n.modules.set(e,s)),s}},concatFloat32:{value(e,t){let s=new d(t),U=0,r=0;for(;U<e.length;)s.set(e[U],r),r+=e[U++].length;return s}},getDecodedAudio:{value:(e,t,s,U,r)=>({errors:e,channelData:t,samplesDecoded:s,sampleRate:U,bitDepth:r})},getDecodedAudioMultiChannel:{value(e,t,s,U,r,i){let l=[],o,c;for(o=0;o<s;o++){const a=[];for(c=0;c<t.length;)a.push(t[c++][o]||[]);l.push(n.concatFloat32(a,U))}return n.getDecodedAudio(e,l,U,r,i)}},crc32Table:{value:(()=>{let e=new Int32Array(256),t,s,U;for(t=0;t<256;t++){for(U=t<<24,s=8;s>0;--s)U=U&2147483648?U<<1^79764919:U<<1;e[t]=U}return e})()},decodeDynString:{value(e){let t=new h(e.length),s=parseInt(e.substring(11,13),16),U=256-s,r,i=!1,l=0,o,c=21,a,u=4294967295;for(;c<e.length;){if(o=e.charCodeAt(c++),o===61&&!i){i=!0;continue}i&&(i=!1,o-=64),t[l]=o<s&&o>0?o+U:o-s,u=u<<8^n.crc32Table[(u>>24^t[l++])&255]}for(r=0;r<=8;r+=2)a|=parseInt(e.substring(13+r,15+r),16)<<r*4;if(a!==u)throw new Error("WASM string decode failed crc32 validation");return t.subarray(0,l)}},inflateDynEncodeString:{value(e){return e=n.decodeDynString(e),new Promise(t=>{const s=String.raw`dynEncode0114db91da9buÂ‡Â*tÂ“Â“Â“tÂ“Â“Â“Â“Â“tÂ“Â“Â“Â“$#Â“UÂ¤Â¤Â“UÂ¤Â¤3ÂyÂÂƒÂ†ÂÂ„Â‰zzss|yuÂ„svuÂ‡yÃš&ÂˆÂ“4<054<,5T44^T44<(6U~J(44< ~A544U~6J0444ÂˆÂ†545 444J0444Â‰J,4UÂ“4ÂˆUÂ“Â‡Â…Ã’Â“7U45Â“4U4ZÂ“4U4U^/6545T4T44BUÂˆ~64CU~O4U54U~5 U5T4B4Z!4U~5U5U5T4U~6U4ZTU5U5T44~4O4U2ZTU5T44Z!4B6T44UÂˆ~64B6U~O44UÂˆ~4O4U~54U~5 44~C4~54U~5 44~5454UÂˆ4B6Ub!444~UO4U~5 Â“U5Â“4U4ZTUÂŠ#44U$4Â†64<4~B6^Â“4<444~UÂˆ~B4U~54UÂˆ544~544~UÂˆ5 ÂµÂ“UÃ¤#UJUÃ¨#5TT4U0ZTTUX5U5T4T4UÃ #~4OU4UÂ $~CÂˆ4~54U~5 T44$6U\!TTT4UaT4<6T4<64<Z!44~4N4<U~5 4UÂ”Z!4UÂ±_TUÂŠ#44UÂ•UÂˆ6UÃ”~B$544$6U\!4UÂˆ6UÂ¤#~B44UÃ¤#~B$~64<6_TUÂ‰#444UÂ”~B~6~54<Y!44<_!T4Y!4<64~444~AN44<U~6J4U5 44J4UÂ”[!U#44UÂŠO4U~54U~5 U54 Â“7U6844J44J 4UJ4UJ04VK(44<J44<J$4UÂ´~54U~5 4UÂ¤~5!TTT4U$5"UÂ“5TTTTTTT4U$"4VK,U54<(6U~64<$6_!4< 64~6A54A544U~6#J(UÂ’54A4UÂ‡[!44J(44#~A4UÂˆ6UÂ“Â‡UÂŠUÂ…[!44Â†64~64_!4<64~54<6T4<4]TU5 T4Y!44~44~AN4U~54U~54U5 44J(44J UÃ„A!U5UÂ”#UÃ´JU"UÃ”JUÂœ#UÃ”"JUÂ˜#UÂ´"JT4UÂ´ZTU5T4UÃ´ZTU5T4UDZTU5T4U$[T44~UO4U~5 UÃ”UÃ´4U~UÂ´$.U5T4UP[T4U~4~UO4U~5 UÂ˜#<UÂœ#<4U~U2$.UÃ„UN 44 ~UO4U~5 44!~UO4U~5 4U~4~UO4U~5 44J44J(U5 44UÂ¤~J@44UÃ¤~J<44UD~J844U~J44U$54U$5UÂ‘54U$54U1^4U1^Â†!4UÂ•~54U~5UÂ”54U~6U4U^/65T4T4U$54U~4BUÂˆ~4O4U54U~5 UU'464U'_/54UÂˆUÂ”~5T4T4U~4BUÂˆ~UO4U54U~5 UÂ54UÃ¤~4UÂ¤~4U~U'$!44~5U5T44\T44U<~$6U\!4U#aT4U~4UÂˆ~4O4U~5 U5U5U5TTT4U$"4YTUÂ5 4UÂˆ4~C5U5 U5U5444$4~64~\TUÂ5 4U~4UÂˆ~5T4Y!44O4U~54U~54U5 4CYTUÂ‹5 4UÃ¤~4UÂ¤~4U~4$6TUÂ54U\!44BÃ¦4BÃ¤~[!4U~4UD~4U~4UÂˆ~4$6TUÂŒ54U\!44BÂ†4BÂ„~[!44U<~4U4~$5 4U"UÂ˜#$544"Â†Y!454U^!44<J44<(J454U~84Â­UÂ”N!#%'+/37?GOWgwÂ‡Â—Â·Ã—Ã·UÃ¤;UÂ”9$%& !"#`;n.getModule(n,s).then(U=>WebAssembly.instantiate(U,{})).then(({exports:U})=>{const r=new Map(Object.entries(U)),i=r.get("puff"),l=r.get("memory").buffer,o=new h(l),c=new DataView(l);let a=r.get("__heap_base");const u=e.length,f=a;a+=4,c.setInt32(f,u,!0);const y=a;a+=u,o.set(e,y);const T=a;a+=4,c.setInt32(T,o.byteLength-a,!0),i(a,T,y,f),t(o.slice(a,a+c.getInt32(T,!0)))})})}}}),Object.defineProperty(this,"wasm",{enumerable:!0,get:()=>this._wasm}),this.getOutputChannels=(e,t,s)=>{let U=[],r=0;for(;r<t;)U.push(e.slice(r*s,r++*s+s));return U},this.allocateTypedArray=(e,t,s=!0)=>{const U=this._wasm.malloc(t.BYTES_PER_ELEMENT*e);return s&&this._pointers.add(U),{ptr:U,len:e,buf:new t(this._wasm.HEAP,U,e)}},this.free=()=>{this._pointers.forEach(e=>{this._wasm.free(e)}),this._pointers.clear()},this.codeToString=e=>{const t=[],s=new Uint8Array(this._wasm.HEAP);for(let U=s[e];U!==0;U=s[++e])t.push(U);return String.fromCharCode.apply(null,t)},this.addError=(e,t,s,U,r,i)=>{e.push({message:t,frameLength:s,frameNumber:U,inputBytes:r,outputSamples:i})},this.instantiate=(e,t)=>(t&&n.setModule(e,t),this._wasm=new e(n).instantiate(),this._pointers=new Set,this._wasm.ready.then(()=>this))}var J=Worker;const O=$(J),_=()=>globalThis.Worker||O;class B extends _(){constructor(d,e,t,s){n.modules||new n;let U=n.modules.get(t);if(!U){let r="text/javascript",i,l=`'use strict';(${((o,c,a)=>{let u,f,y=new Promise(T=>{f=T});self.onmessage=({data:{id:T,command:p,data:g}})=>{let m=y,w={id:T},A;p==="init"?(Object.defineProperties(o,{WASMAudioDecoderCommon:{value:c},EmscriptenWASM:{value:a},module:{value:g.module},isWebWorker:{value:!0}}),u=new o(g.options),f()):p==="free"?u.free():p==="ready"?m=m.then(()=>u.ready):p==="reset"?m=m.then(()=>u.reset()):(Object.assign(w,u[p](Array.isArray(g)?g.map(b=>new Uint8Array(b)):new Uint8Array(g))),A=w.channelData?w.channelData.map(b=>b.buffer):[]),m.then(()=>self.postMessage(w,A))}}).toString()})(${t}, ${n}, ${s})`;try{i=typeof process.versions.node<"u"}catch{}U=i?`data:${r};base64,${Buffer.from(l).toString("base64")}`:URL.createObjectURL(new Blob([l],{type:r})),n.modules.set(t,U)}super(U,{name:e}),this._id=Number.MIN_SAFE_INTEGER,this._enqueuedOperations=new Map,this.onmessage=({data:r})=>{const{id:i,...l}=r;this._enqueuedOperations.get(i)(l),this._enqueuedOperations.delete(i)},new s(n).getModule().then(r=>{this.postToDecoder("init",{module:r,options:d})})}async postToDecoder(d,e){return new Promise(t=>{this.postMessage({command:d,id:this._id,data:e}),this._enqueuedOperations.set(this._id++,t)})}get ready(){return this.postToDecoder("ready")}async free(){await this.postToDecoder("free").finally(()=>{this.terminate()})}async reset(){await this.postToDecoder("reset")}}const P=(h,d)=>{Object.defineProperty(h,"name",{value:d})};export{n as W,B as a,P as b};
